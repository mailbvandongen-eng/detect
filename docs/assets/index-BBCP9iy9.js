const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/arcgisAHNLayers-DDGel08T.js","assets/ImageryLayer-CFMyIUjm.js","assets/MultiOriginJSONSupport-D7yqnE2q.js","assets/GraphicOrigin-CVBMd8P0.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/OperationalLayer-CQfhqHH4.js","assets/layerContainerType-CSXZNpHb.js","assets/ElevationInfo-Bvkvfkh9.js","assets/lengthUtils-BzLrKVLa.js","assets/datasetUtils-BZ0TKrUb.js","assets/RasterJobHandlerMixin-CtD3-ec6.js","assets/ClassBreaksRenderer-D_5QpaNr.js","assets/commonProperties-ImqFgcDn.js","assets/colorRamps-D85wS-B0.js","assets/ColorStop-B8XgC4p7.js","assets/visualVariableUtils-DRdCV_nJ.js","assets/jsonUtils-C33Aunze.js","assets/defaults3D-BxVmayCl.js","assets/defaults-BuNebVxb.js","assets/defaultsJSON-GKolV7NZ.js","assets/RendererLegendOptions-DXgprYg_.js","assets/UniqueValueRenderer-FUtRWOdu.js","assets/diffUtils-jDIk9n1_.js","assets/styleUtils-DbRDVMF6.js","assets/RasterSymbolizer-BNlZorWn.js","assets/PixelBlock-B0Rj94Bl.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/vectorFieldUtils-BCvzxiRm.js","assets/colorUtils-BHT64S1R.js","assets/vec42-AdnYyqcL.js","assets/vec4f64-DPb6J-GU.js","assets/utils-uN4gRC0S.js","assets/cimSymbolUtils-B8YO7EHV.js","assets/utils-DQaLv0i_.js","assets/defaultCIMValues-XI-Li77m.js","assets/LRUCache-BH8oCef8.js","assets/MemCache-BeKkb3N7.js","assets/ClassBreaksDefinition-C4x_V41_.js","assets/dataUtils-BOYdrx8w.js","assets/FieldsIndex-B9joKLus.js","assets/UnknownTimeZone-BitrqK_s.js","assets/imageBitmapUtils-CDFPcAph.js","assets/rasterFieldUtils-D6xzoA6-.js","assets/FeatureSet-D6HZFSrF.js","assets/RasterPresetRendererMixin-BiPxjQUW.js","assets/executeForIds-BnZoEitQ.js","assets/query-CBT6iZ3f.js","assets/pbfQueryUtils-4V-rbfzs.js","assets/pbf-DE9XSzEc.js","assets/memoryEstimations-Cv_3VnWz.js","assets/OptimizedFeature-CCEJeD6k.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/queryZScale-BBE3Uh8l.js","assets/executeQueryJSON-BdKo0UzZ.js","assets/ArcGISService-ChuS9zhu.js","assets/BlendLayer-CBV4XNpt.js","assets/jsonUtils-DFXviWZJ.js","assets/parser-DcKKgvi6.js","assets/CustomParametersMixin-JY0_VeiH.js","assets/PortalLayer-DRUnodHH.js","assets/portalItemUtils-BSviU9LR.js","assets/RefreshableLayer-a8Si-mb0.js","assets/ScaleRangeLayer-G61GPv6E.js","assets/TemporalLayer-D0JlUfsd.js","assets/TimeInfo-CN4pfQ1T.js","assets/versionUtils-CdBdwSJ9.js","assets/elevationInfoUtils-B11QWGAO.js","assets/popupUtils-B1tOsDQ1.js","assets/romeinseFortenOL-BPM_V6hf.js","assets/iconStyles-B87wXlAl.js","assets/kastelenOL-T_cV9n-9.js","assets/ruinesOL-CgRO9XwV.js","assets/hunebeddenOL-CaDEdIQp.js","assets/uikavArcheoPuntenOL-Dmv-_p9b.js","assets/speeltuinenOL-BfYP8qri.js","assets/museaOL-BYGEMrEH.js","assets/kringloopwinkelsOL-CnvHG7YM.js","assets/fossielenOL-eA5pWB96.js","assets/fossielUtils-DEeIKTTy.js","assets/fossielenBelgieOL-CL-P3aKO.js","assets/fossielenDuitslandOL-BdFZytOI.js","assets/fossielenFrankrijkOL-73n8THoF.js","assets/bunkersOL-Bz0QfhQV.js","assets/grafheuvelsOL-BZAaErh_.js","assets/slagveldenOL-DE-scJy2.js","assets/IdentityManager-B5JkgnVm.js","assets/substitute-BS73lSj_.js","assets/ElevationLayer-CqNA76vi.js","assets/ArcGISCachedService-CbA5_ZnR.js","assets/TileInfoTilemapCache-C1SOcq-P.js","assets/TilemapCache-8yYmDHxo.js","assets/WorkerHandle-BMrdqfeV.js","assets/portalLayers-BlY7XnG4.js","assets/associatedFeatureServiceUtils-BYAEZG2G.js","assets/fetchService-IxEnDXRm.js","assets/loadUtils-7CQNI_JQ.js","assets/lazyLayerLoader-BnB1ZiV9.js","assets/arcgisLayers-6oP3SkHa.js","assets/layersCreator-CitNrbkO.js","assets/styleUtils-CHY-mHVp.js","assets/ElevationQuery-9WHXmw90.js","assets/GeometryDescriptor-CR8aQE_C.js","assets/projectOperator-CjRTGjL7.js","assets/operatorProject-vzugDU3y.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/projectOperator-Cb0tTcLz.js","assets/statsWorker-CbLzvriU.js","assets/utils-Be4pMei_.js","assets/quantizationUtils-Dhu5EE0s.js","assets/heatmapUtils-_l2swbBK.js","assets/utils-DU1wwhbG.js","assets/utils-SS1IoGW4.js","assets/geometryEngineWorker-BkMQzpX8.js","assets/geometryEngineJSON-B_JiqPb-.js","assets/geometryEngineBase-BQTefT4Y.js","assets/CSVSourceWorker-DH2Uzn2t.js","assets/date-DCujAECq.js","assets/FeatureStore-Bd5nYE8L.js","assets/featureConversionUtils-BAEvRNfA.js","assets/BoundsStore-Bsn29nwH.js","assets/PooledRBush-DtuxvVkf.js","assets/timeSupport-BCHgcxAx.js","assets/queryUtils-B85fy363.js","assets/optimizedFeatureQueryEngineAdapter-n481gjKj.js","assets/QueryEngine-YBzznJBJ.js","assets/WhereClauseCache-BlP3sz7h.js","assets/WhereClause-d85WZu7w.js","assets/TimeOnly-osfabNzq.js","assets/enum-CA2LEw9R.js","assets/QueryEngineCapabilities-DJC_YILC.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-Cifs7V2y.js","assets/NormalizationBinParametersMixin-CgvbVsiJ.js","assets/number-C-W0wb7F.js","assets/locationUtils-C5MrBRDd.js","assets/clientSideDefaults-DOE4Eka6.js","assets/EdgeProcessingWorker-C87gQ_PF.js","assets/workerHelper-BPKrbEyE.js","assets/InterleavedLayout-CEZtMwBt.js","assets/BufferView-BSuiYwvV.js","assets/types-BKo2foNY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/VertexAttributeLocations-BfZbt_DV.js","assets/edgeProcessing-B-yIZD23.js","assets/deduplicate-DH9wTiTD.js","assets/Indices-CTl6v4On.js","assets/Normals-CU815GyW.js","assets/ElevationSamplerWorker-CUinB0Hl.js","assets/MeshLocalVertexSpace-BKmQyQhc.js","assets/vertexSpaceConversion-CUo3bgHh.js","assets/spatialReferenceEllipsoidUtils-867CDqS5.js","assets/computeTranslationToOriginAndRotation-BAcX8Eb_.js","assets/projectPointToVector-CQRILJJd.js","assets/meshVertexSpaceUtils-D53jrfDa.js","assets/vec3-BOh2_hK4.js","assets/vec4-D_CgBXbx.js","assets/FeatureServiceSnappingSourceWorker-GQscbrJL.js","assets/symbologySnappingCandidates-DGKMmV5J.js","assets/GeoJSONSourceWorker-DyHR0YyV.js","assets/geojson-C_qGdeQZ.js","assets/sourceUtils-1na_sQrg.js","assets/MemorySourceWorker-CyyliqFE.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-C0qEI-SJ.js","assets/dehydratedFeatures-C_FW9kiC.js","assets/FeaturePipelineWorker-D43b8QFH.js","assets/AttributeStore-fP08t7OA.js","assets/Utils-DLeeaSjm.js","assets/BoundingBox-TFDITDND.js","assets/UpdateTracking2D-BmK-E3pA.js","assets/ArcadeExpression-B3_QhEWo.js","assets/FeatureStoreQueryAdapter-i61fs8Oq.js","assets/labelPoint-BmmMQFfs.js","assets/labelUtils-C14OPplY.js","assets/constants-BBnGEY1d.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/DictionaryScriptEvaluator-BHPOz6kh.js","assets/MeshWriterRegistry-B8WBljI5.js","assets/rasterizingUtils-DBqVYDIl.js","assets/CIMSymbolHelper-BmdMa29S.js","assets/BidiEngine-BvER9tXK.js","assets/GeometryUtils-BfnTXIQV.js","assets/Rect-CUzevAry.js","assets/TexturedLineMeshWriter-BJJhHbOk.js","assets/TurboLine-DFsRTEuS.js","assets/grouping-BIUE56GS.js","assets/QueueProcessor-BVeWtZRX.js","assets/FeatureMetadata-CidO9k95.js","assets/SourceChunkStore-B_1e5xCL.js","assets/parquet-DoVb8YjY.js","assets/operatorGeodeticDensify-BWLJ0zNQ.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-CwAf21WH.js","assets/FeatureIdInfo-BtsfCeGU.js","assets/displayFilterUtils-C5dznLXD.js","assets/ogcFeatureUtils-DDBwbzJ3.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-JdNvRJAK.js","assets/PointCloudWorker-BCtxY5w1.js","assets/quat-DgVKUJCT.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-BKVVjuj1.js","assets/I3SBinaryReader-BJGewvtV.js","assets/orientedBoundingBox-WP8iq53w.js","assets/plane-D4dXAXof.js","assets/vectorStacks-Cg2aDzhY.js","assets/RasterWorker-I3_d2MK7.js","assets/rasterFunctionHelper-TWKb2DUW.js","assets/clipUtils-wCwNLCuu.js","assets/rasterProjectionHelper-CHN_IuJ-.js","assets/PolynomialTransform-Bd1nFb7B.js","assets/SceneLayerSnappingSourceWorker-De_uAVXc.js","assets/lineSegment-D2AGisNt.js","assets/sphere-z5peSh-h.js","assets/Octree-CJBJcHxx.js","assets/frustum-CX9Biv8j.js","assets/SceneLayerWorker-BcxCVNI5.js","assets/projectVectorToVector-Bd7bVxdD.js","assets/WFSSourceWorker-DaqAagwq.js","assets/wfsUtils-BvQUkyUj.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-BWluGeg1.js","assets/constants-BHYAGdRm.js","assets/config-BOD8--da.js","assets/SourceLayerData-Be-4Ksgh.js","assets/StyleRepository-B0nFJygV.js","assets/earcut-D9gy186-.js","assets/Feature3DPipelineWorker-8ZQcil6y.js","assets/jsonUtils-BFUhzYre.js","assets/typeUtils-DPIT6zTJ.js","assets/SimpleRenderer-BVnzbWSx.js","assets/HUDMaterial.glsl-B_BkzxMi.js","assets/hydratedFeatures-C5ko5OFA.js","assets/OutputColorHighlightOID.glsl-DkIlRjER.js","assets/triangle-BAfTxY_F.js","assets/renderState-CKc66y4x.js","assets/glsl-B5bJgrnA.js","assets/ShaderBuilder-BwFQQ2jn.js","assets/placementUtils-b8SLmPuQ.js","assets/sdfPrimitives-DaFciRBB.js","assets/Texture-CTrb8Cy1.js","assets/videoUtils-D5rUBY04.js","assets/requestImageUtils-DmB9ONrl.js","assets/RealisticTree.glsl-CFPNbAX3.js","assets/DefaultMaterial-CMTLwkGw.js","assets/VertexBuffer-bhrZkdwk.js","assets/BufferObject-J6CCISNY.js","assets/boundedPlane-PNwMLMmJ.js","assets/FlowWorker-CRtLauKv.js","assets/ParquetSourceWorker-DVYX8NaV.js","assets/parquetUtils-Ct48jwV8.js","assets/PanoramicMeshWorker-CFebDxOV.js","assets/Popup-DvUaP8S5.js","assets/throttle-S5wOARuz.js","assets/unitFormatUtils-BRwUrs5g.js","assets/quantityUtils-ivlExRHX.js","assets/AttachmentInfo-BPWZW8nM.js","assets/labelingInfo-Bj5h2f2Z.js","assets/featureUtils-N0WQeWgC.js","assets/shared-DHjPQq65.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/FeatureLayer-DJDWjDGt.js","assets/FormTemplate-CDE8W6TM.js","assets/editsZScale-DMlupv67.js","assets/APIKeyMixin-CDzsWoVP.js","assets/DisplayFilteredLayer-VmtmNIwA.js","assets/scaleUtils-BCw0ldXH.js","assets/EditBusLayer-BoKiA_7X.js","assets/FeatureEffectLayer-Bzc6N7KL.js","assets/FeatureEffect-B7wsZhBH.js","assets/FeatureFilter-DKSaPiwz.js","assets/FeatureLayerBase-D3d8WhO-.js","assets/LayerFloorInfo-Q8-nP5Q0.js","assets/multiLayerServiceUtils-DXFTS3XE.js","assets/Relationship-DR_xtry4.js","assets/serviceCapabilitiesUtils-MB1zLZFm.js","assets/infoFor3D-DhzudQro.js","assets/FeatureReductionLayer-Cl-Tp9u2.js","assets/FeatureReductionSelection-Bu1egE4V.js","assets/OrderedLayer-21LxC0Gm.js","assets/OrderByInfo-BDBd2L9h.js","assets/TrackableLayer-BANvfMJj.js","assets/FeatureTemplate-DQr1CeaU.js","assets/FeatureType-D1ulmyrx.js","assets/fieldProperties-D93YCpWA.js","assets/TitleCreator-DfVlqF7K.js","assets/NetworkElement-NgbGWfMS.js","assets/ReactiveSet--5DUoiky.js","assets/symbolUtils-BFWdIOlY.js","assets/layerViewUtils-Casi4D5c.js","assets/arcadeUtils-DB3UA28m.js","assets/arcade-DvuaxeS6.js","assets/arcadeEnvironment--ZKQE1wL.js","assets/Dictionary-rVHrdqB5.js","assets/ImmutableArray-BPVd6ESQ.js","assets/Feature-Dk_WcXal.js","assets/aiServices-pXEvxrTW.js","assets/commonProperties-DHiB1uzW.js","assets/unitConversion-DlX-EB9M.js","assets/batchExec-K1JZqLHo.js","assets/webStyleSymbolUtils-DvphAHGx.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/geometryServiceUtils-CVw8Hojt.js","assets/project-FQ1I3Med.js","assets/webglDeps-BqjsH8Rb.js","assets/FramebufferObject-CDUoIaAZ.js","assets/ProgramTemplate-B4zj38tO.js","assets/VertexArrayObject-DUx5B4EL.js","assets/mapViewDeps-bU-Fi3lF.js","assets/FeatureCommandQueue-CVYfyAXG.js","assets/GraphShaderModule-BOzuTUna.js","assets/utils-BLX3E2PW.js","assets/WGLContainer-DiSoJlnd.js","assets/Container-CyJ8kA2t.js","assets/SDFHelper-D5MwpNm1.js","assets/OverrideHelper-WgcNS1Ls.js","assets/callExpressionWithFeature--_9nFF57.js","assets/GridShader-BFTZMrlD.js","assets/testSVGPremultipliedAlpha-DGCuyxcq.js","assets/SymbolFader-DFQ24kVm.js","assets/RenderingContext-BgieSyye.js","assets/CIMResourceManager-DB80ToUq.js","assets/utils-BGnNLkBq.js","assets/utils-DDjZAYSk.js","assets/GraphicsView2D-Dyy3UUFs.js","assets/GraphicContainer-xb-eupGY.js","assets/AGraphicContainer-lNfp2_DV.js","assets/TechniqueInstance-QLpNBDTi.js","assets/TileContainer-PJWy1GC6.js","assets/gridUtils-7zwvjwVx.js","assets/geodesicUtils-B7rE6lX4.js","assets/TileLayerView2D-DiXzfVW4.js","assets/imageUtils-D0G84Rwr.js","assets/BitmapTechnique-B2LaPEOO.js","assets/bitmapUtils-DJzl5BI3.js","assets/LayerView2D-DR6CTIAI.js","assets/HighlightGraphicContainer-Dt7W16-i.js","assets/LayerView-DL4bkBKo.js","assets/RefreshableLayerView-D4esTM24.js","assets/MapServiceLayerViewHelper-DJ_XNpVY.js","assets/floorFilterUtils-DKzVzLpH.js","assets/drapedUtils-BrYoNscq.js","assets/sublayerUtils-BEQnBRaB.js","assets/popupUtils-C6EXNqcD.js","assets/highlightOptionsUtils-DcFOCCg3.js","assets/FeatureLayerView2D-Hp17_mr7.js","assets/timeSupport-CbgTmg4c.js","assets/AttributeBinsFeatureSet-B2VHadfI.js","assets/AttributeBinsQuery-CVhvNQbz.js","assets/constants-SxxbBSOD.js","assets/BaseDynamicLayerView2D-edvgNSUJ.js","assets/BitmapContainer-CLeS0rSA.js","assets/ExportStrategy-Brt-j69I.js","assets/CatalogLayerView2D-i15e60qX.js","assets/CatalogDynamicGroupLayerView2D-k_BGeOuw.js","assets/CatalogFootprintLayerView2D-ChzWgQYK.js","assets/GeoRSSLayerView2D-BtlIz1O8.js","assets/GraphicsLayerView2D-CnaUkfxc.js","assets/GroupLayerView2D-DQVzVq8t.js","assets/ImageryLayerView2D-Wk5f6XML.js","assets/RasterVFDisplayObject-NECSKQHa.js","assets/ImageryTileLayerView2D-BfVdB5LH.js","assets/rasterUtils-CIaDpeBc.js","assets/RawBlockCache-CnAuUrbC.js","assets/KMLLayerView2D-DQa7eMxA.js","assets/kmlUtils-BaPy1GTF.js","assets/KnowledgeGraphLayerView2D-DYP__jux.js","assets/MapImageLayerView2D-wOVnJ7Ak.js","assets/ExportImageParameters-D6g0lYU_.js","assets/MapNotesLayerView2D-CLlved2I.js","assets/MediaLayerView2D-C3nl4_F9.js","assets/mediaLayerUtils-BeREV06-.js","assets/OverlayContainer-CB1wYcNi.js","assets/OGCFeatureLayerView2D-r27ZW3U3.js","assets/RouteLayerView2D-DGapfdfh.js","assets/Stop-DjQBnMbM.js","assets/networkEnums-BwB2iU-x.js","assets/StreamLayerView2D-CBlFjVdK.js","assets/SubtypeGroupLayerView2D-CAUNhlbZ.js","assets/VectorTileLayerView2D-CJwh_WpT.js","assets/VideoLayerView2D-BhBhduzm.js","assets/GraphicsLayer-4uvoZ5S5.js","assets/videoUtils-vJR6x584.js","assets/ControlPoint-BH46cIGv.js","assets/WMSLayerView2D-Dj3mO43p.js","assets/ExportWMSImageParameters-DW8wZmxz.js","assets/WMTSLayerView2D-MxTfQZB7.js","assets/ElevationProfileAnalysisView2D-DBmGwRel.js","assets/createUtils-BgBA1GkO.js","assets/distanceOperator-D0vgbQMd.js","assets/Point2D-BtwadikP.js","assets/Distance2DCalculator-CXhBP-8I-CSaNYICB.js","assets/ProjectionTransformation-9JtRkSeG.js","assets/Envelope2D-v1krxB11.js","assets/Transformation2D-DPwEgitm.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-hGB0pD5S.js","assets/jsonConverter-BwQGinVR.js","assets/simplifyOperator-Ccxp-tdk.js","assets/operatorSimplify-DF45Mk9t.js","assets/mapCollectionUtils-bxcRHT0s.js","assets/getDefaultUnitForView-EPAUxsZk.js","assets/SketchViewModel-CAyTpycm.js","assets/hitTestSelectUtils-BGsHGAOg.js","assets/geodeticLengthOperator-BBq5Et2b.js","assets/apng-BBxnbr4V.js","assets/index-BGmMjSHe.js","assets/index-IRL3bw6u.js","assets/guid-LcV_DAvu.js","assets/useT9n-DLEwuMAm.js","assets/index-CtMhKB3s.js","assets/index-BukTyvfh.js","assets/dom-DbWVcm2z.js","assets/observers-BsA6yUi1.js","assets/ref-CP86mzvA.js","assets/static-5BouB9Pa.js","assets/form-ZP37b0dI.js","assets/interactive-B8zDhGeY.js","assets/label-XBr8Tb1O.js","assets/useSetFocus-D99u2S81.js"])))=>i.map(i=>d[i]);
var vSe=Object.getPrototypeOf;var _Se=Reflect.get;var aY=t=>{throw TypeError(t)};var DD=(t,e,n)=>e.has(t)||aY("Cannot "+n);var Ir=(t,e,n)=>(DD(t,e,"read from private field"),n?n.call(t):e.get(t)),bu=(t,e,n)=>e.has(t)?aY("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Eu=(t,e,n,r)=>(DD(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Jb=(t,e,n)=>(DD(t,e,"access private method"),n);var lY=(t,e,n)=>_Se(vSe(t),n,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function sz(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $D={exports:{}},Qb={},jD={exports:{}},Wn={};var cY;function xSe(){if(cY)return Wn;cY=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.iterator;function f(Q){return Q===null||typeof Q!="object"?null:(Q=h&&Q[h]||Q["@@iterator"],typeof Q=="function"?Q:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function b(Q,B,ne){this.props=Q,this.context=B,this.refs=x,this.updater=ne||g}b.prototype.isReactComponent={},b.prototype.setState=function(Q,B){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,B,"setState")},b.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function T(){}T.prototype=b.prototype;function A(Q,B,ne){this.props=Q,this.context=B,this.refs=x,this.updater=ne||g}var I=A.prototype=new T;I.constructor=A,v(I,b.prototype),I.isPureReactComponent=!0;var R=Array.isArray,M=Object.prototype.hasOwnProperty,F={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function N(Q,B,ne){var ie,le={},ve=null,qe=null;if(B!=null)for(ie in B.ref!==void 0&&(qe=B.ref),B.key!==void 0&&(ve=""+B.key),B)M.call(B,ie)&&!C.hasOwnProperty(ie)&&(le[ie]=B[ie]);var Ke=arguments.length-2;if(Ke===1)le.children=ne;else if(1<Ke){for(var Te=Array(Ke),we=0;we<Ke;we++)Te[we]=arguments[we+2];le.children=Te}if(Q&&Q.defaultProps)for(ie in Ke=Q.defaultProps,Ke)le[ie]===void 0&&(le[ie]=Ke[ie]);return{$$typeof:t,type:Q,key:ve,ref:qe,props:le,_owner:F.current}}function O(Q,B){return{$$typeof:t,type:Q.type,key:B,ref:Q.ref,props:Q.props,_owner:Q._owner}}function j(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function V(Q){var B={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(ne){return B[ne]})}var W=/\/+/g;function U(Q,B){return typeof Q=="object"&&Q!==null&&Q.key!=null?V(""+Q.key):B.toString(36)}function pe(Q,B,ne,ie,le){var ve=typeof Q;(ve==="undefined"||ve==="boolean")&&(Q=null);var qe=!1;if(Q===null)qe=!0;else switch(ve){case"string":case"number":qe=!0;break;case"object":switch(Q.$$typeof){case t:case e:qe=!0}}if(qe)return qe=Q,le=le(qe),Q=ie===""?"."+U(qe,0):ie,R(le)?(ne="",Q!=null&&(ne=Q.replace(W,"$&/")+"/"),pe(le,B,ne,"",function(we){return we})):le!=null&&(j(le)&&(le=O(le,ne+(!le.key||qe&&qe.key===le.key?"":(""+le.key).replace(W,"$&/")+"/")+Q)),B.push(le)),1;if(qe=0,ie=ie===""?".":ie+":",R(Q))for(var Ke=0;Ke<Q.length;Ke++){ve=Q[Ke];var Te=ie+U(ve,Ke);qe+=pe(ve,B,ne,Te,le)}else if(Te=f(Q),typeof Te=="function")for(Q=Te.call(Q),Ke=0;!(ve=Q.next()).done;)ve=ve.value,Te=ie+U(ve,Ke++),qe+=pe(ve,B,ne,Te,le);else if(ve==="object")throw B=String(Q),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return qe}function Ne(Q,B,ne){if(Q==null)return Q;var ie=[],le=0;return pe(Q,ie,"","",function(ve){return B.call(ne,ve,le++)}),ie}function Se(Q){if(Q._status===-1){var B=Q._result;B=B(),B.then(function(ne){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=ne)},function(ne){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=ne)}),Q._status===-1&&(Q._status=0,Q._result=B)}if(Q._status===1)return Q._result.default;throw Q._result}var je={current:null},de={transition:null},Oe={ReactCurrentDispatcher:je,ReactCurrentBatchConfig:de,ReactCurrentOwner:F};function Ae(){throw Error("act(...) is not supported in production builds of React.")}return Wn.Children={map:Ne,forEach:function(Q,B,ne){Ne(Q,function(){B.apply(this,arguments)},ne)},count:function(Q){var B=0;return Ne(Q,function(){B++}),B},toArray:function(Q){return Ne(Q,function(B){return B})||[]},only:function(Q){if(!j(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},Wn.Component=b,Wn.Fragment=n,Wn.Profiler=i,Wn.PureComponent=A,Wn.StrictMode=r,Wn.Suspense=l,Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Oe,Wn.act=Ae,Wn.cloneElement=function(Q,B,ne){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var ie=v({},Q.props),le=Q.key,ve=Q.ref,qe=Q._owner;if(B!=null){if(B.ref!==void 0&&(ve=B.ref,qe=F.current),B.key!==void 0&&(le=""+B.key),Q.type&&Q.type.defaultProps)var Ke=Q.type.defaultProps;for(Te in B)M.call(B,Te)&&!C.hasOwnProperty(Te)&&(ie[Te]=B[Te]===void 0&&Ke!==void 0?Ke[Te]:B[Te])}var Te=arguments.length-2;if(Te===1)ie.children=ne;else if(1<Te){Ke=Array(Te);for(var we=0;we<Te;we++)Ke[we]=arguments[we+2];ie.children=Ke}return{$$typeof:t,type:Q.type,key:le,ref:ve,props:ie,_owner:qe}},Wn.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:s,_context:Q},Q.Consumer=Q},Wn.createElement=N,Wn.createFactory=function(Q){var B=N.bind(null,Q);return B.type=Q,B},Wn.createRef=function(){return{current:null}},Wn.forwardRef=function(Q){return{$$typeof:a,render:Q}},Wn.isValidElement=j,Wn.lazy=function(Q){return{$$typeof:u,_payload:{_status:-1,_result:Q},_init:Se}},Wn.memo=function(Q,B){return{$$typeof:c,type:Q,compare:B===void 0?null:B}},Wn.startTransition=function(Q){var B=de.transition;de.transition={};try{Q()}finally{de.transition=B}},Wn.unstable_act=Ae,Wn.useCallback=function(Q,B){return je.current.useCallback(Q,B)},Wn.useContext=function(Q){return je.current.useContext(Q)},Wn.useDebugValue=function(){},Wn.useDeferredValue=function(Q){return je.current.useDeferredValue(Q)},Wn.useEffect=function(Q,B){return je.current.useEffect(Q,B)},Wn.useId=function(){return je.current.useId()},Wn.useImperativeHandle=function(Q,B,ne){return je.current.useImperativeHandle(Q,B,ne)},Wn.useInsertionEffect=function(Q,B){return je.current.useInsertionEffect(Q,B)},Wn.useLayoutEffect=function(Q,B){return je.current.useLayoutEffect(Q,B)},Wn.useMemo=function(Q,B){return je.current.useMemo(Q,B)},Wn.useReducer=function(Q,B,ne){return je.current.useReducer(Q,B,ne)},Wn.useRef=function(Q){return je.current.useRef(Q)},Wn.useState=function(Q){return je.current.useState(Q)},Wn.useSyncExternalStore=function(Q,B,ne){return je.current.useSyncExternalStore(Q,B,ne)},Wn.useTransition=function(){return je.current.useTransition()},Wn.version="18.3.1",Wn}var uY;function gA(){return uY||(uY=1,jD.exports=xSe()),jD.exports}var hY;function wSe(){if(hY)return Qb;hY=1;var t=gA(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var u,h={},f=null,g=null;c!==void 0&&(f=""+c),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(g=l.ref);for(u in l)r.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:e,type:a,key:f,ref:g,props:h,_owner:i.current}}return Qb.Fragment=n,Qb.jsx=o,Qb.jsxs=o,Qb}var dY;function bSe(){return dY||(dY=1,$D.exports=wSe()),$D.exports}var m=bSe(),UR={},FD={exports:{}},Ha={},VD={exports:{}},zD={};var fY;function ESe(){return fY||(fY=1,(function(t){function e(de,Oe){var Ae=de.length;de.push(Oe);e:for(;0<Ae;){var Q=Ae-1>>>1,B=de[Q];if(0<i(B,Oe))de[Q]=Oe,de[Ae]=B,Ae=Q;else break e}}function n(de){return de.length===0?null:de[0]}function r(de){if(de.length===0)return null;var Oe=de[0],Ae=de.pop();if(Ae!==Oe){de[0]=Ae;e:for(var Q=0,B=de.length,ne=B>>>1;Q<ne;){var ie=2*(Q+1)-1,le=de[ie],ve=ie+1,qe=de[ve];if(0>i(le,Ae))ve<B&&0>i(qe,le)?(de[Q]=qe,de[ve]=Ae,Q=ve):(de[Q]=le,de[ie]=Ae,Q=ie);else if(ve<B&&0>i(qe,Ae))de[Q]=qe,de[ve]=Ae,Q=ve;else break e}}return Oe}function i(de,Oe){var Ae=de.sortIndex-Oe.sortIndex;return Ae!==0?Ae:de.id-Oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,g=!1,v=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(de){for(var Oe=n(c);Oe!==null;){if(Oe.callback===null)r(c);else if(Oe.startTime<=de)r(c),Oe.sortIndex=Oe.expirationTime,e(l,Oe);else break;Oe=n(c)}}function R(de){if(x=!1,I(de),!v)if(n(l)!==null)v=!0,Se(M);else{var Oe=n(c);Oe!==null&&je(R,Oe.startTime-de)}}function M(de,Oe){v=!1,x&&(x=!1,T(N),N=-1),g=!0;var Ae=f;try{for(I(Oe),h=n(l);h!==null&&(!(h.expirationTime>Oe)||de&&!V());){var Q=h.callback;if(typeof Q=="function"){h.callback=null,f=h.priorityLevel;var B=Q(h.expirationTime<=Oe);Oe=t.unstable_now(),typeof B=="function"?h.callback=B:h===n(l)&&r(l),I(Oe)}else r(l);h=n(l)}if(h!==null)var ne=!0;else{var ie=n(c);ie!==null&&je(R,ie.startTime-Oe),ne=!1}return ne}finally{h=null,f=Ae,g=!1}}var F=!1,C=null,N=-1,O=5,j=-1;function V(){return!(t.unstable_now()-j<O)}function W(){if(C!==null){var de=t.unstable_now();j=de;var Oe=!0;try{Oe=C(!0,de)}finally{Oe?U():(F=!1,C=null)}}else F=!1}var U;if(typeof A=="function")U=function(){A(W)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Ne=pe.port2;pe.port1.onmessage=W,U=function(){Ne.postMessage(null)}}else U=function(){b(W,0)};function Se(de){C=de,F||(F=!0,U())}function je(de,Oe){N=b(function(){de(t.unstable_now())},Oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(de){de.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,Se(M))},t.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<de?Math.floor(1e3/de):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(de){switch(f){case 1:case 2:case 3:var Oe=3;break;default:Oe=f}var Ae=f;f=Oe;try{return de()}finally{f=Ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(de,Oe){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var Ae=f;f=de;try{return Oe()}finally{f=Ae}},t.unstable_scheduleCallback=function(de,Oe,Ae){var Q=t.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?Q+Ae:Q):Ae=Q,de){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Ae+B,de={id:u++,callback:Oe,priorityLevel:de,startTime:Ae,expirationTime:B,sortIndex:-1},Ae>Q?(de.sortIndex=Ae,e(c,de),n(l)===null&&de===n(c)&&(x?(T(N),N=-1):x=!0,je(R,Ae-Q))):(de.sortIndex=B,e(l,de),v||g||(v=!0,Se(M))),de},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(de){var Oe=f;return function(){var Ae=f;f=Oe;try{return de.apply(this,arguments)}finally{f=Ae}}}})(zD)),zD}var pY;function SSe(){return pY||(pY=1,VD.exports=ESe()),VD.exports}var mY;function TSe(){if(mY)return Ha;mY=1;var t=gA(),e=SSe();function n(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,w=1;w<arguments.length;w++)p+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(d,p){o(d,p),o(d+"Capture",p)}function o(d,p){for(i[d]=p,d=0;d<p.length;d++)r.add(p[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},h={};function f(d){return l.call(h,d)?!0:l.call(u,d)?!1:c.test(d)?h[d]=!0:(u[d]=!0,!1)}function g(d,p,w,k){if(w!==null&&w.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return k?!1:w!==null?!w.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function v(d,p,w,k){if(p===null||typeof p>"u"||g(d,p,w,k))return!0;if(k)return!1;if(w!==null)switch(w.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function x(d,p,w,k,P,L,K){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=k,this.attributeNamespace=P,this.mustUseProperty=w,this.propertyName=d,this.type=p,this.sanitizeURL=L,this.removeEmptyString=K}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){b[d]=new x(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];b[p]=new x(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){b[d]=new x(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){b[d]=new x(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){b[d]=new x(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){b[d]=new x(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){b[d]=new x(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){b[d]=new x(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){b[d]=new x(d,5,!1,d.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function A(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(T,A);b[p]=new x(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(T,A);b[p]=new x(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(T,A);b[p]=new x(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){b[d]=new x(d,1,!1,d.toLowerCase(),null,!1,!1)}),b.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){b[d]=new x(d,1,!1,d.toLowerCase(),null,!0,!0)});function I(d,p,w,k){var P=b.hasOwnProperty(p)?b[p]:null;(P!==null?P.type!==0:k||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(v(p,w,P,k)&&(w=null),k||P===null?f(p)&&(w===null?d.removeAttribute(p):d.setAttribute(p,""+w)):P.mustUseProperty?d[P.propertyName]=w===null?P.type===3?!1:"":w:(p=P.attributeName,k=P.attributeNamespace,w===null?d.removeAttribute(p):(P=P.type,w=P===3||P===4&&w===!0?"":""+w,k?d.setAttributeNS(k,p,w):d.setAttribute(p,w))))}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),F=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),V=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),Ne=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),je=Symbol.for("react.offscreen"),de=Symbol.iterator;function Oe(d){return d===null||typeof d!="object"?null:(d=de&&d[de]||d["@@iterator"],typeof d=="function"?d:null)}var Ae=Object.assign,Q;function B(d){if(Q===void 0)try{throw Error()}catch(w){var p=w.stack.trim().match(/\n( *(at )?)/);Q=p&&p[1]||""}return`
`+Q+d}var ne=!1;function ie(d,p){if(!d||ne)return"";ne=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Fe){var k=Fe}Reflect.construct(d,[],p)}else{try{p.call()}catch(Fe){k=Fe}d.call(p.prototype)}else{try{throw Error()}catch(Fe){k=Fe}d()}}catch(Fe){if(Fe&&k&&typeof Fe.stack=="string"){for(var P=Fe.stack.split(`
`),L=k.stack.split(`
`),K=P.length-1,ce=L.length-1;1<=K&&0<=ce&&P[K]!==L[ce];)ce--;for(;1<=K&&0<=ce;K--,ce--)if(P[K]!==L[ce]){if(K!==1||ce!==1)do if(K--,ce--,0>ce||P[K]!==L[ce]){var he=`
`+P[K].replace(" at new "," at ");return d.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",d.displayName)),he}while(1<=K&&0<=ce);break}}}finally{ne=!1,Error.prepareStackTrace=w}return(d=d?d.displayName||d.name:"")?B(d):""}function le(d){switch(d.tag){case 5:return B(d.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return d=ie(d.type,!1),d;case 11:return d=ie(d.type.render,!1),d;case 1:return d=ie(d.type,!0),d;default:return""}}function ve(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case C:return"Fragment";case F:return"Portal";case O:return"Profiler";case N:return"StrictMode";case U:return"Suspense";case pe:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case V:return(d.displayName||"Context")+".Consumer";case j:return(d._context.displayName||"Context")+".Provider";case W:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case Ne:return p=d.displayName||null,p!==null?p:ve(d.type)||"Memo";case Se:p=d._payload,d=d._init;try{return ve(d(p))}catch{}}return null}function qe(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(p);case 8:return p===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Ke(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Te(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function we(d){var p=Te(d)?"checked":"value",w=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),k=""+d[p];if(!d.hasOwnProperty(p)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var P=w.get,L=w.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return P.call(this)},set:function(K){k=""+K,L.call(this,K)}}),Object.defineProperty(d,p,{enumerable:w.enumerable}),{getValue:function(){return k},setValue:function(K){k=""+K},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function Dt(d){d._valueTracker||(d._valueTracker=we(d))}function Ye(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var w=p.getValue(),k="";return d&&(k=Te(d)?d.checked?"true":"false":d.value),d=k,d!==w?(p.setValue(d),!0):!1}function sn(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function $t(d,p){var w=p.checked;return Ae({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??d._wrapperState.initialChecked})}function fn(d,p){var w=p.defaultValue==null?"":p.defaultValue,k=p.checked!=null?p.checked:p.defaultChecked;w=Ke(p.value!=null?p.value:w),d._wrapperState={initialChecked:k,initialValue:w,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function yn(d,p){p=p.checked,p!=null&&I(d,"checked",p,!1)}function dt(d,p){yn(d,p);var w=Ke(p.value),k=p.type;if(w!=null)k==="number"?(w===0&&d.value===""||d.value!=w)&&(d.value=""+w):d.value!==""+w&&(d.value=""+w);else if(k==="submit"||k==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?$n(d,p.type,w):p.hasOwnProperty("defaultValue")&&$n(d,p.type,Ke(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function lr(d,p,w){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var k=p.type;if(!(k!=="submit"&&k!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,w||p===d.value||(d.value=p),d.defaultValue=p}w=d.name,w!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,w!==""&&(d.name=w)}function $n(d,p,w){(p!=="number"||sn(d.ownerDocument)!==d)&&(w==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+w&&(d.defaultValue=""+w))}var Un=Array.isArray;function Xr(d,p,w,k){if(d=d.options,p){p={};for(var P=0;P<w.length;P++)p["$"+w[P]]=!0;for(w=0;w<d.length;w++)P=p.hasOwnProperty("$"+d[w].value),d[w].selected!==P&&(d[w].selected=P),P&&k&&(d[w].defaultSelected=!0)}else{for(w=""+Ke(w),p=null,P=0;P<d.length;P++){if(d[P].value===w){d[P].selected=!0,k&&(d[P].defaultSelected=!0);return}p!==null||d[P].disabled||(p=d[P])}p!==null&&(p.selected=!0)}}function po(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(n(91));return Ae({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function kr(d,p){var w=p.value;if(w==null){if(w=p.children,p=p.defaultValue,w!=null){if(p!=null)throw Error(n(92));if(Un(w)){if(1<w.length)throw Error(n(93));w=w[0]}p=w}p==null&&(p=""),w=p}d._wrapperState={initialValue:Ke(w)}}function Si(d,p){var w=Ke(p.value),k=Ke(p.defaultValue);w!=null&&(w=""+w,w!==d.value&&(d.value=w),p.defaultValue==null&&d.defaultValue!==w&&(d.defaultValue=w)),k!=null&&(d.defaultValue=""+k)}function Rs(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function bt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yn(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?bt(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var cr,Ft=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,w,k,P){MSApp.execUnsafeLocalFunction(function(){return d(p,w,k,P)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(cr=cr||document.createElement("div"),cr.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=cr.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function On(d,p){if(p){var w=d.firstChild;if(w&&w===d.lastChild&&w.nodeType===3){w.nodeValue=p;return}}d.textContent=p}var Qt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Oo=["Webkit","ms","Moz","O"];Object.keys(Qt).forEach(function(d){Oo.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),Qt[p]=Qt[d]})});function Fi(d,p,w){return p==null||typeof p=="boolean"||p===""?"":w||typeof p!="number"||p===0||Qt.hasOwnProperty(d)&&Qt[d]?(""+p).trim():p+"px"}function Ps(d,p){d=d.style;for(var w in p)if(p.hasOwnProperty(w)){var k=w.indexOf("--")===0,P=Fi(w,p[w],k);w==="float"&&(w="cssFloat"),k?d.setProperty(w,P):d[w]=P}}var Pn=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ti(d,p){if(p){if(Pn[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(n(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(n(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(n(61))}if(p.style!=null&&typeof p.style!="object")throw Error(n(62))}}function He(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ie=null;function Re(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var rn=null,z=null,Et=null;function Y(d){if(d=$b(d)){if(typeof rn!="function")throw Error(n(280));var p=d.stateNode;p&&(p=rR(p),rn(d.stateNode,d.type,p))}}function ae(d){z?Et?Et.push(d):Et=[d]:z=d}function ze(){if(z){var d=z,p=Et;if(Et=z=null,Y(d),p)for(d=0;d<p.length;d++)Y(p[d])}}function ee(d,p){return d(p)}function ge(){}var $e=!1;function Je(d,p,w){if($e)return d(p,w);$e=!0;try{return ee(d,p,w)}finally{$e=!1,(z!==null||Et!==null)&&(ge(),ze())}}function Ue(d,p){var w=d.stateNode;if(w===null)return null;var k=rR(w);if(k===null)return null;w=k[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(d=d.type,k=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!k;break e;default:d=!1}if(d)return null;if(w&&typeof w!="function")throw Error(n(231,p,typeof w));return w}var nt=!1;if(a)try{var et={};Object.defineProperty(et,"passive",{get:function(){nt=!0}}),window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch{nt=!1}function Ct(d,p,w,k,P,L,K,ce,he){var Fe=Array.prototype.slice.call(arguments,3);try{p.apply(w,Fe)}catch(ot){this.onError(ot)}}var zt=!1,gn=null,q=!1,re=null,J={onError:function(d){zt=!0,gn=d}};function te(d,p,w,k,P,L,K,ce,he){zt=!1,gn=null,Ct.apply(J,arguments)}function se(d,p,w,k,P,L,K,ce,he){if(te.apply(this,arguments),zt){if(zt){var Fe=gn;zt=!1,gn=null}else throw Error(n(198));q||(q=!0,re=Fe)}}function oe(d){var p=d,w=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(w=p.return),d=p.return;while(d)}return p.tag===3?w:null}function Ce(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function Be(d){if(oe(d)!==d)throw Error(n(188))}function Pe(d){var p=d.alternate;if(!p){if(p=oe(d),p===null)throw Error(n(188));return p!==d?null:d}for(var w=d,k=p;;){var P=w.return;if(P===null)break;var L=P.alternate;if(L===null){if(k=P.return,k!==null){w=k;continue}break}if(P.child===L.child){for(L=P.child;L;){if(L===w)return Be(P),d;if(L===k)return Be(P),p;L=L.sibling}throw Error(n(188))}if(w.return!==k.return)w=P,k=L;else{for(var K=!1,ce=P.child;ce;){if(ce===w){K=!0,w=P,k=L;break}if(ce===k){K=!0,k=P,w=L;break}ce=ce.sibling}if(!K){for(ce=L.child;ce;){if(ce===w){K=!0,w=L,k=P;break}if(ce===k){K=!0,k=L,w=P;break}ce=ce.sibling}if(!K)throw Error(n(189))}}if(w.alternate!==k)throw Error(n(190))}if(w.tag!==3)throw Error(n(188));return w.stateNode.current===w?d:p}function Le(d){return d=Pe(d),d!==null?De(d):null}function De(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=De(d);if(p!==null)return p;d=d.sibling}return null}var at=e.unstable_scheduleCallback,gt=e.unstable_cancelCallback,Rt=e.unstable_shouldYield,ct=e.unstable_requestPaint,ut=e.unstable_now,wn=e.unstable_getCurrentPriorityLevel,Ar=e.unstable_ImmediatePriority,Lr=e.unstable_UserBlockingPriority,mi=e.unstable_NormalPriority,pu=e.unstable_LowPriority,mc=e.unstable_IdlePriority,Il=null,ns=null;function Tp(d){if(ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(Il,d,void 0,(d.current.flags&128)===128)}catch{}}var ki=Math.clz32?Math.clz32:r0,gh=Math.log,gc=Math.LN2;function r0(d){return d>>>=0,d===0?32:31-(gh(d)/gc|0)|0}var yh=64,kp=4194304;function yr(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function jd(d,p){var w=d.pendingLanes;if(w===0)return 0;var k=0,P=d.suspendedLanes,L=d.pingedLanes,K=w&268435455;if(K!==0){var ce=K&~P;ce!==0?k=yr(ce):(L&=K,L!==0&&(k=yr(L)))}else K=w&~P,K!==0?k=yr(K):L!==0&&(k=yr(L));if(k===0)return 0;if(p!==0&&p!==k&&(p&P)===0&&(P=k&-k,L=p&-p,P>=L||P===16&&(L&4194240)!==0))return p;if((k&4)!==0&&(k|=w&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=k;0<p;)w=31-ki(p),P=1<<w,k|=d[w],p&=~P;return k}function i0(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s0(d,p){for(var w=d.suspendedLanes,k=d.pingedLanes,P=d.expirationTimes,L=d.pendingLanes;0<L;){var K=31-ki(L),ce=1<<K,he=P[K];he===-1?((ce&w)===0||(ce&k)!==0)&&(P[K]=i0(ce,p)):he<=p&&(d.expiredLanes|=ce),L&=~ce}}function gb(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function yb(){var d=yh;return yh<<=1,(yh&4194240)===0&&(yh=64),d}function vb(d){for(var p=[],w=0;31>w;w++)p.push(d);return p}function o0(d,p,w){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-ki(p),d[p]=w}function pL(d,p){var w=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var k=d.eventTimes;for(d=d.expirationTimes;0<w;){var P=31-ki(w),L=1<<P;p[P]=0,k[P]=-1,d[P]=-1,w&=~L}}function _b(d,p){var w=d.entangledLanes|=p;for(d=d.entanglements;w;){var k=31-ki(w),P=1<<k;P&p|d[k]&p&&(d[k]|=p),w&=~P}}var nr=0;function vh(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var xb,gv,wb,bb,Eb,_h=!1,yv=[],xh=null,wh=null,mo=null,a0=new Map,Fd=new Map,Rl=[],zI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ap(d,p){switch(d){case"focusin":case"focusout":xh=null;break;case"dragenter":case"dragleave":wh=null;break;case"mouseover":case"mouseout":mo=null;break;case"pointerover":case"pointerout":a0.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fd.delete(p.pointerId)}}function mu(d,p,w,k,P,L){return d===null||d.nativeEvent!==L?(d={blockedOn:p,domEventName:w,eventSystemFlags:k,nativeEvent:L,targetContainers:[P]},p!==null&&(p=$b(p),p!==null&&gv(p)),d):(d.eventSystemFlags|=k,p=d.targetContainers,P!==null&&p.indexOf(P)===-1&&p.push(P),d)}function UI(d,p,w,k,P){switch(p){case"focusin":return xh=mu(xh,d,p,w,k,P),!0;case"dragenter":return wh=mu(wh,d,p,w,k,P),!0;case"mouseover":return mo=mu(mo,d,p,w,k,P),!0;case"pointerover":var L=P.pointerId;return a0.set(L,mu(a0.get(L)||null,d,p,w,k,P)),!0;case"gotpointercapture":return L=P.pointerId,Fd.set(L,mu(Fd.get(L)||null,d,p,w,k,P)),!0}return!1}function vv(d){var p=h0(d.target);if(p!==null){var w=oe(p);if(w!==null){if(p=w.tag,p===13){if(p=Ce(w),p!==null){d.blockedOn=p,Eb(d.priority,function(){wb(w)});return}}else if(p===3&&w.stateNode.current.memoizedState.isDehydrated){d.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Zr(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var w=_v(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(w===null){w=d.nativeEvent;var k=new w.constructor(w.type,w);Ie=k,w.target.dispatchEvent(k),Ie=null}else return p=$b(w),p!==null&&gv(p),d.blockedOn=w,!1;p.shift()}return!0}function GI(d,p,w){Zr(d)&&w.delete(p)}function mL(){_h=!1,xh!==null&&Zr(xh)&&(xh=null),wh!==null&&Zr(wh)&&(wh=null),mo!==null&&Zr(mo)&&(mo=null),a0.forEach(GI),Fd.forEach(GI)}function Ip(d,p){d.blockedOn===p&&(d.blockedOn=null,_h||(_h=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,mL)))}function Rp(d){function p(P){return Ip(P,d)}if(0<yv.length){Ip(yv[0],d);for(var w=1;w<yv.length;w++){var k=yv[w];k.blockedOn===d&&(k.blockedOn=null)}}for(xh!==null&&Ip(xh,d),wh!==null&&Ip(wh,d),mo!==null&&Ip(mo,d),a0.forEach(p),Fd.forEach(p),w=0;w<Rl.length;w++)k=Rl[w],k.blockedOn===d&&(k.blockedOn=null);for(;0<Rl.length&&(w=Rl[0],w.blockedOn===null);)vv(w),w.blockedOn===null&&Rl.shift()}var Vd=R.ReactCurrentBatchConfig,zd=!0;function bh(d,p,w,k){var P=nr,L=Vd.transition;Vd.transition=null;try{nr=1,Sb(d,p,w,k)}finally{nr=P,Vd.transition=L}}function BI(d,p,w,k){var P=nr,L=Vd.transition;Vd.transition=null;try{nr=4,Sb(d,p,w,k)}finally{nr=P,Vd.transition=L}}function Sb(d,p,w,k){if(zd){var P=_v(d,p,w,k);if(P===null)kL(d,p,k,Eh,w),Ap(d,k);else if(UI(P,d,p,w,k))k.stopPropagation();else if(Ap(d,k),p&4&&-1<zI.indexOf(d)){for(;P!==null;){var L=$b(P);if(L!==null&&xb(L),L=_v(d,p,w,k),L===null&&kL(d,p,k,Eh,w),L===P)break;P=L}P!==null&&k.stopPropagation()}else kL(d,p,k,null,w)}}var Eh=null;function _v(d,p,w,k){if(Eh=null,d=Re(k),d=h0(d),d!==null)if(p=oe(d),p===null)d=null;else if(w=p.tag,w===13){if(d=Ce(p),d!==null)return d;d=null}else if(w===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return Eh=d,null}function xv(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wn()){case Ar:return 1;case Lr:return 4;case mi:case pu:return 16;case mc:return 536870912;default:return 16}default:return 16}}var Pl=null,wv=null,Ud=null;function WI(){if(Ud)return Ud;var d,p=wv,w=p.length,k,P="value"in Pl?Pl.value:Pl.textContent,L=P.length;for(d=0;d<w&&p[d]===P[d];d++);var K=w-d;for(k=1;k<=K&&p[w-k]===P[L-k];k++);return Ud=P.slice(d,1<k?1-k:void 0)}function l0(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function Sh(){return!0}function Tb(){return!1}function Lo(d){function p(w,k,P,L,K){this._reactName=w,this._targetInst=P,this.type=k,this.nativeEvent=L,this.target=K,this.currentTarget=null;for(var ce in d)d.hasOwnProperty(ce)&&(w=d[ce],this[ce]=w?w(L):L[ce]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?Sh:Tb,this.isPropagationStopped=Tb,this}return Ae(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=Sh)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=Sh)},persist:function(){},isPersistent:Sh}),p}var Th={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},c0=Lo(Th),Pp=Ae({},Th,{view:0,detail:0}),bv=Lo(Pp),Ev,Sv,Cl,u0=Ae({},Pp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Cl&&(Cl&&d.type==="mousemove"?(Ev=d.screenX-Cl.screenX,Sv=d.screenY-Cl.screenY):Sv=Ev=0,Cl=d),Ev)},movementY:function(d){return"movementY"in d?d.movementY:Sv}}),kb=Lo(u0),HI=Ae({},u0,{dataTransfer:0}),qI=Lo(HI),Tv=Ae({},Pp,{relatedTarget:0}),go=Lo(Tv),KI=Ae({},Th,{animationName:0,elapsedTime:0,pseudoElement:0}),YI=Lo(KI),Cp=Ae({},Th,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),S=Lo(Cp),D=Ae({},Th,{data:0}),G=Lo(D),Z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ve={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _t(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=Ve[d])?!!p[d]:!1}function Cn(){return _t}var rs=Ae({},Pp,{key:function(d){if(d.key){var p=Z[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=l0(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Ee[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(d){return d.type==="keypress"?l0(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?l0(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Dr=Lo(rs),ds=Ae({},u0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ml=Lo(ds),Gd=Ae({},Pp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn}),kh=Lo(Gd),Ah=Ae({},Th,{propertyName:0,elapsedTime:0,pseudoElement:0}),kv=Lo(Ah),Ab=Ae({},u0,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),dEe=Lo(Ab),fEe=[9,13,27,32],gL=a&&"CompositionEvent"in window,Ib=null;a&&"documentMode"in document&&(Ib=document.documentMode);var pEe=a&&"TextEvent"in window&&!Ib,QH=a&&(!gL||Ib&&8<Ib&&11>=Ib),eq=" ",tq=!1;function nq(d,p){switch(d){case"keyup":return fEe.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rq(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Av=!1;function mEe(d,p){switch(d){case"compositionend":return rq(p);case"keypress":return p.which!==32?null:(tq=!0,eq);case"textInput":return d=p.data,d===eq&&tq?null:d;default:return null}}function gEe(d,p){if(Av)return d==="compositionend"||!gL&&nq(d,p)?(d=WI(),Ud=wv=Pl=null,Av=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return QH&&p.locale!=="ko"?null:p.data;default:return null}}var yEe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function iq(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!yEe[d.type]:p==="textarea"}function sq(d,p,w,k){ae(k),p=eR(p,"onChange"),0<p.length&&(w=new c0("onChange","change",null,w,k),d.push({event:w,listeners:p}))}var Rb=null,Pb=null;function vEe(d){Eq(d,0)}function XI(d){var p=Mv(d);if(Ye(p))return d}function _Ee(d,p){if(d==="change")return p}var oq=!1;if(a){var yL;if(a){var vL="oninput"in document;if(!vL){var aq=document.createElement("div");aq.setAttribute("oninput","return;"),vL=typeof aq.oninput=="function"}yL=vL}else yL=!1;oq=yL&&(!document.documentMode||9<document.documentMode)}function lq(){Rb&&(Rb.detachEvent("onpropertychange",cq),Pb=Rb=null)}function cq(d){if(d.propertyName==="value"&&XI(Pb)){var p=[];sq(p,Pb,d,Re(d)),Je(vEe,p)}}function xEe(d,p,w){d==="focusin"?(lq(),Rb=p,Pb=w,Rb.attachEvent("onpropertychange",cq)):d==="focusout"&&lq()}function wEe(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return XI(Pb)}function bEe(d,p){if(d==="click")return XI(p)}function EEe(d,p){if(d==="input"||d==="change")return XI(p)}function SEe(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var gu=typeof Object.is=="function"?Object.is:SEe;function Cb(d,p){if(gu(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var w=Object.keys(d),k=Object.keys(p);if(w.length!==k.length)return!1;for(k=0;k<w.length;k++){var P=w[k];if(!l.call(p,P)||!gu(d[P],p[P]))return!1}return!0}function uq(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function hq(d,p){var w=uq(d);d=0;for(var k;w;){if(w.nodeType===3){if(k=d+w.textContent.length,d<=p&&k>=p)return{node:w,offset:p-d};d=k}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=uq(w)}}function dq(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?dq(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function fq(){for(var d=window,p=sn();p instanceof d.HTMLIFrameElement;){try{var w=typeof p.contentWindow.location.href=="string"}catch{w=!1}if(w)d=p.contentWindow;else break;p=sn(d.document)}return p}function _L(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function TEe(d){var p=fq(),w=d.focusedElem,k=d.selectionRange;if(p!==w&&w&&w.ownerDocument&&dq(w.ownerDocument.documentElement,w)){if(k!==null&&_L(w)){if(p=k.start,d=k.end,d===void 0&&(d=p),"selectionStart"in w)w.selectionStart=p,w.selectionEnd=Math.min(d,w.value.length);else if(d=(p=w.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var P=w.textContent.length,L=Math.min(k.start,P);k=k.end===void 0?L:Math.min(k.end,P),!d.extend&&L>k&&(P=k,k=L,L=P),P=hq(w,L);var K=hq(w,k);P&&K&&(d.rangeCount!==1||d.anchorNode!==P.node||d.anchorOffset!==P.offset||d.focusNode!==K.node||d.focusOffset!==K.offset)&&(p=p.createRange(),p.setStart(P.node,P.offset),d.removeAllRanges(),L>k?(d.addRange(p),d.extend(K.node,K.offset)):(p.setEnd(K.node,K.offset),d.addRange(p)))}}for(p=[],d=w;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<p.length;w++)d=p[w],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var kEe=a&&"documentMode"in document&&11>=document.documentMode,Iv=null,xL=null,Mb=null,wL=!1;function pq(d,p,w){var k=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;wL||Iv==null||Iv!==sn(k)||(k=Iv,"selectionStart"in k&&_L(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Mb&&Cb(Mb,k)||(Mb=k,k=eR(xL,"onSelect"),0<k.length&&(p=new c0("onSelect","select",null,p,w),d.push({event:p,listeners:k}),p.target=Iv)))}function ZI(d,p){var w={};return w[d.toLowerCase()]=p.toLowerCase(),w["Webkit"+d]="webkit"+p,w["Moz"+d]="moz"+p,w}var Rv={animationend:ZI("Animation","AnimationEnd"),animationiteration:ZI("Animation","AnimationIteration"),animationstart:ZI("Animation","AnimationStart"),transitionend:ZI("Transition","TransitionEnd")},bL={},mq={};a&&(mq=document.createElement("div").style,"AnimationEvent"in window||(delete Rv.animationend.animation,delete Rv.animationiteration.animation,delete Rv.animationstart.animation),"TransitionEvent"in window||delete Rv.transitionend.transition);function JI(d){if(bL[d])return bL[d];if(!Rv[d])return d;var p=Rv[d],w;for(w in p)if(p.hasOwnProperty(w)&&w in mq)return bL[d]=p[w];return d}var gq=JI("animationend"),yq=JI("animationiteration"),vq=JI("animationstart"),_q=JI("transitionend"),xq=new Map,wq="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mp(d,p){xq.set(d,p),s(p,[d])}for(var EL=0;EL<wq.length;EL++){var SL=wq[EL],AEe=SL.toLowerCase(),IEe=SL[0].toUpperCase()+SL.slice(1);Mp(AEe,"on"+IEe)}Mp(gq,"onAnimationEnd"),Mp(yq,"onAnimationIteration"),Mp(vq,"onAnimationStart"),Mp("dblclick","onDoubleClick"),Mp("focusin","onFocus"),Mp("focusout","onBlur"),Mp(_q,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),REe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nb));function bq(d,p,w){var k=d.type||"unknown-event";d.currentTarget=w,se(k,p,void 0,d),d.currentTarget=null}function Eq(d,p){p=(p&4)!==0;for(var w=0;w<d.length;w++){var k=d[w],P=k.event;k=k.listeners;e:{var L=void 0;if(p)for(var K=k.length-1;0<=K;K--){var ce=k[K],he=ce.instance,Fe=ce.currentTarget;if(ce=ce.listener,he!==L&&P.isPropagationStopped())break e;bq(P,ce,Fe),L=he}else for(K=0;K<k.length;K++){if(ce=k[K],he=ce.instance,Fe=ce.currentTarget,ce=ce.listener,he!==L&&P.isPropagationStopped())break e;bq(P,ce,Fe),L=he}}}if(q)throw d=re,q=!1,re=null,d}function si(d,p){var w=p[ML];w===void 0&&(w=p[ML]=new Set);var k=d+"__bubble";w.has(k)||(Sq(p,d,2,!1),w.add(k))}function TL(d,p,w){var k=0;p&&(k|=4),Sq(w,d,k,p)}var QI="_reactListening"+Math.random().toString(36).slice(2);function Ob(d){if(!d[QI]){d[QI]=!0,r.forEach(function(w){w!=="selectionchange"&&(REe.has(w)||TL(w,!1,d),TL(w,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[QI]||(p[QI]=!0,TL("selectionchange",!1,p))}}function Sq(d,p,w,k){switch(xv(p)){case 1:var P=bh;break;case 4:P=BI;break;default:P=Sb}w=P.bind(null,p,w,d),P=void 0,!nt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(P=!0),k?P!==void 0?d.addEventListener(p,w,{capture:!0,passive:P}):d.addEventListener(p,w,!0):P!==void 0?d.addEventListener(p,w,{passive:P}):d.addEventListener(p,w,!1)}function kL(d,p,w,k,P){var L=k;if((p&1)===0&&(p&2)===0&&k!==null)e:for(;;){if(k===null)return;var K=k.tag;if(K===3||K===4){var ce=k.stateNode.containerInfo;if(ce===P||ce.nodeType===8&&ce.parentNode===P)break;if(K===4)for(K=k.return;K!==null;){var he=K.tag;if((he===3||he===4)&&(he=K.stateNode.containerInfo,he===P||he.nodeType===8&&he.parentNode===P))return;K=K.return}for(;ce!==null;){if(K=h0(ce),K===null)return;if(he=K.tag,he===5||he===6){k=L=K;continue e}ce=ce.parentNode}}k=k.return}Je(function(){var Fe=L,ot=Re(w),ht=[];e:{var rt=xq.get(d);if(rt!==void 0){var Nt=c0,Ut=d;switch(d){case"keypress":if(l0(w)===0)break e;case"keydown":case"keyup":Nt=Dr;break;case"focusin":Ut="focus",Nt=go;break;case"focusout":Ut="blur",Nt=go;break;case"beforeblur":case"afterblur":Nt=go;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Nt=kb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Nt=qI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Nt=kh;break;case gq:case yq:case vq:Nt=YI;break;case _q:Nt=kv;break;case"scroll":Nt=bv;break;case"wheel":Nt=dEe;break;case"copy":case"cut":case"paste":Nt=S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Nt=Ml}var Yt=(p&4)!==0,is=!Yt&&d==="scroll",be=Yt?rt!==null?rt+"Capture":null:rt;Yt=[];for(var me=Fe,Me;me!==null;){Me=me;var mt=Me.stateNode;if(Me.tag===5&&mt!==null&&(Me=mt,be!==null&&(mt=Ue(me,be),mt!=null&&Yt.push(Lb(me,mt,Me)))),is)break;me=me.return}0<Yt.length&&(rt=new Nt(rt,Ut,null,w,ot),ht.push({event:rt,listeners:Yt}))}}if((p&7)===0){e:{if(rt=d==="mouseover"||d==="pointerover",Nt=d==="mouseout"||d==="pointerout",rt&&w!==Ie&&(Ut=w.relatedTarget||w.fromElement)&&(h0(Ut)||Ut[Bd]))break e;if((Nt||rt)&&(rt=ot.window===ot?ot:(rt=ot.ownerDocument)?rt.defaultView||rt.parentWindow:window,Nt?(Ut=w.relatedTarget||w.toElement,Nt=Fe,Ut=Ut?h0(Ut):null,Ut!==null&&(is=oe(Ut),Ut!==is||Ut.tag!==5&&Ut.tag!==6)&&(Ut=null)):(Nt=null,Ut=Fe),Nt!==Ut)){if(Yt=kb,mt="onMouseLeave",be="onMouseEnter",me="mouse",(d==="pointerout"||d==="pointerover")&&(Yt=Ml,mt="onPointerLeave",be="onPointerEnter",me="pointer"),is=Nt==null?rt:Mv(Nt),Me=Ut==null?rt:Mv(Ut),rt=new Yt(mt,me+"leave",Nt,w,ot),rt.target=is,rt.relatedTarget=Me,mt=null,h0(ot)===Fe&&(Yt=new Yt(be,me+"enter",Ut,w,ot),Yt.target=Me,Yt.relatedTarget=is,mt=Yt),is=mt,Nt&&Ut)t:{for(Yt=Nt,be=Ut,me=0,Me=Yt;Me;Me=Pv(Me))me++;for(Me=0,mt=be;mt;mt=Pv(mt))Me++;for(;0<me-Me;)Yt=Pv(Yt),me--;for(;0<Me-me;)be=Pv(be),Me--;for(;me--;){if(Yt===be||be!==null&&Yt===be.alternate)break t;Yt=Pv(Yt),be=Pv(be)}Yt=null}else Yt=null;Nt!==null&&Tq(ht,rt,Nt,Yt,!1),Ut!==null&&is!==null&&Tq(ht,is,Ut,Yt,!0)}}e:{if(rt=Fe?Mv(Fe):window,Nt=rt.nodeName&&rt.nodeName.toLowerCase(),Nt==="select"||Nt==="input"&&rt.type==="file")var Zt=_Ee;else if(iq(rt))if(oq)Zt=EEe;else{Zt=wEe;var cn=xEe}else(Nt=rt.nodeName)&&Nt.toLowerCase()==="input"&&(rt.type==="checkbox"||rt.type==="radio")&&(Zt=bEe);if(Zt&&(Zt=Zt(d,Fe))){sq(ht,Zt,w,ot);break e}cn&&cn(d,rt,Fe),d==="focusout"&&(cn=rt._wrapperState)&&cn.controlled&&rt.type==="number"&&$n(rt,"number",rt.value)}switch(cn=Fe?Mv(Fe):window,d){case"focusin":(iq(cn)||cn.contentEditable==="true")&&(Iv=cn,xL=Fe,Mb=null);break;case"focusout":Mb=xL=Iv=null;break;case"mousedown":wL=!0;break;case"contextmenu":case"mouseup":case"dragend":wL=!1,pq(ht,w,ot);break;case"selectionchange":if(kEe)break;case"keydown":case"keyup":pq(ht,w,ot)}var un;if(gL)e:{switch(d){case"compositionstart":var bn="onCompositionStart";break e;case"compositionend":bn="onCompositionEnd";break e;case"compositionupdate":bn="onCompositionUpdate";break e}bn=void 0}else Av?nq(d,w)&&(bn="onCompositionEnd"):d==="keydown"&&w.keyCode===229&&(bn="onCompositionStart");bn&&(QH&&w.locale!=="ko"&&(Av||bn!=="onCompositionStart"?bn==="onCompositionEnd"&&Av&&(un=WI()):(Pl=ot,wv="value"in Pl?Pl.value:Pl.textContent,Av=!0)),cn=eR(Fe,bn),0<cn.length&&(bn=new G(bn,d,null,w,ot),ht.push({event:bn,listeners:cn}),un?bn.data=un:(un=rq(w),un!==null&&(bn.data=un)))),(un=pEe?mEe(d,w):gEe(d,w))&&(Fe=eR(Fe,"onBeforeInput"),0<Fe.length&&(ot=new G("onBeforeInput","beforeinput",null,w,ot),ht.push({event:ot,listeners:Fe}),ot.data=un))}Eq(ht,p)})}function Lb(d,p,w){return{instance:d,listener:p,currentTarget:w}}function eR(d,p){for(var w=p+"Capture",k=[];d!==null;){var P=d,L=P.stateNode;P.tag===5&&L!==null&&(P=L,L=Ue(d,w),L!=null&&k.unshift(Lb(d,L,P)),L=Ue(d,p),L!=null&&k.push(Lb(d,L,P))),d=d.return}return k}function Pv(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function Tq(d,p,w,k,P){for(var L=p._reactName,K=[];w!==null&&w!==k;){var ce=w,he=ce.alternate,Fe=ce.stateNode;if(he!==null&&he===k)break;ce.tag===5&&Fe!==null&&(ce=Fe,P?(he=Ue(w,L),he!=null&&K.unshift(Lb(w,he,ce))):P||(he=Ue(w,L),he!=null&&K.push(Lb(w,he,ce)))),w=w.return}K.length!==0&&d.push({event:p,listeners:K})}var PEe=/\r\n?/g,CEe=/\u0000|\uFFFD/g;function kq(d){return(typeof d=="string"?d:""+d).replace(PEe,`
`).replace(CEe,"")}function tR(d,p,w){if(p=kq(p),kq(d)!==p&&w)throw Error(n(425))}function nR(){}var AL=null,IL=null;function RL(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var PL=typeof setTimeout=="function"?setTimeout:void 0,MEe=typeof clearTimeout=="function"?clearTimeout:void 0,Aq=typeof Promise=="function"?Promise:void 0,NEe=typeof queueMicrotask=="function"?queueMicrotask:typeof Aq<"u"?function(d){return Aq.resolve(null).then(d).catch(OEe)}:PL;function OEe(d){setTimeout(function(){throw d})}function CL(d,p){var w=p,k=0;do{var P=w.nextSibling;if(d.removeChild(w),P&&P.nodeType===8)if(w=P.data,w==="/$"){if(k===0){d.removeChild(P),Rp(p);return}k--}else w!=="$"&&w!=="$?"&&w!=="$!"||k++;w=P}while(w);Rp(p)}function Np(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function Iq(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var w=d.data;if(w==="$"||w==="$!"||w==="$?"){if(p===0)return d;p--}else w==="/$"&&p++}d=d.previousSibling}return null}var Cv=Math.random().toString(36).slice(2),Ih="__reactFiber$"+Cv,Db="__reactProps$"+Cv,Bd="__reactContainer$"+Cv,ML="__reactEvents$"+Cv,LEe="__reactListeners$"+Cv,DEe="__reactHandles$"+Cv;function h0(d){var p=d[Ih];if(p)return p;for(var w=d.parentNode;w;){if(p=w[Bd]||w[Ih]){if(w=p.alternate,p.child!==null||w!==null&&w.child!==null)for(d=Iq(d);d!==null;){if(w=d[Ih])return w;d=Iq(d)}return p}d=w,w=d.parentNode}return null}function $b(d){return d=d[Ih]||d[Bd],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Mv(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(n(33))}function rR(d){return d[Db]||null}var NL=[],Nv=-1;function Op(d){return{current:d}}function oi(d){0>Nv||(d.current=NL[Nv],NL[Nv]=null,Nv--)}function ti(d,p){Nv++,NL[Nv]=d.current,d.current=p}var Lp={},Do=Op(Lp),za=Op(!1),d0=Lp;function Ov(d,p){var w=d.type.contextTypes;if(!w)return Lp;var k=d.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===p)return k.__reactInternalMemoizedMaskedChildContext;var P={},L;for(L in w)P[L]=p[L];return k&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=P),P}function Ua(d){return d=d.childContextTypes,d!=null}function iR(){oi(za),oi(Do)}function Rq(d,p,w){if(Do.current!==Lp)throw Error(n(168));ti(Do,p),ti(za,w)}function Pq(d,p,w){var k=d.stateNode;if(p=p.childContextTypes,typeof k.getChildContext!="function")return w;k=k.getChildContext();for(var P in k)if(!(P in p))throw Error(n(108,qe(d)||"Unknown",P));return Ae({},w,k)}function sR(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Lp,d0=Do.current,ti(Do,d),ti(za,za.current),!0}function Cq(d,p,w){var k=d.stateNode;if(!k)throw Error(n(169));w?(d=Pq(d,p,d0),k.__reactInternalMemoizedMergedChildContext=d,oi(za),oi(Do),ti(Do,d)):oi(za),ti(za,w)}var Wd=null,oR=!1,OL=!1;function Mq(d){Wd===null?Wd=[d]:Wd.push(d)}function $Ee(d){oR=!0,Mq(d)}function Dp(){if(!OL&&Wd!==null){OL=!0;var d=0,p=nr;try{var w=Wd;for(nr=1;d<w.length;d++){var k=w[d];do k=k(!0);while(k!==null)}Wd=null,oR=!1}catch(P){throw Wd!==null&&(Wd=Wd.slice(d+1)),at(Ar,Dp),P}finally{nr=p,OL=!1}}return null}var Lv=[],Dv=0,aR=null,lR=0,yc=[],vc=0,f0=null,Hd=1,qd="";function p0(d,p){Lv[Dv++]=lR,Lv[Dv++]=aR,aR=d,lR=p}function Nq(d,p,w){yc[vc++]=Hd,yc[vc++]=qd,yc[vc++]=f0,f0=d;var k=Hd;d=qd;var P=32-ki(k)-1;k&=~(1<<P),w+=1;var L=32-ki(p)+P;if(30<L){var K=P-P%5;L=(k&(1<<K)-1).toString(32),k>>=K,P-=K,Hd=1<<32-ki(p)+P|w<<P|k,qd=L+d}else Hd=1<<L|w<<P|k,qd=d}function LL(d){d.return!==null&&(p0(d,1),Nq(d,1,0))}function DL(d){for(;d===aR;)aR=Lv[--Dv],Lv[Dv]=null,lR=Lv[--Dv],Lv[Dv]=null;for(;d===f0;)f0=yc[--vc],yc[vc]=null,qd=yc[--vc],yc[vc]=null,Hd=yc[--vc],yc[vc]=null}var Nl=null,Ol=null,gi=!1,yu=null;function Oq(d,p){var w=bc(5,null,null,0);w.elementType="DELETED",w.stateNode=p,w.return=d,p=d.deletions,p===null?(d.deletions=[w],d.flags|=16):p.push(w)}function Lq(d,p){switch(d.tag){case 5:var w=d.type;return p=p.nodeType!==1||w.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Nl=d,Ol=Np(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Nl=d,Ol=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(w=f0!==null?{id:Hd,overflow:qd}:null,d.memoizedState={dehydrated:p,treeContext:w,retryLane:1073741824},w=bc(18,null,null,0),w.stateNode=p,w.return=d,d.child=w,Nl=d,Ol=null,!0):!1;default:return!1}}function $L(d){return(d.mode&1)!==0&&(d.flags&128)===0}function jL(d){if(gi){var p=Ol;if(p){var w=p;if(!Lq(d,p)){if($L(d))throw Error(n(418));p=Np(w.nextSibling);var k=Nl;p&&Lq(d,p)?Oq(k,w):(d.flags=d.flags&-4097|2,gi=!1,Nl=d)}}else{if($L(d))throw Error(n(418));d.flags=d.flags&-4097|2,gi=!1,Nl=d}}}function Dq(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Nl=d}function cR(d){if(d!==Nl)return!1;if(!gi)return Dq(d),gi=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!RL(d.type,d.memoizedProps)),p&&(p=Ol)){if($L(d))throw $q(),Error(n(418));for(;p;)Oq(d,p),p=Np(p.nextSibling)}if(Dq(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var w=d.data;if(w==="/$"){if(p===0){Ol=Np(d.nextSibling);break e}p--}else w!=="$"&&w!=="$!"&&w!=="$?"||p++}d=d.nextSibling}Ol=null}}else Ol=Nl?Np(d.stateNode.nextSibling):null;return!0}function $q(){for(var d=Ol;d;)d=Np(d.nextSibling)}function $v(){Ol=Nl=null,gi=!1}function FL(d){yu===null?yu=[d]:yu.push(d)}var jEe=R.ReactCurrentBatchConfig;function jb(d,p,w){if(d=w.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(n(309));var k=w.stateNode}if(!k)throw Error(n(147,d));var P=k,L=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===L?p.ref:(p=function(K){var ce=P.refs;K===null?delete ce[L]:ce[L]=K},p._stringRef=L,p)}if(typeof d!="string")throw Error(n(284));if(!w._owner)throw Error(n(290,d))}return d}function uR(d,p){throw d=Object.prototype.toString.call(p),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function jq(d){var p=d._init;return p(d._payload)}function Fq(d){function p(be,me){if(d){var Me=be.deletions;Me===null?(be.deletions=[me],be.flags|=16):Me.push(me)}}function w(be,me){if(!d)return null;for(;me!==null;)p(be,me),me=me.sibling;return null}function k(be,me){for(be=new Map;me!==null;)me.key!==null?be.set(me.key,me):be.set(me.index,me),me=me.sibling;return be}function P(be,me){return be=Bp(be,me),be.index=0,be.sibling=null,be}function L(be,me,Me){return be.index=Me,d?(Me=be.alternate,Me!==null?(Me=Me.index,Me<me?(be.flags|=2,me):Me):(be.flags|=2,me)):(be.flags|=1048576,me)}function K(be){return d&&be.alternate===null&&(be.flags|=2),be}function ce(be,me,Me,mt){return me===null||me.tag!==6?(me=PD(Me,be.mode,mt),me.return=be,me):(me=P(me,Me),me.return=be,me)}function he(be,me,Me,mt){var Zt=Me.type;return Zt===C?ot(be,me,Me.props.children,mt,Me.key):me!==null&&(me.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===Se&&jq(Zt)===me.type)?(mt=P(me,Me.props),mt.ref=jb(be,me,Me),mt.return=be,mt):(mt=OR(Me.type,Me.key,Me.props,null,be.mode,mt),mt.ref=jb(be,me,Me),mt.return=be,mt)}function Fe(be,me,Me,mt){return me===null||me.tag!==4||me.stateNode.containerInfo!==Me.containerInfo||me.stateNode.implementation!==Me.implementation?(me=CD(Me,be.mode,mt),me.return=be,me):(me=P(me,Me.children||[]),me.return=be,me)}function ot(be,me,Me,mt,Zt){return me===null||me.tag!==7?(me=b0(Me,be.mode,mt,Zt),me.return=be,me):(me=P(me,Me),me.return=be,me)}function ht(be,me,Me){if(typeof me=="string"&&me!==""||typeof me=="number")return me=PD(""+me,be.mode,Me),me.return=be,me;if(typeof me=="object"&&me!==null){switch(me.$$typeof){case M:return Me=OR(me.type,me.key,me.props,null,be.mode,Me),Me.ref=jb(be,null,me),Me.return=be,Me;case F:return me=CD(me,be.mode,Me),me.return=be,me;case Se:var mt=me._init;return ht(be,mt(me._payload),Me)}if(Un(me)||Oe(me))return me=b0(me,be.mode,Me,null),me.return=be,me;uR(be,me)}return null}function rt(be,me,Me,mt){var Zt=me!==null?me.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Zt!==null?null:ce(be,me,""+Me,mt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case M:return Me.key===Zt?he(be,me,Me,mt):null;case F:return Me.key===Zt?Fe(be,me,Me,mt):null;case Se:return Zt=Me._init,rt(be,me,Zt(Me._payload),mt)}if(Un(Me)||Oe(Me))return Zt!==null?null:ot(be,me,Me,mt,null);uR(be,Me)}return null}function Nt(be,me,Me,mt,Zt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return be=be.get(Me)||null,ce(me,be,""+mt,Zt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case M:return be=be.get(mt.key===null?Me:mt.key)||null,he(me,be,mt,Zt);case F:return be=be.get(mt.key===null?Me:mt.key)||null,Fe(me,be,mt,Zt);case Se:var cn=mt._init;return Nt(be,me,Me,cn(mt._payload),Zt)}if(Un(mt)||Oe(mt))return be=be.get(Me)||null,ot(me,be,mt,Zt,null);uR(me,mt)}return null}function Ut(be,me,Me,mt){for(var Zt=null,cn=null,un=me,bn=me=0,Ks=null;un!==null&&bn<Me.length;bn++){un.index>bn?(Ks=un,un=null):Ks=un.sibling;var fr=rt(be,un,Me[bn],mt);if(fr===null){un===null&&(un=Ks);break}d&&un&&fr.alternate===null&&p(be,un),me=L(fr,me,bn),cn===null?Zt=fr:cn.sibling=fr,cn=fr,un=Ks}if(bn===Me.length)return w(be,un),gi&&p0(be,bn),Zt;if(un===null){for(;bn<Me.length;bn++)un=ht(be,Me[bn],mt),un!==null&&(me=L(un,me,bn),cn===null?Zt=un:cn.sibling=un,cn=un);return gi&&p0(be,bn),Zt}for(un=k(be,un);bn<Me.length;bn++)Ks=Nt(un,be,bn,Me[bn],mt),Ks!==null&&(d&&Ks.alternate!==null&&un.delete(Ks.key===null?bn:Ks.key),me=L(Ks,me,bn),cn===null?Zt=Ks:cn.sibling=Ks,cn=Ks);return d&&un.forEach(function(Wp){return p(be,Wp)}),gi&&p0(be,bn),Zt}function Yt(be,me,Me,mt){var Zt=Oe(Me);if(typeof Zt!="function")throw Error(n(150));if(Me=Zt.call(Me),Me==null)throw Error(n(151));for(var cn=Zt=null,un=me,bn=me=0,Ks=null,fr=Me.next();un!==null&&!fr.done;bn++,fr=Me.next()){un.index>bn?(Ks=un,un=null):Ks=un.sibling;var Wp=rt(be,un,fr.value,mt);if(Wp===null){un===null&&(un=Ks);break}d&&un&&Wp.alternate===null&&p(be,un),me=L(Wp,me,bn),cn===null?Zt=Wp:cn.sibling=Wp,cn=Wp,un=Ks}if(fr.done)return w(be,un),gi&&p0(be,bn),Zt;if(un===null){for(;!fr.done;bn++,fr=Me.next())fr=ht(be,fr.value,mt),fr!==null&&(me=L(fr,me,bn),cn===null?Zt=fr:cn.sibling=fr,cn=fr);return gi&&p0(be,bn),Zt}for(un=k(be,un);!fr.done;bn++,fr=Me.next())fr=Nt(un,be,bn,fr.value,mt),fr!==null&&(d&&fr.alternate!==null&&un.delete(fr.key===null?bn:fr.key),me=L(fr,me,bn),cn===null?Zt=fr:cn.sibling=fr,cn=fr);return d&&un.forEach(function(ySe){return p(be,ySe)}),gi&&p0(be,bn),Zt}function is(be,me,Me,mt){if(typeof Me=="object"&&Me!==null&&Me.type===C&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case M:e:{for(var Zt=Me.key,cn=me;cn!==null;){if(cn.key===Zt){if(Zt=Me.type,Zt===C){if(cn.tag===7){w(be,cn.sibling),me=P(cn,Me.props.children),me.return=be,be=me;break e}}else if(cn.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===Se&&jq(Zt)===cn.type){w(be,cn.sibling),me=P(cn,Me.props),me.ref=jb(be,cn,Me),me.return=be,be=me;break e}w(be,cn);break}else p(be,cn);cn=cn.sibling}Me.type===C?(me=b0(Me.props.children,be.mode,mt,Me.key),me.return=be,be=me):(mt=OR(Me.type,Me.key,Me.props,null,be.mode,mt),mt.ref=jb(be,me,Me),mt.return=be,be=mt)}return K(be);case F:e:{for(cn=Me.key;me!==null;){if(me.key===cn)if(me.tag===4&&me.stateNode.containerInfo===Me.containerInfo&&me.stateNode.implementation===Me.implementation){w(be,me.sibling),me=P(me,Me.children||[]),me.return=be,be=me;break e}else{w(be,me);break}else p(be,me);me=me.sibling}me=CD(Me,be.mode,mt),me.return=be,be=me}return K(be);case Se:return cn=Me._init,is(be,me,cn(Me._payload),mt)}if(Un(Me))return Ut(be,me,Me,mt);if(Oe(Me))return Yt(be,me,Me,mt);uR(be,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,me!==null&&me.tag===6?(w(be,me.sibling),me=P(me,Me),me.return=be,be=me):(w(be,me),me=PD(Me,be.mode,mt),me.return=be,be=me),K(be)):w(be,me)}return is}var jv=Fq(!0),Vq=Fq(!1),hR=Op(null),dR=null,Fv=null,VL=null;function zL(){VL=Fv=dR=null}function UL(d){var p=hR.current;oi(hR),d._currentValue=p}function GL(d,p,w){for(;d!==null;){var k=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,k!==null&&(k.childLanes|=p)):k!==null&&(k.childLanes&p)!==p&&(k.childLanes|=p),d===w)break;d=d.return}}function Vv(d,p){dR=d,VL=Fv=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Ga=!0),d.firstContext=null)}function _c(d){var p=d._currentValue;if(VL!==d)if(d={context:d,memoizedValue:p,next:null},Fv===null){if(dR===null)throw Error(n(308));Fv=d,dR.dependencies={lanes:0,firstContext:d}}else Fv=Fv.next=d;return p}var m0=null;function BL(d){m0===null?m0=[d]:m0.push(d)}function zq(d,p,w,k){var P=p.interleaved;return P===null?(w.next=w,BL(p)):(w.next=P.next,P.next=w),p.interleaved=w,Kd(d,k)}function Kd(d,p){d.lanes|=p;var w=d.alternate;for(w!==null&&(w.lanes|=p),w=d,d=d.return;d!==null;)d.childLanes|=p,w=d.alternate,w!==null&&(w.childLanes|=p),w=d,d=d.return;return w.tag===3?w.stateNode:null}var $p=!1;function WL(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uq(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Yd(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function jp(d,p,w){var k=d.updateQueue;if(k===null)return null;if(k=k.shared,(ur&2)!==0){var P=k.pending;return P===null?p.next=p:(p.next=P.next,P.next=p),k.pending=p,Kd(d,w)}return P=k.interleaved,P===null?(p.next=p,BL(k)):(p.next=P.next,P.next=p),k.interleaved=p,Kd(d,w)}function fR(d,p,w){if(p=p.updateQueue,p!==null&&(p=p.shared,(w&4194240)!==0)){var k=p.lanes;k&=d.pendingLanes,w|=k,p.lanes=w,_b(d,w)}}function Gq(d,p){var w=d.updateQueue,k=d.alternate;if(k!==null&&(k=k.updateQueue,w===k)){var P=null,L=null;if(w=w.firstBaseUpdate,w!==null){do{var K={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};L===null?P=L=K:L=L.next=K,w=w.next}while(w!==null);L===null?P=L=p:L=L.next=p}else P=L=p;w={baseState:k.baseState,firstBaseUpdate:P,lastBaseUpdate:L,shared:k.shared,effects:k.effects},d.updateQueue=w;return}d=w.lastBaseUpdate,d===null?w.firstBaseUpdate=p:d.next=p,w.lastBaseUpdate=p}function pR(d,p,w,k){var P=d.updateQueue;$p=!1;var L=P.firstBaseUpdate,K=P.lastBaseUpdate,ce=P.shared.pending;if(ce!==null){P.shared.pending=null;var he=ce,Fe=he.next;he.next=null,K===null?L=Fe:K.next=Fe,K=he;var ot=d.alternate;ot!==null&&(ot=ot.updateQueue,ce=ot.lastBaseUpdate,ce!==K&&(ce===null?ot.firstBaseUpdate=Fe:ce.next=Fe,ot.lastBaseUpdate=he))}if(L!==null){var ht=P.baseState;K=0,ot=Fe=he=null,ce=L;do{var rt=ce.lane,Nt=ce.eventTime;if((k&rt)===rt){ot!==null&&(ot=ot.next={eventTime:Nt,lane:0,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null});e:{var Ut=d,Yt=ce;switch(rt=p,Nt=w,Yt.tag){case 1:if(Ut=Yt.payload,typeof Ut=="function"){ht=Ut.call(Nt,ht,rt);break e}ht=Ut;break e;case 3:Ut.flags=Ut.flags&-65537|128;case 0:if(Ut=Yt.payload,rt=typeof Ut=="function"?Ut.call(Nt,ht,rt):Ut,rt==null)break e;ht=Ae({},ht,rt);break e;case 2:$p=!0}}ce.callback!==null&&ce.lane!==0&&(d.flags|=64,rt=P.effects,rt===null?P.effects=[ce]:rt.push(ce))}else Nt={eventTime:Nt,lane:rt,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},ot===null?(Fe=ot=Nt,he=ht):ot=ot.next=Nt,K|=rt;if(ce=ce.next,ce===null){if(ce=P.shared.pending,ce===null)break;rt=ce,ce=rt.next,rt.next=null,P.lastBaseUpdate=rt,P.shared.pending=null}}while(!0);if(ot===null&&(he=ht),P.baseState=he,P.firstBaseUpdate=Fe,P.lastBaseUpdate=ot,p=P.shared.interleaved,p!==null){P=p;do K|=P.lane,P=P.next;while(P!==p)}else L===null&&(P.shared.lanes=0);v0|=K,d.lanes=K,d.memoizedState=ht}}function Bq(d,p,w){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var k=d[p],P=k.callback;if(P!==null){if(k.callback=null,k=w,typeof P!="function")throw Error(n(191,P));P.call(k)}}}var Fb={},Rh=Op(Fb),Vb=Op(Fb),zb=Op(Fb);function g0(d){if(d===Fb)throw Error(n(174));return d}function HL(d,p){switch(ti(zb,p),ti(Vb,d),ti(Rh,Fb),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:Yn(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=Yn(p,d)}oi(Rh),ti(Rh,p)}function zv(){oi(Rh),oi(Vb),oi(zb)}function Wq(d){g0(zb.current);var p=g0(Rh.current),w=Yn(p,d.type);p!==w&&(ti(Vb,d),ti(Rh,w))}function qL(d){Vb.current===d&&(oi(Rh),oi(Vb))}var Ai=Op(0);function mR(d){for(var p=d;p!==null;){if(p.tag===13){var w=p.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var KL=[];function YL(){for(var d=0;d<KL.length;d++)KL[d]._workInProgressVersionPrimary=null;KL.length=0}var gR=R.ReactCurrentDispatcher,XL=R.ReactCurrentBatchConfig,y0=0,Ii=null,Cs=null,Hs=null,yR=!1,Ub=!1,Gb=0,FEe=0;function $o(){throw Error(n(321))}function ZL(d,p){if(p===null)return!1;for(var w=0;w<p.length&&w<d.length;w++)if(!gu(d[w],p[w]))return!1;return!0}function JL(d,p,w,k,P,L){if(y0=L,Ii=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,gR.current=d===null||d.memoizedState===null?GEe:BEe,d=w(k,P),Ub){L=0;do{if(Ub=!1,Gb=0,25<=L)throw Error(n(301));L+=1,Hs=Cs=null,p.updateQueue=null,gR.current=WEe,d=w(k,P)}while(Ub)}if(gR.current=xR,p=Cs!==null&&Cs.next!==null,y0=0,Hs=Cs=Ii=null,yR=!1,p)throw Error(n(300));return d}function QL(){var d=Gb!==0;return Gb=0,d}function Ph(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hs===null?Ii.memoizedState=Hs=d:Hs=Hs.next=d,Hs}function xc(){if(Cs===null){var d=Ii.alternate;d=d!==null?d.memoizedState:null}else d=Cs.next;var p=Hs===null?Ii.memoizedState:Hs.next;if(p!==null)Hs=p,Cs=d;else{if(d===null)throw Error(n(310));Cs=d,d={memoizedState:Cs.memoizedState,baseState:Cs.baseState,baseQueue:Cs.baseQueue,queue:Cs.queue,next:null},Hs===null?Ii.memoizedState=Hs=d:Hs=Hs.next=d}return Hs}function Bb(d,p){return typeof p=="function"?p(d):p}function eD(d){var p=xc(),w=p.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=d;var k=Cs,P=k.baseQueue,L=w.pending;if(L!==null){if(P!==null){var K=P.next;P.next=L.next,L.next=K}k.baseQueue=P=L,w.pending=null}if(P!==null){L=P.next,k=k.baseState;var ce=K=null,he=null,Fe=L;do{var ot=Fe.lane;if((y0&ot)===ot)he!==null&&(he=he.next={lane:0,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null}),k=Fe.hasEagerState?Fe.eagerState:d(k,Fe.action);else{var ht={lane:ot,action:Fe.action,hasEagerState:Fe.hasEagerState,eagerState:Fe.eagerState,next:null};he===null?(ce=he=ht,K=k):he=he.next=ht,Ii.lanes|=ot,v0|=ot}Fe=Fe.next}while(Fe!==null&&Fe!==L);he===null?K=k:he.next=ce,gu(k,p.memoizedState)||(Ga=!0),p.memoizedState=k,p.baseState=K,p.baseQueue=he,w.lastRenderedState=k}if(d=w.interleaved,d!==null){P=d;do L=P.lane,Ii.lanes|=L,v0|=L,P=P.next;while(P!==d)}else P===null&&(w.lanes=0);return[p.memoizedState,w.dispatch]}function tD(d){var p=xc(),w=p.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=d;var k=w.dispatch,P=w.pending,L=p.memoizedState;if(P!==null){w.pending=null;var K=P=P.next;do L=d(L,K.action),K=K.next;while(K!==P);gu(L,p.memoizedState)||(Ga=!0),p.memoizedState=L,p.baseQueue===null&&(p.baseState=L),w.lastRenderedState=L}return[L,k]}function Hq(){}function qq(d,p){var w=Ii,k=xc(),P=p(),L=!gu(k.memoizedState,P);if(L&&(k.memoizedState=P,Ga=!0),k=k.queue,nD(Xq.bind(null,w,k,d),[d]),k.getSnapshot!==p||L||Hs!==null&&Hs.memoizedState.tag&1){if(w.flags|=2048,Wb(9,Yq.bind(null,w,k,P,p),void 0,null),qs===null)throw Error(n(349));(y0&30)!==0||Kq(w,p,P)}return P}function Kq(d,p,w){d.flags|=16384,d={getSnapshot:p,value:w},p=Ii.updateQueue,p===null?(p={lastEffect:null,stores:null},Ii.updateQueue=p,p.stores=[d]):(w=p.stores,w===null?p.stores=[d]:w.push(d))}function Yq(d,p,w,k){p.value=w,p.getSnapshot=k,Zq(p)&&Jq(d)}function Xq(d,p,w){return w(function(){Zq(p)&&Jq(d)})}function Zq(d){var p=d.getSnapshot;d=d.value;try{var w=p();return!gu(d,w)}catch{return!0}}function Jq(d){var p=Kd(d,1);p!==null&&wu(p,d,1,-1)}function Qq(d){var p=Ph();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bb,lastRenderedState:d},p.queue=d,d=d.dispatch=UEe.bind(null,Ii,d),[p.memoizedState,d]}function Wb(d,p,w,k){return d={tag:d,create:p,destroy:w,deps:k,next:null},p=Ii.updateQueue,p===null?(p={lastEffect:null,stores:null},Ii.updateQueue=p,p.lastEffect=d.next=d):(w=p.lastEffect,w===null?p.lastEffect=d.next=d:(k=w.next,w.next=d,d.next=k,p.lastEffect=d)),d}function eK(){return xc().memoizedState}function vR(d,p,w,k){var P=Ph();Ii.flags|=d,P.memoizedState=Wb(1|p,w,void 0,k===void 0?null:k)}function _R(d,p,w,k){var P=xc();k=k===void 0?null:k;var L=void 0;if(Cs!==null){var K=Cs.memoizedState;if(L=K.destroy,k!==null&&ZL(k,K.deps)){P.memoizedState=Wb(p,w,L,k);return}}Ii.flags|=d,P.memoizedState=Wb(1|p,w,L,k)}function tK(d,p){return vR(8390656,8,d,p)}function nD(d,p){return _R(2048,8,d,p)}function nK(d,p){return _R(4,2,d,p)}function rK(d,p){return _R(4,4,d,p)}function iK(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function sK(d,p,w){return w=w!=null?w.concat([d]):null,_R(4,4,iK.bind(null,p,d),w)}function rD(){}function oK(d,p){var w=xc();p=p===void 0?null:p;var k=w.memoizedState;return k!==null&&p!==null&&ZL(p,k[1])?k[0]:(w.memoizedState=[d,p],d)}function aK(d,p){var w=xc();p=p===void 0?null:p;var k=w.memoizedState;return k!==null&&p!==null&&ZL(p,k[1])?k[0]:(d=d(),w.memoizedState=[d,p],d)}function lK(d,p,w){return(y0&21)===0?(d.baseState&&(d.baseState=!1,Ga=!0),d.memoizedState=w):(gu(w,p)||(w=yb(),Ii.lanes|=w,v0|=w,d.baseState=!0),p)}function VEe(d,p){var w=nr;nr=w!==0&&4>w?w:4,d(!0);var k=XL.transition;XL.transition={};try{d(!1),p()}finally{nr=w,XL.transition=k}}function cK(){return xc().memoizedState}function zEe(d,p,w){var k=Up(d);if(w={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null},uK(d))hK(p,w);else if(w=zq(d,p,w,k),w!==null){var P=_a();wu(w,d,k,P),dK(w,p,k)}}function UEe(d,p,w){var k=Up(d),P={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null};if(uK(d))hK(p,P);else{var L=d.alternate;if(d.lanes===0&&(L===null||L.lanes===0)&&(L=p.lastRenderedReducer,L!==null))try{var K=p.lastRenderedState,ce=L(K,w);if(P.hasEagerState=!0,P.eagerState=ce,gu(ce,K)){var he=p.interleaved;he===null?(P.next=P,BL(p)):(P.next=he.next,he.next=P),p.interleaved=P;return}}catch{}w=zq(d,p,P,k),w!==null&&(P=_a(),wu(w,d,k,P),dK(w,p,k))}}function uK(d){var p=d.alternate;return d===Ii||p!==null&&p===Ii}function hK(d,p){Ub=yR=!0;var w=d.pending;w===null?p.next=p:(p.next=w.next,w.next=p),d.pending=p}function dK(d,p,w){if((w&4194240)!==0){var k=p.lanes;k&=d.pendingLanes,w|=k,p.lanes=w,_b(d,w)}}var xR={readContext:_c,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useInsertionEffect:$o,useLayoutEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useDeferredValue:$o,useTransition:$o,useMutableSource:$o,useSyncExternalStore:$o,useId:$o,unstable_isNewReconciler:!1},GEe={readContext:_c,useCallback:function(d,p){return Ph().memoizedState=[d,p===void 0?null:p],d},useContext:_c,useEffect:tK,useImperativeHandle:function(d,p,w){return w=w!=null?w.concat([d]):null,vR(4194308,4,iK.bind(null,p,d),w)},useLayoutEffect:function(d,p){return vR(4194308,4,d,p)},useInsertionEffect:function(d,p){return vR(4,2,d,p)},useMemo:function(d,p){var w=Ph();return p=p===void 0?null:p,d=d(),w.memoizedState=[d,p],d},useReducer:function(d,p,w){var k=Ph();return p=w!==void 0?w(p):p,k.memoizedState=k.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},k.queue=d,d=d.dispatch=zEe.bind(null,Ii,d),[k.memoizedState,d]},useRef:function(d){var p=Ph();return d={current:d},p.memoizedState=d},useState:Qq,useDebugValue:rD,useDeferredValue:function(d){return Ph().memoizedState=d},useTransition:function(){var d=Qq(!1),p=d[0];return d=VEe.bind(null,d[1]),Ph().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,w){var k=Ii,P=Ph();if(gi){if(w===void 0)throw Error(n(407));w=w()}else{if(w=p(),qs===null)throw Error(n(349));(y0&30)!==0||Kq(k,p,w)}P.memoizedState=w;var L={value:w,getSnapshot:p};return P.queue=L,tK(Xq.bind(null,k,L,d),[d]),k.flags|=2048,Wb(9,Yq.bind(null,k,L,w,p),void 0,null),w},useId:function(){var d=Ph(),p=qs.identifierPrefix;if(gi){var w=qd,k=Hd;w=(k&~(1<<32-ki(k)-1)).toString(32)+w,p=":"+p+"R"+w,w=Gb++,0<w&&(p+="H"+w.toString(32)),p+=":"}else w=FEe++,p=":"+p+"r"+w.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},BEe={readContext:_c,useCallback:oK,useContext:_c,useEffect:nD,useImperativeHandle:sK,useInsertionEffect:nK,useLayoutEffect:rK,useMemo:aK,useReducer:eD,useRef:eK,useState:function(){return eD(Bb)},useDebugValue:rD,useDeferredValue:function(d){var p=xc();return lK(p,Cs.memoizedState,d)},useTransition:function(){var d=eD(Bb)[0],p=xc().memoizedState;return[d,p]},useMutableSource:Hq,useSyncExternalStore:qq,useId:cK,unstable_isNewReconciler:!1},WEe={readContext:_c,useCallback:oK,useContext:_c,useEffect:nD,useImperativeHandle:sK,useInsertionEffect:nK,useLayoutEffect:rK,useMemo:aK,useReducer:tD,useRef:eK,useState:function(){return tD(Bb)},useDebugValue:rD,useDeferredValue:function(d){var p=xc();return Cs===null?p.memoizedState=d:lK(p,Cs.memoizedState,d)},useTransition:function(){var d=tD(Bb)[0],p=xc().memoizedState;return[d,p]},useMutableSource:Hq,useSyncExternalStore:qq,useId:cK,unstable_isNewReconciler:!1};function vu(d,p){if(d&&d.defaultProps){p=Ae({},p),d=d.defaultProps;for(var w in d)p[w]===void 0&&(p[w]=d[w]);return p}return p}function iD(d,p,w,k){p=d.memoizedState,w=w(k,p),w=w==null?p:Ae({},p,w),d.memoizedState=w,d.lanes===0&&(d.updateQueue.baseState=w)}var wR={isMounted:function(d){return(d=d._reactInternals)?oe(d)===d:!1},enqueueSetState:function(d,p,w){d=d._reactInternals;var k=_a(),P=Up(d),L=Yd(k,P);L.payload=p,w!=null&&(L.callback=w),p=jp(d,L,P),p!==null&&(wu(p,d,P,k),fR(p,d,P))},enqueueReplaceState:function(d,p,w){d=d._reactInternals;var k=_a(),P=Up(d),L=Yd(k,P);L.tag=1,L.payload=p,w!=null&&(L.callback=w),p=jp(d,L,P),p!==null&&(wu(p,d,P,k),fR(p,d,P))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var w=_a(),k=Up(d),P=Yd(w,k);P.tag=2,p!=null&&(P.callback=p),p=jp(d,P,k),p!==null&&(wu(p,d,k,w),fR(p,d,k))}};function fK(d,p,w,k,P,L,K){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(k,L,K):p.prototype&&p.prototype.isPureReactComponent?!Cb(w,k)||!Cb(P,L):!0}function pK(d,p,w){var k=!1,P=Lp,L=p.contextType;return typeof L=="object"&&L!==null?L=_c(L):(P=Ua(p)?d0:Do.current,k=p.contextTypes,L=(k=k!=null)?Ov(d,P):Lp),p=new p(w,L),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=wR,d.stateNode=p,p._reactInternals=d,k&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=P,d.__reactInternalMemoizedMaskedChildContext=L),p}function mK(d,p,w,k){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(w,k),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(w,k),p.state!==d&&wR.enqueueReplaceState(p,p.state,null)}function sD(d,p,w,k){var P=d.stateNode;P.props=w,P.state=d.memoizedState,P.refs={},WL(d);var L=p.contextType;typeof L=="object"&&L!==null?P.context=_c(L):(L=Ua(p)?d0:Do.current,P.context=Ov(d,L)),P.state=d.memoizedState,L=p.getDerivedStateFromProps,typeof L=="function"&&(iD(d,p,L,w),P.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(p=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),p!==P.state&&wR.enqueueReplaceState(P,P.state,null),pR(d,w,P,k),P.state=d.memoizedState),typeof P.componentDidMount=="function"&&(d.flags|=4194308)}function Uv(d,p){try{var w="",k=p;do w+=le(k),k=k.return;while(k);var P=w}catch(L){P=`
Error generating stack: `+L.message+`
`+L.stack}return{value:d,source:p,stack:P,digest:null}}function oD(d,p,w){return{value:d,source:null,stack:w??null,digest:p??null}}function aD(d,p){try{console.error(p.value)}catch(w){setTimeout(function(){throw w})}}var HEe=typeof WeakMap=="function"?WeakMap:Map;function gK(d,p,w){w=Yd(-1,w),w.tag=3,w.payload={element:null};var k=p.value;return w.callback=function(){IR||(IR=!0,bD=k),aD(d,p)},w}function yK(d,p,w){w=Yd(-1,w),w.tag=3;var k=d.type.getDerivedStateFromError;if(typeof k=="function"){var P=p.value;w.payload=function(){return k(P)},w.callback=function(){aD(d,p)}}var L=d.stateNode;return L!==null&&typeof L.componentDidCatch=="function"&&(w.callback=function(){aD(d,p),typeof k!="function"&&(Vp===null?Vp=new Set([this]):Vp.add(this));var K=p.stack;this.componentDidCatch(p.value,{componentStack:K!==null?K:""})}),w}function vK(d,p,w){var k=d.pingCache;if(k===null){k=d.pingCache=new HEe;var P=new Set;k.set(p,P)}else P=k.get(p),P===void 0&&(P=new Set,k.set(p,P));P.has(w)||(P.add(w),d=oSe.bind(null,d,p,w),p.then(d,d))}function _K(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function xK(d,p,w,k,P){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(p=Yd(-1,1),p.tag=2,jp(w,p,1))),w.lanes|=1),d):(d.flags|=65536,d.lanes=P,d)}var qEe=R.ReactCurrentOwner,Ga=!1;function va(d,p,w,k){p.child=d===null?Vq(p,null,w,k):jv(p,d.child,w,k)}function wK(d,p,w,k,P){w=w.render;var L=p.ref;return Vv(p,P),k=JL(d,p,w,k,L,P),w=QL(),d!==null&&!Ga?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~P,Xd(d,p,P)):(gi&&w&&LL(p),p.flags|=1,va(d,p,k,P),p.child)}function bK(d,p,w,k,P){if(d===null){var L=w.type;return typeof L=="function"&&!RD(L)&&L.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(p.tag=15,p.type=L,EK(d,p,L,k,P)):(d=OR(w.type,null,k,p,p.mode,P),d.ref=p.ref,d.return=p,p.child=d)}if(L=d.child,(d.lanes&P)===0){var K=L.memoizedProps;if(w=w.compare,w=w!==null?w:Cb,w(K,k)&&d.ref===p.ref)return Xd(d,p,P)}return p.flags|=1,d=Bp(L,k),d.ref=p.ref,d.return=p,p.child=d}function EK(d,p,w,k,P){if(d!==null){var L=d.memoizedProps;if(Cb(L,k)&&d.ref===p.ref)if(Ga=!1,p.pendingProps=k=L,(d.lanes&P)!==0)(d.flags&131072)!==0&&(Ga=!0);else return p.lanes=d.lanes,Xd(d,p,P)}return lD(d,p,w,k,P)}function SK(d,p,w){var k=p.pendingProps,P=k.children,L=d!==null?d.memoizedState:null;if(k.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},ti(Bv,Ll),Ll|=w;else{if((w&1073741824)===0)return d=L!==null?L.baseLanes|w:w,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,ti(Bv,Ll),Ll|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=L!==null?L.baseLanes:w,ti(Bv,Ll),Ll|=k}else L!==null?(k=L.baseLanes|w,p.memoizedState=null):k=w,ti(Bv,Ll),Ll|=k;return va(d,p,P,w),p.child}function TK(d,p){var w=p.ref;(d===null&&w!==null||d!==null&&d.ref!==w)&&(p.flags|=512,p.flags|=2097152)}function lD(d,p,w,k,P){var L=Ua(w)?d0:Do.current;return L=Ov(p,L),Vv(p,P),w=JL(d,p,w,k,L,P),k=QL(),d!==null&&!Ga?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~P,Xd(d,p,P)):(gi&&k&&LL(p),p.flags|=1,va(d,p,w,P),p.child)}function kK(d,p,w,k,P){if(Ua(w)){var L=!0;sR(p)}else L=!1;if(Vv(p,P),p.stateNode===null)ER(d,p),pK(p,w,k),sD(p,w,k,P),k=!0;else if(d===null){var K=p.stateNode,ce=p.memoizedProps;K.props=ce;var he=K.context,Fe=w.contextType;typeof Fe=="object"&&Fe!==null?Fe=_c(Fe):(Fe=Ua(w)?d0:Do.current,Fe=Ov(p,Fe));var ot=w.getDerivedStateFromProps,ht=typeof ot=="function"||typeof K.getSnapshotBeforeUpdate=="function";ht||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ce!==k||he!==Fe)&&mK(p,K,k,Fe),$p=!1;var rt=p.memoizedState;K.state=rt,pR(p,k,K,P),he=p.memoizedState,ce!==k||rt!==he||za.current||$p?(typeof ot=="function"&&(iD(p,w,ot,k),he=p.memoizedState),(ce=$p||fK(p,w,ce,k,rt,he,Fe))?(ht||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(p.flags|=4194308)):(typeof K.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=k,p.memoizedState=he),K.props=k,K.state=he,K.context=Fe,k=ce):(typeof K.componentDidMount=="function"&&(p.flags|=4194308),k=!1)}else{K=p.stateNode,Uq(d,p),ce=p.memoizedProps,Fe=p.type===p.elementType?ce:vu(p.type,ce),K.props=Fe,ht=p.pendingProps,rt=K.context,he=w.contextType,typeof he=="object"&&he!==null?he=_c(he):(he=Ua(w)?d0:Do.current,he=Ov(p,he));var Nt=w.getDerivedStateFromProps;(ot=typeof Nt=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ce!==ht||rt!==he)&&mK(p,K,k,he),$p=!1,rt=p.memoizedState,K.state=rt,pR(p,k,K,P);var Ut=p.memoizedState;ce!==ht||rt!==Ut||za.current||$p?(typeof Nt=="function"&&(iD(p,w,Nt,k),Ut=p.memoizedState),(Fe=$p||fK(p,w,Fe,k,rt,Ut,he)||!1)?(ot||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(k,Ut,he),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(k,Ut,he)),typeof K.componentDidUpdate=="function"&&(p.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof K.componentDidUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=1024),p.memoizedProps=k,p.memoizedState=Ut),K.props=k,K.state=Ut,K.context=he,k=Fe):(typeof K.componentDidUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=1024),k=!1)}return cD(d,p,w,k,L,P)}function cD(d,p,w,k,P,L){TK(d,p);var K=(p.flags&128)!==0;if(!k&&!K)return P&&Cq(p,w,!1),Xd(d,p,L);k=p.stateNode,qEe.current=p;var ce=K&&typeof w.getDerivedStateFromError!="function"?null:k.render();return p.flags|=1,d!==null&&K?(p.child=jv(p,d.child,null,L),p.child=jv(p,null,ce,L)):va(d,p,ce,L),p.memoizedState=k.state,P&&Cq(p,w,!0),p.child}function AK(d){var p=d.stateNode;p.pendingContext?Rq(d,p.pendingContext,p.pendingContext!==p.context):p.context&&Rq(d,p.context,!1),HL(d,p.containerInfo)}function IK(d,p,w,k,P){return $v(),FL(P),p.flags|=256,va(d,p,w,k),p.child}var uD={dehydrated:null,treeContext:null,retryLane:0};function hD(d){return{baseLanes:d,cachePool:null,transitions:null}}function RK(d,p,w){var k=p.pendingProps,P=Ai.current,L=!1,K=(p.flags&128)!==0,ce;if((ce=K)||(ce=d!==null&&d.memoizedState===null?!1:(P&2)!==0),ce?(L=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(P|=1),ti(Ai,P&1),d===null)return jL(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(K=k.children,d=k.fallback,L?(k=p.mode,L=p.child,K={mode:"hidden",children:K},(k&1)===0&&L!==null?(L.childLanes=0,L.pendingProps=K):L=LR(K,k,0,null),d=b0(d,k,w,null),L.return=p,d.return=p,L.sibling=d,p.child=L,p.child.memoizedState=hD(w),p.memoizedState=uD,d):dD(p,K));if(P=d.memoizedState,P!==null&&(ce=P.dehydrated,ce!==null))return KEe(d,p,K,k,ce,P,w);if(L){L=k.fallback,K=p.mode,P=d.child,ce=P.sibling;var he={mode:"hidden",children:k.children};return(K&1)===0&&p.child!==P?(k=p.child,k.childLanes=0,k.pendingProps=he,p.deletions=null):(k=Bp(P,he),k.subtreeFlags=P.subtreeFlags&14680064),ce!==null?L=Bp(ce,L):(L=b0(L,K,w,null),L.flags|=2),L.return=p,k.return=p,k.sibling=L,p.child=k,k=L,L=p.child,K=d.child.memoizedState,K=K===null?hD(w):{baseLanes:K.baseLanes|w,cachePool:null,transitions:K.transitions},L.memoizedState=K,L.childLanes=d.childLanes&~w,p.memoizedState=uD,k}return L=d.child,d=L.sibling,k=Bp(L,{mode:"visible",children:k.children}),(p.mode&1)===0&&(k.lanes=w),k.return=p,k.sibling=null,d!==null&&(w=p.deletions,w===null?(p.deletions=[d],p.flags|=16):w.push(d)),p.child=k,p.memoizedState=null,k}function dD(d,p){return p=LR({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function bR(d,p,w,k){return k!==null&&FL(k),jv(p,d.child,null,w),d=dD(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function KEe(d,p,w,k,P,L,K){if(w)return p.flags&256?(p.flags&=-257,k=oD(Error(n(422))),bR(d,p,K,k)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(L=k.fallback,P=p.mode,k=LR({mode:"visible",children:k.children},P,0,null),L=b0(L,P,K,null),L.flags|=2,k.return=p,L.return=p,k.sibling=L,p.child=k,(p.mode&1)!==0&&jv(p,d.child,null,K),p.child.memoizedState=hD(K),p.memoizedState=uD,L);if((p.mode&1)===0)return bR(d,p,K,null);if(P.data==="$!"){if(k=P.nextSibling&&P.nextSibling.dataset,k)var ce=k.dgst;return k=ce,L=Error(n(419)),k=oD(L,k,void 0),bR(d,p,K,k)}if(ce=(K&d.childLanes)!==0,Ga||ce){if(k=qs,k!==null){switch(K&-K){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=(P&(k.suspendedLanes|K))!==0?0:P,P!==0&&P!==L.retryLane&&(L.retryLane=P,Kd(d,P),wu(k,d,P,-1))}return ID(),k=oD(Error(n(421))),bR(d,p,K,k)}return P.data==="$?"?(p.flags|=128,p.child=d.child,p=aSe.bind(null,d),P._reactRetry=p,null):(d=L.treeContext,Ol=Np(P.nextSibling),Nl=p,gi=!0,yu=null,d!==null&&(yc[vc++]=Hd,yc[vc++]=qd,yc[vc++]=f0,Hd=d.id,qd=d.overflow,f0=p),p=dD(p,k.children),p.flags|=4096,p)}function PK(d,p,w){d.lanes|=p;var k=d.alternate;k!==null&&(k.lanes|=p),GL(d.return,p,w)}function fD(d,p,w,k,P){var L=d.memoizedState;L===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:k,tail:w,tailMode:P}:(L.isBackwards=p,L.rendering=null,L.renderingStartTime=0,L.last=k,L.tail=w,L.tailMode=P)}function CK(d,p,w){var k=p.pendingProps,P=k.revealOrder,L=k.tail;if(va(d,p,k.children,w),k=Ai.current,(k&2)!==0)k=k&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&PK(d,w,p);else if(d.tag===19)PK(d,w,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}k&=1}if(ti(Ai,k),(p.mode&1)===0)p.memoizedState=null;else switch(P){case"forwards":for(w=p.child,P=null;w!==null;)d=w.alternate,d!==null&&mR(d)===null&&(P=w),w=w.sibling;w=P,w===null?(P=p.child,p.child=null):(P=w.sibling,w.sibling=null),fD(p,!1,P,w,L);break;case"backwards":for(w=null,P=p.child,p.child=null;P!==null;){if(d=P.alternate,d!==null&&mR(d)===null){p.child=P;break}d=P.sibling,P.sibling=w,w=P,P=d}fD(p,!0,w,null,L);break;case"together":fD(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function ER(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function Xd(d,p,w){if(d!==null&&(p.dependencies=d.dependencies),v0|=p.lanes,(w&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(n(153));if(p.child!==null){for(d=p.child,w=Bp(d,d.pendingProps),p.child=w,w.return=p;d.sibling!==null;)d=d.sibling,w=w.sibling=Bp(d,d.pendingProps),w.return=p;w.sibling=null}return p.child}function YEe(d,p,w){switch(p.tag){case 3:AK(p),$v();break;case 5:Wq(p);break;case 1:Ua(p.type)&&sR(p);break;case 4:HL(p,p.stateNode.containerInfo);break;case 10:var k=p.type._context,P=p.memoizedProps.value;ti(hR,k._currentValue),k._currentValue=P;break;case 13:if(k=p.memoizedState,k!==null)return k.dehydrated!==null?(ti(Ai,Ai.current&1),p.flags|=128,null):(w&p.child.childLanes)!==0?RK(d,p,w):(ti(Ai,Ai.current&1),d=Xd(d,p,w),d!==null?d.sibling:null);ti(Ai,Ai.current&1);break;case 19:if(k=(w&p.childLanes)!==0,(d.flags&128)!==0){if(k)return CK(d,p,w);p.flags|=128}if(P=p.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),ti(Ai,Ai.current),k)break;return null;case 22:case 23:return p.lanes=0,SK(d,p,w)}return Xd(d,p,w)}var MK,pD,NK,OK;MK=function(d,p){for(var w=p.child;w!==null;){if(w.tag===5||w.tag===6)d.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===p)break;for(;w.sibling===null;){if(w.return===null||w.return===p)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},pD=function(){},NK=function(d,p,w,k){var P=d.memoizedProps;if(P!==k){d=p.stateNode,g0(Rh.current);var L=null;switch(w){case"input":P=$t(d,P),k=$t(d,k),L=[];break;case"select":P=Ae({},P,{value:void 0}),k=Ae({},k,{value:void 0}),L=[];break;case"textarea":P=po(d,P),k=po(d,k),L=[];break;default:typeof P.onClick!="function"&&typeof k.onClick=="function"&&(d.onclick=nR)}Ti(w,k);var K;w=null;for(Fe in P)if(!k.hasOwnProperty(Fe)&&P.hasOwnProperty(Fe)&&P[Fe]!=null)if(Fe==="style"){var ce=P[Fe];for(K in ce)ce.hasOwnProperty(K)&&(w||(w={}),w[K]="")}else Fe!=="dangerouslySetInnerHTML"&&Fe!=="children"&&Fe!=="suppressContentEditableWarning"&&Fe!=="suppressHydrationWarning"&&Fe!=="autoFocus"&&(i.hasOwnProperty(Fe)?L||(L=[]):(L=L||[]).push(Fe,null));for(Fe in k){var he=k[Fe];if(ce=P?.[Fe],k.hasOwnProperty(Fe)&&he!==ce&&(he!=null||ce!=null))if(Fe==="style")if(ce){for(K in ce)!ce.hasOwnProperty(K)||he&&he.hasOwnProperty(K)||(w||(w={}),w[K]="");for(K in he)he.hasOwnProperty(K)&&ce[K]!==he[K]&&(w||(w={}),w[K]=he[K])}else w||(L||(L=[]),L.push(Fe,w)),w=he;else Fe==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ce=ce?ce.__html:void 0,he!=null&&ce!==he&&(L=L||[]).push(Fe,he)):Fe==="children"?typeof he!="string"&&typeof he!="number"||(L=L||[]).push(Fe,""+he):Fe!=="suppressContentEditableWarning"&&Fe!=="suppressHydrationWarning"&&(i.hasOwnProperty(Fe)?(he!=null&&Fe==="onScroll"&&si("scroll",d),L||ce===he||(L=[])):(L=L||[]).push(Fe,he))}w&&(L=L||[]).push("style",w);var Fe=L;(p.updateQueue=Fe)&&(p.flags|=4)}},OK=function(d,p,w,k){w!==k&&(p.flags|=4)};function Hb(d,p){if(!gi)switch(d.tailMode){case"hidden":p=d.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d.tail=null:w.sibling=null;break;case"collapsed":w=d.tail;for(var k=null;w!==null;)w.alternate!==null&&(k=w),w=w.sibling;k===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:k.sibling=null}}function jo(d){var p=d.alternate!==null&&d.alternate.child===d.child,w=0,k=0;if(p)for(var P=d.child;P!==null;)w|=P.lanes|P.childLanes,k|=P.subtreeFlags&14680064,k|=P.flags&14680064,P.return=d,P=P.sibling;else for(P=d.child;P!==null;)w|=P.lanes|P.childLanes,k|=P.subtreeFlags,k|=P.flags,P.return=d,P=P.sibling;return d.subtreeFlags|=k,d.childLanes=w,p}function XEe(d,p,w){var k=p.pendingProps;switch(DL(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jo(p),null;case 1:return Ua(p.type)&&iR(),jo(p),null;case 3:return k=p.stateNode,zv(),oi(za),oi(Do),YL(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(d===null||d.child===null)&&(cR(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,yu!==null&&(TD(yu),yu=null))),pD(d,p),jo(p),null;case 5:qL(p);var P=g0(zb.current);if(w=p.type,d!==null&&p.stateNode!=null)NK(d,p,w,k,P),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!k){if(p.stateNode===null)throw Error(n(166));return jo(p),null}if(d=g0(Rh.current),cR(p)){k=p.stateNode,w=p.type;var L=p.memoizedProps;switch(k[Ih]=p,k[Db]=L,d=(p.mode&1)!==0,w){case"dialog":si("cancel",k),si("close",k);break;case"iframe":case"object":case"embed":si("load",k);break;case"video":case"audio":for(P=0;P<Nb.length;P++)si(Nb[P],k);break;case"source":si("error",k);break;case"img":case"image":case"link":si("error",k),si("load",k);break;case"details":si("toggle",k);break;case"input":fn(k,L),si("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!L.multiple},si("invalid",k);break;case"textarea":kr(k,L),si("invalid",k)}Ti(w,L),P=null;for(var K in L)if(L.hasOwnProperty(K)){var ce=L[K];K==="children"?typeof ce=="string"?k.textContent!==ce&&(L.suppressHydrationWarning!==!0&&tR(k.textContent,ce,d),P=["children",ce]):typeof ce=="number"&&k.textContent!==""+ce&&(L.suppressHydrationWarning!==!0&&tR(k.textContent,ce,d),P=["children",""+ce]):i.hasOwnProperty(K)&&ce!=null&&K==="onScroll"&&si("scroll",k)}switch(w){case"input":Dt(k),lr(k,L,!0);break;case"textarea":Dt(k),Rs(k);break;case"select":case"option":break;default:typeof L.onClick=="function"&&(k.onclick=nR)}k=P,p.updateQueue=k,k!==null&&(p.flags|=4)}else{K=P.nodeType===9?P:P.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=bt(w)),d==="http://www.w3.org/1999/xhtml"?w==="script"?(d=K.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof k.is=="string"?d=K.createElement(w,{is:k.is}):(d=K.createElement(w),w==="select"&&(K=d,k.multiple?K.multiple=!0:k.size&&(K.size=k.size))):d=K.createElementNS(d,w),d[Ih]=p,d[Db]=k,MK(d,p,!1,!1),p.stateNode=d;e:{switch(K=He(w,k),w){case"dialog":si("cancel",d),si("close",d),P=k;break;case"iframe":case"object":case"embed":si("load",d),P=k;break;case"video":case"audio":for(P=0;P<Nb.length;P++)si(Nb[P],d);P=k;break;case"source":si("error",d),P=k;break;case"img":case"image":case"link":si("error",d),si("load",d),P=k;break;case"details":si("toggle",d),P=k;break;case"input":fn(d,k),P=$t(d,k),si("invalid",d);break;case"option":P=k;break;case"select":d._wrapperState={wasMultiple:!!k.multiple},P=Ae({},k,{value:void 0}),si("invalid",d);break;case"textarea":kr(d,k),P=po(d,k),si("invalid",d);break;default:P=k}Ti(w,P),ce=P;for(L in ce)if(ce.hasOwnProperty(L)){var he=ce[L];L==="style"?Ps(d,he):L==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&Ft(d,he)):L==="children"?typeof he=="string"?(w!=="textarea"||he!=="")&&On(d,he):typeof he=="number"&&On(d,""+he):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(i.hasOwnProperty(L)?he!=null&&L==="onScroll"&&si("scroll",d):he!=null&&I(d,L,he,K))}switch(w){case"input":Dt(d),lr(d,k,!1);break;case"textarea":Dt(d),Rs(d);break;case"option":k.value!=null&&d.setAttribute("value",""+Ke(k.value));break;case"select":d.multiple=!!k.multiple,L=k.value,L!=null?Xr(d,!!k.multiple,L,!1):k.defaultValue!=null&&Xr(d,!!k.multiple,k.defaultValue,!0);break;default:typeof P.onClick=="function"&&(d.onclick=nR)}switch(w){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return jo(p),null;case 6:if(d&&p.stateNode!=null)OK(d,p,d.memoizedProps,k);else{if(typeof k!="string"&&p.stateNode===null)throw Error(n(166));if(w=g0(zb.current),g0(Rh.current),cR(p)){if(k=p.stateNode,w=p.memoizedProps,k[Ih]=p,(L=k.nodeValue!==w)&&(d=Nl,d!==null))switch(d.tag){case 3:tR(k.nodeValue,w,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&tR(k.nodeValue,w,(d.mode&1)!==0)}L&&(p.flags|=4)}else k=(w.nodeType===9?w:w.ownerDocument).createTextNode(k),k[Ih]=p,p.stateNode=k}return jo(p),null;case 13:if(oi(Ai),k=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(gi&&Ol!==null&&(p.mode&1)!==0&&(p.flags&128)===0)$q(),$v(),p.flags|=98560,L=!1;else if(L=cR(p),k!==null&&k.dehydrated!==null){if(d===null){if(!L)throw Error(n(318));if(L=p.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(n(317));L[Ih]=p}else $v(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;jo(p),L=!1}else yu!==null&&(TD(yu),yu=null),L=!0;if(!L)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=w,p):(k=k!==null,k!==(d!==null&&d.memoizedState!==null)&&k&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(Ai.current&1)!==0?Ms===0&&(Ms=3):ID())),p.updateQueue!==null&&(p.flags|=4),jo(p),null);case 4:return zv(),pD(d,p),d===null&&Ob(p.stateNode.containerInfo),jo(p),null;case 10:return UL(p.type._context),jo(p),null;case 17:return Ua(p.type)&&iR(),jo(p),null;case 19:if(oi(Ai),L=p.memoizedState,L===null)return jo(p),null;if(k=(p.flags&128)!==0,K=L.rendering,K===null)if(k)Hb(L,!1);else{if(Ms!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(K=mR(d),K!==null){for(p.flags|=128,Hb(L,!1),k=K.updateQueue,k!==null&&(p.updateQueue=k,p.flags|=4),p.subtreeFlags=0,k=w,w=p.child;w!==null;)L=w,d=k,L.flags&=14680066,K=L.alternate,K===null?(L.childLanes=0,L.lanes=d,L.child=null,L.subtreeFlags=0,L.memoizedProps=null,L.memoizedState=null,L.updateQueue=null,L.dependencies=null,L.stateNode=null):(L.childLanes=K.childLanes,L.lanes=K.lanes,L.child=K.child,L.subtreeFlags=0,L.deletions=null,L.memoizedProps=K.memoizedProps,L.memoizedState=K.memoizedState,L.updateQueue=K.updateQueue,L.type=K.type,d=K.dependencies,L.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),w=w.sibling;return ti(Ai,Ai.current&1|2),p.child}d=d.sibling}L.tail!==null&&ut()>Wv&&(p.flags|=128,k=!0,Hb(L,!1),p.lanes=4194304)}else{if(!k)if(d=mR(K),d!==null){if(p.flags|=128,k=!0,w=d.updateQueue,w!==null&&(p.updateQueue=w,p.flags|=4),Hb(L,!0),L.tail===null&&L.tailMode==="hidden"&&!K.alternate&&!gi)return jo(p),null}else 2*ut()-L.renderingStartTime>Wv&&w!==1073741824&&(p.flags|=128,k=!0,Hb(L,!1),p.lanes=4194304);L.isBackwards?(K.sibling=p.child,p.child=K):(w=L.last,w!==null?w.sibling=K:p.child=K,L.last=K)}return L.tail!==null?(p=L.tail,L.rendering=p,L.tail=p.sibling,L.renderingStartTime=ut(),p.sibling=null,w=Ai.current,ti(Ai,k?w&1|2:w&1),p):(jo(p),null);case 22:case 23:return AD(),k=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==k&&(p.flags|=8192),k&&(p.mode&1)!==0?(Ll&1073741824)!==0&&(jo(p),p.subtreeFlags&6&&(p.flags|=8192)):jo(p),null;case 24:return null;case 25:return null}throw Error(n(156,p.tag))}function ZEe(d,p){switch(DL(p),p.tag){case 1:return Ua(p.type)&&iR(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return zv(),oi(za),oi(Do),YL(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return qL(p),null;case 13:if(oi(Ai),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(n(340));$v()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return oi(Ai),null;case 4:return zv(),null;case 10:return UL(p.type._context),null;case 22:case 23:return AD(),null;case 24:return null;default:return null}}var SR=!1,Fo=!1,JEe=typeof WeakSet=="function"?WeakSet:Set,jt=null;function Gv(d,p){var w=d.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(k){Vi(d,p,k)}else w.current=null}function mD(d,p,w){try{w()}catch(k){Vi(d,p,k)}}var LK=!1;function QEe(d,p){if(AL=zd,d=fq(),_L(d)){if("selectionStart"in d)var w={start:d.selectionStart,end:d.selectionEnd};else e:{w=(w=d.ownerDocument)&&w.defaultView||window;var k=w.getSelection&&w.getSelection();if(k&&k.rangeCount!==0){w=k.anchorNode;var P=k.anchorOffset,L=k.focusNode;k=k.focusOffset;try{w.nodeType,L.nodeType}catch{w=null;break e}var K=0,ce=-1,he=-1,Fe=0,ot=0,ht=d,rt=null;t:for(;;){for(var Nt;ht!==w||P!==0&&ht.nodeType!==3||(ce=K+P),ht!==L||k!==0&&ht.nodeType!==3||(he=K+k),ht.nodeType===3&&(K+=ht.nodeValue.length),(Nt=ht.firstChild)!==null;)rt=ht,ht=Nt;for(;;){if(ht===d)break t;if(rt===w&&++Fe===P&&(ce=K),rt===L&&++ot===k&&(he=K),(Nt=ht.nextSibling)!==null)break;ht=rt,rt=ht.parentNode}ht=Nt}w=ce===-1||he===-1?null:{start:ce,end:he}}else w=null}w=w||{start:0,end:0}}else w=null;for(IL={focusedElem:d,selectionRange:w},zd=!1,jt=p;jt!==null;)if(p=jt,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,jt=d;else for(;jt!==null;){p=jt;try{var Ut=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Ut!==null){var Yt=Ut.memoizedProps,is=Ut.memoizedState,be=p.stateNode,me=be.getSnapshotBeforeUpdate(p.elementType===p.type?Yt:vu(p.type,Yt),is);be.__reactInternalSnapshotBeforeUpdate=me}break;case 3:var Me=p.stateNode.containerInfo;Me.nodeType===1?Me.textContent="":Me.nodeType===9&&Me.documentElement&&Me.removeChild(Me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(mt){Vi(p,p.return,mt)}if(d=p.sibling,d!==null){d.return=p.return,jt=d;break}jt=p.return}return Ut=LK,LK=!1,Ut}function qb(d,p,w){var k=p.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var P=k=k.next;do{if((P.tag&d)===d){var L=P.destroy;P.destroy=void 0,L!==void 0&&mD(p,w,L)}P=P.next}while(P!==k)}}function TR(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var w=p=p.next;do{if((w.tag&d)===d){var k=w.create;w.destroy=k()}w=w.next}while(w!==p)}}function gD(d){var p=d.ref;if(p!==null){var w=d.stateNode;switch(d.tag){case 5:d=w;break;default:d=w}typeof p=="function"?p(d):p.current=d}}function DK(d){var p=d.alternate;p!==null&&(d.alternate=null,DK(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[Ih],delete p[Db],delete p[ML],delete p[LEe],delete p[DEe])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function $K(d){return d.tag===5||d.tag===3||d.tag===4}function jK(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||$K(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function yD(d,p,w){var k=d.tag;if(k===5||k===6)d=d.stateNode,p?w.nodeType===8?w.parentNode.insertBefore(d,p):w.insertBefore(d,p):(w.nodeType===8?(p=w.parentNode,p.insertBefore(d,w)):(p=w,p.appendChild(d)),w=w._reactRootContainer,w!=null||p.onclick!==null||(p.onclick=nR));else if(k!==4&&(d=d.child,d!==null))for(yD(d,p,w),d=d.sibling;d!==null;)yD(d,p,w),d=d.sibling}function vD(d,p,w){var k=d.tag;if(k===5||k===6)d=d.stateNode,p?w.insertBefore(d,p):w.appendChild(d);else if(k!==4&&(d=d.child,d!==null))for(vD(d,p,w),d=d.sibling;d!==null;)vD(d,p,w),d=d.sibling}var yo=null,_u=!1;function Fp(d,p,w){for(w=w.child;w!==null;)FK(d,p,w),w=w.sibling}function FK(d,p,w){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(Il,w)}catch{}switch(w.tag){case 5:Fo||Gv(w,p);case 6:var k=yo,P=_u;yo=null,Fp(d,p,w),yo=k,_u=P,yo!==null&&(_u?(d=yo,w=w.stateNode,d.nodeType===8?d.parentNode.removeChild(w):d.removeChild(w)):yo.removeChild(w.stateNode));break;case 18:yo!==null&&(_u?(d=yo,w=w.stateNode,d.nodeType===8?CL(d.parentNode,w):d.nodeType===1&&CL(d,w),Rp(d)):CL(yo,w.stateNode));break;case 4:k=yo,P=_u,yo=w.stateNode.containerInfo,_u=!0,Fp(d,p,w),yo=k,_u=P;break;case 0:case 11:case 14:case 15:if(!Fo&&(k=w.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){P=k=k.next;do{var L=P,K=L.destroy;L=L.tag,K!==void 0&&((L&2)!==0||(L&4)!==0)&&mD(w,p,K),P=P.next}while(P!==k)}Fp(d,p,w);break;case 1:if(!Fo&&(Gv(w,p),k=w.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=w.memoizedProps,k.state=w.memoizedState,k.componentWillUnmount()}catch(ce){Vi(w,p,ce)}Fp(d,p,w);break;case 21:Fp(d,p,w);break;case 22:w.mode&1?(Fo=(k=Fo)||w.memoizedState!==null,Fp(d,p,w),Fo=k):Fp(d,p,w);break;default:Fp(d,p,w)}}function VK(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var w=d.stateNode;w===null&&(w=d.stateNode=new JEe),p.forEach(function(k){var P=lSe.bind(null,d,k);w.has(k)||(w.add(k),k.then(P,P))})}}function xu(d,p){var w=p.deletions;if(w!==null)for(var k=0;k<w.length;k++){var P=w[k];try{var L=d,K=p,ce=K;e:for(;ce!==null;){switch(ce.tag){case 5:yo=ce.stateNode,_u=!1;break e;case 3:yo=ce.stateNode.containerInfo,_u=!0;break e;case 4:yo=ce.stateNode.containerInfo,_u=!0;break e}ce=ce.return}if(yo===null)throw Error(n(160));FK(L,K,P),yo=null,_u=!1;var he=P.alternate;he!==null&&(he.return=null),P.return=null}catch(Fe){Vi(P,p,Fe)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)zK(p,d),p=p.sibling}function zK(d,p){var w=d.alternate,k=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(xu(p,d),Ch(d),k&4){try{qb(3,d,d.return),TR(3,d)}catch(Yt){Vi(d,d.return,Yt)}try{qb(5,d,d.return)}catch(Yt){Vi(d,d.return,Yt)}}break;case 1:xu(p,d),Ch(d),k&512&&w!==null&&Gv(w,w.return);break;case 5:if(xu(p,d),Ch(d),k&512&&w!==null&&Gv(w,w.return),d.flags&32){var P=d.stateNode;try{On(P,"")}catch(Yt){Vi(d,d.return,Yt)}}if(k&4&&(P=d.stateNode,P!=null)){var L=d.memoizedProps,K=w!==null?w.memoizedProps:L,ce=d.type,he=d.updateQueue;if(d.updateQueue=null,he!==null)try{ce==="input"&&L.type==="radio"&&L.name!=null&&yn(P,L),He(ce,K);var Fe=He(ce,L);for(K=0;K<he.length;K+=2){var ot=he[K],ht=he[K+1];ot==="style"?Ps(P,ht):ot==="dangerouslySetInnerHTML"?Ft(P,ht):ot==="children"?On(P,ht):I(P,ot,ht,Fe)}switch(ce){case"input":dt(P,L);break;case"textarea":Si(P,L);break;case"select":var rt=P._wrapperState.wasMultiple;P._wrapperState.wasMultiple=!!L.multiple;var Nt=L.value;Nt!=null?Xr(P,!!L.multiple,Nt,!1):rt!==!!L.multiple&&(L.defaultValue!=null?Xr(P,!!L.multiple,L.defaultValue,!0):Xr(P,!!L.multiple,L.multiple?[]:"",!1))}P[Db]=L}catch(Yt){Vi(d,d.return,Yt)}}break;case 6:if(xu(p,d),Ch(d),k&4){if(d.stateNode===null)throw Error(n(162));P=d.stateNode,L=d.memoizedProps;try{P.nodeValue=L}catch(Yt){Vi(d,d.return,Yt)}}break;case 3:if(xu(p,d),Ch(d),k&4&&w!==null&&w.memoizedState.isDehydrated)try{Rp(p.containerInfo)}catch(Yt){Vi(d,d.return,Yt)}break;case 4:xu(p,d),Ch(d);break;case 13:xu(p,d),Ch(d),P=d.child,P.flags&8192&&(L=P.memoizedState!==null,P.stateNode.isHidden=L,!L||P.alternate!==null&&P.alternate.memoizedState!==null||(wD=ut())),k&4&&VK(d);break;case 22:if(ot=w!==null&&w.memoizedState!==null,d.mode&1?(Fo=(Fe=Fo)||ot,xu(p,d),Fo=Fe):xu(p,d),Ch(d),k&8192){if(Fe=d.memoizedState!==null,(d.stateNode.isHidden=Fe)&&!ot&&(d.mode&1)!==0)for(jt=d,ot=d.child;ot!==null;){for(ht=jt=ot;jt!==null;){switch(rt=jt,Nt=rt.child,rt.tag){case 0:case 11:case 14:case 15:qb(4,rt,rt.return);break;case 1:Gv(rt,rt.return);var Ut=rt.stateNode;if(typeof Ut.componentWillUnmount=="function"){k=rt,w=rt.return;try{p=k,Ut.props=p.memoizedProps,Ut.state=p.memoizedState,Ut.componentWillUnmount()}catch(Yt){Vi(k,w,Yt)}}break;case 5:Gv(rt,rt.return);break;case 22:if(rt.memoizedState!==null){BK(ht);continue}}Nt!==null?(Nt.return=rt,jt=Nt):BK(ht)}ot=ot.sibling}e:for(ot=null,ht=d;;){if(ht.tag===5){if(ot===null){ot=ht;try{P=ht.stateNode,Fe?(L=P.style,typeof L.setProperty=="function"?L.setProperty("display","none","important"):L.display="none"):(ce=ht.stateNode,he=ht.memoizedProps.style,K=he!=null&&he.hasOwnProperty("display")?he.display:null,ce.style.display=Fi("display",K))}catch(Yt){Vi(d,d.return,Yt)}}}else if(ht.tag===6){if(ot===null)try{ht.stateNode.nodeValue=Fe?"":ht.memoizedProps}catch(Yt){Vi(d,d.return,Yt)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===d)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===d)break e;for(;ht.sibling===null;){if(ht.return===null||ht.return===d)break e;ot===ht&&(ot=null),ht=ht.return}ot===ht&&(ot=null),ht.sibling.return=ht.return,ht=ht.sibling}}break;case 19:xu(p,d),Ch(d),k&4&&VK(d);break;case 21:break;default:xu(p,d),Ch(d)}}function Ch(d){var p=d.flags;if(p&2){try{e:{for(var w=d.return;w!==null;){if($K(w)){var k=w;break e}w=w.return}throw Error(n(160))}switch(k.tag){case 5:var P=k.stateNode;k.flags&32&&(On(P,""),k.flags&=-33);var L=jK(d);vD(d,L,P);break;case 3:case 4:var K=k.stateNode.containerInfo,ce=jK(d);yD(d,ce,K);break;default:throw Error(n(161))}}catch(he){Vi(d,d.return,he)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function eSe(d,p,w){jt=d,UK(d)}function UK(d,p,w){for(var k=(d.mode&1)!==0;jt!==null;){var P=jt,L=P.child;if(P.tag===22&&k){var K=P.memoizedState!==null||SR;if(!K){var ce=P.alternate,he=ce!==null&&ce.memoizedState!==null||Fo;ce=SR;var Fe=Fo;if(SR=K,(Fo=he)&&!Fe)for(jt=P;jt!==null;)K=jt,he=K.child,K.tag===22&&K.memoizedState!==null?WK(P):he!==null?(he.return=K,jt=he):WK(P);for(;L!==null;)jt=L,UK(L),L=L.sibling;jt=P,SR=ce,Fo=Fe}GK(d)}else(P.subtreeFlags&8772)!==0&&L!==null?(L.return=P,jt=L):GK(d)}}function GK(d){for(;jt!==null;){var p=jt;if((p.flags&8772)!==0){var w=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Fo||TR(5,p);break;case 1:var k=p.stateNode;if(p.flags&4&&!Fo)if(w===null)k.componentDidMount();else{var P=p.elementType===p.type?w.memoizedProps:vu(p.type,w.memoizedProps);k.componentDidUpdate(P,w.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var L=p.updateQueue;L!==null&&Bq(p,L,k);break;case 3:var K=p.updateQueue;if(K!==null){if(w=null,p.child!==null)switch(p.child.tag){case 5:w=p.child.stateNode;break;case 1:w=p.child.stateNode}Bq(p,K,w)}break;case 5:var ce=p.stateNode;if(w===null&&p.flags&4){w=ce;var he=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&w.focus();break;case"img":he.src&&(w.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Fe=p.alternate;if(Fe!==null){var ot=Fe.memoizedState;if(ot!==null){var ht=ot.dehydrated;ht!==null&&Rp(ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Fo||p.flags&512&&gD(p)}catch(rt){Vi(p,p.return,rt)}}if(p===d){jt=null;break}if(w=p.sibling,w!==null){w.return=p.return,jt=w;break}jt=p.return}}function BK(d){for(;jt!==null;){var p=jt;if(p===d){jt=null;break}var w=p.sibling;if(w!==null){w.return=p.return,jt=w;break}jt=p.return}}function WK(d){for(;jt!==null;){var p=jt;try{switch(p.tag){case 0:case 11:case 15:var w=p.return;try{TR(4,p)}catch(he){Vi(p,w,he)}break;case 1:var k=p.stateNode;if(typeof k.componentDidMount=="function"){var P=p.return;try{k.componentDidMount()}catch(he){Vi(p,P,he)}}var L=p.return;try{gD(p)}catch(he){Vi(p,L,he)}break;case 5:var K=p.return;try{gD(p)}catch(he){Vi(p,K,he)}}}catch(he){Vi(p,p.return,he)}if(p===d){jt=null;break}var ce=p.sibling;if(ce!==null){ce.return=p.return,jt=ce;break}jt=p.return}}var tSe=Math.ceil,kR=R.ReactCurrentDispatcher,_D=R.ReactCurrentOwner,wc=R.ReactCurrentBatchConfig,ur=0,qs=null,fs=null,vo=0,Ll=0,Bv=Op(0),Ms=0,Kb=null,v0=0,AR=0,xD=0,Yb=null,Ba=null,wD=0,Wv=1/0,Zd=null,IR=!1,bD=null,Vp=null,RR=!1,zp=null,PR=0,Xb=0,ED=null,CR=-1,MR=0;function _a(){return(ur&6)!==0?ut():CR!==-1?CR:CR=ut()}function Up(d){return(d.mode&1)===0?1:(ur&2)!==0&&vo!==0?vo&-vo:jEe.transition!==null?(MR===0&&(MR=yb()),MR):(d=nr,d!==0||(d=window.event,d=d===void 0?16:xv(d.type)),d)}function wu(d,p,w,k){if(50<Xb)throw Xb=0,ED=null,Error(n(185));o0(d,w,k),((ur&2)===0||d!==qs)&&(d===qs&&((ur&2)===0&&(AR|=w),Ms===4&&Gp(d,vo)),Wa(d,k),w===1&&ur===0&&(p.mode&1)===0&&(Wv=ut()+500,oR&&Dp()))}function Wa(d,p){var w=d.callbackNode;s0(d,p);var k=jd(d,d===qs?vo:0);if(k===0)w!==null&&gt(w),d.callbackNode=null,d.callbackPriority=0;else if(p=k&-k,d.callbackPriority!==p){if(w!=null&&gt(w),p===1)d.tag===0?$Ee(qK.bind(null,d)):Mq(qK.bind(null,d)),NEe(function(){(ur&6)===0&&Dp()}),w=null;else{switch(vh(k)){case 1:w=Ar;break;case 4:w=Lr;break;case 16:w=mi;break;case 536870912:w=mc;break;default:w=mi}w=tY(w,HK.bind(null,d))}d.callbackPriority=p,d.callbackNode=w}}function HK(d,p){if(CR=-1,MR=0,(ur&6)!==0)throw Error(n(327));var w=d.callbackNode;if(Hv()&&d.callbackNode!==w)return null;var k=jd(d,d===qs?vo:0);if(k===0)return null;if((k&30)!==0||(k&d.expiredLanes)!==0||p)p=NR(d,k);else{p=k;var P=ur;ur|=2;var L=YK();(qs!==d||vo!==p)&&(Zd=null,Wv=ut()+500,x0(d,p));do try{iSe();break}catch(ce){KK(d,ce)}while(!0);zL(),kR.current=L,ur=P,fs!==null?p=0:(qs=null,vo=0,p=Ms)}if(p!==0){if(p===2&&(P=gb(d),P!==0&&(k=P,p=SD(d,P))),p===1)throw w=Kb,x0(d,0),Gp(d,k),Wa(d,ut()),w;if(p===6)Gp(d,k);else{if(P=d.current.alternate,(k&30)===0&&!nSe(P)&&(p=NR(d,k),p===2&&(L=gb(d),L!==0&&(k=L,p=SD(d,L))),p===1))throw w=Kb,x0(d,0),Gp(d,k),Wa(d,ut()),w;switch(d.finishedWork=P,d.finishedLanes=k,p){case 0:case 1:throw Error(n(345));case 2:w0(d,Ba,Zd);break;case 3:if(Gp(d,k),(k&130023424)===k&&(p=wD+500-ut(),10<p)){if(jd(d,0)!==0)break;if(P=d.suspendedLanes,(P&k)!==k){_a(),d.pingedLanes|=d.suspendedLanes&P;break}d.timeoutHandle=PL(w0.bind(null,d,Ba,Zd),p);break}w0(d,Ba,Zd);break;case 4:if(Gp(d,k),(k&4194240)===k)break;for(p=d.eventTimes,P=-1;0<k;){var K=31-ki(k);L=1<<K,K=p[K],K>P&&(P=K),k&=~L}if(k=P,k=ut()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*tSe(k/1960))-k,10<k){d.timeoutHandle=PL(w0.bind(null,d,Ba,Zd),k);break}w0(d,Ba,Zd);break;case 5:w0(d,Ba,Zd);break;default:throw Error(n(329))}}}return Wa(d,ut()),d.callbackNode===w?HK.bind(null,d):null}function SD(d,p){var w=Yb;return d.current.memoizedState.isDehydrated&&(x0(d,p).flags|=256),d=NR(d,p),d!==2&&(p=Ba,Ba=w,p!==null&&TD(p)),d}function TD(d){Ba===null?Ba=d:Ba.push.apply(Ba,d)}function nSe(d){for(var p=d;;){if(p.flags&16384){var w=p.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var k=0;k<w.length;k++){var P=w[k],L=P.getSnapshot;P=P.value;try{if(!gu(L(),P))return!1}catch{return!1}}}if(w=p.child,p.subtreeFlags&16384&&w!==null)w.return=p,p=w;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Gp(d,p){for(p&=~xD,p&=~AR,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var w=31-ki(p),k=1<<w;d[w]=-1,p&=~k}}function qK(d){if((ur&6)!==0)throw Error(n(327));Hv();var p=jd(d,0);if((p&1)===0)return Wa(d,ut()),null;var w=NR(d,p);if(d.tag!==0&&w===2){var k=gb(d);k!==0&&(p=k,w=SD(d,k))}if(w===1)throw w=Kb,x0(d,0),Gp(d,p),Wa(d,ut()),w;if(w===6)throw Error(n(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,w0(d,Ba,Zd),Wa(d,ut()),null}function kD(d,p){var w=ur;ur|=1;try{return d(p)}finally{ur=w,ur===0&&(Wv=ut()+500,oR&&Dp())}}function _0(d){zp!==null&&zp.tag===0&&(ur&6)===0&&Hv();var p=ur;ur|=1;var w=wc.transition,k=nr;try{if(wc.transition=null,nr=1,d)return d()}finally{nr=k,wc.transition=w,ur=p,(ur&6)===0&&Dp()}}function AD(){Ll=Bv.current,oi(Bv)}function x0(d,p){d.finishedWork=null,d.finishedLanes=0;var w=d.timeoutHandle;if(w!==-1&&(d.timeoutHandle=-1,MEe(w)),fs!==null)for(w=fs.return;w!==null;){var k=w;switch(DL(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&iR();break;case 3:zv(),oi(za),oi(Do),YL();break;case 5:qL(k);break;case 4:zv();break;case 13:oi(Ai);break;case 19:oi(Ai);break;case 10:UL(k.type._context);break;case 22:case 23:AD()}w=w.return}if(qs=d,fs=d=Bp(d.current,null),vo=Ll=p,Ms=0,Kb=null,xD=AR=v0=0,Ba=Yb=null,m0!==null){for(p=0;p<m0.length;p++)if(w=m0[p],k=w.interleaved,k!==null){w.interleaved=null;var P=k.next,L=w.pending;if(L!==null){var K=L.next;L.next=P,k.next=K}w.pending=k}m0=null}return d}function KK(d,p){do{var w=fs;try{if(zL(),gR.current=xR,yR){for(var k=Ii.memoizedState;k!==null;){var P=k.queue;P!==null&&(P.pending=null),k=k.next}yR=!1}if(y0=0,Hs=Cs=Ii=null,Ub=!1,Gb=0,_D.current=null,w===null||w.return===null){Ms=1,Kb=p,fs=null;break}e:{var L=d,K=w.return,ce=w,he=p;if(p=vo,ce.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var Fe=he,ot=ce,ht=ot.tag;if((ot.mode&1)===0&&(ht===0||ht===11||ht===15)){var rt=ot.alternate;rt?(ot.updateQueue=rt.updateQueue,ot.memoizedState=rt.memoizedState,ot.lanes=rt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var Nt=_K(K);if(Nt!==null){Nt.flags&=-257,xK(Nt,K,ce,L,p),Nt.mode&1&&vK(L,Fe,p),p=Nt,he=Fe;var Ut=p.updateQueue;if(Ut===null){var Yt=new Set;Yt.add(he),p.updateQueue=Yt}else Ut.add(he);break e}else{if((p&1)===0){vK(L,Fe,p),ID();break e}he=Error(n(426))}}else if(gi&&ce.mode&1){var is=_K(K);if(is!==null){(is.flags&65536)===0&&(is.flags|=256),xK(is,K,ce,L,p),FL(Uv(he,ce));break e}}L=he=Uv(he,ce),Ms!==4&&(Ms=2),Yb===null?Yb=[L]:Yb.push(L),L=K;do{switch(L.tag){case 3:L.flags|=65536,p&=-p,L.lanes|=p;var be=gK(L,he,p);Gq(L,be);break e;case 1:ce=he;var me=L.type,Me=L.stateNode;if((L.flags&128)===0&&(typeof me.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(Vp===null||!Vp.has(Me)))){L.flags|=65536,p&=-p,L.lanes|=p;var mt=yK(L,ce,p);Gq(L,mt);break e}}L=L.return}while(L!==null)}ZK(w)}catch(Zt){p=Zt,fs===w&&w!==null&&(fs=w=w.return);continue}break}while(!0)}function YK(){var d=kR.current;return kR.current=xR,d===null?xR:d}function ID(){(Ms===0||Ms===3||Ms===2)&&(Ms=4),qs===null||(v0&268435455)===0&&(AR&268435455)===0||Gp(qs,vo)}function NR(d,p){var w=ur;ur|=2;var k=YK();(qs!==d||vo!==p)&&(Zd=null,x0(d,p));do try{rSe();break}catch(P){KK(d,P)}while(!0);if(zL(),ur=w,kR.current=k,fs!==null)throw Error(n(261));return qs=null,vo=0,Ms}function rSe(){for(;fs!==null;)XK(fs)}function iSe(){for(;fs!==null&&!Rt();)XK(fs)}function XK(d){var p=eY(d.alternate,d,Ll);d.memoizedProps=d.pendingProps,p===null?ZK(d):fs=p,_D.current=null}function ZK(d){var p=d;do{var w=p.alternate;if(d=p.return,(p.flags&32768)===0){if(w=XEe(w,p,Ll),w!==null){fs=w;return}}else{if(w=ZEe(w,p),w!==null){w.flags&=32767,fs=w;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Ms=6,fs=null;return}}if(p=p.sibling,p!==null){fs=p;return}fs=p=d}while(p!==null);Ms===0&&(Ms=5)}function w0(d,p,w){var k=nr,P=wc.transition;try{wc.transition=null,nr=1,sSe(d,p,w,k)}finally{wc.transition=P,nr=k}return null}function sSe(d,p,w,k){do Hv();while(zp!==null);if((ur&6)!==0)throw Error(n(327));w=d.finishedWork;var P=d.finishedLanes;if(w===null)return null;if(d.finishedWork=null,d.finishedLanes=0,w===d.current)throw Error(n(177));d.callbackNode=null,d.callbackPriority=0;var L=w.lanes|w.childLanes;if(pL(d,L),d===qs&&(fs=qs=null,vo=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||RR||(RR=!0,tY(mi,function(){return Hv(),null})),L=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||L){L=wc.transition,wc.transition=null;var K=nr;nr=1;var ce=ur;ur|=4,_D.current=null,QEe(d,w),zK(w,d),TEe(IL),zd=!!AL,IL=AL=null,d.current=w,eSe(w),ct(),ur=ce,nr=K,wc.transition=L}else d.current=w;if(RR&&(RR=!1,zp=d,PR=P),L=d.pendingLanes,L===0&&(Vp=null),Tp(w.stateNode),Wa(d,ut()),p!==null)for(k=d.onRecoverableError,w=0;w<p.length;w++)P=p[w],k(P.value,{componentStack:P.stack,digest:P.digest});if(IR)throw IR=!1,d=bD,bD=null,d;return(PR&1)!==0&&d.tag!==0&&Hv(),L=d.pendingLanes,(L&1)!==0?d===ED?Xb++:(Xb=0,ED=d):Xb=0,Dp(),null}function Hv(){if(zp!==null){var d=vh(PR),p=wc.transition,w=nr;try{if(wc.transition=null,nr=16>d?16:d,zp===null)var k=!1;else{if(d=zp,zp=null,PR=0,(ur&6)!==0)throw Error(n(331));var P=ur;for(ur|=4,jt=d.current;jt!==null;){var L=jt,K=L.child;if((jt.flags&16)!==0){var ce=L.deletions;if(ce!==null){for(var he=0;he<ce.length;he++){var Fe=ce[he];for(jt=Fe;jt!==null;){var ot=jt;switch(ot.tag){case 0:case 11:case 15:qb(8,ot,L)}var ht=ot.child;if(ht!==null)ht.return=ot,jt=ht;else for(;jt!==null;){ot=jt;var rt=ot.sibling,Nt=ot.return;if(DK(ot),ot===Fe){jt=null;break}if(rt!==null){rt.return=Nt,jt=rt;break}jt=Nt}}}var Ut=L.alternate;if(Ut!==null){var Yt=Ut.child;if(Yt!==null){Ut.child=null;do{var is=Yt.sibling;Yt.sibling=null,Yt=is}while(Yt!==null)}}jt=L}}if((L.subtreeFlags&2064)!==0&&K!==null)K.return=L,jt=K;else e:for(;jt!==null;){if(L=jt,(L.flags&2048)!==0)switch(L.tag){case 0:case 11:case 15:qb(9,L,L.return)}var be=L.sibling;if(be!==null){be.return=L.return,jt=be;break e}jt=L.return}}var me=d.current;for(jt=me;jt!==null;){K=jt;var Me=K.child;if((K.subtreeFlags&2064)!==0&&Me!==null)Me.return=K,jt=Me;else e:for(K=me;jt!==null;){if(ce=jt,(ce.flags&2048)!==0)try{switch(ce.tag){case 0:case 11:case 15:TR(9,ce)}}catch(Zt){Vi(ce,ce.return,Zt)}if(ce===K){jt=null;break e}var mt=ce.sibling;if(mt!==null){mt.return=ce.return,jt=mt;break e}jt=ce.return}}if(ur=P,Dp(),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(Il,d)}catch{}k=!0}return k}finally{nr=w,wc.transition=p}}return!1}function JK(d,p,w){p=Uv(w,p),p=gK(d,p,1),d=jp(d,p,1),p=_a(),d!==null&&(o0(d,1,p),Wa(d,p))}function Vi(d,p,w){if(d.tag===3)JK(d,d,w);else for(;p!==null;){if(p.tag===3){JK(p,d,w);break}else if(p.tag===1){var k=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(Vp===null||!Vp.has(k))){d=Uv(w,d),d=yK(p,d,1),p=jp(p,d,1),d=_a(),p!==null&&(o0(p,1,d),Wa(p,d));break}}p=p.return}}function oSe(d,p,w){var k=d.pingCache;k!==null&&k.delete(p),p=_a(),d.pingedLanes|=d.suspendedLanes&w,qs===d&&(vo&w)===w&&(Ms===4||Ms===3&&(vo&130023424)===vo&&500>ut()-wD?x0(d,0):xD|=w),Wa(d,p)}function QK(d,p){p===0&&((d.mode&1)===0?p=1:(p=kp,kp<<=1,(kp&130023424)===0&&(kp=4194304)));var w=_a();d=Kd(d,p),d!==null&&(o0(d,p,w),Wa(d,w))}function aSe(d){var p=d.memoizedState,w=0;p!==null&&(w=p.retryLane),QK(d,w)}function lSe(d,p){var w=0;switch(d.tag){case 13:var k=d.stateNode,P=d.memoizedState;P!==null&&(w=P.retryLane);break;case 19:k=d.stateNode;break;default:throw Error(n(314))}k!==null&&k.delete(p),QK(d,w)}var eY;eY=function(d,p,w){if(d!==null)if(d.memoizedProps!==p.pendingProps||za.current)Ga=!0;else{if((d.lanes&w)===0&&(p.flags&128)===0)return Ga=!1,YEe(d,p,w);Ga=(d.flags&131072)!==0}else Ga=!1,gi&&(p.flags&1048576)!==0&&Nq(p,lR,p.index);switch(p.lanes=0,p.tag){case 2:var k=p.type;ER(d,p),d=p.pendingProps;var P=Ov(p,Do.current);Vv(p,w),P=JL(null,p,k,d,P,w);var L=QL();return p.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Ua(k)?(L=!0,sR(p)):L=!1,p.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,WL(p),P.updater=wR,p.stateNode=P,P._reactInternals=p,sD(p,k,d,w),p=cD(null,p,k,!0,L,w)):(p.tag=0,gi&&L&&LL(p),va(null,p,P,w),p=p.child),p;case 16:k=p.elementType;e:{switch(ER(d,p),d=p.pendingProps,P=k._init,k=P(k._payload),p.type=k,P=p.tag=uSe(k),d=vu(k,d),P){case 0:p=lD(null,p,k,d,w);break e;case 1:p=kK(null,p,k,d,w);break e;case 11:p=wK(null,p,k,d,w);break e;case 14:p=bK(null,p,k,vu(k.type,d),w);break e}throw Error(n(306,k,""))}return p;case 0:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),lD(d,p,k,P,w);case 1:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),kK(d,p,k,P,w);case 3:e:{if(AK(p),d===null)throw Error(n(387));k=p.pendingProps,L=p.memoizedState,P=L.element,Uq(d,p),pR(p,k,null,w);var K=p.memoizedState;if(k=K.element,L.isDehydrated)if(L={element:k,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},p.updateQueue.baseState=L,p.memoizedState=L,p.flags&256){P=Uv(Error(n(423)),p),p=IK(d,p,k,w,P);break e}else if(k!==P){P=Uv(Error(n(424)),p),p=IK(d,p,k,w,P);break e}else for(Ol=Np(p.stateNode.containerInfo.firstChild),Nl=p,gi=!0,yu=null,w=Vq(p,null,k,w),p.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if($v(),k===P){p=Xd(d,p,w);break e}va(d,p,k,w)}p=p.child}return p;case 5:return Wq(p),d===null&&jL(p),k=p.type,P=p.pendingProps,L=d!==null?d.memoizedProps:null,K=P.children,RL(k,P)?K=null:L!==null&&RL(k,L)&&(p.flags|=32),TK(d,p),va(d,p,K,w),p.child;case 6:return d===null&&jL(p),null;case 13:return RK(d,p,w);case 4:return HL(p,p.stateNode.containerInfo),k=p.pendingProps,d===null?p.child=jv(p,null,k,w):va(d,p,k,w),p.child;case 11:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),wK(d,p,k,P,w);case 7:return va(d,p,p.pendingProps,w),p.child;case 8:return va(d,p,p.pendingProps.children,w),p.child;case 12:return va(d,p,p.pendingProps.children,w),p.child;case 10:e:{if(k=p.type._context,P=p.pendingProps,L=p.memoizedProps,K=P.value,ti(hR,k._currentValue),k._currentValue=K,L!==null)if(gu(L.value,K)){if(L.children===P.children&&!za.current){p=Xd(d,p,w);break e}}else for(L=p.child,L!==null&&(L.return=p);L!==null;){var ce=L.dependencies;if(ce!==null){K=L.child;for(var he=ce.firstContext;he!==null;){if(he.context===k){if(L.tag===1){he=Yd(-1,w&-w),he.tag=2;var Fe=L.updateQueue;if(Fe!==null){Fe=Fe.shared;var ot=Fe.pending;ot===null?he.next=he:(he.next=ot.next,ot.next=he),Fe.pending=he}}L.lanes|=w,he=L.alternate,he!==null&&(he.lanes|=w),GL(L.return,w,p),ce.lanes|=w;break}he=he.next}}else if(L.tag===10)K=L.type===p.type?null:L.child;else if(L.tag===18){if(K=L.return,K===null)throw Error(n(341));K.lanes|=w,ce=K.alternate,ce!==null&&(ce.lanes|=w),GL(K,w,p),K=L.sibling}else K=L.child;if(K!==null)K.return=L;else for(K=L;K!==null;){if(K===p){K=null;break}if(L=K.sibling,L!==null){L.return=K.return,K=L;break}K=K.return}L=K}va(d,p,P.children,w),p=p.child}return p;case 9:return P=p.type,k=p.pendingProps.children,Vv(p,w),P=_c(P),k=k(P),p.flags|=1,va(d,p,k,w),p.child;case 14:return k=p.type,P=vu(k,p.pendingProps),P=vu(k.type,P),bK(d,p,k,P,w);case 15:return EK(d,p,p.type,p.pendingProps,w);case 17:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),ER(d,p),p.tag=1,Ua(k)?(d=!0,sR(p)):d=!1,Vv(p,w),pK(p,k,P),sD(p,k,P,w),cD(null,p,k,!0,d,w);case 19:return CK(d,p,w);case 22:return SK(d,p,w)}throw Error(n(156,p.tag))};function tY(d,p){return at(d,p)}function cSe(d,p,w,k){this.tag=d,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bc(d,p,w,k){return new cSe(d,p,w,k)}function RD(d){return d=d.prototype,!(!d||!d.isReactComponent)}function uSe(d){if(typeof d=="function")return RD(d)?1:0;if(d!=null){if(d=d.$$typeof,d===W)return 11;if(d===Ne)return 14}return 2}function Bp(d,p){var w=d.alternate;return w===null?(w=bc(d.tag,p,d.key,d.mode),w.elementType=d.elementType,w.type=d.type,w.stateNode=d.stateNode,w.alternate=d,d.alternate=w):(w.pendingProps=p,w.type=d.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=d.flags&14680064,w.childLanes=d.childLanes,w.lanes=d.lanes,w.child=d.child,w.memoizedProps=d.memoizedProps,w.memoizedState=d.memoizedState,w.updateQueue=d.updateQueue,p=d.dependencies,w.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},w.sibling=d.sibling,w.index=d.index,w.ref=d.ref,w}function OR(d,p,w,k,P,L){var K=2;if(k=d,typeof d=="function")RD(d)&&(K=1);else if(typeof d=="string")K=5;else e:switch(d){case C:return b0(w.children,P,L,p);case N:K=8,P|=8;break;case O:return d=bc(12,w,p,P|2),d.elementType=O,d.lanes=L,d;case U:return d=bc(13,w,p,P),d.elementType=U,d.lanes=L,d;case pe:return d=bc(19,w,p,P),d.elementType=pe,d.lanes=L,d;case je:return LR(w,P,L,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case j:K=10;break e;case V:K=9;break e;case W:K=11;break e;case Ne:K=14;break e;case Se:K=16,k=null;break e}throw Error(n(130,d==null?d:typeof d,""))}return p=bc(K,w,p,P),p.elementType=d,p.type=k,p.lanes=L,p}function b0(d,p,w,k){return d=bc(7,d,k,p),d.lanes=w,d}function LR(d,p,w,k){return d=bc(22,d,k,p),d.elementType=je,d.lanes=w,d.stateNode={isHidden:!1},d}function PD(d,p,w){return d=bc(6,d,null,p),d.lanes=w,d}function CD(d,p,w){return p=bc(4,d.children!==null?d.children:[],d.key,p),p.lanes=w,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function hSe(d,p,w,k,P){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vb(0),this.expirationTimes=vb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vb(0),this.identifierPrefix=k,this.onRecoverableError=P,this.mutableSourceEagerHydrationData=null}function MD(d,p,w,k,P,L,K,ce,he){return d=new hSe(d,p,w,ce,he),p===1?(p=1,L===!0&&(p|=8)):p=0,L=bc(3,null,null,p),d.current=L,L.stateNode=d,L.memoizedState={element:k,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},WL(L),d}function dSe(d,p,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:k==null?null:""+k,children:d,containerInfo:p,implementation:w}}function nY(d){if(!d)return Lp;d=d._reactInternals;e:{if(oe(d)!==d||d.tag!==1)throw Error(n(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Ua(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(n(171))}if(d.tag===1){var w=d.type;if(Ua(w))return Pq(d,w,p)}return p}function rY(d,p,w,k,P,L,K,ce,he){return d=MD(w,k,!0,d,P,L,K,ce,he),d.context=nY(null),w=d.current,k=_a(),P=Up(w),L=Yd(k,P),L.callback=p??null,jp(w,L,P),d.current.lanes=P,o0(d,P,k),Wa(d,k),d}function DR(d,p,w,k){var P=p.current,L=_a(),K=Up(P);return w=nY(w),p.context===null?p.context=w:p.pendingContext=w,p=Yd(L,K),p.payload={element:d},k=k===void 0?null:k,k!==null&&(p.callback=k),d=jp(P,p,K),d!==null&&(wu(d,P,K,L),fR(d,P,K)),K}function $R(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function iY(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var w=d.retryLane;d.retryLane=w!==0&&w<p?w:p}}function ND(d,p){iY(d,p),(d=d.alternate)&&iY(d,p)}function fSe(){return null}var sY=typeof reportError=="function"?reportError:function(d){console.error(d)};function OD(d){this._internalRoot=d}jR.prototype.render=OD.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(n(409));DR(d,p,null,null)},jR.prototype.unmount=OD.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;_0(function(){DR(null,d,null,null)}),p[Bd]=null}};function jR(d){this._internalRoot=d}jR.prototype.unstable_scheduleHydration=function(d){if(d){var p=bb();d={blockedOn:null,target:d,priority:p};for(var w=0;w<Rl.length&&p!==0&&p<Rl[w].priority;w++);Rl.splice(w,0,d),w===0&&vv(d)}};function LD(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function FR(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function oY(){}function pSe(d,p,w,k,P){if(P){if(typeof k=="function"){var L=k;k=function(){var Fe=$R(K);L.call(Fe)}}var K=rY(p,k,d,0,null,!1,!1,"",oY);return d._reactRootContainer=K,d[Bd]=K.current,Ob(d.nodeType===8?d.parentNode:d),_0(),K}for(;P=d.lastChild;)d.removeChild(P);if(typeof k=="function"){var ce=k;k=function(){var Fe=$R(he);ce.call(Fe)}}var he=MD(d,0,!1,null,null,!1,!1,"",oY);return d._reactRootContainer=he,d[Bd]=he.current,Ob(d.nodeType===8?d.parentNode:d),_0(function(){DR(p,he,w,k)}),he}function VR(d,p,w,k,P){var L=w._reactRootContainer;if(L){var K=L;if(typeof P=="function"){var ce=P;P=function(){var he=$R(K);ce.call(he)}}DR(p,K,d,P)}else K=pSe(w,p,d,P,k);return $R(K)}xb=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var w=yr(p.pendingLanes);w!==0&&(_b(p,w|1),Wa(p,ut()),(ur&6)===0&&(Wv=ut()+500,Dp()))}break;case 13:_0(function(){var k=Kd(d,1);if(k!==null){var P=_a();wu(k,d,1,P)}}),ND(d,1)}},gv=function(d){if(d.tag===13){var p=Kd(d,134217728);if(p!==null){var w=_a();wu(p,d,134217728,w)}ND(d,134217728)}},wb=function(d){if(d.tag===13){var p=Up(d),w=Kd(d,p);if(w!==null){var k=_a();wu(w,d,p,k)}ND(d,p)}},bb=function(){return nr},Eb=function(d,p){var w=nr;try{return nr=d,p()}finally{nr=w}},rn=function(d,p,w){switch(p){case"input":if(dt(d,w),p=w.name,w.type==="radio"&&p!=null){for(w=d;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<w.length;p++){var k=w[p];if(k!==d&&k.form===d.form){var P=rR(k);if(!P)throw Error(n(90));Ye(k),dt(k,P)}}}break;case"textarea":Si(d,w);break;case"select":p=w.value,p!=null&&Xr(d,!!w.multiple,p,!1)}},ee=kD,ge=_0;var mSe={usingClientEntryPoint:!1,Events:[$b,Mv,rR,ae,ze,kD]},Zb={findFiberByHostInstance:h0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gSe={bundleType:Zb.bundleType,version:Zb.version,rendererPackageName:Zb.rendererPackageName,rendererConfig:Zb.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Le(d),d===null?null:d.stateNode},findFiberByHostInstance:Zb.findFiberByHostInstance||fSe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zR=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zR.isDisabled&&zR.supportsFiber)try{Il=zR.inject(gSe),ns=zR}catch{}}return Ha.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mSe,Ha.createPortal=function(d,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!LD(p))throw Error(n(200));return dSe(d,p,null,w)},Ha.createRoot=function(d,p){if(!LD(d))throw Error(n(299));var w=!1,k="",P=sY;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onRecoverableError!==void 0&&(P=p.onRecoverableError)),p=MD(d,1,!1,null,null,w,!1,k,P),d[Bd]=p.current,Ob(d.nodeType===8?d.parentNode:d),new OD(p)},Ha.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=Le(p),d=d===null?null:d.stateNode,d},Ha.flushSync=function(d){return _0(d)},Ha.hydrate=function(d,p,w){if(!FR(p))throw Error(n(200));return VR(null,d,p,!0,w)},Ha.hydrateRoot=function(d,p,w){if(!LD(d))throw Error(n(405));var k=w!=null&&w.hydratedSources||null,P=!1,L="",K=sY;if(w!=null&&(w.unstable_strictMode===!0&&(P=!0),w.identifierPrefix!==void 0&&(L=w.identifierPrefix),w.onRecoverableError!==void 0&&(K=w.onRecoverableError)),p=rY(p,null,d,1,w??null,P,!1,L,K),d[Bd]=p.current,Ob(d),k)for(d=0;d<k.length;d++)w=k[d],P=w._getVersion,P=P(w._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[w,P]:p.mutableSourceEagerHydrationData.push(w,P);return new jR(p)},Ha.render=function(d,p,w){if(!FR(p))throw Error(n(200));return VR(null,d,p,!1,w)},Ha.unmountComponentAtNode=function(d){if(!FR(d))throw Error(n(40));return d._reactRootContainer?(_0(function(){VR(null,null,d,!1,function(){d._reactRootContainer=null,d[Bd]=null})}),!0):!1},Ha.unstable_batchedUpdates=kD,Ha.unstable_renderSubtreeIntoContainer=function(d,p,w,k){if(!FR(w))throw Error(n(200));if(d==null||d._reactInternals===void 0)throw Error(n(38));return VR(d,p,w,!1,k)},Ha.version="18.3.1-next-f1338f8080-20240426",Ha}var gY;function kSe(){if(gY)return FD.exports;gY=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),FD.exports=TSe(),FD.exports}var yY;function ASe(){if(yY)return UR;yY=1;var t=kSe();return UR.createRoot=t.createRoot,UR.hydrateRoot=t.hydrateRoot,UR}var ISe=ASe();const RSe=sz(ISe);var X=gA();const PSe=sz(X),cl={ADD:"add",REMOVE:"remove"},Ow={PROPERTYCHANGE:"propertychange"},An={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class yA{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function CSe(t,e,n){let r,i;n=n||Gf;let s=0,o=t.length,a=!1;for(;s<o;)r=s+(o-s>>1),i=+n(t[r],e),i<0?s=r+1:(o=r,a=!i);return a?s:~s}function Gf(t,e){return t>e?1:t<e?-1:0}function MSe(t,e){return t<e?1:t>e?-1:0}function BN(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if(typeof n=="function"){for(let i=1;i<r;++i){const s=t[i];if(s===e)return i;if(s<e)return n(e,t[i-1],s)>0?i-1:i}return r-1}if(n>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(n<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function NSe(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function Rr(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let i=0;i<r;i++)t[t.length]=n[i]}function pp(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function OSe(t,e,n){const r=e||Gf;return t.every(function(i,s){if(s===0)return!0;const o=r(t[s-1],i);return!(o>0||o===0)})}function GT(){return!0}function WN(){return!1}function BT(){}function Doe(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return(!n||this!==r||!pp(i,n))&&(r=this,n=i,e=t.apply(this,arguments)),e}}function $oe(t){function e(){let n;try{n=t()}catch(r){return Promise.reject(r)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function C2(t){for(const e in t)delete t[e]}function c1(t){let e;for(e in t)return!1;return!e}class Md{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let vA=class extends yA{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(n)||i.push(n)}dispatchEvent(e){const n=typeof e=="string",r=n?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=n?new Md(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,a[r]=0),++o[r];let l;for(let c=0,u=i.length;c<u;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[r]===0){let c=a[r];for(delete a[r];c--;)this.removeEventListener(r,BT);delete o[r]}return l}disposeInternal(){this.listeners_&&C2(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(n);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=BT,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function Hn(t,e,n,r,i){if(i){const o=n;n=function(a){return t.removeEventListener(e,n),o.call(r??this,a)}}else r&&r!==t&&(n=n.bind(r));const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function e3(t,e,n,r){return Hn(t,e,n,r,!0)}function Jr(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),C2(t))}class _A extends vA{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(An.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Hn(this,e[s],n);return i}return Hn(this,e,n)}onceInternal(e,n){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=e3(this,e[s],n)}else r=e3(this,e,n);return n.ol_key=r,r}unInternal(e,n){const r=n.ol_key;if(r)LSe(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],n);else this.removeEventListener(e,n)}}_A.prototype.on;_A.prototype.once;_A.prototype.un;function LSe(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Jr(t[e]);else Jr(t)}function xn(){throw new Error("Unimplemented abstract method.")}let DSe=0;function _n(t){return t.ol_uid||(t.ol_uid=String(++DSe))}class vY extends Md{constructor(e,n,r){super(e),this.key=n,this.oldValue=r}}class Nd extends _A{constructor(e){super(),this.on,this.once,this.un,_n(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new vY(r,e,n)),r=Ow.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new vY(r,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,r){const i=this.values_||(this.values_={});if(r)i[e]=n;else{const s=i[e];i[e]=n,s!==n&&this.notify(e,s)}}setProperties(e,n){for(const r in e)this.set(r,e[r],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],c1(this.values_)&&(this.values_=null),n||this.notify(e,r)}}}const _Y={LENGTH:"length"};class GR extends Md{constructor(e,n,r){super(e),this.element=n,this.index=r}}class Hc extends Nd{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,r=e.length;n<r;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)e(n[r],r,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(_Y.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new GR(cl.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)if(n[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new GR(cl.REMOVE,n,e)),n}setAt(e,n){const r=this.getLength();if(e>=r){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const i=this.array_[e];this.array_[e]=n,this.dispatchEvent(new GR(cl.REMOVE,i,e)),this.dispatchEvent(new GR(cl.ADD,n,e))}updateLength_(){this.set(_Y.LENGTH,this.array_.length)}assertUnique_(e,n){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}}function ar(t,e){if(!t)throw new Error(e)}let xi=class joe extends Nd{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new joe(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Jr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Hn(e,An.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?$Se(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function $Se(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(ar(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}const Qs={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function xY(t){const e=$a();for(let n=0,r=t.length;n<r;++n)LS(e,t[n]);return e}function nd(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Foe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function H1(t,e,n){let r,i;return e<t[0]?r=t[0]-e:t[2]<e?r=e-t[2]:r=0,n<t[1]?i=t[1]-n:t[3]<n?i=n-t[3]:i=0,r*r+i*i}function u1(t,e){return oz(t,e[0],e[1])}function zm(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function oz(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function W8(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=e[0],a=e[1];let l=Qs.UNKNOWN;return o<n?l=l|Qs.LEFT:o>i&&(l=l|Qs.RIGHT),a<r?l=l|Qs.BELOW:a>s&&(l=l|Qs.ABOVE),l===Qs.UNKNOWN&&(l=Qs.INTERSECTING),l}function $a(){return[1/0,1/0,-1/0,-1/0]}function Eg(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function xA(t){return Eg(1/0,1/0,-1/0,-1/0,t)}function Voe(t,e){const n=t[0],r=t[1];return Eg(n,r,n,r,e)}function az(t,e,n,r,i){const s=xA(i);return zoe(s,t,e,n,r)}function h1(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function lz(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function LS(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function zoe(t,e,n,r,i){for(;n<r;n+=i)jSe(t,e[n],e[n+1]);return t}function jSe(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Uoe(t,e){let n;return n=e(HN(t)),n||(n=e(qN(t)),n)||(n=e(KN(t)),n)||(n=e(q1(t)),n)?n:!1}function H8(t){let e=0;return M2(t)||(e=Gn(t)*cs(t)),e}function HN(t){return[t[0],t[1]]}function qN(t){return[t[2],t[1]]}function oh(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function FSe(t,e){let n;if(e==="bottom-left")n=HN(t);else if(e==="bottom-right")n=qN(t);else if(e==="top-left")n=q1(t);else if(e==="top-right")n=KN(t);else throw new Error("Invalid corner");return n}function t3(t,e,n,r,i){const[s,o,a,l,c,u,h,f]=Goe(t,e,n,r);return Eg(Math.min(s,a,c,h),Math.min(o,l,u,f),Math.max(s,a,c,h),Math.max(o,l,u,f),i)}function Goe(t,e,n,r){const i=e*r[0]/2,s=e*r[1]/2,o=Math.cos(n),a=Math.sin(n),l=i*o,c=i*a,u=s*o,h=s*a,f=t[0],g=t[1];return[f-l+h,g-c-u,f-l-h,g-c+u,f+l-h,g+c+u,f+l+h,g+c-u,f-l+h,g-c-u]}function cs(t){return t[3]-t[1]}function Bf(t,e,n){const r=n||$a();return Ia(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):xA(r),r}function q1(t){return[t[0],t[3]]}function KN(t){return[t[2],t[3]]}function Gn(t){return t[2]-t[0]}function Ia(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function M2(t){return t[2]<t[0]||t[3]<t[1]}function VSe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function zSe(t,e,n){let r=!1;const i=W8(t,e),s=W8(t,n);if(i===Qs.INTERSECTING||s===Qs.INTERSECTING)r=!0;else{const o=t[0],a=t[1],l=t[2],c=t[3],u=e[0],h=e[1],f=n[0],g=n[1],v=(g-h)/(f-u);let x,b;s&Qs.ABOVE&&!(i&Qs.ABOVE)&&(x=f-(g-c)/v,r=x>=o&&x<=l),!r&&s&Qs.RIGHT&&!(i&Qs.RIGHT)&&(b=g-(f-l)*v,r=b>=a&&b<=c),!r&&s&Qs.BELOW&&!(i&Qs.BELOW)&&(x=f-(g-a)/v,r=x>=o&&x<=l),!r&&s&Qs.LEFT&&!(i&Qs.LEFT)&&(b=g-(f-o)*v,r=b>=a&&b<=c)}return r}function Boe(t,e){const n=e.getExtent(),r=oh(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const i=Gn(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}function Woe(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];Boe(t,e);const i=Gn(r);if(Gn(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function ii(t,e,n){return Math.min(Math.max(t,e),n)}function USe(t,e,n,r,i,s){const o=i-n,a=s-r;if(o!==0||a!==0){const l=((t-n)*o+(e-r)*a)/(o*o+a*a);l>1?(n=i,r=s):l>0&&(n+=o*l,r+=a*l)}return zy(t,e,n,r)}function zy(t,e,n,r){const i=n-t,s=r-e;return i*i+s*s}function GSe(t){const e=t.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(t[r][r]);for(let a=r+1;a<e;a++){const l=Math.abs(t[a][r]);l>s&&(s=l,i=a)}if(s===0)return null;const o=t[i];t[i]=t[r],t[r]=o;for(let a=r+1;a<e;a++){const l=-t[a][r]/t[r][r];for(let c=r;c<e+1;c++)r==c?t[a][c]=0:t[a][c]+=l*t[r][c]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}function wY(t){return t*180/Math.PI}function Wf(t){return t*Math.PI/180}function og(t,e){const n=t%e;return n*e<0?n+e:n}function Yl(t,e,n){return t+n*(e-t)}function wA(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function n3(t,e){return Math.round(wA(t,e))}function BR(t,e){return Math.floor(wA(t,e))}function Um(t,e){return Math.ceil(wA(t,e))}function q8(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}function eE(t,e,n){const r=""+t;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function Hoe(t,e){const n=(""+t).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(n.length,r.length);i++){const s=parseInt(n[i]||"0",10),o=parseInt(r[i]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function BSe(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function r3(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function cz(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,s=t[1]*n+t[0]*r;return t[0]=i,t[1]=s,t}function WSe(t,e){return t[0]*=e,t[1]*=e,t}function qoe(t,e){if(e.canWrapX()){const n=Gn(e.getExtent()),r=Koe(t,e,n);r&&(t[0]-=r*n)}return t}function Koe(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||Gn(r),i=Math.floor((t[0]-r[0])/n)),i}function Yoe(...t){console.warn(...t)}const Lw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let YN=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Lw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const bA=6378137,hx=Math.PI*bA,HSe=[-hx,-hx,hx,hx],qSe=[-180,-85,180,85],WR=bA*Math.log(Math.tan(Math.PI/2));class qv extends YN{constructor(e){super({code:e,units:"m",extent:HSe,global:!0,worldExtent:qSe,getPointResolution:function(n,r){return n/Math.cosh(r[1]/bA)}})}}const bY=[new qv("EPSG:3857"),new qv("EPSG:102100"),new qv("EPSG:102113"),new qv("EPSG:900913"),new qv("http://www.opengis.net/def/crs/EPSG/0/3857"),new qv("http://www.opengis.net/gml/srs/epsg.xml#3857")];function KSe(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=hx*t[s]/180;let o=bA*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));o>WR?o=WR:o<-WR&&(o=-WR),e[s+1]=o}return e}function YSe(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*t[s]/hx,e[s+1]=360*Math.atan(Math.exp(t[s+1]/bA))/Math.PI-90;return e}const XSe=6378137,EY=[-180,-90,180,90],ZSe=Math.PI*XSe/180;class E0 extends YN{constructor(e,n){super({code:e,units:"degrees",extent:EY,axisOrientation:n,global:!0,metersPerUnit:ZSe,worldExtent:EY})}}const SY=[new E0("CRS:84"),new E0("EPSG:4326","neu"),new E0("urn:ogc:def:crs:OGC:1.3:CRS84"),new E0("urn:ogc:def:crs:OGC:2:84"),new E0("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new E0("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new E0("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let K8={};function xC(t){return K8[t]||K8[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function JSe(t,e){K8[t]=e}let Lx={};function d1(t,e,n){const r=t.getCode(),i=e.getCode();r in Lx||(Lx[r]={}),Lx[r][i]=n}function wC(t,e){return t in Lx&&e in Lx[t]?Lx[t][e]:null}const i3=.9996,Jc=.00669438,XN=Jc*Jc,ZN=XN*Jc,xy=Jc/(1-Jc),TY=Math.sqrt(1-Jc),Dw=(1-TY)/(1+TY),Xoe=Dw*Dw,uz=Xoe*Dw,hz=uz*Dw,Zoe=hz*Dw,Joe=1-Jc/4-3*XN/64-5*ZN/256,QSe=3*Jc/8+3*XN/32+45*ZN/1024,eTe=15*XN/256+45*ZN/1024,tTe=35*ZN/3072,nTe=3/2*Dw-27/32*uz+269/512*Zoe,rTe=21/16*Xoe-55/32*hz,iTe=151/96*uz-417/128*Zoe,sTe=1097/512*hz,s3=6378137;function oTe(t,e,n){const r=t-5e5,o=(n.north?e:e-1e7)/i3/(s3*Joe),a=o+nTe*Math.sin(2*o)+rTe*Math.sin(4*o)+iTe*Math.sin(6*o)+sTe*Math.sin(8*o),l=Math.sin(a),c=l*l,u=Math.cos(a),h=l/u,f=h*h,g=f*f,v=1-Jc*c,x=Math.sqrt(1-Jc*c),b=s3/x,T=(1-Jc)/v,A=xy*u**2,I=A*A,R=r/(b*i3),M=R*R,F=M*R,C=F*R,N=C*R,O=N*R,j=a-h/T*(M/2-C/24*(5+3*f+10*A-4*I-9*xy))+O/720*(61+90*f+298*A+45*g-252*xy-3*I);let V=(R-F/6*(1+2*f+A)+N/120*(5-2*A+28*f-3*I+8*xy+24*g))/u;return V=q8(V+Wf(Qoe(n.number)),-Math.PI,Math.PI),[wY(V),wY(j)]}const kY=-80,AY=84,aTe=-180,lTe=180;function cTe(t,e,n){t=q8(t,aTe,lTe),e<kY?e=kY:e>AY&&(e=AY);const r=Wf(e),i=Math.sin(r),s=Math.cos(r),o=i/s,a=o*o,l=a*a,c=Wf(t),u=Qoe(n.number),h=Wf(u),f=s3/Math.sqrt(1-Jc*i**2),g=xy*s**2,v=s*q8(c-h,-Math.PI,Math.PI),x=v*v,b=x*v,T=b*v,A=T*v,I=A*v,R=s3*(Joe*r-QSe*Math.sin(2*r)+eTe*Math.sin(4*r)-tTe*Math.sin(6*r)),M=i3*f*(v+b/6*(1-a+g)+A/120*(5-18*a+l+72*g-58*xy))+5e5;let F=i3*(R+f*o*(x/2+T/24*(5-a+9*g+4*g**2)+I/720*(61-58*a+l+600*g-330*xy)));return n.north||(F+=1e7),[M,F]}function Qoe(t){return(t-1)*6-180+3}const uTe=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function eae(t){let e=0;for(const i of uTe){const s=t.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function IY(t,e){return function(n,r,i,s){const o=n.length;i=i>1?i:2,s=s??i,r||(i>2?r=n.slice():r=new Array(o));for(let a=0;a<o;a+=s){const l=n[a],c=n[a+1],u=t(l,c,e);r[a]=u[0],r[a+1]=u[1]}return r}}function hTe(t){return eae(t)?new YN({code:t,units:"m"}):null}function dTe(t){const e=eae(t.getCode());return e?{forward:IY(cTe,e),inverse:IY(oTe,e)}:null}const fTe=63710088e-1;function RY(t,e,n){n=n||fTe;const r=Wf(t[1]),i=Wf(e[1]),s=(i-r)/2,o=Wf(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const pTe=[dTe],mTe=[hTe];let Y8=!0;function tae(t){Y8=!1}function dz(t,e){if(e!==void 0){for(let n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function o3(t){JSe(t.getCode(),t),d1(t,t,dz)}function gTe(t){t.forEach(o3)}function Yr(t){if(typeof t!="string")return t;const e=xC(t);if(e)return e;for(const n of mTe){const r=n(t);if(r)return r}return null}function a3(t,e,n,r){t=Yr(t);let i;const s=t.getPointResolutionFunc();if(s){if(i=s(e,n),r&&r!==t.getUnits()){const o=t.getMetersPerUnit();o&&(i=i*o/Lw[r])}}else{const o=t.getUnits();if(o=="degrees"&&!r||r=="degrees")i=e;else{const a=pz(t,Yr("EPSG:4326"));if(!a&&o!=="degrees")i=e*t.getMetersPerUnit();else{let c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];c=a(c,c,2);const u=RY(c.slice(0,2),c.slice(2,4)),h=RY(c.slice(4,6),c.slice(6,8));i=(u+h)/2}const l=r?Lw[r]:t.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function X8(t){gTe(t),t.forEach(function(e){t.forEach(function(n){e!==n&&d1(e,n,dz)})})}function yTe(t,e,n,r){t.forEach(function(i){e.forEach(function(s){d1(i,s,n),d1(s,i,r)})})}function fz(t,e){return t?typeof t=="string"?Yr(t):t:Yr(e)}function Z8(t){return(function(e,n,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,n=n!==void 0?n:new Array(s);for(let o=0;o<s;o+=i){const a=t(e.slice(o,o+r)),l=a.length;for(let c=0,u=i;c<u;++c)n[o+c]=c>=l?e[o+c]:a[c]}return n})}function vTe(t,e,n,r){const i=Yr(t),s=Yr(e);d1(i,s,Z8(n)),d1(s,i,Z8(r))}function Pi(t,e){return tae(),N2(t,"EPSG:4326","EPSG:3857")}function Zn(t,e){const n=N2(t,"EPSG:3857","EPSG:4326"),r=n[0];return(r<-180||r>180)&&(n[0]=og(r+180,360)-180),n}function Uy(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||pz(t,e)===dz)&&n}function pz(t,e){const n=t.getCode(),r=e.getCode();let i=wC(n,r);if(i)return i;let s=null,o=null;for(const l of pTe)s||(s=l(t)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)i=UD(s.inverse,o.forward);else{const l=wC(n,a);l&&(i=UD(l,o.forward))}else{const l=wC(a,r);l&&(i=UD(s.inverse,l))}return i&&(o3(t),o3(e),d1(t,e,i)),i}function UD(t,e){return function(n,r,i,s){return r=t(n,r,i,s),e(r,r,i,s)}}function WT(t,e){const n=Yr(t),r=Yr(e);return pz(n,r)}function N2(t,e,n){const r=WT(e,n);if(!r){const i=Yr(e).getCode(),s=Yr(n).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(t,void 0,t.length)}function J8(t,e){return t}function lf(t,e){return Y8&&!r3(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Y8=!1,Yoe("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function nae(t,e){return t}function rd(t,e){return t}function PY(t,e,n){return function(r){let i,s;if(t.canWrapX()){const o=t.getExtent(),a=Gn(o);r=r.slice(0),s=Koe(r,t,a),s&&(r[0]=r[0]-s*a),r[0]=ii(r[0],o[0],o[2]),r[1]=ii(r[1],o[1],o[3]),i=n(r)}else i=n(r);return s&&e.canWrapX()&&(i[0]+=s*Gn(e.getExtent())),i}}function _Te(){X8(bY),X8(SY),yTe(SY,bY,KSe,YSe)}_Te();const xTe=new Array(6);function js(){return[1,0,0,1,0,0]}function rae(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],g=e[5];return t[0]=n*l+i*c,t[1]=r*l+s*c,t[2]=n*u+i*h,t[3]=r*u+s*h,t[4]=n*f+i*g+o,t[5]=r*f+s*g+a,t}function wTe(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function iae(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Yi(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function bTe(t,e,n){return rae(t,wTe(xTe,1,0,0,1,e,n))}function iu(t,e,n,r,i,s,o,a){const l=Math.sin(s),c=Math.cos(s);return t[0]=r*c,t[1]=i*l,t[2]=-r*l,t[3]=i*c,t[4]=o*r*c-a*r*l+e,t[5]=o*i*l+a*i*c+n,t}function HT(t,e){const n=ETe(e);ar(n!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return t[0]=o/n,t[1]=-i/n,t[2]=-s/n,t[3]=r/n,t[4]=(s*l-o*a)/n,t[5]=-(r*l-i*a)/n,t}function ETe(t){return t[0]*t[3]-t[1]*t[2]}const STe=[1e5,1e5,1e5,1e5,2,2];function TTe(t){return"matrix("+t.join(", ")+")"}function Q8(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function kTe(t,e){const n=Q8(t),r=Q8(e);for(let i=0;i<6;++i)if(Math.round((n[i]-r[i])*STe[i])!==0)return!1;return!0}function ld(t,e,n,r,i,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<n;l+=r){const c=t[l],u=t[l+1];s[a++]=i[0]*c+i[2]*u+i[4],s[a++]=i[1]*c+i[3]*u+i[5];for(let h=2;h<o;h++)s[a++]=t[l+h]}return s&&s.length!=a&&(s.length=a),s}function sae(t,e,n,r,i,s,o){o=o||[];const a=Math.cos(i),l=Math.sin(i),c=s[0],u=s[1];let h=0;for(let f=e;f<n;f+=r){const g=t[f]-c,v=t[f+1]-u;o[h++]=c+g*a-v*l,o[h++]=u+g*l+v*a;for(let x=f+2;x<f+r;++x)o[h++]=t[x]}return o&&o.length!=h&&(o.length=h),o}function ATe(t,e,n,r,i,s,o,a){a=a||[];const l=o[0],c=o[1];let u=0;for(let h=e;h<n;h+=r){const f=t[h]-l,g=t[h+1]-c;a[u++]=l+i*f,a[u++]=c+s*g;for(let v=h+2;v<h+r;++v)a[u++]=t[v]}return a&&a.length!=u&&(a.length=u),a}function ITe(t,e,n,r,i,s,o){o=o||[];let a=0;for(let l=e;l<n;l+=r){o[a++]=t[l]+i,o[a++]=t[l+1]+s;for(let c=l+2;c<l+r;++c)o[a++]=t[c]}return o&&o.length!=a&&(o.length=a),o}const CY=js(),RTe=[NaN,NaN];class oae extends Nd{constructor(){super(),this.extent_=$a(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Doe((e,n,r)=>{if(!r)return this.getSimplifiedGeometry(n);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return xn()}closestPointXY(e,n,r,i){return xn()}containsXY(e,n){return this.closestPointXY(e,n,RTe,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return xn()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&xA(n),this.extentRevision_=this.getRevision()}return VSe(this.extent_,e)}rotate(e,n){xn()}scale(e,n,r){xn()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return xn()}getType(){return xn()}applyTransform(e){xn()}intersectsExtent(e){return xn()}translate(e,n){xn()}transform(e,n){const r=Yr(e),i=r.getUnits()=="tile-pixels"?function(s,o,a){const l=r.getExtent(),c=r.getWorldExtent(),u=cs(c)/cs(l);iu(CY,c[0],c[3],u,-u,0,0,0);const h=ld(s,0,s.length,a,CY,o),f=WT(r,n);return f?f(h,h,a):h}:WT(r,n);return this.applyTransform(i),this}}class K1 extends oae{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return az(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return xn()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=MY(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){xn()}setLayout(e,n,r){let i;if(e)i=MY(e);else{for(let s=0;s<r;++s){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}i=n.length,e=Y1(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();sae(r,0,r.length,i,e,n,r),this.changed()}}scale(e,n,r){n===void 0&&(n=e),r||(r=oh(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();ATe(i,0,i.length,s,e,n,r,i),this.changed()}}translate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();ITe(r,0,r.length,i,e,n,r),this.changed()}}}function Y1(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function MY(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function PTe(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return ld(r,0,r.length,i,e,n)}function NY(t,e,n,r,i,s,o){const a=t[e],l=t[e+1],c=t[n]-a,u=t[n+1]-l;let h;if(c===0&&u===0)h=e;else{const f=((i-a)*c+(s-l)*u)/(c*c+u*u);if(f>1)h=n;else if(f>0){for(let g=0;g<r;++g)o[g]=Yl(t[e+g],t[n+g],f);o.length=r;return}else h=e}for(let f=0;f<r;++f)o[f]=t[h+f];o.length=r}function mz(t,e,n,r,i){let s=t[e],o=t[e+1];for(e+=r;e<n;e+=r){const a=t[e],l=t[e+1],c=zy(s,o,a,l);c>i&&(i=c),s=a,o=l}return i}function gz(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=mz(t,e,a,r,i),e=a}return i}function CTe(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=gz(t,e,a,r,i),e=a[a.length-1]}return i}function yz(t,e,n,r,i,s,o,a,l,c,u){if(e==n)return c;let h,f;if(i===0){if(f=zy(o,a,t[e],t[e+1]),f<c){for(h=0;h<r;++h)l[h]=t[e+h];return l.length=r,f}return c}u=u||[NaN,NaN];let g=e+r;for(;g<n;)if(NY(t,g-r,g,r,o,a,u),f=zy(o,a,u[0],u[1]),f<c){for(c=f,h=0;h<r;++h)l[h]=u[h];l.length=r,g+=r}else g+=r*Math.max((Math.sqrt(f)-Math.sqrt(c))/i|0,1);if(s&&(NY(t,n-r,e,r,o,a,u),f=zy(o,a,u[0],u[1]),f<c)){for(c=f,h=0;h<r;++h)l[h]=u[h];l.length=r}return c}function vz(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let h=0,f=n.length;h<f;++h){const g=n[h];c=yz(t,e,g,r,i,s,o,a,l,c,u),e=g}return c}function MTe(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let h=0,f=n.length;h<f;++h){const g=n[h];c=vz(t,e,g,r,i,s,o,a,l,c,u),e=g[g.length-1]}return c}function NTe(t,e,n,r){for(let i=0,s=n.length;i<s;++i)t[e++]=n[i];return e}function JN(t,e,n,r){for(let i=0,s=n.length;i<s;++i){const o=n[i];for(let a=0;a<r;++a)t[e++]=o[a]}return e}function EA(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=JN(t,e,n[o],r);i[s++]=l,e=l}return i.length=s,i}function aae(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=EA(t,e,n[o],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function Gm(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=e;o<n;o+=r)i[s++]=t.slice(o,o+r);return i.length=s,i}function qT(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=Gm(t,e,l,r,i[s]),e=l}return i.length=s,i}function ej(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=l.length===1&&l[0]===e?[]:qT(t,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function l3(t,e,n,r,i,s,o){let a,l;const c=(n-e)/r;if(c===1)a=e;else if(c===2)a=e,l=i;else if(c!==0){let u=t[e],h=t[e+1],f=0;const g=[0];for(let b=e+r;b<n;b+=r){const T=t[b],A=t[b+1];f+=Math.sqrt((T-u)*(T-u)+(A-h)*(A-h)),g.push(f),u=T,h=A}const v=i*f,x=CSe(g,v);x<0?(l=(v-g[-x-2])/(g[-x-1]-g[-x-2]),a=e+(-x-2)*r):a=e+x*r}o=o>1?o:2,s=s||new Array(o);for(let u=0;u<o;++u)s[u]=a===void 0?NaN:l===void 0?t[a+u]:Yl(t[a+u],t[a+r+u],l);return s}function tj(t,e,n,r,i,s){if(n==e)return null;let o;if(i<t[e+r-1])return s?(o=t.slice(e,e+r),o[r-1]=i,o):null;if(t[n-1]<i)return s?(o=t.slice(n-r,n),o[r-1]=i,o):null;if(i==t[e+r-1])return t.slice(e,e+r);let a=e/r,l=n/r;for(;a<l;){const f=a+l>>1;i<t[(f+1)*r-1]?l=f:a=f+1}const c=t[a*r-1];if(i==c)return t.slice((a-1)*r,(a-1)*r+r);const u=t[(a+1)*r-1],h=(i-c)/(u-c);o=[];for(let f=0;f<r-1;++f)o.push(Yl(t[(a-1)*r+f],t[a*r+f],h));return o.push(i),o}function OTe(t,e,n,r,i,s,o){if(o)return tj(t,e,n[n.length-1],r,i,s);let a;if(i<t[r-1])return s?(a=t.slice(0,r),a[r-1]=i,a):null;if(t[t.length-1]<i)return s?(a=t.slice(t.length-r),a[r-1]=i,a):null;for(let l=0,c=n.length;l<c;++l){const u=n[l];if(e!=u){if(i<t[e+r-1])return null;if(i<=t[u-1])return tj(t,e,u,r,i,!1);e=u}}return null}function LTe(t,e,n,r,i){return!Uoe(i,function(o){return!wy(t,e,n,r,o[0],o[1])})}function wy(t,e,n,r,i,s){let o=0,a=t[n-r],l=t[n-r+1];for(;e<n;e+=r){const c=t[e],u=t[e+1];l<=s?u>s&&(c-a)*(s-l)-(i-a)*(u-l)>0&&o++:u<=s&&(c-a)*(s-l)-(i-a)*(u-l)<0&&o--,a=c,l=u}return o!==0}function _z(t,e,n,r,i,s){if(n.length===0||!wy(t,e,n[0],r,i,s))return!1;for(let o=1,a=n.length;o<a;++o)if(wy(t,n[o-1],n[o],r,i,s))return!1;return!0}function DTe(t,e,n,r,i,s){if(n.length===0)return!1;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(_z(t,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function lae(t,e,n,r,i){let s;for(e+=r;e<n;e+=r)if(s=i(t.slice(e-r,e),t.slice(e,e+r)),s)return s;return!1}function QN(t,e,n,r,i,s){return s=s??zoe($a(),t,e,n,r),Ia(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:lae(t,e,n,r,function(o,a){return zSe(i,o,a)}):!1}function $Te(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){if(QN(t,e,n[s],r,i))return!0;e=n[s]}return!1}function cae(t,e,n,r,i){return!!(QN(t,e,n,r,i)||wy(t,e,n,r,i[0],i[1])||wy(t,e,n,r,i[0],i[3])||wy(t,e,n,r,i[2],i[1])||wy(t,e,n,r,i[2],i[3]))}function uae(t,e,n,r,i){if(!cae(t,e,n[0],r,i))return!1;if(n.length===1)return!0;for(let s=1,o=n.length;s<o;++s)if(LTe(t,n[s-1],n[s],r,i)&&!QN(t,n[s-1],n[s],r,i))return!1;return!0}function jTe(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(uae(t,e,a,r,i))return!0;e=a[a.length-1]}return!1}function xz(t,e,n,r){let i=t[e],s=t[e+1],o=0;for(let a=e+r;a<n;a+=r){const l=t[a],c=t[a+1];o+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return o}function e5(t,e,n,r,i,s,o){const a=(n-e)/r;if(a<3){for(;e<n;e+=r)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,n-r];let u=0;for(;c.length>0;){const h=c.pop(),f=c.pop();let g=0;const v=t[f],x=t[f+1],b=t[h],T=t[h+1];for(let A=f+r;A<h;A+=r){const I=t[A],R=t[A+1],M=USe(I,R,v,x,b,T);M>g&&(u=A,g=M)}g>i&&(l[(u-e)/r]=1,f+r<u&&c.push(f,u),u+r<h&&c.push(u,h))}for(let h=0;h<a;++h)l[h]&&(s[o++]=t[e+h*r],s[o++]=t[e+h*r+1]);return o}function hae(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=e5(t,e,u,r,i,s,o),a.push(o),e=u}return o}function $0(t,e){return e*Math.round(t/e)}function FTe(t,e,n,r,i,s,o){if(e==n)return o;let a=$0(t[e],i),l=$0(t[e+1],i);e+=r,s[o++]=a,s[o++]=l;let c,u;do if(c=$0(t[e],i),u=$0(t[e+1],i),e+=r,e==n)return s[o++]=c,s[o++]=u,o;while(c==a&&u==l);for(;e<n;){const h=$0(t[e],i),f=$0(t[e+1],i);if(e+=r,h==c&&f==u)continue;const g=c-a,v=u-l,x=h-a,b=f-l;if(g*b==v*x&&(g<0&&x<g||g==x||g>0&&x>g)&&(v<0&&b<v||v==b||v>0&&b>v)){c=h,u=f;continue}s[o++]=c,s[o++]=u,a=c,l=u,c=h,u=f}return s[o++]=c,s[o++]=u,o}function wz(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=FTe(t,e,u,r,i,s,o),a.push(o),e=u}return o}function VTe(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l],h=[];o=wz(t,e,u,r,i,s,o,h),a.push(h),e=u[u.length-1]}return o}class ro extends K1{constructor(e,n){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendCoordinate(e){Rr(this.flatCoordinates,e),this.changed()}clone(){const e=new ro(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,n,r,i))}forEachSegment(e){return lae(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,n){return this.layout!="XYM"&&this.layout!="XYZM"?null:(n=n!==void 0?n:!1,tj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n))}getCoordinates(){return Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,n){return l3(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,this.stride)}getLength(){return xz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const n=[];return n.length=e5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new ro(n,"XY")}getType(){return"LineString"}intersectsExtent(e){return QN(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=JN(this.flatCoordinates,0,e,this.stride),this.changed()}}let Vs=class dae extends K1{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new dae(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const s=this.flatCoordinates,o=zy(e,n,s[0],s[1]);if(o<i){const a=this.stride;for(let l=0;l<a;++l)r[l]=s[l];return r.length=a,o}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Voe(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return oz(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=NTe(this.flatCoordinates,0,e,this.stride),this.changed()}};const no={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},f1=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",zTe=f1.includes("safari")&&!f1.includes("chrom"),UTe=zTe&&(f1.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(f1)),GTe=f1.includes("webkit")&&!f1.includes("edge"),fae=f1.includes("macintosh"),BTe=typeof devicePixelRatio<"u"?devicePixelRatio:1,tc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,bz=typeof Image<"u"&&Image.prototype.decode,pae=typeof createImageBitmap=="function",mae=(function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t})(),Vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Ts(t,e,n,r){let i;return n&&n.length?i=n.shift():tc?i=new class extends OffscreenCanvas{style={}}(t??300,e??150):i=document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let GD;function c3(){return GD||(GD=Ts(1,1)),GD}function t5(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function OY(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function WTe(t){for(;t.lastChild;)t.lastChild.remove()}function HTe(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){t.appendChild(s);continue}if(!s){t.removeChild(i),--r;continue}t.insertBefore(s,i)}}}function gae(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,n,r){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,r)}})}function Bm(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}const Ez=[NaN,NaN,NaN,0];let BD;function qTe(){return BD||(BD=Ts(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),BD}const KTe=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,YTe=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,XTe=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ZTe=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function HR(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function DS(t){throw new Error('failed to parse "'+t+'" as color')}function yae(t){if(t.toLowerCase().startsWith("rgb")){const s=t.match(YTe)||t.match(KTe)||t.match(XTe);if(s){const o=s[4],a=100/255;return[ii(HR(s[1],a)+.5|0,0,255),ii(HR(s[2],a)+.5|0,0,255),ii(HR(s[3],a)+.5|0,0,255),o!==void 0?ii(HR(o,100),0,1):1]}DS(t)}if(t.startsWith("#")){if(ZTe.test(t)){const s=t.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let u=parseInt(s.substring(l,l+o),16);o===1&&(u+=u<<4),a[l/o]=u}return a[3]=a[3]/255,a}DS(t)}const e=qTe();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&DS(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return yae(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=wA(i[3]/255,3),i}function JTe(t){return typeof t=="string"?t:Tz(t)}const QTe=1024,tE={};let WD=0;function eke(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function HD(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function qD(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function KD(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function YD(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function LY(t){const e=KD(t[0]),n=KD(t[1]),r=KD(t[2]),i=YD(e*.222488403+n*.716873169+r*.06060791),s=500*(YD(e*.452247074+n*.399439023+r*.148375274)-i),o=200*(i-YD(e*.016863605+n*.117638439+r*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+o*o),a<0?a+360:a,t[3]]}function tke(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=qD(e),s=qD(e+n/500*Math.cos(r)),o=qD(e-n/200*Math.sin(r)),a=HD(s*3.021973625-i*1.617392459-o*.404875592),l=HD(s*-.943766287+i*1.916279586+o*.027607165),c=HD(s*.069407491-i*.22898585+o*1.159737864);return[ii(a+.5|0,0,255),ii(l+.5|0,0,255),ii(c+.5|0,0,255),t[3]]}function Sz(t){if(t==="none")return Ez;if(tE.hasOwnProperty(t))return tE[t];if(WD>=QTe){let n=0;for(const r in tE)(n++&3)===0&&(delete tE[r],--WD)}const e=yae(t);e.length!==4&&DS(t);for(const n of e)isNaN(n)&&DS(t);return tE[t]=e,++WD,e}function su(t){return Array.isArray(t)?t:Sz(t)}function Tz(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let r=t[2];r!=(r|0)&&(r=r+.5|0);const i=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+r+","+i+")"}class vae extends vA{constructor(e,n,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=n,this.state=typeof i=="function"?Vt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(An.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Vt.IDLE&&this.loader){this.state=Vt.LOADING,this.changed();const e=this.getResolution(),n=Array.isArray(e)?e[0]:e;$oe(()=>this.loader(this.getExtent(),n,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||pae&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Vt.LOADED}).catch(r=>{this.state=Vt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function nke(t,e,n){const r=t;let i=!0,s=!1,o=!1;const a=[e3(r,An.LOAD,function(){o=!0,s||e()})];return r.src&&bz?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(o?e():n())})):a.push(e3(r,An.ERROR,n)),function(){i=!1,a.forEach(Jr)}}function rke(t,e){return new Promise((n,r)=>{function i(){o(),n(t)}function s(){o(),r(new Error("Image load error"))}function o(){t.removeEventListener("load",i),t.removeEventListener("error",s)}t.addEventListener("load",i),t.addEventListener("error",s)})}function _ae(t,e){return e&&(t.src=e),t.src&&bz?new Promise((n,r)=>t.decode().then(()=>n(t)).catch(i=>t.complete&&t.width?n(t):r(i))):rke(t)}function xae(t,e){return e&&(t.src=e),t.src&&bz&&pae?t.decode().then(()=>createImageBitmap(t)).catch(n=>{if(t.complete&&t.width)return t;throw n}):_ae(t)}class ike{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const r=this.cache_[n];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,r){const i=XD(e,n,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,n,r){const i=XD(e,n,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,n,r,i,s){const o=XD(e,n,r),a=o in this.cache_;this.cache_[o]=i,s&&(i.getImageState()===Vt.IDLE&&i.load(),i.getImageState()===Vt.LOADING?i.ready().then(()=>{this.patternCache_[o]=c3().createPattern(i.getImage(1),"repeat")}):this.patternCache_[o]=c3().createPattern(i.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function XD(t,e,n){const r=n?su(n):"null";return e+":"+t+":"+r}const qc=new ike;let nE=null;class wae extends vA{constructor(e,n,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Vt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Vt.LOADED){nE||(nE=Ts(1,1,void 0,{willReadFrequently:!0})),nE.drawImage(this.image_,0,0);try{nE.getImageData(0,0,1,1),this.tainted_=!1}catch{nE=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(An.CHANGE)}handleImageError_(){this.imageState_=Vt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Vt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],r=Ts(e,n);r.fillRect(0,0,e,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Vt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Vt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&_ae(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Vt.LOADED)return;const n=this.image_,r=Ts(Math.ceil(n.width*e),Math.ceil(n.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(n,0,0),r.globalCompositeOperation="multiply",r.fillStyle=JTe(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(n,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Vt.LOADED||this.imageState_===Vt.ERROR)e();else{const n=()=>{(this.imageState_===Vt.LOADED||this.imageState_===Vt.ERROR)&&(this.removeEventListener(An.CHANGE,n),e())};this.addEventListener(An.CHANGE,n)}})),this.ready_}}function u3(t,e,n,r,i,s){let o=e===void 0?void 0:qc.get(e,n,i);return o||(o=new wae(t,t&&"src"in t?t.src||void 0:e,n,r,i),qc.set(e,n,i,o,s)),s&&o&&!qc.getPattern(e,n,i)&&qc.set(e,n,i,o,s),o}function id(t){return t?Array.isArray(t)?Tz(t):typeof t=="object"&&"src"in t?ske(t):t:null}function ske(t){if(!t.offset||!t.size)return qc.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=qc.getPattern(e,void 0,t.color);if(n)return n;const r=qc.get(t.src,"anonymous",null);if(r.getImageState()!==Vt.LOADED)return null;const i=Ts(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),u3(i.canvas,e,void 0,Vt.LOADED,t.color,!0),qc.getPattern(e,void 0,t.color)}class bae{drawCustom(e,n,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,r){}drawFeature(e,n,r){}drawGeometryCollection(e,n,r){}drawLineString(e,n,r){}drawMultiLineString(e,n,r){}drawMultiPoint(e,n,r){}drawMultiPolygon(e,n,r){}drawPoint(e,n,r){}drawPolygon(e,n,r){}drawText(e,n,r){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const qR="ol-hidden",SA="ol-unselectable",kz="ol-control",DY="ol-collapsed",oke=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),$Y=["style","variant","weight","size","lineHeight","family"],nj={normal:400,bold:700},rj=function(t){const e=t.match(oke);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=$Y.length;r<i;++r){const s=e[r+1];s!==void 0&&(n[$Y[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(n.weight))&&n.weight in nj&&(n.weight=nj[n.weight]),n.families=n.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),n},Eae="10px sans-serif",ul="#000",$w="round",Hf=[],qf=0,jw="round",KT=10,YT="#000",XT="center",h3="middle",by=[0,0,0,0],ZT=1,A_=new Nd;let rE=null,jY;const ij={},ake=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function lke(t,e,n){return`${t} ${e} 16px "${n}"`}const cke=(function(){let e,n;async function r(s){await n.ready;const o=await n.load(s);if(o.length===0)return!1;const a=rj(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(u=>{const h=u.family.replace(/^['"]|['"]$/g,"").toLowerCase(),f=nj[u.weight]||u.weight;return h===l&&u.style===a.style&&f==c})}async function i(){await n.ready;let s=!0;const o=A_.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let u=o[c];u<100&&(await r(c)?(C2(ij),A_.set(c,100)):(u+=10,A_.set(c,u,!0),u<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){n||(n=tc?self.fonts:document.fonts);const o=rj(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(ake.has(c))continue;const u=lke(o.style,o.weight,c);A_.get(u)===void 0&&(A_.set(u,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),uke=(function(){let t;return function(e){let n=ij[e];if(n==null){if(tc){const r=rj(e),i=Sae(e,"g");n=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);ij[e]=n}return n}})();function Sae(t,e){return rE||(rE=Ts(1,1)),t!=jY&&(rE.font=t,jY=rE.font),rE.measureText(e)}function Tae(t,e){return Sae(t,e).width}function FY(t,e,n){if(e in n)return n[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,Tae(t,s)),0);return n[e]=r,r}function hke(t,e){const n=[],r=[],i=[];let s=0,o=0,a=0,l=0;for(let c=0,u=e.length;c<=u;c+=2){const h=e[c];if(h===`
`||c===u){s=Math.max(s,o),i.push(o),o=0,a+=l,l=0;continue}const f=e[c+1]||t.font,g=Tae(f,h);n.push(g),o+=g;const v=uke(f);r.push(v),l=Math.max(l,v)}return{width:s,height:a,widths:n,heights:r,lineWidths:i}}function dke(t,e,n,r,i,s,o,a,l,c,u){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=h=>h.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(l,c),t.scale(u[0],u[1]),fke(r,t)):u[0]<0||u[1]<0?(t.translate(l,c),t.scale(u[0],u[1]),t.drawImage(r,i,s,o,a,0,0,o,a)):t.drawImage(r,i,s,o,a,l,c,o*u[0],a*u[1]),t.restore()}function fke(t,e){const n=t.contextInstructions;for(let r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}class pke extends bae{constructor(e,n,r,i,s,o,a){super(),this.context_=e,this.pixelRatio_=n,this.extent_=r,this.transform_=i,this.transformRotation_=i?wA(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=js()}drawImages_(e,n,r,i){if(!this.image_)return;const s=ld(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,h=s.length;u<h;u+=2){const f=s[u]-this.imageAnchorX_,g=s[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=f+this.imageAnchorX_,x=g+this.imageAnchorY_;iu(a,v,x,1,1,c,-v,-x),o.save(),o.transform.apply(o,a),o.translate(v,x),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,n,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=ld(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);n<r;n+=i){const l=s[n]+this.textOffsetX_,c=s[n+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,n,r,i,s){const o=this.context_,a=ld(e,n,r,i,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),r}drawRings_(e,n,r,i){for(let s=0,o=r.length;s<o;++s)n=this.moveToLineTo_(e,n,r[s],i,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=PTe(e,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],i=n[3]-n[1],s=Math.sqrt(r*r+i*i),o=this.context_;o.beginPath(),o.arc(n[0],n[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const r=n.getGeometryFunction()(e);r&&(this.setStyle(n),this.drawGeometry(r))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let r=0,i=n.length;r<i;++r)this.drawGeometry(n[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(Ia(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();r.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(i,s,o[l],a,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),o=e.getStride();n.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];i=this.drawRings_(r,i,c,o)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,n.lineCap=e.lineCap),pp(r.lineDash,e.lineDash)||n.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:XT;r?(r.font!=e.font&&(r.font=e.font,n.font=e.font),r.textAlign!=i&&(r.textAlign=i,n.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=i,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:id(r||ul)}}if(!n)this.strokeState_=null;else{const r=n.getColor(),i=n.getLineCap(),s=n.getLineDash(),o=n.getLineDashOffset(),a=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit(),u=s||Hf;this.strokeState_={lineCap:i!==void 0?i:$w,lineDash:this.pixelRatio_===1?u:u.map(h=>h*this.pixelRatio_),lineDashOffset:(o||qf)*this.pixelRatio_,lineJoin:a!==void 0?a:jw,lineWidth:(l!==void 0?l:ZT)*this.pixelRatio_,miterLimit:c!==void 0?c:KT,strokeStyle:id(r||YT)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=n[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/r,o[1]*this.pixelRatio_/r],this.imageWidth_=n[0]*r}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const g=n.getColor();this.textFillState_={fillStyle:id(g||ul)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const g=r.getColor(),v=r.getLineCap(),x=r.getLineDash(),b=r.getLineDashOffset(),T=r.getLineJoin(),A=r.getWidth(),I=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:$w,lineDash:x||Hf,lineDashOffset:b||qf,lineJoin:T!==void 0?T:jw,lineWidth:A!==void 0?A:ZT,miterLimit:I!==void 0?I:KT,strokeStyle:id(g||YT)}}const i=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),u=e.getText(),h=e.getTextAlign(),f=e.getTextBaseline();this.textState_={font:i!==void 0?i:Eae,textAlign:h!==void 0?h:XT,textBaseline:f!==void 0?f:h3},this.text_=u!==void 0?Array.isArray(u)?u.reduce((g,v,x)=>g+=x%2?" ":v,""):u:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const mke=.5,kae={Point:Eke,LineString:xke,Polygon:Tke,MultiPoint:Ske,MultiLineString:wke,MultiPolygon:bke,GeometryCollection:_ke,Circle:yke};function gke(t,e){return parseInt(_n(t),10)-parseInt(_n(e),10)}function VY(t,e){const n=Aae(t,e);return n*n}function Aae(t,e){return mke*t/e}function yke(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}}function zY(t,e,n,r,i,s,o,a){const l=[],c=n.getImage();if(c){let f=!0;const g=c.getImageState();g==Vt.LOADED||g==Vt.ERROR?f=!1:g==Vt.IDLE&&c.load(),f&&l.push(c.ready())}const u=n.getFill();u&&u.loading()&&l.push(u.ready());const h=l.length>0;return h&&Promise.all(l).then(()=>i(null)),vke(t,e,n,r,s,o,a),h}function vke(t,e,n,r,i,s,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(r,i);if(n.getRenderer())Iae(t,l,n,e,o);else{const u=kae[l.getType()];u(t,l,n,e,o,s)}}function Iae(t,e,n,r,i){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)Iae(t,o[a],n,r,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i)}function _ke(t,e,n,r,i,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=kae[o[a].getType()];c(t,o[a],n,r,i,s)}}function xke(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function wke(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function bke(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(o||s){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}function Eke(t,e,n,r,i,s){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=Vt.LOADED)return;const u=t.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,c),u.drawPoint(e,r,i)}if(l){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(e,r,i)}}function Ske(t,e,n,r,i,s){const o=n.getImage(),a=o&&o.getOpacity()!==0,l=n.getText(),c=l&&l.getText(),u=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=Vt.LOADED)return;const h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(o,u),h.drawMultiPoint(e,r,i)}if(c){const h=t.getBuilder(n.getZIndex(),"Text");h.setTextStyle(l,u),h.drawText(e,r,i)}}function Tke(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}let kke=!1;function Ake(t,e,n,r,i,s,o){const a=new XMLHttpRequest;a.open("GET",typeof t=="function"?t(n,r,i):t,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=kke,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let u;c=="text"||c=="json"?u=a.responseText:c=="xml"?u=a.responseXML||a.responseText:c=="arraybuffer"&&(u=a.response),u?s(e.readFeatures(u,{extent:n,featureProjection:i}),e.readProjection(u)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function UY(t,e){return function(n,r,i,s,o){Ake(t,e,n,r,i,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function Ike(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Rae(t,e,n,r){const i=[];let s=$a();for(let o=0,a=n.length;o<a;++o){const l=n[o];s=az(t,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function Az(t,e,n,r,i,s,o){let a,l,c,u,h,f,g;const v=i[s+1],x=[];for(let A=0,I=n.length;A<I;++A){const R=n[A];for(u=t[R-r],f=t[R-r+1],a=e;a<R;a+=r)h=t[a],g=t[a+1],(v<=f&&g<=v||f<=v&&v<=g)&&(c=(v-f)/(g-f)*(h-u)+u,x.push(c)),u=h,f=g}let b=NaN,T=-1/0;for(x.sort(Gf),u=x[0],a=1,l=x.length;a<l;++a){h=x[a];const A=Math.abs(h-u);A>T&&(c=(u+h)/2,_z(t,e,n,r,c,v)&&(b=c,T=A)),u=h}return isNaN(b)&&(b=i[s]),o?(o.push(b,v,T),o):[b,v,T]}function Pae(t,e,n,r,i){let s=[];for(let o=0,a=n.length;o<a;++o){const l=n[o];s=Az(t,e,l,r,i,2*o,s),e=l[l.length-1]}return s}function Rke(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const s=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=s}e+=r,n-=r}}function Iz(t,e,n,r){let i=0,s=t[n-r],o=t[n-r+1];for(;e<n;e+=r){const a=t[e],l=t[e+1];i+=(a-s)*(l+o),s=a,o=l}return i===0?void 0:i>0}function Rz(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=Iz(t,e,a,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=a}return!0}function Cae(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!Rz(t,e,a,r,i))return!1;a.length&&(e=a[a.length-1])}return!0}function d3(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=Iz(t,e,a,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&Rke(t,e,a,r),e=a}return e}function sj(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s)e=d3(t,e,n[s],r,i);return e}function Mae(t,e){const n=[];let r=0,i=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=Iz(t,r,l,2);if(s===void 0&&(s=c),c===s)n.push(e.slice(i,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[i])}i=o+1,r=l}return n}class eh extends oae{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Jr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)this.changeEventsKeys_.push(Hn(e[n],An.CHANGE,this.changed,this))}clone(){const e=new eh(ZD(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<H1(this.getExtent(),e,n))return i;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)i=s[o].closestPointXY(e,n,r,i);return i}containsXY(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,n))return!0;return!1}computeExtent(e){xA(e);const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)lz(e,n[r].getExtent());return e}getGeometries(){return ZD(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].getType()===this.getType()?e=e.concat(n[r].getGeometriesArrayRecursive()):e.push(n[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=[],r=this.geometries_;let i=!1;for(let s=0,o=r.length;s<o;++s){const a=r[s],l=a.getSimplifiedGeometry(e);n.push(l),l!==a&&(i=!0)}return i?new eh(n):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)if(n[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,n);this.changed()}scale(e,n,r){r||(r=oh(this.getExtent()));const i=this.geometries_;for(let s=0,o=i.length;s<o;++s)i[s].scale(e,n,r);this.changed()}setGeometries(e){this.setGeometriesArray(ZD(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].applyTransform(e);this.changed()}translate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,n);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function ZD(t){return t.map(e=>e.clone())}function Nae(t,e,n,r){let i=0;const s=t[n-r],o=t[n-r+1];let a=0,l=0;for(;e<n;e+=r){const c=t[e]-s,u=t[e+1]-o;i+=l*c-a*u,a=c,l=u}return i/2}function Oae(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=Nae(t,e,a,r),e=a}return i}function Pke(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=Oae(t,e,a,r),e=a[a.length-1]}return i}class JT extends K1{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new JT(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(mz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,r,i))}getArea(){return Nae(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=e5(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new JT(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=JN(this.flatCoordinates,0,e,this.stride),this.changed()}}class np extends K1{constructor(e,n,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,n);else if(n!==void 0&&r)this.setFlatCoordinates(n,e),this.ends_=r;else{const i=e,s=[],o=[];for(let l=0,c=i.length;l<c;++l){const u=i[l];Rr(s,u.getFlatCoordinates()),o.push(s.length)}const a=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){Rr(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new np(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gz(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vz(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,n,r,i))}getCoordinateAtM(e,n,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(n=n!==void 0?n:!1,r=r!==void 0?r:!1,OTe(this.flatCoordinates,0,this.ends_,this.stride,e,n,r))}getCoordinates(){return qT(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new ro(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,n=this.ends_,r=this.layout,i=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=new ro(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let n=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=xz(this.flatCoordinates,n,e[i],this.stride),n=e[i];return r}getFlatMidpoints(){const e=[],n=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=l3(n,r,l,s,.5);Rr(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=hae(this.flatCoordinates,0,this.ends_,this.stride,e,n,0,r),new np(n,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return $Te(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=EA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class X1 extends K1{constructor(e,n){super(),n&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendPoint(e){Rr(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new X1(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<H1(this.getExtent(),e,n))return i;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=zy(e,n,s[a],s[a+1]);if(c<i){i=c;for(let u=0;u<o;++u)r[u]=s[a+u];r.length=o}}return i}getCoordinates(){return Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const n=this.flatCoordinates.length/this.stride;return e<0||n<=e?null:new Vs(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,n=this.layout,r=this.stride,i=[];for(let s=0,o=e.length;s<o;s+=r){const a=new Vs(e.slice(s,s+r),n);i.push(a)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const n=this.flatCoordinates,r=this.stride;for(let i=0,s=n.length;i<s;i+=r){const o=n[i],a=n[i+1];if(oz(e,o,a))return!0}return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=JN(this.flatCoordinates,0,e,this.stride),this.changed()}}class ou extends K1{constructor(e,n,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&r?(this.setFlatCoordinates(n,e),this.ends_=r):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?Rr(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ou(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gz(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vz(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return _z(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return Oae(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),d3(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,qT(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=oh(this.getExtent());this.flatInteriorPoint_=Az(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Vs(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new JT(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=new JT(n.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Rz(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=d3(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=wz(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,r),new ou(n,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return uae(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=EA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function GY(t){if(M2(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],s=[e,n,e,i,r,i,r,n,e,n];return new ou(s,"XY",[s.length])}class p1 extends K1{constructor(e,n,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],o=[];for(let a=0,l=i.length;a<l;++a){const c=i[a],u=s.length,h=c.getEnds();for(let f=0,g=h.length;f<g;++f)h[f]+=u;Rr(s,c.getFlatCoordinates()),o.push(h)}n=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=o}n!==void 0&&r?(this.setFlatCoordinates(n,e),this.endss_=r):this.setCoordinates(e,n)}appendPolygon(e){let n;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),n=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Rr(this.flatCoordinates,e.getFlatCoordinates()),n=e.getEnds().slice();for(let i=0,s=n.length;i<s;++i)n[i]+=r}this.endss_.push(n),this.changed()}clone(){const e=this.endss_.length,n=new Array(e);for(let i=0;i<e;++i)n[i]=this.endss_[i].slice();const r=new p1(this.flatCoordinates.slice(),this.layout,n);return r.applyProperties(this),r}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(CTe(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),MTe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return DTe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,n)}getArea(){return Pke(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),sj(n,0,this.endss_,this.stride,e)):n=this.flatCoordinates,ej(n,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=Rae(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Pae(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new X1(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Cae(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=sj(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=VTe(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),n,0,r),new p1(n,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let n;if(e===0)n=0;else{const s=this.endss_[e-1];n=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(n!==0)for(let s=0,o=r.length;s<o;++s)r[s]-=n;return new ou(this.flatCoordinates.slice(n,i),this.layout,r)}getPolygons(){const e=this.layout,n=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o].slice(),c=l[l.length-1];if(s!==0)for(let h=0,f=l.length;h<f;++h)l[h]-=s;const u=new ou(n.slice(s,c),e,l);i.push(u),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return jTe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=aae(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const BY=js();class hl{constructor(e,n,r,i,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Voe(this.flatCoordinates_):az(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=oh(this.getExtent());this.flatInteriorPoints_=Az(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Mae(this.flatCoordinates_,this.ends_),n=Rae(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Pae(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=l3(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const o=r[i],a=l3(e,n,o,2,.5);Rr(this.flatMidpoints_,a),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Yr(e);const n=e.getExtent(),r=e.getWorldExtent();if(n&&r){const i=cs(r)/cs(n);iu(BY,r[0],r[3],i,-i,0,0,0),ld(this.flatCoordinates_,0,this.flatCoordinates_.length,2,BY,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new hl(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Doe((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=e5(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=hae(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=wz(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new hl(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}hl.prototype.getFlatCoordinates=hl.prototype.getOrientedFlatCoordinates;function Lae(t,e,n=0,r=t.length-1,i=Cke){for(;r>n;){if(r-n>600){const l=r-n+1,c=e-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),g=Math.max(n,Math.floor(e-c*h/l+f)),v=Math.min(r,Math.floor(e+(l-c)*h/l+f));Lae(t,e,g,v,i)}const s=t[e];let o=n,a=r;for(iE(t,n,e),i(t[r],s)>0&&iE(t,n,r);o<a;){for(iE(t,o,a),o++,a--;i(t[o],s)<0;)o++;for(;i(t[a],s)>0;)a--}i(t[n],s)===0?iE(t,n,a):(a++,iE(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function iE(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Cke(t,e){return t<e?-1:t>e?1:0}let Dae=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!YR(e,n))return r;const i=this.toBBox,s=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?i(a):a;YR(e,l)&&(n.leaf?r.push(a):QD(e,l)?this._all(a,r):s.push(a))}n=s.pop()}return r}collides(e){let n=this.data;if(!YR(e,n))return!1;const r=[];for(;n;){for(let i=0;i<n.children.length;i++){const s=n.children[i],o=n.leaf?this.toBBox(s):s;if(YR(e,o)){if(n.leaf||QD(e,o))return!0;r.push(s)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=I_([]),this}remove(e,n){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],o=[];let a,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),r.leaf){const u=Mke(e,r.children,n);if(u!==-1)return r.children.splice(u,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&QD(r,i)?(s.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,i){const s=r-n+1;let o=this._maxEntries,a;if(s<=o)return a=I_(e.slice(n,r+1)),Kv(a,this.toBBox),a;i||(i=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,i-1))),a=I_([]),a.leaf=!1,a.height=i;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));WY(e,n,r,c,this.compareMinX);for(let u=n;u<=r;u+=c){const h=Math.min(u+c-1,r);WY(e,u,h,l,this.compareMinY);for(let f=u;f<=h;f+=l){const g=Math.min(f+l-1,h);a.children.push(this._build(e,f,g,i-1))}}return Kv(a,this.toBBox),a}_chooseSubtree(e,n,r,i){for(;i.push(n),!(n.leaf||i.length-1===r);){let s=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],u=JD(c),h=Lke(e,c)-u;h<o?(o=h,s=u<s?u:s,a=c):h===o&&u<s&&(s=u,a=c)}n=a||n.children[0]}return n}_insert(e,n,r){const i=r?e:this.toBBox(e),s=[],o=this._chooseSubtree(i,this.data,n,s);for(o.children.push(e),VE(o,i);n>=0&&s[n].children.length>this._maxEntries;)this._split(s,n),n--;this._adjustParentBBoxes(i,s,n)}_split(e,n){const r=e[n],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const o=this._chooseSplitIndex(r,s,i),a=I_(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Kv(r,this.toBBox),Kv(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,n){this.data=I_([e,n]),this.data.height=e.height+1,this.data.leaf=!1,Kv(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let i,s=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=FE(e,0,a,this.toBBox),c=FE(e,a,r,this.toBBox),u=Dke(l,c),h=JD(l)+JD(c);u<s?(s=u,i=a,o=h<o?h:o):u===s&&h<o&&(o=h,i=a)}return i||r-n}_chooseSplitAxis(e,n,r){const i=e.leaf?this.compareMinX:Nke,s=e.leaf?this.compareMinY:Oke,o=this._allDistMargin(e,n,r,i),a=this._allDistMargin(e,n,r,s);o<a&&e.children.sort(i)}_allDistMargin(e,n,r,i){e.children.sort(i);const s=this.toBBox,o=FE(e,0,n,s),a=FE(e,r-n,r,s);let l=KR(o)+KR(a);for(let c=n;c<r-n;c++){const u=e.children[c];VE(o,e.leaf?s(u):u),l+=KR(o)}for(let c=r-n-1;c>=n;c--){const u=e.children[c];VE(a,e.leaf?s(u):u),l+=KR(a)}return l}_adjustParentBBoxes(e,n,r){for(let i=r;i>=0;i--)VE(n[i],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():Kv(e[n],this.toBBox)}};function Mke(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function Kv(t,e){FE(t,0,t.children.length,e,t)}function FE(t,e,n,r,i){i||(i=I_(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<n;s++){const o=t.children[s];VE(i,t.leaf?r(o):o)}return i}function VE(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Nke(t,e){return t.minX-e.minX}function Oke(t,e){return t.minY-e.minY}function JD(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function KR(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Lke(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Dke(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function QD(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function YR(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function I_(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function WY(t,e,n,r,i){const s=[e,n];for(;s.length;){if(n=s.pop(),e=s.pop(),n-e<=r)continue;const o=e+Math.ceil((n-e)/r/2)*r;Lae(t,o,e,n,i),s.push(e,o,o,n)}}class HY{constructor(e){this.rbush_=new Dae(e),this.items_={}}insert(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[_n(n)]=r}load(e,n){const r=new Array(n.length);for(let i=0,s=n.length;i<s;i++){const o=e[i],a=n[i],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};r[i]=l,this.items_[_n(a)]=l}this.rbush_.load(r)}remove(e){const n=_n(e),r=this.items_[n];return delete this.items_[n],this.rbush_.remove(r)!==null}update(e,n){const r=this.items_[_n(n)],i=[r.minX,r.minY,r.maxX,r.maxY];h1(i,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let r;for(let i=0,s=e.length;i<s;i++)if(r=n(e[i]),r)return r;return r}isEmpty(){return c1(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return Eg(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class Pz extends Nd{constructor(e){super(),this.projection=Yr(e.projection),this.attributions_=qY(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(r,i){n.viewResolver=r,n.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=qY(e),this.changed()}setState(e){this.state_=e,this.changed()}}function qY(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const Xo={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Hp extends Md{constructor(e,n,r){super(e),this.feature=n,this.features=r}}class Od extends Pz{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=BT,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(ar(this.format_,"`format` must be set when `url` is set"),this.loader_=UY(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Ike;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new HY:null,this.loadedExtentsRtree_=new HY,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!n&&r===void 0&&(r=new Hc(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=_n(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new Hp(Xo.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof hl||(this.featureChangeKeys_[e]=[Hn(n,An.CHANGE,this.handleFeatureChange_,this),Hn(n,Ow.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let r=!0;if(n.getId()!==void 0){const i=String(n.getId());if(!(i in this.idIndex_))this.idIndex_[i]=n;else if(n instanceof hl){const s=this.idIndex_[i];s instanceof hl?Array.isArray(s)?s.push(n):this.idIndex_[i]=[s,n]:r=!1}else r=!1}return r&&(ar(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],r=[],i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=_n(a);this.addToIndex_(l,a)&&r.push(a)}for(let s=0,o=r.length;s<o;s++){const a=r[s],l=_n(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const u=c.getExtent();n.push(u),i.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(Xo.ADDFEATURE))for(let s=0,o=r.length;s<o;s++)this.dispatchEvent(new Hp(Xo.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(Xo.ADDFEATURE,function(r){n||(n=!0,e.push(r.feature),n=!1)}),this.addEventListener(Xo.REMOVEFEATURE,function(r){n||(n=!0,e.remove(r.feature),n=!1)}),e.addEventListener(cl.ADD,r=>{n||(n=!0,this.addFeature(r.element),n=!1)}),e.addEventListener(cl.REMOVE,r=>{n||(n=!0,this.removeFeature(r.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(Jr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new Hp(Xo.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof hl||s.intersectsCoordinate(e))return n(i)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof hl||i.intersectsExtent(e)){const s=n(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),c1(this.nullGeometryFeatures_)||Rr(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){n.push(r)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=Woe(e,n);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const r=e[0],i=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return n=n||GT,this.featuresRtree_.forEachInExtent(l,function(c){if(n(c)){const u=c.getGeometry(),h=a;if(a=u instanceof hl?0:u.closestPointXY(r,i,o,a),a<h){s=c;const f=Math.sqrt(a);l[0]=r-f,l[1]=i-f,l[2]=r+f,l[3]=i+f}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,r=_n(n),i=n.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{const o=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const s=n.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new Hp(Xo.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:_n(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&c1(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,n,r);for(let o=0,a=s.length;o<a;++o){const l=s[o];i.forEachInExtent(l,function(u){return zm(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Hp(Xo.FEATURESLOADSTART)),this.loader_.call(this,l,n,r,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new Hp(Xo.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Hp(Xo.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,r=n.forEachInExtent(e,function(i){if(h1(i.extent,e))return i});r&&n.remove(r)}removeFeatures(e){let n=!1;for(let r=0,i=e.length;r<i;++r)n=this.removeFeatureInternal(e[r])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=_n(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[n]?.forEach(Jr),delete this.featureChangeKeys_[n];const i=e.getId();if(i!==void 0){const s=i.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[n],this.hasListener(Xo.REMOVEFEATURE)&&this.dispatchEvent(new Hp(Xo.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){ar(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(UY(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Nr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Nr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=u3(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===Vt.IDLE&&n.load(),n.getImageState()===Vt.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?_n(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:su(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Sr{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Sr({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function KY(t){return t[0]>0&&t[1]>0}function $ke(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function Ca(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}class n5{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ca(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new n5({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return xn()}getImage(e){return xn()}getHitDetectionImage(){return xn()}getPixelRatio(e){return 1}getImageState(){return xn()}getImageSize(){return xn()}getOrigin(){return xn()}getSize(){return xn()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ca(e)}listenImageChange(e){xn()}load(){xn()}unlistenImageChange(e){xn()}ready(){return Promise.resolve()}}class r5 extends n5{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Vt.LOADING:Vt.LOADED,this.imageState_===Vt.LOADING&&this.ready().then(()=>this.imageState_=Vt.LOADED),this.render()}clone(){const e=this.getScale(),n=new r5({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-n[0]/r[0],e[1]/2+n[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const n=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let i=qc.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=Ts(o,o);this.draw_(s,a,e),i=a.canvas,qc.set(r,null,null,new wae(i,void 0,null,Vt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,r){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const F=i;i=s,s=F}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),u=i-c,h=Math.sqrt(l*l+u*u),f=h/l;if(e==="miter"&&f<=r)return f*n;const g=n/2/f,v=n/2*(u/h),b=Math.sqrt((i+g)*(i+g)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return b*2;const T=i*Math.sin(a),A=Math.sqrt(i*i-T*T),I=s-A,M=Math.sqrt(T*T+I*I)/T;if(M<=r){const F=M*n/2-s-i;return 2*Math.max(b,F)}return b*2}createRenderOptions(){let e=$w,n=jw,r=0,i=null,s=0,o,a=0;this.stroke_&&(o=id(this.stroke_.getColor()??YT),a=this.stroke_.getWidth()??ZT,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??jw,e=this.stroke_.getLineCap()??$w,r=this.stroke_.getMiterLimit()??KT);const l=this.calculateLineJoinSize_(n,a,r),c=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:u,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,r){if(n.scale(r,r),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let i=this.fill_.getColor();i===null&&(i=ul),n.fillStyle=id(i),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=su(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(n=Ts(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const r=this.radius;if(n===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let a=0;a<n;a++){const l=s+a*o,c=a%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=ul,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class ja extends r5{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new ja({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class zn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=YY,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new zn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=YY,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function jke(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(ar(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let e6=null;function $ae(t,e){if(!e6){const n=new Nr({color:"rgba(255,255,255,0.4)"}),r=new Sr({color:"#3399CC",width:1.25});e6=[new zn({image:new ja({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return e6}function YY(t){return t.getGeometry()}const Fke="#333";class th{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Ca(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Nr({color:Fke}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new th({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Nr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ca(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const ws={ANIMATING:0,INTERACTING:1},an={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},XR=[an.FILL],Wm=[an.STROKE],Ey=[an.BEGIN_PATH],XY=[an.CLOSE_PATH];class TA extends bae{constructor(e,n,r,i){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(r){return r*n})}appendFlatPointCoordinates(e,n){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=n)i[0]=e[a],i[1]=e[a+1],u1(r,i)&&(s[o++]=i[0],s[o++]=i[1]);return o}appendFlatLineCoordinates(e,n,r,i,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(n+=i);let u=e[n],h=e[n+1];const f=this.tmpCoordinate_;let g=!0,v,x,b;for(v=n+i;v<r;v+=i)f[0]=e[v],f[1]=e[v+1],b=W8(c,f),b!==x?(g&&(a[l++]=u,a[l++]=h,g=!1),a[l++]=f[0],a[l++]=f[1]):b===Qs.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],g=!1):g=!0,u=f[0],h=f[1],x=b;return(s&&g||v===n+i)&&(a[l++]=u,a[l++]=h),l}drawCustomCoordinates_(e,n,r,i,s){for(let o=0,a=r.length;o<a;++o){const l=r[o],c=this.appendFlatLineCoordinates(e,n,l,i,!1,!1);s.push(c),n=l}return n}drawCustom(e,n,r,i,s){this.beginGeometry(e,n,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,u,h,f,g;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),f=[];const v=e.getEndss();g=0;for(let x=0,b=v.length;x<b;++x){const T=[];g=this.drawCustomCoordinates_(c,g,v[x],a,T),f.push(T)}this.instructions.push([an.CUSTOM,l,f,e,r,ej,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,f,e,i||r,ej,s]);break;case"Polygon":case"MultiLineString":h=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),g=this.drawCustomCoordinates_(c,0,e.getEnds(),a,h),this.instructions.push([an.CUSTOM,l,h,e,r,qT,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,h,e,i||r,qT,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([an.CUSTOM,l,u,e,r,Gm,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,u,e,i||r,Gm,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(c,a),u>l&&(this.instructions.push([an.CUSTOM,l,u,e,r,Gm,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,u,e,i||r,Gm,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),u=this.coordinates.length,this.instructions.push([an.CUSTOM,l,u,e,r,void 0,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,u,e,i||r,void 0,s]);break}this.endGeometry(n)}beginGeometry(e,n,r){this.beginGeometryInstruction1_=[an.BEGIN_GEOMETRY,n,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[an.BEGIN_GEOMETRY,n,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const r=e.length;let i,s,o=-1;for(n=0;n<r;++n)i=e[n],s=i[0],s==an.END_GEOMETRY?o=n:s==an.BEGIN_GEOMETRY&&(i[2]=n,NSe(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const r=e.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=id(r||ul)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const r=e.getColor();n.strokeStyle=id(r||YT);const i=e.getLineCap();n.lineCap=i!==void 0?i:$w;const s=e.getLineDash();n.lineDash=s?s.slice():Hf;const o=e.getLineDashOffset();n.lineDashOffset=o||qf;const a=e.getLineJoin();n.lineJoin=a!==void 0?a:jw;const l=e.getWidth();n.lineWidth=l!==void 0?l:ZT;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:KT,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(n,r)}createFill(e){const n=e.fillStyle,r=[an.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[an.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,n){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!pp(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(n.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[an.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Foe(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;nd(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Vke extends TA{constructor(e,n,r,i){super(e,n,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,r){if(!this.image_||this.maxExtent&&!u1(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(i,s);this.instructions.push([an.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([an.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,r){if(!this.image_)return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||u1(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([an.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([an.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class zke extends TA{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinates_(e,n,r,i){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,n,r,i,!1,!1),a=[an.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),r}drawLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf],Ey);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Wm),this.endGeometry(n)}drawMultiLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf],Ey);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let u=0;for(let h=0,f=a.length;h<f;++h)u=this.drawFlatCoordinates_(l,u,a[h],c);this.hitDetectionInstructions.push(Wm),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Wm),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Wm),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Ey)}}class ZY extends TA{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinatess_(e,n,r,i){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Ey),this.hitDetectionInstructions.push(Ey);for(let c=0;c<l;++c){const u=r[c],h=this.coordinates.length,f=this.appendFlatLineCoordinates(e,n,u,i,!0,!a),g=[an.MOVE_TO_LINE_TO,h,f];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(XY),this.hitDetectionInstructions.push(XY)),n=u}return o&&(this.instructions.push(XR),this.hitDetectionInstructions.push(XR)),a&&(this.instructions.push(Wm),this.hitDetectionInstructions.push(Wm)),n}drawCircle(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,ul]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const u=[an.CIRCLE,c];this.instructions.push(Ey,u),this.hitDetectionInstructions.push(Ey,u),i.fillStyle!==void 0&&(this.instructions.push(XR),this.hitDetectionInstructions.push(XR)),i.strokeStyle!==void 0&&(this.instructions.push(Wm),this.hitDetectionInstructions.push(Wm)),this.endGeometry(n)}drawPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,ul]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(n)}drawMultiPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,ul]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let u=0;for(let h=0,f=a.length;h<f;++h)u=this.drawFlatCoordinatess_(l,u,a[h],c);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let r=0,i=n.length;r<i;++r)n[r]=$0(n[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function Uke(t,e,n,r,i){const s=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+i<r;){const[c,u]=l.slice(-2),h=e[o+i],f=e[o+i+1],g=Math.sqrt((h-c)*(h-c)+(f-u)*(f-u));if(a+=g,a>=t){const v=(t-a+g)/g,x=Yl(c,h,v),b=Yl(u,f,v);l.push(x,b),s.push(l),l=[x,b],a==t&&(o+=i),a=0}else if(a<t)l.push(e[o+i],e[o+i+1]),o+=i;else{const v=g-a,x=Yl(c,h,v/g),b=Yl(u,f,v/g);l.push(x,b),s.push(l),l=[x,b],a=0,o+=i}}return a>0&&s.push(l),s}function Gke(t,e,n,r,i){let s=n,o=n,a=0,l=0,c=n,u,h,f,g,v,x,b,T,A,I;for(h=n;h<r;h+=i){const R=e[h],M=e[h+1];v!==void 0&&(A=R-v,I=M-x,g=Math.sqrt(A*A+I*I),b!==void 0&&(l+=f,u=Math.acos((b*A+T*I)/(f*g)),u>t&&(l>a&&(a=l,s=c,o=h),l=0,c=h-i)),f=g,b=A,T=I),v=R,x=M}return l+=g,l>a?[c,h]:[s,o]}const f3={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Bke extends TA{constructor(e,n,r,i){super(e,n,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ul]={fillStyle:ul},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,r){const i=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!i&&!s)return;const a=this.coordinates;let l=a.length;const c=e.getType();let u=null,h=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Ia(this.maxExtent,e.getExtent()))return;let f;if(u=e.getFlatCoordinates(),c=="LineString")f=[u.length];else if(c=="MultiLineString")f=e.getEnds();else if(c=="Polygon")f=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const b=e.getEndss();f=[];for(let T=0,A=b.length;T<A;++T)f.push(b[T][0])}this.beginGeometry(e,n,r);const g=o.repeat,v=g?void 0:o.textAlign;let x=0;for(let b=0,T=f.length;b<T;++b){let A;g?A=Uke(g*this.resolution,u,x,f[b],h):A=[u.slice(x,f[b])];for(let I=0,R=A.length;I<R;++I){const M=A[I];let F=0,C=M.length;if(v==null){const O=Gke(o.maxAngle,M,0,M.length,2);F=O[0],C=O[1]}for(let O=F;O<C;O+=h)a.push(M[O],M[O+1]);const N=a.length;x=f[b],this.drawChars_(l,N),l=N}}this.endGeometry(n)}else{let f=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),h=2;break;case"Polygon":u=e.getFlatInteriorPoint(),o.overflow||f.push(u[2]/this.resolution),h=3;break;case"MultiPolygon":const R=e.getFlatInteriorPoints();u=[];for(let M=0,F=R.length;M<F;M+=3)o.overflow||f.push(R[M+2]/this.resolution),u.push(R[M],R[M+1]);if(u.length===0)return;h=2;break}const g=this.appendFlatPointCoordinates(u,h);if(g===l)return;if(f&&(g-l)/2!==u.length/h){let R=l/2;f=f.filter((M,F)=>{const C=a[(R+F)*2]===u[F*h]&&a[(R+F)*2+1]===u[F*h+1];return C||--R,C})}this.saveTextStates_();const v=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,x=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,r);let b=o.padding;if(b!=by&&(o.scale[0]<0||o.scale[1]<0)){let R=o.padding[0],M=o.padding[1],F=o.padding[2],C=o.padding[3];o.scale[0]<0&&(M=-M,C=-C),o.scale[1]<0&&(R=-R,F=-F),b=[R,M,F,C]}const T=this.pixelRatio;this.instructions.push([an.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,b==by?by:b.map(function(R){return R*T}),v,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const A=1/T,I=v?v.slice(0):null;I&&(I[1]=ul),this.hitDetectionInstructions.push([an.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[A,A],NaN,this.declutterMode_,this.declutterImageWithText_,b,I,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ul:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:n.font,textAlign:n.textAlign||XT,justify:n.justify,textBaseline:n.textBaseline||h3,scale:n.scale});const o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))}drawChars_(e,n){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=f3[i.textBaseline],u=this.textOffsetY_*l,h=this.text_,f=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([an.DRAW_CHARS,e,n,c,i.overflow,a,i.maxAngle,l,u,s,f*l,h,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([an.DRAW_CHARS,e,n,c,i.overflow,a&&ul,i.maxAngle,l,u,s,f*l,h,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let r,i,s;if(!e)this.text_="";else{const o=e.getFill();o?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=id(o.getColor()||ul)):(i=null,this.textFillState_=i);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=a.getLineDash(),b=a.getLineDashOffset(),T=a.getWidth(),A=a.getMiterLimit();s.lineCap=a.getLineCap()||$w,s.lineDash=x?x.slice():Hf,s.lineDashOffset=b===void 0?qf:b,s.lineJoin=a.getLineJoin()||jw,s.lineWidth=T===void 0?ZT:T,s.miterLimit=A===void 0?KT:A,s.strokeStyle=id(a.getColor()||YT)}r=this.textState_;const l=e.getFont()||Eae;cke(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||h3,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||by,r.scale=c===void 0?[1,1]:c;const u=e.getOffsetX(),h=e.getOffsetY(),f=e.getRotateWithView(),g=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=f===void 0?!1:f,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:_n(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+_n(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const Wke={Circle:ZY,Default:TA,Image:Vke,LineString:zke,Polygon:ZY,Text:Bke};class Hke{constructor(e,n,r,i){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const r=this.buildersByZIndex_[n];for(const i in r){const s=r[i].finish();e[n][i]=s}}return e}getBuilder(e,n){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[n];if(s===void 0){const o=Wke[n];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[n]=s}return s}}function qke(t,e,n,r,i,s,o,a,l,c,u,h,f=!0){let g=t[e],v=t[e+1],x=0,b=0,T=0,A=0;function I(){x=g,b=v,e+=r,g=t[e],v=t[e+1],A+=T,T=Math.sqrt((g-x)*(g-x)+(v-b)*(v-b))}do I();while(e<n-r&&A+T<s);let R=T===0?0:(s-A)/T;const M=Yl(x,g,R),F=Yl(b,v,R),C=e-r,N=A,O=s+a*l(c,i,u);for(;e<n-r&&A+T<O;)I();R=T===0?0:(O-A)/T;const j=Yl(x,g,R),V=Yl(b,v,R);let W=!1;if(f)if(h){const je=[M,F,j,V];sae(je,0,4,2,h,je,je),W=je[0]>je[2]}else W=M>j;const U=Math.PI,pe=[],Ne=C+r===e;e=C,T=0,A=N,g=t[e],v=t[e+1];let Se;if(Ne){I(),Se=Math.atan2(v-b,g-x),W&&(Se+=Se>0?-U:U);const je=(j+M)/2,de=(V+F)/2;return pe[0]=[je,de,(O-s)/2,Se,i],pe}i=i.replace(/\n/g," ");for(let je=0,de=i.length;je<de;){I();let Oe=Math.atan2(v-b,g-x);if(W&&(Oe+=Oe>0?-U:U),Se!==void 0){let le=Oe-Se;if(le+=le>U?-2*U:le<-U?2*U:0,Math.abs(le)>o)return null}Se=Oe;const Ae=je;let Q=0;for(;je<de;++je){const le=W?de-je-1:je,ve=a*l(c,i[le],u);if(e+r<n&&A+T<s+Q+ve/2)break;Q+=ve}if(je===Ae)continue;const B=W?i.substring(de-Ae,de-je):i.substring(Ae,je);R=T===0?0:(s+Q/2-A)/T;const ne=Yl(x,g,R),ie=Yl(b,v,R);pe.push([ne,ie,Q/2,Oe,B]),s+=Q}return pe}class jae{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(c3(),{get:(e,n)=>{if(typeof c3()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,r)=>(this.push_(n,r),!0)})}push_(...e){const n=this.instructions_,r=this.zIndex+this.offset_;n[r]||(n[r]=[]),n[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let r=0,i=n.length;r<i;++r){const s=n[r];if(typeof s=="function"){s(e);continue}const o=n[++r];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Yv=$a(),qp=[],Jd=[],Qd=[],Kp=[];function JY(t){return t[3].declutterBox}const QY=new RegExp("[-----]");function t6(t,e){return e==="start"?e=QY.test(t)?"right":"left":e==="end"&&(e=QY.test(t)?"left":"right"),f3[e]}function Kke(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function Yke(t,e,n){return n%2===0&&(t+=e),t}class Xke{constructor(e,n,r,i,s){this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=js(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new jae:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,r,i){const s=e+n+r+i;if(this.labels_[s])return this.labels_[s];const o=i?this.strokeStates[i]:null,a=r?this.fillStates[r]:null,l=this.textStates[n],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],h=l.justify?f3[l.justify]:t6(Array.isArray(e)?e[0]:e,l.textAlign||XT),f=i&&o.lineWidth?o.lineWidth:0,g=Array.isArray(e)?e:String(e).split(`
`).reduce(Kke,[]),{width:v,height:x,widths:b,heights:T,lineWidths:A}=hke(l,g),I=v+f,R=[],M=(I+2)*u[0],F=(x+f)*u[1],C={width:M<0?Math.floor(M):Math.ceil(M),height:F<0?Math.floor(F):Math.ceil(F),contextInstructions:R};(u[0]!=1||u[1]!=1)&&R.push("scale",u),i&&(R.push("strokeStyle",o.strokeStyle),R.push("lineWidth",f),R.push("lineCap",o.lineCap),R.push("lineJoin",o.lineJoin),R.push("miterLimit",o.miterLimit),R.push("setLineDash",[o.lineDash]),R.push("lineDashOffset",o.lineDashOffset)),r&&R.push("fillStyle",a.fillStyle),R.push("textBaseline","middle"),R.push("textAlign","center");const N=.5-h;let O=h*I+N*f;const j=[],V=[];let W=0,U=0,pe=0,Ne=0,Se;for(let je=0,de=g.length;je<de;je+=2){const Oe=g[je];if(Oe===`
`){U+=W,W=0,O=h*I+N*f,++Ne;continue}const Ae=g[je+1]||l.font;Ae!==Se&&(i&&j.push("font",Ae),r&&V.push("font",Ae),Se=Ae),W=Math.max(W,T[pe]);const Q=[Oe,O+N*b[pe]+h*(b[pe]-A[Ne]),.5*(f+W)+U];O+=b[pe],i&&j.push("strokeText",Q),r&&V.push("fillText",Q),++pe}return Array.prototype.push.apply(R,j),Array.prototype.push.apply(R,V),this.labels_[s]=C,C}replayTextBackground_(e,n,r,i,s,o,a){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,n,r,i,s,o,a,l,c,u,h,f,g,v,x,b){a*=f[0],l*=f[1];let T=r-a,A=i-l;const I=s+c>e?e-c:s,R=o+u>n?n-u:o,M=v[3]+I*f[0]+v[1],F=v[0]+R*f[1]+v[2],C=T-v[3],N=A-v[0];(x||h!==0)&&(qp[0]=C,Kp[0]=C,qp[1]=N,Jd[1]=N,Jd[0]=C+M,Qd[0]=Jd[0],Qd[1]=N+F,Kp[1]=Qd[1]);let O;return h!==0?(O=iu(js(),r,i,1,1,h,-r,-i),Yi(O,qp),Yi(O,Jd),Yi(O,Qd),Yi(O,Kp),Eg(Math.min(qp[0],Jd[0],Qd[0],Kp[0]),Math.min(qp[1],Jd[1],Qd[1],Kp[1]),Math.max(qp[0],Jd[0],Qd[0],Kp[0]),Math.max(qp[1],Jd[1],Qd[1],Kp[1]),Yv)):Eg(Math.min(C,C+M),Math.min(N,N+F),Math.max(C,C+M),Math.max(N,N+F),Yv),g&&(T=Math.round(T),A=Math.round(A)),{drawImageX:T,drawImageY:A,drawImageW:I,drawImageH:R,originX:c,originY:u,declutterBox:{minX:Yv[0],minY:Yv[1],maxX:Yv[2],maxY:Yv[3],value:b},canvasTransform:O,scale:f}}replayImageOrLabel_(e,n,r,i,s,o,a){const l=!!(o||a),c=i.declutterBox,u=a?a[2]*i.scale[0]/2:0;return c.minX-u<=n[0]&&c.maxX+u>=0&&c.minY-u<=n[1]&&c.maxY+u>=0&&(l&&this.replayTextBackground_(e,qp,Jd,Qd,Kp,o,a),dke(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const r=Yi(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,r,i){const s=this.textStates[n],o=this.createLabel(e,n,i,r),a=this.strokeStates[r],l=this.pixelRatio,c=t6(Array.isArray(e)?e[0]:e,s.textAlign||XT),u=f3[s.textBaseline||h3],h=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*s.scale[0],g=c*f+2*(.5-c)*h,v=u*o.height/l+2*(.5-u)*h;return{label:o,anchorX:g,anchorY:v}}execute_(e,n,r,i,s,o,a,l){const c=this.zIndexContext_;let u;this.pixelCoordinates_&&pp(r,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=ld(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),iae(this.renderedTransform_,r));let h=0;const f=i.length;let g=0,v,x,b,T,A,I,R,M,F,C,N,O,j,V=0,W=0;const U=this.coordinateCache_,pe=this.viewRotation_,Ne=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,Se={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:pe},je=this.instructions!=i||this.overlaps?0:200;let de,Oe,Ae,Q;for(;h<f;){const B=i[h];switch(B[0]){case an.BEGIN_GEOMETRY:de=B[1],Q=B[3],de.getGeometry()?a!==void 0&&!Ia(a,Q.getExtent())?h=B[2]+1:++h:h=B[2],c&&(c.zIndex=B[4]);break;case an.BEGIN_PATH:V>je&&(this.fill_(e),V=0),W>je&&(e.stroke(),W=0),!V&&!W&&(e.beginPath(),A=NaN,I=NaN),++h;break;case an.CIRCLE:g=B[1];const ie=u[g],le=u[g+1],ve=u[g+2],qe=u[g+3],Ke=ve-ie,Te=qe-le,we=Math.sqrt(Ke*Ke+Te*Te);e.moveTo(ie+we,le),e.arc(ie,le,we,0,2*Math.PI,!0),++h;break;case an.CLOSE_PATH:e.closePath(),++h;break;case an.CUSTOM:g=B[1],v=B[2];const Dt=B[3],Ye=B[4],sn=B[5];Se.geometry=Dt,Se.feature=de,h in U||(U[h]=[]);const $t=U[h];sn?sn(u,g,v,2,$t):($t[0]=u[g],$t[1]=u[g+1],$t.length=2),c&&(c.zIndex=B[6]),Ye($t,Se),++h;break;case an.DRAW_IMAGE:g=B[1],v=B[2],F=B[3],x=B[4],b=B[5];let fn=B[6];const yn=B[7],dt=B[8],lr=B[9],$n=B[10];let Un=B[11];const Xr=B[12];let po=B[13];T=B[14]||"declutter";const kr=B[15];if(!F&&B.length>=20){C=B[19],N=B[20],O=B[21],j=B[22];const ze=this.drawLabelWithPointPlacement_(C,N,O,j);F=ze.label,B[3]=F;const ee=B[23];x=(ze.anchorX-ee)*this.pixelRatio,B[4]=x;const ge=B[24];b=(ze.anchorY-ge)*this.pixelRatio,B[5]=b,fn=F.height,B[6]=fn,po=F.width,B[13]=po}let Si;B.length>25&&(Si=B[25]);let Rs,bt,Yn;B.length>17?(Rs=B[16],bt=B[17],Yn=B[18]):(Rs=by,bt=null,Yn=null),$n&&Ne?Un+=pe:!$n&&!Ne&&(Un-=pe);let cr=0;for(;g<v;g+=2){if(Si&&Si[cr++]<po/this.pixelRatio)continue;const ze=this.calculateImageOrLabelDimensions_(F.width,F.height,u[g],u[g+1],po,fn,x,b,dt,lr,Un,Xr,s,Rs,!!bt||!!Yn,de),ee=[e,n,F,ze,yn,bt,Yn];if(l){let ge,$e,Je;if(kr){const et=v-g;if(!kr[et]){kr[et]={args:ee,declutterMode:T};continue}const Ct=kr[et];ge=Ct.args,$e=Ct.declutterMode,delete kr[et],Je=JY(ge)}let Ue,nt;if(ge&&($e!=="declutter"||!l.collides(Je))&&(Ue=!0),(T!=="declutter"||!l.collides(ze.declutterBox))&&(nt=!0),$e==="declutter"&&T==="declutter"){const et=Ue&&nt;Ue=et,nt=et}Ue&&($e!=="none"&&l.insert(Je),this.replayImageOrLabel_.apply(this,ge)),nt&&(T!=="none"&&l.insert(ze.declutterBox),this.replayImageOrLabel_.apply(this,ee))}else this.replayImageOrLabel_.apply(this,ee)}++h;break;case an.DRAW_CHARS:const Ft=B[1],On=B[2],Qt=B[3],Oo=B[4];j=B[5];const Fi=B[6],Ps=B[7],Pn=B[8];O=B[9];const Ti=B[10];C=B[11],Array.isArray(C)&&(C=C.reduce(Yke,"")),N=B[12];const He=[B[13],B[13]];T=B[14]||"declutter";const Ie=B[15],Re=this.textStates[N],rn=Re.font,z=[Re.scale[0]*Ps,Re.scale[1]*Ps];let Et;rn in this.widths_?Et=this.widths_[rn]:(Et={},this.widths_[rn]=Et);const Y=xz(u,Ft,On,2),ae=Math.abs(z[0])*FY(rn,C,Et);if(Oo||ae<=Y){const ze=this.textStates[N].textAlign,ee=(Y-ae)*t6(C,ze),ge=qke(u,Ft,On,2,C,ee,Fi,Math.abs(z[0]),FY,rn,Et,Ne?0:this.viewRotation_,Ie);e:if(ge){const $e=[];let Je,Ue,nt,et,Ct;if(O)for(Je=0,Ue=ge.length;Je<Ue;++Je){Ct=ge[Je],nt=Ct[4],et=this.createLabel(nt,N,"",O),x=Ct[2]+(z[0]<0?-Ti:Ti),b=Qt*et.height+(.5-Qt)*2*Ti*z[1]/z[0]-Pn;const zt=this.calculateImageOrLabelDimensions_(et.width,et.height,Ct[0],Ct[1],et.width,et.height,x,b,0,0,Ct[3],He,!1,by,!1,de);if(l&&T==="declutter"&&l.collides(zt.declutterBox))break e;$e.push([e,n,et,zt,1,null,null])}if(j)for(Je=0,Ue=ge.length;Je<Ue;++Je){Ct=ge[Je],nt=Ct[4],et=this.createLabel(nt,N,j,""),x=Ct[2],b=Qt*et.height-Pn;const zt=this.calculateImageOrLabelDimensions_(et.width,et.height,Ct[0],Ct[1],et.width,et.height,x,b,0,0,Ct[3],He,!1,by,!1,de);if(l&&T==="declutter"&&l.collides(zt.declutterBox))break e;$e.push([e,n,et,zt,1,null,null])}l&&T!=="none"&&l.load($e.map(JY));for(let zt=0,gn=$e.length;zt<gn;++zt)this.replayImageOrLabel_.apply(this,$e[zt])}}++h;break;case an.END_GEOMETRY:if(o!==void 0){de=B[1];const ze=o(de,Q,T);if(ze)return ze}++h;break;case an.FILL:je?V++:this.fill_(e),++h;break;case an.MOVE_TO_LINE_TO:for(g=B[1],v=B[2],Oe=u[g],Ae=u[g+1],e.moveTo(Oe,Ae),A=Oe+.5|0,I=Ae+.5|0,g+=2;g<v;g+=2)Oe=u[g],Ae=u[g+1],R=Oe+.5|0,M=Ae+.5|0,(g==v-2||R!==A||M!==I)&&(e.lineTo(Oe,Ae),A=R,I=M);++h;break;case an.SET_FILL_STYLE:this.alignAndScaleFill_=B[2],V&&(this.fill_(e),V=0,W&&(e.stroke(),W=0)),e.fillStyle=B[1],++h;break;case an.SET_STROKE_STYLE:W&&(e.stroke(),W=0),this.setStrokeStyle_(e,B),++h;break;case an.STROKE:je?W++:e.stroke(),++h;break;default:++h;break}}V&&this.fill_(e),W&&e.stroke()}execute(e,n,r,i,s,o){this.viewRotation_=i,this.execute_(e,n,r,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,n,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,i,s)}}const uy=["Polygon","Circle","LineString","Image","Text","Default"],Fae=["Image","Text"],Zke=uy.filter(t=>!Fae.includes(t));class Jke{constructor(e,n,r,i,s,o,a){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=js(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,n){const r=this.getClipCoords(n);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,n){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const o in s){const a=s[o];i[o]=new Xke(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const r=this.executorsByZIndex_[n];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,n,r,i,s,o){i=Math.round(i);const a=i*2+1,l=iu(this.hitDetectionTransform_,i+.5,i+.5,1/n,-1/n,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Ts(a,a));const u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=$a(),LS(h,e),nd(h,n*(this.renderBuffer_+i),h));const f=Qke(i);let g;function v(M,F,C){const N=u.getImageData(0,0,a,a).data;for(let O=0,j=f.length;O<j;O++)if(N[f[O]]>0){if(!o||C==="none"||g!=="Image"&&g!=="Text"||o.includes(M)){const V=(f[O]-3)/4,W=i-V%a,U=i-(V/a|0),pe=s(M,F,W*W+U*U);if(pe)return pe}u.clearRect(0,0,a,a);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Gf);let b,T,A,I,R;for(b=x.length-1;b>=0;--b){const M=x[b].toString();for(A=this.executorsByZIndex_[M],T=uy.length-1;T>=0;--T)if(g=uy[T],I=A[g],I!==void 0&&(R=I.executeHitDetection(u,l,r,v,h),R))return R}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const r=n[0],i=n[1],s=n[2],o=n[3],a=[r,i,r,o,s,o,s,i];return ld(a,0,8,2,e,a),a}isEmpty(){return c1(this.executorsByZIndex_)}execute(e,n,r,i,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?MSe:Gf),o=o||uy;const c=uy.length;for(let u=0,h=l.length;u<h;++u){const f=l[u].toString(),g=this.executorsByZIndex_[f];for(let v=0,x=o.length;v<x;++v){const b=o[v],T=g[b];if(T!==void 0){const A=a===null?void 0:T.getZIndexContext(),I=A?A.getContext():e,R=this.maxExtent_&&b!=="Image"&&b!=="Text";if(R&&(I.save(),this.clip(I,r)),!A||b==="Text"||b==="Image"?T.execute(I,n,r,i,s,a):A.pushFunction(M=>T.execute(M,n,r,i,s,a)),R&&I.restore(),A){A.offset();const M=l[u]*c+uy.indexOf(b);this.deferredZIndexContexts_[M]||(this.deferredZIndexContexts_[M]=[]),this.deferredZIndexContexts_[M].push(A)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(Gf);for(let r=0,i=n.length;r<i;++r)e[n[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[n[r]].length=0}}const n6={};function Qke(t){if(n6[t]!==void 0)return n6[t];const e=t*2+1,n=t*t,r=new Array(n+1);for(let s=0;s<=t;++s)for(let o=0;o<=t;++o){const a=s*s+o*o;if(a>n)break;let l=r[a];l||(l=[],r[a]=l),l.push(((t+s)*e+(t+o))*4+3),s>0&&l.push(((t-s)*e+(t+o))*4+3),o>0&&(l.push(((t+s)*e+(t-o))*4+3),s>0&&l.push(((t-s)*e+(t-o))*4+3))}const i=[];for(let s=0,o=r.length;s<o;++s)r[s]&&i.push(...r[s]);return n6[t]=i,i}function eX(t,e,n,r){return n!==void 0&&r!==void 0?[n/t,r/e]:n!==void 0?n/t:r!==void 0?r/e:1}let kA=class Vae extends n5{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;ar(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||_n(o)),ar(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),ar(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Vt.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?Vt.LOADED:Vt.IDLE:l=Vt.LOADING:l=Vt.LOADED),this.color_=e.color!==void 0?su(e.color):null,this.iconImage_=u3(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,u;if(e.size)[c,u]=e.size;else{const h=this.getImage(1);if(h.width&&h.height)c=h.width,u=h.height;else if(h instanceof HTMLImageElement){this.initialOptions_=e;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(eX(g[0],g[1],e.width,e.height))};this.listenImageChange(f);return}}c!==void 0&&this.setScale(eX(c,u,e.width,e.height))}}clone(){let e,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Vae({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),r=this.getScaleArray();return[e[0]-n[0]/r[0],e[1]+n[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=u3(null,e,this.crossOrigin_,Vt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Vt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Vt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(An.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(An.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Jh=.5;function eAe(t,e,n,r,i,s,o,a,l){const c=i,u=t[0]*Jh,h=t[1]*Jh,f=Ts(u,h);f.imageSmoothingEnabled=!1;const g=f.canvas,v=new pke(f,Jh,i,null,o,a,null),x=n.length,b=Math.floor((256*256*256-1)/x),T={};for(let I=1;I<=x;++I){const R=n[I-1],M=R.getStyleFunction()||r;if(!M)continue;let F=M(R,s);if(!F)continue;Array.isArray(F)||(F=[F]);const N=(I*b).toString(16).padStart(7,"#00000");for(let O=0,j=F.length;O<j;++O){const V=F[O],W=V.getGeometryFunction()(R);if(!W||!Ia(c,W.getExtent()))continue;const U=V.clone(),pe=U.getFill();pe&&pe.setColor(N);const Ne=U.getStroke();Ne&&(Ne.setColor(N),Ne.setLineDash(null)),U.setText(void 0);const Se=V.getImage();if(Se){const Ae=Se.getImageSize();if(!Ae)continue;const Q=Ts(Ae[0],Ae[1],void 0,{alpha:!1}),B=Q.canvas;Q.fillStyle=N,Q.fillRect(0,0,B.width,B.height),U.setImage(new kA({img:B,anchor:Se.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Se.getOrigin(),opacity:1,size:Se.getSize(),scale:Se.getScale(),rotation:Se.getRotation(),rotateWithView:Se.getRotateWithView()}))}const je=U.getZIndex()||0;let de=T[je];de||(de={},T[je]=de,de.Polygon=[],de.Circle=[],de.LineString=[],de.Point=[]);const Oe=W.getType();if(Oe==="GeometryCollection"){const Ae=W.getGeometriesArrayRecursive();for(let Q=0,B=Ae.length;Q<B;++Q){const ne=Ae[Q];de[ne.getType().replace("Multi","")].push(ne,U)}}else de[Oe.replace("Multi","")].push(W,U)}}const A=Object.keys(T).map(Number).sort(Gf);for(let I=0,R=A.length;I<R;++I){const M=T[A[I]];for(const F in M){const C=M[F];for(let N=0,O=C.length;N<O;N+=2){v.setStyle(C[N+1]);for(let j=0,V=e.length;j<V;++j)v.setTransform(e[j]),v.drawGeometry(C[N])}}}return f.getImageData(0,0,g.width,g.height)}function tAe(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*Jh),s=Math.floor(Math.round(t[1])*Jh),o=(ii(i,0,n.width-1)+ii(s,0,n.height-1)*n.width)*4,a=n.data[o],l=n.data[o+1],u=n.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/e.length);u&&u%h===0&&r.push(e[u/h-1])}return r}class $S extends Md{constructor(e,n,r,i){super(e),this.inversePixelTransform=n,this.frameState=r,this.context=i}}const nAe=5;class zae extends _A{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=nAe}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return xn()}getData(e){return null}prepareFrame(e){return xn()}renderFrame(e,n){return xn()}forEachFeatureAtCoordinate(e,n,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===Vt.LOADED||n.getState()===Vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=Vt.LOADED&&n!=Vt.ERROR&&e.addEventListener(An.CHANGE,this.boundHandleImageChange_),n==Vt.IDLE&&(e.load(),n=e.getState()),n==Vt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const tX=[];let R_=null;function rAe(){R_=Ts(1,1,void 0,{willReadFrequently:!0})}class Cz extends zae{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=js(),this.pixelTransform=js(),this.inversePixelTransform=js(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,r){R_||rAe(),R_.clearRect(0,0,1,1);let i;try{R_.drawImage(e,n,r,1,1,0,0,1,1),i=R_.getImageData(0,0,1,1).data}catch{return R_=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,n,r){const i=this.getLayer().getClassName();let s,o;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&pp(su(e.style.backgroundColor),su(r)))){const a=e.firstElementChild;Bm(a)&&(o=a.getContext("2d"))}if(o&&kTe(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=tc?gae():document.createElement("div"),s.className=i;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Ts();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,n,r){const i=q1(r),s=KN(r),o=qN(r),a=HN(r);Yi(n.coordinateToPixelTransform,i),Yi(n.coordinateToPixelTransform,s),Yi(n.coordinateToPixelTransform,o),Yi(n.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Yi(l,i),Yi(l,s),Yi(l,o),Yi(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,n){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(Gn(r)/i*o),l=Math.round(cs(r)/i*o);iu(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),HT(this.inversePixelTransform,this.pixelTransform);const c=TTe(this.pixelTransform);if(this.useContainer(n,c,this.getBackground(e)),!this.containerReused){const u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),c!==u.style.transform&&(u.style.transform=c)}}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){const s=new $S(e,this.inversePixelTransform,r,n);i.dispatchEvent(s)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(no.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(no.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new jae),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(no.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(no.POSTRENDER,this.context,e))}getRenderTransform(e,n,r,i,s,o,a){const l=s/2,c=o/2,u=i/n,h=-u,f=-e[0]+a,g=-e[1];return iu(this.tempTransform,l,c,u,h,-r,f,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class iAe extends Cz{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=$a(),this.wrappedRenderedExtent_=$a(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,r){const i=n.extent,s=n.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,u=l.getExtent(),h=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),g=n.pixelRatio,v=n.viewHints,x=!(v[ws.ANIMATING]||v[ws.INTERACTING]),b=this.context,T=Math.round(Gn(i)/a*g),A=Math.round(cs(i)/a*g),I=h.getWrapX()&&l.canWrapX(),R=I?Gn(u):null,M=I?Math.ceil((i[2]-u[2])/R)+1:1;let F=I?Math.floor((i[0]-u[0])/R):0;do{let C=this.getRenderTransform(o,a,0,g,T,A,F*R);n.declutter&&(C=C.slice(0)),e.execute(b,[b.canvas.width,b.canvas.height],C,c,x,r===void 0?uy:r?Fae:Zke,r?f&&n.declutter[f]:void 0)}while(++F<M)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Ts(this.context.canvas.width,this.context.canvas.height,tX))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,t5(this.context),tX.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,n);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(no.PRERENDER)||this.getLayer().hasListener(no.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,a&&r.extent&&this.clipping){const l=rd(r.extent);a=Ia(l,e.extent),this.clipped_=a&&!zm(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],h=r[0]*Jh,f=r[1]*Jh;u.push(this.getRenderTransform(i,s,o,Jh,h,f,0).slice());const g=c.getSource(),v=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!zm(v,l)){let x=l[0];const b=Gn(v);let T=0,A;for(;x<v[0];)--T,A=b*T,u.push(this.getRenderTransform(i,s,o,Jh,h,f,A).slice()),x+=b;for(T=0,x=l[2];x>v[2];)++T,A=b*T,u.push(this.getRenderTransform(i,s,o,Jh,h,f,A).slice()),x-=b}this.hitDetectionImageData_=eAe(r,u,this.renderedFeatures_,c.getStyleFunction(),l,s,o,VY(s,this.renderedPixelRatio_))}n(tAe(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,r,i,s){if(!this.replayGroup_)return;const o=n.viewState.resolution,a=n.viewState.rotation,l=this.getLayer(),c={},u=function(f,g,v){const x=_n(f),b=c[x];if(b){if(b!==!0&&v<b.distanceSq){if(v===0)return c[x]=!0,s.splice(s.lastIndexOf(b),1),i(f,l,g);b.geometry=g,b.distanceSq=v}}else{if(v===0)return c[x]=!0,i(f,l,g);s.push(c[x]={feature:f,layer:l,geometry:g,distanceSq:v,callback:i})}},h=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,r,u,h?n.declutter?.[h]?.all().map(f=>f.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),r=n.getSource();if(!r)return!1;const i=e.viewHints[ws.ANIMATING],s=e.viewHints[ws.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&i||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,u=c.projection,h=c.resolution,f=e.pixelRatio,g=n.getRevision(),v=n.getRenderBuffer();let x=n.getRenderOrder();x===void 0&&(x=gke);const b=c.center.slice(),T=nd(l,v*h),A=T.slice(),I=[T.slice()],R=u.getExtent();if(r.getWrapX()&&u.canWrapX()&&!zm(R,e.extent)){const pe=Gn(R),Ne=Math.max(Gn(T)/2,pe);T[0]=R[0]-Ne,T[2]=R[2]+Ne,qoe(b,u);const Se=Boe(I[0],u);Se[0]<R[0]&&Se[2]<R[2]?I.push([Se[0]+pe,Se[1],Se[2]+pe,Se[3]]):Se[0]>R[0]&&Se[2]>R[2]&&I.push([Se[0]-pe,Se[1],Se[2]-pe,Se[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==g&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&zm(this.wrappedRenderedExtent_,T))return pp(this.renderedExtent_,A)||(this.hitDetectionImageData_=null,this.renderedExtent_=A),this.renderedCenter_=b,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const M=new Hke(Aae(h,f),T,h,f);let F;for(let pe=0,Ne=I.length;pe<Ne;++pe)r.loadFeatures(I[pe],h,u);const C=VY(h,f);let N=!0;const O=(pe,Ne)=>{let Se;const je=pe.getStyleFunction()||n.getStyleFunction();if(je&&(Se=je(pe,h)),Se){const de=this.renderFeature(pe,C,Se,M,F,this.getLayer().getDeclutter(),Ne);N=N&&!de}},j=nae(T),V=r.getFeaturesInExtent(j);x&&V.sort(x);for(let pe=0,Ne=V.length;pe<Ne;++pe)O(V[pe],pe);this.renderedFeatures_=V,this.ready=N;const W=M.finish(),U=new Jke(T,h,f,r.getOverlaps(),W,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=h,this.renderedRevision_=g,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=A,this.wrappedRenderedExtent_=T,this.renderedCenter_=b,this.renderedProjection_=u,this.renderedPixelRatio_=f,this.replayGroup_=U,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,r,i,s,o,a){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,u=r.length;c<u;++c)l=zY(i,e,r[c],n,this.boundHandleStyleImageChange_,s,o,a)||l;else l=zY(i,e,r,n,this.boundHandleStyleImageChange_,s,o,a);return l}}let Z1=0;const Es=1<<Z1++,Wt=1<<Z1++,$s=1<<Z1++,wi=1<<Z1++,bl=1<<Z1++,Kc=1<<Z1++,ZR=Math.pow(2,Z1)-1,Mz={[Es]:"boolean",[Wt]:"number",[$s]:"string",[wi]:"color",[bl]:"number[]",[Kc]:"size"},sAe=Object.keys(Mz).map(Number).sort(Gf);function oAe(t){return t in Mz}function dx(t){const e=[];for(const n of sAe)zE(t,n)&&e.push(Mz[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function zE(t,e){return(t&e)===e}function Hh(t,e){return t===e}class Ls{constructor(e,n){if(!oAe(e))throw new Error(`literal expressions must have a specific type, got ${dx(e)}`);this.type=e,this.value=n}}class Uae{constructor(e,n,...r){this.type=e,this.operator=n,this.args=r}}function Nz(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function oo(t,e,n){switch(typeof t){case"boolean":{if(Hh(e,$s))return new Ls($s,t?"true":"false");if(!zE(e,Es))throw new Error(`got a boolean, but expected ${dx(e)}`);return new Ls(Es,t)}case"number":{if(Hh(e,Kc))return new Ls(Kc,Ca(t));if(Hh(e,Es))return new Ls(Es,!!t);if(Hh(e,$s))return new Ls($s,t.toString());if(!zE(e,Wt))throw new Error(`got a number, but expected ${dx(e)}`);return new Ls(Wt,t)}case"string":{if(Hh(e,wi))return new Ls(wi,Sz(t));if(Hh(e,Es))return new Ls(Es,!!t);if(!zE(e,$s))throw new Error(`got a string, but expected ${dx(e)}`);return new Ls($s,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return yAe(t,e,n);for(const r of t)if(typeof r!="number")throw new Error("expected an array of numbers");if(Hh(e,Kc)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new Ls(Kc,t)}if(Hh(e,wi)){if(t.length===3)return new Ls(wi,[...t,1]);if(t.length===4)return new Ls(wi,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!zE(e,bl))throw new Error(`got an array of numbers, but expected ${dx(e)}`);return new Ls(bl,t)}const ke={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},aAe={[ke.Get]:En(Ln(1,1/0),nX),[ke.Var]:En(Ln(1,1),lAe),[ke.Has]:En(Ln(1,1/0),nX),[ke.Id]:En(cAe,Xv),[ke.Concat]:En(Ln(2,1/0),vr($s)),[ke.GeometryType]:En(uAe,Xv),[ke.LineMetric]:En(Xv),[ke.Resolution]:En(r6,Xv),[ke.Zoom]:En(r6,Xv),[ke.Time]:En(r6,Xv),[ke.Any]:En(Ln(2,1/0),vr(Es)),[ke.All]:En(Ln(2,1/0),vr(Es)),[ke.Not]:En(Ln(1,1),vr(Es)),[ke.Equal]:En(Ln(2,2),vr(ZR)),[ke.NotEqual]:En(Ln(2,2),vr(ZR)),[ke.GreaterThan]:En(Ln(2,2),vr(Wt)),[ke.GreaterThanOrEqualTo]:En(Ln(2,2),vr(Wt)),[ke.LessThan]:En(Ln(2,2),vr(Wt)),[ke.LessThanOrEqualTo]:En(Ln(2,2),vr(Wt)),[ke.Multiply]:En(Ln(2,1/0),rX),[ke.Coalesce]:En(Ln(2,1/0),rX),[ke.Divide]:En(Ln(2,2),vr(Wt)),[ke.Add]:En(Ln(2,1/0),vr(Wt)),[ke.Subtract]:En(Ln(2,2),vr(Wt)),[ke.Clamp]:En(Ln(3,3),vr(Wt)),[ke.Mod]:En(Ln(2,2),vr(Wt)),[ke.Pow]:En(Ln(2,2),vr(Wt)),[ke.Abs]:En(Ln(1,1),vr(Wt)),[ke.Floor]:En(Ln(1,1),vr(Wt)),[ke.Ceil]:En(Ln(1,1),vr(Wt)),[ke.Round]:En(Ln(1,1),vr(Wt)),[ke.Sin]:En(Ln(1,1),vr(Wt)),[ke.Cos]:En(Ln(1,1),vr(Wt)),[ke.Atan]:En(Ln(1,2),vr(Wt)),[ke.Sqrt]:En(Ln(1,1),vr(Wt)),[ke.Match]:En(Ln(4,1/0),iX,dAe),[ke.Between]:En(Ln(3,3),vr(Wt)),[ke.Interpolate]:En(Ln(6,1/0),iX,fAe),[ke.Case]:En(Ln(3,1/0),hAe,pAe),[ke.In]:En(Ln(2,2),mAe),[ke.Number]:En(Ln(1,1/0),vr(ZR)),[ke.String]:En(Ln(1,1/0),vr(ZR)),[ke.Array]:En(Ln(1,1/0),vr(Wt)),[ke.Color]:En(Ln(1,4),vr(Wt)),[ke.Band]:En(Ln(1,3),vr(Wt)),[ke.Palette]:En(Ln(2,2),gAe),[ke.ToString]:En(Ln(1,1),vr(Es|Wt|$s|wi))};function nX(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=t[s+1];switch(typeof o){case"number":{i[s]=new Ls(Wt,o);break}case"string":{i[s]=new Ls($s,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&n.properties.add(String(o))}return i}function lAe(t,e,n){const r=t[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return n.variables.add(r),[new Ls($s,r)]}function cAe(t,e,n){n.featureId=!0}function uAe(t,e,n){n.geometryType=!0}function r6(t,e,n){n.mapState=!0}function Xv(t,e,n){const r=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function Ln(t,e){return function(n,r,i){const s=n[0],o=n.length-1;if(t===e){if(o!==t){const a=t===1?"":"s";throw new Error(`expected ${t} argument${a} for ${s}, got ${o}`)}}else if(o<t||o>e){const a=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function rX(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=oo(t[s+1],e,n);i[s]=o}return i}function vr(t){return function(e,n,r){const i=e.length-1,s=new Array(i);for(let o=0;o<i;++o){const a=oo(e[o+1],t,r);s[o]=a}return s}}function hAe(t,e,n){const r=t[0],i=t.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function iX(t,e,n){const r=t[0],i=t.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function dAe(t,e,n){const r=t.length-1,i=$s|Wt|Es,s=oo(t[1],i,n),o=oo(t[t.length-1],e,n),a=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=oo(t[l+2],s.type,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=oo(t[l+3],o.type,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function fAe(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new Ls(Wt,i);let o;try{o=oo(t[2],Wt,n)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){try{const c=oo(t[l+3],Wt,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=oo(t[l+4],e,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function pAe(t,e,n){const r=oo(t[t.length-1],e,n),i=new Array(t.length-1);for(let s=0;s<i.length-1;s+=2){try{const o=oo(t[s+1],Es,n);i[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=oo(t[s+2],r.type,n);i[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return i[i.length-1]=r,i}function mAe(t,e,n){let r=t[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=$s}else i=Wt;const s=new Array(r.length);for(let a=0;a<s.length;a++)try{const l=oo(r[a],i,n);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[oo(t[1],i,n),...s]}function gAe(t,e,n){let r;try{r=oo(t[1],Wt,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let o=0;o<s.length;o++){let a;try{a=oo(i[o],wi,n)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Ls))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[r,...s]}function En(...t){return function(e,n,r){const i=e[0];let s;for(let o=0;o<t.length;o++){const a=t[o](e,n,r);if(o==t.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new Uae(n,i,...s)}}function yAe(t,e,n){const r=t[0],i=aAe[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}function Oz(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Oz(t.getGeometries()[0]);default:return""}}function Gae(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function mp(t,e,n){const r=oo(t,e,n);return ah(r)}function ah(t,e){if(t instanceof Ls){if(t.type===wi&&typeof t.value=="string"){const r=Sz(t.value);return function(){return r}}return function(){return t.value}}const n=t.operator;switch(n){case ke.Number:case ke.String:case ke.Coalesce:return vAe(t);case ke.Get:case ke.Var:case ke.Has:return _Ae(t);case ke.Id:return r=>r.featureId;case ke.GeometryType:return r=>r.geometryType;case ke.Concat:{const r=t.args.map(i=>ah(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case ke.Resolution:return r=>r.resolution;case ke.Any:case ke.All:case ke.Between:case ke.In:case ke.Not:return wAe(t);case ke.Equal:case ke.NotEqual:case ke.LessThan:case ke.LessThanOrEqualTo:case ke.GreaterThan:case ke.GreaterThanOrEqualTo:return xAe(t);case ke.Multiply:case ke.Divide:case ke.Add:case ke.Subtract:case ke.Clamp:case ke.Mod:case ke.Pow:case ke.Abs:case ke.Floor:case ke.Ceil:case ke.Round:case ke.Sin:case ke.Cos:case ke.Atan:case ke.Sqrt:return bAe(t);case ke.Case:return EAe(t);case ke.Match:return SAe(t);case ke.Interpolate:return TAe(t);case ke.ToString:return kAe(t);default:throw new Error(`Unsupported operator ${n}`)}}function vAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case ke.Coalesce:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case ke.Number:case ke.String:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a===n)return a}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function _Ae(t,e){const r=t.args[0].value;switch(t.operator){case ke.Get:return i=>{const s=t.args;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;o=o[u]}return o};case ke.Var:return i=>i.variables[r];case ke.Has:return i=>{const s=t.args;if(!(r in i.properties))return!1;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;if(!o||!Object.hasOwn(o,u))return!1;o=o[u]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function xAe(t,e){const n=t.operator,r=ah(t.args[0]),i=ah(t.args[1]);switch(n){case ke.Equal:return s=>r(s)===i(s);case ke.NotEqual:return s=>r(s)!==i(s);case ke.LessThan:return s=>r(s)<i(s);case ke.LessThanOrEqualTo:return s=>r(s)<=i(s);case ke.GreaterThan:return s=>r(s)>i(s);case ke.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${n}`)}}function wAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case ke.Any:return s=>{for(let o=0;o<r;++o)if(i[o](s))return!0;return!1};case ke.All:return s=>{for(let o=0;o<r;++o)if(!i[o](s))return!1;return!0};case ke.Between:return s=>{const o=i[0](s),a=i[1](s),l=i[2](s);return o>=a&&o<=l};case ke.In:return s=>{const o=i[0](s);for(let a=1;a<r;++a)if(o===i[a](s))return!0;return!1};case ke.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${n}`)}}function bAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case ke.Multiply:return s=>{let o=1;for(let a=0;a<r;++a)o*=i[a](s);return o};case ke.Divide:return s=>i[0](s)/i[1](s);case ke.Add:return s=>{let o=0;for(let a=0;a<r;++a)o+=i[a](s);return o};case ke.Subtract:return s=>i[0](s)-i[1](s);case ke.Clamp:return s=>{const o=i[0](s),a=i[1](s);if(o<a)return a;const l=i[2](s);return o>l?l:o};case ke.Mod:return s=>i[0](s)%i[1](s);case ke.Pow:return s=>Math.pow(i[0](s),i[1](s));case ke.Abs:return s=>Math.abs(i[0](s));case ke.Floor:return s=>Math.floor(i[0](s));case ke.Ceil:return s=>Math.ceil(i[0](s));case ke.Round:return s=>Math.round(i[0](s));case ke.Sin:return s=>Math.sin(i[0](s));case ke.Cos:return s=>Math.cos(i[0](s));case ke.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case ke.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${n}`)}}function EAe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ah(t.args[i]);return i=>{for(let s=0;s<n-1;s+=2)if(r[s](i))return r[s+1](i);return r[n-1](i)}}function SAe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ah(t.args[i]);return i=>{const s=r[0](i);for(let o=1;o<n-1;o+=2)if(s===r[o](i))return r[o+1](i);return r[n-1](i)}}function TAe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ah(t.args[i]);return i=>{const s=r[0](i),o=r[1](i);let a,l;for(let c=2;c<n;c+=2){const u=r[c](i);let h=r[c+1](i);const f=Array.isArray(h);if(f&&(h=eke(h)),u>=o)return c===2?h:f?AAe(s,o,a,l,u,h):UE(s,o,a,l,u,h);a=u,l=h}return l}}function kAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case ke.ToString:return s=>{const o=i[0](s);return t.args[0].type===wi?Tz(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function UE(t,e,n,r,i,s){const o=i-n;if(o===0)return r;const a=e-n,l=t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1);return r+l*(s-r)}function AAe(t,e,n,r,i,s){if(i-n===0)return r;const a=LY(r),l=LY(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const u=[UE(t,e,n,a[0],i,l[0]),UE(t,e,n,a[1],i,l[1]),a[2]+UE(t,e,n,0,i,c),UE(t,e,n,r[3],i,s[3])];return tke(u)}function IAe(t){return!0}function RAe(t){const e=Nz(),n=PAe(t,e),r=Gae();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const o=i.getId();o!==void 0?r.featureId=o:r.featureId=null}return e.geometryType&&(r.geometryType=Oz(i.getGeometry())),n(r)}}function sX(t){const e=Nz(),n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=oj(t[o],e);const i=Gae(),s=new Array(n);return function(o,a){if(i.properties=o.getPropertiesInternal(),i.resolution=a,e.featureId){const c=o.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<n;++c){const u=r[c](i);u&&(s[l]=u,l+=1)}return s.length=l,s}}function PAe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const s=t[i],o="filter"in s?mp(s.filter,Es,e):IAe;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=oj(s.style[c],e)}else a=[oj(s.style,e)];r[i]={filter:o,styles:a}}return function(i){const s=[];let o=!1;for(let a=0;a<n;++a){const l=r[a].filter;if(l(i)&&!(t[a].else&&o)){o=!0;for(const c of r[a].styles){const u=c(i);u&&s.push(u)}}}return s}}function oj(t,e){const n=QT(t,"",e),r=ek(t,"",e),i=CAe(t,e),s=MAe(t,e),o=dl(t,"z-index",e);if(!n&&!r&&!i&&!s&&!c1(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new zn;return function(l){let c=!0;if(n){const u=n(l);u&&(c=!1),a.setFill(u)}if(r){const u=r(l);u&&(c=!1),a.setStroke(u)}if(i){const u=i(l);u&&(c=!1),a.setText(u)}if(s){const u=s(l);u&&(c=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),c?null:a}}function QT(t,e,n){let r;if(e+"fill-pattern-src"in t)r=DAe(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return s=>null;r=Lz(t,e+"fill-color",n)}if(!r)return null;const i=new Nr;return function(s){const o=r(s);return o===Ez?null:(i.setColor(o),i)}}function ek(t,e,n){const r=dl(t,e+"stroke-width",n),i=Lz(t,e+"stroke-color",n);if(!r&&!i)return null;const s=Rf(t,e+"stroke-line-cap",n),o=Rf(t,e+"stroke-line-join",n),a=Bae(t,e+"stroke-line-dash",n),l=dl(t,e+"stroke-line-dash-offset",n),c=dl(t,e+"stroke-miter-limit",n),u=new Sr;return function(h){if(i){const f=i(h);if(f===Ez)return null;u.setColor(f)}if(r&&u.setWidth(r(h)),s){const f=s(h);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(f)}if(o){const f=o(h);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(f)}return a&&u.setLineDash(a(h)),l&&u.setLineDashOffset(l(h)),c&&u.setMiterLimit(c(h)),u}}function CAe(t,e){const n="text-",r=Rf(t,n+"value",e);if(!r)return null;const i=QT(t,n,e),s=QT(t,n+"background-",e),o=ek(t,n,e),a=ek(t,n+"background-",e),l=Rf(t,n+"font",e),c=dl(t,n+"max-angle",e),u=dl(t,n+"offset-x",e),h=dl(t,n+"offset-y",e),f=Dx(t,n+"overflow",e),g=Rf(t,n+"placement",e),v=dl(t,n+"repeat",e),x=i5(t,n+"scale",e),b=Dx(t,n+"rotate-with-view",e),T=dl(t,n+"rotation",e),A=Rf(t,n+"align",e),I=Rf(t,n+"justify",e),R=Rf(t,n+"baseline",e),M=Dx(t,n+"keep-upright",e),F=Bae(t,n+"padding",e),C=s5(t,n+"declutter-mode"),N=new th({declutterMode:C});return function(O){if(N.setText(r(O)),i&&N.setFill(i(O)),s&&N.setBackgroundFill(s(O)),o&&N.setStroke(o(O)),a&&N.setBackgroundStroke(a(O)),l&&N.setFont(l(O)),c&&N.setMaxAngle(c(O)),u&&N.setOffsetX(u(O)),h&&N.setOffsetY(h(O)),f&&N.setOverflow(f(O)),g){const j=g(O);if(j!=="point"&&j!=="line")throw new Error("Expected point or line for text-placement");N.setPlacement(j)}if(v&&N.setRepeat(v(O)),x&&N.setScale(x(O)),b&&N.setRotateWithView(b(O)),T&&N.setRotation(T(O)),A){const j=A(O);if(j!=="left"&&j!=="center"&&j!=="right"&&j!=="end"&&j!=="start")throw new Error("Expected left, right, center, start, or end for text-align");N.setTextAlign(j)}if(I){const j=I(O);if(j!=="left"&&j!=="right"&&j!=="center")throw new Error("Expected left, right, or center for text-justify");N.setJustify(j)}if(R){const j=R(O);if(j!=="bottom"&&j!=="top"&&j!=="middle"&&j!=="alphabetic"&&j!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");N.setTextBaseline(j)}return F&&N.setPadding(F(O)),M&&N.setKeepUpright(M(O)),N}}function MAe(t,e){return"icon-src"in t?NAe(t,e):"shape-points"in t?OAe(t,e):"circle-radius"in t?LAe(t,e):null}function NAe(t,e){const n="icon-",r=n+"src",i=Wae(t[r],r),s=p3(t,n+"anchor",e),o=i5(t,n+"scale",e),a=dl(t,n+"opacity",e),l=p3(t,n+"displacement",e),c=dl(t,n+"rotation",e),u=Dx(t,n+"rotate-with-view",e),h=aX(t,n+"anchor-origin"),f=lX(t,n+"anchor-x-units"),g=lX(t,n+"anchor-y-units"),v=VAe(t,n+"color"),x=jAe(t,n+"cross-origin"),b=FAe(t,n+"offset"),T=aX(t,n+"offset-origin"),A=m3(t,n+"width"),I=m3(t,n+"height"),R=$Ae(t,n+"size"),M=s5(t,n+"declutter-mode"),F=new kA({src:i,anchorOrigin:h,anchorXUnits:f,anchorYUnits:g,color:v,crossOrigin:x,offset:b,offsetOrigin:T,height:I,width:A,size:R,declutterMode:M});return function(C){return a&&F.setOpacity(a(C)),l&&F.setDisplacement(l(C)),c&&F.setRotation(c(C)),u&&F.setRotateWithView(u(C)),o&&F.setScale(o(C)),s&&F.setAnchor(s(C)),F}}function OAe(t,e){const n="shape-",r=n+"points",i=n+"radius",s=aj(t[r],r),o=aj(t[i],i),a=QT(t,n,e),l=ek(t,n,e),c=i5(t,n+"scale",e),u=p3(t,n+"displacement",e),h=dl(t,n+"rotation",e),f=Dx(t,n+"rotate-with-view",e),g=m3(t,n+"radius2"),v=m3(t,n+"angle"),x=s5(t,n+"declutter-mode"),b=new r5({points:s,radius:o,radius2:g,angle:v,declutterMode:x});return function(T){return a&&b.setFill(a(T)),l&&b.setStroke(l(T)),u&&b.setDisplacement(u(T)),h&&b.setRotation(h(T)),f&&b.setRotateWithView(f(T)),c&&b.setScale(c(T)),b}}function LAe(t,e){const n="circle-",r=QT(t,n,e),i=ek(t,n,e),s=dl(t,n+"radius",e),o=i5(t,n+"scale",e),a=p3(t,n+"displacement",e),l=dl(t,n+"rotation",e),c=Dx(t,n+"rotate-with-view",e),u=s5(t,n+"declutter-mode"),h=new ja({radius:5,declutterMode:u});return function(f){return s&&h.setRadius(s(f)),r&&h.setFill(r(f)),i&&h.setStroke(i(f)),a&&h.setDisplacement(a(f)),l&&h.setRotation(l(f)),c&&h.setRotateWithView(c(f)),o&&h.setScale(o(f)),h}}function dl(t,e,n){if(!(e in t))return;const r=mp(t[e],Wt,n);return function(i){return aj(r(i),e)}}function Rf(t,e,n){if(!(e in t))return null;const r=mp(t[e],$s,n);return function(i){return Wae(r(i),e)}}function DAe(t,e,n){const r=Rf(t,e+"pattern-src",n),i=oX(t,e+"pattern-offset",n),s=oX(t,e+"pattern-size",n),o=Lz(t,e+"color",n);return function(a){return{src:r(a),offset:i&&i(a),size:s&&s(a),color:o&&o(a)}}}function Dx(t,e,n){if(!(e in t))return null;const r=mp(t[e],Es,n);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Lz(t,e,n){if(!(e in t))return null;const r=mp(t[e],wi,n);return function(i){return Hae(r(i),e)}}function Bae(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl,n);return function(i){return AA(r(i),e)}}function p3(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl,n);return function(i){const s=AA(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function oX(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl,n);return function(i){return qae(r(i),e)}}function i5(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl|Wt,n);return function(i){return zAe(r(i),e)}}function m3(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function $Ae(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return Ca(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function jAe(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function aX(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function lX(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function FAe(t,e){const n=t[e];if(n!==void 0)return AA(n,e)}function s5(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function VAe(t,e){const n=t[e];if(n!==void 0)return Hae(n,e)}function AA(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if(typeof t[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function Wae(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function aj(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function Hae(t,e){if(typeof t=="string")return t;const n=AA(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function qae(t,e){const n=AA(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function zAe(t,e){return typeof t=="number"?t:qae(t,e)}const Su={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function cX(t,e,n){return(function(r,i,s,o,a){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,u=a?a[0]:0,h=a?a[1]:0;let f=t[0]+l/2+u,g=t[2]-l/2+u,v=t[1]+c/2+h,x=t[3]-c/2+h;f>g&&(f=(g+f)/2,g=f),v>x&&(v=(x+v)/2,x=v);let b=ii(r[0],f,g),T=ii(r[1],v,x);if(o&&n&&i){const A=30*i;b+=-A*Math.log(1+Math.max(0,f-r[0])/A)+A*Math.log(1+Math.max(0,r[0]-g)/A),T+=-A*Math.log(1+Math.max(0,v-r[1])/A)+A*Math.log(1+Math.max(0,r[1]-x)/A)}return[b,T]})}function UAe(t){return t}function Kae(t){return Math.pow(t,3)}function O2(t){return 1-Kae(1-t)}function GAe(t){return 3*t*t-2*t*t*t}function BAe(t){return t}function Dz(t,e,n,r){const i=Gn(e)/n[0],s=cs(e)/n[1];return r?Math.min(t,Math.max(i,s)):Math.min(t,Math.min(i,s))}function $z(t,e,n){let r=Math.min(t,e);const i=50;return r*=Math.log(1+i*Math.max(0,t/e-1))/i+1,n&&(r=Math.max(r,n),r/=Math.log(1+i*Math.max(0,n/t-1))/i+1),ii(r,n/2,e*2)}function WAe(t,e,n,r){return e=e!==void 0?e:!0,(function(i,s,o,a){if(i!==void 0){const l=t[0],c=t[t.length-1],u=n?Dz(l,n,o,r):l;if(a)return e?$z(i,u,c):ii(i,c,u);const h=Math.min(u,i),f=Math.floor(BN(t,h,s));return t[f]>u&&f<t.length-1?t[f+1]:t[f]}})}function HAe(t,e,n,r,i,s){return r=r!==void 0?r:!0,n=n!==void 0?n:0,(function(o,a,l,c){if(o!==void 0){const u=i?Dz(e,i,l,s):e;if(c)return r?$z(o,u,n):ii(o,n,u);const h=1e-9,f=Math.ceil(Math.log(e/u)/Math.log(t)-h),g=-a*(.5-h)+.5,v=Math.min(u,o),x=Math.floor(Math.log(e/v)/Math.log(t)+g),b=Math.max(f,x),T=e/Math.pow(t,b);return ii(T,n,u)}})}function uX(t,e,n,r,i){return n=n!==void 0?n:!0,(function(s,o,a,l){if(s!==void 0){const c=r?Dz(t,r,a,i):t;return!n||!l?ii(s,e,c):$z(s,c,e)}})}function jz(t){if(t!==void 0)return 0}function hX(t){if(t!==void 0)return t}function qAe(t){const e=2*Math.PI/t;return(function(n,r){if(r)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n})}function KAe(t){const e=Wf(5);return(function(n,r){return r||n===void 0?n:Math.abs(n)<=e?0:n})}const YAe=42,Fz=256,i6=0;class Qh extends Nd{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=fz(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&tae(),e.center&&(e.center=lf(e.center,this.projection_)),e.extent&&(e.extent=rd(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const a in Su)delete n[a];this.setProperties(n,!0);const r=ZAe(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=XAe(e),s=r.constraint,o=JAe(e);this.constraints_={center:i,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];n=n||[0,0,0,0];const s=this.getResolution(),o=s/2*(i[3]-n[3]+n[1]-i[1]),a=s/2*(i[0]-n[0]+n[2]-i[2]);this.setCenterInternal([r[0]+o,r[1]-a])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let r=0;r<n.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=lf(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=lf(i.anchor,this.getProjection())),n[r]=i}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const u=arguments[i];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(i===n){r&&JR(r,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<n;++i){const u=arguments[i],h={start:s,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||GAe,callback:r};if(u.center&&(h.sourceCenter=o,h.targetCenter=u.center.slice(),o=h.targetCenter),u.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(u.zoom),a=h.targetResolution):u.resolution&&(h.sourceResolution=a,h.targetResolution=u.resolution,a=h.targetResolution),u.rotation!==void 0){h.sourceRotation=l;const f=og(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+f,l=h.targetRotation}QAe(h)?h.complete=!0:s+=h.duration,c.push(h)}this.animations_.push(c),this.setHint(ws.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ws.ANIMATING]>0}getInteracting(){return this.hints_[ws.INTERACTING]>0}cancelAnimations(){this.setHint(ws.ANIMATING,-this.hints_[ws.ANIMATING]);let e;for(let n=0,r=this.animations_.length;n<r;++n){const i=this.animations_[n];if(i[0].callback&&JR(i[0].callback,!1),!e)for(let s=0,o=i.length;s<o;++s){const a=i[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let o=0,a=i.length;o<a;++o){const l=i[o];if(l.complete)continue;const c=e-l.start;let u=l.duration>0?c/l.duration:1;u>=1?(l.complete=!0,u=1):s=!1;const h=l.easing(u);if(l.sourceCenter){const f=l.sourceCenter[0],g=l.sourceCenter[1],v=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const b=f+h*(v-f),T=g+h*(x-g);this.targetCenter_=[b,T]}if(l.sourceResolution&&l.targetResolution){const f=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(f,0,g,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=h===1?og(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),n=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(ws.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=i[0].callback;o&&JR(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-n[0],i[1]-n[1]],cz(r,e-this.getRotation()),BSe(r,n)),r}calculateCenterZoom(e,n){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const o=n[0]-e*(n[0]-i[0])/s,a=n[1]-e*(n[1]-i[1])/s;r=[o,a]}return r}getViewportSize_(e){const n=this.viewportSize_;if(e){const r=n[0],i=n[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&J8(e,this.getProjection())}getCenterInternal(){return this.get(Su.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return nae(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();ar(n,"The view center is not defined");const r=this.getResolution();ar(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return ar(i!==void 0,"The view rotation is not defined"),t3(n,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Su.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(rd(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const r=Gn(e)/n[0],i=cs(e)/n[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return(function(s){return n/Math.pow(e,s*i)})}getRotation(){return this.get(Su.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/n;return(function(o){return Math.log(r/o)/n/s})}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();i=s6(i,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],n,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,r,i;if(this.resolutions_){const s=BN(this.resolutions_,e,1);n=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const n=ii(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(r,ii(e-n,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let r;if(ar(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){ar(!M2(e),"Cannot fit empty extent provided as `geometry`");const i=rd(e,this.getProjection());r=GY(i)}else if(e.getType()==="Circle"){const i=rd(e.getExtent(),this.getProjection());r=GY(i),r.rotate(this.getRotation(),oh(i))}else r=e;this.fitInternal(r,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),r=Math.cos(n),i=Math.sin(-n),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,u=-1/0;for(let h=0,f=s.length;h<f;h+=o){const g=s[h]*r-s[h+1]*i,v=s[h]*i+s[h+1]*r;a=Math.min(a,g),l=Math.min(l,v),c=Math.max(c,g),u=Math.max(u,v)}return[a,l,c,u]}fitInternal(e,n){n=n||{};let r=n.size;r||(r=this.getViewportSizeMinusPadding_());const i=n.padding!==void 0?n.padding:[0,0,0,0],s=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),u=Math.sin(c),h=Math.cos(c),f=oh(a);f[0]+=(i[1]-i[3])/2*l,f[1]+=(i[0]-i[2])/2*l;const g=f[0]*h-f[1]*u,v=f[1]*h+f[0]*u,x=this.getConstrainedCenter([g,v],l),b=n.callback?n.callback:BT;n.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:n.duration,easing:n.easing},b):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),JR(b,!0))}centerOn(e,n,r){this.centerOnInternal(lf(e,this.getProjection()),n,r)}centerOnInternal(e,n,r){this.setCenterInternal(s6(e,n,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,r,i){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-r),l=s6(e,i,[a[0]/2+o[3],a[1]/2+o[0]],n,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=J8(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&lf(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);n&&(this.targetCenter_=this.calculateCenterZoom(s,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=lf(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);n&&(this.targetCenter_=this.calculateCenterRotate(i,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&lf(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const r=this.getAnimating()||this.getInteracting()||n,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,s,r),a=this.constraints_.center(this.targetCenter_,o,s,r,this.calculateCenterShift(this.targetCenter_,o,i,s));this.get(Su.ROTATION)!==i&&this.set(Su.ROTATION,i),this.get(Su.RESOLUTION)!==o&&(this.set(Su.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Su.CENTER)||!r3(this.get(Su.CENTER),a))&&this.set(Su.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,r){e=e!==void 0?e:200;const i=n||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,i,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!r3(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:O2,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ws.INTERACTING,1)}endInteraction(e,n,r){r=r&&lf(r,this.getProjection()),this.endInteractionInternal(e,n,r)}endInteractionInternal(e,n,r){this.getInteracting()&&(this.setHint(ws.INTERACTING,-1),this.resolveConstraints(e,n,r))}getConstrainedCenter(e,n){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),r)}getConstrainedZoom(e,n){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,n))}getConstrainedResolution(e,n){n=n||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,r)}}function JR(t,e){setTimeout(function(){t(e)},0)}function XAe(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return cX(t.extent,t.constrainOnlyCenter,n)}const e=fz(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,cX(n,!1,!1)}return UAe}function ZAe(t){let e,n,r,o=t.minZoom!==void 0?t.minZoom:i6,a=t.maxZoom!==void 0?t.maxZoom:28;const l=t.zoomFactor!==void 0?t.zoomFactor:2,c=t.multiWorld!==void 0?t.multiWorld:!1,u=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,h=t.showFullExtent!==void 0?t.showFullExtent:!1,f=fz(t.projection,"EPSG:3857"),g=f.getExtent();let v=t.constrainOnlyCenter,x=t.extent;if(!c&&!x&&f.isGlobal()&&(v=!1,x=g),t.resolutions!==void 0){const b=t.resolutions;n=b[o],r=b[a]!==void 0?b[a]:b[b.length-1],t.constrainResolution?e=WAe(b,u,!v&&x,h):e=uX(n,r,u,!v&&x,h)}else{const T=(g?Math.max(Gn(g),cs(g)):360*Lw.degrees/f.getMetersPerUnit())/Fz/Math.pow(2,i6),A=T/Math.pow(2,28-i6);n=t.maxResolution,n!==void 0?o=0:n=T/Math.pow(l,o),r=t.minResolution,r===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?r=n/Math.pow(l,a):r=T/Math.pow(l,a):r=A),a=o+Math.floor(Math.log(n/r)/Math.log(l)),r=n/Math.pow(l,a-o),t.constrainResolution?e=HAe(l,n,r,u,!v&&x,h):e=uX(n,r,u,!v&&x,h)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:o,zoomFactor:l}}function JAe(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?KAe():n===!1?hX:typeof n=="number"?qAe(n):hX}return jz}function QAe(t){return!(t.sourceCenter&&t.targetCenter&&!r3(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function s6(t,e,n,r,i){const s=Math.cos(-i);let o=Math.sin(-i),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;a+=(e[0]/2-n[0])*r,l+=(n[1]-e[1]/2)*r,o=-o;const c=a*s-l*o,u=l*s+a*o;return[c,u]}const xr={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Yae extends Nd{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[xr.OPACITY]=e.opacity!==void 0?e.opacity:1,ar(typeof n[xr.OPACITY]=="number","Layer opacity must be a number"),n[xr.VISIBLE]=e.visible!==void 0?e.visible:!0,n[xr.Z_INDEX]=e.zIndex,n[xr.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[xr.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[xr.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[xr.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return n.opacity=ii(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return xn()}getLayerStatesArray(e){return xn()}getExtent(){return this.get(xr.EXTENT)}getMaxResolution(){return this.get(xr.MAX_RESOLUTION)}getMinResolution(){return this.get(xr.MIN_RESOLUTION)}getMinZoom(){return this.get(xr.MIN_ZOOM)}getMaxZoom(){return this.get(xr.MAX_ZOOM)}getOpacity(){return this.get(xr.OPACITY)}getSourceState(){return xn()}getVisible(){return this.get(xr.VISIBLE)}getZIndex(){return this.get(xr.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(xr.EXTENT,e)}setMaxResolution(e){this.set(xr.MAX_RESOLUTION,e)}setMinResolution(e){this.set(xr.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(xr.MAX_ZOOM,e)}setMinZoom(e){this.set(xr.MIN_ZOOM,e)}setOpacity(e){ar(typeof e=="number","Layer opacity must be a number"),this.set(xr.OPACITY,e)}setVisible(e){this.set(xr.VISIBLE,e)}setZIndex(e){this.set(xr.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class IA extends Yae{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(xr.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(xr.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Jr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Hn(e,An.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Qh?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&r&&(n.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(n.layerStatesArray){if(i=n.layerStatesArray.find(o=>o.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return Vz(i,n.viewState)&&(!s||Ia(s,n.extent))}getAttributions(e){if(!this.isVisible(e))return[];const n=this.getSource()?.getAttributions();if(!n)return[];const r=e instanceof Qh?e.getViewStateAndExtent():e;let i=n(r);return Array.isArray(i)||(i=[i]),i}render(e,n){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(xr.MAP,e)}getMapInternal(){return this.get(xr.MAP)}setMap(e){this.mapPrecomposeKey_&&(Jr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Jr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Hn(e,no.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Hn(this,An.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);ar(!n.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}setSource(e){this.set(xr.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Vz(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}const dX={RENDER_ORDER:"renderOrder"};class o5 extends IA{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(dX.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new Dae(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(dX.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?$ae:e;const n=eIe(e);this.styleFunction_=e===null?void 0:jke(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function eIe(t){if(t===void 0)return $ae;if(!t)return null;if(typeof t=="function"||t instanceof zn)return t;if(!Array.isArray(t))return sX([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof zn){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!(o instanceof zn))throw new Error("Expected a list of style instances");i[s]=o}return i}if("style"in n){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");i[s]=o}return RAe(i)}return sX(t)}class gp extends o5{constructor(e){super(e)}createRenderer(){return new iAe(this)}}const Yp={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class km extends Md{constructor(e,n){super(e),this.layer=n}}const o6={LAYERS:"layers"};let a5=class Xae extends Yae{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let r=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(o6.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Hc(r.slice(),{unique:!0}):ar(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Hc(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Jr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Hn(e,cl.ADD,this.handleLayersAdd_,this),Hn(e,cl.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(Jr);C2(this.listenerKeys_);const n=e.getArray();for(let r=0,i=n.length;r<i;r++){const s=n[r];this.registerLayerListeners_(s),this.dispatchEvent(new km(Yp.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const n=[Hn(e,Ow.PROPERTYCHANGE,this.handleLayerChange_,this),Hn(e,An.CHANGE,this.handleLayerChange_,this)];e instanceof Xae&&n.push(Hn(e,Yp.ADDLAYER,this.handleLayerGroupAdd_,this),Hn(e,Yp.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[_n(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new km(Yp.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new km(Yp.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new km(Yp.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,r=_n(n);this.listenerKeys_[r].forEach(Jr),delete this.listenerKeys_[r],this.dispatchEvent(new km(Yp.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(o6.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const r=n.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new km(Yp.REMOVELAYER,r[i]))}this.set(o6.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],r=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let o=r,a=n.length;o<a;o++){const l=n[o];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Bf(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return n}getSourceState(){return"ready"}};const ln={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Zae(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function lj(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}const g3=34962,zz=34963,tIe=35044,a6=35048,nIe=5121,rIe=5123,iIe=5125,Jae=5126,fX=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function sIe(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!UTe},e);const n=fX.length;for(let r=0;r<n;++r)try{const i=t.getContext(fX[r],e);if(i)return i}catch{}return null}const oIe={STATIC_DRAW:tIe};class l6{constructor(e,n){this.array_=null,this.type_=e,ar(e===g3||e===zz,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=n!==void 0?n:oIe.STATIC_DRAW}ofSize(e){return this.array_=new(QR(this.type_))(e),this}fromArray(e){return this.array_=QR(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(QR(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const n=QR(this.type_);if(!(e instanceof n))throw new Error(`Expected ${n}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function QR(t){switch(t){case g3:return Float32Array;case zz:return Uint32Array;default:return Float32Array}}const eP={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},aIe=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,lIe=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class pX{constructor(e){this.gl_=e.webGlContext;const n=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=n.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=n.createFramebuffer(),this.depthBuffer_=n.createRenderbuffer();const r=n.createShader(n.VERTEX_SHADER);n.shaderSource(r,e.vertexShader||aIe),n.compileShader(r);const i=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(i,e.fragmentShader||lIe),n.compileShader(i),this.renderTargetProgram_=n.createProgram(),n.attachShader(this.renderTargetProgram_,r),n.attachShader(this.renderTargetProgram_,i),n.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=n.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.bufferData(n.ARRAY_BUFFER,new Float32Array(s),n.STATIC_DRAW),this.renderTargetAttribLocation_=n.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:n.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const n=this.getGL(),r=[n.drawingBufferWidth*this.scaleRatio_,n.drawingBufferHeight*this.scaleRatio_];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.getDepthBuffer()),n.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=n.RGBA,o=0,a=n.RGBA,l=n.UNSIGNED_BYTE,c=null;n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.texImage2D(n.TEXTURE_2D,i,s,r[0],r[1],o,a,l,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.renderTargetTexture_,0),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,r[0],r[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer_)}}apply(e,n,r,i){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,n?n.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!n){const l=_n(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const n=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=n.createTexture()),n.activeTexture(n[`TEXTURE${i}`]),n.bindTexture(n.TEXTURE_2D,s.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,r.width,r.height,0,n.UNSIGNED_BYTE,new Uint8Array(r.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:n.uniform2f(s.location,r[0],r[1]);return;case 3:n.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:n.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(s.location,r)})}}const cf={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},bo={UNSIGNED_BYTE:nIe,UNSIGNED_SHORT:rIe,UNSIGNED_INT:iIe,FLOAT:Jae},y3={};function mX(t){return"shared/"+t}let gX=0;function cIe(){const t="unique/"+gX;return gX+=1,t}function uIe(t){let e=y3[t];if(!e){const n=document.createElement("canvas");n.width=1,n.height=1,n.style.position="absolute",n.style.left="0",e={users:0,context:sIe(n)},y3[t]=e}return e.users+=1,e.context}function hIe(t){const e=y3[t];if(!e||(e.users-=1,e.users>0))return;const n=e.context,r=n.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=n.canvas;i.width=1,i.height=1,delete y3[t]}class dIe extends yA{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?mX(e.canvasCacheKey):cIe(),this.gl_=uIe(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const n=this.gl_.canvas;n.addEventListener(eP.LOST,this.boundHandleWebGLContextLost_),n.addEventListener(eP.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=js(),this.offsetScaleMatrix_=js(),this.tmpMat4_=Zae(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new pX({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new pX({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const n in e)this.uniforms_.push({name:n,value:e[n]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===mX(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return ar(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const n=this.gl_,r=_n(e);let i=this.bufferCache_[r];if(!i){const s=n.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}n.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const n=this.gl_;this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const n=_n(e);delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(eP.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(eP.RESTORED,this.boundHandleWebGLContextRestored_),hIe(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,n,r){const i=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,n){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0)}bindInitialFrameBuffer(){const e=this.getGL(),n=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,n,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+n),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),n)}bindAttribute(e,n,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(n);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,n,r,i){const s=this.gl_,o=n.getSize();s.bindFramebuffer(s.FRAMEBUFFER,n.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,n.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,n.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,n){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,o=n-e,a=e*s;r.drawElements(r.TRIANGLES,o,i,a)}drawElementsInstanced(e,n,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),o=i.UNSIGNED_INT,a=4,l=n-e,c=e*a;s.drawElementsInstancedANGLE(i.TRIANGLES,l,o,c,r);for(let u=0;u<this.maxAttributeCount_;u++)s.vertexAttribDivisorANGLE(u,0)}finalizeDraw(e,n,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,n,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const n=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(cf.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(cf.ZOOM,e.viewState.zoom),this.setUniformFloatValue(cf.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(cf.PIXEL_RATIO,i),this.setUniformFloatVec2(cf.VIEWPORT_SIZE_PX,[n[0],n[1]]),this.setUniformFloatValue(cf.ROTATION,r)}applyHitDetectionUniform(e){const n=this.getUniformLocation(cf.HIT_DETECTION);this.getGL().uniform1i(n,e?1:0),e&&this.setUniformFloatValue(cf.PIXEL_RATIO,.5)}applyUniforms(e){const n=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=n.createTexture()),this.bindTexture(s.texture,i,s.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&o&&s.prevValue!==r&&(s.prevValue=r,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,lj(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:n.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:n.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:n.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,n){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,n&&(this.applyFrameState(n),this.applyUniforms(n))}compileShader(e,n){const r=this.gl_,i=r.createShader(n);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,n){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(n,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,i),r.attachShader(o,s),r.linkProgram(o),!r.getShaderParameter(i,r.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(a)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(a)}if(r.deleteShader(s),!r.getProgramParameter(o,r.LINK_STATUS)){const a=`GL program linking failed: ${r.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const n=_n(this.currentProgram_);return this.uniformLocationsByProgram_[n]===void 0&&(this.uniformLocationsByProgram_[n]={}),this.uniformLocationsByProgram_[n][e]===void 0&&(this.uniformLocationsByProgram_[n][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[n][e]}getAttributeLocation(e){const n=_n(this.currentProgram_);return this.attribLocationsByProgram_[n]===void 0&&(this.attribLocationsByProgram_[n]={}),this.attribLocationsByProgram_[n][e]===void 0&&(this.attribLocationsByProgram_[n][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[n][e]}makeProjectionTransform(e,n){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return iu(n,0,0,2/(s*r[0]),2/(s*r[1]),-i,-o[0],-o[1]),n}setUniformFloatValue(e,n){this.gl_.uniform1f(this.getUniformLocation(e),n)}setUniformFloatVec2(e,n){this.gl_.uniform2fv(this.getUniformLocation(e),n)}setUniformFloatVec4(e,n){this.gl_.uniform4fv(this.getUniformLocation(e),n)}setUniformMatrixValue(e,n){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,n)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,n,r,i,s,o){const a=this.getAttributeLocation(e);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,n,r,!1,i,s),o&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(a,1))}enableAttributes_(e,n){const r=fIe(e);let i=0;for(let s=0;s<e.length;s++){const o=e[s];o.name&&this.enableAttributeArray_(o.name,o.size,o.type||Jae,r,i,n),i+=o.size*Qae(o.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){C2(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,n,r,i){const s=this.gl_;r=r||s.createTexture();const o=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,c=0,u=s.RGBA,h=s.UNSIGNED_BYTE;return n instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,h,n):n?s.texImage2D(s.TEXTURE_2D,a,l,u,h,n):s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,h,null),r}}function fIe(t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];e+=r.size*Qae(r.type)}return e}function Qae(t){switch(t){case bo.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case bo.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case bo.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case bo.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class Uz extends vA{constructor(e,n,r){super(),r=r||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(An.CHANGE)}release(){this.setState(ln.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ln.EMPTY){if(this.state!==ln.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){xn()}getAlpha(e,n){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=n,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=n-r+1e3/60;return i>=this.transition_?1:Kae(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function cj(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const pIe=new Error("disposed"),mIe=[256,256];class yX extends Uz{constructor(e){const n=ln.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=cj(this.data_);return e?[e.width,e.height]:mIe}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ln.IDLE&&this.state!==ln.ERROR)return;this.state=ln.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=ln.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=ln.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(pIe),this.controller_=null),super.disposeInternal()}}class ele extends Uz{constructor(e,n,r,i,s,o){super(e,n,o),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,tc?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ln.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=ln.ERROR,this.unlistenImage_(),this.image_=gIe(),this.changed()}handleImageLoad_(){if(tc)this.state=ln.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ln.LOADED:this.state=ln.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==ln.ERROR&&(this.state=ln.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ln.IDLE&&(this.state=ln.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=nke(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function gIe(){const t=Ts(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}let c6;const $x=[];function vX(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function u6(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function yIe(){if(c6===void 0){const t=Ts(6,6,$x);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",vX(t,4,5,4,0),vX(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;c6=u6(e,0)||u6(e,4)||u6(e,8),t5(t),$x.push(t.canvas)}return c6}function v3(t,e,n,r){const i=N2(n,e,t);let s=a3(e,r,n);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=t.getMetersPerUnit();a!==void 0&&(s/=a);const l=t.getExtent();if(!l||u1(l,i)){const c=a3(t,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function vIe(t,e,n,r){const i=oh(n);let s=v3(t,e,i,r);return(!isFinite(s)||s<=0)&&Uoe(n,function(o){return s=v3(t,e,o,r),isFinite(s)&&s>0}),s}function tle(t,e,n,r,i,s,o,a,l,c,u,h,f,g){const v=Ts(Math.round(n*t),Math.round(n*e),$x);if(h||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(n,n);function x(M){return Math.round(M*n)/n}v.globalCompositeOperation="lighter";const b=$a();l.forEach(function(M,F,C){lz(b,M.extent)});let T;const A=n/r,I=(h?1:1+Math.pow(2,-24))/A;if(!f||l.length!==1||c!==0){if(T=Ts(Math.round(Gn(b)*A),Math.round(cs(b)*A),$x),h||(T.imageSmoothingEnabled=!1),i&&g){const M=(i[0]-b[0])*A,F=-(i[3]-b[3])*A,C=Gn(i)*A,N=cs(i)*A;T.rect(M,F,C,N),T.clip()}l.forEach(function(M,F,C){if(M.image.width>0&&M.image.height>0){if(M.clipExtent){T.save();const W=(M.clipExtent[0]-b[0])*A,U=-(M.clipExtent[3]-b[3])*A,pe=Gn(M.clipExtent)*A,Ne=cs(M.clipExtent)*A;T.rect(h?W:Math.round(W),h?U:Math.round(U),h?pe:Math.round(W+pe)-Math.round(W),h?Ne:Math.round(U+Ne)-Math.round(U)),T.clip()}const N=(M.extent[0]-b[0])*A,O=-(M.extent[3]-b[3])*A,j=Gn(M.extent)*A,V=cs(M.extent)*A;T.drawImage(M.image,c,c,M.image.width-2*c,M.image.height-2*c,h?N:Math.round(N),h?O:Math.round(O),h?j:Math.round(N+j)-Math.round(N),h?V:Math.round(O+V)-Math.round(O)),M.clipExtent&&T.restore()}})}const R=q1(o);return a.getTriangles().forEach(function(M,F,C){const N=M.source,O=M.target;let j=N[0][0],V=N[0][1],W=N[1][0],U=N[1][1],pe=N[2][0],Ne=N[2][1];const Se=x((O[0][0]-R[0])/s),je=x(-(O[0][1]-R[1])/s),de=x((O[1][0]-R[0])/s),Oe=x(-(O[1][1]-R[1])/s),Ae=x((O[2][0]-R[0])/s),Q=x(-(O[2][1]-R[1])/s),B=j,ne=V;j=0,V=0,W-=B,U-=ne,pe-=B,Ne-=ne;const ie=[[W,U,0,0,de-Se],[pe,Ne,0,0,Ae-Se],[0,0,W,U,Oe-je],[0,0,pe,Ne,Q-je]],le=GSe(ie);if(!le)return;if(v.save(),v.beginPath(),yIe()||!h){v.moveTo(de,Oe);const qe=4,Ke=Se-de,Te=je-Oe;for(let we=0;we<qe;we++)v.lineTo(de+x((we+1)*Ke/qe),Oe+x(we*Te/(qe-1))),we!=qe-1&&v.lineTo(de+x((we+1)*Ke/qe),Oe+x((we+1)*Te/(qe-1)));v.lineTo(Ae,Q)}else v.moveTo(de,Oe),v.lineTo(Se,je),v.lineTo(Ae,Q);v.clip(),v.transform(le[0],le[2],le[1],le[3],Se,je),v.translate(b[0]-B,b[3]-ne);let ve;if(T)ve=T.canvas,v.scale(I,-I);else{const qe=l[0],Ke=qe.extent;ve=qe.image,v.scale(Gn(Ke)/ve.width,-cs(Ke)/ve.height)}v.drawImage(ve,0,0),v.restore()}),T&&(t5(T),$x.push(T.canvas)),u&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,a.getTriangles().forEach(function(M,F,C){const N=M.target,O=(N[0][0]-R[0])/s,j=-(N[0][1]-R[1])/s,V=(N[1][0]-R[0])/s,W=-(N[1][1]-R[1])/s,U=(N[2][0]-R[0])/s,pe=-(N[2][1]-R[1])/s;v.beginPath(),v.moveTo(V,W),v.lineTo(O,j),v.lineTo(U,pe),v.closePath(),v.stroke()}),v.restore()),v.canvas}const _Ie=10,_X=.25;class nle{constructor(e,n,r,i,s,o,a){this.sourceProj_=e,this.targetProj_=n;let l={};const c=a?Z8(I=>Yi(a,N2(I,this.targetProj_,this.sourceProj_))):WT(this.targetProj_,this.sourceProj_);this.transformInv_=function(I){const R=I[0]+"/"+I[1];return l[R]||(l[R]=c(I)),l[R]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Gn(i)>=Gn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Gn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Gn(this.targetProj_.getExtent()):null;const u=q1(r),h=KN(r),f=qN(r),g=HN(r),v=this.transformInv_(u),x=this.transformInv_(h),b=this.transformInv_(f),T=this.transformInv_(g),A=_Ie+(o?Math.max(0,Math.ceil(Math.log2(H8(r)/(o*o*256*256)))):0);if(this.addQuad_(u,h,f,g,v,x,b,T,A),this.wrapsXInSource_){let I=1/0;this.triangles_.forEach(function(R,M,F){I=Math.min(I,R.source[0][0],R.source[1][0],R.source[2][0])}),this.triangles_.forEach(R=>{if(Math.max(R.source[0][0],R.source[1][0],R.source[2][0])-I>this.sourceWorldWidth_/2){const M=[[R.source[0][0],R.source[0][1]],[R.source[1][0],R.source[1][1]],[R.source[2][0],R.source[2][1]]];M[0][0]-I>this.sourceWorldWidth_/2&&(M[0][0]-=this.sourceWorldWidth_),M[1][0]-I>this.sourceWorldWidth_/2&&(M[1][0]-=this.sourceWorldWidth_),M[2][0]-I>this.sourceWorldWidth_/2&&(M[2][0]-=this.sourceWorldWidth_);const F=Math.min(M[0][0],M[1][0],M[2][0]);Math.max(M[0][0],M[1][0],M[2][0])-F<this.sourceWorldWidth_/2&&(R.source=M)}})}l={}}addTriangle_(e,n,r,i,s,o){this.triangles_.push({source:[i,s,o],target:[e,n,r]})}addQuad_(e,n,r,i,s,o,a,l,c){const u=xY([s,o,a,l]),h=this.sourceWorldWidth_?Gn(u)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&h>.5&&h<1;let v=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const b=xY([e,n,r,i]);v=Gn(b)/this.targetWorldWidth_>_X||v}!g&&this.sourceProj_.isGlobal()&&h&&(v=h>_X||v)}if(!v&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!Ia(u,this.maxSourceExtent_))return;let x=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)v=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(c>0){if(!v){const b=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(b);let A;g?A=(og(s[0],f)+og(a[0],f))/2-og(T[0],f):A=(s[0]+a[0])/2-T[0];const I=(s[1]+a[1])/2-T[1];v=A*A+I*I>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const b=[(n[0]+r[0])/2,(n[1]+r[1])/2],T=this.transformInv_(b),A=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(A);this.addQuad_(e,n,b,A,s,o,T,I,c-1),this.addQuad_(A,b,r,i,I,T,a,l,c-1)}else{const b=[(e[0]+n[0])/2,(e[1]+n[1])/2],T=this.transformInv_(b),A=[(r[0]+i[0])/2,(r[1]+i[1])/2],I=this.transformInv_(A);this.addQuad_(e,b,A,i,s,T,I,l,c-1),this.addQuad_(b,n,r,A,T,o,a,I,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,a,l),(x&14)==0&&this.addTriangle_(e,r,n,s,a,o),x&&((x&13)==0&&this.addTriangle_(n,i,e,o,l,s),(x&7)==0&&this.addTriangle_(n,i,r,o,l,a))}calculateSourceExtent(){const e=$a();return this.triangles_.forEach(function(n,r,i){const s=n.source;LS(e,s[0]),LS(e,s[1]),LS(e,s[2])}),e}getTriangles(){return this.triangles_}}const rle=.5;class ile extends Uz{constructor(e,n,r,i,s,o,a,l,c,u,h,f){super(s,ln.IDLE,f),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=i,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const g=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const b=v?Bf(g,v):g;if(H8(b)===0){this.state=ln.EMPTY;return}const T=e.getExtent();T&&(x?x=Bf(x,T):x=T);const A=i.getResolution(this.wrappedTileCoord_[0]),I=vIe(e,r,b,A);if(!isFinite(I)||I<=0){this.state=ln.EMPTY;return}const R=u!==void 0?u:rle;if(this.triangulation_=new nle(e,r,b,x,I*R,A),this.triangulation_.getTriangles().length===0){this.state=ln.EMPTY;return}this.sourceZ_=n.getZForResolution(I);let M=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(M[1]=ii(M[1],x[1],x[3]),M[3]=ii(M[3],x[1],x[3])):M=Bf(M,x)),!H8(M))this.state=ln.EMPTY;else{let F=0,C=0;e.canWrapX()&&(F=Gn(T),C=Math.floor((M[0]-T[0])/F)),Woe(M.slice(),e,!0).forEach(O=>{const j=n.getTileRangeForExtentAndZ(O,this.sourceZ_);for(let V=j.minX;V<=j.maxX;V++)for(let W=j.minY;W<=j.maxY;W++){const U=c(this.sourceZ_,V,W,a);if(U){const pe=C*F;this.sourceTiles_.push({tile:U,offset:pe})}}++C}),this.sourceTiles_.length===0&&(this.state=ln.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{const r=n.tile;if(r&&r.getState()==ln.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=n.offset,i[2]+=n.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=n.offset,s[2]+=n.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=ln.ERROR;else{const n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],o=this.targetTileGrid_.getResolution(n),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=tle(i,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ln.LOADED}this.changed()}load(){if(this.state==ln.IDLE){this.state=ln.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const r=n.getState();if(r==ln.IDLE||r==ln.LOADING){e++;const i=Hn(n,An.CHANGE,s=>{const o=n.getState();(o==ln.LOADED||o==ln.ERROR||o==ln.EMPTY)&&(Jr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},r,i){n.getState()==ln.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Jr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(t5(this.canvas_.getContext("2d")),$x.push(this.canvas_),this.canvas_=null),super.release()}}class Gz{constructor(e,n,r,i){this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Zv(t,e,n,r,i){return i!==void 0?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new Gz(t,e,n,r)}class xX{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof yA&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const r=this.entries_[e];return ar(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const n=this.entries_[e];return ar(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.key_;return e}getValues(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){ar(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function _3(t,e,n,r){return r!==void 0?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function xIe(t,e,n){return t+"/"+e+"/"+n}function bC(t,e,n,r,i){return`${_n(t)},${e},${xIe(n,r,i)}`}function sle(t){return wIe(t[0],t[1],t[2])}function wIe(t,e,n){return(e<<t)+n}function bIe(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return s?s.containsXY(r,i):!0}class Bz extends zae{constructor(e,n){super(e),n=n||{},this.inversePixelTransform_=js(),this.postProcesses_=n.postProcesses,this.uniforms_=n.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(xr.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(no.PRECOMPOSE)){const i=new $S(no.PRECOMPOSE,void 0,n,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(no.POSTCOMPOSE)){const i=new $S(no.POSTCOMPOSE,void 0,n,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let n=!0,r=-1,i;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof Bz)){n=!0;continue}const u=l.getClassName();if((n||u!==i)&&(r+=1,n=!1),i=u,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new dIe({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(xr.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){iu(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new $S(e,this.inversePixelTransform_,r,n);i.dispatchEvent(s)}}preRender(e,n){this.dispatchRenderEvent_(no.PRERENDER,e,n)}postRender(e,n){this.dispatchRenderEvent_(no.POSTRENDER,e,n)}}const h6={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class EIe{constructor(e,n){this.name=e,this.data=n,this.texture_=null}getTexture(e){if(!this.texture_){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=n}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function SIe(t,e){return`operator_${t}_${Object.keys(e.functions).length}`}function ag(t){const e=t.toString();return e.includes(".")?e:e+".0"}function Wz(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(ag).join(", ")})`}function EC(t){const e=su(t),n=e.length>3?e[3]:1;return Wz([e[0]/255,e[1]/255,e[2]/255,n])}function TIe(t){const e=Ca(t);return Wz(e)}const d6={};let kIe=0;function tk(t){return t in d6||(d6[t]=kIe++),d6[t]}function Pf(t){return ag(tk(t))}function Hz(t){return"u_var_"+t}function ole(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const f6="getBandValue",AIe="u_paletteTextures",ale="featureId",lle="geometryType",uj=-9999999;function IIe(t,e,n,r){const i=oo(t,e,n);return qz(i,e,r)}function pr(t){return(e,n,r)=>{const i=n.args.length,s=new Array(i);for(let o=0;o<i;++o)s[o]=qz(n.args[o],r,e);return t(s,e)}}const RIe={[ke.Get]:(t,e)=>{const r=e.args[0].value;r in t.properties||(t.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Hh(e.type,Es)&&(s=`(${s} > 0.0)`),s},[ke.Id]:t=>(t.featureId=!0,"a_"+ale),[ke.GeometryType]:t=>(t.geometryType=!0,"a_"+lle),[ke.LineMetric]:()=>"currentLineMetric",[ke.Var]:(t,e)=>{const r=e.args[0].value;r in t.variables||(t.variables[r]={name:r,type:e.type});let s=Hz(r);return Hh(e.type,Es)&&(s=`(${s} > 0.0)`),s},[ke.Has]:(t,e)=>{const r=e.args[0].value;return r in t.properties||(t.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${ag(uj)})`},[ke.Resolution]:()=>"u_resolution",[ke.Zoom]:()=>"u_zoom",[ke.Time]:()=>"u_time",[ke.Any]:pr(t=>`(${t.join(" || ")})`),[ke.All]:pr(t=>`(${t.join(" && ")})`),[ke.Not]:pr(([t])=>`(!${t})`),[ke.Equal]:pr(([t,e])=>`(${t} == ${e})`),[ke.NotEqual]:pr(([t,e])=>`(${t} != ${e})`),[ke.GreaterThan]:pr(([t,e])=>`(${t} > ${e})`),[ke.GreaterThanOrEqualTo]:pr(([t,e])=>`(${t} >= ${e})`),[ke.LessThan]:pr(([t,e])=>`(${t} < ${e})`),[ke.LessThanOrEqualTo]:pr(([t,e])=>`(${t} <= ${e})`),[ke.Multiply]:pr(t=>`(${t.join(" * ")})`),[ke.Divide]:pr(([t,e])=>`(${t} / ${e})`),[ke.Add]:pr(t=>`(${t.join(" + ")})`),[ke.Subtract]:pr(([t,e])=>`(${t} - ${e})`),[ke.Clamp]:pr(([t,e,n])=>`clamp(${t}, ${e}, ${n})`),[ke.Mod]:pr(([t,e])=>`mod(${t}, ${e})`),[ke.Pow]:pr(([t,e])=>`pow(${t}, ${e})`),[ke.Abs]:pr(([t])=>`abs(${t})`),[ke.Floor]:pr(([t])=>`floor(${t})`),[ke.Ceil]:pr(([t])=>`ceil(${t})`),[ke.Round]:pr(([t])=>`floor(${t} + 0.5)`),[ke.Sin]:pr(([t])=>`sin(${t})`),[ke.Cos]:pr(([t])=>`cos(${t})`),[ke.Atan]:pr(([t,e])=>e!==void 0?`atan(${t}, ${e})`:`atan(${t})`),[ke.Sqrt]:pr(([t])=>`sqrt(${t})`),[ke.Match]:pr(t=>{const e=t[0],n=t[t.length-1];let r=null;for(let i=t.length-3;i>=1;i-=2){const s=t[i],o=t[i+1];r=`(${e} == ${s} ? ${o} : ${r||n})`}return r}),[ke.Between]:pr(([t,e,n])=>`(${t} >= ${e} && ${t} <= ${n})`),[ke.Interpolate]:pr(([t,e,...n])=>{let r="";for(let i=0;i<n.length-2;i+=2){const s=n[i],o=r||n[i+1],a=n[i+2],l=n[i+3];let c;t===ag(1)?c=`(${e} - ${s}) / (${a} - ${s})`:c=`(pow(${t}, (${e} - ${s})) - 1.0) / (pow(${t}, (${a} - ${s})) - 1.0)`,r=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[ke.Case]:pr(t=>{const e=t[t.length-1];let n=null;for(let r=t.length-3;r>=0;r-=2){const i=t[r],s=t[r+1];n=`(${i} ? ${s} : ${n||e})`}return n}),[ke.In]:pr(([t,...e],n)=>{const r=SIe("in",n),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return n.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${t})`}),[ke.Array]:pr(t=>`vec${t.length}(${t.join(", ")})`),[ke.Color]:pr(t=>{if(t.length===1)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(t.length===2)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(r=>`${r} / 255.0`);if(t.length===3)return`vec4(${e.join(", ")}, 1.0)`;const n=t[3];return`vec4(${e.join(", ")}, ${n})`}),[ke.Band]:pr(([t,e,n],r)=>{if(!(f6 in r.functions)){let i="";const s=r.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const c=`${h6.TILE_TEXTURE_ARRAY}[${a}]`;i+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[f6]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${h6.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${h6.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${f6}(${t}, ${e??"0.0"}, ${n??"0.0"})`}),[ke.Palette]:(t,e)=>{const[n,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const u=r[c].value,h=su(u),f=c*4;s[f]=h[0],s[f+1]=h[1],s[f+2]=h[2],s[f+3]=h[3]*255}t.paletteTextures||(t.paletteTextures=[]);const o=`${AIe}[${t.paletteTextures.length}]`,a=new EIe(o,s);t.paletteTextures.push(a);const l=qz(n,Wt,t);return`texture2D(${o}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function qz(t,e,n){if(t instanceof Uae){const r=RIe[t.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return r(n,t,e)}if((t.type&Wt)>0)return ag(t.value);if((t.type&Es)>0)return t.value.toString();if((t.type&$s)>0)return Pf(t.value.toString());if((t.type&wi)>0)return EC(t.value);if((t.type&bl)>0)return Wz(t.value);if((t.type&Kc)>0)return TIe(t.value);throw new Error(`Unexpected expression ${t.value} (expected type ${dx(e)})`)}function PIe(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const wX=.985;function Tn(t,e,n){const r=Nz();return IIe(e,n,r,t)}function CIe(t){const e=su(t),n=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[n+r,i+s]}const MIe=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function Kz(t){return t===wi||t===Kc?2:t===bl?4:1}function hj(t){const e=Kz(t);return e>1?`vec${e}`:"float"}function cle(t,e){for(const n in e.variables){const r=e.variables[n],i=Hz(r.name);let s=hj(r.type);r.type===wi&&(s="vec4"),t.addUniform(i,s)}for(const n in e.properties){const r=e.properties[n],i=hj(r.type),s=`a_prop_${r.name}`;r.type===wi?t.addAttribute(s,i,`unpackColor(${s})`,"vec4"):t.addAttribute(s,i)}for(const n in e.functions)t.addVertexShaderFunction(e.functions[n]),t.addFragmentShaderFunction(e.functions[n])}function ule(t,e){const n={};for(const r in t.variables){const i=t.variables[r],s=Hz(i.name);n[s]=()=>{const o=e[i.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(i.type===wi){const a=[...su(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??=1,a}return typeof o=="string"?tk(o):o}}return n}function hle(t){const e={};for(const n in t.properties){const r=t.properties[n],i=s=>{const o=s.get(r.name);return r.type===wi?CIe([...su(o||"#eee")]):typeof o=="string"?tk(o):typeof o=="boolean"?o?1:0:o};e[`prop_${r.name}`]={size:Kz(r.type),callback:i}}return e}const Jv=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${MIe}
`,Qv=PIe();class dle{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${ag(Qv["circle-radius"])} + ${ag(Qv["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=EC(Qv["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=ag(Qv["stroke-width"]),this.strokeColorExpression_=EC(Qv["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Pf("round"),this.strokeJoinExpression_=Pf("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=EC(Qv["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,n){return this.uniforms_.push({name:e,type:n}),this}addAttribute(e,n,r,i){return this.attributes_.push({name:e,type:n,varyingName:e.replace(/^a_/,"v_"),varyingType:i??n,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${wX} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${wX}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Pf("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Pf("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Pf("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Pf("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class x3{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,n){for(let r=0;r<e.length;r++)this.addFeature(e[r],n)}addFeature(e,n){let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const n=_n(e),r=this.pointBatch.entries[n];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[n],r}clearFeatureEntryInLineStringBatch_(e){const n=_n(e),r=this.lineStringBatch.entries[n];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[n],r}clearFeatureEntryInPolygonBatch_(e){const n=_n(e),r=this.polygonBatch.entries[n];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[n],r}addGeometry_(e,n){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,n);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),n,_n(n),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),n,_n(n),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,n,_n(n),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),n,_n(n),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,n,_n(n),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,n,_n(n),s,i.getLayout?.());break}}}addCoordinates_(e,n,r,i,s,o,a){let l;switch(e){case"MultiPolygon":{const c=r;for(let u=0,h=c.length;u<h;u++){let f=c[u];const g=u>0?c[u-1]:null,v=g?g[g.length-1]:0,x=f[f.length-1];f=v>0?f.map(b=>b-v):f,this.addCoordinates_("Polygon",n.slice(v,x),f,i,s,o,a)}break}case"MultiLineString":{const c=r;for(let u=0,h=c.length;u<h;u++){const f=u>0?c[u-1]:0;this.addCoordinates_("LineString",n.slice(f,c[u]),null,i,s,o,a)}break}case"MultiPoint":for(let c=0,u=n.length;c<u;c+=o)this.addCoordinates_("Point",n.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof hl){const f=Mae(n,c);if(f.length>1){this.addCoordinates_("MultiPolygon",n,f,i,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=n.length/o;const u=r.length,h=r.map((f,g,v)=>g>0?(f-v[g-1])/o:f/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=u,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(NIe(n,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(h),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=u;for(let f=0,g=c.length;f<g;f++){const v=f>0?c[f-1]:0;this.addCoordinates_("LinearRing",n.slice(v,c[f]),null,i,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(n);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=n.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(OIe(n,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,n){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return n.ref=i,r||(this.refToFeature_.set(i,n.feature),this.uidToRef_.set(e,i)),n}removeRef_(e,n){if(!e)throw new Error("This feature has no ref: "+n);this.refToFeature_.delete(e),this.uidToRef_.delete(n),this.freeGlobalRef_.push(e)}changeFeature(e,n){if(!this.uidToRef_.get(_n(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}removeFeature(e){let n=this.clearFeatureEntryInPointBatch_(e);n=this.clearFeatureEntryInPolygonBatch_(e)||n,n=this.clearFeatureEntryInLineStringBatch_(e)||n,n&&this.removeRef_(n.ref,_n(n.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const n=new x3;n.globalCounter_=this.globalCounter_,n.uidToRef_=this.uidToRef_,n.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(n.addFeature(i),r=!1);return r?new x3:n}}function NIe(t,e){return e===2?t:t.filter((n,r)=>r%e<2)}function OIe(t,e,n){return e===3&&n==="XYM"?t:e===4?t.filter((r,i)=>i%e!==2):e===3?t.map((r,i)=>i%e!==2?r:0):new Array(t.length*1.5).fill(0).map((r,i)=>i%3===2?0:t[Math.round(i/1.5)])}function LIe(){const t='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}const p6={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function DIe(t,e){e=e||[];const n=256,r=n-1,i=Math.floor(t/n/n/n)/r,s=Math.floor(t/n/n)%n/r,o=Math.floor(t/n)%n/r,a=t%n/r;return e[0]=i*256*255+s*255,e[1]=o*256*255+a*255,e}function $Ie(t){let e=0;const n=256,r=n-1;return e+=Math.round(t[0]*n*n*n*r),e+=Math.round(t[1]*n*n*r),e+=Math.round(t[2]*n*r),e+=Math.round(t[3]*r),e}function Yz(t,e,n,r){let i=0;for(const s in e){const o=e[s],a=o.callback.call(n,n.feature);let l=a?.[0]??a;l===uj&&console.warn('The "has" operator might return false positives.'),l===void 0?l=uj:l===null&&(l=0),t[r+i++]=l,!(!o.size||o.size===1)&&(t[r+i++]=a[1],!(o.size<3)&&(t[r+i++]=a[2],!(o.size<4)&&(t[r+i++]=a[3])))}return i}function l5(t){return Object.keys(t).reduce((e,n)=>e+(t[n].size||1),0)}function jIe(t,e,n,r){const i=(2+l5(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Yi(r,s),e[o++]=s[0],e[o++]=s[1],o+=Yz(e,n,l,o)}return e}function FIe(t,e,n,r){const i=3*t.verticesCount+(1+l5(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,ld(l.flatCoordss[c],0,s.length,3,r,s,3),o+=Yz(e,n,l,o),e[o++]=s.length/3;for(let h=0,f=s.length;h<f;h+=3)e[o++]=s[h],e[o++]=s[h+1],e[o++]=s[h+2]}}return e}function VIe(t,e,n,r){const i=2*t.verticesCount+(1+l5(n))*t.geometriesCount+t.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,ld(l.flatCoordss[c],0,s.length,2,r,s),o+=Yz(e,n,l,o),e[o++]=l.ringsVerticesCounts[c].length;for(let h=0,f=l.ringsVerticesCounts[c].length;h<f;h++)e[o++]=l.ringsVerticesCounts[c][h];for(let h=0,f=s.length;h<f;h+=2)e[o++]=s[h],e[o++]=s[h+1]}}return e}function w3(t){return(JSON.stringify(t).split("").reduce((n,r)=>(n<<5)-n+r.charCodeAt(0),0)>>>0).toString()}function Xz(t,e,n,r){if(`${r}radius`in t&&r!=="icon-"){let i=Tn(n,t[`${r}radius`],Wt);if(`${r}radius2`in t){const s=Tn(n,t[`${r}radius2`],Wt);i=`max(${i}, ${s})`}`${r}stroke-width`in t&&(i=`(${i} + ${Tn(n,t[`${r}stroke-width`],Wt)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in t){const i=Tn(n,t[`${r}scale`],Kc);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in t&&e.setSymbolOffsetExpression(Tn(n,t[`${r}displacement`],bl)),`${r}rotation`in t&&e.setSymbolRotationExpression(Tn(n,t[`${r}rotation`],Wt)),`${r}rotate-with-view`in t&&e.setSymbolRotateWithView(!!t[`${r}rotate-with-view`])}function fle(t,e,n,r,i){let s="vec4(0.)";if(e!==null&&(s=e),n!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${t})`;s=`mix(${n}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${t}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return i!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${i})`),a}function Zz(t,e,n,r,i){const s=new Image;s.crossOrigin=t[`${r}cross-origin`]===void 0?"anonymous":t[`${r}cross-origin`],ar(typeof t[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=t[`${r}src`],n[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const o=`u_texture${i}_size`;return n[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),o}function Jz(t,e,n,r,i){let s=Tn(n,t[`${e}offset`],Kc);if(`${e}offset-origin`in t)switch(t[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function zIe(t,e,n,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,Xz(t,e,r,"circle-");let i=null;"circle-opacity"in t&&(i=Tn(r,t["circle-opacity"],Wt));let s="coordsPx";"circle-scale"in t&&(s=`coordsPx / ${Tn(r,t["circle-scale"],Kc)}`);let o=null;"circle-fill-color"in t&&(o=Tn(r,t["circle-fill-color"],wi));let a=null;"circle-stroke-color"in t&&(a=Tn(r,t["circle-stroke-color"],wi));let l=Tn(r,t["circle-radius"],Wt),c=null;"circle-stroke-width"in t&&(c=Tn(r,t["circle-stroke-width"],Wt),l=`(${l} + ${c} * 0.5)`);const u=`circleDistanceField(${s}, ${l})`,h=fle(u,o,a,c,i);e.setSymbolColorExpression(h)}function UIe(t,e,n,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,Xz(t,e,r,"shape-");let i=null;"shape-opacity"in t&&(i=Tn(r,t["shape-opacity"],Wt));let s="coordsPx";"shape-scale"in t&&(s=`coordsPx / ${Tn(r,t["shape-scale"],Kc)}`);let o=null;"shape-fill-color"in t&&(o=Tn(r,t["shape-fill-color"],wi));let a=null;"shape-stroke-color"in t&&(a=Tn(r,t["shape-stroke-color"],wi));let l=null;"shape-stroke-width"in t&&(l=Tn(r,t["shape-stroke-width"],Wt));const c=Tn(r,t["shape-points"],Wt);let u="0.";"shape-angle"in t&&(u=Tn(r,t["shape-angle"],Wt));let h,f=Tn(r,t["shape-radius"],Wt);if(l!==null&&(f=`${f} + ${l} * 0.5`),"shape-radius2"in t){let v=Tn(r,t["shape-radius2"],Wt);l!==null&&(v=`${v} + ${l} * 0.5`),h=`starDistanceField(${s}, ${c}, ${f}, ${v}, ${u})`}else h=`regularDistanceField(${s}, ${c}, ${f}, ${u})`;const g=fle(h,o,a,l,i);e.setSymbolColorExpression(g)}function GIe(t,e,n,r){let i="vec4(1.0)";"icon-color"in t&&(i=Tn(r,t["icon-color"],wi)),"icon-opacity"in t&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${Tn(r,t["icon-opacity"],Wt)})`);const s=w3(t["icon-src"]),o=Zz(t,e,n,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in t&&"icon-height"in t&&e.setSymbolSizeExpression(`vec2(${Tn(r,t["icon-width"],Wt)}, ${Tn(r,t["icon-height"],Wt)})`),"icon-offset"in t&&"icon-size"in t){const a=Tn(r,t["icon-size"],bl),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(a);const c=Jz(t,"icon-",r,"v_quadSizePx",a);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(Xz(t,e,r,"icon-"),"icon-anchor"in t){const a=Tn(r,t["icon-anchor"],bl);let l="1.0";"icon-scale"in t&&(l=Tn(r,t["icon-scale"],Kc));let c;t["icon-anchor-x-units"]==="pixels"&&t["icon-anchor-y-units"]==="pixels"?c=`${a} * ${l}`:t["icon-anchor-x-units"]==="pixels"?c=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:t["icon-anchor-y-units"]==="pixels"?c=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${a} * v_quadSizePx`;let u=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in t)switch(t["icon-anchor-origin"]){case"top-right":u=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":u=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":u=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${u}`)}}function BIe(t,e,n,r){if("stroke-color"in t&&e.setStrokeColorExpression(Tn(r,t["stroke-color"],wi)),"stroke-pattern-src"in t){const i=w3(t["stroke-pattern-src"]),s=Zz(t,e,n,"stroke-pattern-",i);let o=s,a="vec2(0.)";"stroke-pattern-offset"in t&&"stroke-pattern-size"in t&&(o=Tn(r,t["stroke-pattern-size"],bl),a=Jz(t,"stroke-pattern-",r,s,o));let l="0.";"stroke-pattern-spacing"in t&&(l=Tn(r,t["stroke-pattern-spacing"],Wt));let c="0.";"stroke-pattern-start-offset"in t&&(c=Tn(r,t["stroke-pattern-start-offset"],Wt)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const u=`u_texture${i}`;let h="1.";"stroke-color"in t&&(h=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${h} * sampleStrokePattern(${u}, ${s}, ${a}, ${o}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${o}, ${l}, v_width)`)}if("stroke-width"in t&&e.setStrokeWidthExpression(Tn(r,t["stroke-width"],Wt)),"stroke-offset"in t&&e.setStrokeOffsetExpression(Tn(r,t["stroke-offset"],Wt)),"stroke-line-cap"in t&&e.setStrokeCapExpression(Tn(r,t["stroke-line-cap"],$s)),"stroke-line-join"in t&&e.setStrokeJoinExpression(Tn(r,t["stroke-line-join"],$s)),"stroke-miter-limit"in t&&e.setStrokeMiterLimitExpression(Tn(r,t["stroke-miter-limit"],Wt)),"stroke-line-dash"in t){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${Pf("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${Pf("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=t["stroke-line-dash"].map(v=>Tn(r,v,Wt));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in t&&(s=Tn(r,t["stroke-line-dash-offset"],Wt));const a=`dashDistanceField_${w3(t["stroke-line-dash"])}`,l=i.map((v,x)=>`float dashLength${x}`).join(", "),c=i.map((v,x)=>`dashLength${x}`).join(" + ");let u="0.",h=`getSingleDashDistance(distance, radius, ${u}, dashLength0, totalDashLength, capType, lineWidth)`;for(let v=2;v<i.length;v+=2)u=`${u} + dashLength${v-2} + dashLength${v-1}`,h=`min(${h}, getSingleDashDistance(distance, radius, ${u}, dashLength${v}, totalDashLength, capType, lineWidth))`;r.functions[a]=`float ${a}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${h};
}`;const f=i.map((v,x)=>`${v}`).join(", ");e.setStrokeDistanceFieldExpression(`${a}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${f})`);let g=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,g=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${g})`),e.setStrokePatternLengthExpression(g)}}function WIe(t,e,n,r){if("fill-color"in t&&e.setFillColorExpression(Tn(r,t["fill-color"],wi)),"fill-pattern-src"in t){const i=w3(t["fill-pattern-src"]),s=Zz(t,e,n,"fill-pattern-",i);let o=s,a="vec2(0.)";"fill-pattern-offset"in t&&"fill-pattern-size"in t&&(o=Tn(r,t["fill-pattern-size"],bl),a=Jz(t,"fill-pattern-",r,s,o)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in t&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function bX(t,e,n){const r=ole(),i=new dle,s={};if("icon-src"in t?GIe(t,i,s,r):"shape-points"in t?UIe(t,i,s,r):"circle-radius"in t&&zIe(t,i,s,r),BIe(t,i,s,r),WIe(t,i,s,r),n){const l=Tn(r,n,Es);i.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,c,u,h){if(!r[l])return;const f=hj(u),g=Kz(u);i.addAttribute(`a_${c}`,f),o[c]={size:g,callback:h}}return a("geometryType",lle,$s,l=>tk(Oz(l.getGeometry()))),a("featureId",ale,$s|Wt,l=>{const c=l.getId()??null;return typeof c=="string"?tk(c):c}),cle(i,r),{builder:i,attributes:{...o,...hle(r)},uniforms:{...s,...ule(r,e)}}}const HIe=[];let m6;function qIe(){return m6||(m6=LIe()),m6}let KIe=0;const Ec={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class YIe{constructor(e,n,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=XIe(e,n),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return DIe(this.ref,HIe)},size:2});for(const s of this.styleShaders){for(const o in s.attributes)o in this.customAttributes_||(this.customAttributes_[o]=s.attributes[o]);for(const o in s.uniforms)o in this.uniforms_||(this.uniforms_[o]=s.uniforms[o])}this.renderPasses_=this.styleShaders.map(s=>{const o={},a=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:bo.FLOAT}));return s.builder.getFillVertexShader()&&(o.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Ec.POSITION,size:2,type:bo.FLOAT},...a],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(o.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Ec.LOCAL_POSITION,size:2,type:bo.FLOAT}],instancedAttributesDesc:[{name:Ec.SEGMENT_START,size:2,type:bo.FLOAT},{name:Ec.MEASURE_START,size:1,type:bo.FLOAT},{name:Ec.SEGMENT_END,size:2,type:bo.FLOAT},{name:Ec.MEASURE_END,size:1,type:bo.FLOAT},{name:Ec.JOIN_ANGLES,size:2,type:bo.FLOAT},{name:Ec.DISTANCE_LOW,size:1,type:bo.FLOAT},{name:Ec.DISTANCE_HIGH,size:1,type:bo.FLOAT},{name:Ec.ANGLE_TANGENT_SUM,size:1,type:bo.FLOAT},...a],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(o.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Ec.LOCAL_POSITION,size:2,type:bo.FLOAT}],instancedAttributesDesc:[{name:Ec.POSITION,size:2,type:bo.FLOAT},...a],instancePrimitiveVertexCount:6}),o}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,n){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,n),[i,s,o]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",n),this.generateBuffersForType_(r.lineStringInstructions,"LineString",n),this.generateBuffersForType_(r.pointInstructions,"Point",n)]),a=HT(js(),n);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:o,invertVerticesTransform:a}}generateRenderInstructions_(e,n){const r=this.hasFill_?VIe(e.polygonBatch,new Float32Array(0),this.customAttributes_,n):null,i=this.hasStroke_?FIe(e.lineStringBatch,new Float32Array(0),this.customAttributes_,n):null,s=this.hasSymbol_?jIe(e.pointBatch,new Float32Array(0),this.customAttributes_,n):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,n,r){if(e===null)return null;const i=KIe++;let s;switch(n){case"Polygon":s=p6.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=p6.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=p6.GENERATE_POINT_BUFFERS;break}const o={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:l5(this.customAttributes_)},a=qIe();return a.postMessage(o,[e.buffer]),e=null,new Promise(l=>{const c=u=>{const h=u.data;if(h.id!==i||(a.removeEventListener("message",c),!this.helper_.getGL()))return;const f=new l6(zz,a6).fromArrayBuffer(h.indicesBuffer),g=new l6(g3,a6).fromArrayBuffer(h.vertexAttributesBuffer),v=new l6(g3,a6).fromArrayBuffer(h.instanceAttributesBuffer);this.helper_.flushBufferData(f),this.helper_.flushBufferData(g),this.helper_.flushBufferData(v),l([f,g,v])};a.addEventListener("message",c)})}render(e,n,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,n,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,n,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,n,r)}renderInternal_(e,n,r,i,s,o){const a=e.getSize();if(a===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(n),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),o(),l){const c=i.instancedAttributesDesc.reduce((h,f)=>h+(f.size||1),0),u=r.getSize()/c;this.helper_.drawElementsInstanced(0,a,u)}else this.helper_.drawElements(0,a)}setHelper(e,n=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),n&&(n.polygonBuffers&&(this.helper_.flushBufferData(n.polygonBuffers[0]),this.helper_.flushBufferData(n.polygonBuffers[1]),this.helper_.flushBufferData(n.polygonBuffers[2])),n.lineStringBuffers&&(this.helper_.flushBufferData(n.lineStringBuffers[0]),this.helper_.flushBufferData(n.lineStringBuffers[1]),this.helper_.flushBufferData(n.lineStringBuffers[2])),n.pointBuffers&&(this.helper_.flushBufferData(n.pointBuffers[0]),this.helper_.flushBufferData(n.pointBuffers[1]),this.helper_.flushBufferData(n.pointBuffers[2])))}}function XIe(t,e){const n=Array.isArray(t)?t:[t];if("style"in n[0]){const r=[],i=n,s=[];for(const o of i){const a=Array.isArray(o.style)?o.style:[o.style];let l=o.filter;o.else&&s.length&&(l=["all",...s.map(u=>["!",u])],o.filter&&l.push(o.filter),l.length<3&&(l=l[1])),o.filter&&s.push(o.filter);const c=a.map(u=>bX(u,e,l));r.push(...c)}return r}return"builder"in n[0]?n:n.map(r=>bX(r,e,null))}const Mh=new Uint8Array(4);class ZIe{constructor(e,n){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=n||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){pp(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,n=this.helper_.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.readPixels(0,0,e[0],e[1],n.RGBA,n.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,n){if(e<0||n<0||e>this.size_[0]||n>=this.size_[1])return Mh[0]=0,Mh[1]=0,Mh[2]=0,Mh[3]=0,Mh;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(n)-1)*this.size_[0];return Mh[0]=this.data_[r*4],Mh[1]=this.data_[r*4+1],Mh[2]=this.data_[r*4+2],Mh[3]=this.data_[r*4+3],Mh}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,n=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.viewport(0,0,e[0],e[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture_,0),n.bindRenderbuffer(n.RENDERBUFFER,this.depthbuffer_),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e[0],e[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function JIe(t,e){const n=t.viewState.projection,i=e.getSource().getWrapX()&&n.canWrapX(),s=n.getExtent(),o=t.extent,a=i?Gn(s):null,l=i?Math.ceil((o[2]-s[2])/a)+1:1;return[i?Math.floor((o[0]-s[0])/a):0,l,a]}const e_={...cf,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class QIe extends Bz{constructor(e,n){const r={[e_.RENDER_EXTENT]:[0,0,0,0],[e_.PATTERN_ORIGIN]:[0,0],[e_.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:n.postProcesses}),this.hitDetectionEnabled_=!n.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=$a(),this.currentTransform_=js(),this.tmpCoords_=[0,0],this.tmpTransform_=js(),this.tmpMat4_=Zae(),this.currentFrameStateTransform_=js(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(n),this.batch_=new x3,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const n=this.getLayer().getSource();let r;this.batch_.addFeatures(n.getFeatures(),r),this.sourceListenKeys_=[Hn(n,Xo.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),Hn(n,Xo.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),Hn(n,Xo.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),Hn(n,Xo.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new YIe(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new ZIe(this.helper))}handleSourceFeatureAdded_(e,n){const r=n.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,n){const r=n.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const n=e.feature;this.batch_.removeFeature(n)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){iae(this.tmpTransform_,this.currentFrameStateTransform_),rae(this.tmpTransform_,e),this.helper.setUniformMatrixValue(e_.PROJECTION_MATRIX,lj(this.tmpMat4_,this.tmpTransform_)),HT(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(e_.SCREEN_TO_WORLD_MATRIX,lj(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,HT(this.tmpTransform_,e),Yi(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(e_.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const n=this.helper.getGL();this.preRender(n,e);const[r,i,s]=JIe(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(n,e),o}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const n=this.getLayer(),r=n.getSource(),i=e.viewState,s=!e.viewHints[ws.ANIMATING]&&!e.viewHints[ws.INTERACTING],o=!h1(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),s&&(o||a)){const l=i.projection,c=i.resolution,u=n instanceof o5?n.getRenderBuffer():0,h=nd(e.extent,u*c);r.loadFeatures(h,c,l),this.ready=!1;const f=this.helper.makeProjectionTransform(e,js());this.styleRenderer_.generateBuffers(this.batch_,f).then(g=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=g,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,n,r,i,s){let o=r;n&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),bTe(this.currentFrameStateTransform_,o*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(n)});while(++o<i)}forEachFeatureAtCoordinate(e,n,r,i,s){if(ar(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const o=Yi(n.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],c=$Ie(l),u=this.batch_.getFeatureFromRef(c);if(u)return i(u,this.getLayer(),null)}disposeBuffers(e){const n=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&n(e.pointBuffers),e.lineStringBuffers&&n(e.lineStringBuffers),e.polygonBuffers&&n(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){Jr(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const ef={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},eRe=["#00f","#0ff","#0f0","#ff0","#f00"];class tRe extends o5{constructor(e){e=e||{};const n=Object.assign({},e);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,super(n),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(ef.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:eRe),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(ef.BLUR)}getGradient(){return this.get(ef.GRADIENT)}getRadius(){return this.get(ef.RADIUS)}handleGradientChanged_(){this.gradient_=nRe(this.getGradient())}setBlur(e){const n=this.get(ef.BLUR);if(this.set(ef.BLUR,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(ef.GRADIENT,e)}setRadius(e){const n=this.get(ef.RADIUS);if(this.set(ef.RADIUS,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new dle,n=ole(),r=Tn(n,this.filter_,Es);let i=Tn(n,this.getRadius(),Wt),s=Tn(n,this.getBlur(),Wt);const o={};typeof this.getBlur()=="number"&&(s="a_blur",o.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",o.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const a={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const h=typeof this.weight_=="string"?f=>f.get(this.weight_):this.weight_;a.prop_weight={size:1,callback:f=>{const g=h(f);return g!==void 0?ii(g,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const h=["clamp",this.weight_,0,1];l=Tn(n,h,Wt)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),cle(e,n);const c=hle(n),u=ule(n,this.styleVariables_);return new QIe(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...a},uniforms:{...u,...o}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function nRe(t){const r=Ts(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(t.length-1);for(let o=0,a=t.length;o<a;++o)i.addColorStop(o*s,t[o]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class rRe extends Cz{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const n=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(n.extent!==void 0&&(l=Bf(l,rd(n.extent,i.projection))),!a[ws.ANIMATING]&&!a[ws.INTERACTING]&&!M2(l))if(o){const c=i.projection,u=o.getImage(l,s,r,c);u&&(this.loadImage(u)?this.image=u:u.getState()===Vt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=Yi(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!u1(s,i))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=Gn(o),c=Math.floor(a.width*((i[0]-o[0])/l));if(c<0||c>=a.width)return null;const u=cs(o),h=Math.floor(a.height*((o[3]-i[1])/u));return h<0||h>=a.height?null:this.getImageData(a,c,h)}renderFrame(e,n){const r=this.image,i=r.getExtent(),s=r.getResolution(),[o,a]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],u=e.pixelRatio,h=e.viewState,f=h.center,g=h.resolution,v=u*o/(g*l),x=u*a/(g*l);this.prepareContainer(e,n);const b=this.context.canvas.width,T=this.context.canvas.height,A=this.getRenderContext(e);let I=!1,R=!0;if(c.extent){const O=rd(c.extent,h.projection);R=Ia(O,e.extent),I=R&&!zm(O,e.extent),I&&this.clipUnrotated(A,e,O)}const M=r.getImage(),F=iu(this.tempTransform,b/2,T/2,v,x,0,l*(i[0]-f[0])/o,l*(f[1]-i[3])/a);this.renderedResolution=a*u/l;const C=M.width*F[0],N=M.height*F[3];if(this.getLayer().getSource().getInterpolate()||(A.imageSmoothingEnabled=!1),this.preRender(A,e),R&&C>=.5&&N>=.5){const O=F[4],j=F[5],V=c.opacity;V!==1&&(A.save(),A.globalAlpha=V),A.drawImage(M,0,0,+M.width,+M.height,O,j,C,N),V!==1&&A.restore()}return this.postRender(this.context,e),I&&A.restore(),A.imageSmoothingEnabled=!0,this.container}}class iRe extends IA{constructor(e){e=e||{},super(e)}}class sRe extends iRe{constructor(e){super(e)}createRenderer(){return new rRe(this)}getData(e){return super.getData(e)}}function g6(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function oRe(t,e,n){const r=t[n];return r?r.delete(e):!1}function EX(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=Bf(e,rd(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=Bf(e,i))}return e}class aRe extends Cz{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=$a(),this.tempTileRange_=new Gz(0,0,0,0),this.tempTileCoord_=_3(0,0,0);const r=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new xX(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new xX(512)),this.sourceTileCache_}getOrCreateTile(e,n,r,i){const s=this.tileCache_,a=this.getLayer().getSource(),l=bC(a,a.getKey(),e,n,r);let c;if(s.containsKey(l))c=s.get(l);else{const u=i.viewState.projection,h=a.getProjection();if(c=a.getTile(e,n,r,i.pixelRatio,u,!h||Uy(h,u)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,n,r,i){const s=this.getOrCreateTile(e,n,r,i);return s||null}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=Yi(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!u1(s,i))return null;const o=n.viewState,a=r.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(n.pixelRatio);for(let u=l.getZForResolution(o.resolution);u>=l.getMinZoom();--u){const h=l.getTileCoordForCoordAndZ(i,u),f=this.getTile(u,h[1],h[2],n);if(!f||f.getState()!==ln.LOADED)continue;const g=l.getOrigin(u),v=Ca(l.getTileSize(u)),x=l.getResolution(u);let b;if(f instanceof ele||f instanceof ile)b=f.getImage();else if(f instanceof yX){if(b=cj(f.getData()),!b)continue}else continue;const T=Math.floor(c*((i[0]-g[0])/x-h[1]*v[0])),A=Math.floor(c*((g[1]-i[1])/x-h[2]*v[1])),I=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(b,T+I,A+I)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const r=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,r,i,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),u=_n(l);u in e.wantedTiles||(e.wantedTiles[u]={});const h=e.wantedTiles[u],f=a.getMapInternal(),g=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),v=o.rotation,x=v?Goe(o.center,o.resolution,v,e.size):void 0;for(let b=r;b>=g;--b){const T=c.getTileRangeForExtentAndZ(n,b,this.tempTileRange_),A=c.getResolution(b);for(let I=T.minX;I<=T.maxX;++I)for(let R=T.minY;R<=T.maxY;++R){if(v&&!c.tileCoordIntersectsViewport([b,I,R],x))continue;const M=this.getTile(b,I,R,e);if(!M||!g6(i,M,b))continue;const C=M.getKey();if(h[C]=!0,M.getState()===ln.IDLE&&!e.tileQueue.isKeyQueued(C)){const N=_3(b,I,R,this.tempTileCoord_);e.tileQueue.enqueue([M,u,c.getTileCoordCenter(N),A])}}}}findStaleTile_(e,n){const r=this.tileCache_,i=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=bC(this.getLayer().getSource(),a[l],i,s,o);if(r.containsKey(c)){const u=r.peek(c);if(u.getState()===ln.LOADED)return u.endTransition(_n(this)),g6(n,u,i),!0}}return!1}findAltTiles_(e,n,r,i){const s=e.getTileRangeForTileCoordAndZ(n,r,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let u=s.minX;u<=s.maxX;++u)for(let h=s.minY;h<=s.maxY;++h){const f=bC(l,c,r,u,h);let g=!1;if(a.containsKey(f)){const v=a.peek(f);v.getState()===ln.LOADED&&(g6(i,v,r),g=!0)}g||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,o=i.resolution,a=i.center,l=e.pixelRatio,c=this.getLayer(),u=c.getSource(),h=u.getTileGridForProjection(s),f=h.getZForResolution(o,u.zDirection),g=h.getResolution(f),v=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let x=e.extent;const b=u.getTilePixelRatio(l);this.prepareContainer(e,n);const T=this.context.canvas.width,A=this.context.canvas.height,I=r.extent&&rd(r.extent);I&&(x=Bf(x,rd(r.extent)));const R=g*T/2/b,M=g*A/2/b,F=[a[0]-R,a[1]-M,a[0]+R,a[1]+M],C={};this.renderedTiles.length=0;const N=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const de=h.getZForResolution(i.nextResolution,u.zDirection),Oe=EX(e,e.nextExtent);this.enqueueTiles(e,Oe,de,C,N)}const O=EX(e,x);if(this.enqueueTiles(e,O,f,C,0),N>0&&setTimeout(()=>{this.enqueueTiles(e,O,f-1,C,N-1)},0),!(f in C))return this.container;const j=_n(this),V=e.time;for(const de of C[f]){const Oe=de.getState();if(Oe===ln.EMPTY)continue;const Ae=de.tileCoord;if(Oe===ln.LOADED&&de.getAlpha(j,V)===1){de.endTransition(j);continue}if(Oe!==ln.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Ae,C)){oRe(C,de,f),e.animate=!0;continue}if(this.findAltTiles_(h,Ae,f+1,C))continue;const ne=h.getMinZoom();for(let ie=f-1;ie>=ne&&!this.findAltTiles_(h,Ae,ie,C);--ie);}const W=g/o*l/b,U=this.getRenderContext(e);iu(this.tempTransform,T/2,A/2,W,W,0,-T/2,-A/2),r.extent&&this.clipUnrotated(U,e,I),u.getInterpolate()||(U.imageSmoothingEnabled=!1),this.preRender(U,e);const pe=Object.keys(C).map(Number);pe.sort(Gf);let Ne;const Se=[],je=[];for(let de=pe.length-1;de>=0;--de){const Oe=pe[de],Ae=u.getTilePixelSize(Oe,l,s),B=h.getResolution(Oe)/g,ne=Ae[0]*B*W,ie=Ae[1]*B*W,le=h.getTileCoordForCoordAndZ(q1(F),Oe),ve=h.getTileCoordExtent(le),qe=Yi(this.tempTransform,[b*(ve[0]-F[0])/g,b*(F[3]-ve[3])/g]),Ke=b*u.getGutterForProjection(s);for(const Te of C[Oe]){if(Te.getState()!==ln.LOADED)continue;const we=Te.tileCoord,Dt=le[1]-we[1],Ye=Math.round(qe[0]-(Dt-1)*ne),sn=le[2]-we[2],$t=Math.round(qe[1]-(sn-1)*ie),fn=Math.round(qe[0]-Dt*ne),yn=Math.round(qe[1]-sn*ie),dt=Ye-fn,lr=$t-yn,$n=pe.length===1;let Un=!1;Ne=[fn,yn,fn+dt,yn,fn+dt,yn+lr,fn,yn+lr];for(let Xr=0,po=Se.length;Xr<po;++Xr)if(!$n&&Oe<je[Xr]){const kr=Se[Xr];Ia([fn,yn,fn+dt,yn+lr],[kr[0],kr[3],kr[4],kr[7]])&&(Un||(U.save(),Un=!0),U.beginPath(),U.moveTo(Ne[0],Ne[1]),U.lineTo(Ne[2],Ne[3]),U.lineTo(Ne[4],Ne[5]),U.lineTo(Ne[6],Ne[7]),U.moveTo(kr[6],kr[7]),U.lineTo(kr[4],kr[5]),U.lineTo(kr[2],kr[3]),U.lineTo(kr[0],kr[1]),U.clip())}Se.push(Ne),je.push(Oe),this.drawTile(Te,e,fn,yn,dt,lr,Ke,$n),Un&&U.restore(),this.renderedTiles.unshift(Te),this.updateUsedTiles(e.usedTiles,u,Te)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!h1(this.renderedExtent_,F),this.renderedExtent_=F,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&U.restore(),U.imageSmoothingEnabled=!0,this.renderComplete){const de=(Oe,Ae)=>{const Q=_n(u),B=Ae.wantedTiles[Q],ne=B?Object.keys(B).length:0;this.updateCacheSize(ne),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(de)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,r,i,s,o,a,l){let c;if(e instanceof yX){if(c=cj(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const u=this.getRenderContext(n),h=_n(this),f=n.layerStatesArray[n.layerIndex],g=f.opacity*(l?e.getAlpha(h,n.time):1),v=g!==u.globalAlpha;v&&(u.save(),u.globalAlpha=g),u.drawImage(c,a,a,c.width-2*a,c.height-2*a,r,i,s,o),v&&u.restore(),g!==f.opacity?n.animate=!0:l&&e.endTransition(h)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,r){const i=_n(n);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const tP={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class lRe extends IA{constructor(e){e=e||{};const n=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(tP.PRELOAD)}setPreload(e){this.set(tP.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(tP.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(tP.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Am extends lRe{constructor(e){super(e)}createRenderer(){return new aRe(this,{cacheSize:this.getCacheSize()})}}function dj(t){return Array.isArray(t)?Math.min(...t):t}const t_=[0,0,0],Xp=5;class ple{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,ar(OSe(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!n)n=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,ar(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=q1(r)),ar(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,ar(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Fz,ar(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const o=new Gz(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const a=this.getTileRangeForExtentAndZ(r,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,n,r){const i=this.getTileRangeForExtentAndZ(e,n);for(let s=i.minX,o=i.maxX;s<=o;++s)for(let a=i.minY,l=i.maxY;a<=l;++a)r([n,s,a])}forEachTileCoordParentTileRange(e,n,r,i){let s,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Zv(o,o,a,a,r)):s=this.getTileRangeForExtentAndZ(l,c,r),n(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Zv(s,s+1,o,o+1,n)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,r){if(n>this.maxZoom||n<this.minZoom)return null;const i=e[0],s=e[1],o=e[2];if(n===i)return Zv(s,o,s,o,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,n-i),c=Math.floor(s*l),u=Math.floor(o*l);if(n<i)return Zv(c,c,u,u,r);const h=Math.floor(l*(s+1))-1,f=Math.floor(l*(o+1))-1;return Zv(c,h,u,f,r)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,n,r)}getTileRangeForExtentAndZ(e,n,r){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,t_);const i=t_[1],s=t_[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,t_);const o=t_[1],a=t_[2];return Zv(i,o,s,a,r)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Ca(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*i[0]*r,n[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,n){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Ca(this.getTileSize(e[0]),this.tmpSize_),o=r[0]+e[1]*s[0]*i,a=r[1]-(e[2]+1)*s[1]*i,l=o+s[0]*i,c=a+s[1]*i;return Eg(o,a,l,c,n)}getTileCoordForCoordAndResolution(e,n,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,r)}getTileCoordForXYAndResolution_(e,n,r,i,s){const o=this.getZForResolution(r),a=r/this.getResolution(o),l=this.getOrigin(o),c=Ca(this.getTileSize(o),this.tmpSize_);let u=a*(e-l[0])/r/c[0],h=a*(l[1]-n)/r/c[1];return i?(u=Um(u,Xp)-1,h=Um(h,Xp)-1):(u=BR(u,Xp),h=BR(h,Xp)),_3(o,u,h,s)}getTileCoordForXYAndZ_(e,n,r,i,s){const o=this.getOrigin(r),a=this.getResolution(r),l=Ca(this.getTileSize(r),this.tmpSize_);let c=(e-o[0])/a/l[0],u=(o[1]-n)/a/l[1];return i?(c=Um(c,Xp)-1,u=Um(u,Xp)-1):(c=BR(c,Xp),u=BR(u,Xp)),_3(r,c,u,s)}getTileCoordForCoordAndZ(e,n,r){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const r=BN(this.resolutions_,e,n||0);return ii(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return cae(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,r=new Array(n);for(let i=this.minZoom;i<n;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function mle(t){let e=t.getDefaultTileGrid();return e||(e=dRe(t),t.setDefaultTileGrid(e)),e}function cRe(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),s=Qz(n);if(!u1(s,i)){const o=Gn(s),a=Math.ceil((s[0]-i[0])/o);return i[0]+=o*a,t.getTileCoordForCoordAndZ(i,r)}return e}function uRe(t,e,n,r){r=r!==void 0?r:"top-left";const i=gle(t,e,n);return new ple({extent:t,origin:FSe(t,r),resolutions:i,tileSize:n})}function hRe(t){const e=t||{},n=e.extent||Yr("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:gle(n,e.maxZoom,e.tileSize,e.maxResolution)};return new ple(r)}function gle(t,e,n,r){e=e!==void 0?e:YAe,n=Ca(n!==void 0?n:Fz);const i=cs(t),s=Gn(t);r=r>0?r:Math.max(s/n[0],i/n[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=r/Math.pow(2,l);return a}function dRe(t,e,n,r){const i=Qz(t);return uRe(i,e,n,r)}function Qz(t){t=Yr(t);let e=t.getExtent();if(!e){const n=180*Lw.degrees/t.getMetersPerUnit();e=Eg(-n,-n,n,n)}return e}function eU(t,e){const n=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&n.push(i+"="+encodeURIComponent(e[i]))});const r=n.join("&");return t=t.replace(/[?&]$/,""),t+=t.includes("?")?"&":"?",t+r}const fRe=/\{z\}/g,pRe=/\{x\}/g,mRe=/\{y\}/g,gRe=/\{-y\}/g;function yRe(t,e,n,r,i){return t.replace(fRe,e.toString()).replace(pRe,n.toString()).replace(mRe,r.toString()).replace(gRe,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function vRe(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}function _Re(t,e){return(function(n,r,i){if(!n)return;let s;const o=n[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return yRe(t,o,n[1],n[2],s)})}function xRe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=_Re(t[i],e);return wRe(r)}function wRe(t){return t.length===1?t[0]:(function(e,n,r){if(!e)return;const i=sle(e),s=og(i,t.length);return t[s](e,n,r)})}class bRe extends Pz{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&Ca(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||_n(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,r,i,s,o){return xn()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:mle(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(n),o=Ca(i.getTileSize(e),this.tmpSize);return s==1?o:$ke(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const r=n!==void 0?n:this.getProjection(),i=n!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=cRe(i,e,r)),bIe(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class ERe extends Md{constructor(e,n){super(e),this.tile=n}}const y6={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class tU extends bRe{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===tU.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,r=_n(n),i=n.getState();let s;i==ln.LOADING?(this.tileLoadingKeys_[r]=!0,s=y6.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==ln.ERROR?y6.TILELOADERROR:i==ln.LOADED?y6.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new ERe(s,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=vRe(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(xRe(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,r){}}class yle extends tU{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:vle,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:ele,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Uy(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Uy(n,e)))return this.tileGrid;const r=_n(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=mle(e)),this.tileGridForProjection[r]}createTile_(e,n,r,i,s,o){const a=[e,n,r],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,i,s):void 0,u=new this.tileClass(a,c!==void 0?ln.IDLE:ln.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(An.CHANGE,this.handleTileChange.bind(this)),u}getTile(e,n,r,i,s,o){const a=this.getProjection();if(!a||!s||Uy(a,s))return this.getTileInternal(e,n,r,i,a||s);const l=[e,n,r],c=this.getKey(),u=this.getTileGridForProjection(a),h=this.getTileGridForProjection(s),f=this.getTileCoordForTileUrlFunction(l,s),g=new ile(a,u,s,h,l,f,this.getTilePixelRatio(i),this.getGutter(),(v,x,b,T)=>this.getTileInternal(v,x,b,T,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,g}getTileInternal(e,n,r,i,s,o){const a=this.getKey(),l=bC(this,a,e,n,r);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(e,n,r,i,s,a);return o?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const r=Yr(e);if(r){const i=_n(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=n)}}}function vle(t,e){if(tc){const n=t.getCrossOrigin();let r="same-origin",i="same-origin";n==="anonymous"||n===""?(r="cors",i="omit"):n==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=t.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class hy extends yle{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:hRe({extent:Qz(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const SRe="modulepreload",TRe=function(t){return"/detectorapp-nl/"+t},SX={},_e=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=l(n.map(c=>{if(c=TRe(c),c in SX)return;SX[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":SRe,u||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((g,v)=>{f.addEventListener("load",g),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};class kRe extends vae{constructor(e,n,r,i,s,o,a){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=n.getExtent();c&&n.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const u=c?Bf(r,c):r,h=oh(u),f=v3(e,n,h,i),g=rle,v=new nle(e,n,u,l,f*g,i),x=v.calculateSourceExtent(),b=M2(x)?null:o(x,f,s),T=b?Vt.IDLE:Vt.EMPTY,A=b?b.getPixelRatio():1;super(r,i,A,T),this.targetProj_=n,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=b,this.sourcePixelRatio_=A,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Vt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Vt.LOADED){const n=Gn(this.targetExtent_)/this.targetResolution_,r=cs(this.targetExtent_)/this.targetResolution_;this.canvas_=tle(n,r,this.sourcePixelRatio_,dj(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Vt.IDLE){this.state=Vt.LOADING,this.changed();const e=this.sourceImage_.getState();e==Vt.LOADED||e==Vt.ERROR?this.reproject_():(this.sourceListenerKey_=Hn(this.sourceImage_,An.CHANGE,n=>{const r=this.sourceImage_.getState();(r==Vt.LOADED||r==Vt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Jr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Hm=4,v6={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class ARe extends Md{constructor(e,n){super(e),this.image=n}}class IRe extends Pz{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const n=this.getResolutions();if(n){const r=BN(n,e,0);e=n[r]}return e}getImage(e,n,r,i){const s=this.getProjection();if(!s||!i||Uy(s,i))return s&&(i=s),this.getImageInternal(e,n,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Uy(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==n&&h1(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new kRe(s,i,e,n,r,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,n,r,i){if(this.loader){const s=_le(e,n,r,1),o=this.findNearestResolution(n);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&zm(this.wantedExtent_,s)||zm(this.image.getExtent(),s))&&(this.wantedResolution_&&dj(this.wantedResolution_)===o||dj(this.image.getResolution())===o)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new vae(s,o,r,this.loader),this.image.addEventListener(An.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const n=e.target;let r;switch(n.getState()){case Vt.LOADING:this.loading=!0,r=v6.IMAGELOADSTART;break;case Vt.LOADED:this.loading=!1,r=v6.IMAGELOADEND;break;case Vt.ERROR:this.loading=!1,r=v6.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new ARe(r,n))}}function RRe(t,e){t.getImage().src=e}function _le(t,e,n,r){const i=e/n,s=oh(t),o=Um(Gn(t)/i,Hm),a=Um(cs(t)/i,Hm),l=Um((r-1)*o/2,Hm),c=o+2*l,u=Um((r-1)*a/2,Hm),h=a+2*u;return t3(s,i,0,[c,h])}function PRe(t,e,n,r,i,s){const o=i.getCode().split(/:(?=\d+$)/).pop(),a=n/r,l=[n3(Gn(e)/a,Hm),n3(cs(e)/a,Hm)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return eU(c,s)}function CRe(t){const e=t.load?t.load:xae,n=Yr(t.projection||"EPSG:3857"),r=t.ratio??1.5,i=t.crossOrigin??null;return function(s,o,a){a=t.hidpi?a:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,t.params),s=_le(s,o,a,r);const c=PRe(t.url,s,o,a,n,l),u=new Image;return u.crossOrigin=i,e(u,c).then(h=>{const f=Gn(s)/h.width*a;return{image:h,extent:s,resolution:f,pixelRatio:a}})}}class MRe extends IRe{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:RRe,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,n,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=CRe({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),xae(s))})),super.getImageInternal(e,n,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const fj="1.3.0";function NRe(t,e,n,r,i){i.WIDTH=n[0],i.HEIGHT=n[1];const s=r.getAxisOrientation(),o=Hoe(i.VERSION,"1.3")>=0;i[o?"CRS":"SRS"]=r.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=a.join(","),eU(t,i)}function ORe(t,e,n,r,i,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/n,l=[n3(Gn(t)/a,Hm),n3(cs(t)/a,Hm)];if(n!=1)switch(o){case"geoserver":const u=90*n+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+u:s.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":s.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":s.DPI=90*n;break;default:throw new Error("Unknown `serverType` configured")}return NRe(i,t,l,r,s)}function TX(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:fj,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}const LRe='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class DRe extends hy{constructor(e){e=e||{};let n;e.attributions!==void 0?n=e.attributions:n=[LRe];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:n,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!tc&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||vle)(s,o)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const b3=1/0;class $Re{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,C2(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,r=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){ar(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=b3?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,r=this.priorities_,i=n.length,s=n[e],o=r[e],a=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),u=c<i&&r[c]<r[l]?c:l;n[e]=n[u],r[e]=r[u],e=u}n[e]=s,r[e]=o,this.siftDown_(a,e)}siftDown_(e,n){const r=this.elements_,i=this.priorities_,s=r[n],o=i[n];for(;n>e;){const a=this.getParentIndex_(n);if(i[a]>o)r[n]=r[a],i[n]=i[a],n=a;else break}r[n]=s,i[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,r=this.priorities_;let i=0;const s=n.length;let o,a,l;for(a=0;a<s;++a)o=n[a],l=e(o),l==b3?delete this.queuedElements_[this.keyFunction_(o)]:(r[i]=l,n[i++]=o);n.length=i,r.length=i,this.heapify_()}}class jRe extends $Re{constructor(e,n){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(An.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,r=n.getState();if(r===ln.LOADED||r===ln.ERROR||r===ln.EMPTY){r!==ln.ERROR&&n.removeEventListener(An.CHANGE,this.boundHandleTileChange_);const i=n.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let r=0;for(;this.tilesLoading_<e&&r<n&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===ln.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function FRe(t,e,n,r,i){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return b3;const s=t.viewState.center,o=r[0]-s[0],a=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(o*o+a*a)/i}class VRe extends yle{constructor(e){e=e||{};const n=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=n,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=$a(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,n,r,i){const s=Yr(r),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=N2(e,s,o),c=v3(o,s,e,n),u=a.getZForResolution(c,this.zDirection),h=a.getResolution(u),f=a.getTileCoordForCoordAndZ(l,u);if(a.getResolutions().length<=f[0])return;let g=a.getTileCoordExtent(f,this.tmpExtent_);const v=this.gutter_;v!==0&&(g=nd(g,h*v,g));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,TX(this.params_,"GetFeatureInfo"),i);const b=Math.floor((l[0]-g[0])/h),T=Math.floor((g[3]-l[1])/h);return x[this.v13_?"I":"X"]=b,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(f,g,1,o||s,x)}getLegendUrl(e,n){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:fj,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n===void 0||n.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,n),eU(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,n,r,i,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=og(sle(e),o.length);a=o[l]}return ORe(n,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const n=[];for(const r in this.params_)n[e++]=r+"-"+this.params_[r];return n.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||fj;this.v13_=Hoe(e,"1.3")>=0}tileUrlFunction(e,n,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;n!=1&&(!this.hidpi_||this.serverType_===void 0)&&(n=1);const s=i.getResolution(e[0]);let o=i.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=nd(o,s*a,o));const l=Object.assign({},TX(this.params_,"GetMap"));return this.getRequestUrl_(e,o,n,r,l)}}class P_ extends Md{constructor(e,n,r){super(e),this.map=n,this.frameState=r!==void 0?r:null}}class dm extends P_{constructor(e,n,r,i,s,o){super(e,n,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Wi={SINGLECLICK:"singleclick",CLICK:An.CLICK,DBLCLICK:An.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},pj={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class zRe extends vA{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=Hn(r,pj.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Hn(r,pj.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(An.TOUCHMOVE,this.boundHandleTouchMove_,mae?{passive:!1}:!1)}emulateClick_(e){let n=new dm(Wi.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new dm(Wi.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new dm(Wi.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const n=e,r=n.pointerId;if(n.type==Wi.POINTERUP||n.type==Wi.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==n.target){delete this.trackedTouches_[i];break}}else(n.type==Wi.POINTERDOWN||n.type==Wi.POINTERMOVE)&&(this.trackedTouches_[r]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new dm(Wi.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Jr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new dm(Wi.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Hn(r,Wi.POINTERMOVE,this.handlePointerMove_,this),Hn(r,Wi.POINTERUP,this.handlePointerUp_,this),Hn(this.element_,Wi.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(Hn(this.element_.getRootNode(),Wi.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new dm(Wi.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new dm(Wi.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Jr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(An.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Jr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Jr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const fm={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Ko={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class c5 extends Nd{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let n=0,r=this.listenerKeys.length;n<r;++n)Jr(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=e,e){const n=this.target_??e.getOverlayContainerStopEvent();this.element&&n.appendChild(this.element),this.render!==BT&&this.listenerKeys.push(Hn(e,fm.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class URe extends c5{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:n+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=i):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(An.CLICK,this.handleClick_.bind(this),!1);const c=n+" "+SA+" "+kz+(this.collapsed_&&this.collapsible_?" "+DY:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),r=new Set(n.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!n.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(i=>$oe(()=>i))),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!pp(n,this.renderedAttributions_)){WTe(this.ulElement_);for(let i=0,s=n.length;i<s;++i){const o=document.createElement("li");o.innerHTML=n[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(DY),this.collapsed_?OY(this.collapseLabel_,this.label_):OY(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class GRe extends c5{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(An.CLICK,this.handleClick_.bind(this),!1);const a=n+" "+SA+" "+kz,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(qR)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:O2}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const r=n.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(qR);!s&&r===0?this.element.classList.add(qR):s&&r!==0&&this.element.classList.remove(qR)}this.label_.style.transform=i}this.rotation_=r}}class BRe extends c5{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=i,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener(An.CLICK,this.handleClick_.bind(this,r),!1);const h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=c,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(An.CLICK,this.handleClick_.bind(this,-r),!1);const f=n+" "+SA+" "+kz,g=this.element;g.className=f,g.appendChild(u),g.appendChild(h),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:O2})):r.setZoom(s)}}}function WRe(t){t=t||{};const e=new Hc;return(t.zoom===void 0||t.zoom)&&e.push(new BRe(t.zoomOptions)),(t.rotate===void 0||t.rotate)&&e.push(new GRe(t.rotateOptions)),(t.attribution===void 0||t.attribution)&&e.push(new URe(t.attributionOptions)),e}class HRe{constructor(e,n,r){this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let r=n-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[n+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[n]-this.points_[r],o=this.points_[n+1]-this.points_[r+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const kX={ACTIVE:"active"};class RA extends Nd{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(kX.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(kX.ACTIVE,e)}setMap(e){this.map_=e}}function qRe(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:BAe,center:t.getConstrainedCenter(i)})}}function nU(t,e,n,r){const i=t.getZoom();if(i===void 0)return;const s=t.getConstrainedZoom(i+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:r!==void 0?r:250,easing:O2})}class KRe extends RA{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==Wi.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,o=r.shiftKey?-this.delta_:this.delta_,a=i.getView();nU(a,o,s,this.duration_),r.preventDefault(),n=!0}return!n}}function mj(t){const e=arguments;return function(n){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](n),!!r);++i);return r}}const YRe=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},XRe=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)},xle=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?XRe(t):!0},ZRe=GT,wle=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(GTe&&fae&&e.ctrlKey)},ble=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},JRe=function(t){const e=t.originalEvent;return fae?e.metaKey:e.ctrlKey},QRe=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Ele=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},_6=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},ePe=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class PA extends RA{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Wi.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Wi.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Wi.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,n=this.stopDown(r)}else e.type==Wi.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function rU(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}class tPe extends PA{constructor(e){super({stopDown:WN}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:mj(ble,ePe);this.condition_=e.onFocusOnly?mj(xle,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const r=this.targetPointers,i=n.getEventPixel(rU(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],a=e.map.getView();WSe(s,a.getResolution()),cz(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=r.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),l=n.getCoordinateFromPixelInternal([a[0]-i*Math.cos(s),a[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:O2})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class nPe extends PA{constructor(e){e=e||{},super({stopDown:WN}),this.condition_=e.condition?e.condition:YRe,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!_6(e))return;const n=e.map,r=n.getView();if(r.getConstraints().rotation===jz)return;const i=n.getSize(),s=e.pixel,o=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return _6(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return _6(e)&&wle(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class rPe extends yA{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],n[0])+r,i.top=Math.min(e[1],n[1])+r,i.width=Math.abs(n[0]-e[0])+r,i.height=Math.abs(n[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new ou([i])}getGeometry(){return this.geometry_}}const n_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class sE extends Md{constructor(e,n,r){super(e),this.coordinate=n,this.mapBrowserEvent=r}}class iPe extends PA{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new rPe(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??wle,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,r){const i=r[0]-n[0],s=r[1]-n[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new sE(n_.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new sE(n?n_.BOXEND:n_.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new sE(n_.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new sE(n_.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new sE(n_.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class sPe extends iPe{constructor(e){e=e||{};const n=e.condition?e.condition:QRe;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),o=r.getResolutionForExtentInternal(s),a=r.getResolution()/o;i=i.clone(),i.scale(a*a)}r.fitInternal(i,{duration:this.duration_,easing:O2})}}const S0={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class oPe extends RA{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return ble(n)&&Ele(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==An.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==S0.DOWN||i==S0.LEFT||i==S0.RIGHT||i==S0.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;i==S0.DOWN?c=-a:i==S0.LEFT?l=-a:i==S0.RIGHT?l=a:c=a;const u=[l,c];cz(u,o.getRotation()),qRe(o,u,this.duration_),r.preventDefault(),n=!0}}return!n}}class aPe extends RA{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!JRe(n)&&Ele(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==An.KEYDOWN||e.type==An.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,o=i==="+"?this.delta_:-this.delta_,a=s.getView();nU(a,o,void 0,this.duration_),r.preventDefault(),n=!0}}return!n}}const lPe=40,cPe=300;class uPe extends RA{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:ZRe;this.condition_=e.onFocusOnly?mj(xle,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==An.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=lPe;break;case WheelEvent.DOM_DELTA_PAGE:s*=cPe;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=r.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let r=-ii(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),nU(n,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class hPe extends PA{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=WN),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==jz&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(rU(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class dPe extends PA{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=WN),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,o=r.clientY-i.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(rU(this.targetPointers))),l.render(),c.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function fPe(t){t=t||{};const e=new Hc,n=new HRe(-.005,.05,100);return(t.altShiftDragRotate===void 0||t.altShiftDragRotate)&&e.push(new nPe),(t.doubleClickZoom===void 0||t.doubleClickZoom)&&e.push(new KRe({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan===void 0||t.dragPan)&&e.push(new tPe({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate===void 0||t.pinchRotate)&&e.push(new hPe),(t.pinchZoom===void 0||t.pinchZoom)&&e.push(new dPe({duration:t.zoomDuration})),(t.keyboard===void 0||t.keyboard)&&(e.push(new oPe),e.push(new aPe({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom===void 0||t.mouseWheelZoom)&&e.push(new uPe({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom===void 0||t.shiftDragZoom)&&e.push(new sPe({duration:t.zoomDuration})),e}class pPe extends yA{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){xn()}calculateMatrices2D(e){const n=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;iu(r,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),HT(i,r)}forEachFeatureAtCoordinate(e,n,r,i,s,o,a,l){let c;const u=n.viewState;function h(R,M,F,C){return s.call(o,M,R?F:null,C)}const f=u.projection,g=qoe(e.slice(),f),v=[[0,0]];if(f.canWrapX()&&i){const R=f.getExtent(),M=Gn(R);v.push([-M,0],[M,0])}const x=n.layerStatesArray,b=x.length,T=[],A=[];for(let R=0;R<v.length;R++)for(let M=b-1;M>=0;--M){const F=x[M],C=F.layer;if(C.hasRenderer()&&Vz(F,u)&&a.call(l,C)){const N=C.getRenderer(),O=C.getSource();if(N&&O){const j=O.getWrapX()?g:e,V=h.bind(null,F.managed);A[0]=j[0]+v[R][0],A[1]=j[1]+v[R][1],c=N.forEachFeatureAtCoordinate(A,n,r,V,T)}if(c)return c}}if(T.length===0)return;const I=1/T.length;return T.forEach((R,M)=>R.distanceSq+=M*I),T.sort((R,M)=>R.distanceSq-M.distanceSq),T.some(R=>c=R.callback(R.feature,R.layer,R.geometry)),c}hasFeatureAtCoordinate(e,n,r,i,s,o){return this.forEachFeatureAtCoordinate(e,n,r,i,GT,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){xn()}scheduleExpireIconCache(e){qc.canExpireCache()&&e.postRenderFunctions.push(mPe)}}function mPe(t,e){qc.expire()}class gPe extends pPe{constructor(e){super(e),this.fontChangeListenerKey_=Hn(A_,Ow.PROPERTYCHANGE,e.redrawText,e),this.element_=tc?gae():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=SA+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const r=this.getMap();if(r.hasListener(e)){const i=new $S(e,void 0,n);r.dispatchEvent(i)}}disposeInternal(){Jr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(no.PRECOMPOSE,e);const n=e.layerStatesArray.sort((c,u)=>c.zIndex-u.zIndex);n.some(c=>c.layer instanceof o5&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let o=null;for(let c=0,u=n.length;c<u;++c){const h=n[c];e.layerIndex=c;const f=h.layer,g=f.getSourceState();if(!Vz(h,i)||g!="ready"&&g!="undefined"){f.unrender();continue}const v=f.render(e,o);v&&(v!==o&&(this.children_.push(v),o=v),s.push(h))}this.declutter(e,s),HTe(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Bm(l)){const c=l.getContext("2d");for(const u of this.children_){const h=u.firstElementChild||u,f=u.style.backgroundColor;if(f&&(!Bm(h)||h.width>0)&&(c.fillStyle=f,c.fillRect(0,0,l.width,l.height)),Bm(h)&&h.width>0){const g=u.style.opacity||h.style.opacity;c.globalAlpha=g===""?1:Number(g);const v=h.style.transform;if(v)c.setTransform(...Q8(v));else{const x=parseFloat(h.style.width)/h.width,b=parseFloat(h.style.height)/h.height;c.setTransform(x,0,0,b,0,0)}c.drawImage(h,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(no.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let r=n.length-1;r>=0;--r){const i=n[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}n.forEach(r=>r.layer.renderDeferred(e))}}}function Sle(t){if(t instanceof IA){t.setMapInternal(null);return}t instanceof a5&&t.getLayers().forEach(Sle)}function Tle(t,e){if(t instanceof IA){t.setMapInternal(e);return}if(t instanceof a5){const n=t.getLayers().getArray();for(let r=0,i=n.length;r<i;++r)Tle(n[r],e)}}let yPe=class extends Nd{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=vPe(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:BTe,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=js(),this.pixelToCoordinateTransform_=js(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,tc||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,tc||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(tc?new Hc:WRe()),this.interactions=n.interactions||(tc?new Hc:fPe({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new jRe(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Ko.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Ko.VIEW,this.handleViewChanged_),this.addChangeListener(Ko.SIZE,this.handleSizeChanged_),this.addChangeListener(Ko.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const r=this;e.view&&!(e.view instanceof Qh)&&e.view.then(function(i){r.setView(new Qh(i))}),this.controls.addEventListener(cl.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(cl.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(cl.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(cl.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(cl.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(cl.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){Tle(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,o=r.layerFilter!==void 0?r.layerFilter:GT,a=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,a,n,null,o,null)}getFeaturesAtPixel(e,n){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},n),r}getAllLayers(){const e=[];function n(r){r.forEach(function(i){i instanceof a5?n(i.getLayers()):e.push(i)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const i=n.layerFilter!==void 0?n.layerFilter:GT,s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,o,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],o=r.height/i[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-r.left)/s,(a.clientY-r.top)/o]}getTarget(){return this.get(Ko.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return J8(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?Yi(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Ko.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Hc){n.setLayers(e);return}const r=n.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,r=e.length;n<r;++n){const i=e[n];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const o=i.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=lf(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?Yi(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Ko.SIZE)}getView(){return this.get(Ko.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,r,i){return FRe(this.frameState_,e,n,r,i)}handleBrowserEvent(e,n){n=n||e.type;const r=new dm(n,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,r=n.type;if(r===pj.POINTERDOWN||r===An.WHEEL||r===An.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,o=n.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const o=e.viewHints;if(o[ws.ANIMATING]||o[ws.INTERACTING]){const a=Date.now()-e.time>8;i=a?0:8,s=a?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(no.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(no.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new P_(fm.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new P_(fm.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)Jr(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(An.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(An.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Bm(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Bm(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new gPe(this)),!Bm(n)){this.mapBrowserEventHandler_=new zRe(this,this.moveTolerance_);for(const i in Wi)this.mapBrowserEventHandler_.addEventListener(Wi[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(An.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(An.WHEEL,this.boundHandleBrowserEvent_,mae?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=n.getRootNode();r=i instanceof ShadowRoot?i.host:n}if(this.targetChangeHandlerKeys_=[Hn(r,An.KEYDOWN,this.handleBrowserEvent,this),Hn(r,An.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const i=n.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Jr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Jr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Hn(e,Ow.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Hn(e,An.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Jr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new km("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Hn(e,Ow.PROPERTYCHANGE,this.render,this),Hn(e,An.CHANGE,this.render,this),Hn(e,"addlayer",this.handleLayerAdd_,this),Hn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,r=e.length;n<r;++n){const i=e[n].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){Sle(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(n!==void 0&&KY(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:t3(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:_n(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=t3(a.nextCenter,a.nextResolution,l,n)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!M2(this.previousExtent_)&&!h1(s.extent,this.previousExtent_))&&(this.dispatchEvent(new P_(fm.MOVESTART,this,i)),this.previousExtent_=xA(this.previousExtent_)),this.previousExtent_&&!s.viewHints[ws.ANIMATING]&&!s.viewHints[ws.INTERACTING]&&!h1(s.extent,this.previousExtent_)&&(this.dispatchEvent(new P_(fm.MOVEEND,this,s)),Foe(s.extent,this.previousExtent_))),this.dispatchEvent(new P_(fm.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(fm.LOADSTART)||this.hasListener(fm.LOADEND)||this.hasListener(no.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new km("removelayer",n)),this.set(Ko.LAYERGROUP,e)}setSize(e){this.set(Ko.SIZE,e)}setTarget(e){this.set(Ko.TARGET,e)}setView(e){if(!e||e instanceof Qh){this.set(Ko.VIEW,e);return}this.set(Ko.VIEW,new Qh);const n=this;e.then(function(r){n.setView(new Qh(r))})}updateSize(){const e=this.getTargetElement();let n;if(e){let i,s;if(Bm(e))i=e.width,s=e.height;else{const o=getComputedStyle(e);i=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(n=[Math.max(0,i),Math.max(0,s)],!KY(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Yoe("No map visible because the map container's width or height are 0."))}const r=this.getSize();n&&(!r||!pp(n,r))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function vPe(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new a5({layers:t.layers});n[Ko.LAYERGROUP]=r,n[Ko.TARGET]=t.target,n[Ko.VIEW]=t.view instanceof Qh?t.view:new Qh;let i;t.controls!==void 0&&(Array.isArray(t.controls)?i=new Hc(t.controls.slice()):(ar(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls));let s;t.interactions!==void 0&&(Array.isArray(t.interactions)?s=new Hc(t.interactions.slice()):(ar(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new Hc(t.overlays.slice()):(ar(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new Hc,{controls:i,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}const x6="units",_Pe=[1,2,5],oE=25.4/.28;class xPe extends c5{constructor(e){e=e||{};const n=document.createElement("div");n.style.pointerEvents="none",super({element:n,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+SA,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(x6,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(x6)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(x6,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let o=a3(r,e.resolution,n,s);const a=this.minWidth_*(this.dpi_||oE)/oE,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||oE)/oE:void 0;let c=a*o,u="";if(i=="degrees"){const I=Lw.degrees;c*=I,c<I/60?(u="",o*=3600):c<I?(u="",o*=60):u=""}else if(i=="imperial")c<.9144?(u="in",o/=.0254):c<1609.344?(u="ft",o/=.3048):(u="mi",o/=1609.344);else if(i=="nautical")o/=1852,u="NM";else if(i=="metric")c<1e-6?(u="nm",o*=1e9):c<.001?(u="m",o*=1e6):c<1?(u="mm",o*=1e3):c<1e3?u="m":(u="km",o/=1e3);else if(i=="us")c<.9144?(u="in",o*=39.37):c<1609.344?(u="ft",o/=.30480061):(u="mi",o/=1609.3472);else throw new Error("Invalid units");let h=3*Math.floor(Math.log(a*o)/Math.log(10)),f,g,v,x=0,b,T;for(;;){v=Math.floor(h/3);const I=Math.pow(10,v);if(f=_Pe[(h%3+3)%3]*I,g=Math.round(f/o),isNaN(g)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&g>=l){f=x,g=b,v=T;break}else if(g>=a)break;x=f,b=g,T=v,++h}const A=this.scaleBar_?this.createScaleBar(g,f,u):f.toFixed(v<0?-v:0)+" "+u;this.renderedHTML_!=A&&(this.innerElement_.innerHTML=A,this.renderedHTML_=A),this.renderedWidth_!=g&&(this.innerElement_.style.width=g+"px",this.renderedWidth_=g),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,n,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let u=0;u<o;++u){const h=u%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${h}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(u%2===0||o===2?this.createStepText(u,e,!1,n,r):"")+"</div>")}return l.push(this.createStepText(o,e,!0,n,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,n,r,i,s){const a=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:n/this.scaleBarSteps_*-1,c=e===0?0:n/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?n+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=a3(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),n=this.dpi_||oE,r=1e3/25.4;return e*r*n}render(e){const n=e.frameState;n?this.viewState_=n.viewState:this.viewState_=null,this.updateElement_()}}const wPe={},AX=t=>{let e;const n=new Set,r=(u,h)=>{const f=typeof u=="function"?u(e):u;if(!Object.is(f,e)){const g=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(v=>v(e,g))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(wPe?"commercial":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},bPe=t=>t?AX(t):AX;var w6={exports:{}},b6={},E6={exports:{}},S6={};var IX;function EPe(){if(IX)return S6;IX=1;var t=gA();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function a(h,f){var g=f(),v=r({inst:{value:g,getSnapshot:f}}),x=v[0].inst,b=v[1];return s(function(){x.value=g,x.getSnapshot=f,l(x)&&b({inst:x})},[h,g,f]),i(function(){return l(x)&&b({inst:x}),h(function(){l(x)&&b({inst:x})})},[h]),o(g),g}function l(h){var f=h.getSnapshot;h=h.value;try{var g=f();return!n(h,g)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return S6.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,S6}var RX;function SPe(){return RX||(RX=1,E6.exports=EPe()),E6.exports}var PX;function TPe(){if(PX)return b6;PX=1;var t=gA(),e=SPe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return b6.useSyncExternalStoreWithSelector=function(c,u,h,f,g){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=a(function(){function T(F){if(!A){if(A=!0,I=F,F=f(F),g!==void 0&&x.hasValue){var C=x.value;if(g(C,F))return R=C}return R=F}if(C=R,r(I,F))return C;var N=f(F);return g!==void 0&&g(C,N)?(I=F,C):(I=F,R=N)}var A=!1,I,R,M=h===void 0?null:h;return[function(){return T(u())},M===null?void 0:function(){return T(M())}]},[u,h,f,g]);var b=i(c,v[0],v[1]);return o(function(){x.hasValue=!0,x.value=b},[b]),l(b),b},b6}var CX;function kPe(){return CX||(CX=1,w6.exports=TPe()),w6.exports}var APe=kPe();const IPe=sz(APe),kle={},{useDebugValue:RPe}=PSe,{useSyncExternalStoreWithSelector:PPe}=IPe;let MX=!1;const CPe=t=>t;function MPe(t,e=CPe,n){(kle?"commercial":void 0)!=="production"&&n&&!MX&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),MX=!0);const r=PPe(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return RPe(r),r}const NX=t=>{(kle?"commercial":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?bPe(t):t,n=(r,i)=>MPe(e,r,i);return Object.assign(n,e),n},ho=t=>t?NX(t):NX;var Ale=Symbol.for("immer-nothing"),OX=Symbol.for("immer-draftable"),lc=Symbol.for("immer-state");function Bu(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var nk=Object.getPrototypeOf;function Fw(t){return!!t&&!!t[lc]}function m1(t){return t?Ile(t)||Array.isArray(t)||!!t[OX]||!!t.constructor?.[OX]||CA(t)||h5(t):!1}var NPe=Object.prototype.constructor.toString(),LX=new WeakMap;function Ile(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let r=LX.get(n);return r===void 0&&(r=Function.toString.call(n),LX.set(n,r)),r===NPe}function E3(t,e,n=!0){u5(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((r,i)=>e(i,r,t))}function u5(t){const e=t[lc];return e?e.type_:Array.isArray(t)?1:CA(t)?2:h5(t)?3:0}function gj(t,e){return u5(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Rle(t,e,n){const r=u5(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function OPe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function CA(t){return t instanceof Map}function h5(t){return t instanceof Set}function j0(t){return t.copy_||t.base_}function yj(t,e){if(CA(t))return new Map(t);if(h5(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=Ile(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[lc];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const o=i[s],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(nk(t),r)}else{const r=nk(t);if(r!==null&&n)return{...t};const i=Object.create(r);return Object.assign(i,t)}}function iU(t,e=!1){return d5(t)||Fw(t)||!m1(t)||(u5(t)>1&&Object.defineProperties(t,{set:nP,add:nP,clear:nP,delete:nP}),Object.freeze(t),e&&Object.values(t).forEach(n=>iU(n,!0))),t}function LPe(){Bu(2)}var nP={value:LPe};function d5(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var DPe={};function g1(t){const e=DPe[t];return e||Bu(0,t),e}var rk;function Ple(){return rk}function $Pe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function DX(t,e){e&&(g1("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function vj(t){_j(t),t.drafts_.forEach(jPe),t.drafts_=null}function _j(t){t===rk&&(rk=t.parent_)}function $X(t){return rk=$Pe(rk,t)}function jPe(t){const e=t[lc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function jX(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[lc].modified_&&(vj(e),Bu(4)),m1(t)&&(t=S3(e,t),e.parent_||T3(e,t)),e.patches_&&g1("Patches").generateReplacementPatches_(n[lc].base_,t,e.patches_,e.inversePatches_)):t=S3(e,n,[]),vj(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Ale?t:void 0}function S3(t,e,n){if(d5(e))return e;const r=t.immer_.shouldUseStrictIteration(),i=e[lc];if(!i)return E3(e,(s,o)=>FX(t,i,e,s,o,n),r),e;if(i.scope_!==t)return e;if(!i.modified_)return T3(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,a=!1;i.type_===3&&(o=new Set(s),s.clear(),a=!0),E3(o,(l,c)=>FX(t,i,s,l,c,n,a),r),T3(t,s,!1),n&&t.patches_&&g1("Patches").generatePatches_(i,n,t.patches_,t.inversePatches_)}return i.copy_}function FX(t,e,n,r,i,s,o){if(i==null||typeof i!="object"&&!o)return;const a=d5(i);if(!(a&&!o)){if(Fw(i)){const l=s&&e&&e.type_!==3&&!gj(e.assigned_,r)?s.concat(r):void 0,c=S3(t,i,l);if(Rle(n,r,c),Fw(c))t.canAutoFreeze_=!1;else return}else o&&n.add(i);if(m1(i)&&!a){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&a)return;S3(t,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(CA(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&T3(t,i)}}}function T3(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&iU(e,n)}function FPe(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:Ple(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=sU;n&&(i=[r],s=ik);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return r.draft_=a,r.revoke_=o,a}var sU={get(t,e){if(e===lc)return t;const n=j0(t);if(!gj(n,e))return VPe(t,n,e);const r=n[e];return t.finalized_||!m1(r)?r:r===T6(t.base_,e)?(k6(t),t.copy_[e]=wj(r,t)):r},has(t,e){return e in j0(t)},ownKeys(t){return Reflect.ownKeys(j0(t))},set(t,e,n){const r=Cle(j0(t),e);if(r?.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const i=T6(j0(t),e),s=i?.[lc];if(s&&s.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(OPe(n,i)&&(n!==void 0||gj(t.base_,e)))return!0;k6(t),xj(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return T6(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,k6(t),xj(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=j0(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Bu(11)},getPrototypeOf(t){return nk(t.base_)},setPrototypeOf(){Bu(12)}},ik={};E3(sU,(t,e)=>{ik[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ik.deleteProperty=function(t,e){return ik.set.call(this,t,e,void 0)};ik.set=function(t,e,n){return sU.set.call(this,t[0],e,n,t[0])};function T6(t,e){const n=t[lc];return(n?j0(n):t)[e]}function VPe(t,e,n){const r=Cle(e,n);return r?"value"in r?r.value:r.get?.call(t.draft_):void 0}function Cle(t,e){if(!(e in t))return;let n=nk(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=nk(n)}}function xj(t){t.modified_||(t.modified_=!0,t.parent_&&xj(t.parent_))}function k6(t){t.copy_||(t.copy_=yj(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var zPe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const s=n;n=e;const o=this;return function(l=s,...c){return o.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&Bu(6),r!==void 0&&typeof r!="function"&&Bu(7);let i;if(m1(e)){const s=$X(this),o=wj(e,void 0);let a=!0;try{i=n(o),a=!1}finally{a?vj(s):_j(s)}return DX(s,r),jX(i,s)}else if(!e||typeof e!="object"){if(i=n(e),i===void 0&&(i=e),i===Ale&&(i=void 0),this.autoFreeze_&&iU(i,!0),r){const s=[],o=[];g1("Patches").generateReplacementPatches_(e,i,s,o),r(s,o)}return i}else Bu(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,i;return[this.produce(e,n,(o,a)=>{r=o,i=a}),r,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){m1(t)||Bu(8),Fw(t)&&(t=UPe(t));const e=$X(this),n=wj(t,void 0);return n[lc].isManual_=!0,_j(e),n}finishDraft(t,e){const n=t&&t[lc];(!n||!n.isManual_)&&Bu(9);const{scope_:r}=n;return DX(r,e),jX(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const i=e[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(e=e.slice(n+1));const r=g1("Patches").applyPatches_;return Fw(t)?r(t,e):this.produce(t,i=>r(i,e))}};function wj(t,e){const n=CA(t)?g1("MapSet").proxyMap_(t,e):h5(t)?g1("MapSet").proxySet_(t,e):FPe(t,e);return(e?e.scope_:Ple()).drafts_.push(n),n}function UPe(t){return Fw(t)||Bu(10,t),Mle(t)}function Mle(t){if(!m1(t)||d5(t))return t;const e=t[lc];let n,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=yj(t,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else n=yj(t,!0);return E3(n,(i,s)=>{Rle(n,i,Mle(s))},r),e&&(e.finalized_=!1),n}var GPe=new zPe,BPe=GPe.produce;const WPe=t=>(e,n,r)=>(r.setState=(i,s,...o)=>{const a=typeof i=="function"?BPe(i):i;return e(a,s,...o)},t(r.setState,n,r)),L2=WPe,bs=ho()(L2((t,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,rawGPSHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,navigationMode:"free",config:{centerOnUser:!0},fetchPassivePosition:()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{t(r=>{r.tracking||(r.position={lat:n.coords.latitude,lng:n.coords.longitude},r.accuracy=n.coords.accuracy)})},()=>{},{enableHighAccuracy:!1,maximumAge:6e4,timeout:1e4})},startTracking:()=>{t(n=>{n.tracking=!0})},stopTracking:()=>{t(n=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),n.tracking=!1,n.speed=null,n.headingSource=null,n.heading=null,n.smoothHeading=null,n.rawGPSHeading=null,n.watchId=null,n.navigationMode="free"})},updatePosition:n=>{t(r=>{r.position={lat:n.coords.latitude,lng:n.coords.longitude},r.accuracy=n.coords.accuracy,r.speed=n.coords.speed,r.rawGPSHeading=n.coords.heading,n.coords.accuracy!==null&&n.coords.accuracy<20?n.coords.heading!==null&&n.coords.speed!==null&&n.coords.speed>.5?r.headingSource="gps":r.headingSource="compass":r.headingSource=null})},setSmoothedHeading:n=>{t(r=>{r.smoothHeading=n,r.heading=n})},setWatchId:n=>{t(r=>{r.watchId=n})},resetFirstFix:()=>{t(n=>{n.firstFix=!1})},setNavigationMode:n=>{t(r=>{r.navigationMode=n})},toggleNavigationMode:()=>{t(n=>{n.navigationMode=n.navigationMode==="free"?"headingUp":"free"})}}))),Sy={Kansenkaart:{name:"Kansenkaart",factory:async()=>{const{createKansenkaartLayerOL:t}=await _e(async()=>{const{createKansenkaartLayerOL:e}=await import("./kansenkaartOL-CmD-W98h.js");return{createKansenkaartLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:t}=await _e(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createAHNLayerOL:e}},[]);return t()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:t}=await _e(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createGeomorfologieLayerOL:e}},[]);return t()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:t}=await _e(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createBodemkaartLayerOL:e}},[]);return t()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:t}=await _e(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createIKAWLayerOL:e}},[]);return t()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:t}=await _e(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createFAMKESteentijdLayerOL:e}},[]);return t()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:t}=await _e(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return t()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:t}=await _e(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createEssenLayerOL:e}},[]);return t()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:t}=await _e(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createRijksmonumentenLayerOL:e}},[]);return t()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:t}=await _e(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return t()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:t}=await _e(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createWerelderfgoedLayerOL:e}},[]);return t()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:t}=await _e(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-DbB-KReB.js");return{createTerpenLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:t}=await _e(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-5hFSDrGj.js");return{createLiniesLayerOL:e}},[]);return t()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:t}=await _e(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-5hFSDrGj.js");return{createInundatiesLayerOL:e}},[]);return t()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:t}=await _e(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-5hFSDrGj.js");return{createMilitaireObjectenLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:t}=await _e(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo800ncLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:t}=await _e(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo100ncLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:t}=await _e(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:t}=await _e(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo1500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:t}=await _e(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo2750vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:t}=await _e(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo5500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:t}=await _e(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CS3toZvz.js");return{createPaleo9000vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:t}=await _e(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-CBEnX5bg.js");return{createReligieusErfgoedLayerOL:e}},[]);return t()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createArcGISAHN4ColorElevation:t}=await _e(async()=>{const{createArcGISAHN4ColorElevation:e}=await import("./arcgisAHNLayers-DDGel08T.js");return{createArcGISAHN4ColorElevation:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createArcGISAHN4Hillshade:t}=await _e(async()=>{const{createArcGISAHN4Hillshade:e}=await import("./arcgisAHNLayers-DDGel08T.js");return{createArcGISAHN4Hillshade:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createArcGISAHN4MultiHillshade:t}=await _e(async()=>{const{createArcGISAHN4MultiHillshade:e}=await import("./arcgisAHNLayers-DDGel08T.js");return{createArcGISAHN4MultiHillshade:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},"AHN4 Hillshade Kleur":{name:"AHN4 Hillshade Kleur",factory:async()=>{const{createArcGISAHN4ShadedRelief:t}=await _e(async()=>{const{createArcGISAHN4ShadedRelief:e}=await import("./arcgisAHNLayers-DDGel08T.js");return{createArcGISAHN4ShadedRelief:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:t}=await _e(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createGewaspercelenLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:t}=await _e(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createKadastraleKaartLayerOL:e}},[]);return t()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:t}=await _e(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createScheepswrakkenLayerOL:e}},[]);return t()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:t}=await _e(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createWoonheuvelsLayerOL:e}},[]);return t()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:t}=await _e(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-BPM_V6hf.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([68,69]));return t()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:t}=await _e(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-BPM_V6hf.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([68,69]));return t()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:t}=await _e(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createWindmolensLayerOL:e}},[]);return t()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:t}=await _e(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createErfgoedlijnenLayerOL:e}},[]);return t()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:t}=await _e(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createOudeKernenLayerOL:e}},[]);return t()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:t}=await _e(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-Bwx8WpMN.js");return{createRelictenPuntenLayerOL:e}},[]);return t()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:t}=await _e(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return t()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:t}=await _e(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return t()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:t}=await _e(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-BEaJFxkZ.js");return{createVerdronkenDorpenLayerOL:e}},[]);return t()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:t}=await _e(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-DkkbyiXN.js");return{createAMKLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:t}=await _e(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-DkkbyiXN.js");return{createAMKRomeinsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:t}=await _e(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-DkkbyiXN.js");return{createAMKSteentijdLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:t}=await _e(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-DkkbyiXN.js");return{createAMKVroegeMELayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:t}=await _e(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-DkkbyiXN.js");return{createAMKLateMELayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:t}=await _e(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-DkkbyiXN.js");return{createAMKOverigLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:t}=await _e(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-BqNUmUCQ.js");return{createRomeinseWegenLayerOL:e}},[]);return t()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:t}=await _e(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-BqNUmUCQ.js");return{createRomeinseWegenWereldLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:t}=await _e(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-T_cV9n-9.js");return{createKastelenLayerOL:e}},__vite__mapDeps([70,69]));return t()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:t}=await _e(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-CgRO9XwV.js");return{createRuinesLayerOL:e}},__vite__mapDeps([71,69]));return t()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:t}=await _e(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-DkFvJZ8g.js");return{createVeengebiedenLayerOL:e}},[]);return t()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:t}=await _e(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-CaDEdIQp.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([72,69]));return t()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:t}=await _e(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-Dmv-_p9b.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([73,69]));return t()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:t}=await _e(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BbK-Qr4B.js");return{createUIKAVVlakkenLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:t}=await _e(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-B1QhsN-v.js");return{createUIKAVBufferlaagLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:t}=await _e(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-gQWZmErH.js");return{createUIKAVExpertLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:t}=await _e(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-C-8-GKWd.js");return{createUIKAVUiterwaardenLayerOL:e}},[]);return t()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:t}=await _e(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-BfYP8qri.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([74,69]));return t()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:t}=await _e(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-BYGEMrEH.js");return{createMuseaLayerOL:e}},__vite__mapDeps([75,69]));return t()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:t}=await _e(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-BWtcADUP.js");return{createStrandjesLayerOL:e}},[]);return t()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:t}=await _e(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-CdsXkUcK.js");return{createParkenLayerOL:e}},[]);return t()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:t}=await _e(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-CnvHG7YM.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([76,69]));return t()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:t}=await _e(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-CA5RnqnH.js");return{createRuiterpadenLayerOL:e}},[]);return t()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:t}=await _e(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-lYDZyPP7.js");return{createLaarzenpadenLayerOL:e}},[]);return t()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:t}=await _e(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-eA5pWB96.js");return{createFossielenLayerOL:e}},__vite__mapDeps([77,78,69]));return t()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:t}=await _e(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-CL-P3aKO.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([79,78,69]));return t()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:t}=await _e(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-BdFZytOI.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([80,78,69]));return t()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:t}=await _e(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-73n8THoF.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([81,78,69]));return t()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:t}=await _e(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-Cn7-M62n.js");return{createFossielHotspotsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:t}=await _e(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-CTZVSrtG.js");return{createMineralenHotspotsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:t}=await _e(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-DFDBX89e.js");return{createGoudrivierenLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:t}=await _e(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-Bz0QfhQV.js");return{createBunkersLayerOL:e}},__vite__mapDeps([82,69]));return t()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:t}=await _e(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-BZAaErh_.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([83,69]));return t()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:t}=await _e(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-DE-scJy2.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([84,69]));return t()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:t}=await _e(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-9or85LHS.js");return{createVliegveldenLayerOL:e}},[]);return t()},immediateLoad:!1}};function HPe(){return Object.values(Sy).filter(t=>t.immediateLoad&&t.platform!=="arcgis")}const $i=ho()(L2((t,e)=>({map:null,arcgisMap:null,arcgisView:null,arcgisInitialized:!1,rotation:0,rotationEnabled:!0,setMap:n=>{t(r=>{r.map=n})},setArcGISMap:(n,r)=>{t(i=>{i.arcgisMap=n,i.arcgisView=r,i.arcgisInitialized=!0})},setRotation:n=>{t(r=>{if(r.rotation=n,r.map&&r.rotationEnabled){const i=n*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{t(n=>{n.rotationEnabled=!0})},disableRotation:()=>{t(n=>{n.rotationEnabled=!1,n.rotation=0,n.map&&n.map.getView().animate({rotation:0,duration:500})})}}))),io=ho()(L2((t,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Hillshade Kleur":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,"Romeinse Forten Lijnen":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Hillshade Kleur":.8,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},arcgisLayers:{},toggleLayer:n=>{const r=e(),i=!r.visible[n];t(a=>{a.visible[n]=i}),Sy[n]?.platform==="arcgis"?i&&!r.arcgisLayers[n]?e().loadLayer(n):r.arcgisLayers[n]&&(r.arcgisLayers[n].visible=i):i&&!r.layers[n]?e().loadLayer(n):r.layers[n]&&r.layers[n].setVisible(i)},setLayerVisibility:(n,r)=>{const i=e(),o=Sy[n]?.platform==="arcgis";t(l=>{if(l.visible[n]=r,o){const c=l.arcgisLayers[n];c&&(c.visible=r)}else{const c=l.layers[n];c&&c.setVisible(r)}});const a=o?i.arcgisLayers[n]:i.layers[n];r&&!a&&e().loadLayer(n)},setLayerOpacity:(n,r)=>{const s=Sy[n]?.platform==="arcgis";t(o=>{if(o.opacity[n]=r,s){const a=o.arcgisLayers[n];a&&(a.opacity=r)}else{const a=o.layers[n];a&&a.setOpacity(r)}})},registerLayer:(n,r)=>{t(i=>{i.layers[n]=r,i.loadingState[n]="loaded",i.visible[n]!==void 0&&r.setVisible(i.visible[n]),i.opacity[n]!==void 0&&r.setOpacity(i.opacity[n])})},registerArcGISLayer:(n,r)=>{t(i=>{i.arcgisLayers[n]=r,i.loadingState[n]="loaded",i.visible[n]!==void 0&&(r.visible=i.visible[n]),i.opacity[n]!==void 0&&(r.opacity=i.opacity[n])})},unregisterLayer:n=>{t(r=>{delete r.layers[n],delete r.arcgisLayers[n],delete r.loadingState[n]})},loadLayer:async n=>{const r=e(),i=Sy[n];if(!i){console.warn(` Layer "${n}" not found in registry`);return}const s=i.platform==="arcgis";if(r.loadingState[n]==="loading"||s&&r.arcgisLayers[n]||!s&&r.layers[n])return;const o=$i.getState();if(s){if(!o.arcgisMap||!o.arcgisInitialized){console.warn(` Cannot load ArcGIS layer "${n}": ArcGIS map not initialized`);return}}else if(!o.map){console.warn(` Cannot load layer "${n}": map not initialized`);return}t(a=>{a.loadingState[n]="loading"}),console.log(` Loading ${s?"ArcGIS":"OL"} layer: ${n}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const l=e();if(s){const c=a;c.visible=l.visible[n]??!1,l.opacity[n]!==void 0&&(c.opacity=l.opacity[n]),o.arcgisMap.add(c),t(u=>{u.arcgisLayers[n]=c,u.loadingState[n]="loaded"})}else{const c=a;c.setVisible(l.visible[n]??!1),l.opacity[n]!==void 0&&c.setOpacity(l.opacity[n]),o.map.addLayer(c),t(u=>{u.layers[n]=c,u.loadingState[n]="loaded"})}console.log(` Layer loaded: ${n}`)}catch(a){console.error(` Failed to load layer "${n}":`,a),t(l=>{l.loadingState[n]="error"})}}}))),ri=ho()(L2((t,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,monumentSearchOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{t(n=>{n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1})},toggleLayerControl:()=>{t(n=>{n.layerControlOpen=!n.layerControlOpen})},toggleLegend:()=>{t(n=>{n.legendOpen=!n.legendOpen})},toggleBackgroundsPanel:()=>{t(n=>{const r=n.backgroundsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{t(n=>{const r=n.themesPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{t(n=>{const r=n.settingsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{t(n=>{const r=n.infoPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.infoPanelOpen=!0)})},togglePresetsPanel:()=>{t(n=>{const r=n.presetsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.presetsPanelOpen=!0)})},toggleCategory:n=>{t(r=>{r.collapsedCategories.has(n)?r.collapsedCategories.delete(n):r.collapsedCategories.add(n)})},setLayerControlOpen:n=>{t(r=>{r.layerControlOpen=n})},setLegendOpen:n=>{t(r=>{r.legendOpen=n})},openVondstForm:(n,r)=>{t(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=n||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{t(n=>{n.vondstFormOpen=!1,n.vondstFormLocation=null,n.vondstFormPhoto=null})},toggleVondstDashboard:()=>{t(n=>{const r=n.vondstDashboardOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{t(n=>{n.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{t(n=>{n.createLayerModalOpen=!1})},openAddPointModal:(n,r)=>{t(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=n,i.addPointModalLocation=r})},closeAddPointModal:()=>{t(n=>{n.addPointModalOpen=!1,n.addPointModalLayerId=null,n.addPointModalLocation=null})},openLayerManagerModal:()=>{t(n=>{n.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{t(n=>{n.layerManagerModalOpen=!1})},openLayerDashboard:n=>{t(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=n,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{t(n=>{n.layerDashboardOpen=!1,n.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{t(n=>{n.routeDashboardOpen=!n.routeDashboardOpen})},toggleMonumentSearch:()=>{t(n=>{const r=n.monumentSearchOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentSearchOpen=!r})},closeMonumentSearch:()=>{t(n=>{n.monumentSearchOpen=!1})}}))),qPe=()=>{};var VX={};const Nle=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},KPe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Ole={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(f=64)),r.push(n[u],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Nle(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KPe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new YPe;const f=s<<2|a>>4;if(r.push(f),c!==64){const g=a<<4&240|c>>2;if(r.push(g),h!==64){const v=c<<6&192|h;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class YPe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XPe=function(t){const e=Nle(t);return Ole.encodeByteArray(e,!0)},k3=function(t){return XPe(t).replace(/\./g,"")},Lle=function(t){try{return Ole.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Dle(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const ZPe=()=>Dle().__FIREBASE_DEFAULTS__,JPe=()=>{if(typeof process>"u"||typeof VX>"u")return;const t=VX.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},QPe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Lle(t[1]);return e&&JSON.parse(e)},f5=()=>{try{return qPe()||ZPe()||JPe()||QPe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$le=t=>f5()?.emulatorHosts?.[t],jle=t=>{const e=$le(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Fle=()=>f5()?.config,Vle=t=>f5()?.[`_${t}`];let eCe=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function J1(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function oU(t){return(await fetch(t,{credentials:"include"})).ok}function zle(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[k3(JSON.stringify(n)),k3(JSON.stringify(o)),""].join(".")}const jS={};function tCe(){const t={prod:[],emulator:[]};for(const e of Object.keys(jS))jS[e]?t.emulator.push(e):t.prod.push(e);return t}function nCe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let zX=!1;function aU(t,e){if(typeof window>"u"||typeof document>"u"||!J1(window.location.host)||jS[t]===e||jS[t]||zX)return;jS[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",s=tCe().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{zX=!0,o()},f}function u(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=nCe(r),g=n("text"),v=document.getElementById(g)||document.createElement("span"),x=n("learnmore"),b=document.getElementById(x)||document.createElement("a"),T=n("preprendIcon"),A=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const I=f.element;a(I),u(b,x);const R=c();l(A,T),I.append(A,v,b,R),document.body.appendChild(I)}s?(v.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Us(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function rCe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Us())}function Ule(){const t=f5()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iCe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sCe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function oCe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function aCe(){const t=Us();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Gle(){return!Ule()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ble(){return!Ule()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Wle(){try{return typeof indexedDB=="object"}catch{return!1}}function lCe(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const cCe="FirebaseError";class Ld extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=cCe,Object.setPrototypeOf(this,Ld.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,MA.prototype.create)}}class MA{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?uCe(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ld(i,a,r)}}function uCe(t,e){return t.replace(hCe,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const hCe=/\{\$([^}]+)}/g;function dCe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function y1(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(UX(s)&&UX(o)){if(!y1(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function UX(t){return t!==null&&typeof t=="object"}function NA(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function fCe(t,e){const n=new pCe(t,e);return n.subscribe.bind(n)}class pCe{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");mCe(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=A6),i.error===void 0&&(i.error=A6),i.complete===void 0&&(i.complete=A6);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mCe(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function A6(){}function co(t){return t&&t._delegate?t._delegate:t}class Sg{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const F0="[DEFAULT]";class gCe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new eCe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vCe(e))try{this.getOrInitializeService({instanceIdentifier:F0})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=F0){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=F0){return this.instances.has(e)}getOptions(e=F0){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yCe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=F0){return this.component?this.component.multipleInstances?e:F0:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yCe(t){return t===F0?void 0:t}function vCe(t){return t.instantiationMode==="EAGER"}class _Ce{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gCe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Jn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Jn||(Jn={}));const xCe={debug:Jn.DEBUG,verbose:Jn.VERBOSE,info:Jn.INFO,warn:Jn.WARN,error:Jn.ERROR,silent:Jn.SILENT},wCe=Jn.INFO,bCe={[Jn.DEBUG]:"log",[Jn.VERBOSE]:"log",[Jn.INFO]:"info",[Jn.WARN]:"warn",[Jn.ERROR]:"error"},ECe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=bCe[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lU{constructor(e){this.name=e,this._logLevel=wCe,this._logHandler=ECe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Jn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xCe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Jn.DEBUG,...e),this._logHandler(this,Jn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Jn.VERBOSE,...e),this._logHandler(this,Jn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Jn.INFO,...e),this._logHandler(this,Jn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Jn.WARN,...e),this._logHandler(this,Jn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Jn.ERROR,...e),this._logHandler(this,Jn.ERROR,...e)}}const SCe=(t,e)=>e.some(n=>t instanceof n);let GX,BX;function TCe(){return GX||(GX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kCe(){return BX||(BX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hle=new WeakMap,bj=new WeakMap,qle=new WeakMap,I6=new WeakMap,cU=new WeakMap;function ACe(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(lg(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Hle.set(n,t)}).catch(()=>{}),cU.set(e,t),e}function ICe(t){if(bj.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});bj.set(t,e)}let Ej={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return bj.get(t);if(e==="objectStoreNames")return t.objectStoreNames||qle.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return lg(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function RCe(t){Ej=t(Ej)}function PCe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(R6(this),e,...n);return qle.set(r,e.sort?e.sort():[e]),lg(r)}:kCe().includes(t)?function(...e){return t.apply(R6(this),e),lg(Hle.get(this))}:function(...e){return lg(t.apply(R6(this),e))}}function CCe(t){return typeof t=="function"?PCe(t):(t instanceof IDBTransaction&&ICe(t),SCe(t,TCe())?new Proxy(t,Ej):t)}function lg(t){if(t instanceof IDBRequest)return ACe(t);if(I6.has(t))return I6.get(t);const e=CCe(t);return e!==t&&(I6.set(t,e),cU.set(e,t)),e}const R6=t=>cU.get(t);function MCe(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=lg(o);return r&&o.addEventListener("upgradeneeded",l=>{r(lg(o.result),l.oldVersion,l.newVersion,lg(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const NCe=["get","getKey","getAll","getAllKeys","count"],OCe=["put","add","delete","clear"],P6=new Map;function WX(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P6.get(e))return P6.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=OCe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||NCe.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return P6.set(e,s),s}RCe(t=>({...t,get:(e,n,r)=>WX(e,n)||t.get(e,n,r),has:(e,n)=>!!WX(e,n)||t.has(e,n)}));class LCe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(DCe(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function DCe(t){return t.getComponent()?.type==="VERSION"}const Sj="@firebase/app",HX="0.14.6";const rp=new lU("@firebase/app"),$Ce="@firebase/app-compat",jCe="@firebase/analytics-compat",FCe="@firebase/analytics",VCe="@firebase/app-check-compat",zCe="@firebase/app-check",UCe="@firebase/auth",GCe="@firebase/auth-compat",BCe="@firebase/database",WCe="@firebase/data-connect",HCe="@firebase/database-compat",qCe="@firebase/functions",KCe="@firebase/functions-compat",YCe="@firebase/installations",XCe="@firebase/installations-compat",ZCe="@firebase/messaging",JCe="@firebase/messaging-compat",QCe="@firebase/performance",eMe="@firebase/performance-compat",tMe="@firebase/remote-config",nMe="@firebase/remote-config-compat",rMe="@firebase/storage",iMe="@firebase/storage-compat",sMe="@firebase/firestore",oMe="@firebase/ai",aMe="@firebase/firestore-compat",lMe="firebase",cMe="12.6.0";const Tj="[DEFAULT]",uMe={[Sj]:"fire-core",[$Ce]:"fire-core-compat",[FCe]:"fire-analytics",[jCe]:"fire-analytics-compat",[zCe]:"fire-app-check",[VCe]:"fire-app-check-compat",[UCe]:"fire-auth",[GCe]:"fire-auth-compat",[BCe]:"fire-rtdb",[WCe]:"fire-data-connect",[HCe]:"fire-rtdb-compat",[qCe]:"fire-fn",[KCe]:"fire-fn-compat",[YCe]:"fire-iid",[XCe]:"fire-iid-compat",[ZCe]:"fire-fcm",[JCe]:"fire-fcm-compat",[QCe]:"fire-perf",[eMe]:"fire-perf-compat",[tMe]:"fire-rc",[nMe]:"fire-rc-compat",[rMe]:"fire-gcs",[iMe]:"fire-gcs-compat",[sMe]:"fire-fst",[aMe]:"fire-fst-compat",[oMe]:"fire-vertex","fire-js":"fire-js",[lMe]:"fire-js-all"};const A3=new Map,hMe=new Map,kj=new Map;function qX(t,e){try{t.container.addComponent(e)}catch(n){rp.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function v1(t){const e=t.name;if(kj.has(e))return rp.debug(`There were multiple attempts to register component ${e}.`),!1;kj.set(e,t);for(const n of A3.values())qX(n,t);for(const n of hMe.values())qX(n,t);return!0}function p5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ec(t){return t==null?!1:t.settings!==void 0}const dMe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cg=new MA("app","Firebase",dMe);class fMe{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Sg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cg.create("app-deleted",{appName:this._name})}}const Q1=cMe;function Kle(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Tj,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw cg.create("bad-app-name",{appName:String(i)});if(n||(n=Fle()),!n)throw cg.create("no-options");const s=A3.get(i);if(s){if(y1(n,s.options)&&y1(r,s.config))return s;throw cg.create("duplicate-app",{appName:i})}const o=new _Ce(i);for(const l of kj.values())o.addComponent(l);const a=new fMe(n,r,o);return A3.set(i,a),a}function uU(t=Tj){const e=A3.get(t);if(!e&&t===Tj&&Fle())return Kle();if(!e)throw cg.create("no-app",{appName:t});return e}function cd(t,e,n){let r=uMe[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rp.warn(o.join(" "));return}v1(new Sg(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const pMe="firebase-heartbeat-database",mMe=1,sk="firebase-heartbeat-store";let C6=null;function Yle(){return C6||(C6=MCe(pMe,mMe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(sk)}catch(n){console.warn(n)}}}}).catch(t=>{throw cg.create("idb-open",{originalErrorMessage:t.message})})),C6}async function gMe(t){try{const n=(await Yle()).transaction(sk),r=await n.objectStore(sk).get(Xle(t));return await n.done,r}catch(e){if(e instanceof Ld)rp.warn(e.message);else{const n=cg.create("idb-get",{originalErrorMessage:e?.message});rp.warn(n.message)}}}async function KX(t,e){try{const r=(await Yle()).transaction(sk,"readwrite");await r.objectStore(sk).put(e,Xle(t)),await r.done}catch(n){if(n instanceof Ld)rp.warn(n.message);else{const r=cg.create("idb-set",{originalErrorMessage:n?.message});rp.warn(r.message)}}}function Xle(t){return`${t.name}!${t.options.appId}`}const yMe=1024,vMe=30;class _Me{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new wMe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=YX();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>vMe){const i=bMe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){rp.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=YX(),{heartbeatsToSend:n,unsentEntries:r}=xMe(this._heartbeatsCache.heartbeats),i=k3(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return rp.warn(e),""}}}function YX(){return new Date().toISOString().substring(0,10)}function xMe(t,e=yMe){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),XX(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),XX(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class wMe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Wle()?lCe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gMe(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return KX(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return KX(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function XX(t){return k3(JSON.stringify({version:2,heartbeats:t})).length}function bMe(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function EMe(t){v1(new Sg("platform-logger",e=>new LCe(e),"PRIVATE")),v1(new Sg("heartbeat",e=>new _Me(e),"PRIVATE")),cd(Sj,HX,t),cd(Sj,HX,"esm2020"),cd("fire-js","")}EMe("");function Zle(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const SMe=Zle,Jle=new MA("auth","Firebase",Zle());const I3=new lU("@firebase/auth");function TMe(t,...e){I3.logLevel<=Jn.WARN&&I3.warn(`Auth (${Q1}): ${t}`,...e)}function SC(t,...e){I3.logLevel<=Jn.ERROR&&I3.error(`Auth (${Q1}): ${t}`,...e)}function bd(t,...e){throw dU(t,...e)}function nh(t,...e){return dU(t,...e)}function hU(t,e,n){const r={...SMe(),[e]:n};return new MA("auth","Firebase",r).create(e,{appName:t.name})}function ug(t){return hU(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kMe(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&bd(t,"argument-error"),hU(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function dU(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Jle.create(t,...e)}function kn(t,e,...n){if(!t)throw dU(e,...n)}function $f(t){const e="INTERNAL ASSERTION FAILED: "+t;throw SC(e),new Error(e)}function ip(t,e){t||$f(e)}function Aj(){return typeof self<"u"&&self.location?.href||""}function AMe(){return ZX()==="http:"||ZX()==="https:"}function ZX(){return typeof self<"u"&&self.location?.protocol||null}function IMe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AMe()||sCe()||"connection"in navigator)?navigator.onLine:!0}function RMe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class OA{constructor(e,n){this.shortDelay=e,this.longDelay=n,ip(n>e,"Short delay should be less than long delay!"),this.isMobile=rCe()||oCe()}get(){return IMe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fU(t,e){ip(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Qle{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$f("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$f("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$f("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const PMe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const CMe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MMe=new OA(3e4,6e4);function m5(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function D2(t,e,n,r,i={}){return ece(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=NA({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...s};return iCe()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&J1(t.emulatorConfig.host)&&(c.credentials="include"),Qle.fetch()(await nce(t,t.config.apiHost,n,a),c)})}async function ece(t,e,n){t._canInitEmulator=!1;const r={...PMe,...e};try{const i=new NMe(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rP(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rP(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw rP(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw rP(t,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw hU(t,u,c);bd(t,u)}}catch(i){if(i instanceof Ld)throw i;bd(t,"network-request-failed",{message:String(i)})}}async function tce(t,e,n,r,i={}){const s=await D2(t,e,n,r,i);return"mfaPendingCredential"in s&&bd(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function nce(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?fU(t.config,i):`${t.config.apiScheme}://${i}`;return CMe.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class NMe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(nh(this.auth,"network-request-failed")),MMe.get())})}}function rP(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=nh(t,e,r);return i.customData._tokenResponse=n,i}async function OMe(t,e){return D2(t,"POST","/v1/accounts:delete",e)}async function R3(t,e){return D2(t,"POST","/v1/accounts:lookup",e)}function FS(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LMe(t,e=!1){const n=co(t),r=await n.getIdToken(e),i=pU(r);kn(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:FS(M6(i.auth_time)),issuedAtTime:FS(M6(i.iat)),expirationTime:FS(M6(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function M6(t){return Number(t)*1e3}function pU(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return SC("JWT malformed, contained fewer than 3 sections"),null;try{const i=Lle(n);return i?JSON.parse(i):(SC("Failed to decode base64 JWT payload"),null)}catch(i){return SC("Caught error parsing JWT payload as JSON",i?.toString()),null}}function JX(t){const e=pU(t);return kn(e,"internal-error"),kn(typeof e.exp<"u","internal-error"),kn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ok(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ld&&DMe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function DMe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class $Me{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ij{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=FS(this.lastLoginAt),this.creationTime=FS(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function P3(t){const e=t.auth,n=await t.getIdToken(),r=await ok(t,R3(e,{idToken:n}));kn(r?.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=i.providerUserInfo?.length?rce(i.providerUserInfo):[],o=FMe(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!o?.length,c=a?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ij(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function jMe(t){const e=co(t);await P3(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function FMe(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function rce(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function VMe(t,e){const n=await ece(t,{},async()=>{const r=NA({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await nce(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&J1(t.emulatorConfig.host)&&(l.credentials="include"),Qle.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function zMe(t,e){return D2(t,"POST","/v2/accounts:revokeToken",m5(t,e))}class jx{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kn(e.idToken,"internal-error"),kn(typeof e.idToken<"u","internal-error"),kn(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):JX(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){kn(e.length!==0,"internal-error");const n=JX(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(kn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await VMe(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new jx;return r&&(kn(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(kn(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(kn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jx,this.toJSON())}_performRefresh(){return $f("not implemented")}}function Zp(t,e){kn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Yu{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new $Me(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ij(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ok(this,this.stsTokenManager.getToken(this.auth,e));return kn(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return LMe(this,e)}reload(){return jMe(this)}_assign(e){this!==e&&(kn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Yu({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){kn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await P3(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ec(this.auth.app))return Promise.reject(ug(this.auth));const e=await this.getIdToken();return await ok(this,OMe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:v,stsTokenManager:x}=n;kn(h&&x,e,"internal-error");const b=jx.fromJSON(this.name,x);kn(typeof h=="string",e,"internal-error"),Zp(r,e.name),Zp(i,e.name),kn(typeof f=="boolean",e,"internal-error"),kn(typeof g=="boolean",e,"internal-error"),Zp(s,e.name),Zp(o,e.name),Zp(a,e.name),Zp(l,e.name),Zp(c,e.name),Zp(u,e.name);const T=new Yu({uid:h,auth:e,email:i,emailVerified:f,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:b,createdAt:c,lastLoginAt:u});return v&&Array.isArray(v)&&(T.providerData=v.map(A=>({...A}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new jx;i.updateFromServerResponse(n);const s=new Yu({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await P3(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];kn(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?rce(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new jx;a.updateFromIdToken(r);const l=new Yu({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ij(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const QX=new Map;function jf(t){ip(t instanceof Function,"Expected a class definition");let e=QX.get(t);return e?(ip(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,QX.set(t,e),e)}class ice{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ice.type="NONE";const eZ=ice;function TC(t,e,n){return`firebase:${t}:${e}:${n}`}class Fx{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=TC(this.userKey,i.apiKey,s),this.fullPersistenceKey=TC("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await R3(this.auth,{idToken:e}).catch(()=>{});return n?Yu._fromGetAccountInfoResponse(this.auth,n,e):null}return Yu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Fx(jf(eZ),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||jf(eZ);const o=TC(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await R3(e,{idToken:u}).catch(()=>{});if(!f)break;h=await Yu._fromGetAccountInfoResponse(e,f,u)}else h=Yu._fromJSON(e,u);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Fx(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Fx(s,e,r))}}function tZ(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lce(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sce(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uce(e))return"Blackberry";if(hce(e))return"Webos";if(oce(e))return"Safari";if((e.includes("chrome/")||ace(e))&&!e.includes("edge/"))return"Chrome";if(cce(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function sce(t=Us()){return/firefox\//i.test(t)}function oce(t=Us()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ace(t=Us()){return/crios\//i.test(t)}function lce(t=Us()){return/iemobile/i.test(t)}function cce(t=Us()){return/android/i.test(t)}function uce(t=Us()){return/blackberry/i.test(t)}function hce(t=Us()){return/webos/i.test(t)}function mU(t=Us()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function UMe(t=Us()){return mU(t)&&!!window.navigator?.standalone}function GMe(){return aCe()&&document.documentMode===10}function dce(t=Us()){return mU(t)||cce(t)||hce(t)||uce(t)||/windows phone/i.test(t)||lce(t)}function fce(t,e=[]){let n;switch(t){case"Browser":n=tZ(Us());break;case"Worker":n=`${tZ(Us())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Q1}/${r}`}class BMe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function WMe(t,e={}){return D2(t,"GET","/v2/passwordPolicy",m5(t,e))}const HMe=6;class qMe{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??HMe,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class KMe{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nZ(this),this.idTokenSubscription=new nZ(this),this.beforeStateQueue=new BMe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jle,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=jf(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fx.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await R3(this,{idToken:e}),r=await Yu._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ec(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return kn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await P3(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RMe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ec(this.app))return Promise.reject(ug(this));const n=e?co(e):null;return n&&kn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&kn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ec(this.app)?Promise.reject(ug(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ec(this.app)?Promise.reject(ug(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jf(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WMe(this),n=new qMe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new MA("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await zMe(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&jf(e)||this._popupRedirectResolver;kn(n,this,"argument-error"),this.redirectPersistenceManager=await Fx.create(this,[jf(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(kn(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fce(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ec(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&TMe(`Error while retrieving App Check token: ${e.error}`),e?.token}}function LA(t){return co(t)}class nZ{constructor(e){this.auth=e,this.observer=null,this.addObserver=fCe(n=>this.observer=n)}get next(){return kn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let gU={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YMe(t){gU=t}function XMe(t){return gU.loadJS(t)}function ZMe(){return gU.gapiScript}function JMe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function QMe(t,e){const n=p5(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(y1(s,e??{}))return i;bd(i,"already-initialized")}return n.initialize({options:e})}function e3e(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(jf);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function t3e(t,e,n){const r=LA(t);kn(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=pce(e),{host:o,port:a}=n3e(e),l=a===null?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){kn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),kn(y1(c,r.config.emulator)&&y1(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,J1(o)?(oU(`${s}//${o}${l}`),aU("Auth",!0)):r3e()}function pce(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function n3e(t){const e=pce(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:rZ(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:rZ(o)}}}function rZ(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function r3e(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class mce{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $f("not implemented")}_getIdTokenResponse(e){return $f("not implemented")}_linkToIdToken(e,n){return $f("not implemented")}_getReauthenticationResolver(e){return $f("not implemented")}}async function Vx(t,e){return tce(t,"POST","/v1/accounts:signInWithIdp",m5(t,e))}const i3e="http://localhost";class _1 extends mce{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new _1(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):bd("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new _1(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Vx(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Vx(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Vx(e,n)}buildRequest(){const e={requestUri:i3e,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=NA(n)}return e}}class yU{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class DA extends yU{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Om extends DA{constructor(){super("facebook.com")}static credential(e){return _1._fromParams({providerId:Om.PROVIDER_ID,signInMethod:Om.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Om.credentialFromTaggedObject(e)}static credentialFromError(e){return Om.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Om.credential(e.oauthAccessToken)}catch{return null}}}Om.FACEBOOK_SIGN_IN_METHOD="facebook.com";Om.PROVIDER_ID="facebook.com";class Wu extends DA{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return _1._fromParams({providerId:Wu.PROVIDER_ID,signInMethod:Wu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Wu.credentialFromTaggedObject(e)}static credentialFromError(e){return Wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Wu.credential(n,r)}catch{return null}}}Wu.GOOGLE_SIGN_IN_METHOD="google.com";Wu.PROVIDER_ID="google.com";class Lm extends DA{constructor(){super("github.com")}static credential(e){return _1._fromParams({providerId:Lm.PROVIDER_ID,signInMethod:Lm.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lm.credentialFromTaggedObject(e)}static credentialFromError(e){return Lm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lm.credential(e.oauthAccessToken)}catch{return null}}}Lm.GITHUB_SIGN_IN_METHOD="github.com";Lm.PROVIDER_ID="github.com";class Dm extends DA{constructor(){super("twitter.com")}static credential(e,n){return _1._fromParams({providerId:Dm.PROVIDER_ID,signInMethod:Dm.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Dm.credentialFromTaggedObject(e)}static credentialFromError(e){return Dm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Dm.credential(n,r)}catch{return null}}}Dm.TWITTER_SIGN_IN_METHOD="twitter.com";Dm.PROVIDER_ID="twitter.com";async function s3e(t,e){return tce(t,"POST","/v1/accounts:signUp",m5(t,e))}class Tg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Yu._fromIdTokenResponse(e,r,i),o=iZ(r);return new Tg({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=iZ(r);return new Tg({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function iZ(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function o3e(t){if(ec(t.app))return Promise.reject(ug(t));const e=LA(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Tg({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await s3e(e,{returnSecureToken:!0}),r=await Tg._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}class C3 extends Ld{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,C3.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new C3(e,n,r,i)}}function gce(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?C3._fromErrorAndOperation(t,s,e,r):s})}async function a3e(t,e,n=!1){const r=await ok(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Tg._forOperation(t,"link",r)}async function l3e(t,e,n=!1){const{auth:r}=t;if(ec(r.app))return Promise.reject(ug(r));const i="reauthenticate";try{const s=await ok(t,gce(r,i,e,t),n);kn(s.idToken,r,"internal-error");const o=pU(s.idToken);kn(o,r,"internal-error");const{sub:a}=o;return kn(t.uid===a,r,"user-mismatch"),Tg._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&bd(r,"user-mismatch"),s}}async function c3e(t,e,n=!1){if(ec(t.app))return Promise.reject(ug(t));const r="signIn",i=await gce(t,r,e),s=await Tg._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function u3e(t,e,n,r){return co(t).onIdTokenChanged(e,n,r)}function h3e(t,e,n){return co(t).beforeAuthStateChanged(e,n)}function yce(t,e,n,r){return co(t).onAuthStateChanged(e,n,r)}function vce(t){return co(t).signOut()}const M3="__sak";class _ce{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(M3,"1"),this.storage.removeItem(M3),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const d3e=1e3,f3e=10;class xce extends _ce{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dce(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);GMe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,f3e):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},d3e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}xce.type="LOCAL";const p3e=xce;class wce extends _ce{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}wce.type="SESSION";const bce=wce;function m3e(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class g5{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new g5(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await m3e(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}g5.receivers=[];function vU(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class g3e{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=vU("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function ud(){return window}function y3e(t){ud().location.href=t}function Ece(){return typeof ud().WorkerGlobalScope<"u"&&typeof ud().importScripts=="function"}async function v3e(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _3e(){return navigator?.serviceWorker?.controller||null}function x3e(){return Ece()?self:null}const Sce="firebaseLocalStorageDb",w3e=1,N3="firebaseLocalStorage",Tce="fbase_key";class $A{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function y5(t,e){return t.transaction([N3],e?"readwrite":"readonly").objectStore(N3)}function b3e(){const t=indexedDB.deleteDatabase(Sce);return new $A(t).toPromise()}function Rj(){const t=indexedDB.open(Sce,w3e);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(N3,{keyPath:Tce})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(N3)?e(r):(r.close(),await b3e(),e(await Rj()))})})}async function sZ(t,e,n){const r=y5(t,!0).put({[Tce]:e,value:n});return new $A(r).toPromise()}async function E3e(t,e){const n=y5(t,!1).get(e),r=await new $A(n).toPromise();return r===void 0?null:r.value}function oZ(t,e){const n=y5(t,!0).delete(e);return new $A(n).toPromise()}const S3e=800,T3e=3;class kce{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Rj(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>T3e)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ece()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=g5._getInstance(x3e()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await v3e(),!this.activeServiceWorker)return;this.sender=new g3e(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_3e()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rj();return await sZ(e,M3,"1"),await oZ(e,M3),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>sZ(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>E3e(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>oZ(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=y5(i,!1).getAll();return new $A(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),S3e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kce.type="LOCAL";const k3e=kce;new OA(3e4,6e4);function Ace(t,e){return e?jf(e):(kn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class _U extends mce{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vx(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Vx(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Vx(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function A3e(t){return c3e(t.auth,new _U(t),t.bypassAuthState)}function I3e(t){const{auth:e,user:n}=t;return kn(n,e,"internal-error"),l3e(n,new _U(t),t.bypassAuthState)}async function R3e(t){const{auth:e,user:n}=t;return kn(n,e,"internal-error"),a3e(n,new _U(t),t.bypassAuthState)}class Ice{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return A3e;case"linkViaPopup":case"linkViaRedirect":return R3e;case"reauthViaPopup":case"reauthViaRedirect":return I3e;default:bd(this.auth,"internal-error")}}resolve(e){ip(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ip(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const P3e=new OA(2e3,1e4);async function aZ(t,e,n){if(ec(t.app))return Promise.reject(nh(t,"operation-not-supported-in-this-environment"));const r=LA(t);kMe(t,e,yU);const i=Ace(r,n);return new Ty(r,"signInViaPopup",e,i).executeNotNull()}class Ty extends Ice{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ty.currentPopupAction&&Ty.currentPopupAction.cancel(),Ty.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kn(e,this.auth,"internal-error"),e}async onExecution(){ip(this.filter.length===1,"Popup operations only handle one event");const e=vU();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(nh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ty.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,P3e.get())};e()}}Ty.currentPopupAction=null;const C3e="pendingRedirect",kC=new Map;class M3e extends Ice{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=kC.get(this.auth._key());if(!e){try{const r=await N3e(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}kC.set(this.auth._key(),e)}return this.bypassAuthState||kC.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function N3e(t,e){const n=D3e(e),r=L3e(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function O3e(t,e){kC.set(t._key(),e)}function L3e(t){return jf(t._redirectPersistence)}function D3e(t){return TC(C3e,t.config.apiKey,t.name)}async function $3e(t,e,n=!1){if(ec(t.app))return Promise.reject(ug(t));const r=LA(t),i=Ace(r,e),o=await new M3e(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const j3e=600*1e3;class F3e{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!V3e(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!Rce(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(nh(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=j3e&&this.cachedEventUids.clear(),this.cachedEventUids.has(lZ(e))}saveEventToCache(e){this.cachedEventUids.add(lZ(e)),this.lastProcessedEventTime=Date.now()}}function lZ(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Rce({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function V3e(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rce(t);default:return!1}}async function z3e(t,e={}){return D2(t,"GET","/v1/projects",e)}const U3e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,G3e=/^https?/;async function B3e(t){if(t.config.emulator)return;const{authorizedDomains:e}=await z3e(t);for(const n of e)try{if(W3e(n))return}catch{}bd(t,"unauthorized-domain")}function W3e(t){const e=Aj(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!G3e.test(n))return!1;if(U3e.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const H3e=new OA(3e4,6e4);function cZ(){const t=ud().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function q3e(t){return new Promise((e,n)=>{function r(){cZ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cZ(),n(nh(t,"network-request-failed"))},timeout:H3e.get()})}if(ud().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ud().gapi?.load)r();else{const i=JMe("iframefcb");return ud()[i]=()=>{gapi.load?r():n(nh(t,"network-request-failed"))},XMe(`${ZMe()}?onload=${i}`).catch(s=>n(s))}}).catch(e=>{throw AC=null,e})}let AC=null;function K3e(t){return AC=AC||q3e(t),AC}const Y3e=new OA(5e3,15e3),X3e="__/auth/iframe",Z3e="emulator/auth/iframe",J3e={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Q3e=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function e4e(t){const e=t.config;kn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?fU(e,Z3e):`https://${t.config.authDomain}/${X3e}`,r={apiKey:e.apiKey,appName:t.name,v:Q1},i=Q3e.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${NA(r).slice(1)}`}async function t4e(t){const e=await K3e(t),n=ud().gapi;return kn(n,t,"internal-error"),e.open({where:document.body,url:e4e(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:J3e,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=nh(t,"network-request-failed"),a=ud().setTimeout(()=>{s(o)},Y3e.get());function l(){ud().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}const n4e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},r4e=500,i4e=600,s4e="_blank",o4e="http://localhost";class uZ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function a4e(t,e,n,r=r4e,i=i4e){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...n4e,width:r.toString(),height:i.toString(),top:s,left:o},c=Us().toLowerCase();n&&(a=ace(c)?s4e:n),sce(c)&&(e=e||o4e,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[g,v])=>`${f}${g}=${v},`,"");if(UMe(c)&&a!=="_self")return l4e(e||"",a),new uZ(null);const h=window.open(e||"",a,u);kn(h,t,"popup-blocked");try{h.focus()}catch{}return new uZ(h)}function l4e(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const c4e="__/auth/handler",u4e="emulator/auth/handler",h4e=encodeURIComponent("fac");async function hZ(t,e,n,r,i,s){kn(t.config.authDomain,t,"auth-domain-config-required"),kn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Q1,eventId:i};if(e instanceof yU){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",dCe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof DA){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${h4e}=${encodeURIComponent(l)}`:"";return`${d4e(t)}?${NA(a).slice(1)}${c}`}function d4e({config:t}){return t.emulator?fU(t,u4e):`https://${t.authDomain}/${c4e}`}const N6="webStorageSupport";class f4e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=bce,this._completeRedirectFn=$3e,this._overrideRedirectResult=O3e}async _openPopup(e,n,r,i){ip(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await hZ(e,n,r,Aj(),i);return a4e(e,s,vU())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await hZ(e,n,r,Aj(),i);return y3e(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ip(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await t4e(e),r=new F3e(e);return n.register("authEvent",i=>(kn(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(N6,{type:N6},i=>{const s=i?.[0]?.[N6];s!==void 0&&n(!!s),bd(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=B3e(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return dce()||oce()||mU()}}const p4e=f4e;var dZ="@firebase/auth",fZ="1.12.0";class m4e{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){kn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function g4e(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function y4e(t){v1(new Sg("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;kn(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fce(t)},c=new KMe(r,i,s,l);return e3e(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),v1(new Sg("auth-internal",e=>{const n=LA(e.getProvider("auth").getImmediate());return(r=>new m4e(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),cd(dZ,fZ,g4e(t)),cd(dZ,fZ,"esm2020")}const v4e=300,_4e=Vle("authIdTokenMaxAge")||v4e;let pZ=null;const x4e=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>_4e)return;const i=n?.token;pZ!==i&&(pZ=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function w4e(t=uU()){const e=p5(t,"auth");if(e.isInitialized())return e.getImmediate();const n=QMe(t,{popupRedirectResolver:p4e,persistence:[k3e,p3e,bce]}),r=Vle("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=x4e(s.toString());h3e(n,o,()=>o(n.currentUser)),u3e(n,a=>o(a))}}const i=$le("auth");return i&&t3e(n,`http://${i}`),n}function b4e(){return document.getElementsByTagName("head")?.[0]??document}YMe({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=nh("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",b4e().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});y4e("Browser");var E4e="firebase",S4e="12.7.0";cd(E4e,S4e,"app");var mZ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hg,Pce;(function(){var t;function e(C,N){function O(){}O.prototype=N.prototype,C.F=N.prototype,C.prototype=new O,C.prototype.constructor=C,C.D=function(j,V,W){for(var U=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)U[pe-2]=arguments[pe];return N.prototype[V].apply(j,U)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,N,O){O||(O=0);const j=Array(16);if(typeof N=="string")for(var V=0;V<16;++V)j[V]=N.charCodeAt(O++)|N.charCodeAt(O++)<<8|N.charCodeAt(O++)<<16|N.charCodeAt(O++)<<24;else for(V=0;V<16;++V)j[V]=N[O++]|N[O++]<<8|N[O++]<<16|N[O++]<<24;N=C.g[0],O=C.g[1],V=C.g[2];let W=C.g[3],U;U=N+(W^O&(V^W))+j[0]+3614090360&4294967295,N=O+(U<<7&4294967295|U>>>25),U=W+(V^N&(O^V))+j[1]+3905402710&4294967295,W=N+(U<<12&4294967295|U>>>20),U=V+(O^W&(N^O))+j[2]+606105819&4294967295,V=W+(U<<17&4294967295|U>>>15),U=O+(N^V&(W^N))+j[3]+3250441966&4294967295,O=V+(U<<22&4294967295|U>>>10),U=N+(W^O&(V^W))+j[4]+4118548399&4294967295,N=O+(U<<7&4294967295|U>>>25),U=W+(V^N&(O^V))+j[5]+1200080426&4294967295,W=N+(U<<12&4294967295|U>>>20),U=V+(O^W&(N^O))+j[6]+2821735955&4294967295,V=W+(U<<17&4294967295|U>>>15),U=O+(N^V&(W^N))+j[7]+4249261313&4294967295,O=V+(U<<22&4294967295|U>>>10),U=N+(W^O&(V^W))+j[8]+1770035416&4294967295,N=O+(U<<7&4294967295|U>>>25),U=W+(V^N&(O^V))+j[9]+2336552879&4294967295,W=N+(U<<12&4294967295|U>>>20),U=V+(O^W&(N^O))+j[10]+4294925233&4294967295,V=W+(U<<17&4294967295|U>>>15),U=O+(N^V&(W^N))+j[11]+2304563134&4294967295,O=V+(U<<22&4294967295|U>>>10),U=N+(W^O&(V^W))+j[12]+1804603682&4294967295,N=O+(U<<7&4294967295|U>>>25),U=W+(V^N&(O^V))+j[13]+4254626195&4294967295,W=N+(U<<12&4294967295|U>>>20),U=V+(O^W&(N^O))+j[14]+2792965006&4294967295,V=W+(U<<17&4294967295|U>>>15),U=O+(N^V&(W^N))+j[15]+1236535329&4294967295,O=V+(U<<22&4294967295|U>>>10),U=N+(V^W&(O^V))+j[1]+4129170786&4294967295,N=O+(U<<5&4294967295|U>>>27),U=W+(O^V&(N^O))+j[6]+3225465664&4294967295,W=N+(U<<9&4294967295|U>>>23),U=V+(N^O&(W^N))+j[11]+643717713&4294967295,V=W+(U<<14&4294967295|U>>>18),U=O+(W^N&(V^W))+j[0]+3921069994&4294967295,O=V+(U<<20&4294967295|U>>>12),U=N+(V^W&(O^V))+j[5]+3593408605&4294967295,N=O+(U<<5&4294967295|U>>>27),U=W+(O^V&(N^O))+j[10]+38016083&4294967295,W=N+(U<<9&4294967295|U>>>23),U=V+(N^O&(W^N))+j[15]+3634488961&4294967295,V=W+(U<<14&4294967295|U>>>18),U=O+(W^N&(V^W))+j[4]+3889429448&4294967295,O=V+(U<<20&4294967295|U>>>12),U=N+(V^W&(O^V))+j[9]+568446438&4294967295,N=O+(U<<5&4294967295|U>>>27),U=W+(O^V&(N^O))+j[14]+3275163606&4294967295,W=N+(U<<9&4294967295|U>>>23),U=V+(N^O&(W^N))+j[3]+4107603335&4294967295,V=W+(U<<14&4294967295|U>>>18),U=O+(W^N&(V^W))+j[8]+1163531501&4294967295,O=V+(U<<20&4294967295|U>>>12),U=N+(V^W&(O^V))+j[13]+2850285829&4294967295,N=O+(U<<5&4294967295|U>>>27),U=W+(O^V&(N^O))+j[2]+4243563512&4294967295,W=N+(U<<9&4294967295|U>>>23),U=V+(N^O&(W^N))+j[7]+1735328473&4294967295,V=W+(U<<14&4294967295|U>>>18),U=O+(W^N&(V^W))+j[12]+2368359562&4294967295,O=V+(U<<20&4294967295|U>>>12),U=N+(O^V^W)+j[5]+4294588738&4294967295,N=O+(U<<4&4294967295|U>>>28),U=W+(N^O^V)+j[8]+2272392833&4294967295,W=N+(U<<11&4294967295|U>>>21),U=V+(W^N^O)+j[11]+1839030562&4294967295,V=W+(U<<16&4294967295|U>>>16),U=O+(V^W^N)+j[14]+4259657740&4294967295,O=V+(U<<23&4294967295|U>>>9),U=N+(O^V^W)+j[1]+2763975236&4294967295,N=O+(U<<4&4294967295|U>>>28),U=W+(N^O^V)+j[4]+1272893353&4294967295,W=N+(U<<11&4294967295|U>>>21),U=V+(W^N^O)+j[7]+4139469664&4294967295,V=W+(U<<16&4294967295|U>>>16),U=O+(V^W^N)+j[10]+3200236656&4294967295,O=V+(U<<23&4294967295|U>>>9),U=N+(O^V^W)+j[13]+681279174&4294967295,N=O+(U<<4&4294967295|U>>>28),U=W+(N^O^V)+j[0]+3936430074&4294967295,W=N+(U<<11&4294967295|U>>>21),U=V+(W^N^O)+j[3]+3572445317&4294967295,V=W+(U<<16&4294967295|U>>>16),U=O+(V^W^N)+j[6]+76029189&4294967295,O=V+(U<<23&4294967295|U>>>9),U=N+(O^V^W)+j[9]+3654602809&4294967295,N=O+(U<<4&4294967295|U>>>28),U=W+(N^O^V)+j[12]+3873151461&4294967295,W=N+(U<<11&4294967295|U>>>21),U=V+(W^N^O)+j[15]+530742520&4294967295,V=W+(U<<16&4294967295|U>>>16),U=O+(V^W^N)+j[2]+3299628645&4294967295,O=V+(U<<23&4294967295|U>>>9),U=N+(V^(O|~W))+j[0]+4096336452&4294967295,N=O+(U<<6&4294967295|U>>>26),U=W+(O^(N|~V))+j[7]+1126891415&4294967295,W=N+(U<<10&4294967295|U>>>22),U=V+(N^(W|~O))+j[14]+2878612391&4294967295,V=W+(U<<15&4294967295|U>>>17),U=O+(W^(V|~N))+j[5]+4237533241&4294967295,O=V+(U<<21&4294967295|U>>>11),U=N+(V^(O|~W))+j[12]+1700485571&4294967295,N=O+(U<<6&4294967295|U>>>26),U=W+(O^(N|~V))+j[3]+2399980690&4294967295,W=N+(U<<10&4294967295|U>>>22),U=V+(N^(W|~O))+j[10]+4293915773&4294967295,V=W+(U<<15&4294967295|U>>>17),U=O+(W^(V|~N))+j[1]+2240044497&4294967295,O=V+(U<<21&4294967295|U>>>11),U=N+(V^(O|~W))+j[8]+1873313359&4294967295,N=O+(U<<6&4294967295|U>>>26),U=W+(O^(N|~V))+j[15]+4264355552&4294967295,W=N+(U<<10&4294967295|U>>>22),U=V+(N^(W|~O))+j[6]+2734768916&4294967295,V=W+(U<<15&4294967295|U>>>17),U=O+(W^(V|~N))+j[13]+1309151649&4294967295,O=V+(U<<21&4294967295|U>>>11),U=N+(V^(O|~W))+j[4]+4149444226&4294967295,N=O+(U<<6&4294967295|U>>>26),U=W+(O^(N|~V))+j[11]+3174756917&4294967295,W=N+(U<<10&4294967295|U>>>22),U=V+(N^(W|~O))+j[2]+718787259&4294967295,V=W+(U<<15&4294967295|U>>>17),U=O+(W^(V|~N))+j[9]+3951481745&4294967295,C.g[0]=C.g[0]+N&4294967295,C.g[1]=C.g[1]+(V+(U<<21&4294967295|U>>>11))&4294967295,C.g[2]=C.g[2]+V&4294967295,C.g[3]=C.g[3]+W&4294967295}r.prototype.v=function(C,N){N===void 0&&(N=C.length);const O=N-this.blockSize,j=this.C;let V=this.h,W=0;for(;W<N;){if(V==0)for(;W<=O;)i(this,C,W),W+=this.blockSize;if(typeof C=="string"){for(;W<N;)if(j[V++]=C.charCodeAt(W++),V==this.blockSize){i(this,j),V=0;break}}else for(;W<N;)if(j[V++]=C[W++],V==this.blockSize){i(this,j),V=0;break}}this.h=V,this.o+=N},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var N=1;N<C.length-8;++N)C[N]=0;N=this.o*8;for(var O=C.length-8;O<C.length;++O)C[O]=N&255,N/=256;for(this.v(C),C=Array(16),N=0,O=0;O<4;++O)for(let j=0;j<32;j+=8)C[N++]=this.g[O]>>>j&255;return C};function s(C,N){var O=a;return Object.prototype.hasOwnProperty.call(O,C)?O[C]:O[C]=N(C)}function o(C,N){this.h=N;const O=[];let j=!0;for(let V=C.length-1;V>=0;V--){const W=C[V]|0;j&&W==N||(O[V]=W,j=!1)}this.g=O}var a={};function l(C){return-128<=C&&C<128?s(C,function(N){return new o([N|0],N<0?-1:0)}):new o([C|0],C<0?-1:0)}function c(C){if(isNaN(C)||!isFinite(C))return h;if(C<0)return b(c(-C));const N=[];let O=1;for(let j=0;C>=O;j++)N[j]=C/O|0,O*=4294967296;return new o(N,0)}function u(C,N){if(C.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(C.charAt(0)=="-")return b(u(C.substring(1),N));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=c(Math.pow(N,8));let j=h;for(let W=0;W<C.length;W+=8){var V=Math.min(8,C.length-W);const U=parseInt(C.substring(W,W+V),N);V<8?(V=c(Math.pow(N,V)),j=j.j(V).add(c(U))):(j=j.j(O),j=j.add(c(U)))}return j}var h=l(0),f=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-b(this).m();let C=0,N=1;for(let O=0;O<this.g.length;O++){const j=this.i(O);C+=(j>=0?j:4294967296+j)*N,N*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(v(this))return"0";if(x(this))return"-"+b(this).toString(C);const N=c(Math.pow(C,6));var O=this;let j="";for(;;){const V=R(O,N).g;O=T(O,V.j(N));let W=((O.g.length>0?O.g[0]:O.h)>>>0).toString(C);if(O=V,v(O))return W+j;for(;W.length<6;)W="0"+W;j=W+j}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function v(C){if(C.h!=0)return!1;for(let N=0;N<C.g.length;N++)if(C.g[N]!=0)return!1;return!0}function x(C){return C.h==-1}t.l=function(C){return C=T(this,C),x(C)?-1:v(C)?0:1};function b(C){const N=C.g.length,O=[];for(let j=0;j<N;j++)O[j]=~C.g[j];return new o(O,~C.h).add(f)}t.abs=function(){return x(this)?b(this):this},t.add=function(C){const N=Math.max(this.g.length,C.g.length),O=[];let j=0;for(let V=0;V<=N;V++){let W=j+(this.i(V)&65535)+(C.i(V)&65535),U=(W>>>16)+(this.i(V)>>>16)+(C.i(V)>>>16);j=U>>>16,W&=65535,U&=65535,O[V]=U<<16|W}return new o(O,O[O.length-1]&-2147483648?-1:0)};function T(C,N){return C.add(b(N))}t.j=function(C){if(v(this)||v(C))return h;if(x(this))return x(C)?b(this).j(b(C)):b(b(this).j(C));if(x(C))return b(this.j(b(C)));if(this.l(g)<0&&C.l(g)<0)return c(this.m()*C.m());const N=this.g.length+C.g.length,O=[];for(var j=0;j<2*N;j++)O[j]=0;for(j=0;j<this.g.length;j++)for(let V=0;V<C.g.length;V++){const W=this.i(j)>>>16,U=this.i(j)&65535,pe=C.i(V)>>>16,Ne=C.i(V)&65535;O[2*j+2*V]+=U*Ne,A(O,2*j+2*V),O[2*j+2*V+1]+=W*Ne,A(O,2*j+2*V+1),O[2*j+2*V+1]+=U*pe,A(O,2*j+2*V+1),O[2*j+2*V+2]+=W*pe,A(O,2*j+2*V+2)}for(C=0;C<N;C++)O[C]=O[2*C+1]<<16|O[2*C];for(C=N;C<2*N;C++)O[C]=0;return new o(O,0)};function A(C,N){for(;(C[N]&65535)!=C[N];)C[N+1]+=C[N]>>>16,C[N]&=65535,N++}function I(C,N){this.g=C,this.h=N}function R(C,N){if(v(N))throw Error("division by zero");if(v(C))return new I(h,h);if(x(C))return N=R(b(C),N),new I(b(N.g),b(N.h));if(x(N))return N=R(C,b(N)),new I(b(N.g),N.h);if(C.g.length>30){if(x(C)||x(N))throw Error("slowDivide_ only works with positive integers.");for(var O=f,j=N;j.l(C)<=0;)O=M(O),j=M(j);var V=F(O,1),W=F(j,1);for(j=F(j,2),O=F(O,2);!v(j);){var U=W.add(j);U.l(C)<=0&&(V=V.add(O),W=U),j=F(j,1),O=F(O,1)}return N=T(C,V.j(N)),new I(V,N)}for(V=h;C.l(N)>=0;){for(O=Math.max(1,Math.floor(C.m()/N.m())),j=Math.ceil(Math.log(O)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),W=c(O),U=W.j(N);x(U)||U.l(C)>0;)O-=j,W=c(O),U=W.j(N);v(W)&&(W=f),V=V.add(W),C=T(C,U)}return new I(V,C)}t.B=function(C){return R(this,C).h},t.and=function(C){const N=Math.max(this.g.length,C.g.length),O=[];for(let j=0;j<N;j++)O[j]=this.i(j)&C.i(j);return new o(O,this.h&C.h)},t.or=function(C){const N=Math.max(this.g.length,C.g.length),O=[];for(let j=0;j<N;j++)O[j]=this.i(j)|C.i(j);return new o(O,this.h|C.h)},t.xor=function(C){const N=Math.max(this.g.length,C.g.length),O=[];for(let j=0;j<N;j++)O[j]=this.i(j)^C.i(j);return new o(O,this.h^C.h)};function M(C){const N=C.g.length+1,O=[];for(let j=0;j<N;j++)O[j]=C.i(j)<<1|C.i(j-1)>>>31;return new o(O,C.h)}function F(C,N){const O=N>>5;N%=32;const j=C.g.length-O,V=[];for(let W=0;W<j;W++)V[W]=N>0?C.i(W+O)>>>N|C.i(W+O+1)<<32-N:C.i(W+O);return new o(V,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Pce=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,hg=o}).apply(typeof mZ<"u"?mZ:typeof self<"u"?self:typeof window<"u"?window:{});var iP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Cce,GE,Mce,IC,Pj,Nce,Oce,Lce;(function(){var t,e=Object.defineProperty;function n(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof iP=="object"&&iP];for(var D=0;D<S.length;++D){var G=S[D];if(G&&G.Math==Math)return G}throw Error("Cannot find global object")}var r=n(this);function i(S,D){if(D)e:{var G=r;S=S.split(".");for(var Z=0;Z<S.length-1;Z++){var Ee=S[Z];if(!(Ee in G))break e;G=G[Ee]}S=S[S.length-1],Z=G[S],D=D(Z),D!=Z&&D!=null&&e(G,S,{configurable:!0,writable:!0,value:D})}}i("Symbol.dispose",function(S){return S||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(S){return S||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(S){return S||function(D){var G=[],Z;for(Z in D)Object.prototype.hasOwnProperty.call(D,Z)&&G.push([Z,D[Z]]);return G}});var s=s||{},o=this||self;function a(S){var D=typeof S;return D=="object"&&S!=null||D=="function"}function l(S,D,G){return S.call.apply(S.bind,arguments)}function c(S,D,G){return c=l,c.apply(null,arguments)}function u(S,D){var G=Array.prototype.slice.call(arguments,1);return function(){var Z=G.slice();return Z.push.apply(Z,arguments),S.apply(this,Z)}}function h(S,D){function G(){}G.prototype=D.prototype,S.Z=D.prototype,S.prototype=new G,S.prototype.constructor=S,S.Ob=function(Z,Ee,Ve){for(var _t=Array(arguments.length-2),Cn=2;Cn<arguments.length;Cn++)_t[Cn-2]=arguments[Cn];return D.prototype[Ee].apply(Z,_t)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?S=>S&&AsyncContext.Snapshot.wrap(S):S=>S;function g(S){const D=S.length;if(D>0){const G=Array(D);for(let Z=0;Z<D;Z++)G[Z]=S[Z];return G}return[]}function v(S,D){for(let Z=1;Z<arguments.length;Z++){const Ee=arguments[Z];var G=typeof Ee;if(G=G!="object"?G:Ee?Array.isArray(Ee)?"array":G:"null",G=="array"||G=="object"&&typeof Ee.length=="number"){G=S.length||0;const Ve=Ee.length||0;S.length=G+Ve;for(let _t=0;_t<Ve;_t++)S[G+_t]=Ee[_t]}else S.push(Ee)}}class x{constructor(D,G){this.i=D,this.j=G,this.h=0,this.g=null}get(){let D;return this.h>0?(this.h--,D=this.g,this.g=D.next,D.next=null):D=this.i(),D}}function b(S){o.setTimeout(()=>{throw S},0)}function T(){var S=C;let D=null;return S.g&&(D=S.g,S.g=S.g.next,S.g||(S.h=null),D.next=null),D}class A{constructor(){this.h=this.g=null}add(D,G){const Z=I.get();Z.set(D,G),this.h?this.h.next=Z:this.g=Z,this.h=Z}}var I=new x(()=>new R,S=>S.reset());class R{constructor(){this.next=this.g=this.h=null}set(D,G){this.h=D,this.g=G,this.next=null}reset(){this.next=this.g=this.h=null}}let M,F=!1,C=new A,N=()=>{const S=Promise.resolve(void 0);M=()=>{S.then(O)}};function O(){for(var S;S=T();){try{S.h.call(S.g)}catch(G){b(G)}var D=I;D.j(S),D.h<100&&(D.h++,S.next=D.g,D.g=S)}F=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(S,D){this.type=S,this.g=this.target=D,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var W=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var S=!1,D=Object.defineProperty({},"passive",{get:function(){S=!0}});try{const G=()=>{};o.addEventListener("test",G,D),o.removeEventListener("test",G,D)}catch{}return S})();function U(S){return/^[\s\xa0]*$/.test(S)}function pe(S,D){V.call(this,S?S.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,S&&this.init(S,D)}h(pe,V),pe.prototype.init=function(S,D){const G=this.type=S.type,Z=S.changedTouches&&S.changedTouches.length?S.changedTouches[0]:null;this.target=S.target||S.srcElement,this.g=D,D=S.relatedTarget,D||(G=="mouseover"?D=S.fromElement:G=="mouseout"&&(D=S.toElement)),this.relatedTarget=D,Z?(this.clientX=Z.clientX!==void 0?Z.clientX:Z.pageX,this.clientY=Z.clientY!==void 0?Z.clientY:Z.pageY,this.screenX=Z.screenX||0,this.screenY=Z.screenY||0):(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0),this.button=S.button,this.key=S.key||"",this.ctrlKey=S.ctrlKey,this.altKey=S.altKey,this.shiftKey=S.shiftKey,this.metaKey=S.metaKey,this.pointerId=S.pointerId||0,this.pointerType=S.pointerType,this.state=S.state,this.i=S,S.defaultPrevented&&pe.Z.h.call(this)},pe.prototype.h=function(){pe.Z.h.call(this);const S=this.i;S.preventDefault?S.preventDefault():S.returnValue=!1};var Ne="closure_listenable_"+(Math.random()*1e6|0),Se=0;function je(S,D,G,Z,Ee){this.listener=S,this.proxy=null,this.src=D,this.type=G,this.capture=!!Z,this.ha=Ee,this.key=++Se,this.da=this.fa=!1}function de(S){S.da=!0,S.listener=null,S.proxy=null,S.src=null,S.ha=null}function Oe(S,D,G){for(const Z in S)D.call(G,S[Z],Z,S)}function Ae(S,D){for(const G in S)D.call(void 0,S[G],G,S)}function Q(S){const D={};for(const G in S)D[G]=S[G];return D}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(S,D){let G,Z;for(let Ee=1;Ee<arguments.length;Ee++){Z=arguments[Ee];for(G in Z)S[G]=Z[G];for(let Ve=0;Ve<B.length;Ve++)G=B[Ve],Object.prototype.hasOwnProperty.call(Z,G)&&(S[G]=Z[G])}}function ie(S){this.src=S,this.g={},this.h=0}ie.prototype.add=function(S,D,G,Z,Ee){const Ve=S.toString();S=this.g[Ve],S||(S=this.g[Ve]=[],this.h++);const _t=ve(S,D,Z,Ee);return _t>-1?(D=S[_t],G||(D.fa=!1)):(D=new je(D,this.src,Ve,!!Z,Ee),D.fa=G,S.push(D)),D};function le(S,D){const G=D.type;if(G in S.g){var Z=S.g[G],Ee=Array.prototype.indexOf.call(Z,D,void 0),Ve;(Ve=Ee>=0)&&Array.prototype.splice.call(Z,Ee,1),Ve&&(de(D),S.g[G].length==0&&(delete S.g[G],S.h--))}}function ve(S,D,G,Z){for(let Ee=0;Ee<S.length;++Ee){const Ve=S[Ee];if(!Ve.da&&Ve.listener==D&&Ve.capture==!!G&&Ve.ha==Z)return Ee}return-1}var qe="closure_lm_"+(Math.random()*1e6|0),Ke={};function Te(S,D,G,Z,Ee){if(Array.isArray(D)){for(let Ve=0;Ve<D.length;Ve++)Te(S,D[Ve],G,Z,Ee);return null}return G=lr(G),S&&S[Ne]?S.J(D,G,a(Z)?!!Z.capture:!1,Ee):we(S,D,G,!1,Z,Ee)}function we(S,D,G,Z,Ee,Ve){if(!D)throw Error("Invalid event type");const _t=a(Ee)?!!Ee.capture:!!Ee;let Cn=yn(S);if(Cn||(S[qe]=Cn=new ie(S)),G=Cn.add(D,G,Z,_t,Ve),G.proxy)return G;if(Z=Dt(),G.proxy=Z,Z.src=S,Z.listener=G,S.addEventListener)W||(Ee=_t),Ee===void 0&&(Ee=!1),S.addEventListener(D.toString(),Z,Ee);else if(S.attachEvent)S.attachEvent($t(D.toString()),Z);else if(S.addListener&&S.removeListener)S.addListener(Z);else throw Error("addEventListener and attachEvent are unavailable.");return G}function Dt(){function S(G){return D.call(S.src,S.listener,G)}const D=fn;return S}function Ye(S,D,G,Z,Ee){if(Array.isArray(D))for(var Ve=0;Ve<D.length;Ve++)Ye(S,D[Ve],G,Z,Ee);else Z=a(Z)?!!Z.capture:!!Z,G=lr(G),S&&S[Ne]?(S=S.i,Ve=String(D).toString(),Ve in S.g&&(D=S.g[Ve],G=ve(D,G,Z,Ee),G>-1&&(de(D[G]),Array.prototype.splice.call(D,G,1),D.length==0&&(delete S.g[Ve],S.h--)))):S&&(S=yn(S))&&(D=S.g[D.toString()],S=-1,D&&(S=ve(D,G,Z,Ee)),(G=S>-1?D[S]:null)&&sn(G))}function sn(S){if(typeof S!="number"&&S&&!S.da){var D=S.src;if(D&&D[Ne])le(D.i,S);else{var G=S.type,Z=S.proxy;D.removeEventListener?D.removeEventListener(G,Z,S.capture):D.detachEvent?D.detachEvent($t(G),Z):D.addListener&&D.removeListener&&D.removeListener(Z),(G=yn(D))?(le(G,S),G.h==0&&(G.src=null,D[qe]=null)):de(S)}}}function $t(S){return S in Ke?Ke[S]:Ke[S]="on"+S}function fn(S,D){if(S.da)S=!0;else{D=new pe(D,this);const G=S.listener,Z=S.ha||S.src;S.fa&&sn(S),S=G.call(Z,D)}return S}function yn(S){return S=S[qe],S instanceof ie?S:null}var dt="__closure_events_fn_"+(Math.random()*1e9>>>0);function lr(S){return typeof S=="function"?S:(S[dt]||(S[dt]=function(D){return S.handleEvent(D)}),S[dt])}function $n(){j.call(this),this.i=new ie(this),this.M=this,this.G=null}h($n,j),$n.prototype[Ne]=!0,$n.prototype.removeEventListener=function(S,D,G,Z){Ye(this,S,D,G,Z)};function Un(S,D){var G,Z=S.G;if(Z)for(G=[];Z;Z=Z.G)G.push(Z);if(S=S.M,Z=D.type||D,typeof D=="string")D=new V(D,S);else if(D instanceof V)D.target=D.target||S;else{var Ee=D;D=new V(Z,S),ne(D,Ee)}Ee=!0;let Ve,_t;if(G)for(_t=G.length-1;_t>=0;_t--)Ve=D.g=G[_t],Ee=Xr(Ve,Z,!0,D)&&Ee;if(Ve=D.g=S,Ee=Xr(Ve,Z,!0,D)&&Ee,Ee=Xr(Ve,Z,!1,D)&&Ee,G)for(_t=0;_t<G.length;_t++)Ve=D.g=G[_t],Ee=Xr(Ve,Z,!1,D)&&Ee}$n.prototype.N=function(){if($n.Z.N.call(this),this.i){var S=this.i;for(const D in S.g){const G=S.g[D];for(let Z=0;Z<G.length;Z++)de(G[Z]);delete S.g[D],S.h--}}this.G=null},$n.prototype.J=function(S,D,G,Z){return this.i.add(String(S),D,!1,G,Z)},$n.prototype.K=function(S,D,G,Z){return this.i.add(String(S),D,!0,G,Z)};function Xr(S,D,G,Z){if(D=S.i.g[String(D)],!D)return!0;D=D.concat();let Ee=!0;for(let Ve=0;Ve<D.length;++Ve){const _t=D[Ve];if(_t&&!_t.da&&_t.capture==G){const Cn=_t.listener,rs=_t.ha||_t.src;_t.fa&&le(S.i,_t),Ee=Cn.call(rs,Z)!==!1&&Ee}}return Ee&&!Z.defaultPrevented}function po(S,D){if(typeof S!="function")if(S&&typeof S.handleEvent=="function")S=c(S.handleEvent,S);else throw Error("Invalid listener argument");return Number(D)>2147483647?-1:o.setTimeout(S,D||0)}function kr(S){S.g=po(()=>{S.g=null,S.i&&(S.i=!1,kr(S))},S.l);const D=S.h;S.h=null,S.m.apply(null,D)}class Si extends j{constructor(D,G){super(),this.m=D,this.l=G,this.h=null,this.i=!1,this.g=null}j(D){this.h=arguments,this.g?this.i=!0:kr(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rs(S){j.call(this),this.h=S,this.g={}}h(Rs,j);var bt=[];function Yn(S){Oe(S.g,function(D,G){this.g.hasOwnProperty(G)&&sn(D)},S),S.g={}}Rs.prototype.N=function(){Rs.Z.N.call(this),Yn(this)},Rs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=o.JSON.stringify,Ft=o.JSON.parse,On=class{stringify(S){return o.JSON.stringify(S,void 0)}parse(S){return o.JSON.parse(S,void 0)}};function Qt(){}function Oo(){}var Fi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ps(){V.call(this,"d")}h(Ps,V);function Pn(){V.call(this,"c")}h(Pn,V);var Ti={},He=null;function Ie(){return He=He||new $n}Ti.Ia="serverreachability";function Re(S){V.call(this,Ti.Ia,S)}h(Re,V);function rn(S){const D=Ie();Un(D,new Re(D))}Ti.STAT_EVENT="statevent";function z(S,D){V.call(this,Ti.STAT_EVENT,S),this.stat=D}h(z,V);function Et(S){const D=Ie();Un(D,new z(D,S))}Ti.Ja="timingevent";function Y(S,D){V.call(this,Ti.Ja,S),this.size=D}h(Y,V);function ae(S,D){if(typeof S!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){S()},D)}function ze(){this.g=!0}ze.prototype.ua=function(){this.g=!1};function ee(S,D,G,Z,Ee,Ve){S.info(function(){if(S.g)if(Ve){var _t="",Cn=Ve.split("&");for(let Dr=0;Dr<Cn.length;Dr++){var rs=Cn[Dr].split("=");if(rs.length>1){const ds=rs[0];rs=rs[1];const Ml=ds.split("_");_t=Ml.length>=2&&Ml[1]=="type"?_t+(ds+"="+rs+"&"):_t+(ds+"=redacted&")}}}else _t=null;else _t=Ve;return"XMLHTTP REQ ("+Z+") [attempt "+Ee+"]: "+D+`
`+G+`
`+_t})}function ge(S,D,G,Z,Ee,Ve,_t){S.info(function(){return"XMLHTTP RESP ("+Z+") [ attempt "+Ee+"]: "+D+`
`+G+`
`+Ve+" "+_t})}function $e(S,D,G,Z){S.info(function(){return"XMLHTTP TEXT ("+D+"): "+Ue(S,G)+(Z?" "+Z:"")})}function Je(S,D){S.info(function(){return"TIMEOUT: "+D})}ze.prototype.info=function(){};function Ue(S,D){if(!S.g)return D;if(!D)return null;try{const Ve=JSON.parse(D);if(Ve){for(S=0;S<Ve.length;S++)if(Array.isArray(Ve[S])){var G=Ve[S];if(!(G.length<2)){var Z=G[1];if(Array.isArray(Z)&&!(Z.length<1)){var Ee=Z[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(let _t=1;_t<Z.length;_t++)Z[_t]=""}}}}return cr(Ve)}catch{return D}}var nt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},et={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ct;function zt(){}h(zt,Qt),zt.prototype.g=function(){return new XMLHttpRequest},Ct=new zt;function gn(S){return encodeURIComponent(String(S))}function q(S){var D=1;S=S.split(":");const G=[];for(;D>0&&S.length;)G.push(S.shift()),D--;return S.length&&G.push(S.join(":")),G}function re(S,D,G,Z){this.j=S,this.i=D,this.l=G,this.S=Z||1,this.V=new Rs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new J}function J(){this.i=null,this.g="",this.h=!1}var te={},se={};function oe(S,D,G){S.M=1,S.A=jd(gc(D)),S.u=G,S.R=!0,Ce(S,null)}function Ce(S,D){S.F=Date.now(),De(S),S.B=gc(S.A);var G=S.B,Z=S.S;Array.isArray(Z)||(Z=[String(Z)]),bb(G.i,"t",Z),S.C=0,G=S.j.L,S.h=new J,S.g=HI(S.j,G?D:null,!S.u),S.P>0&&(S.O=new Si(c(S.Y,S,S.g),S.P)),D=S.V,G=S.g,Z=S.ba;var Ee="readystatechange";Array.isArray(Ee)||(Ee&&(bt[0]=Ee.toString()),Ee=bt);for(let Ve=0;Ve<Ee.length;Ve++){const _t=Te(G,Ee[Ve],Z||D.handleEvent,!1,D.h||D);if(!_t)break;D.g[_t.key]=_t}D=S.J?Q(S.J):{},S.u?(S.v||(S.v="POST"),D["Content-Type"]="application/x-www-form-urlencoded",S.g.ea(S.B,S.v,S.u,D)):(S.v="GET",S.g.ea(S.B,S.v,null,D)),rn(),ee(S.i,S.v,S.B,S.l,S.S,S.u)}re.prototype.ba=function(S){S=S.target;const D=this.O;D&&bh(S)==3?D.j():this.Y(S)},re.prototype.Y=function(S){try{if(S==this.g)e:{const Cn=bh(this.g),rs=this.g.ya(),Dr=this.g.ca();if(!(Cn<3)&&(Cn!=3||this.g&&(this.h.h||this.g.la()||BI(this.g)))){this.K||Cn!=4||rs==7||(rs==8||Dr<=0?rn(3):rn(2)),gt(this);var D=this.g.ca();this.X=D;var G=Be(this);if(this.o=D==200,ge(this.i,this.v,this.B,this.l,this.S,Cn,D),this.o){if(this.U&&!this.L){t:{if(this.g){var Z,Ee=this.g;if((Z=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Z)){var Ve=Z;break t}}Ve=null}if(S=Ve)$e(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ut(this,S);else{this.o=!1,this.m=3,Et(12),ct(this),Rt(this);break e}}if(this.R){S=!0;let ds;for(;!this.K&&this.C<G.length;)if(ds=Le(this,G),ds==se){Cn==4&&(this.m=4,Et(14),S=!1),$e(this.i,this.l,null,"[Incomplete Response]");break}else if(ds==te){this.m=4,Et(15),$e(this.i,this.l,G,"[Invalid Chunk]"),S=!1;break}else $e(this.i,this.l,ds,null),ut(this,ds);if(Pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cn!=4||G.length!=0||this.h.h||(this.m=1,Et(16),S=!1),this.o=this.o&&S,!S)$e(this.i,this.l,G,"[Invalid Chunked Response]"),ct(this),Rt(this);else if(G.length>0&&!this.W){this.W=!0;var _t=this.j;_t.g==this&&_t.aa&&!_t.P&&(_t.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),c0(_t),_t.P=!0,Et(11))}}else $e(this.i,this.l,G,null),ut(this,G);Cn==4&&ct(this),this.o&&!this.K&&(Cn==4?Ev(this.j,this):(this.o=!1,De(this)))}else Sb(this.g),D==400&&G.indexOf("Unknown SID")>0?(this.m=3,Et(12)):(this.m=0,Et(13)),ct(this),Rt(this)}}}catch{}};function Be(S){if(!Pe(S))return S.g.la();const D=BI(S.g);if(D==="")return"";let G="";const Z=D.length,Ee=bh(S.g)==4;if(!S.h.i){if(typeof TextDecoder>"u")return ct(S),Rt(S),"";S.h.i=new o.TextDecoder}for(let Ve=0;Ve<Z;Ve++)S.h.h=!0,G+=S.h.i.decode(D[Ve],{stream:!(Ee&&Ve==Z-1)});return D.length=0,S.h.g+=G,S.C=0,S.h.g}function Pe(S){return S.g?S.v=="GET"&&S.M!=2&&S.j.Aa:!1}function Le(S,D){var G=S.C,Z=D.indexOf(`
`,G);return Z==-1?se:(G=Number(D.substring(G,Z)),isNaN(G)?te:(Z+=1,Z+G>D.length?se:(D=D.slice(Z,Z+G),S.C=Z+G,D)))}re.prototype.cancel=function(){this.K=!0,ct(this)};function De(S){S.T=Date.now()+S.H,at(S,S.H)}function at(S,D){if(S.D!=null)throw Error("WatchDog timer not null");S.D=ae(c(S.aa,S),D)}function gt(S){S.D&&(o.clearTimeout(S.D),S.D=null)}re.prototype.aa=function(){this.D=null;const S=Date.now();S-this.T>=0?(Je(this.i,this.B),this.M!=2&&(rn(),Et(17)),ct(this),this.m=2,Rt(this)):at(this,this.T-S)};function Rt(S){S.j.I==0||S.K||Ev(S.j,S)}function ct(S){gt(S);var D=S.O;D&&typeof D.dispose=="function"&&D.dispose(),S.O=null,Yn(S.V),S.g&&(D=S.g,S.g=null,D.abort(),D.dispose())}function ut(S,D){try{var G=S.j;if(G.I!=0&&(G.g==S||pu(G.h,S))){if(!S.L&&pu(G.h,S)&&G.I==3){try{var Z=G.Ba.g.parse(D)}catch{Z=null}if(Array.isArray(Z)&&Z.length==3){var Ee=Z;if(Ee[0]==0){e:if(!G.v){if(G.g)if(G.g.F+3e3<S.F)bv(G),Pl(G);else break e;Th(G),Et(18)}}else G.xa=Ee[1],0<G.xa-G.K&&Ee[2]<37500&&G.F&&G.A==0&&!G.C&&(G.C=ae(c(G.Va,G),6e3));mi(G.h)<=1&&G.ta&&(G.ta=void 0)}else Cl(G,11)}else if((S.L||G.g==S)&&bv(G),!U(D))for(Ee=G.Ba.g.parse(D),D=0;D<Ee.length;D++){let Dr=Ee[D];const ds=Dr[0];if(!(ds<=G.K))if(G.K=ds,Dr=Dr[1],G.I==2)if(Dr[0]=="c"){G.M=Dr[1],G.ba=Dr[2];const Ml=Dr[3];Ml!=null&&(G.ka=Ml,G.j.info("VER="+G.ka));const Gd=Dr[4];Gd!=null&&(G.za=Gd,G.j.info("SVER="+G.za));const kh=Dr[5];kh!=null&&typeof kh=="number"&&kh>0&&(Z=1.5*kh,G.O=Z,G.j.info("backChannelRequestTimeoutMs_="+Z)),Z=G;const Ah=S.g;if(Ah){const kv=Ah.g?Ah.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kv){var Ve=Z.h;Ve.g||kv.indexOf("spdy")==-1&&kv.indexOf("quic")==-1&&kv.indexOf("h2")==-1||(Ve.j=Ve.l,Ve.g=new Set,Ve.h&&(mc(Ve,Ve.h),Ve.h=null))}if(Z.G){const Ab=Ah.g?Ah.g.getResponseHeader("X-HTTP-Session-Id"):null;Ab&&(Z.wa=Ab,yr(Z.J,Z.G,Ab))}}G.I=3,G.l&&G.l.ra(),G.aa&&(G.T=Date.now()-S.F,G.j.info("Handshake RTT: "+G.T+"ms")),Z=G;var _t=S;if(Z.na=kb(Z,Z.L?Z.ba:null,Z.W),_t.L){Il(Z.h,_t);var Cn=_t,rs=Z.O;rs&&(Cn.H=rs),Cn.D&&(gt(Cn),De(Cn)),Z.g=_t}else Lo(Z);G.i.length>0&&Ud(G)}else Dr[0]!="stop"&&Dr[0]!="close"||Cl(G,7);else G.I==3&&(Dr[0]=="stop"||Dr[0]=="close"?Dr[0]=="stop"?Cl(G,7):xv(G):Dr[0]!="noop"&&G.l&&G.l.qa(Dr),G.A=0)}}rn(4)}catch{}}var wn=class{constructor(S,D){this.g=S,this.map=D}};function Ar(S){this.l=S||10,o.PerformanceNavigationTiming?(S=o.performance.getEntriesByType("navigation"),S=S.length>0&&(S[0].nextHopProtocol=="hq"||S[0].nextHopProtocol=="h2")):S=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=S?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lr(S){return S.h?!0:S.g?S.g.size>=S.j:!1}function mi(S){return S.h?1:S.g?S.g.size:0}function pu(S,D){return S.h?S.h==D:S.g?S.g.has(D):!1}function mc(S,D){S.g?S.g.add(D):S.h=D}function Il(S,D){S.h&&S.h==D?S.h=null:S.g&&S.g.has(D)&&S.g.delete(D)}Ar.prototype.cancel=function(){if(this.i=ns(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const S of this.g.values())S.cancel();this.g.clear()}};function ns(S){if(S.h!=null)return S.i.concat(S.h.G);if(S.g!=null&&S.g.size!==0){let D=S.i;for(const G of S.g.values())D=D.concat(G.G);return D}return g(S.i)}var Tp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ki(S,D){if(S){S=S.split("&");for(let G=0;G<S.length;G++){const Z=S[G].indexOf("=");let Ee,Ve=null;Z>=0?(Ee=S[G].substring(0,Z),Ve=S[G].substring(Z+1)):Ee=S[G],D(Ee,Ve?decodeURIComponent(Ve.replace(/\+/g," ")):"")}}}function gh(S){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let D;S instanceof gh?(this.l=S.l,r0(this,S.j),this.o=S.o,this.g=S.g,yh(this,S.u),this.h=S.h,kp(this,Eb(S.i)),this.m=S.m):S&&(D=String(S).match(Tp))?(this.l=!1,r0(this,D[1]||"",!0),this.o=i0(D[2]||""),this.g=i0(D[3]||"",!0),yh(this,D[4]),this.h=i0(D[5]||"",!0),kp(this,D[6]||"",!0),this.m=i0(D[7]||"")):(this.l=!1,this.i=new nr(null,this.l))}gh.prototype.toString=function(){const S=[];var D=this.j;D&&S.push(s0(D,yb,!0),":");var G=this.g;return(G||D=="file")&&(S.push("//"),(D=this.o)&&S.push(s0(D,yb,!0),"@"),S.push(gn(G).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),G=this.u,G!=null&&S.push(":",String(G))),(G=this.h)&&(this.g&&G.charAt(0)!="/"&&S.push("/"),S.push(s0(G,G.charAt(0)=="/"?o0:vb,!0))),(G=this.i.toString())&&S.push("?",G),(G=this.m)&&S.push("#",s0(G,_b)),S.join("")},gh.prototype.resolve=function(S){const D=gc(this);let G=!!S.j;G?r0(D,S.j):G=!!S.o,G?D.o=S.o:G=!!S.g,G?D.g=S.g:G=S.u!=null;var Z=S.h;if(G)yh(D,S.u);else if(G=!!S.h){if(Z.charAt(0)!="/")if(this.g&&!this.h)Z="/"+Z;else{var Ee=D.h.lastIndexOf("/");Ee!=-1&&(Z=D.h.slice(0,Ee+1)+Z)}if(Ee=Z,Ee==".."||Ee==".")Z="";else if(Ee.indexOf("./")!=-1||Ee.indexOf("/.")!=-1){Z=Ee.lastIndexOf("/",0)==0,Ee=Ee.split("/");const Ve=[];for(let _t=0;_t<Ee.length;){const Cn=Ee[_t++];Cn=="."?Z&&_t==Ee.length&&Ve.push(""):Cn==".."?((Ve.length>1||Ve.length==1&&Ve[0]!="")&&Ve.pop(),Z&&_t==Ee.length&&Ve.push("")):(Ve.push(Cn),Z=!0)}Z=Ve.join("/")}else Z=Ee}return G?D.h=Z:G=S.i.toString()!=="",G?kp(D,Eb(S.i)):G=!!S.m,G&&(D.m=S.m),D};function gc(S){return new gh(S)}function r0(S,D,G){S.j=G?i0(D,!0):D,S.j&&(S.j=S.j.replace(/:$/,""))}function yh(S,D){if(D){if(D=Number(D),isNaN(D)||D<0)throw Error("Bad port number "+D);S.u=D}else S.u=null}function kp(S,D,G){D instanceof nr?(S.i=D,yv(S.i,S.l)):(G||(D=s0(D,pL)),S.i=new nr(D,S.l))}function yr(S,D,G){S.i.set(D,G)}function jd(S){return yr(S,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),S}function i0(S,D){return S?D?decodeURI(S.replace(/%25/g,"%2525")):decodeURIComponent(S):""}function s0(S,D,G){return typeof S=="string"?(S=encodeURI(S).replace(D,gb),G&&(S=S.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S):null}function gb(S){return S=S.charCodeAt(0),"%"+(S>>4&15).toString(16)+(S&15).toString(16)}var yb=/[#\/\?@]/g,vb=/[#\?:]/g,o0=/[#\?]/g,pL=/[#\?@]/g,_b=/#/g;function nr(S,D){this.h=this.g=null,this.i=S||null,this.j=!!D}function vh(S){S.g||(S.g=new Map,S.h=0,S.i&&ki(S.i,function(D,G){S.add(decodeURIComponent(D.replace(/\+/g," ")),G)}))}t=nr.prototype,t.add=function(S,D){vh(this),this.i=null,S=_h(this,S);let G=this.g.get(S);return G||this.g.set(S,G=[]),G.push(D),this.h+=1,this};function xb(S,D){vh(S),D=_h(S,D),S.g.has(D)&&(S.i=null,S.h-=S.g.get(D).length,S.g.delete(D))}function gv(S,D){return vh(S),D=_h(S,D),S.g.has(D)}t.forEach=function(S,D){vh(this),this.g.forEach(function(G,Z){G.forEach(function(Ee){S.call(D,Ee,Z,this)},this)},this)};function wb(S,D){vh(S);let G=[];if(typeof D=="string")gv(S,D)&&(G=G.concat(S.g.get(_h(S,D))));else for(S=Array.from(S.g.values()),D=0;D<S.length;D++)G=G.concat(S[D]);return G}t.set=function(S,D){return vh(this),this.i=null,S=_h(this,S),gv(this,S)&&(this.h-=this.g.get(S).length),this.g.set(S,[D]),this.h+=1,this},t.get=function(S,D){return S?(S=wb(this,S),S.length>0?String(S[0]):D):D};function bb(S,D,G){xb(S,D),G.length>0&&(S.i=null,S.g.set(_h(S,D),g(G)),S.h+=G.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const S=[],D=Array.from(this.g.keys());for(let Z=0;Z<D.length;Z++){var G=D[Z];const Ee=gn(G);G=wb(this,G);for(let Ve=0;Ve<G.length;Ve++){let _t=Ee;G[Ve]!==""&&(_t+="="+gn(G[Ve])),S.push(_t)}}return this.i=S.join("&")};function Eb(S){const D=new nr;return D.i=S.i,S.g&&(D.g=new Map(S.g),D.h=S.h),D}function _h(S,D){return D=String(D),S.j&&(D=D.toLowerCase()),D}function yv(S,D){D&&!S.j&&(vh(S),S.i=null,S.g.forEach(function(G,Z){const Ee=Z.toLowerCase();Z!=Ee&&(xb(this,Z),bb(this,Ee,G))},S)),S.j=D}function xh(S,D){const G=new ze;if(o.Image){const Z=new Image;Z.onload=u(mo,G,"TestLoadImage: loaded",!0,D,Z),Z.onerror=u(mo,G,"TestLoadImage: error",!1,D,Z),Z.onabort=u(mo,G,"TestLoadImage: abort",!1,D,Z),Z.ontimeout=u(mo,G,"TestLoadImage: timeout",!1,D,Z),o.setTimeout(function(){Z.ontimeout&&Z.ontimeout()},1e4),Z.src=S}else D(!1)}function wh(S,D){const G=new ze,Z=new AbortController,Ee=setTimeout(()=>{Z.abort(),mo(G,"TestPingServer: timeout",!1,D)},1e4);fetch(S,{signal:Z.signal}).then(Ve=>{clearTimeout(Ee),Ve.ok?mo(G,"TestPingServer: ok",!0,D):mo(G,"TestPingServer: server error",!1,D)}).catch(()=>{clearTimeout(Ee),mo(G,"TestPingServer: error",!1,D)})}function mo(S,D,G,Z,Ee){try{Ee&&(Ee.onload=null,Ee.onerror=null,Ee.onabort=null,Ee.ontimeout=null),Z(G)}catch{}}function a0(){this.g=new On}function Fd(S){this.i=S.Sb||null,this.h=S.ab||!1}h(Fd,Qt),Fd.prototype.g=function(){return new Rl(this.i,this.h)};function Rl(S,D){$n.call(this),this.H=S,this.o=D,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Rl,$n),t=Rl.prototype,t.open=function(S,D){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=S,this.D=D,this.readyState=1,mu(this)},t.send=function(S){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const D={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};S&&(D.body=S),(this.H||o).fetch(new Request(this.D,D)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ap(this)),this.readyState=0},t.Pa=function(S){if(this.g&&(this.l=S,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=S.headers,this.readyState=2,mu(this)),this.g&&(this.readyState=3,mu(this),this.g)))if(this.responseType==="arraybuffer")S.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in S){if(this.j=S.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;zI(this)}else S.text().then(this.Oa.bind(this),this.ga.bind(this))};function zI(S){S.j.read().then(S.Ma.bind(S)).catch(S.ga.bind(S))}t.Ma=function(S){if(this.g){if(this.o&&S.value)this.response.push(S.value);else if(!this.o){var D=S.value?S.value:new Uint8Array(0);(D=this.B.decode(D,{stream:!S.done}))&&(this.response=this.responseText+=D)}S.done?Ap(this):mu(this),this.readyState==3&&zI(this)}},t.Oa=function(S){this.g&&(this.response=this.responseText=S,Ap(this))},t.Na=function(S){this.g&&(this.response=S,Ap(this))},t.ga=function(){this.g&&Ap(this)};function Ap(S){S.readyState=4,S.l=null,S.j=null,S.B=null,mu(S)}t.setRequestHeader=function(S,D){this.A.append(S,D)},t.getResponseHeader=function(S){return this.h&&this.h.get(S.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const S=[],D=this.h.entries();for(var G=D.next();!G.done;)G=G.value,S.push(G[0]+": "+G[1]),G=D.next();return S.join(`\r
`)};function mu(S){S.onreadystatechange&&S.onreadystatechange.call(S)}Object.defineProperty(Rl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(S){this.m=S?"include":"same-origin"}});function UI(S){let D="";return Oe(S,function(G,Z){D+=Z,D+=":",D+=G,D+=`\r
`}),D}function vv(S,D,G){e:{for(Z in G){var Z=!1;break e}Z=!0}Z||(G=UI(G),typeof S=="string"?G!=null&&gn(G):yr(S,D,G))}function Zr(S){$n.call(this),this.headers=new Map,this.L=S||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Zr,$n);var GI=/^https?$/i,mL=["POST","PUT"];t=Zr.prototype,t.Fa=function(S){this.H=S},t.ea=function(S,D,G,Z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+S);D=D?D.toUpperCase():"GET",this.D=S,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ct.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(D,String(S),!0),this.B=!1}catch(Ve){Ip(this,Ve);return}if(S=G||"",G=new Map(this.headers),Z)if(Object.getPrototypeOf(Z)===Object.prototype)for(var Ee in Z)G.set(Ee,Z[Ee]);else if(typeof Z.keys=="function"&&typeof Z.get=="function")for(const Ve of Z.keys())G.set(Ve,Z.get(Ve));else throw Error("Unknown input type for opt_headers: "+String(Z));Z=Array.from(G.keys()).find(Ve=>Ve.toLowerCase()=="content-type"),Ee=o.FormData&&S instanceof o.FormData,!(Array.prototype.indexOf.call(mL,D,void 0)>=0)||Z||Ee||G.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ve,_t]of G)this.g.setRequestHeader(Ve,_t);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(S),this.v=!1}catch(Ve){Ip(this,Ve)}};function Ip(S,D){S.h=!1,S.g&&(S.j=!0,S.g.abort(),S.j=!1),S.l=D,S.o=5,Rp(S),zd(S)}function Rp(S){S.A||(S.A=!0,Un(S,"complete"),Un(S,"error"))}t.abort=function(S){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=S||7,Un(this,"complete"),Un(this,"abort"),zd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zd(this,!0)),Zr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Vd(this):this.Xa())},t.Xa=function(){Vd(this)};function Vd(S){if(S.h&&typeof s<"u"){if(S.v&&bh(S)==4)setTimeout(S.Ca.bind(S),0);else if(Un(S,"readystatechange"),bh(S)==4){S.h=!1;try{const Ve=S.ca();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var D=!0;break e;default:D=!1}var G;if(!(G=D)){var Z;if(Z=Ve===0){let _t=String(S.D).match(Tp)[1]||null;!_t&&o.self&&o.self.location&&(_t=o.self.location.protocol.slice(0,-1)),Z=!GI.test(_t?_t.toLowerCase():"")}G=Z}if(G)Un(S,"complete"),Un(S,"success");else{S.o=6;try{var Ee=bh(S)>2?S.g.statusText:""}catch{Ee=""}S.l=Ee+" ["+S.ca()+"]",Rp(S)}}finally{zd(S)}}}}function zd(S,D){if(S.g){S.m&&(clearTimeout(S.m),S.m=null);const G=S.g;S.g=null,D||Un(S,"ready");try{G.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function bh(S){return S.g?S.g.readyState:0}t.ca=function(){try{return bh(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(S){if(this.g){var D=this.g.responseText;return S&&D.indexOf(S)==0&&(D=D.substring(S.length)),Ft(D)}};function BI(S){try{if(!S.g)return null;if("response"in S.g)return S.g.response;switch(S.F){case"":case"text":return S.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in S.g)return S.g.mozResponseArrayBuffer}return null}catch{return null}}function Sb(S){const D={};S=(S.g&&bh(S)>=2&&S.g.getAllResponseHeaders()||"").split(`\r
`);for(let Z=0;Z<S.length;Z++){if(U(S[Z]))continue;var G=q(S[Z]);const Ee=G[0];if(G=G[1],typeof G!="string")continue;G=G.trim();const Ve=D[Ee]||[];D[Ee]=Ve,Ve.push(G)}Ae(D,function(Z){return Z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Eh(S,D,G){return G&&G.internalChannelParams&&G.internalChannelParams[S]||D}function _v(S){this.za=0,this.i=[],this.j=new ze,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Eh("failFast",!1,S),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Eh("baseRetryDelayMs",5e3,S),this.Za=Eh("retryDelaySeedMs",1e4,S),this.Ta=Eh("forwardChannelMaxRetries",2,S),this.va=Eh("forwardChannelRequestTimeoutMs",2e4,S),this.ma=S&&S.xmlHttpFactory||void 0,this.Ua=S&&S.Rb||void 0,this.Aa=S&&S.useFetchStreams||!1,this.O=void 0,this.L=S&&S.supportsCrossDomainXhr||!1,this.M="",this.h=new Ar(S&&S.concurrentRequestLimit),this.Ba=new a0,this.S=S&&S.fastHandshake||!1,this.R=S&&S.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=S&&S.Pb||!1,S&&S.ua&&this.j.ua(),S&&S.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&S&&S.detectBufferingProxy||!1,this.ia=void 0,S&&S.longPollingTimeout&&S.longPollingTimeout>0&&(this.ia=S.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=_v.prototype,t.ka=8,t.I=1,t.connect=function(S,D,G,Z){Et(0),this.W=S,this.H=D||{},G&&Z!==void 0&&(this.H.OSID=G,this.H.OAID=Z),this.F=this.X,this.J=kb(this,null,this.W),Ud(this)};function xv(S){if(wv(S),S.I==3){var D=S.V++,G=gc(S.J);if(yr(G,"SID",S.M),yr(G,"RID",D),yr(G,"TYPE","terminate"),Sh(S,G),D=new re(S,S.j,D),D.M=2,D.A=jd(gc(G)),G=!1,o.navigator&&o.navigator.sendBeacon)try{G=o.navigator.sendBeacon(D.A.toString(),"")}catch{}!G&&o.Image&&(new Image().src=D.A,G=!0),G||(D.g=HI(D.j,null),D.g.ea(D.A)),D.F=Date.now(),De(D)}u0(S)}function Pl(S){S.g&&(c0(S),S.g.cancel(),S.g=null)}function wv(S){Pl(S),S.v&&(o.clearTimeout(S.v),S.v=null),bv(S),S.h.cancel(),S.m&&(typeof S.m=="number"&&o.clearTimeout(S.m),S.m=null)}function Ud(S){if(!Lr(S.h)&&!S.m){S.m=!0;var D=S.Ea;M||N(),F||(M(),F=!0),C.add(D,S),S.D=0}}function WI(S,D){return mi(S.h)>=S.h.j-(S.m?1:0)?!1:S.m?(S.i=D.G.concat(S.i),!0):S.I==1||S.I==2||S.D>=(S.Sa?0:S.Ta)?!1:(S.m=ae(c(S.Ea,S,D),Sv(S,S.D)),S.D++,!0)}t.Ea=function(S){if(this.m)if(this.m=null,this.I==1){if(!S){this.V=Math.floor(Math.random()*1e5),S=this.V++;const Ee=new re(this,this.j,S);let Ve=this.o;if(this.U&&(Ve?(Ve=Q(Ve),ne(Ve,this.U)):Ve=this.U),this.u!==null||this.R||(Ee.J=Ve,Ve=null),this.S)e:{for(var D=0,G=0;G<this.i.length;G++){t:{var Z=this.i[G];if("__data__"in Z.map&&(Z=Z.map.__data__,typeof Z=="string")){Z=Z.length;break t}Z=void 0}if(Z===void 0)break;if(D+=Z,D>4096){D=G;break e}if(D===4096||G===this.i.length-1){D=G+1;break e}}D=1e3}else D=1e3;D=Tb(this,Ee,D),G=gc(this.J),yr(G,"RID",S),yr(G,"CVER",22),this.G&&yr(G,"X-HTTP-Session-Id",this.G),Sh(this,G),Ve&&(this.R?D="headers="+gn(UI(Ve))+"&"+D:this.u&&vv(G,this.u,Ve)),mc(this.h,Ee),this.Ra&&yr(G,"TYPE","init"),this.S?(yr(G,"$req",D),yr(G,"SID","null"),Ee.U=!0,oe(Ee,G,null)):oe(Ee,G,D),this.I=2}}else this.I==3&&(S?l0(this,S):this.i.length==0||Lr(this.h)||l0(this))};function l0(S,D){var G;D?G=D.l:G=S.V++;const Z=gc(S.J);yr(Z,"SID",S.M),yr(Z,"RID",G),yr(Z,"AID",S.K),Sh(S,Z),S.u&&S.o&&vv(Z,S.u,S.o),G=new re(S,S.j,G,S.D+1),S.u===null&&(G.J=S.o),D&&(S.i=D.G.concat(S.i)),D=Tb(S,G,1e3),G.H=Math.round(S.va*.5)+Math.round(S.va*.5*Math.random()),mc(S.h,G),oe(G,Z,D)}function Sh(S,D){S.H&&Oe(S.H,function(G,Z){yr(D,Z,G)}),S.l&&Oe({},function(G,Z){yr(D,Z,G)})}function Tb(S,D,G){G=Math.min(S.i.length,G);const Z=S.l?c(S.l.Ka,S.l,S):null;e:{var Ee=S.i;let Cn=-1;for(;;){const rs=["count="+G];Cn==-1?G>0?(Cn=Ee[0].g,rs.push("ofs="+Cn)):Cn=0:rs.push("ofs="+Cn);let Dr=!0;for(let ds=0;ds<G;ds++){var Ve=Ee[ds].g;const Ml=Ee[ds].map;if(Ve-=Cn,Ve<0)Cn=Math.max(0,Ee[ds].g-100),Dr=!1;else try{Ve="req"+Ve+"_"||"";try{var _t=Ml instanceof Map?Ml:Object.entries(Ml);for(const[Gd,kh]of _t){let Ah=kh;a(kh)&&(Ah=cr(kh)),rs.push(Ve+Gd+"="+encodeURIComponent(Ah))}}catch(Gd){throw rs.push(Ve+"type="+encodeURIComponent("_badmap")),Gd}}catch{Z&&Z(Ml)}}if(Dr){_t=rs.join("&");break e}}_t=void 0}return S=S.i.splice(0,G),D.G=S,_t}function Lo(S){if(!S.g&&!S.v){S.Y=1;var D=S.Da;M||N(),F||(M(),F=!0),C.add(D,S),S.A=0}}function Th(S){return S.g||S.v||S.A>=3?!1:(S.Y++,S.v=ae(c(S.Da,S),Sv(S,S.A)),S.A++,!0)}t.Da=function(){if(this.v=null,Pp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var S=4*this.T;this.j.info("BP detection timer enabled: "+S),this.B=ae(c(this.Wa,this),S)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Et(10),Pl(this),Pp(this))};function c0(S){S.B!=null&&(o.clearTimeout(S.B),S.B=null)}function Pp(S){S.g=new re(S,S.j,"rpc",S.Y),S.u===null&&(S.g.J=S.o),S.g.P=0;var D=gc(S.na);yr(D,"RID","rpc"),yr(D,"SID",S.M),yr(D,"AID",S.K),yr(D,"CI",S.F?"0":"1"),!S.F&&S.ia&&yr(D,"TO",S.ia),yr(D,"TYPE","xmlhttp"),Sh(S,D),S.u&&S.o&&vv(D,S.u,S.o),S.O&&(S.g.H=S.O);var G=S.g;S=S.ba,G.M=1,G.A=jd(gc(D)),G.u=null,G.R=!0,Ce(G,S)}t.Va=function(){this.C!=null&&(this.C=null,Pl(this),Th(this),Et(19))};function bv(S){S.C!=null&&(o.clearTimeout(S.C),S.C=null)}function Ev(S,D){var G=null;if(S.g==D){bv(S),c0(S),S.g=null;var Z=2}else if(pu(S.h,D))G=D.G,Il(S.h,D),Z=1;else return;if(S.I!=0){if(D.o)if(Z==1){G=D.u?D.u.length:0,D=Date.now()-D.F;var Ee=S.D;Z=Ie(),Un(Z,new Y(Z,G)),Ud(S)}else Lo(S);else if(Ee=D.m,Ee==3||Ee==0&&D.X>0||!(Z==1&&WI(S,D)||Z==2&&Th(S)))switch(G&&G.length>0&&(D=S.h,D.i=D.i.concat(G)),Ee){case 1:Cl(S,5);break;case 4:Cl(S,10);break;case 3:Cl(S,6);break;default:Cl(S,2)}}}function Sv(S,D){let G=S.Qa+Math.floor(Math.random()*S.Za);return S.isActive()||(G*=2),G*D}function Cl(S,D){if(S.j.info("Error code "+D),D==2){var G=c(S.bb,S),Z=S.Ua;const Ee=!Z;Z=new gh(Z||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||r0(Z,"https"),jd(Z),Ee?xh(Z.toString(),G):wh(Z.toString(),G)}else Et(2);S.I=0,S.l&&S.l.pa(D),u0(S),wv(S)}t.bb=function(S){S?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function u0(S){if(S.I=0,S.ja=[],S.l){const D=ns(S.h);(D.length!=0||S.i.length!=0)&&(v(S.ja,D),v(S.ja,S.i),S.h.i.length=0,g(S.i),S.i.length=0),S.l.oa()}}function kb(S,D,G){var Z=G instanceof gh?gc(G):new gh(G);if(Z.g!="")D&&(Z.g=D+"."+Z.g),yh(Z,Z.u);else{var Ee=o.location;Z=Ee.protocol,D=D?D+"."+Ee.hostname:Ee.hostname,Ee=+Ee.port;const Ve=new gh(null);Z&&r0(Ve,Z),D&&(Ve.g=D),Ee&&yh(Ve,Ee),G&&(Ve.h=G),Z=Ve}return G=S.G,D=S.wa,G&&D&&yr(Z,G,D),yr(Z,"VER",S.ka),Sh(S,Z),Z}function HI(S,D,G){if(D&&!S.L)throw Error("Can't create secondary domain capable XhrIo object.");return D=S.Aa&&!S.ma?new Zr(new Fd({ab:G})):new Zr(S.ma),D.Fa(S.L),D}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function qI(){}t=qI.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Tv(){}Tv.prototype.g=function(S,D){return new go(S,D)};function go(S,D){$n.call(this),this.g=new _v(D),this.l=S,this.h=D&&D.messageUrlParams||null,S=D&&D.messageHeaders||null,D&&D.clientProtocolHeaderRequired&&(S?S["X-Client-Protocol"]="webchannel":S={"X-Client-Protocol":"webchannel"}),this.g.o=S,S=D&&D.initMessageHeaders||null,D&&D.messageContentType&&(S?S["X-WebChannel-Content-Type"]=D.messageContentType:S={"X-WebChannel-Content-Type":D.messageContentType}),D&&D.sa&&(S?S["X-WebChannel-Client-Profile"]=D.sa:S={"X-WebChannel-Client-Profile":D.sa}),this.g.U=S,(S=D&&D.Qb)&&!U(S)&&(this.g.u=S),this.A=D&&D.supportsCrossDomainXhr||!1,this.v=D&&D.sendRawJson||!1,(D=D&&D.httpSessionIdParam)&&!U(D)&&(this.g.G=D,S=this.h,S!==null&&D in S&&(S=this.h,D in S&&delete S[D])),this.j=new Cp(this)}h(go,$n),go.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},go.prototype.close=function(){xv(this.g)},go.prototype.o=function(S){var D=this.g;if(typeof S=="string"){var G={};G.__data__=S,S=G}else this.v&&(G={},G.__data__=cr(S),S=G);D.i.push(new wn(D.Ya++,S)),D.I==3&&Ud(D)},go.prototype.N=function(){this.g.l=null,delete this.j,xv(this.g),delete this.g,go.Z.N.call(this)};function KI(S){Ps.call(this),S.__headers__&&(this.headers=S.__headers__,this.statusCode=S.__status__,delete S.__headers__,delete S.__status__);var D=S.__sm__;if(D){e:{for(const G in D){S=G;break e}S=void 0}(this.i=S)&&(S=this.i,D=D!==null&&S in D?D[S]:void 0),this.data=D}else this.data=S}h(KI,Ps);function YI(){Pn.call(this),this.status=1}h(YI,Pn);function Cp(S){this.g=S}h(Cp,qI),Cp.prototype.ra=function(){Un(this.g,"a")},Cp.prototype.qa=function(S){Un(this.g,new KI(S))},Cp.prototype.pa=function(S){Un(this.g,new YI)},Cp.prototype.oa=function(){Un(this.g,"b")},Tv.prototype.createWebChannel=Tv.prototype.g,go.prototype.send=go.prototype.o,go.prototype.open=go.prototype.m,go.prototype.close=go.prototype.close,Lce=function(){return new Tv},Oce=function(){return Ie()},Nce=Ti,Pj={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,IC=nt,et.COMPLETE="complete",Mce=et,Oo.EventType=Fi,Fi.OPEN="a",Fi.CLOSE="b",Fi.ERROR="c",Fi.MESSAGE="d",$n.prototype.listen=$n.prototype.J,GE=Oo,Zr.prototype.listenOnce=Zr.prototype.K,Zr.prototype.getLastError=Zr.prototype.Ha,Zr.prototype.getLastErrorCode=Zr.prototype.ya,Zr.prototype.getStatus=Zr.prototype.ca,Zr.prototype.getResponseJson=Zr.prototype.La,Zr.prototype.getResponseText=Zr.prototype.la,Zr.prototype.send=Zr.prototype.ea,Zr.prototype.setWithCredentials=Zr.prototype.Fa,Cce=Zr}).apply(typeof iP<"u"?iP:typeof self<"u"?self:typeof window<"u"?window:{});const gZ="@firebase/firestore",yZ="4.9.3";let Ao=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ao.UNAUTHENTICATED=new Ao(null),Ao.GOOGLE_CREDENTIALS=new Ao("google-credentials-uid"),Ao.FIRST_PARTY=new Ao("first-party-uid"),Ao.MOCK_USER=new Ao("mock-user");let $2="12.7.0";const x1=new lU("@firebase/firestore");function C_(){return x1.logLevel}function ft(t,...e){if(x1.logLevel<=Jn.DEBUG){const n=e.map(xU);x1.debug(`Firestore (${$2}): ${t}`,...n)}}function Ra(t,...e){if(x1.logLevel<=Jn.ERROR){const n=e.map(xU);x1.error(`Firestore (${$2}): ${t}`,...n)}}function w1(t,...e){if(x1.logLevel<=Jn.WARN){const n=e.map(xU);x1.warn(`Firestore (${$2}): ${t}`,...n)}}function xU(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ht(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Dce(t,r,n)}function Dce(t,e,n){let r=`FIRESTORE (${$2}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ra(r),new Error(r)}function nn(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||Dce(e,i,r)}function Rn(t,e){return t}const We={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class St extends Ld{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class hd{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class $ce{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class T4e{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Ao.UNAUTHENTICATED)))}shutdown(){}}class k4e{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class A4e{constructor(e){this.t=e,this.currentUser=Ao.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){nn(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new hd;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new hd,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},a=l=>{ft("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ft("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new hd)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(ft("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nn(typeof r.accessToken=="string",31837,{l:r}),new $ce(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nn(e===null||typeof e=="string",2055,{h:e}),new Ao(e)}}class I4e{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Ao.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class R4e{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new I4e(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Ao.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P4e{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ec(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){nn(this.o===void 0,3512);const r=s=>{s.error!=null&&ft("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ft("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{ft("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ft("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vZ(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(nn(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new vZ(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function C4e(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class wU{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=C4e(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function In(t,e){return t<e?-1:t>e?1:0}function Cj(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return O6(i)===O6(s)?In(i,s):O6(i)?1:-1}return In(t.length,e.length)}const M4e=55296,N4e=57343;function O6(t){const e=t.charCodeAt(0);return e>=M4e&&e<=N4e}function Vw(t,e,n){return t.length===e.length&&t.every(((r,i)=>n(r,e[i])))}function jce(t){return t+"\0"}const _Z="__name__";class qh{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ht(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ht(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return qh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qh?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=qh.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return In(e.length,n.length)}static compareSegments(e,n){const r=qh.isNumericId(e),i=qh.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?qh.extractNumericId(e).compare(qh.extractNumericId(n)):Cj(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hg.fromString(e.substring(4,e.length-2))}}class Er extends qh{construct(e,n,r){return new Er(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new St(We.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((i=>i.length>0)))}return new Er(n)}static emptyPath(){return new Er([])}}const O4e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ni extends qh{construct(e,n,r){return new Ni(e,n,r)}static isValidIdentifier(e){return O4e.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ni.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_Z}static keyField(){return new Ni([_Z])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new St(We.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new St(We.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new St(We.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new St(We.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ni(n)}static emptyPath(){return new Ni([])}}class kt{constructor(e){this.path=e}static fromPath(e){return new kt(Er.fromString(e))}static fromName(e){return new kt(Er.fromString(e).popFirst(5))}static empty(){return new kt(Er.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Er.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Er.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new kt(new Er(e.slice()))}}function Fce(t,e,n){if(!n)throw new St(We.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function L4e(t,e,n,r){if(e===!0&&r===!0)throw new St(We.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function xZ(t){if(!kt.isDocumentKey(t))throw new St(We.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function wZ(t){if(kt.isDocumentKey(t))throw new St(We.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vce(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function v5(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ht(12329,{type:typeof t})}function au(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new St(We.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=v5(t);throw new St(We.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Ss(t,e){const n={typeString:t};return e&&(n.value=e),n}function jA(t,e){if(!Vce(t))throw new St(We.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new St(We.INVALID_ARGUMENT,n);return!0}const bZ=-62135596800,EZ=1e6;class Vr{static now(){return Vr.fromMillis(Date.now())}static fromDate(e){return Vr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*EZ);return new Vr(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new St(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new St(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<bZ)throw new St(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new St(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/EZ}_compareTo(e){return this.seconds===e.seconds?In(this.nanoseconds,e.nanoseconds):In(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(jA(e,Vr._jsonSchema))return new Vr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-bZ;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vr._jsonSchemaVersion="firestore/timestamp/1.0",Vr._jsonSchema={type:Ss("string",Vr._jsonSchemaVersion),seconds:Ss("number"),nanoseconds:Ss("number")};class on{static fromTimestamp(e){return new on(e)}static min(){return new on(new Vr(0,0))}static max(){return new on(new Vr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ak=-1;class O3{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Mj(t){return t.fields.find((e=>e.kind===2))}function V0(t){return t.fields.filter((e=>e.kind!==2))}O3.UNKNOWN_ID=-1;class RC{constructor(e,n){this.fieldPath=e,this.kind=n}}class lk{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new lk(0,cc.min())}}function D4e(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=on.fromTimestamp(r===1e9?new Vr(n+1,0):new Vr(n,r));return new cc(i,kt.empty(),e)}function zce(t){return new cc(t.readTime,t.key,ak)}class cc{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new cc(on.min(),kt.empty(),ak)}static max(){return new cc(on.max(),kt.empty(),ak)}}function bU(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=kt.comparator(t.documentKey,e.documentKey),n!==0?n:In(t.largestBatchId,e.largestBatchId))}const Uce="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Gce{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ev(t){if(t.code!==We.FAILED_PRECONDITION||t.message!==Uce)throw t;ft("LocalStore","Unexpectedly lost primary lease")}class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ht(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new xe(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof xe?n:xe.resolve(n)}catch(n){return xe.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):xe.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):xe.reject(n)}static resolve(e){return new xe(((n,r)=>{n(e)}))}static reject(e){return new xe(((n,r)=>{r(e)}))}static waitFor(e){return new xe(((n,r)=>{let i=0,s=0,o=!1;e.forEach((a=>{++i,a.next((()=>{++s,o&&s===i&&n()}),(l=>r(l)))})),o=!0,s===i&&n()}))}static or(e){let n=xe.resolve(!1);for(const r of e)n=n.next((i=>i?xe.resolve(i):r()));return n}static forEach(e,n){const r=[];return e.forEach(((i,s)=>{r.push(n.call(this,i,s))})),this.waitFor(r)}static mapArray(e,n){return new xe(((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next((u=>{o[c]=u,++a,a===s&&r(o)}),(u=>i(u)))}}))}static doWhile(e,n){return new xe(((r,i)=>{const s=()=>{e()===!0?n().next((()=>{s()}),i):r()};s()}))}}const ql="SimpleDb";class _5{static open(e,n,r,i){try{return new _5(n,e.transaction(i,r))}catch(s){throw new VS(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new hd,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new VS(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=EU(r.target.error);this.S.reject(new VS(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ft(ql,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new j4e(n)}}class dg{static delete(e){return ft(ql,"Removing database:",e),dy(Dle().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Wle())return!1;if(dg.F())return!0;const e=Us(),n=dg.M(e),r=0<n&&n<10,i=Bce(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,dg.M(Us())===12.2&&Ra("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ft(ql,"Opening database:",this.name),this.db=await new Promise(((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new VS(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new St(We.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new St(We.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new VS(e,o))},i.onupgradeneeded=s=>{ft(ql,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{ft(ql,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=_5.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next((c=>(a.C(),c))).catch((c=>(a.abort(c),xe.reject(c)))).toPromise();return l.catch((()=>{})),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(ft(ql,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Bce(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class $4e{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return dy(this.U.delete())}}class VS extends St{constructor(e,n){super(We.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function qg(t){return t.name==="IndexedDbTransactionError"}class j4e{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ft(ql,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ft(ql,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),dy(r)}add(e){return ft(ql,"ADD",this.store.name,e,e),dy(this.store.add(e))}get(e){return dy(this.store.get(e)).next((n=>(n===void 0&&(n=null),ft(ql,"GET",this.store.name,e,n),n)))}delete(e){return ft(ql,"DELETE",this.store.name,e),dy(this.store.delete(e))}count(){return ft(ql,"COUNT",this.store.name),dy(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new xe(((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}}))}{const s=this.cursor(r),o=[];return this.H(s,((a,l)=>{o.push(l)})).next((()=>o))}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new xe(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,n){ft(ql,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,((s,o,a)=>a.delete()))}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new xe(((r,i)=>{n.onerror=s=>{const o=EU(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():r()})):r()}}))}H(e,n){const r=[];return new xe(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new $4e(a),c=n(a.primaryKey,a.value,l);if(c instanceof xe){const u=c.catch((h=>(l.done(),xe.reject(h))));r.push(u)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}})).next((()=>xe.waitFor(r)))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function dy(t){return new xe(((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=EU(r.target.error);n(i)}}))}let SZ=!1;function EU(t){const e=dg.M(Us());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new St("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return SZ||(SZ=!0,setTimeout((()=>{throw r}),0)),r}}return t}const zS="IndexBackfiller";class F4e{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ft(zS,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const n=await this.ne.ie();ft(zS,`Documents written: ${n}`)}catch(n){qg(n)?ft(zS,"Ignoring IndexedDB error during index backfill: ",n):await ev(n)}await this.re(6e4)}))}}class V4e{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(n=>this.se(n,e)))}se(e,n){const r=new Set;let i=n,s=!0;return xe.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return ft(zS,`Processing collection: ${o}`),this.oe(e,o,i).next((a=>{i-=a,r.add(o)}));s=!1})))).next((()=>n-i))}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next((i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((a=>(ft(zS,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a)))).next((()=>o.size))}))))}_e(e,n){let r=e;return n.changes.forEach(((i,s)=>{const o=zce(s);bU(o,r)>0&&(r=o)})),new cc(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}class Yc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Yc.ce=-1;const Gy=-1;function x5(t){return t==null}function ck(t){return t===0&&1/t==-1/0}function z4e(t){return typeof t=="number"&&Number.isInteger(t)&&!ck(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const L3="";function ua(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=TZ(e)),e=U4e(t.get(n),e);return TZ(e)}function U4e(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case L3:n+="";break;default:n+=s}}return n}function TZ(t){return t+L3+""}function sd(t){const e=t.length;if(nn(e>=2,64408,{path:t}),e===2)return nn(t.charAt(0)===L3&&t.charAt(1)==="",56145,{path:t}),Er.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(L3,s);switch((o<0||o>n)&&Ht(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:Ht(61167,{path:t})}s=o+2}return new Er(r)}const z0="remoteDocuments",FA="owner",r_="owner",uk="mutationQueues",G4e="userId",Uu="mutations",kZ="batchId",ky="userMutationsIndex",AZ=["userId","batchId"];function PC(t,e){return[t,ua(e)]}function Wce(t,e,n){return[t,ua(e),n]}const B4e={},zw="documentMutations",D3="remoteDocumentsV14",W4e=["prefixPath","collectionGroup","readTime","documentId"],CC="documentKeyIndex",H4e=["prefixPath","collectionGroup","documentId"],Hce="collectionGroupIndex",q4e=["collectionGroup","readTime","prefixPath","documentId"],hk="remoteDocumentGlobal",Nj="remoteDocumentGlobalKey",Uw="targets",qce="queryTargetsIndex",K4e=["canonicalId","targetId"],Gw="targetDocuments",Y4e=["targetId","path"],SU="documentTargetsIndex",X4e=["path","targetId"],$3="targetGlobalKey",By="targetGlobal",dk="collectionParents",Z4e=["collectionId","parent"],Bw="clientMetadata",J4e="clientId",w5="bundles",Q4e="bundleId",b5="namedQueries",eNe="name",TU="indexConfiguration",tNe="indexId",Oj="collectionGroupIndex",nNe="collectionGroup",US="indexState",rNe=["indexId","uid"],Kce="sequenceNumberIndex",iNe=["uid","sequenceNumber"],GS="indexEntries",sNe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Yce="documentKeyIndex",oNe=["indexId","uid","orderedDocumentKey"],E5="documentOverlays",aNe=["userId","collectionPath","documentId"],Lj="collectionPathOverlayIndex",lNe=["userId","collectionPath","largestBatchId"],Xce="collectionGroupOverlayIndex",cNe=["userId","collectionGroup","largestBatchId"],kU="globals",uNe="name",Zce=[uk,Uu,zw,z0,Uw,FA,By,Gw,Bw,hk,dk,w5,b5],hNe=[...Zce,E5],Jce=[uk,Uu,zw,D3,Uw,FA,By,Gw,Bw,hk,dk,w5,b5,E5],Qce=Jce,AU=[...Qce,TU,US,GS],dNe=AU,eue=[...AU,kU],fNe=eue;class Dj extends Gce{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Bs(t,e){const n=Rn(t);return dg.O(n.le,e)}function IZ(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Kg(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ei{constructor(e,n){this.comparator=e,this.root=n||Io.EMPTY}insert(e,n){return new Ei(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Io.BLACK,null,null))}remove(e){return new Ei(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Io.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sP(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sP(this.root,e,this.comparator,!1)}getReverseIterator(){return new sP(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sP(this.root,e,this.comparator,!0)}}class sP{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Io{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Io.RED,this.left=i??Io.EMPTY,this.right=s??Io.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Io(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Io.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Io.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Io.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Io.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ht(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ht(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ht(27949);return e+(this.isRed()?0:1)}}Io.EMPTY=null,Io.RED=!0,Io.BLACK=!1;Io.EMPTY=new class{constructor(){this.size=0}get key(){throw Ht(57766)}get value(){throw Ht(16141)}get color(){throw Ht(16727)}get left(){throw Ht(29726)}get right(){throw Ht(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Io(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Gr{constructor(e){this.comparator=e,this.data=new Ei(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new RZ(this.data.getIterator())}getIteratorFrom(e){return new RZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Gr)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Gr(this.comparator);return n.data=e,n}}class RZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function i_(t){return t.hasNext()?t.getNext():void 0}class pl{constructor(e){this.fields=e,e.sort(Ni.comparator)}static empty(){return new pl([])}unionWith(e){let n=new Gr(Ni.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new pl(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Vw(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class nue extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class As{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new nue("Invalid base64 string: "+s):s}})(e);return new As(n)}static fromUint8Array(e){const n=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new As(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return In(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}As.EMPTY_BYTE_STRING=new As("");const pNe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sp(t){if(nn(!!t,39018),typeof t=="string"){let e=0;const n=pNe.exec(t);if(nn(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:_i(t.seconds),nanos:_i(t.nanos)}}function _i(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function op(t){return typeof t=="string"?As.fromBase64String(t):As.fromUint8Array(t)}const rue="server_timestamp",iue="__type__",sue="__previous_value__",oue="__local_write_time__";function IU(t){return(t?.mapValue?.fields||{})[iue]?.stringValue===rue}function S5(t){const e=t.mapValue.fields[sue];return IU(e)?S5(e):e}function fk(t){const e=sp(t.mapValue.fields[oue].timestampValue);return new Vr(e.seconds,e.nanos)}class mNe{constructor(e,n,r,i,s,o,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const j3="(default)";class b1{constructor(e,n){this.projectId=e,this.database=n||j3}static empty(){return new b1("","")}get isDefaultDatabase(){return this.database===j3}isEqual(e){return e instanceof b1&&e.projectId===this.projectId&&e.database===this.database}}const RU="__type__",aue="__max__",qm={mapValue:{fields:{__type__:{stringValue:aue}}}},PU="__vector__",Ww="value",MC={nullValue:"NULL_VALUE"};function kg(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?IU(t)?4:lue(t)?9007199254740991:T5(t)?10:11:Ht(28295,{value:t})}function Ed(t,e){if(t===e)return!0;const n=kg(t);if(n!==kg(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fk(t).isEqual(fk(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=sp(i.timestampValue),a=sp(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,s){return op(i.bytesValue).isEqual(op(s.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,s){return _i(i.geoPointValue.latitude)===_i(s.geoPointValue.latitude)&&_i(i.geoPointValue.longitude)===_i(s.geoPointValue.longitude)})(t,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return _i(i.integerValue)===_i(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=_i(i.doubleValue),a=_i(s.doubleValue);return o===a?ck(o)===ck(a):isNaN(o)&&isNaN(a)}return!1})(t,e);case 9:return Vw(t.arrayValue.values||[],e.arrayValue.values||[],Ed);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(IZ(o)!==IZ(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Ed(o[l],a[l])))return!1;return!0})(t,e);default:return Ht(52216,{left:t})}}function pk(t,e){return(t.values||[]).find((n=>Ed(n,e)))!==void 0}function Ag(t,e){if(t===e)return 0;const n=kg(t),r=kg(e);if(n!==r)return In(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return In(t.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=_i(s.integerValue||s.doubleValue),l=_i(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(t,e);case 3:return PZ(t.timestampValue,e.timestampValue);case 4:return PZ(fk(t),fk(e));case 5:return Cj(t.stringValue,e.stringValue);case 6:return(function(s,o){const a=op(s),l=op(o);return a.compareTo(l)})(t.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=In(a[c],l[c]);if(u!==0)return u}return In(a.length,l.length)})(t.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=In(_i(s.latitude),_i(o.latitude));return a!==0?a:In(_i(s.longitude),_i(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return CZ(t.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},l=o.fields||{},c=a[Ww]?.arrayValue,u=l[Ww]?.arrayValue,h=In(c?.values?.length||0,u?.values?.length||0);return h!==0?h:CZ(c,u)})(t.mapValue,e.mapValue);case 11:return(function(s,o){if(s===qm.mapValue&&o===qm.mapValue)return 0;if(s===qm.mapValue)return 1;if(o===qm.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=Cj(l[h],u[h]);if(f!==0)return f;const g=Ag(a[l[h]],c[u[h]]);if(g!==0)return g}return In(l.length,u.length)})(t.mapValue,e.mapValue);default:throw Ht(23264,{he:n})}}function PZ(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return In(t,e);const n=sp(t),r=sp(e),i=In(n.seconds,r.seconds);return i!==0?i:In(n.nanos,r.nanos)}function CZ(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Ag(n[i],r[i]);if(s)return s}return In(n.length,r.length)}function Hw(t){return $j(t)}function $j(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=sp(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return op(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return kt.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=$j(s);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${$j(n.fields[o])}`;return i+"}"})(t.mapValue):Ht(61005,{value:t})}function NC(t){switch(kg(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=S5(t);return e?16+NC(e):16;case 5:return 2*t.stringValue.length;case 6:return op(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+NC(s)),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return Kg(r.fields,((s,o)=>{i+=s.length+NC(o)})),i})(t.mapValue);default:throw Ht(13486,{value:t})}}function mk(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function jj(t){return!!t&&"integerValue"in t}function gk(t){return!!t&&"arrayValue"in t}function MZ(t){return!!t&&"nullValue"in t}function NZ(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function OC(t){return!!t&&"mapValue"in t}function T5(t){return(t?.mapValue?.fields||{})[RU]?.stringValue===PU}function BS(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Kg(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=BS(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=BS(t.arrayValue.values[n]);return e}return{...t}}function lue(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===aue}const cue={mapValue:{fields:{[RU]:{stringValue:PU},[Ww]:{arrayValue:{}}}}};function gNe(t){return"nullValue"in t?MC:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?mk(b1.empty(),kt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?T5(t)?cue:{mapValue:{}}:Ht(35942,{value:t})}function yNe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?mk(b1.empty(),kt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?cue:"mapValue"in t?T5(t)?{mapValue:{}}:qm:Ht(61959,{value:t})}function OZ(t,e){const n=Ag(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function LZ(t,e){const n=Ag(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class ra{constructor(e){this.value=e}static empty(){return new ra({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!OC(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=BS(n)}setAll(e){let n=Ni.emptyPath(),r={},i=[];e.forEach(((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=BS(o):i.push(a.lastSegment())}));const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());OC(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ed(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];OC(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Kg(n,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new ra(BS(this.value))}}function uue(t){const e=[];return Kg(t.fields,((n,r)=>{const i=new Ni([n]);if(OC(r)){const s=uue(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)})),new pl(e)}class Zi{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Zi(e,0,on.min(),on.min(),on.min(),ra.empty(),0)}static newFoundDocument(e,n,r,i){return new Zi(e,1,n,on.min(),r,i,0)}static newNoDocument(e,n){return new Zi(e,2,n,on.min(),on.min(),ra.empty(),0)}static newUnknownDocument(e,n){return new Zi(e,3,n,on.min(),on.min(),ra.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(on.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ra.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ra.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=on.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qw{constructor(e,n){this.position=e,this.inclusive=n}}function DZ(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=kt.comparator(kt.fromName(o.referenceValue),n.key):r=Ag(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function $Z(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ed(t.position[n],e.position[n]))return!1;return!0}class F3{constructor(e,n="asc"){this.field=e,this.dir=n}}function vNe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class hue{}class er extends hue{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new _Ne(e,n,r):n==="array-contains"?new bNe(e,r):n==="in"?new yue(e,r):n==="not-in"?new ENe(e,r):n==="array-contains-any"?new SNe(e,r):new er(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new xNe(e,r):new wNe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ag(n,this.value)):n!==null&&kg(this.value)===kg(n)&&this.matchesComparison(Ag(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ht(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zr extends hue{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new zr(e,n)}matches(e){return Kw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kw(t){return t.op==="and"}function Fj(t){return t.op==="or"}function CU(t){return due(t)&&Kw(t)}function due(t){for(const e of t.filters)if(e instanceof zr)return!1;return!0}function Vj(t){if(t instanceof er)return t.field.canonicalString()+t.op.toString()+Hw(t.value);if(CU(t))return t.filters.map((e=>Vj(e))).join(",");{const e=t.filters.map((n=>Vj(n))).join(",");return`${t.op}(${e})`}}function fue(t,e){return t instanceof er?(function(r,i){return i instanceof er&&r.op===i.op&&r.field.isEqual(i.field)&&Ed(r.value,i.value)})(t,e):t instanceof zr?(function(r,i){return i instanceof zr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,a)=>s&&fue(o,i.filters[a])),!0):!1})(t,e):void Ht(19439)}function pue(t,e){const n=t.filters.concat(e);return zr.create(n,t.op)}function mue(t){return t instanceof er?(function(n){return`${n.field.canonicalString()} ${n.op} ${Hw(n.value)}`})(t):t instanceof zr?(function(n){return n.op.toString()+" {"+n.getFilters().map(mue).join(" ,")+"}"})(t):"Filter"}class _Ne extends er{constructor(e,n,r){super(e,n,r),this.key=kt.fromName(r.referenceValue)}matches(e){const n=kt.comparator(e.key,this.key);return this.matchesComparison(n)}}class xNe extends er{constructor(e,n){super(e,"in",n),this.keys=gue("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class wNe extends er{constructor(e,n){super(e,"not-in",n),this.keys=gue("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function gue(t,e){return(e.arrayValue?.values||[]).map((n=>kt.fromName(n.referenceValue)))}class bNe extends er{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gk(n)&&pk(n.arrayValue,this.value)}}class yue extends er{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&pk(this.value.arrayValue,n)}}class ENe extends er{constructor(e,n){super(e,"not-in",n)}matches(e){if(pk(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!pk(this.value.arrayValue,n)}}class SNe extends er{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gk(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>pk(this.value.arrayValue,r)))}}class TNe{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function zj(t,e=null,n=[],r=[],i=null,s=null,o=null){return new TNe(t,e,n,r,i,s,o)}function E1(t){const e=Rn(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>Vj(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),x5(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>Hw(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>Hw(r))).join(",")),e.Te=n}return e.Te}function VA(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!vNe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!fue(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$Z(t.startAt,e.startAt)&&$Z(t.endAt,e.endAt)}function V3(t){return kt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function z3(t,e){return t.filters.filter((n=>n instanceof er&&n.field.isEqual(e)))}function jZ(t,e,n){let r=MC,i=!0;for(const s of z3(t,e)){let o=MC,a=!0;switch(s.op){case"<":case"<=":o=gNe(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=MC}OZ({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];OZ({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function FZ(t,e,n){let r=qm,i=!0;for(const s of z3(t,e)){let o=qm,a=!0;switch(s.op){case">=":case">":o=yNe(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=qm}LZ({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];LZ({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}class zA{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function kNe(t,e,n,r,i,s,o,a){return new zA(t,e,n,r,i,s,o,a)}function k5(t){return new zA(t)}function VZ(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function vue(t){return t.collectionGroup!==null}function WS(t){const e=Rn(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Gr(Ni.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(e).forEach((s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new F3(s,r))})),n.has(Ni.keyField().canonicalString())||e.Ie.push(new F3(Ni.keyField(),r))}return e.Ie}function Qc(t){const e=Rn(t);return e.Ee||(e.Ee=ANe(e,WS(t))),e.Ee}function ANe(t,e){if(t.limitType==="F")return zj(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new F3(i.field,s)}));const n=t.endAt?new qw(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new qw(t.startAt.position,t.startAt.inclusive):null;return zj(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Uj(t,e){const n=t.filters.concat([e]);return new zA(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Gj(t,e,n){return new zA(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function A5(t,e){return VA(Qc(t),Qc(e))&&t.limitType===e.limitType}function _ue(t){return`${E1(Qc(t))}|lt:${t.limitType}`}function M_(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((i=>mue(i))).join(", ")}]`),x5(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((i=>Hw(i))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((i=>Hw(i))).join(",")),`Target(${r})`})(Qc(t))}; limitType=${t.limitType})`}function UA(t,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):kt.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(t,e)&&(function(r,i){for(const s of WS(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,l){const c=DZ(o,a,l);return o.inclusive?c<=0:c<0})(r.startAt,WS(r),i)||r.endAt&&!(function(o,a,l){const c=DZ(o,a,l);return o.inclusive?c>=0:c>0})(r.endAt,WS(r),i))})(t,e)}function INe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xue(t){return(e,n)=>{let r=!1;for(const i of WS(t)){const s=RNe(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function RNe(t,e,n){const r=t.field.isKeyField()?kt.comparator(e.key,n.key):(function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Ag(l,c):Ht(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ht(19790,{direction:t.dir})}}class yp{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Kg(this.inner,((n,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return tue(this.inner)}size(){return this.innerSize}}const PNe=new Ei(kt.comparator);function nc(){return PNe}const wue=new Ei(kt.comparator);function BE(...t){let e=wue;for(const n of t)e=e.insert(n.key,n);return e}function bue(t){let e=wue;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function od(){return HS()}function Eue(){return HS()}function HS(){return new yp((t=>t.toString()),((t,e)=>t.isEqual(e)))}const CNe=new Ei(kt.comparator),MNe=new Gr(kt.comparator);function Bn(...t){let e=MNe;for(const n of t)e=e.add(n);return e}const NNe=new Gr(In);function ONe(){return NNe}function MU(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ck(e)?"-0":e}}function Sue(t){return{integerValue:""+t}}function LNe(t,e){return z4e(e)?Sue(e):MU(t,e)}class I5{constructor(){this._=void 0}}function DNe(t,e,n){return t instanceof Yw?(function(i,s){const o={fields:{[iue]:{stringValue:rue},[oue]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&IU(s)&&(s=S5(s)),s&&(o.fields[sue]=s),{mapValue:o}})(n,e):t instanceof Xw?kue(t,e):t instanceof Zw?Aue(t,e):(function(i,s){const o=Tue(i,s),a=zZ(o)+zZ(i.Ae);return jj(o)&&jj(i.Ae)?Sue(a):MU(i.serializer,a)})(t,e)}function $Ne(t,e,n){return t instanceof Xw?kue(t,e):t instanceof Zw?Aue(t,e):n}function Tue(t,e){return t instanceof yk?(function(r){return jj(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class Yw extends I5{}class Xw extends I5{constructor(e){super(),this.elements=e}}function kue(t,e){const n=Iue(e);for(const r of t.elements)n.some((i=>Ed(i,r)))||n.push(r);return{arrayValue:{values:n}}}class Zw extends I5{constructor(e){super(),this.elements=e}}function Aue(t,e){let n=Iue(e);for(const r of t.elements)n=n.filter((i=>!Ed(i,r)));return{arrayValue:{values:n}}}class yk extends I5{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function zZ(t){return _i(t.integerValue||t.doubleValue)}function Iue(t){return gk(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Rue{constructor(e,n){this.field=e,this.transform=n}}function jNe(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof Xw&&i instanceof Xw||r instanceof Zw&&i instanceof Zw?Vw(r.elements,i.elements,Ed):r instanceof yk&&i instanceof yk?Ed(r.Ae,i.Ae):r instanceof Yw&&i instanceof Yw})(t.transform,e.transform)}class FNe{constructor(e,n){this.version=e,this.transformResults=n}}class oa{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new oa}static exists(e){return new oa(void 0,e)}static updateTime(e){return new oa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function LC(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class R5{}function Pue(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new P5(t.key,oa.none()):new j2(t.key,t.data,oa.none());{const n=t.data,r=ra.empty();let i=new Gr(Ni.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new vp(t.key,r,new pl(i.toArray()),oa.none())}}function VNe(t,e,n){t instanceof j2?(function(i,s,o){const a=i.value.clone(),l=GZ(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(t,e,n):t instanceof vp?(function(i,s,o){if(!LC(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=GZ(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Cue(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,n):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function qS(t,e,n,r){return t instanceof j2?(function(s,o,a,l){if(!LC(s.precondition,o))return a;const c=s.value.clone(),u=BZ(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null})(t,e,n,r):t instanceof vp?(function(s,o,a,l){if(!LC(s.precondition,o))return a;const c=BZ(s.fieldTransforms,l,o),u=o.data;return u.setAll(Cue(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((h=>h.field)))})(t,e,n,r):(function(s,o,a){return LC(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(t,e,n)}function zNe(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Tue(r.transform,i||null);s!=null&&(n===null&&(n=ra.empty()),n.set(r.field,s))}return n||null}function UZ(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Vw(r,i,((s,o)=>jNe(s,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class j2 extends R5{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class vp extends R5{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Cue(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function GZ(t,e,n){const r=new Map;nn(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,$Ne(o,a,n[i]))}return r}function BZ(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,DNe(s,o,e))}return r}class P5 extends R5{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Mue extends R5{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class NU{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&VNe(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=qS(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=qS(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Eue();return this.mutations.forEach((i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=Pue(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(on.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Bn())}isEqual(e){return this.batchId===e.batchId&&Vw(this.mutations,e.mutations,((n,r)=>UZ(n,r)))&&Vw(this.baseMutations,e.baseMutations,((n,r)=>UZ(n,r)))}}class OU{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){nn(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return CNe})();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new OU(e,n,r,i)}}class LU{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class UNe{constructor(e,n){this.count=e,this.unchangedNames=n}}var gs,ir;function GNe(t){switch(t){case We.OK:return Ht(64938);case We.CANCELLED:case We.UNKNOWN:case We.DEADLINE_EXCEEDED:case We.RESOURCE_EXHAUSTED:case We.INTERNAL:case We.UNAVAILABLE:case We.UNAUTHENTICATED:return!1;case We.INVALID_ARGUMENT:case We.NOT_FOUND:case We.ALREADY_EXISTS:case We.PERMISSION_DENIED:case We.FAILED_PRECONDITION:case We.ABORTED:case We.OUT_OF_RANGE:case We.UNIMPLEMENTED:case We.DATA_LOSS:return!0;default:return Ht(15467,{code:t})}}function Nue(t){if(t===void 0)return Ra("GRPC error has no .code"),We.UNKNOWN;switch(t){case gs.OK:return We.OK;case gs.CANCELLED:return We.CANCELLED;case gs.UNKNOWN:return We.UNKNOWN;case gs.DEADLINE_EXCEEDED:return We.DEADLINE_EXCEEDED;case gs.RESOURCE_EXHAUSTED:return We.RESOURCE_EXHAUSTED;case gs.INTERNAL:return We.INTERNAL;case gs.UNAVAILABLE:return We.UNAVAILABLE;case gs.UNAUTHENTICATED:return We.UNAUTHENTICATED;case gs.INVALID_ARGUMENT:return We.INVALID_ARGUMENT;case gs.NOT_FOUND:return We.NOT_FOUND;case gs.ALREADY_EXISTS:return We.ALREADY_EXISTS;case gs.PERMISSION_DENIED:return We.PERMISSION_DENIED;case gs.FAILED_PRECONDITION:return We.FAILED_PRECONDITION;case gs.ABORTED:return We.ABORTED;case gs.OUT_OF_RANGE:return We.OUT_OF_RANGE;case gs.UNIMPLEMENTED:return We.UNIMPLEMENTED;case gs.DATA_LOSS:return We.DATA_LOSS;default:return Ht(39323,{code:t})}}(ir=gs||(gs={}))[ir.OK=0]="OK",ir[ir.CANCELLED=1]="CANCELLED",ir[ir.UNKNOWN=2]="UNKNOWN",ir[ir.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ir[ir.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ir[ir.NOT_FOUND=5]="NOT_FOUND",ir[ir.ALREADY_EXISTS=6]="ALREADY_EXISTS",ir[ir.PERMISSION_DENIED=7]="PERMISSION_DENIED",ir[ir.UNAUTHENTICATED=16]="UNAUTHENTICATED",ir[ir.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ir[ir.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ir[ir.ABORTED=10]="ABORTED",ir[ir.OUT_OF_RANGE=11]="OUT_OF_RANGE",ir[ir.UNIMPLEMENTED=12]="UNIMPLEMENTED",ir[ir.INTERNAL=13]="INTERNAL",ir[ir.UNAVAILABLE=14]="UNAVAILABLE",ir[ir.DATA_LOSS=15]="DATA_LOSS";function BNe(){return new TextEncoder}const WNe=new hg([4294967295,4294967295],0);function WZ(t){const e=BNe().encode(t),n=new Pce;return n.update(e),new Uint8Array(n.digest())}function HZ(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new hg([n,r],0),new hg([i,s],0)]}class DU{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new WE(`Invalid padding: ${n}`);if(r<0)throw new WE(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new WE(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new WE(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=hg.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(hg.fromNumber(r)));return i.compare(WNe)===1&&(i=new hg([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=WZ(e),[r,i]=HZ(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new DU(s,i,n);return r.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const n=WZ(e),[r,i]=HZ(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class WE extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class C5{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,GA.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new C5(on.min(),i,new Ei(In),nc(),Bn())}}class GA{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new GA(r,n,Bn(),Bn(),Bn())}}class DC{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Oue{constructor(e,n){this.targetId=e,this.Ce=n}}class Lue{constructor(e,n,r=As.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class qZ{constructor(){this.ve=0,this.Fe=KZ(),this.Me=As.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Bn(),n=Bn(),r=Bn();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ht(38017,{changeType:s})}})),new GA(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=KZ()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,nn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class HNe{constructor(e){this.Ge=e,this.ze=new Map,this.je=nc(),this.Je=oP(),this.He=oP(),this.Ye=new Ei(In)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ht(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,i)=>{this.rt(i)&&n(i)}))}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(V3(s))if(r===0){const o=new kt(s.path);this.et(n,o,Zi.newNoDocument(o,on.min()))}else nn(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=op(r).toUint8Array()}catch(l){if(l instanceof nue)return w1("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new DU(o,i,s)}catch(l){return w1(l instanceof WE?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)})),i}Tt(e){const n=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&V3(a.target)){const l=new kt(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Zi.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}}));let r=Bn();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const i=new C5(e,n,this.Ye,this.je,r);return this.je=nc(),this.Je=oP(),this.He=oP(),this.Ye=new Ei(In),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new qZ,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Gr(In),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Gr(In),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ft("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qZ),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function oP(){return new Ei(kt.comparator)}function KZ(){return new Ei(kt.comparator)}const qNe={asc:"ASCENDING",desc:"DESCENDING"},KNe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YNe={and:"AND",or:"OR"};class XNe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Bj(t,e){return t.useProto3Json||x5(e)?e:{value:e}}function Jw(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Due(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ZNe(t,e){return Jw(t,e.toTimestamp())}function Oa(t){return nn(!!t,49232),on.fromTimestamp((function(n){const r=sp(n);return new Vr(r.seconds,r.nanos)})(t))}function $U(t,e){return Wj(t,e).canonicalString()}function Wj(t,e){const n=(function(i){return new Er(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function $ue(t){const e=Er.fromString(t);return nn(Hue(e),10190,{key:e.toString()}),e}function U3(t,e){return $U(t.databaseId,e.path)}function Wy(t,e){const n=$ue(e);if(n.get(1)!==t.databaseId.projectId)throw new St(We.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new St(We.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new kt(Vue(n))}function jue(t,e){return $U(t.databaseId,e)}function Fue(t){const e=$ue(t);return e.length===4?Er.emptyPath():Vue(e)}function Hj(t){return new Er(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vue(t){return nn(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function YZ(t,e,n){return{name:U3(t,e),fields:n.value.mapValue.fields}}function JNe(t,e,n){const r=Wy(t,e.name),i=Oa(e.updateTime),s=e.createTime?Oa(e.createTime):on.min(),o=new ra({mapValue:{fields:e.fields}}),a=Zi.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function QNe(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ht(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,u){return c.useProto3Json?(nn(u===void 0||typeof u=="string",58123),As.fromBase64String(u||"")):(nn(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),As.fromUint8Array(u||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(c){const u=c.code===void 0?We.UNKNOWN:Nue(c.code);return new St(u,c.message||"")})(o);n=new Lue(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Wy(t,r.document.name),s=Oa(r.document.updateTime),o=r.document.createTime?Oa(r.document.createTime):on.min(),a=new ra({mapValue:{fields:r.document.fields}}),l=Zi.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new DC(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Wy(t,r.document),s=r.readTime?Oa(r.readTime):on.min(),o=Zi.newNoDocument(i,s),a=r.removedTargetIds||[];n=new DC([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Wy(t,r.document),s=r.removedTargetIds||[];n=new DC([],s,i,null)}else{if(!("filter"in e))return Ht(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new UNe(i,s),a=r.targetId;n=new Oue(a,o)}}return n}function G3(t,e){let n;if(e instanceof j2)n={update:YZ(t,e.key,e.value)};else if(e instanceof P5)n={delete:U3(t,e.key)};else if(e instanceof vp)n={update:YZ(t,e.key,e.data),updateMask:s5e(e.fieldMask)};else{if(!(e instanceof Mue))return Ht(16599,{Vt:e.type});n={verify:U3(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){const a=o.transform;if(a instanceof Yw)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Xw)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Zw)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof yk)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Ht(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:ZNe(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ht(27497)})(t,e.precondition)),n}function qj(t,e){const n=e.currentDocument?(function(s){return s.updateTime!==void 0?oa.updateTime(Oa(s.updateTime)):s.exists!==void 0?oa.exists(s.exists):oa.none()})(e.currentDocument):oa.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,a){let l=null;if("setToServerValue"in a)nn(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Yw;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new Xw(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new Zw(u)}else"increment"in a?l=new yk(o,a.increment):Ht(16584,{proto:a});const c=Ni.fromServerFormat(a.fieldPath);return new Rue(c,l)})(t,i))):[];if(e.update){e.update.name;const i=Wy(t,e.update.name),s=new ra({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(l){const c=l.fieldPaths||[];return new pl(c.map((u=>Ni.fromServerFormat(u))))})(e.updateMask);return new vp(i,s,o,n,r)}return new j2(i,s,n,r)}if(e.delete){const i=Wy(t,e.delete);return new P5(i,n)}if(e.verify){const i=Wy(t,e.verify);return new Mue(i,n)}return Ht(1463,{proto:e})}function e5e(t,e){return t&&t.length>0?(nn(e!==void 0,14353),t.map((n=>(function(i,s){let o=i.updateTime?Oa(i.updateTime):Oa(s);return o.isEqual(on.min())&&(o=Oa(s)),new FNe(o,i.transformResults||[])})(n,e)))):[]}function zue(t,e){return{documents:[jue(t,e.path)]}}function Uue(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=jue(t,i);const s=(function(c){if(c.length!==0)return Wue(zr.create(c,"and"))})(e.filters);s&&(n.structuredQuery.where=s);const o=(function(c){if(c.length!==0)return c.map((u=>(function(f){return{field:N_(f.field),direction:n5e(f.dir)}})(u)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Bj(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:n,parent:i}}function Gue(t){let e=Fue(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){nn(r===1,65062);const u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=(function(h){const f=Bue(h);return f instanceof zr&&CU(f)?f.getFilters():[f]})(n.where));let o=[];n.orderBy&&(o=(function(h){return h.map((f=>(function(v){return new F3(O_(v.field),(function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(f)))})(n.orderBy));let a=null;n.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,x5(f)?null:f})(n.limit));let l=null;n.startAt&&(l=(function(h){const f=!!h.before,g=h.values||[];return new qw(g,f)})(n.startAt));let c=null;return n.endAt&&(c=(function(h){const f=!h.before,g=h.values||[];return new qw(g,f)})(n.endAt)),kNe(e,i,o,s,a,"F",l,c)}function t5e(t,e){const n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ht(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Bue(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=O_(n.unaryFilter.field);return er.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=O_(n.unaryFilter.field);return er.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=O_(n.unaryFilter.field);return er.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=O_(n.unaryFilter.field);return er.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ht(61313);default:return Ht(60726)}})(t):t.fieldFilter!==void 0?(function(n){return er.create(O_(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ht(58110);default:return Ht(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return zr.create(n.compositeFilter.filters.map((r=>Bue(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ht(1026)}})(n.compositeFilter.op))})(t):Ht(30097,{filter:t})}function n5e(t){return qNe[t]}function r5e(t){return KNe[t]}function i5e(t){return YNe[t]}function N_(t){return{fieldPath:t.canonicalString()}}function O_(t){return Ni.fromServerFormat(t.fieldPath)}function Wue(t){return t instanceof er?(function(n){if(n.op==="=="){if(NZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NAN"}};if(MZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(NZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NOT_NAN"}};if(MZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:N_(n.field),op:r5e(n.op),value:n.value}}})(t):t instanceof zr?(function(n){const r=n.getFilters().map((i=>Wue(i)));return r.length===1?r[0]:{compositeFilter:{op:i5e(n.op),filters:r}}})(t):Ht(54877,{filter:t})}function s5e(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Hue(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ff{constructor(e,n,r,i,s=on.min(),o=on.min(),a=As.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Ff(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ff(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ff(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ff(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class que{constructor(e){this.yt=e}}function o5e(t,e){let n;if(e.document)n=JNe(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=kt.fromSegments(e.noDocument.path),i=T1(e.noDocument.readTime);n=Zi.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ht(56709);{const r=kt.fromSegments(e.unknownDocument.path),i=T1(e.unknownDocument.version);n=Zi.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime((function(i){const s=new Vr(i[0],i[1]);return on.fromTimestamp(s)})(e.readTime)),n}function XZ(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:B3(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:U3(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Jw(s,o.version.toTimestamp()),createTime:Jw(s,o.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:S1(e.version)};else{if(!e.isUnknownDocument())return Ht(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:S1(e.version)}}return r}function B3(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function S1(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function T1(t){const e=new Vr(t.seconds,t.nanoseconds);return on.fromTimestamp(e)}function fy(t,e){const n=(e.baseMutations||[]).map((s=>qj(t.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>qj(t.yt,s))),i=Vr.fromMillis(e.localWriteTimeMs);return new NU(e.batchId,i,n,r)}function HE(t){const e=T1(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?T1(t.lastLimboFreeSnapshotVersion):on.min();let r;return r=(function(s){return s.documents!==void 0})(t.query)?(function(s){const o=s.documents.length;return nn(o===1,1966,{count:o}),Qc(k5(Fue(s.documents[0])))})(t.query):(function(s){return Qc(Gue(s))})(t.query),new Ff(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,As.fromBase64String(t.resumeToken))}function Kue(t,e){const n=S1(e.snapshotVersion),r=S1(e.lastLimboFreeSnapshotVersion);let i;i=V3(e.target)?zue(t.yt,e.target):Uue(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:E1(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Yue(t){const e=Gue({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gj(e,e.limit,"L"):e}function L6(t,e){return new LU(e.largestBatchId,qj(t.yt,e.overlayMutation))}function ZZ(t,e){const n=e.path.lastSegment();return[t,ua(e.path.popLast()),n]}function JZ(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:S1(r.readTime),documentKey:ua(r.documentKey.path),largestBatchId:r.largestBatchId}}class a5e{getBundleMetadata(e,n){return QZ(e).get(n).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:T1(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,n){return QZ(e).put((function(i){return{bundleId:i.id,createTime:S1(Oa(i.createTime)),version:i.version}})(n))}getNamedQuery(e,n){return eJ(e).get(n).next((r=>{if(r)return(function(s){return{name:s.name,query:Yue(s.bundledQuery),readTime:T1(s.readTime)}})(r)}))}saveNamedQuery(e,n){return eJ(e).put((function(i){return{name:i.name,readTime:S1(Oa(i.readTime)),bundledQuery:i.bundledQuery}})(n))}}function QZ(t){return Bs(t,w5)}function eJ(t){return Bs(t,b5)}class M5{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new M5(e,r)}getOverlay(e,n){return aE(e).get(ZZ(this.userId,n)).next((r=>r?L6(this.serializer,r):null))}getOverlays(e,n){const r=od();return xe.forEach(n,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,n,r){const i=[];return r.forEach(((s,o)=>{const a=new LU(n,o);i.push(this.St(e,a))})),xe.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach((o=>i.add(ua(o.getCollectionPath()))));const s=[];return i.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(aE(e).Z(Lj,a))})),xe.waitFor(s)}getOverlaysForCollection(e,n,r){const i=od(),s=ua(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return aE(e).J(Lj,o).next((a=>{for(const l of a){const c=L6(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,n,r,i){const s=od();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return aE(e).ee({index:Xce,range:a},((l,c,u)=>{const h=L6(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()})).next((()=>s))}St(e,n){return aE(e).put((function(i,s,o){const[a,l,c]=ZZ(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:G3(i.yt,o.mutation)}})(this.serializer,this.userId,n))}}function aE(t){return Bs(t,E5)}class l5e{bt(e){return Bs(e,kU)}getSessionToken(e){return this.bt(e).get("sessionToken").next((n=>{const r=n?.value;return r?As.fromUint8Array(r):As.EMPTY_BYTE_STRING}))}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}class py{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(_i(e.integerValue));else if("doubleValue"in e){const r=_i(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),ck(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=sp(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(op(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?lue(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):T5(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Ht(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){const r=e.fields||{};this.Ft(n,53);const i=Ww,s=r[i].arrayValue?.values?.length||0;this.Ft(n,15),n.Mt(_i(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),kt.fromName(e).path.forEach((r=>{this.Ft(n,60),this.Ut(r,n)}))}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}py.Kt=new py;const s_=255;function c5e(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function tJ(t){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const o=c5e(255&r[s]);if(i+=o,o!==8)break}return i})(t);return Math.ceil(e/8)}class u5e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=tJ(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=tJ(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(s_),this.sn(255)}_n(){this.an(s_),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===s_?(this.sn(s_),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===s_?(this.an(s_),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class h5e{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class d5e{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class lE{constructor(){this.cn=new u5e,this.ln=new h5e(this.cn),this.hn=new d5e(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class my{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new my(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:$C(this.En),directionalValue:$C(this.dn),orderedDocumentKey:$C(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Jp(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=nJ(t.En,e.En),n!==0?n:(n=nJ(t.dn,e.dn),n!==0?n:kt.comparator(t.In,e.In)))}function nJ(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function $C(t){return Ble()?(function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r})(t):t}function rJ(t){return typeof t!="string"?t:(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(t)}class iJ{constructor(e){this.mn=new Gr(((n,r)=>Ni.comparator(n.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(nn(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Mj(e);if(n!==void 0&&!this.wn(n))return!1;const r=V0(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Gr(Ni.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new RC(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new RC(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new RC(r.field,r.dir==="asc"?0:1)));return new O3(O3.UNKNOWN_ID,this.collectionId,n,lk.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}function Xue(t){if(nn(t instanceof er||t instanceof zr,20012),t instanceof er){if(t instanceof yue){const n=t.value.arrayValue?.values?.map((r=>er.create(t.field,"==",r)))||[];return zr.create(n,"or")}return t}const e=t.filters.map((n=>Xue(n)));return zr.create(e,t.op)}function f5e(t){if(t.getFilters().length===0)return[];const e=Xj(Xue(t));return nn(Zue(e),7391),Kj(e)||Yj(e)?[e]:e.getFilters()}function Kj(t){return t instanceof er}function Yj(t){return t instanceof zr&&CU(t)}function Zue(t){return Kj(t)||Yj(t)||(function(n){if(n instanceof zr&&Fj(n)){for(const r of n.getFilters())if(!Kj(r)&&!Yj(r))return!1;return!0}return!1})(t)}function Xj(t){if(nn(t instanceof er||t instanceof zr,34018),t instanceof er)return t;if(t.filters.length===1)return Xj(t.filters[0]);const e=t.filters.map((r=>Xj(r)));let n=zr.create(e,t.op);return n=W3(n),Zue(n)?n:(nn(n instanceof zr,64498),nn(Kw(n),40251),nn(n.filters.length>1,57927),n.filters.reduce(((r,i)=>jU(r,i))))}function jU(t,e){let n;return nn(t instanceof er||t instanceof zr,38388),nn(e instanceof er||e instanceof zr,25473),n=t instanceof er?e instanceof er?(function(i,s){return zr.create([i,s],"and")})(t,e):sJ(t,e):e instanceof er?sJ(e,t):(function(i,s){if(nn(i.filters.length>0&&s.filters.length>0,48005),Kw(i)&&Kw(s))return pue(i,s.getFilters());const o=Fj(i)?i:s,a=Fj(i)?s:i,l=o.filters.map((c=>jU(c,a)));return zr.create(l,"or")})(t,e),W3(n)}function sJ(t,e){if(Kw(e))return pue(e,t.getFilters());{const n=e.filters.map((r=>jU(t,r)));return zr.create(n,"or")}}function W3(t){if(nn(t instanceof er||t instanceof zr,11850),t instanceof er)return t;const e=t.getFilters();if(e.length===1)return W3(e[0]);if(due(t))return t;const n=e.map((i=>W3(i))),r=[];return n.forEach((i=>{i instanceof er?r.push(i):i instanceof zr&&(i.op===t.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:zr.create(r,t.op)}class p5e{constructor(){this.Cn=new FU}addToCollectionParentIndex(e,n){return this.Cn.add(n),xe.resolve()}getCollectionParents(e,n){return xe.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return xe.resolve()}deleteFieldIndex(e,n){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,n){return xe.resolve()}getDocumentsMatchingTarget(e,n){return xe.resolve(null)}getIndexType(e,n){return xe.resolve(0)}getFieldIndexes(e,n){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,n){return xe.resolve(cc.min())}getMinOffsetFromCollectionGroup(e,n){return xe.resolve(cc.min())}updateCollectionGroup(e,n,r){return xe.resolve()}updateIndexEntries(e,n){return xe.resolve()}}class FU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Gr(Er.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gr(Er.comparator)).toArray()}}const oJ="IndexedDbIndexManager",aP=new Uint8Array(0);class m5e{constructor(e,n){this.databaseId=n,this.vn=new FU,this.Fn=new yp((r=>E1(r)),((r,i)=>VA(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener((()=>{this.vn.add(n)}));const s={collectionId:r,parent:ua(i)};return aJ(e).put(s)}return xe.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[jce(n),""],!1,!0);return aJ(e).J(i).next((s=>{for(const o of s){if(o.collectionId!==n)break;r.push(sd(o.parent))}return r}))}addFieldIndex(e,n){const r=cE(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=a_(e);return s.next((a=>{o.put(JZ(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))}))}return s.next()}deleteFieldIndex(e,n){const r=cE(e),i=a_(e),s=o_(e);return r.delete(n.indexId).next((()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const n=cE(e),r=o_(e),i=a_(e);return n.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,n){return xe.forEach(this.Mn(n),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new iJ(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,n){const r=o_(e);let i=!0;const s=new Map;return xe.forEach(this.Mn(n),(o=>this.xn(e,o).next((a=>{i&&(i=!!a),s.set(o,a)})))).next((()=>{if(i){let o=Bn();const a=[];return xe.forEach(s,((l,c)=>{ft(oJ,`Using index ${(function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map((R=>`${R.fieldPath}:${R.kind}`)).join(",")}`})(l)} to execute ${E1(n)}`);const u=(function(I,R){const M=Mj(R);if(M===void 0)return null;for(const F of z3(I,M.fieldPath))switch(F.op){case"array-contains-any":return F.value.arrayValue.values||[];case"array-contains":return[F.value]}return null})(c,l),h=(function(I,R){const M=new Map;for(const F of V0(R))for(const C of z3(I,F.fieldPath))switch(C.op){case"==":case"in":M.set(F.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return M.set(F.fieldPath.canonicalString(),C.value),Array.from(M.values())}return null})(c,l),f=(function(I,R){const M=[];let F=!0;for(const C of V0(R)){const N=C.kind===0?jZ(I,C.fieldPath,I.startAt):FZ(I,C.fieldPath,I.startAt);M.push(N.value),F&&(F=N.inclusive)}return new qw(M,F)})(c,l),g=(function(I,R){const M=[];let F=!0;for(const C of V0(R)){const N=C.kind===0?FZ(I,C.fieldPath,I.endAt):jZ(I,C.fieldPath,I.endAt);M.push(N.value),F&&(F=N.inclusive)}return new qw(M,F)})(c,l),v=this.On(l,c,f),x=this.On(l,c,g),b=this.Nn(l,c,h),T=this.Bn(l.indexId,u,v,f.inclusive,x,g.inclusive,b);return xe.forEach(T,(A=>r.Y(A,n.limit).next((I=>{I.forEach((R=>{const M=kt.fromSegments(R.documentKey);o.has(M)||(o=o.add(M),a.push(M))}))}))))})).next((()=>a))}return xe.resolve(null)}))}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=f5e(zr.create(e.filters,"and")).map((r=>zj(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const f=n?this.Ln(n[h/c]):aP,g=this.kn(e,f,r[h%c],i),v=this.qn(e,f,s[h%c],o),x=a.map((b=>this.kn(e,f,b,!0)));u.push(...this.createRange(g,v,x))}return u}kn(e,n,r,i){const s=new my(e,kt.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new my(e,kt.empty(),n,r);return i?s.An():s}xn(e,n){const r=new iJ(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,n){let r=2;const i=this.Mn(n);return xe.forEach(i,(s=>this.xn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(l){let c=new Gr(Ni.comparator),u=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(n)&&i.length>1&&r===2?1:r))}Qn(e,n){const r=new lE;for(const i of V0(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);py.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new lE;return py.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new lE;return py.Kt.Dt(mk(this.databaseId,n),r.Pn((function(s){const o=V0(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new lE);let s=0;for(const o of V0(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&gk(a))i=this.Kn(i,o,a);else{const c=l.Pn(o.kind);py.Kt.Dt(a,c)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new lE;l.seed(a.un()),py.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find((r=>r instanceof er&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,n){const r=cE(e),i=a_(e);return(n?r.J(Oj,IDBKeyRange.bound(n,n)):r.J()).next((s=>{const o=[];return xe.forEach(s,(a=>i.get([a.indexId,this.uid]).next((l=>{o.push((function(u,h){const f=h?new lk(h.sequenceNumber,new cc(T1(h.readTime),new kt(sd(h.documentKey)),h.largestBatchId)):lk.empty(),g=u.fields.map((([v,x])=>new RC(Ni.fromServerFormat(v),x)));return new O3(u.indexId,u.collectionGroup,g,f)})(a,l))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((n=>n.length===0?null:(n.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:In(r.collectionGroup,i.collectionGroup)})),n[0].collectionGroup)))}updateCollectionGroup(e,n,r){const i=cE(e),s=a_(e);return this.Gn(e).next((o=>i.J(Oj,IDBKeyRange.bound(n,n)).next((a=>xe.forEach(a,(l=>s.put(JZ(l.indexId,this.uid,o,r))))))))}updateIndexEntries(e,n){const r=new Map;return xe.forEach(n,((i,s)=>{const o=r.get(i.collectionGroup);return(o?xe.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((a=>(r.set(i.collectionGroup,a),xe.forEach(a,(l=>this.zn(e,i,l).next((c=>{const u=this.jn(s,l);return c.isEqual(u)?xe.resolve():this.Jn(e,s,l,c,u)})))))))}))}Hn(e,n,r,i){return o_(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return o_(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=o_(e);let s=new Gr(Jp);return i.ee({index:Yce,range:IDBKeyRange.only([r.indexId,this.uid,$C(this.$n(r,n))])},((o,a)=>{s=s.add(new my(r.indexId,n,rJ(a.arrayValue),rJ(a.directionalValue)))})).next((()=>s))}jn(e,n){let r=new Gr(Jp);const i=this.Qn(n,e);if(i==null)return r;const s=Mj(n);if(s!=null){const o=e.data.field(s.fieldPath);if(gk(o))for(const a of o.arrayValue.values||[])r=r.add(new my(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new my(n.indexId,e.key,aP,i));return r}Jn(e,n,r,i,s){ft(oJ,"Updating index entries for document '%s'",n.key);const o=[];return(function(l,c,u,h,f){const g=l.getIterator(),v=c.getIterator();let x=i_(g),b=i_(v);for(;x||b;){let T=!1,A=!1;if(x&&b){const I=u(x,b);I<0?A=!0:I>0&&(T=!0)}else x!=null?A=!0:T=!0;T?(h(b),b=i_(v)):A?(f(x),x=i_(g)):(x=i_(g),b=i_(v))}})(i,s,Jp,(a=>{o.push(this.Hn(e,n,r,a))}),(a=>{o.push(this.Yn(e,n,r,a))})),xe.waitFor(o)}Gn(e){let n=1;return a_(e).ee({index:Kce,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),n=i.sequenceNumber+1})).next((()=>n))}createRange(e,n,r){r=r.sort(((o,a)=>Jp(o,a))).filter(((o,a,l)=>!a||Jp(o,l[a-1])!==0));const i=[];i.push(e);for(const o of r){const a=Jp(o,e),l=Jp(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,aP,kt.empty()),l=i[o+1].Vn(this.uid,aP,kt.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Jp(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(lJ)}getMinOffset(e,n){return xe.mapArray(this.Mn(n),(r=>this.xn(e,r).next((i=>i||Ht(44426))))).next(lJ)}}function aJ(t){return Bs(t,dk)}function o_(t){return Bs(t,GS)}function cE(t){return Bs(t,TU)}function a_(t){return Bs(t,US)}function lJ(t){nn(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;bU(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new cc(e.readTime,e.documentKey,n)}const cJ={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Jue=41943040;class Jo{static withCacheSize(e){return new Jo(e,Jo.DEFAULT_COLLECTION_PERCENTILE,Jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}function Que(t,e,n){const r=t.store(Uu),i=t.store(zw),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},((u,h,f)=>(a++,f.delete())));s.push(l.next((()=>{nn(a===1,47070,{batchId:n.batchId})})));const c=[];for(const u of n.mutations){const h=Wce(e,u.key.path,n.batchId);s.push(i.delete(h)),c.push(u.key)}return xe.waitFor(s).next((()=>c))}function H3(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ht(14731);e=t.noDocument}return JSON.stringify(e).length}Jo.DEFAULT_COLLECTION_PERCENTILE=10,Jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jo.DEFAULT=new Jo(Jue,Jo.DEFAULT_COLLECTION_PERCENTILE,Jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jo.DISABLED=new Jo(-1,0,0);class N5{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){nn(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new N5(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qp(e).ee({index:ky,range:r},((i,s,o)=>{n=!1,o.done()})).next((()=>n))}addMutationBatch(e,n,r,i){const s=L_(e),o=Qp(e);return o.add({}).next((a=>{nn(typeof a=="number",49019);const l=new NU(a,n,r,i),c=(function(g,v,x){const b=x.baseMutations.map((A=>G3(g.yt,A))),T=x.mutations.map((A=>G3(g.yt,A)));return{userId:v,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:b,mutations:T}})(this.serializer,this.userId,l),u=[];let h=new Gr(((f,g)=>In(f.canonicalString(),g.canonicalString())));for(const f of i){const g=Wce(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),u.push(o.put(c)),u.push(s.put(g,B4e))}return h.forEach((f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))})),e.addOnCommittedListener((()=>{this.Xn[a]=l.keys()})),xe.waitFor(u).next((()=>l))}))}lookupMutationBatch(e,n){return Qp(e).get(n).next((r=>r?(nn(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),fy(this.serializer,r)):null))}er(e,n){return this.Xn[n]?xe.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next((r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Qp(e).ee({index:ky,range:i},((o,a,l)=>{a.userId===this.userId&&(nn(a.batchId>=r,47524,{tr:r}),s=fy(this.serializer,a)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Gy;return Qp(e).ee({index:ky,range:n,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Gy],[this.userId,Number.POSITIVE_INFINITY]);return Qp(e).J(ky,n).next((r=>r.map((i=>fy(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=PC(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return L_(e).ee({range:i},((o,a,l)=>{const[c,u,h]=o,f=sd(u);if(c===this.userId&&n.path.isEqual(f))return Qp(e).get(h).next((g=>{if(!g)throw Ht(61480,{nr:o,batchId:h});nn(g.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:g.userId,batchId:h}),s.push(fy(this.serializer,g))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Gr(In);const i=[];return n.forEach((s=>{const o=PC(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=L_(e).ee({range:a},((c,u,h)=>{const[f,g,v]=c,x=sd(g);f===this.userId&&s.path.isEqual(x)?r=r.add(v):h.done()}));i.push(l)})),xe.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=PC(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Gr(In);return L_(e).ee({range:o},((l,c,u)=>{const[h,f,g]=l,v=sd(f);h===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(g)):u.done()})).next((()=>this.rr(e,a)))}rr(e,n){const r=[],i=[];return n.forEach((s=>{i.push(Qp(e).get(s).next((o=>{if(o===null)throw Ht(35274,{batchId:s});nn(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(fy(this.serializer,o))})))})),xe.waitFor(i).next((()=>r))}removeMutationBatch(e,n){return Que(e.le,this.userId,n).next((r=>(e.addOnCommittedListener((()=>{this.ir(n.batchId)})),xe.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((n=>{if(!n)return xe.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return L_(e).ee({range:r},((s,o,a)=>{if(s[0]===this.userId){const l=sd(s[1]);i.push(l)}else a.done()})).next((()=>{nn(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,n){return ehe(e,this.userId,n)}_r(e){return the(e).get(this.userId).next((n=>n||{userId:this.userId,lastAcknowledgedBatchId:Gy,lastStreamToken:""}))}}function ehe(t,e,n){const r=PC(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return L_(t).ee({range:s,X:!0},((a,l,c)=>{const[u,h,f]=a;u===e&&h===i&&(o=!0),c.done()})).next((()=>o))}function Qp(t){return Bs(t,Uu)}function L_(t){return Bs(t,zw)}function the(t){return Bs(t,uk)}class k1{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new k1(0)}static cr(){return new k1(-1)}}class g5e{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next((n=>{const r=new k1(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next((()=>n.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((n=>on.fromTimestamp(new Vr(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((n=>n.highestListenSequenceNumber))}setTargetsMetadata(e,n,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i))))}addTargetData(e,n){return this.Pr(e,n).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next((()=>l_(e).delete(n.targetId))).next((()=>this.lr(e))).next((r=>(nn(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,n,r){let i=0;const s=[];return l_(e).ee(((o,a)=>{const l=HE(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>xe.waitFor(s))).next((()=>i))}forEachTarget(e,n){return l_(e).ee(((r,i)=>{const s=HE(i);n(s)}))}lr(e){return uJ(e).get($3).next((n=>(nn(n!==null,2888),n)))}hr(e,n){return uJ(e).put($3,n)}Pr(e,n){return l_(e).put(Kue(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((n=>n.targetCount))}getTargetData(e,n){const r=E1(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return l_(e).ee({range:i,index:qce},((o,a,l)=>{const c=HE(a);VA(n,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,n,r){const i=[],s=$m(e);return n.forEach((o=>{const a=ua(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))})),xe.waitFor(i)}removeMatchingKeys(e,n,r){const i=$m(e);return xe.forEach(n,(s=>{const o=ua(s.path);return xe.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,n){const r=$m(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=$m(e);let s=Bn();return i.ee({range:r,X:!0},((o,a,l)=>{const c=sd(o[1]),u=new kt(c);s=s.add(u)})).next((()=>s))}containsKey(e,n){const r=ua(n.path),i=IDBKeyRange.bound([r],[jce(r)],!1,!0);let s=0;return $m(e).ee({index:SU,X:!0,range:i},(([o,a],l,c)=>{o!==0&&(s++,c.done())})).next((()=>s>0))}At(e,n){return l_(e).get(n).next((r=>r?HE(r):null))}}function l_(t){return Bs(t,Uw)}function uJ(t){return Bs(t,By)}function $m(t){return Bs(t,Gw)}const hJ="LruGarbageCollector",y5e=1048576;function dJ([t,e],[n,r]){const i=In(t,n);return i===0?In(e,r):i}class v5e{constructor(e){this.Ir=e,this.buffer=new Gr(dJ),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();dJ(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class nhe{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ft(hJ,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){qg(n)?ft(hJ,"Ignoring IndexedDB error during garbage collection: ",n):await ev(n)}await this.Vr(3e5)}))}}class _5e{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return xe.resolve(Yc.ce);const r=new v5e(n);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ft("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(cJ)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ft("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cJ):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((h=>(h>this.params.maximumSequenceNumbersToCollect?(ft("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i)))).next((h=>(r=h,a=Date.now(),this.removeTargets(e,r,n)))).next((h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((h=>(c=Date.now(),C_()<=Jn.DEBUG&&ft("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h}))))}}function rhe(t,e){return new _5e(t,e)}class x5e{constructor(e,n){this.db=e,this.garbageCollector=rhe(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,((r,i)=>n(i)))}addReference(e,n,r){return lP(e,r)}removeReference(e,n,r){return lP(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return lP(e,n)}br(e,n){return(function(i,s){let o=!1;return the(i).te((a=>ehe(i,a,s).next((l=>(l&&(o=!0),xe.resolve(!l)))))).next((()=>o))})(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=n){const l=this.br(e,o).next((c=>{if(!c)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,on.min()),$m(e).delete((function(h){return[0,ua(h.path)]})(o)))))}));i.push(l)}})).next((()=>xe.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return lP(e,n)}Sr(e,n){const r=$m(e);let i,s=Yc.ce;return r.ee({index:SU},(([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==Yc.ce&&n(new kt(sd(i)),s),s=c,i=l):s=Yc.ce})).next((()=>{s!==Yc.ce&&n(new kt(sd(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lP(t,e){return $m(t).put((function(r,i){return{targetId:0,path:ua(r.path),sequenceNumber:i}})(e,t.currentSequenceNumber))}class ihe{constructor(){this.changes=new yp((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Zi.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?xe.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class w5e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return T0(e).put(r)}removeEntry(e,n,r){return T0(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],B3(o),a[a.length-1]]})(n,r))}updateMetadata(e,n){return this.getMetadata(e).next((r=>(r.byteSize+=n,this.Dr(e,r))))}getEntry(e,n){let r=Zi.newInvalidDocument(n);return T0(e).ee({index:CC,range:IDBKeyRange.only(uE(n))},((i,s)=>{r=this.Cr(n,s)})).next((()=>r))}vr(e,n){let r={size:0,document:Zi.newInvalidDocument(n)};return T0(e).ee({index:CC,range:IDBKeyRange.only(uE(n))},((i,s)=>{r={document:this.Cr(n,s),size:H3(s)}})).next((()=>r))}getEntries(e,n){let r=nc();return this.Fr(e,n,((i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)})).next((()=>r))}Mr(e,n){let r=nc(),i=new Ei(kt.comparator);return this.Fr(e,n,((s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,H3(o))})).next((()=>({documents:r,Or:i})))}Fr(e,n,r){if(n.isEmpty())return xe.resolve();let i=new Gr(mJ);n.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(uE(i.first()),uE(i.last())),o=i.getIterator();let a=o.getNext();return T0(e).ee({index:CC,range:s},((l,c,u)=>{const h=kt.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&mJ(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(uE(a)):u.done()})).next((()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),B3(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return T0(e).J(IDBKeyRange.bound(a,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let u=nc();for(const h of c){const f=this.Cr(kt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(UA(n,f)||i.has(f.key))&&(u=u.insert(f.key,f))}return u}))}getAllFromCollectionGroup(e,n,r,i){let s=nc();const o=pJ(n,r),a=pJ(n,cc.max());return T0(e).ee({index:Hce,range:IDBKeyRange.bound(o,a,!0)},((l,c,u)=>{const h=this.Cr(kt.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&u.done()})).next((()=>s))}newChangeBuffer(e){return new b5e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((n=>n.byteSize))}getMetadata(e){return fJ(e).get(Nj).next((n=>(nn(!!n,20021),n)))}Dr(e,n){return fJ(e).put(Nj,n)}Cr(e,n){if(n){const r=o5e(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(on.min())))return r}return Zi.newInvalidDocument(e)}}function she(t){return new w5e(t)}class b5e extends ihe{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new yp((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const n=[];let r=0,i=new Gr(((s,o)=>In(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=XZ(this.Nr.serializer,o);i=i.add(s.path.popLast());const c=H3(l);r+=c-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=XZ(this.Nr.serializer,o.convertToNoDocument(on.min()));n.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),n.push(this.Nr.updateMetadata(e,r)),xe.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next((r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next((({documents:r,Or:i})=>(i.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}}function fJ(t){return Bs(t,hk)}function T0(t){return Bs(t,D3)}function uE(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function pJ(t,e){const n=e.documentKey.path.toArray();return[t,B3(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function mJ(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=In(n[s],r[s]),i)return i;return i=In(n.length,r.length),i||(i=In(n[n.length-2],r[r.length-2]),i||In(n[n.length-1],r[r.length-1]))}class E5e{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class ohe{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,n)))).next((i=>(r!==null&&qS(r.mutation,i,pl.empty(),Vr.now()),i)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,Bn()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=Bn()){const i=od();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,r).next((s=>{let o=BE();return s.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=od();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,Bn())))}populateOverlays(e,n,r){const i=[];return r.forEach((s=>{n.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,a)=>{n.set(o,a)}))}))}computeViews(e,n,r,i){let s=nc();const o=HS(),a=(function(){return HS()})();return n.forEach(((l,c)=>{const u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof vp)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),qS(u.mutation,c,u.mutation.getFieldMask(),Vr.now())):o.set(c.key,pl.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,u)=>o.set(c,u))),n.forEach(((c,u)=>a.set(c,new E5e(u,o.get(c)??null)))),a)))}recalculateAndSaveOverlays(e,n){const r=HS();let i=new Ei(((o,a)=>o-a)),s=Bn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const a of o)a.keys().forEach((l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||pl.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(i.get(a.batchId)||Bn()).add(l);i=i.insert(a.batchId,h)}))})).next((()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=Eue();u.forEach((f=>{if(!s.has(f)){const g=Pue(n.get(f),r.get(f));g!==null&&h.set(f,g),s=s.add(f)}})),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return xe.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return kt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):vue(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):xe.resolve(od());let a=ak,l=s;return o.next((c=>xe.forEach(c,((u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?xe.resolve():this.remoteDocumentCache.getEntry(e,u).next((f=>{l=l.insert(u,f)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,Bn()))).next((u=>({batchId:a,changes:bue(u)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new kt(n)).next((r=>{let i=BE();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=BE();return this.indexManager.getCollectionParents(e,s).next((a=>xe.forEach(a,(l=>{const c=(function(h,f){return new zA(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((u=>{u.forEach(((h,f)=>{o=o.insert(h,f)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i)))).next((o=>{s.forEach(((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Zi.newInvalidDocument(u)))}));let a=BE();return o.forEach(((l,c)=>{const u=s.get(l);u!==void 0&&qS(u.mutation,c,pl.empty(),Vr.now()),UA(n,c)&&(a=a.insert(l,c))})),a}))}}class S5e{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return xe.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Oa(i.createTime)}})(n)),xe.resolve()}getNamedQuery(e,n){return xe.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(i){return{name:i.name,query:Yue(i.bundledQuery),readTime:Oa(i.readTime)}})(n)),xe.resolve()}}class T5e{constructor(){this.overlays=new Ei(kt.comparator),this.qr=new Map}getOverlay(e,n){return xe.resolve(this.overlays.get(n))}getOverlays(e,n){const r=od();return xe.forEach(n,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((i,s)=>{this.St(e,n,s)})),xe.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),xe.resolve()}getOverlaysForCollection(e,n,r){const i=od(),s=n.length+1,o=new kt(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return xe.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ei(((c,u)=>c-u));const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=od(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=od(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>a.set(c,u))),!(a.size()>=i)););return xe.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new LU(n,r));let s=this.qr.get(n);s===void 0&&(s=Bn(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}class k5e{constructor(){this.sessionToken=As.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,xe.resolve()}}class VU{constructor(){this.Qr=new Gr(eo.$r),this.Ur=new Gr(eo.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new eo(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new eo(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new kt(new Er([])),r=new eo(n,e),i=new eo(n,e+1),s=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new kt(new Er([])),r=new eo(n,e),i=new eo(n,e+1);let s=Bn();return this.Ur.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){const n=new eo(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class eo{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return kt.comparator(e.key,n.key)||In(e.Yr,n.Yr)}static Kr(e,n){return In(e.Yr,n.Yr)||kt.comparator(e.key,n.key)}}class A5e{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Gr(eo.$r)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new NU(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new eo(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return xe.resolve(o)}lookupMutationBatch(e,n){return xe.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return xe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?Gy:this.tr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new eo(n,0),i=new eo(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(o=>{const a=this.Xr(o.Yr);s.push(a)})),xe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Gr(In);return n.forEach((i=>{const s=new eo(i,0),o=new eo(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{r=r.add(a.Yr)}))})),xe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;kt.isDocumentKey(s)||(s=s.child(""));const o=new eo(new kt(s),0);let a=new Gr(In);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Yr)),!0)}),o),xe.resolve(this.ti(a))}ti(e){const n=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&n.push(i)})),n}removeMutationBatch(e,n){nn(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return xe.forEach(n.mutations,(i=>{const s=new eo(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new eo(n,0),i=this.Zr.firstAfterOrEqual(r);return xe.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class I5e{constructor(e){this.ri=e,this.docs=(function(){return new Ei(kt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return xe.resolve(r?r.document.mutableCopy():Zi.newInvalidDocument(n))}getEntries(e,n){let r=nc();return n.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Zi.newInvalidDocument(i))})),xe.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=nc();const o=n.path,a=new kt(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||bU(zce(u),r)<=0||(i.has(u.key)||UA(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return xe.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ht(9500)}ii(e,n){return xe.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new R5e(this)}getSize(e){return xe.resolve(this.size)}}class R5e extends ihe{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),xe.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class P5e{constructor(e){this.persistence=e,this.si=new yp((n=>E1(n)),VA),this.lastRemoteSnapshotVersion=on.min(),this.highestTargetId=0,this.oi=0,this._i=new VU,this.targetCount=0,this.ai=k1.ur()}forEachTarget(e,n){return this.si.forEach(((r,i)=>n(i))),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),xe.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new k1(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,xe.resolve()}updateTargetData(e,n){return this.Pr(n),xe.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),xe.waitFor(s).next((()=>i))}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return xe.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),xe.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),xe.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),xe.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return xe.resolve(r)}containsKey(e,n){return xe.resolve(this._i.containsKey(n))}}class zU{constructor(e,n){this.ui={},this.overlays={},this.ci=new Yc(0),this.li=!1,this.li=!0,this.hi=new k5e,this.referenceDelegate=e(this),this.Pi=new P5e(this),this.indexManager=new p5e,this.remoteDocumentCache=(function(i){return new I5e(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new que(n),this.Ii=new S5e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new T5e,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new A5e(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ft("MemoryPersistence","Starting transaction:",e);const i=new C5e(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,n){return xe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class C5e extends Gce{constructor(e){super(),this.currentSequenceNumber=e}}class O5{constructor(e){this.persistence=e,this.Ri=new VU,this.Vi=null}static mi(e){return new O5(e)}get fi(){if(this.Vi)return this.Vi;throw Ht(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),xe.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),xe.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),xe.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.fi,(r=>{const i=kt.fromPath(r);return this.gi(e,i).next((s=>{s||n.removeEntry(i,on.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return xe.or([()=>xe.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class q3{constructor(e,n){this.persistence=e,this.pi=new yp((r=>ua(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=rhe(this,n)}static mi(e,n){return new q3(e,n)}Ei(){}di(e){return xe.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return xe.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?xe.resolve():n(i)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,n).next((a=>{a||(r++,s.removeEntry(o,on.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),xe.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),xe.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=NC(e.data.value)),n}br(e,n,r){return xe.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return xe.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class M5e{constructor(e){this.serializer=e}k(e,n,r,i){const s=new _5("createOrUpgrade",n);r<1&&i>=1&&((function(l){l.createObjectStore(FA)})(e),(function(l){l.createObjectStore(uk,{keyPath:G4e}),l.createObjectStore(Uu,{keyPath:kZ,autoIncrement:!0}).createIndex(ky,AZ,{unique:!0}),l.createObjectStore(zw)})(e),gJ(e),(function(l){l.createObjectStore(z0)})(e));let o=xe.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(Gw),l.deleteObjectStore(Uw),l.deleteObjectStore(By)})(e),gJ(e)),o=o.next((()=>(function(l){const c=l.store(By),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:on.min().toTimestamp(),targetCount:0};return c.put($3,u)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(l,c){return c.store(Uu).J().next((h=>{l.deleteObjectStore(Uu),l.createObjectStore(Uu,{keyPath:kZ,autoIncrement:!0}).createIndex(ky,AZ,{unique:!0});const f=c.store(Uu),g=h.map((v=>f.put(v)));return xe.waitFor(g)}))})(e,s)))),o=o.next((()=>{(function(l){l.createObjectStore(Bw,{keyPath:J4e})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(l){l.createObjectStore(hk)})(e),this.wi(s))))),r<7&&i>=7&&(o=o.next((()=>this.Si(s)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(l){l.createObjectStore(w5,{keyPath:Q4e})})(e),(function(l){l.createObjectStore(b5,{keyPath:eNe})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(l){const c=l.createObjectStore(E5,{keyPath:aNe});c.createIndex(Lj,lNe,{unique:!1}),c.createIndex(Xce,cNe,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(l){const c=l.createObjectStore(D3,{keyPath:W4e});c.createIndex(CC,H4e),c.createIndex(Hce,q4e)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(z0)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(l){l.createObjectStore(TU,{keyPath:tNe,autoIncrement:!0}).createIndex(Oj,nNe,{unique:!1}),l.createObjectStore(US,{keyPath:rNe}).createIndex(Kce,iNe,{unique:!1}),l.createObjectStore(GS,{keyPath:sNe}).createIndex(Yce,oNe,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{n.objectStore(US).clear()})).next((()=>{n.objectStore(GS).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(l){l.createObjectStore(kU,{keyPath:uNe})})(e)}))),r<18&&i>=18&&Ble()&&(o=o.next((()=>{n.objectStore(US).clear()})).next((()=>{n.objectStore(GS).clear()}))),o}wi(e){let n=0;return e.store(z0).ee(((r,i)=>{n+=H3(i)})).next((()=>{const r={byteSize:n};return e.store(hk).put(Nj,r)}))}yi(e){const n=e.store(uk),r=e.store(Uu);return n.J().next((i=>xe.forEach(i,(s=>{const o=IDBKeyRange.bound([s.userId,Gy],[s.userId,s.lastAcknowledgedBatchId]);return r.J(ky,o).next((a=>xe.forEach(a,(l=>{nn(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=fy(this.serializer,l);return Que(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const n=e.store(Gw),r=e.store(z0);return e.store(By).get($3).next((i=>{const s=[];return r.ee(((o,a)=>{const l=new Er(o),c=(function(h){return[0,ua(h)]})(l);s.push(n.get(c).next((u=>u?xe.resolve():(h=>n.put({targetId:0,path:ua(h),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>xe.waitFor(s)))}))}bi(e,n){e.createObjectStore(dk,{keyPath:Z4e});const r=n.store(dk),i=new FU,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:ua(l)})}};return n.store(z0).ee({X:!0},((o,a)=>{const l=new Er(o);return s(l.popLast())})).next((()=>n.store(zw).ee({X:!0},(([o,a,l],c)=>{const u=sd(a);return s(u.popLast())}))))}Di(e){const n=e.store(Uw);return n.ee(((r,i)=>{const s=HE(i),o=Kue(this.serializer,s);return n.put(o)}))}Ci(e,n){const r=n.store(z0),i=[];return r.ee(((s,o)=>{const a=n.store(D3),l=(function(h){return h.document?new kt(Er.fromString(h.document.name).popFirst(5)):h.noDocument?kt.fromSegments(h.noDocument.path):h.unknownDocument?kt.fromSegments(h.unknownDocument.path):Ht(36783)})(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))})).next((()=>xe.waitFor(i)))}Fi(e,n){const r=n.store(Uu),i=she(this.serializer),s=new zU(O5.mi,this.serializer.yt);return r.J().next((o=>{const a=new Map;return o.forEach((l=>{let c=a.get(l.userId)??Bn();fy(this.serializer,l).keys().forEach((u=>c=c.add(u))),a.set(l.userId,c)})),xe.forEach(a,((l,c)=>{const u=new Ao(c),h=M5.wt(this.serializer,u),f=s.getIndexManager(u),g=N5.wt(u,this.serializer,f,s.referenceDelegate);return new ohe(i,g,h,f).recalculateAndSaveOverlaysForDocumentKeys(new Dj(n,Yc.ce),l).next()}))}))}}function gJ(t){t.createObjectStore(Gw,{keyPath:Y4e}).createIndex(SU,X4e,{unique:!0}),t.createObjectStore(Uw,{keyPath:"targetId"}).createIndex(qce,K4e,{unique:!0}),t.createObjectStore(By)}const em="IndexedDbPersistence",D6=18e5,$6=5e3,j6="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",N5e="main";class UU{constructor(e,n,r,i,s,o,a,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=f=>Promise.resolve(),!UU.v())throw new St(We.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new x5e(this,i),this.$i=n+N5e,this.serializer=new que(l),this.Ui=new dg(this.$i,this.Ni,new M5e(this.serializer)),this.hi=new l5e,this.Pi=new g5e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=she(this.serializer),this.Ii=new a5e,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&Ra(em,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new St(We.FAILED_PRECONDITION,j6);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Yc(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async n=>{n.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>cP(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((n=>this.isPrimary&&!n?this.Zi(e).next((()=>!1)):!!n&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(qg(e))return ft(em,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ft(em,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return hE(e).get(r_).next((n=>xe.resolve(this.es(n))))}ts(e){return cP(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,D6)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(n=>{const r=Bs(n,Bw);return r.J().next((i=>{const s=this.ss(i,D6),o=i.filter((a=>s.indexOf(a)===-1));return xe.forEach(o,(a=>r.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?xe.resolve(!0):hE(e).get(r_).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,$6)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new St(We.FAILED_PRECONDITION,j6);return!1}}return!(!this.networkEnabled||!this.inForeground)||cP(e).J().next((r=>this.ss(r,$6).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((n=>(this.isPrimary!==n&&ft(em,`Client ${n?"is":"is not"} eligible for a primary lease.`),n)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[FA,Bw],(e=>{const n=new Dj(e,Yc.ce);return this.Zi(n).next((()=>this.ts(n)))})),this.Ui.close(),this.Ps()}ss(e,n){return e.filter((r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>cP(e).J().next((n=>this.ss(n,D6).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return N5.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new m5e(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return M5.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ft(em,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?fNe:l===17?eue:l===16?dNe:l===15?AU:l===14?Qce:l===13?Jce:l===12?hNe:l===11?Zce:void Ht(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,s,(a=>(o=new Dj(a,this.ci?this.ci.next():Yc.ce),n==="readwrite-primary"?this.Hi(o).next((l=>!!l||this.Yi(o))).next((l=>{if(!l)throw Ra(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new St(We.FAILED_PRECONDITION,Uce);return r(o)})).next((l=>this.Xi(o).next((()=>l)))):this.Is(o).next((()=>r(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return hE(e).get(r_).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,$6)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new St(We.FAILED_PRECONDITION,j6)}))}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return hE(e).put(r_,n)}static v(){return dg.v()}Zi(e){const n=hE(e);return n.get(r_).next((r=>this.es(r)?(ft(em,"Releasing primary lease."),n.delete(r_)):xe.resolve()))}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ra(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Gle()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const n=this.Ki?.getItem(this._s(e))!==null;return ft(em,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ra(em,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ra("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function hE(t){return Bs(t,FA)}function cP(t){return Bs(t,Bw)}function O5e(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class GU{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Bn(),i=Bn();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new GU(e,n.fromCache,r,i)}}class L5e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ahe{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Gle()?8:Bce(Us())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,n,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new L5e;return this.Ss(e,n,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)}))})).next((()=>s.result))}bs(e,n,r,i){return r.documentReadCount<this.fs?(C_()<=Jn.DEBUG&&ft("QueryEngine","SDK will not create cache indexes for query:",M_(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xe.resolve()):(C_()<=Jn.DEBUG&&ft("QueryEngine","Query:",M_(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(C_()<=Jn.DEBUG&&ft("QueryEngine","The SDK decides to create cache indexes for query:",M_(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qc(n))):xe.resolve())}ys(e,n){if(VZ(n))return xe.resolve(null);let r=Qc(n);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(n.limit!==null&&i===1&&(n=Gj(n,null,"F"),r=Qc(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const o=Bn(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(n,a);return this.Cs(n,c,o,l.readTime)?this.ys(e,Gj(n,null,"F")):this.vs(e,c,n,l)}))))})))))}ws(e,n,r,i){return VZ(n)||i.isEqual(on.min())?xe.resolve(null):this.ps.getDocuments(e,r).next((s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?xe.resolve(null):(C_()<=Jn.DEBUG&&ft("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),M_(n)),this.vs(e,o,n,D4e(i,ak)).next((a=>a)))}))}Ds(e,n){let r=new Gr(xue(e));return n.forEach(((i,s)=>{UA(e,s)&&(r=r.add(s))})),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return C_()<=Jn.DEBUG&&ft("QueryEngine","Using full collection scan to execute query:",M_(n)),this.ps.getDocumentsMatchingQuery(e,n,cc.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(n.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const BU="LocalStore",D5e=3e8;class $5e{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new Ei(In),this.xs=new yp((s=>E1(s)),VA),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ohe(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function lhe(t,e,n,r){return new $5e(t,e,n,r)}async function che(t,e){const n=Rn(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],a=[];let l=Bn();for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:o,addedBatchIds:a})))}))}))}function j5e(t,e){const n=Rn(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,u){const h=c.batch,f=h.keys();let g=xe.resolve();return f.forEach((v=>{g=g.next((()=>u.getEntry(l,v))).next((x=>{const b=c.docVersions.get(v);nn(b!==null,48541),x.version.compareTo(b)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),u.addEntry(x)))}))})),g.next((()=>a.mutationQueue.removeMutationBatch(l,h)))})(n,r,e,s).next((()=>s.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let l=Bn();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e)))).next((()=>n.localDocuments.getDocuments(r,i)))}))}function uhe(t){const e=Rn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function F5e(t,e){const n=Rn(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach(((u,h)=>{const f=i.get(h);if(!f)return;a.push(n.Pi.removeMatchingKeys(s,u.removedDocuments,h).next((()=>n.Pi.addMatchingKeys(s,u.addedDocuments,h))));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(As.EMPTY_BYTE_STRING,on.min()).withLastLimboFreeSnapshotVersion(on.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),i=i.insert(h,g),(function(x,b,T){return x.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=D5e?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(f,g,u)&&a.push(n.Pi.updateTargetData(s,g))}));let l=nc(),c=Bn();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))})),a.push(V5e(s,o,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!r.isEqual(on.min())){const u=n.Pi.getLastRemoteSnapshotVersion(s).next((h=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));a.push(u)}return xe.waitFor(a).next((()=>o.apply(s))).next((()=>n.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(n.Ms=i,s)))}function V5e(t,e,n){let r=Bn(),i=Bn();return n.forEach((s=>r=r.add(s))),e.getEntries(t,r).next((s=>{let o=nc();return n.forEach(((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(on.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ft(BU,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)})),{ks:o,qs:i}}))}function z5e(t,e){const n=Rn(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Gy),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function U5e(t,e){const n=Rn(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return n.Pi.getTargetData(r,e).next((s=>s?(i=s,xe.resolve(i)):n.Pi.allocateTargetId(r).next((o=>(i=new Ff(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function Zj(t,e,n){const r=Rn(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!qg(o))throw o;ft(BU,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function yJ(t,e,n){const r=Rn(t);let i=on.min(),s=Bn();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,c,u){const h=Rn(l),f=h.xs.get(u);return f!==void 0?xe.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)})(r,o,Qc(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:on.min(),n?s:Bn()))).next((a=>(G5e(r,INe(e),a),{documents:a,Qs:s})))))}function G5e(t,e,n){let r=t.Os.get(e)||on.min();n.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),t.Os.set(e,r)}class vJ{constructor(){this.activeTargetIds=ONe()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hhe{constructor(){this.Mo=new vJ,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new vJ,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class B5e{Oo(e){}shutdown(){}}const _J="ConnectivityMonitor";class xJ{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ft(_J,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ft(_J,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let uP=null;function Jj(){return uP===null?uP=(function(){return 268435456+Math.round(2147483648*Math.random())})():uP++,"0x"+uP.toString(16)}const F6="RestConnection",W5e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class H5e{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===j3?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Jj(),a=this.zo(e,n.toUriEncodedString());ft(F6,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(a),u=J1(c);return this.Jo(e,a,l,r,u).then((h=>(ft(F6,`Received RPC '${e}' ${o}: `,h),h)),(h=>{throw w1(F6,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h}))}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+$2})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,n){const r=W5e[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class q5e{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Vo="WebChannelConnection";class K5e extends H5e{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Jj();return new Promise(((a,l)=>{const c=new Cce;c.setWithCredentials(!0),c.listenOnce(Mce.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case IC.NO_ERROR:const h=c.getResponseJson();ft(Vo,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case IC.TIMEOUT:ft(Vo,`RPC '${e}' ${o} timed out`),l(new St(We.DEADLINE_EXCEEDED,"Request time out"));break;case IC.HTTP_ERROR:const f=c.getStatus();if(ft(Vo,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const v=g?.error;if(v&&v.status&&v.message){const x=(function(T){const A=T.toLowerCase().replace(/_/g,"-");return Object.values(We).indexOf(A)>=0?A:We.UNKNOWN})(v.status);l(new St(x,v.message))}else l(new St(We.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new St(We.UNAVAILABLE,"Connection failed."));break;default:Ht(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ft(Vo,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(i);ft(Vo,`RPC '${e}' ${o} sending request:`,i),c.send(n,"POST",u,r,15)}))}T_(e,n,r){const i=Jj(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Lce(),a=Oce(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=s.join("");ft(Vo,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,g=!1;const v=new q5e({Yo:b=>{g?ft(Vo,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(f||(ft(Vo,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),ft(Vo,`RPC '${e}' stream ${i} sending:`,b),h.send(b))},Zo:()=>h.close()}),x=(b,T,A)=>{b.listen(T,(I=>{try{A(I)}catch(R){setTimeout((()=>{throw R}),0)}}))};return x(h,GE.EventType.OPEN,(()=>{g||(ft(Vo,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),x(h,GE.EventType.CLOSE,(()=>{g||(g=!0,ft(Vo,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(h))})),x(h,GE.EventType.ERROR,(b=>{g||(g=!0,w1(Vo,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),v.a_(new St(We.UNAVAILABLE,"The operation could not be completed")))})),x(h,GE.EventType.MESSAGE,(b=>{if(!g){const T=b.data[0];nn(!!T,16349);const A=T,I=A?.error||A[0]?.error;if(I){ft(Vo,`RPC '${e}' stream ${i} received error:`,I);const R=I.status;let M=(function(N){const O=gs[N];if(O!==void 0)return Nue(O)})(R),F=I.message;M===void 0&&(M=We.INTERNAL,F="Unknown error status: "+R+" with message "+I.message),g=!0,v.a_(new St(M,F)),h.close()}else ft(Vo,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),x(a,Nce.STAT_EVENT,(b=>{b.stat===Pj.PROXY?ft(Vo,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===Pj.NOPROXY&&ft(Vo,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Y5e(){return typeof window<"u"?window:null}function jC(){return typeof document<"u"?document:null}function L5(t){return new XNe(t,!0)}class dhe{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ft("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const wJ="PersistentStream";class fhe{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new dhe(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===We.RESOURCE_EXHAUSTED?(Ra(n.toString()),Ra("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===We.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===n&&this.G_(r,i)}),(r=>{e((()=>{const i=new St(We.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ft(wJ,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(ft(wJ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class X5e extends fhe{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=QNe(this.serializer,e),r=(function(s){if(!("targetChange"in s))return on.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?on.min():o.readTime?Oa(o.readTime):on.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Hj(this.serializer),n.addTarget=(function(s,o){let a;const l=o.target;if(a=V3(l)?{documents:zue(s,l)}:{query:Uue(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Due(s,o.resumeToken);const c=Bj(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(on.min())>0){a.readTime=Jw(s,o.snapshotVersion.toTimestamp());const c=Bj(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);const r=t5e(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Hj(this.serializer),n.removeTarget=e,this.q_(n)}}class Z5e extends fhe{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return nn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,nn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){nn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=e5e(e.writeResults,e.commitTime),r=Oa(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Hj(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>G3(this.serializer,r)))};this.q_(n)}}class J5e{}class Q5e extends J5e{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new St(We.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,Wj(n,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new St(We.UNKNOWN,s.toString())}))}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,Wj(n,r),i,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new St(We.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class eOe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ra(n),this.aa=!1):ft("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const A1="RemoteStore";class tOe{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{tv(this)&&(ft(A1,"Restarting streams for network reachability change."),await(async function(l){const c=Rn(l);c.Ea.add(4),await BA(c),c.Ra.set("Unknown"),c.Ea.delete(4),await D5(c)})(this))}))})),this.Ra=new eOe(r,i)}}async function D5(t){if(tv(t))for(const e of t.da)await e(!0)}async function BA(t){for(const e of t.da)await e(!1)}function phe(t,e){const n=Rn(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),KU(n)?qU(n):F2(n).O_()&&HU(n,e))}function WU(t,e){const n=Rn(t),r=F2(n);n.Ia.delete(e),r.O_()&&mhe(n,e),n.Ia.size===0&&(r.O_()?r.L_():tv(n)&&n.Ra.set("Unknown"))}function HU(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(on.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}F2(t).Y_(e)}function mhe(t,e){t.Va.Ue(e),F2(t).Z_(e)}function qU(t){t.Va=new HNe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),F2(t).start(),t.Ra.ua()}function KU(t){return tv(t)&&!F2(t).x_()&&t.Ia.size>0}function tv(t){return Rn(t).Ea.size===0}function ghe(t){t.Va=void 0}async function nOe(t){t.Ra.set("Online")}async function rOe(t){t.Ia.forEach(((e,n)=>{HU(t,e)}))}async function iOe(t,e){ghe(t),KU(t)?(t.Ra.ha(e),qU(t)):t.Ra.set("Unknown")}async function sOe(t,e,n){if(t.Ra.set("Online"),e instanceof Lue&&e.state===2&&e.cause)try{await(async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))})(t,e)}catch(r){ft(A1,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await K3(t,r)}else if(e instanceof DC?t.Va.Ze(e):e instanceof Oue?t.Va.st(e):t.Va.tt(e),!n.isEqual(on.min()))try{const r=await uhe(t.localStore);n.compareTo(r)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.Ia.get(c);u&&s.Ia.set(c,u.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,c)=>{const u=s.Ia.get(l);if(!u)return;s.Ia.set(l,u.withResumeToken(As.EMPTY_BYTE_STRING,u.snapshotVersion)),mhe(s,l);const h=new Ff(u.target,l,c,u.sequenceNumber);HU(s,h)})),s.remoteSyncer.applyRemoteEvent(a)})(t,n)}catch(r){ft(A1,"Failed to raise snapshot:",r),await K3(t,r)}}async function K3(t,e,n){if(!qg(e))throw e;t.Ea.add(1),await BA(t),t.Ra.set("Offline"),n||(n=()=>uhe(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ft(A1,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await D5(t)}))}function yhe(t,e){return e().catch((n=>K3(t,n,e)))}async function WA(t){const e=Rn(t),n=Ig(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gy;for(;oOe(e);)try{const i=await z5e(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,aOe(e,i)}catch(i){await K3(e,i)}vhe(e)&&_he(e)}function oOe(t){return tv(t)&&t.Ta.length<10}function aOe(t,e){t.Ta.push(e);const n=Ig(t);n.O_()&&n.X_&&n.ea(e.mutations)}function vhe(t){return tv(t)&&!Ig(t).x_()&&t.Ta.length>0}function _he(t){Ig(t).start()}async function lOe(t){Ig(t).ra()}async function cOe(t){const e=Ig(t);for(const n of t.Ta)e.ea(n.mutations)}async function uOe(t,e,n){const r=t.Ta.shift(),i=OU.from(r,e,n);await yhe(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await WA(t)}async function hOe(t,e){e&&Ig(t).X_&&await(async function(r,i){if((function(o){return GNe(o)&&o!==We.ABORTED})(i.code)){const s=r.Ta.shift();Ig(r).B_(),await yhe(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await WA(r)}})(t,e),vhe(t)&&_he(t)}async function bJ(t,e){const n=Rn(t);n.asyncQueue.verifyOperationInProgress(),ft(A1,"RemoteStore received new credentials");const r=tv(n);n.Ea.add(3),await BA(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await D5(n)}async function dOe(t,e){const n=Rn(t);e?(n.Ea.delete(2),await D5(n)):e||(n.Ea.add(2),await BA(n),n.Ra.set("Unknown"))}function F2(t){return t.ma||(t.ma=(function(n,r,i){const s=Rn(n);return s.sa(),new X5e(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Xo:nOe.bind(null,t),t_:rOe.bind(null,t),r_:iOe.bind(null,t),H_:sOe.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),KU(t)?qU(t):t.Ra.set("Unknown")):(await t.ma.stop(),ghe(t))}))),t.ma}function Ig(t){return t.fa||(t.fa=(function(n,r,i){const s=Rn(n);return s.sa(),new Z5e(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:lOe.bind(null,t),r_:hOe.bind(null,t),ta:cOe.bind(null,t),na:uOe.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await WA(t)):(await t.fa.stop(),t.Ta.length>0&&(ft(A1,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class YU{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new hd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new YU(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new St(We.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function XU(t,e){if(Ra("AsyncQueue",`${e}: ${t}`),qg(t))return new St(We.UNAVAILABLE,`${e}: ${t}`);throw t}class zx{static emptySet(e){return new zx(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||kt.comparator(n.key,r.key):(n,r)=>kt.comparator(n.key,r.key),this.keyedMap=BE(),this.sortedSet=new Ei(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof zx)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new zx;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class EJ{constructor(){this.ga=new Ei(kt.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ht(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Qw{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach((a=>{o.push({type:0,doc:a})})),new Qw(e,n,zx.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&A5(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class fOe{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class pOe{constructor(){this.queries=SJ(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Rn(n),s=i.queries;i.queries=SJ(),s.forEach(((o,a)=>{for(const l of a.Sa)l.onError(r)}))})(this,new St(We.ABORTED,"Firestore shutting down"))}}function SJ(){return new yp((t=>_ue(t)),A5)}async function xhe(t,e){const n=Rn(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new fOe,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=XU(o,`Initialization of query '${M_(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&ZU(n)}async function whe(t,e){const n=Rn(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function mOe(t,e){const n=Rn(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&ZU(n)}function gOe(t,e,n){const r=Rn(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function ZU(t){t.Ca.forEach((e=>{e.next()}))}var Qj,TJ;(TJ=Qj||(Qj={})).Ma="default",TJ.Cache="cache";class bhe{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Qw(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Qw.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Qj.Cache}}class Ehe{constructor(e){this.key=e}}class She{constructor(e){this.key=e}}class yOe{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Bn(),this.mutatedKeys=Bn(),this.eu=xue(e),this.tu=new zx(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new EJ,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((u,h)=>{const f=i.get(u),g=UA(this.query,h)?h:null,v=!!f&&this.mutatedKeys.has(f.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let b=!1;f&&g?f.data.isEqual(g.data)?v!==x&&(r.track({type:3,doc:g}),b=!0):this.su(f,g)||(r.track({type:2,doc:g}),b=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),b=!0):f&&!g&&(r.track({type:1,doc:f}),b=!0,(l||c)&&(a=!0)),b&&(g?(o=o.add(g),s=x?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((u,h)=>(function(g,v){const x=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ht(20277,{Rt:b})}};return x(g)-x(v)})(u.type,h.type)||this.eu(u.doc,h.doc))),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Qw(this.query,e.tu,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new EJ,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Bn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new She(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new Ehe(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=Bn();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Qw.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const JU="SyncEngine";class vOe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class _Oe{constructor(e){this.key=e,this.hu=!1}}class xOe{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new yp((a=>_ue(a)),A5),this.Iu=new Map,this.Eu=new Set,this.du=new Ei(kt.comparator),this.Au=new Map,this.Ru=new VU,this.Vu={},this.mu=new Map,this.fu=k1.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wOe(t,e,n=!0){const r=Phe(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await The(r,e,n,!0),i}async function bOe(t,e){const n=Phe(t);await The(n,e,!0,!1)}async function The(t,e,n,r){const i=await U5e(t.localStore,Qc(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await EOe(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&phe(t.remoteStore,i),a}async function EOe(t,e,n,r,i){t.pu=(h,f,g)=>(async function(x,b,T,A){let I=b.view.ru(T);I.Cs&&(I=await yJ(x.localStore,b.query,!1).then((({documents:C})=>b.view.ru(C,I))));const R=A&&A.targetChanges.get(b.targetId),M=A&&A.targetMismatches.get(b.targetId)!=null,F=b.view.applyChanges(I,x.isPrimaryClient,R,M);return AJ(x,b.targetId,F.au),F.snapshot})(t,h,f,g);const s=await yJ(t.localStore,e,!0),o=new yOe(e,s.Qs),a=o.ru(s.documents),l=GA.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);AJ(t,n,c.au);const u=new vOe(e,n,o);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function SOe(t,e,n){const r=Rn(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!A5(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Zj(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&WU(r.remoteStore,i.targetId),eF(r,i.targetId)})).catch(ev)):(eF(r,i.targetId),await Zj(r.localStore,i.targetId,!0))}async function TOe(t,e){const n=Rn(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),WU(n.remoteStore,r.targetId))}async function kOe(t,e,n){const r=Che(t);try{const i=await(function(o,a){const l=Rn(o),c=Vr.now(),u=a.reduce(((g,v)=>g.add(v.key)),Bn());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",(g=>{let v=nc(),x=Bn();return l.Ns.getEntries(g,u).next((b=>{v=b,v.forEach(((T,A)=>{A.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(g,v))).next((b=>{h=b;const T=[];for(const A of a){const I=zNe(A,h.get(A.key).overlayedDocument);I!=null&&T.push(new vp(A.key,I,uue(I.value.mapValue),oa.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,a)})).next((b=>{f=b;const T=b.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(g,b.batchId,T)}))})).then((()=>({batchId:f.batchId,changes:bue(h)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new Ei(In)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c})(r,i.batchId,n),await HA(r,i.changes),await WA(r.remoteStore)}catch(i){const s=XU(i,"Failed to persist write");n.reject(s)}}async function khe(t,e){const n=Rn(t);try{const r=await F5e(n.localStore,e);e.targetChanges.forEach(((i,s)=>{const o=n.Au.get(s);o&&(nn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?nn(o.hu,14607):i.removedDocuments.size>0&&(nn(o.hu,42227),o.hu=!1))})),await HA(n,r,e)}catch(r){await ev(r)}}function kJ(t,e,n){const r=Rn(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(o,a){const l=Rn(o);l.onlineState=a;let c=!1;l.queries.forEach(((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)})),c&&ZU(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function AOe(t,e,n){const r=Rn(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new Ei(kt.comparator);o=o.insert(s,Zi.newNoDocument(s,on.min()));const a=Bn().add(s),l=new C5(on.min(),new Map,new Ei(In),o,a);await khe(r,l),r.du=r.du.remove(s),r.Au.delete(e),QU(r)}else await Zj(r.localStore,e,!1).then((()=>eF(r,e,n))).catch(ev)}async function IOe(t,e){const n=Rn(t),r=e.batch.batchId;try{const i=await j5e(n.localStore,e);Ihe(n,r,null),Ahe(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await HA(n,i)}catch(i){await ev(i)}}async function ROe(t,e,n){const r=Rn(t);try{const i=await(function(o,a){const l=Rn(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next((h=>(nn(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(r.localStore,e);Ihe(r,e,n),Ahe(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await HA(r,i)}catch(i){await ev(i)}}function Ahe(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Ihe(t,e,n){const r=Rn(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function eF(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||Rhe(t,r)}))}function Rhe(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(WU(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),QU(t))}function AJ(t,e,n){for(const r of n)r instanceof Ehe?(t.Ru.addReference(r.key,e),POe(t,r)):r instanceof She?(ft(JU,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Rhe(t,r.key)):Ht(19791,{wu:r})}function POe(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ft(JU,"New document in limbo: "+n),t.Eu.add(r),QU(t))}function QU(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new kt(Er.fromString(e)),r=t.fu.next();t.Au.set(r,new _Oe(n)),t.du=t.du.insert(n,r),phe(t.remoteStore,new Ff(Qc(k5(n.path)),r,"TargetPurposeLimboResolution",Yc.ce))}}async function HA(t,e,n){const r=Rn(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,l)=>{o.push(r.pu(l,e,n).then((c=>{if((c||n)&&r.isPrimaryClient){const u=c?!c.fromCache:n?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){i.push(c);const u=GU.As(l.targetId,c);s.push(u)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(l,c){const u=Rn(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(h=>xe.forEach(c,(f=>xe.forEach(f.Es,(g=>u.persistence.referenceDelegate.addReference(h,f.targetId,g))).next((()=>xe.forEach(f.ds,(g=>u.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))))))}catch(h){if(!qg(h))throw h;ft(BU,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const g=u.Ms.get(f),v=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(f,x)}}})(r.localStore,s))}async function COe(t,e){const n=Rn(t);if(!n.currentUser.isEqual(e)){ft(JU,"User change. New user:",e.toKey());const r=await che(n.localStore,e);n.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((l=>{l.reject(new St(We.CANCELLED,o))}))})),s.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await HA(n,r.Ls)}}function MOe(t,e){const n=Rn(t),r=n.Au.get(e);if(r&&r.hu)return Bn().add(r.key);{let i=Bn();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function Phe(t){const e=Rn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=khe.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MOe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AOe.bind(null,e),e.Pu.H_=mOe.bind(null,e.eventManager),e.Pu.yu=gOe.bind(null,e.eventManager),e}function Che(t){const e=Rn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IOe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ROe.bind(null,e),e}class vk{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=L5(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return lhe(this.persistence,new ahe,e.initialUser,this.serializer)}Cu(e){return new zU(O5.mi,this.serializer)}Du(e){return new hhe}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vk.provider={build:()=>new vk};class NOe extends vk{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){nn(this.persistence.referenceDelegate instanceof q3,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new nhe(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Jo.withCacheSize(this.cacheSizeBytes):Jo.DEFAULT;return new zU((r=>q3.mi(r,n)),this.serializer)}}class OOe extends vk{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Che(this.xu.syncEngine),await WA(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return lhe(this.persistence,new ahe,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new nhe(r,e.asyncQueue,n)}Mu(e,n){const r=new V4e(n,this.persistence);return new F4e(e.asyncQueue,r)}Cu(e){const n=O5e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Jo.withCacheSize(this.cacheSizeBytes):Jo.DEFAULT;return new UU(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Y5e(),jC(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new hhe}}class Y3{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>kJ(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=COe.bind(null,this.syncEngine),await dOe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new pOe})()}createDatastore(e){const n=L5(e.databaseInfo.databaseId),r=(function(s){return new K5e(s)})(e.databaseInfo);return(function(s,o,a,l){return new Q5e(s,o,a,l)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,i,s,o,a){return new tOe(r,i,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(n=>kJ(this.syncEngine,n,0)),(function(){return xJ.v()?new xJ:new B5e})())}createSyncEngine(e,n){return(function(i,s,o,a,l,c,u){const h=new xOe(i,s,o,a,l,c);return u&&(h.gu=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=Rn(n);ft(A1,"RemoteStore shutting down."),r.Ea.add(5),await BA(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Y3.provider={build:()=>new Y3};class Mhe{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ra("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Rg="FirestoreClient";class LOe{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ao.UNAUTHENTICATED,this.clientId=wU.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{ft(Rg,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(ft(Rg,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new hd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=XU(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function V6(t,e){t.asyncQueue.verifyOperationInProgress(),ft(Rg,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async i=>{r.isEqual(i)||(await che(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function IJ(t,e){t.asyncQueue.verifyOperationInProgress();const n=await DOe(t);ft(Rg,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>bJ(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,i)=>bJ(e.remoteStore,i))),t._onlineComponents=e}async function DOe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ft(Rg,"Using user provided OfflineComponentProvider");try{await V6(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===We.FAILED_PRECONDITION||i.code===We.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;w1("Error using user provided cache. Falling back to memory cache: "+n),await V6(t,new vk)}}else ft(Rg,"Using default OfflineComponentProvider"),await V6(t,new NOe(void 0));return t._offlineComponents}async function Nhe(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ft(Rg,"Using user provided OnlineComponentProvider"),await IJ(t,t._uninitializedComponentsProvider._online)):(ft(Rg,"Using default OnlineComponentProvider"),await IJ(t,new Y3))),t._onlineComponents}function $Oe(t){return Nhe(t).then((e=>e.syncEngine))}async function Ohe(t){const e=await Nhe(t),n=e.eventManager;return n.onListen=wOe.bind(null,e.syncEngine),n.onUnlisten=SOe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=bOe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=TOe.bind(null,e.syncEngine),n}function jOe(t,e,n={}){const r=new hd;return t.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,c){const u=new Mhe({next:f=>{u.Nu(),o.enqueueAndForget((()=>whe(s,h)));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new St(We.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new St(We.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new bhe(k5(a.path),u,{includeMetadataChanges:!0,qa:!0});return xhe(s,h)})(await Ohe(t),t.asyncQueue,e,n,r))),r.promise}function FOe(t,e,n={}){const r=new hd;return t.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,c){const u=new Mhe({next:f=>{u.Nu(),o.enqueueAndForget((()=>whe(s,h))),f.fromCache&&l.source==="server"?c.reject(new St(We.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new bhe(a,u,{includeMetadataChanges:!0,qa:!0});return xhe(s,h)})(await Ohe(t),t.asyncQueue,e,n,r))),r.promise}function Lhe(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const RJ=new Map;const Dhe="firestore.googleapis.com",PJ=!0;class CJ{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new St(We.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Dhe,this.ssl=PJ}else this.host=e.host,this.ssl=e.ssl??PJ;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Jue;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<y5e)throw new St(We.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}L4e("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lhe(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new St(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new St(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new St(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $5{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new CJ({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new St(We.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new St(We.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new CJ(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new T4e;switch(r.type){case"firstParty":return new R4e(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new St(We.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=RJ.get(n);r&&(ft("ComponentProvider","Removing Datastore"),RJ.delete(n),r.terminate())})(this),Promise.resolve()}}function VOe(t,e,n,r={}){t=au(t,$5);const i=J1(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(oU(`https://${a}`),aU("Firestore",!0)),s.host!==Dhe&&s.host!==a&&w1("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!y1(l,o)&&(t._setSettings(l),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Ao.MOCK_USER;else{c=zle(r.mockUserToken,t._app?.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new St(We.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ao(h)}t._authCredentials=new k4e(new $ce(c,u))}}class V2{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new V2(this.firestore,e,this._query)}}class hs{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hs(this.firestore,e,this._key)}toJSON(){return{type:hs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(jA(n,hs._jsonSchema))return new hs(e,r||null,new kt(Er.fromString(n.referencePath)))}}hs._jsonSchemaVersion="firestore/documentReference/1.0",hs._jsonSchema={type:Ss("string",hs._jsonSchemaVersion),referencePath:Ss("string")};class fg extends V2{constructor(e,n,r){super(e,n,k5(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hs(this.firestore,null,new kt(e))}withConverter(e){return new fg(this.firestore,e,this._path)}}function MJ(t,e,...n){if(t=co(t),Fce("collection","path",e),t instanceof $5){const r=Er.fromString(e,...n);return wZ(r),new fg(t,null,r)}{if(!(t instanceof hs||t instanceof fg))throw new St(We.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Er.fromString(e,...n));return wZ(r),new fg(t.firestore,null,r)}}function Ay(t,e,...n){if(t=co(t),arguments.length===1&&(e=wU.newId()),Fce("doc","path",e),t instanceof $5){const r=Er.fromString(e,...n);return xZ(r),new hs(t,null,new kt(r))}{if(!(t instanceof hs||t instanceof fg))throw new St(We.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Er.fromString(e,...n));return xZ(r),new hs(t.firestore,t instanceof fg?t.converter:null,new kt(r))}}const NJ="AsyncQueue";class OJ{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new dhe(this,"async_queue_retry"),this._c=()=>{const r=jC();r&&ft(NJ,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=jC();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=jC();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new hd;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qg(e))throw e;ft(NJ,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ra("INTERNAL UNHANDLED ERROR: ",LJ(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=YU.createAndSchedule(this,e,n,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Ht(47125,{Pc:LJ(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function LJ(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Yg extends $5{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new OJ,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new OJ(e),this._firestoreClient=void 0,await e}}}function zOe(t,e){const n=typeof t=="object"?t:uU(),r=typeof t=="string"?t:j3,i=p5(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=jle("firestore");s&&VOe(i,...s)}return i}function eG(t){if(t._terminated)throw new St(We.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$he(t),t._firestoreClient}function $he(t){const e=t._freezeSettings(),n=(function(i,s,o,a){return new mNe(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,Lhe(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new LOe(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(t._componentsProvider))}function UOe(t,e){w1("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return GOe(t,Y3.provider,{build:r=>new OOe(r,n.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function GOe(t,e,n){if((t=au(t,Yg))._firestoreClient||t._terminated)throw new St(We.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new St(We.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},$he(t)}class Gc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gc(As.fromBase64String(e))}catch(n){throw new St(We.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gc(As.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gc._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(jA(e,Gc._jsonSchema))return Gc.fromBase64String(e.bytes)}}Gc._jsonSchemaVersion="firestore/bytes/1.0",Gc._jsonSchema={type:Ss("string",Gc._jsonSchemaVersion),bytes:Ss("string")};class j5{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new St(We.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ni(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class F5{constructor(e){this._methodName=e}}class dd{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new St(We.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new St(We.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return In(this._lat,e._lat)||In(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dd._jsonSchemaVersion}}static fromJSON(e){if(jA(e,dd._jsonSchema))return new dd(e.latitude,e.longitude)}}dd._jsonSchemaVersion="firestore/geoPoint/1.0",dd._jsonSchema={type:Ss("string",dd._jsonSchemaVersion),latitude:Ss("number"),longitude:Ss("number")};class fd{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(jA(e,fd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new fd(e.vectorValues);throw new St(We.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fd._jsonSchemaVersion="firestore/vectorValue/1.0",fd._jsonSchema={type:Ss("string",fd._jsonSchemaVersion),vectorValues:Ss("object")};const BOe=/^__.*__$/;class WOe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new vp(e,this.data,this.fieldMask,n,this.fieldTransforms):new j2(e,this.data,n,this.fieldTransforms)}}class jhe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new vp(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Fhe(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ht(40011,{Ac:t})}}class tG{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new tG({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return X3(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Fhe(this.Ac)&&BOe.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class HOe{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||L5(e)}Cc(e,n,r,i=!1){return new tG({Ac:e,methodName:n,Dc:r,path:Ni.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function V5(t){const e=t._freezeSettings(),n=L5(t._databaseId);return new HOe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Vhe(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);rG("Data must be an object, but it was:",o,r);const a=zhe(r,o);let l,c;if(s.merge)l=new pl(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const f=tF(e,h,n);if(!o.contains(f))throw new St(We.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Ghe(u,f)||u.push(f)}l=new pl(u),c=o.fieldTransforms.filter((h=>l.covers(h.field)))}else l=null,c=o.fieldTransforms;return new WOe(new ra(a),l,c)}class z5 extends F5{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof z5}}class nG extends F5{_toFieldTransform(e){return new Rue(e.path,new Yw)}isEqual(e){return e instanceof nG}}function qOe(t,e,n,r){const i=t.Cc(1,e,n);rG("Data must be an object, but it was:",i,r);const s=[],o=ra.empty();Kg(r,((l,c)=>{const u=iG(e,l,n);c=co(c);const h=i.yc(u);if(c instanceof z5)s.push(u);else{const f=qA(c,h);f!=null&&(s.push(u),o.set(u,f))}}));const a=new pl(s);return new jhe(o,a,i.fieldTransforms)}function KOe(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[tF(e,r,n)],l=[i];if(s.length%2!=0)throw new St(We.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(tF(e,s[f])),l.push(s[f+1]);const c=[],u=ra.empty();for(let f=a.length-1;f>=0;--f)if(!Ghe(c,a[f])){const g=a[f];let v=l[f];v=co(v);const x=o.yc(g);if(v instanceof z5)c.push(g);else{const b=qA(v,x);b!=null&&(c.push(g),u.set(g,b))}}const h=new pl(c);return new jhe(u,h,o.fieldTransforms)}function YOe(t,e,n,r=!1){return qA(n,t.Cc(r?4:3,e))}function qA(t,e){if(Uhe(t=co(t)))return rG("Unsupported field value:",e,t),zhe(t,e);if(t instanceof F5)return(function(r,i){if(!Fhe(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const a of r){let l=qA(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}})(t,e)}return(function(r,i){if((r=co(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return LNe(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Vr.fromDate(r);return{timestampValue:Jw(i.serializer,s)}}if(r instanceof Vr){const s=new Vr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jw(i.serializer,s)}}if(r instanceof dd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gc)return{bytesValue:Due(i.serializer,r._byteString)};if(r instanceof hs){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$U(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof fd)return(function(o,a){return{mapValue:{fields:{[RU]:{stringValue:PU},[Ww]:{arrayValue:{values:o.toArray().map((c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return MU(a.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${v5(r)}`)})(t,e)}function zhe(t,e){const n={};return tue(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Kg(t,((r,i)=>{const s=qA(i,e.mc(r));s!=null&&(n[r]=s)})),{mapValue:{fields:n}}}function Uhe(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Vr||t instanceof dd||t instanceof Gc||t instanceof hs||t instanceof F5||t instanceof fd)}function rG(t,e,n){if(!Uhe(n)||!Vce(n)){const r=v5(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function tF(t,e,n){if((e=co(e))instanceof j5)return e._internalPath;if(typeof e=="string")return iG(t,e);throw X3("Field path arguments must be of type string or ",t,!1,void 0,n)}const XOe=new RegExp("[~\\*/\\[\\]]");function iG(t,e,n){if(e.search(XOe)>=0)throw X3(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new j5(...e.split("."))._internalPath}catch{throw X3(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function X3(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new St(We.INVALID_ARGUMENT,a+t+l)}function Ghe(t,e){return t.some((n=>n.isEqual(e)))}class Bhe{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new hs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZOe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(sG("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ZOe extends Bhe{data(){return super.data()}}function sG(t,e){return typeof e=="string"?iG(t,e):e instanceof j5?e._internalPath:e._delegate._internalPath}function JOe(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new St(We.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oG{}class QOe extends oG{}function eLe(t,e,...n){let r=[];e instanceof oG&&r.push(e),r=r.concat(n),(function(s){const o=s.filter((l=>l instanceof aG)).length,a=s.filter((l=>l instanceof U5)).length;if(o>1||o>0&&a>0)throw new St(We.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)t=i._apply(t);return t}class U5 extends QOe{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new U5(e,n,r)}_apply(e){const n=this._parse(e);return Whe(e._query,n),new V2(e.firestore,e.converter,Uj(e._query,n))}_parse(e){const n=V5(e.firestore);return(function(s,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new St(We.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){$J(h,u);const v=[];for(const x of h)v.push(DJ(l,s,x));f={arrayValue:{values:v}}}else f=DJ(l,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||$J(h,u),f=YOe(a,o,h,u==="in"||u==="not-in");return er.create(c,u,f)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function tLe(t,e,n){const r=e,i=sG("where",t);return U5._create(i,r,n)}class aG extends oG{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new aG(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:zr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Whe(o,l),o=Uj(o,l)})(e._query,n),new V2(e.firestore,e.converter,Uj(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function DJ(t,e,n){if(typeof(n=co(n))=="string"){if(n==="")throw new St(We.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!vue(e)&&n.indexOf("/")!==-1)throw new St(We.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Er.fromString(n));if(!kt.isDocumentKey(r))throw new St(We.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mk(t,new kt(r))}if(n instanceof hs)return mk(t,n._key);throw new St(We.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${v5(n)}.`)}function $J(t,e){if(!Array.isArray(t)||t.length===0)throw new St(We.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Whe(t,e){const n=(function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new St(We.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new St(We.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class nLe{convertValue(e,n="none"){switch(kg(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _i(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(op(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ht(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Kg(e,((i,s)=>{r[i]=this.convertValue(s,n)})),r}convertVectorValue(e){const n=e.fields?.[Ww].arrayValue?.values?.map((r=>_i(r.doubleValue)));return new fd(n)}convertGeoPoint(e){return new dd(_i(e.latitude),_i(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=S5(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(fk(e));default:return null}}convertTimestamp(e){const n=sp(e);return new Vr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Er.fromString(e);nn(Hue(r),9688,{name:e});const i=new b1(r.get(1),r.get(3)),s=new kt(r.popFirst(5));return i.isEqual(n)||Ra(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function Hhe(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class qE{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hy extends Bhe{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new FC(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(sG("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new St(We.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Hy._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Hy._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hy._jsonSchema={type:Ss("string",Hy._jsonSchemaVersion),bundleSource:Ss("string","DocumentSnapshot"),bundleName:Ss("string"),bundle:Ss("string")};class FC extends Hy{data(e={}){return super.data(e)}}class Ux{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new qE(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new FC(this._firestore,this._userDataWriter,r.key,r,new qE(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new St(We.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((a=>{const l=new FC(i._firestore,i._userDataWriter,a.doc.key,a.doc,new qE(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const l=new FC(i._firestore,i._userDataWriter,a.doc.key,a.doc,new qE(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:rLe(a.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new St(We.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ux._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=wU.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rLe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ht(61501,{type:t})}}function iLe(t){t=au(t,hs);const e=au(t.firestore,Yg);return jOe(eG(e),t._key).then((n=>cLe(e,t,n)))}Ux._jsonSchemaVersion="firestore/querySnapshot/1.0",Ux._jsonSchema={type:Ss("string",Ux._jsonSchemaVersion),bundleSource:Ss("string","QuerySnapshot"),bundleName:Ss("string"),bundle:Ss("string")};class qhe extends nLe{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gc(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hs(this.firestore,null,n)}}function sLe(t){t=au(t,V2);const e=au(t.firestore,Yg),n=eG(e),r=new qhe(e);return JOe(t._query),FOe(n,t._query).then((i=>new Ux(e,r,t,i)))}function z6(t,e,n){t=au(t,hs);const r=au(t.firestore,Yg),i=Hhe(t.converter,e,n);return G5(r,[Vhe(V5(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,oa.none())])}function oLe(t,e,n,...r){t=au(t,hs);const i=au(t.firestore,Yg),s=V5(i);let o;return o=typeof(e=co(e))=="string"||e instanceof j5?KOe(s,"updateDoc",t._key,e,n,r):qOe(s,"updateDoc",t._key,e),G5(i,[o.toMutation(t._key,oa.exists(!0))])}function aLe(t){return G5(au(t.firestore,Yg),[new P5(t._key,oa.none())])}function lLe(t,e){const n=au(t.firestore,Yg),r=Ay(t),i=Hhe(t.converter,e);return G5(n,[Vhe(V5(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,oa.exists(!1))]).then((()=>r))}function G5(t,e){return(function(r,i){const s=new hd;return r.asyncQueue.enqueueAndForget((async()=>kOe(await $Oe(r),i,s))),s.promise})(eG(t),e)}function cLe(t,e,n){const r=n.docs.get(e._key),i=new qhe(t);return new Hy(t,i,e._key,r,new qE(n.hasPendingWrites,n.fromCache),e.converter)}function U6(){return new nG("serverTimestamp")}(function(e,n=!0){(function(i){$2=i})(Q1),v1(new Sg("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Yg(new A4e(r.getProvider("auth-internal")),new P4e(o,r.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new St(We.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new b1(c.options.projectId,u)})(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),cd(gZ,yZ,e),cd(gZ,yZ,"esm2020")})();const Khe="firebasestorage.googleapis.com",uLe="storageBucket",hLe=120*1e3,dLe=600*1e3;class Dd extends Ld{constructor(e,n,r=0){super(G6(e),`Firebase Storage: ${n} (${G6(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Dd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return G6(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sd;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sd||(Sd={}));function G6(t){return"storage/"+t}function fLe(){const t="An unknown error occurred, please check the error payload for server response.";return new Dd(Sd.UNKNOWN,t)}function pLe(){return new Dd(Sd.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function mLe(){return new Dd(Sd.CANCELED,"User canceled the upload/download.")}function gLe(t){return new Dd(Sd.INVALID_URL,"Invalid URL '"+t+"'.")}function yLe(t){return new Dd(Sd.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function jJ(t){return new Dd(Sd.INVALID_ARGUMENT,t)}function Yhe(){return new Dd(Sd.APP_DELETED,"The Firebase app was deleted.")}function vLe(t){return new Dd(Sd.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Xu{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Xu.makeFromUrl(e,n)}catch{return new Xu(e,"")}if(r.path==="")return r;throw yLe(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(R){R.path_=decodeURIComponent(R.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",g=new RegExp(`^https?://${h}/${u}/b/${i}/o${f}`,"i"),v={bucket:1,path:3},x=n===Khe?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${b}`,"i"),I=[{regex:a,indices:l,postModify:s},{regex:g,indices:v,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let R=0;R<I.length;R++){const M=I[R],F=M.regex.exec(e);if(F){const C=F[M.indices.bucket];let N=F[M.indices.path];N||(N=""),r=new Xu(C,N),M.postModify(r);break}}if(r==null)throw gLe(e);return r}}class _Le{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function xLe(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...b){c||(c=!0,e.apply(null,b))}function h(b){i=setTimeout(()=>{i=null,t(g,l())},b)}function f(){s&&clearTimeout(s)}function g(b,...T){if(c){f();return}if(b){f(),u.call(null,b,...T);return}if(l()||o){f(),u.call(null,b,...T);return}r<64&&(r*=2);let I;a===1?(a=2,I=0):I=(r+Math.random())*1e3,h(I)}let v=!1;function x(b){v||(v=!0,f(),!c&&(i!==null?(b||(a=2),clearTimeout(i),h(0)):b||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,x(!0)},n),x}function wLe(t){t(!1)}function bLe(t){return t!==void 0}function FJ(t,e,n,r){if(r<e)throw jJ(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw jJ(`Invalid value for '${t}'. Expected ${n} or less.`)}function ELe(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Z3;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Z3||(Z3={}));function SLe(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}class TLe{constructor(e,n,r,i,s,o,a,l,c,u,h,f=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new hP(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Z3.NO_ERROR,l=s.getStatus();if(!a||SLe(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Z3.ABORT;r(!1,new hP(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new hP(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());bLe(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=fLe();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?Yhe():mLe();o(l)}else{const l=pLe();o(l)}};this.canceled_?n(!1,new hP(!1,null,!0)):this.backoffId_=xLe(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&wLe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hP{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function kLe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function ALe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ILe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RLe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function PLe(t,e,n,r,i,s,o=!0,a=!1){const l=ELe(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return ILe(u,e),kLe(u,n),ALe(u,s),RLe(u,r),new TLe(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}function CLe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function MLe(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class J3{constructor(e,n){this._service=e,n instanceof Xu?this._location=n:this._location=Xu.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new J3(e,n)}get root(){const e=new Xu(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return MLe(this._location.path)}get storage(){return this._service}get parent(){const e=CLe(this._location.path);if(e===null)return null;const n=new Xu(this._location.bucket,e);return new J3(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw vLe(e)}}function VJ(t,e){const n=e?.[uLe];return n==null?null:Xu.makeFromBucketSpec(n,t)}function NLe(t,e,n,r={}){t.host=`${e}:${n}`;const i=J1(e);i&&(oU(`https://${t.host}/b`),aU("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:zle(s,t.app.options.projectId))}class OLe{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=Khe,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hLe,this._maxUploadRetryTime=dLe,this._requests=new Set,i!=null?this._bucket=Xu.makeFromBucketSpec(i,this._host):this._bucket=VJ(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xu.makeFromBucketSpec(this._url,e):this._bucket=VJ(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){FJ("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){FJ("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(ec(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new J3(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new _Le(Yhe());{const o=PLe(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const zJ="@firebase/storage",UJ="0.14.0";const Xhe="storage";function LLe(t=uU(),e){t=co(t);const r=p5(t,Xhe).getImmediate({identifier:e}),i=jle("storage");return i&&DLe(r,...i),r}function DLe(t,e,n,r={}){NLe(t,e,n,r)}function $Le(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new OLe(n,r,i,e,Q1)}function jLe(){v1(new Sg(Xhe,$Le,"PUBLIC").setMultipleInstances(!0)),cd(zJ,UJ,""),cd(zJ,UJ,"esm2020")}jLe();const FLe={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},lG=Kle(FLe),Iy=w4e(lG),Vf=zOe(lG);LLe(lG);UOe(Vf).catch(t=>{t.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const VLe={};function zLe(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var s;const o=l=>l===null?null:JSON.parse(l,void 0),a=(s=n.getItem(i))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(i,s)=>n.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>n.removeItem(i)}}const _k=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return _k(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return _k(r)(n)}}}},ULe=(t,e)=>(n,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:b=>b,version:0,merge:(b,T)=>({...T,...b}),...e},o=!1;const a=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...b)},r,i);const u=_k(s.serialize),h=()=>{const b=s.partialize({...r()});let T;const A=u({state:b,version:s.version}).then(I=>c.setItem(s.name,I)).catch(I=>{T=I});if(T)throw T;return A},f=i.setState;i.setState=(b,T)=>{f(b,T),h()};const g=t((...b)=>{n(...b),h()},r,i);let v;const x=()=>{var b;if(!c)return;o=!1,a.forEach(A=>A(r()));const T=((b=s.onRehydrateStorage)==null?void 0:b.call(s,r()))||void 0;return _k(c.getItem.bind(c))(s.name).then(A=>{if(A)return s.deserialize(A)}).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==s.version){if(s.migrate)return s.migrate(A.state,A.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return A.state}).then(A=>{var I;return v=s.merge(A,(I=r())!=null?I:g),n(v,!0),h()}).then(()=>{T?.(v,void 0),o=!0,l.forEach(A=>A(v))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:b=>{s={...s,...b},b.getStorage&&(c=b.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:b=>(a.add(b),()=>{a.delete(b)}),onFinishHydration:b=>(l.add(b),()=>{l.delete(b)})},x(),v||g},GLe=(t,e)=>(n,r,i)=>{let s={storage:zLe(()=>localStorage),partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},o=!1;const a=new Set,l=new Set;let c=s.storage;if(!c)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...x)},r,i);const u=()=>{const x=s.partialize({...r()});return c.setItem(s.name,{state:x,version:s.version})},h=i.setState;i.setState=(x,b)=>{h(x,b),u()};const f=t((...x)=>{n(...x),u()},r,i);i.getInitialState=()=>f;let g;const v=()=>{var x,b;if(!c)return;o=!1,a.forEach(A=>{var I;return A((I=r())!=null?I:f)});const T=((b=s.onRehydrateStorage)==null?void 0:b.call(s,(x=r())!=null?x:f))||void 0;return _k(c.getItem.bind(c))(s.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==s.version){if(s.migrate)return[!0,s.migrate(A.state,A.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var I;const[R,M]=A;if(g=s.merge(M,(I=r())!=null?I:f),n(g,!0),R)return u()}).then(()=>{T?.(g,void 0),g=r(),o=!0,l.forEach(A=>A(g))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:x=>(a.add(x),()=>{a.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||v(),g||f},BLe=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((VLe?"commercial":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ULe(t,e)):GLe(t,e),dh=BLe,Nn=ho()(dh(t=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,weatherFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,showWeatherButton:!1,setDefaultBackground:e=>t({defaultBackground:e}),setShowScaleBar:e=>t({showScaleBar:e}),setGpsAutoStart:e=>t({gpsAutoStart:e}),setShowAccuracyCircle:e=>t({showAccuracyCircle:e}),setHapticFeedback:e=>t({hapticFeedback:e}),setVondstenLocalOnly:e=>t({vondstenLocalOnly:e}),setShowVondstButton:e=>t({showVondstButton:e}),setShowRouteRecordButton:e=>t({showRouteRecordButton:e}),setShowLocalVondsten:e=>t({showLocalVondsten:e}),setShowCustomPointLayers:e=>t({showCustomPointLayers:e}),setFontScale:e=>t({fontScale:e}),setLayerPanelFontScale:e=>t({layerPanelFontScale:e}),setPresetPanelFontScale:e=>t({presetPanelFontScale:e}),setMenuFontScale:e=>t({menuFontScale:e}),setWeatherFontScale:e=>t({weatherFontScale:e}),setVoiceFeedbackEnabled:e=>t({voiceFeedbackEnabled:e}),setShowStepCounter:e=>t({showStepCounter:e}),setShowFontSliders:e=>t({showFontSliders:e}),setShowWeatherButton:e=>t({showWeatherButton:e})}),{name:"detectorapp-settings",version:2,migrate:(t,e)=>e<2?{...t,showScaleBar:!0}:t})),B5=ho()(L2((t,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:n=>{t(r=>{r.user=n,r.loading=!1})},setLoading:n=>{t(r=>{r.loading=n})},setError:n=>{t(r=>{r.error=n})},setAccessToken:n=>{t(r=>{r.accessToken=n})},signInWithGoogle:async()=>{t(n=>{n.loading=!0,n.error=null});try{const n=new Wu;await aZ(Iy,n)}catch(n){console.error("Google sign-in error:",n),t(r=>{r.error=n.message,r.loading=!1})}},connectGoogleFit:async()=>{t(n=>{n.loading=!0,n.error=null});try{const n=new Wu;n.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await aZ(Iy,n),i=Wu.credentialFromResult(r);return i?.accessToken?(t(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(t(s=>{s.loading=!1}),!1)}catch(n){return console.error("Google Fit connect error:",n),t(r=>{r.error=n.message,r.loading=!1}),!1}},logout:async()=>{t(n=>{n.loading=!0});try{await vce(Iy),t(n=>{n.accessToken=null})}catch(n){console.error("Logout error:",n),t(r=>{r.error=n.message,r.loading=!1})}},initAuth:()=>{e().initialized||(t(n=>{n.initialized=!0}),yce(Iy,n=>{t(r=>{r.user=n,r.loading=!1}),n&&Nn.getState().setVondstenLocalOnly(!1)}))}})));ho()(L2((t,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async n=>{t(r=>{r.loading=!0});try{const r=eLe(MJ(Vf,"vondsten"),tLe("userId","==",n)),s=(await sLe(r)).docs.map(o=>({id:o.id,...o.data()}));t(o=>{o.vondsten=s,o.loading=!1})}catch(r){t(i=>{i.error=r.message,i.loading=!1})}},addVondst:async n=>{const r=new Date().toISOString(),i={...n,createdAt:r,updatedAt:r},s=await lLe(MJ(Vf,"vondsten"),i);return t(o=>{o.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(n,r)=>{const i=Ay(Vf,"vondsten",n);await oLe(i,{...r,updatedAt:new Date().toISOString()}),t(s=>{const o=s.vondsten.findIndex(a=>a.id===n);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...r})})},deleteVondst:async n=>{await aLe(Ay(Vf,"vondsten",n)),t(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==n)})}})));const dP=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],GJ=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],nF=ho()(dh((t,e)=>({presets:[...dP],customDefaults:null,applyPreset:n=>{const r=e().presets.find(s=>s.id===n);if(!r)return;const i=io.getState();GJ.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(o=>{i.setLayerVisibility(o,o===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(n,r)=>{const i=io.getState(),s=Object.entries(i.visible).filter(([a,l])=>l&&GJ.includes(a)).map(([a])=>a),o={id:`custom-${Date.now()}`,name:n,icon:r,layers:s,isBuiltIn:!1};t(a=>({presets:[...a.presets,o]})),console.log(` Preset aangemaakt: ${n} met ${s.length} lagen`)},updatePreset:(n,r)=>{t(i=>({presets:i.presets.map(s=>s.id===n?{...s,...r}:s)}))},deletePreset:n=>{t(r=>({presets:r.presets.filter(i=>i.id!==n||i.isBuiltIn)}))},saveAsDefaults:()=>{const n=e().presets;t({customDefaults:[...n]}),console.log(" Presets opgeslagen als standaard")},resetToDefaults:()=>{const{customDefaults:n}=e();n?(t({presets:[...n]}),console.log(" Presets hersteld naar eigen standaard")):(t({presets:[...dP]}),console.log(" Presets hersteld naar originele standaard"))},resetToBuiltIn:()=>{t({presets:[...dP],customDefaults:null}),console.log(" Presets gereset naar originele instellingen")}}),{name:"detectorapp-presets",version:10,migrate:(t,e)=>e<10?{presets:[...dP]}:t})),BJ=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],KA=ho()(dh((t,e)=>({layers:[],addLayer:n=>{const r=crypto.randomUUID(),i=e().layers.length,s=BJ[i%BJ.length];return t(o=>({layers:[...o.layers,{...n,id:r,createdAt:new Date().toISOString(),color:n.color||s,visible:n.visible??!0,opacity:n.opacity??1}]})),r},removeLayer:n=>t(r=>({layers:r.layers.filter(i=>i.id!==n)})),updateLayer:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,...r}:s)})),toggleVisibility:n=>t(r=>({layers:r.layers.map(i=>i.id===n?{...i,visible:!i.visible}:i)})),setOpacity:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,opacity:r}:s)})),setColor:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,color:r}:s)})),clearAll:()=>t({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),WLe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],cG=ho()(dh((t,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:n=>t({tier:n}),unlockRegion:n=>t(r=>({unlockedRegions:r.unlockedRegions.includes(n)?r.unlockedRegions:[...r.unlockedRegions,n]})),lockRegion:n=>t(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==n)})),setDevMode:n=>t({devMode:n}),isRegionUnlocked:n=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(n)},isLayerUnlocked:(n,r="free",i=["nl"])=>{const s=e();return s.devMode||WLe.includes(n)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(o=>s.unlockedRegions.includes(o)):!1},canAccessPremiumFeatures:()=>{const n=e();return n.devMode||n.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));ho()(dh(t=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>t({parkingLocation:e}),clearParkingLocation:()=>t({parkingLocation:null}),setShowParkingButton:e=>t({showParkingButton:e})}),{name:"detectorapp-parking"}));function WJ(){return new Date().toISOString().split("T")[0]}ho()(dh((t,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:WJ(),stepLength:.75,incrementStep:()=>{const n=e(),r=WJ(),i=n.todayDate===r?n.todaySteps+1:1;t({steps:n.steps+1,distance:(n.steps+1)*n.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{t({steps:0,distance:0,startTime:null})},setActive:n=>{t({isActive:n,startTime:n?Date.now():e().startTime})},setStepLength:n=>{const r=e();t({stepLength:n,distance:r.steps*n})}}),{name:"step-counter-storage",partialize:t=>({todaySteps:t.todaySteps,todayDate:t.todayDate,stepLength:t.stepLength})}));const HJ={sunAzimuth:315,sunElevation:45,verticalExaggeration:2,colorRamp:"terrain",minElevation:-5,maxElevation:50,showControls:!1};ho()(dh(t=>({...HJ,setSunAzimuth:e=>t({sunAzimuth:e}),setSunElevation:e=>t({sunElevation:e}),setVerticalExaggeration:e=>t({verticalExaggeration:e}),setColorRamp:e=>t({colorRamp:e}),setMinElevation:e=>t({minElevation:e}),setMaxElevation:e=>t({maxElevation:e}),setShowControls:e=>t({showControls:e}),resetToDefaults:()=>t(HJ)}),{name:"detectorapp-hillshade"}));const HLe=()=>Math.random().toString(36).substring(2,9),qLe={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijp/mist",51:"Lichte motregen",53:"Motregen",55:"Dichte motregen",56:"Lichte ijzel",57:"Ijzel",61:"Lichte regen",63:"Regen",65:"Hevige regen",66:"Lichte ijsregen",67:"IJsregen",71:"Lichte sneeuw",73:"Sneeuw",75:"Hevige sneeuw",77:"Korrelsneeuw",80:"Lichte buien",81:"Buien",82:"Hevige buien",85:"Lichte sneeuwbuien",86:"Sneeuwbuien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer met hagel"};function KLe(t){const e=["N","NNO","NO","ONO","O","OZO","ZO","ZZO","Z","ZZW","ZW","WZW","W","WNW","NW","NNW"],n=Math.round(t/22.5)%16;return e[n]}const KS=ho()(dh((t,e)=>({weatherData:null,isLoading:!1,error:null,savedLocations:[{id:"current",name:"Huidige locatie",lat:0,lon:0,isCurrentLocation:!0}],selectedLocationId:"current",weatherPanelOpen:!1,showBuienradar:!1,setWeatherData:n=>t({weatherData:n}),setIsLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),addLocation:n=>t(r=>({savedLocations:[...r.savedLocations,{...n,id:HLe()}]})),removeLocation:n=>t(r=>({savedLocations:r.savedLocations.filter(i=>i.id!==n),selectedLocationId:r.selectedLocationId===n?"current":r.selectedLocationId})),setSelectedLocation:n=>t({selectedLocationId:n}),updateCurrentLocation:(n,r)=>t(i=>({savedLocations:i.savedLocations.map(s=>s.isCurrentLocation?{...s,lat:n,lon:r}:s)})),toggleWeatherPanel:()=>t(n=>({weatherPanelOpen:!n.weatherPanelOpen})),setWeatherPanelOpen:n=>t({weatherPanelOpen:n}),setShowBuienradar:n=>t({showBuienradar:n}),fetchWeather:async(n,r)=>{const{setIsLoading:i,setError:s,setWeatherData:o,savedLocations:a,selectedLocationId:l}=e();i(!0),s(null);try{const c=new URL("https://api.open-meteo.com/v1/forecast");c.searchParams.set("latitude",n.toString()),c.searchParams.set("longitude",r.toString()),c.searchParams.set("current","temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,wind_direction_10m,wind_gusts_10m,cloud_cover,is_day,snow_depth"),c.searchParams.set("hourly","temperature_2m,precipitation,precipitation_probability,weather_code,wind_speed_10m,wind_direction_10m,relative_humidity_2m"),c.searchParams.set("daily","weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,wind_speed_10m_max,sunrise,sunset"),c.searchParams.set("minutely_15","precipitation"),c.searchParams.set("timezone","Europe/Amsterdam"),c.searchParams.set("forecast_days","7"),c.searchParams.set("past_days","7");const u=await fetch(c.toString());if(!u.ok)throw new Error("Kon weerdata niet ophalen");const h=await u.json();let f=0;const g=h.daily.temperature_2m_min||[],v=new Date().toISOString().split("T")[0],x=h.daily.time.indexOf(v);for(let O=x-1;O>=0&&g[O]<0;O--)f++;const b=a.find(O=>O.id===l)||a[0],T=new Date,A=[],I=[];if(h.minutely_15?.time&&h.minutely_15?.precipitation){const O=new Date(T.getTime()+72e5),j=new Date(T.getTime()+2880*60*1e3);for(let V=0;V<h.minutely_15.time.length;V++){const W=new Date(h.minutely_15.time[V]);W<T||(W<=O&&A.push({time:h.minutely_15.time[V],precipitation:h.minutely_15.precipitation[V]}),W<=j&&I.push({time:h.minutely_15.time[V],precipitation:h.minutely_15.precipitation[V]}))}}const R=T.getHours(),M=T.toISOString().split("T")[0],F=h.hourly.time.map((O,j)=>({time:O,temperature:h.hourly.temperature_2m[j],precipitation:h.hourly.precipitation[j],precipitationProbability:h.hourly.precipitation_probability[j],weatherCode:h.hourly.weather_code[j],windSpeed:h.hourly.wind_speed_10m[j],windDirection:h.hourly.wind_direction_10m[j],humidity:h.hourly.relative_humidity_2m[j]})).filter(O=>new Date(O.time)>=T).slice(0,24),C=h.daily.time.map((O,j)=>({date:O,temperatureMax:h.daily.temperature_2m_max[j],temperatureMin:h.daily.temperature_2m_min[j],precipitationSum:h.daily.precipitation_sum[j],precipitationProbability:h.daily.precipitation_probability_max[j],weatherCode:h.daily.weather_code[j],windSpeedMax:h.daily.wind_speed_10m_max[j],sunrise:h.daily.sunrise[j],sunset:h.daily.sunset[j]})).filter(O=>O.date>=M),N={location:{...b,lat:n,lon:r},current:{temperature:h.current.temperature_2m,apparentTemperature:h.current.apparent_temperature,humidity:h.current.relative_humidity_2m,precipitation:h.current.precipitation,weatherCode:h.current.weather_code,windSpeed:h.current.wind_speed_10m,windDirection:h.current.wind_direction_10m,windGusts:h.current.wind_gusts_10m,cloudCover:h.current.cloud_cover,isDay:h.current.is_day===1,snowDepth:h.current.snow_depth},hourly:F,daily:C,precipitation15min:A,precipitation48h:I,frostDays:f,lastUpdated:Date.now()};try{const O=new URL("https://air-quality-api.open-meteo.com/v1/air-quality");O.searchParams.set("latitude",n.toString()),O.searchParams.set("longitude",r.toString()),O.searchParams.set("current","grass_pollen,birch_pollen,alder_pollen,mugwort_pollen,ragweed_pollen,olive_pollen");const j=await fetch(O.toString());if(j.ok){const V=await j.json();if(V.current){const W=U=>Math.min(5,Math.round(U/20));N.pollen={grass:W(V.current.grass_pollen||0),birch:W(V.current.birch_pollen||0),alder:W(V.current.alder_pollen||0),mugwort:W(V.current.mugwort_pollen||0),ragweed:W(V.current.ragweed_pollen||0),olive:W(V.current.olive_pollen||0)}}}}catch{}o(N)}catch(c){s(c instanceof Error?c.message:"Onbekende fout")}finally{i(!1)}}}),{name:"detectorapp-weather",partialize:t=>({savedLocations:t.savedLocations,selectedLocationId:t.selectedLocationId,showBuienradar:t.showBuienradar})}));function YLe({target:t,viewOptions:e}){const n=X.useRef(null),r=X.useRef(null),i=$i(o=>o.setMap),s=Nn(o=>o.showScaleBar);return X.useEffect(()=>{if(!n.current){const o={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},a=new yPe({target:t,controls:[],view:new Qh({center:Pi(o.center),zoom:o.zoom,rotation:o.rotation,minZoom:o.minZoom,maxZoom:o.maxZoom})});n.current=a,i(a),window.__olMap=a}return()=>{n.current&&(n.current.setTarget(void 0),i(null),window.__olMap=null)}},[t,e,i]),X.useEffect(()=>{const o=n.current;o&&(s?r.current||(r.current=new xPe({units:"metric",bar:!1,text:!0,minWidth:80}),o.addControl(r.current)):r.current&&(o.removeControl(r.current),r.current=null))},[s]),n.current}function _(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s}function XTt(t,e){return function(n,r){e(n,r,t)}}function ZTt(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function JTt(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var XLe=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function QTt(t){function e(s){t.error=t.hasError?new XLe(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var n,r=0;function i(){for(;n=t.stack.pop();)try{if(!n.async&&r===1)return r=0,t.stack.push(n),Promise.resolve().then(i);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(s).then(i,function(o){return e(o),i()})}else r|=1}catch(o){e(o)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}let Km;const _o=globalThis;function ye(t){return typeof Km[t]=="function"?Km[t]=Km[t](_o):Km[t]}Km=_o.dojoConfig?.has||_o.esriConfig?.has?{..._o.dojoConfig?.has,..._o.esriConfig?.has}:{},ye.add=(t,e,n,r)=>{(r||Km[t]===void 0)&&(Km[t]=e),n&&ye(t)},ye.cache=Km,ye.add("big-integer-warning-enabled",!0),ye.add("esri-deprecation-warnings",!0),ye.add("esri-tests-disable-screenshots",!1),ye.add("esri-tests-use-full-window",!1),ye.add("esri-tests-post-to-influx",!0),ye.add("esri-cim-animations-enable-status","enabled"),ye.add("esri-cim-animations-spotlight",!1),ye.add("esri-cim-animations-freeze-time",!1),(()=>{ye.add("host-webworker",_o.WorkerGlobalScope!==void 0&&self instanceof _o.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ye.add("host-browser",t),ye.add("host-node",!(typeof _o.process!="object"||!_o.process.versions?.node||!_o.process.versions.v8)),ye.add("dom",t),ye("host-browser")){const e=navigator,n=e.userAgent,r=e.appVersion,i=parseFloat(r);if(ye.add("wp",parseFloat(n.split("Windows Phone")[1])||void 0),ye.add("msapp",parseFloat(n.split("MSAppHost/")[1])||void 0),ye.add("khtml",r.includes("Konqueror")?i:void 0),ye.add("edge",parseFloat(n.split("Edge/")[1])||void 0),ye.add("opr",parseFloat(n.split("OPR/")[1])||void 0),ye.add("webkit",!ye("wp")&&!ye("edge")&&parseFloat(n.split("WebKit/")[1])||void 0),ye.add("chrome",!ye("edge")&&!ye("opr")&&parseFloat(n.split("Chrome/")[1])||void 0),ye.add("android",!ye("wp")&&parseFloat(n.split("Android ")[1])||void 0),ye.add("safari",!r.includes("Safari")||ye("wp")||ye("chrome")||ye("android")||ye("edge")||ye("opr")?void 0:parseFloat(r.split("Version/")[1])),ye.add("mac",r.includes("Macintosh")),!ye("wp")&&/(iPhone|iPod|iPad)/.test(n)){const s=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(n)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replaceAll("_",""));ye.add(s,a),ye.add("ios",a)}ye("webkit")||(!n.includes("Gecko")||ye("wp")||ye("khtml")||ye("edge")||ye.add("mozilla",i),ye("mozilla")&&ye.add("ff",parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0))}})(),(()=>{if(_o.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),n=/iPhone/i.test(t);e&&ye.add("esri-mobile",e),n&&ye.add("esri-iPhone",n),ye.add("esri-geolocation",!!navigator.geolocation)}ye.add("esri-wasm","WebAssembly"in _o),ye.add("esri-performance-mode-frames-between-render",20),ye.add("esri-force-performance-mode",!1),ye.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in _o,e=_o.crossOriginIsolated===!1;return t&&!e}),ye.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ye.add("esri-atomics","Atomics"in _o),ye.add("esri-workers","Worker"in _o),ye.add("web-feat:cache","caches"in _o),ye.add("esri-workers-arraybuffer-transfer",!ye("safari")||Number(ye("safari"))>=12),ye.add("workers-pool-size",8),ye.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ye.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ye.add("featurelayer-fast-triangulation-enabled",!0),ye.add("featurelayer-animation-enabled",!0),ye.add("featurelayer-snapshot-enabled",!0),ye.add("featurelayer-snapshot-initial-tolerance",0),ye.add("featurelayer-snapshot-point-min-threshold",8e4),ye.add("featurelayer-snapshot-point-max-threshold",4e5),ye.add("featurelayer-snapshot-multipoint-min-threshold",2e4),ye.add("featurelayer-snapshot-multipoint-max-threshold",1e5),ye.add("featurelayer-snapshot-polygon-min-threshold",2e3),ye.add("featurelayer-snapshot-polygon-max-threshold",2e3),ye.add("featurelayer-snapshot-polyline-min-threshold",2e3),ye.add("featurelayer-snapshot-polyline-max-threshold",2e3),ye.add("featurelayer-snapshot-max-vertex-count",25e4),ye.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),ye.add("featurelayer-snapshot-concurrency",4),ye.add("featurelayer-snapshot-coverage",.1),ye.add("featurelayer-query-max-depth",4),ye.add("featurelayer-query-pausing-enabled",!1),ye.add("featurelayer-query-tile-concurrency",4),ye.add("featurelayer-query-tile-max-features",6e5),ye.add("featurelayer-advanced-symbols",!1),ye.add("featurelayer-pbf",!0),ye.add("featurelayer-pbf-statistics",!1),ye.add("feature-layers-workers",!0),ye.add("feature-polyline-generalization-factor",1),ye.add("parquetlayer-full-query-feature-count",2e4),ye.add("parquetlayer-hittest-max-feature-count",1),ye.add("parquetlayer-persistence-enabled",!1),ye.add("mapview-transitions-duration",200),ye.add("mapview-essential-goto-duration",200),ye.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ye.add("mapserver-pbf-version-support",10.81),ye.add("mapservice-popup-identify-max-tolerance",20),ye.add("request-queue-concurrency-hosted",16),ye.add("request-queue-concurrency-non-hosted",4),ye.add("curve-densification-coarse-segments",128),ye.add("curve-densification-max-segments",2e3),ye.add("curve-densification-min-segments",3),ye.add("curve-densification-pixel-deviation",.5),ye.add("view-readyState-waiting-delay",1e3),ye.add("gradient-depth-bias",.01),ye.add("gradient-depth-epsilon",1e-8),ye.add("enable-feature:esri-compress-textures",!0),ye("host-webworker")||ye("host-browser")&&(ye.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ye.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function ekt(t){}function ZLe(t){return()=>t}function tkt(t){return t}var sl;let JLe=(sl=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*sl._m}getInt(){return this._seed=(sl._a*this._seed+sl._c)%sl._m,this._seed}getFloat(){return this.getInt()/(sl._m-1)}getIntRange(e,n){return Math.round(this.getFloatRange(e,n))}getFloatRange(e,n){const r=n-e;return e+this.getInt()/sl._m*r}},sl._m=2147483647,sl._a=48271,sl._c=0,sl);const QLe=1.5,nkt=1/QLe,rkt=.5;function Zhe(t){return t}function eDe(t,e=Zhe){if(!t||t.length===0)return;let n=t[0],r=e(n);for(let i=1;i<t.length;++i){const s=t[i],o=Number(e(s));o>r&&(r=o,n=s)}return n}function ikt(t,e=Zhe){return eDe(t,n=>-e(n))}function skt(t,e){return e?t.filter((n,r,i)=>i.findIndex(e.bind(null,n))===r):Array.from(new Set(t))}function tDe(t,e,n,r,i,s,o){if(t==null&&r==null)return!0;e=Math.max(0,e),i=Math.max(0,i),n=Math.max(0,n<0?(t?.length??0)+n:n),s=Math.max(0,s<0?(r?.length??0)+s:s);const a=n-e;if(t==null||r==null||a!==s-i)return!1;if(o){for(let l=0;l<a;l++)if(!o(t[e+l],r[i+l]))return!1}else for(let l=0;l<a;l++)if(t[e+l]!==r[i+l])return!1;return!0}function W5(t,e,n){return tDe(t,0,t?.length??0,e,0,e?.length??0,n)}function okt(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}}function qJ(t,e,n){let r,i;return n?(r=e.filter(s=>!t.some(o=>n(o,s))),i=t.filter(s=>!e.some(o=>n(o,s)))):(r=e.filter(s=>!t.includes(s)),i=t.filter(s=>!e.includes(s))),{added:r,removed:i}}function akt(t){return t&&typeof t.length=="number"}function lkt(t,e){const n=t.length;if(n===0)return[];const r=[];for(let i=0;i<n;i+=e)r.push(t.slice(i,i+e));return r}let Jhe=class{constructor(){this.last=0}};const Qhe=new Jhe;function rF(t,e,n,r){r=r||Qhe;const i=Math.max(0,r.last-10);for(let o=i;o<n;++o)if(t[o]===e)return r.last=o,o;const s=Math.min(i,n);for(let o=0;o<s;++o)if(t[o]===e)return r.last=o,o;return-1}function iF(t,e,n,r){const i=t.length,s=rF(t,e,i,r);if(s!==-1)return t[s]=t[i-1],t.pop(),e}const Tu=new Set;function nDe(t,e,n=t.length,r=e.length,i,s){if(r===0||n===0)return n;Tu.clear();for(let a=0;a<r;++a)Tu.add(e[a]);i=i||Qhe;const o=Math.max(0,i.last-10);for(let a=o;a<n;++a)if(Tu.has(t[a])&&(s?.push(t[a]),Tu.delete(t[a]),t[a]=t[n-1],--n,--a,Tu.size===0||n===0))return Tu.clear(),n;for(let a=0;a<o;++a)if(Tu.has(t[a])&&(s?.push(t[a]),Tu.delete(t[a]),t[a]=t[n-1],--n,--a,Tu.size===0||n===0))return Tu.clear(),n;return Tu.clear(),n}function rDe(t,e){let n=0;for(let r=0;r<t.length;++r){const i=t[r];e(i,r)&&(t[n]=i,n++)}return t.length=n,t}function ukt(t,e,n){const r=t.length;if(e>=r)return t.slice();const i=ede(n),s=new Set,o=[];for(;o.length<e;){const a=Math.floor(i()*r);s.has(a)||(s.add(a),o.push(t[a]))}return o}function ede(t){return t?(KJ.seed=t,()=>KJ.getFloat()):Math.random}const KJ=new JLe;function hkt(t,e){if(!t)return t;const n=ede(e);for(let r=t.length-1;r>0;r--){const i=Math.floor(n()*(r+1)),s=t[r];t[r]=t[i],t[i]=s}return t}function tde(t,e){const n=t.indexOf(e);return n!==-1?(t.splice(n,1),e):null}function e2(t,e){return t!=null}const dkt=[];function fkt(t){return t instanceof ArrayBuffer}function uG(t){return t?.constructor?.name==="Int8Array"}function nde(t){return t?.constructor?.name==="Uint8Array"}function rde(t){return t?.constructor?.name==="Uint8ClampedArray"}function hG(t){return t?.constructor?.name==="Int16Array"}function ide(t){return t?.constructor?.name==="Uint16Array"}function dG(t){return t?.constructor?.name==="Int32Array"}function sde(t){return t?.constructor?.name==="Uint32Array"}function iDe(t){return t?.constructor?.name==="Float16Array"}function H5(t){return t?.constructor?.name==="Float32Array"}function q5(t){return t?.constructor?.name==="Float64Array"}function sDe(t){return"buffer"in t}const ode=1024;function pkt(t){return q5(t)||H5(t)||dG(t)||hG(t)||uG(t)}function mkt(t){return q5(t)||H5(t)}function gkt(t){return q5(t)?179769e303:iDe(t)?65504:H5(t)?3402823e32:sde(t)?4294967295:ide(t)?65535:nde(t)||rde(t)?255:dG(t)?2147483647:hG(t)?32767:uG(t)?127:256}const ykt=-32768,vkt=-2147483648;function _kt(t){return t}function oDe(t,e){let n;for(n in t)t.hasOwnProperty(n)&&t[n]===void 0&&delete t[n];return t}function Ze(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=cde(t);if(e!=null)return e;if(YS(t))return t.clone();if(ade(t))return t.map(Ze);if(lde(t))throw new Error("Trying to clone an unclonable Accessor instance");const n={};for(const r of Object.getOwnPropertyNames(t))n[r]=Ze(t[r]);return n}function sF(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const n=cde(t);if(n!=null)return n;if(ade(t)){let i=!0;const s=t.map(o=>{const a=sF(o,e);return o!=null&&a==null&&(i=!1),a});return i?s:null}if(YS(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(lde(t))return null;const r=new(Object.getPrototypeOf(t)).constructor;for(const i of Object.getOwnPropertyNames(t)){const s=t[i],o=sF(s);if(s!=null&&o==null)return null;r[i]=o}return r}function YS(t){return typeof t.clone=="function"}function ade(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function lde(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function YJ(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function cde(t){if(uG(t)||nde(t)||rde(t)||hG(t)||ide(t)||dG(t)||sde(t)||H5(t)||q5(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[n,r]of t)e.set(n,Ze(r));return e}if(t instanceof Set){const e=new Set;for(const n of t)e.add(Ze(n));return e}return null}function fG(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function ude(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&W5(t,e):t instanceof Set?e instanceof Set&&lDe(t,e):t instanceof Map?e instanceof Map&&cDe(t,e):!!YJ(t)&&YJ(e)&&aDe(t,e))}function aDe(t,e){if(t===null||e===null)return!1;const n=Object.keys(t);if(e===null||Object.keys(e).length!==n.length)return!1;for(const r of n)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function lDe(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function cDe(t,e){if(t.size!==e.size)return!1;for(const[n,r]of t){const i=e.get(n);if(i!==r||i===void 0&&!e.has(n))return!1}return!0}function uDe(t,e,n=!1){return dde(t,e,n)}function K5(t,e){if(e!=null)return e[t]||hde(t.split("."),!1,e)}function z2(t,e,n){const r=t.split("."),i=r.pop(),s=hde(r,!0,n);s&&i&&(s[i]=e)}function XJ(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const n=e;if(t.length!==n.length)return!0;for(let r=0;r<t.length;r++)if(XJ(t[r],n[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const n in t)if(XJ(t[n],e[n]))return!0;return!1}return t!==e}function hde(t,e,n){let r=n;for(const i of t){if(r==null)return;if(!(i in r)){if(!e)return;r[i]={}}r=r[i]}return r}function dde(t,e,n){return e?Object.keys(e).reduce((r,i)=>{if(i==="__proto__")return r;let s=r[i],o=e[i];return s===o?r:s===void 0?(r[i]=Ze(o),r):(Array.isArray(o)||Array.isArray(r)?(s=s?Array.isArray(s)?r[i]=s.slice():r[i]=[s]:r[i]=[],o&&(Array.isArray(o)||(o=[o]),n?o.forEach(a=>{s.includes(a)||s.push(a)}):r[i]=o.slice())):o&&typeof o=="object"?r[i]=dde(s,o,n):r.hasOwnProperty(i)&&!e.hasOwnProperty(i)||(r[i]=o),r)},t||{}):t}function xkt(t,e){for(const n of Object.entries(t))if(e===n[1])return n[0]}function Y5(t,e){return Object.values(t).includes(e)}const Qn={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(uDe(Qn,globalThis.esriConfig,!0),delete Qn.has),!Qn.assetsPath){{const t="4.34";Qn.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Qn.defaultAssetsPath=Qn.assetsPath}const hDe=/\{([^}]+)\}/g;function ZJ(t){return t??""}function fde(t,e){return e?t.replaceAll(hDe,typeof e=="object"?(n,r)=>ZJ(K5(r,e)):(n,r)=>ZJ(e(r))):t}function wkt(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,n=>e?.includes(n)?n:`\\${n}`)}function pde(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}let JJ;function bkt(t){return JJ??=new DOMParser,JJ.parseFromString(t||"","text/html").body.innerText||""}function Ekt(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function Skt(t,...e){let n=t[0];for(let r=0;r<e.length;++r)n+=e[r]+t[r+1];return n}const QJ={info:0,warn:1,error:2,none:3};var os;let Tt=(os=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,os._loggers.set(this.module,this);const n=this.module.lastIndexOf(".");n!==-1&&(this._parent=os.getLogger(this.module.slice(0,n)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,os._loggers.get(e)||new os({module:e})}_log(e,n,...r){if(this._matchLevel(e)){if(n!=="always"&&!os._throttlingDisabled){const i=fDe(r),s=this._loggedMessages[e].get(i);if(n==="once"&&s!=null||n==="oncePerTick"&&s&&s>=os._tickCounter)return;this._loggedMessages[e].set(i,os._tickCounter),os._scheduleTickCounterIncrement()}for(const i of Qn.log.interceptors)if(i(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,n){let r=this;for(;r!=null;){const i=r[e];if(i!=null)return i;r=r.parent}return n}_inheritedWriter(){return this._parentWithMember("writer",dDe)}_matchLevel(e){const n=Qn.log.level||"warn";return QJ[this._parentWithMember("level",n)]<=QJ[e]}static _scheduleTickCounterIncrement(){os._tickCounterScheduled||(os._tickCounterScheduled=!0,Promise.resolve().then(()=>{os._tickCounter++,os._tickCounterScheduled=!1}))}},os._loggers=new Map,os._tickCounter=0,os._tickCounterScheduled=!1,os._throttlingDisabled=!1,os);function dDe(t,e,...n){console[t](`[${e}]`,...n)}function fDe(...t){return pde(JSON.stringify(t,(n,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}function pDe(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(n,r)=>r===""?"$":(K5(r,e)??"").toString())}let mde=class{constructor(e,n,r=void 0){this.name=e,this.details=r,this.message=(n&&pDe(n,r))??""}toString(){return"["+this.name+"]: "+this.message}},Xe=class gde extends mde{constructor(e,n,r){super(e,n,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,n)=>{if(n&&typeof n=="object"&&typeof n.toJSON=="function")return n;try{return Ze(n)}catch{return"[object]"}}))}}catch(e){throw Tt.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new gde(e.name,e.message,e.details)}};Xe.prototype.type="error";function Q3(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const mDe=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,gDe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function eQ(t){const e=t?.match(mDe);if(!e)return null;const[,n,r,i]=e;if(!n)return null;let s=null,o=null,a=null;const{devext:l,qaext:c,www:u}=gDe;if(r)if(s=n,i)switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=u);else switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function yde(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function vde(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,n=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):n.test(t)?t=t.replace(n,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function _de(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n.buffer}function yDe(t){const e=new Uint8Array(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}const vDe=()=>Tt.getLogger("esri.core.urlUtils"),U2=Qn.request,tQ="esri/config: esriConfig.request.proxyUrl is not set.",xde=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,wde=/^\s*http:/i,_De=/^\s*https:/i,xDe=/^\s*file:/i,bde=/:\d+$/,wDe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,bDe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),EDe=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Gx=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let n=this.uri.match(bDe);this.scheme=n[2]||(n[1]?"":null),this.authority=n[4]||(n[3]?"":null),this.path=n[5],this.query=n[7]||(n[6]?"":null),this.fragment=n[9]||(n[8]?"":null),this.authority!=null&&(n=this.authority.match(EDe),this.user=n[3]||null,this.password=n[4]||null,this.host=n[6]||n[7],this.port=n[9]||null)}toString(){return this.uri}};const fP={},SDe=new Gx(Qn.applicationUrl);let ia=SDe;const TDe=kDe();let pG=TDe;const mG=()=>ia,Akt=()=>pG;function kDe(){const t=ia.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${ia.scheme}://${ia.host}${ia.port!=null?`:${ia.port}`:""}`}${e}`}function Fa(t){if(!t)return null;const e={path:null,query:null},n=new Gx(t),r=t.indexOf("?");return n.query===null?e.path=t:(e.path=t.slice(0,r),e.query=gG(n.query)),n.fragment&&(e.hash=n.fragment,n.query===null&&(e.path=e.path.slice(0,e.path.length-(n.fragment.length+1)))),e}function gG(t){const e=t.split("&"),n={};for(const r of e){if(!r)continue;const i=r.indexOf("=");let s,o;i<0?(s=decodeURIComponent(r),o=""):(s=decodeURIComponent(r.slice(0,i)),o=decodeURIComponent(r.slice(i+1)));let a=n[s];typeof a=="string"&&(a=n[s]=[a]),Array.isArray(a)?a.push(o):n[s]=o}return n}function xk(t,e){return t?Object.keys(t).map(n=>{const r=t[n];if(r==null)return"";const i=encodeURIComponent(n)+"=";return Array.isArray(r)?r.map(s=>Q3(s)?i+encodeURIComponent(JSON.stringify(s)):i+encodeURIComponent(s)).join("&"):Q3(r)?i+encodeURIComponent(JSON.stringify(r)):i+encodeURIComponent(r)}).filter(n=>n).join("&"):""}function Ede(t=!1){let e,n=U2.proxyUrl;if(typeof t=="string"){e=NDe(t);const r=X5(t);r&&(n=r.proxyUrl)}else e=!!t;if(!n)throw vDe().warn(tQ),new Xe("urlUtils:proxy-not-set",tQ);return e&&aF()&&(n=wG(n)),Fa(n)}function Ikt(t,e=!1){const n=X5(t);let r,i;if(n){const s=yG(n.proxyUrl);r=s.path,i=s.query?gG(s.query):null}else if(e){const s=Ede(t);r=s.path,i=s.query}if(r){const s=Fa(t);t=r+"?"+s.path;const o=xk({...i,...s.query});o&&(t=`${t}?${o}`)}return t}const dE={path:"",query:""};function yG(t){const e=t.indexOf("?");return e!==-1?(dE.path=t.slice(0,e),dE.query=t.slice(e+1)):(dE.path=t,dE.query=null),dE}function Sde(t){return t=(t=t4(t=jDe(t=yG(t).path),!0)).toLowerCase()}function ADe(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Sde(t.urlPrefix)},n=U2.proxyRules,r=e.urlPrefix;let i=n.length;for(let s=0;s<n.length;s++){const o=n[s].urlPrefix;if(r.startsWith(o)){if(r.length===o.length)return-1;i=s;break}o.startsWith(r)&&(i=s+1)}return n.splice(i,0,e),i}function X5(t){const e=U2.proxyRules,n=Sde(t);for(let r=0;r<e.length;r++)if(n.startsWith(e[r].urlPrefix))return e[r]}function Rkt(t,e){if(!t||!e)return!1;t=e4(t),e=e4(e);const n=eQ(t),r=eQ(e);return n!=null&&r!=null?n.portalHostname===r.portalHostname:n==null&&r==null&&I1(t,e,!0)}function IDe(t,e){return t=e4(t),e=e4(e),t4(t)===t4(e)}function e4(t){const e=(t=pg(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function oF(t,e=U2.interceptors){const n=r=>r instanceof RegExp?r.test(t):typeof r=="string"?t.startsWith(r):r==null;if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(n))return r}else if(n(r.urls))return r}return null}function I1(t,e,n=!1){if(!t||!e)return!1;const r=cF(t),i=cF(e);return!(!n&&r.scheme!==i.scheme)&&r.host!=null&&i.host!=null&&r.host.toLowerCase()===i.host.toLowerCase()&&r.port===i.port}function vG(t){if(typeof t=="string"){if(!vl(t))return!0;t=cF(t)}if(I1(t,ia))return!0;const e=U2.trustedServers||[];for(let n=0;n<e.length;n++){const r=RDe(e[n]);for(let i=0;i<r.length;i++)if(I1(t,r[i]))return!0}return!1}function RDe(t){return fP[t]||(xG(t)||Td(t)?fP[t]=[new Gx(Bc(t))]:fP[t]=[new Gx(`http://${t}`),new Gx(`https://${t}`)]),fP[t]}function Bc(t,e=pG,n){return Td(t)?n?.preserveProtocolRelative?t:ia.scheme==="http"&&ia.authority===sc(t).slice(2)?`http:${t}`:`https:${t}`:xG(t)?t:YA(t.startsWith("/")?$De(e):e,t)}function _G(t,e=pG,n){if(t==null||!vl(t))return t;const r=pg(t),i=r.toLowerCase(),s=pg(e).toLowerCase().replace(/\/+$/,""),o=n?pg(n).toLowerCase().replace(/\/+$/,""):null;if(o&&!s.startsWith(o))return t;const a=(h,f,g)=>(g=h.indexOf(f,g))===-1?h.length:g;let l=a(i,"/",i.indexOf("//")+2),c=-1;for(;i.slice(0,l+1)===s.slice(0,l)+"/"&&(c=l+1,l!==i.length);)l=a(i,"/",l+1);if(c===-1||o&&c<o.length)return t;t=r.slice(c);const u=s.slice(c-1).replaceAll(/[^/]+/g,"").length;if(u>0)for(let h=0;h<u;h++)t=`../${t}`;else t=`./${t}`;return t}function pg(t){return t=zDe(t=VDe(t=FDe(t=Bc(t=t.trim()))))}function YA(...t){const e=t.filter(e2);if(!e?.length)return;const n=[];if(vl(e[0])){const i=e[0],s=i.indexOf("//");s!==-1&&(n.push(i.slice(0,s+1)),LDe(e[0])&&(n[0]+="/"),e[0]=i.slice(s+2))}else e[0].startsWith("/")&&n.push("");const r=e.reduce((i,s)=>s?i.concat(s.split("/")):i,[]);for(let i=0;i<r.length;i++){const s=r[i];s===".."&&n.length>0&&n[n.length-1]!==".."?n.pop():(!s&&i===r.length-1||s&&(s!=="."||n.length===0))&&n.push(s)}return n.join("/")}function sc(t,e=!1){if(t==null||XA(t)||nv(t))return null;let n=t.indexOf("://");if(n===-1&&Td(t))n=2;else{if(n===-1)return null;n+=3}const r=t.indexOf("/",n);return r!==-1&&(t=t.slice(0,r)),e&&(t=t4(t,!0)),t}function vl(t){return Td(t)||xG(t)}function XA(t){return t!=null&&t.startsWith("blob:")}function nv(t){return t!=null&&t.startsWith("data:")}function PDe(t){const e=t2(t);return e?.isBase64?_de(e.data):null}function Pkt(t){return yDe(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const CDe=/^data:(.*?)(;base64)?,(.*)$/;function t2(t){const e=t.match(CDe);if(!e)return null;const[,n,r,i]=e;return{mediaType:n,isBase64:!!r,data:i}}function Tde(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function MDe(t){return(await fetch(t)).blob()}function Ckt(t){const e=PDe(t);if(!e)return null;const n=t2(t);return new Blob([e],{type:n.mediaType})}function Td(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function xG(t){return t!=null&&xde.test(t)}function NDe(t){return t!=null&&_De.test(t)||ia.scheme==="https"&&Td(t)}function ODe(t){return t!=null&&wde.test(t)||ia.scheme==="http"&&Td(t)}function LDe(t){return t!=null&&xDe.test(t)}function wG(t){return Td(t)?`https:${t}`:t.replace(wde,"https:")}function DDe(){return ia.scheme==="http"}function aF(){return ia.scheme==="https"}function t4(t,e=!1){return Td(t)?t.slice(2):(t=t.replace(xde,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function $De(t){const e=t.indexOf("//"),n=t.indexOf("/",e+2);return n===-1?t:t.slice(0,n)}function Mkt(t){let e=0;if(vl(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const n=t.lastIndexOf("/");return n<e?t:t.slice(0,n+1)}function Nkt(t,e){if(!t)return"";const n=Fa(t).path.replace(/\/+$/,""),r=n.slice(n.lastIndexOf("/")+1);if(!e?.length)return r;const i=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(i,"")}function jDe(t){return t.endsWith("/")?t:`${t}/`}function kde(t){return t.replace(/\/+$/,"")}function FDe(t){if(/^https?:\/\//i.test(t)){const e=yG(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function VDe(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function zDe(t){const e=U2.httpsDomains;if(!ODe(t))return t;const n=t.indexOf("/",7);let r;if(r=n===-1?t:t.slice(0,n),r=r.toLowerCase().slice(7),bde.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return DDe()&&r===ia.authority&&!wDe.test(t)||(aF()&&r===ia.authority||e&&e.some(i=>r===i||r.endsWith(`.${i}`))||aF()&&!X5(t))&&(t=wG(t)),t}function lF(t,e,n){if(!(e&&n&&t&&vl(t)))return t;const r=t.indexOf("//"),i=t.indexOf("/",r+2),s=t.indexOf(":",r+2),o=Math.min(i<0?t.length:i,s<0?t.length:s);return t.slice(r+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${n}${t.slice(o)}`}function UDe(t,e){const n=new URL(t);return n.host=e,n.port&&!bde.test(e)&&(n.port=""),n.toString()}function Okt(t){return new URL(t).host}function cF(t){return typeof t=="string"?new Gx(Bc(t)):(t.scheme||(t.scheme=ia.scheme),t)}function Lkt(t){return BDe.test(t)}function Ade(t,e){const n=Fa(t),r=Object.keys(n.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),n.path}function GDe(t,e,n){const r=Fa(t),i=r.query||{};return i[e]=String(n),`${r.path}?${xk(i)}`}function B6(t,e){if(!e)return t;const n=Fa(t),r=n.query||{};for(const[s,o]of Object.entries(e))o!=null&&(r[s]=o);const i=xk(r);return i?`${n.path}?${i}`:n.path}function Ide(t){if(t==null)return null;const e=t.match(Rde);return e?e[2]:null}function nQ(t){if(t==null)return null;const e=t.match(Rde);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Dkt(t){return typeof t=="string"?t2(t)??{data:t}:new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(t2(r.result)),r.onerror=i=>n(i)})}const Rde=/([^.]*)\.([^/]*)$/,BDe=/(^data:image\/svg|\.svg$)/i,Pde="20251114",Cde="ec088c999de2dac6fb9478a47da1bad775545540";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const WDe="4.34";let Kr,bG=WDe;function $kt(t){Kr=t}function jkt(t){const e=Kr?.findCredential(t);return e?.token?GDe(t,"token",e.token):t}bG="4.34.8",ye("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),ye("host-webworker");function HDe(t,e){for(const n of t.values())if(e(n))return!0;return!1}function Fkt(t,e){for(const n of t.values())if(!e(n))return!1;return!0}function Vkt(t,e){for(const n of t.values())if(e(n))return n;return null}function ZA(t,e,n){const r=t.get(e);if(r!==void 0)return r;const i=n();return t.set(e,i),i}function zkt(t){const e=new Map;return n=>(e.has(n)||e.set(n,t(n)),e.get(n))}const qDe={remove:()=>{}};function qn(t){return t?{remove(){t&&(t(),t=void 0)}}:qDe}function Mde(t){t.forEach(e=>e?.remove())}function Ukt(t){Mde(t),t.length=0}function rv(t){return qn(()=>Mde(t))}function Gkt(t){return qn(()=>t()?.remove())}function KDe(t){return qn(()=>t?.abort())}function Bkt(t){return qn(t!=null?()=>t.destroy():void 0)}function YDe(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function Wkt(t){YDe(t)&&t.remove()}function Hkt(t){return{[Symbol.dispose](){t.remove()}}}function XDe(t){return{setTimeout:(e,n)=>{const r=t.setTimeout(e,n);return qn(()=>t.clearTimeout(r))}}}const G2=XDe(globalThis);function Z5(t){return ZDe(t)||Nde(t)}function ZDe(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function Nde(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function B2(t,e,n){if(!Z5(t))throw new TypeError("target is not a Evented or EventTarget object");return Nde(t)?JDe(t,e,n):t.on(e,n)}function JDe(t,e,n,r){if(Array.isArray(e)){const i=e.slice();for(const s of i)t.addEventListener(s,n,r);return qn(()=>{for(const s of i)t.removeEventListener(s,n,r)})}return t.addEventListener(e,n,r),qn(()=>t.removeEventListener(e,n,r))}function Ode(t,e,n){if(!Z5(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,n);const r=B2(t,e,i=>{r.remove(),n.call(t,i)});return r}function Lde(t,e){if(t==null)throw new Error(e??"value is None")}function Mi(t){return t?.destroy(),null}function qkt(t){return t?.dispose(),null}function Qr(t){return t?.remove(),null}function R1(t){return t?.abort(),null}function Kkt(t){return t?.release(),null}function Ykt(t,e,n){return t!=null&&e!=null?n!=null?n(t,e):t.equals(e):t===e}function QDe(t,e){let n;return t.some((r,i)=>(n=e(r,i),n!=null)),n??void 0}function Tr(t="Aborted"){return new Xe("AbortError",t)}function hi(t,e="Aborted"){if(ha(t))throw Tr(e)}function JA(t){return t instanceof AbortSignal?t:t?.signal??void 0}function ha(t){const e=JA(t);return e!=null&&e.aborted}function Dde(t){if(ya(t))throw t}function rQ(t){if(!ya(t))throw t}function lu(t,e){const n=JA(t);if(n!=null){if(!n.aborted)return Ode(n,"abort",()=>e());e()}}function EG(t,e){const n=JA(t);if(n!=null)return hi(n),Ode(n,"abort",()=>e(Tr()))}function e6e(t,e){return JA(e)==null?t:new Promise((n,r)=>{let i=lu(e,()=>r(Tr()));const s=()=>{i=Qr(i)};t.then(s,s),t.then(n,r)})}function ya(t){return t?.name==="AbortError"}async function n4(t){try{return await t}catch(e){if(!ya(e))throw e;return}}async function SG(t){if(!t)return;if(typeof t.forEach!="function"){const n=Object.keys(t),r=n.map(o=>t[o]),i=await SG(r),s={};return n.map((o,a)=>s[o]=i[a]),s}const e=t;return Promise.allSettled(e).then(n=>Array.from(e,(r,i)=>{const s=n[i];return s.status==="fulfilled"?{promise:r,value:s.value}:{promise:r,error:s.reason}}))}async function t6e(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function Xkt(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function $de(t,e=void 0,n){const r=new AbortController;return lu(n,()=>r.abort()),new Promise((i,s)=>{let o=setTimeout(()=>{o=0,i(e)},t);lu(r,()=>{o&&(clearTimeout(o),s(Tr()))})})}function Zkt(t,e,n,r){const i=n&&"abort"in n?n:null;r!=null||i||(r=n);let s=setTimeout(()=>{s=0,i?.abort()},e);const o=()=>r||new Xe("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(a=>{if(s===0)throw o();return clearTimeout(s),a},a=>{throw clearTimeout(s),s===0?o():a})}function n6e(t,e){const n=new AbortController,r=setTimeout(()=>n.abort(),e);return lu(t,()=>{n.abort(),clearTimeout(r)}),{...t,signal:n.signal}}function da(t){return t&&typeof t.then=="function"}function uF(t){return da(t)?t:Promise.resolve(t)}function r6e(t,e=-1){let n,r,i,s,o=null;const a=(...l)=>{if(n){r=l,s&&s.reject(Tr()),s=uc();const f=s.promise;if(o){const g=o;o=null,g.abort()}return f}if(i=s||uc(),s=null,e>0){const f=new AbortController;n=uF(t(...l,f.signal));const g=n;$de(e).then(()=>{n===g&&(s?f.abort():o=f)})}else n=1,n=uF(t(...l));const c=()=>{const f=r;r=i=n=o=null,f!=null&&a(...f)},u=n,h=i;return u.then(c,c),u.then(h.resolve,h.reject),h.promise};return a}function uc(){let t,e;const n=new Promise((i,s)=>{t=i,e=s}),r=i=>{t(i)};return r.resolve=i=>t(i),r.reject=i=>e(i),r.timeout=(i,s)=>G2.setTimeout(()=>r.reject(s),i),r.promise=n,r}function Jkt(t,e){e.then(t.resolve,t.reject)}async function iQ(t){await Promise.resolve(),hi(t)}function W2(t,e){const n=e?.url?.path;if(t&&n&&(t=Bc(t,n,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=_G(t,e.portalItem.itemUrl);r!=null&&r.startsWith(i6e)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return(t=hF(t,e?.portal))&&Q5.test(t)?TG(t):t}function n2(t,e,n=0){if((t=t&&Q5.test(t)?zde(t):t)==null)return t;!vl(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let r=Bc(t);if(e){const i=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(i){const s=hF(i,e.portal),o=hF(r,e.portal);r=_G(o,s,s),r!=null&&r!==o&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=Vde(r,e?.portal),vl(r)&&(r=pg(r)),e?.resources&&e?.portalItem&&!vl(r)&&!nv(r)&&n===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function J5(t,e,n){return W2(t,n)}function r2(t,e,n,r){const i=n2(t,r);i!==void 0&&(e[n]=i)}const Q5=/\/items\/([^/]+)\/resources\/(.*)/,i6e="./resources/";function jde(t){return(t?.match(Q5)??null)?.[1]??null}function Fde(t){const e=t?.match(Q5)??null;if(e==null)return null;const n=e[2],r=n.lastIndexOf("/");if(r===-1){const{path:o,extension:a}=nQ(n);return{prefix:null,filename:o,extension:a}}const{path:i,extension:s}=nQ(n.slice(r+1));return{prefix:n.slice(0,r),filename:i,extension:s}}function Vde(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?lF(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function hF(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const n=`${e.urlKey}.${e.customBaseUrl}`,r=mG();return I1(r,`${r.scheme}://${n}`)?lF(t,e.portalHostname,n):lF(t,n,e.portalHostname)}function TG(t){if(!t)return t||null;let e=t;return e&&Kr&&!Kr.findCredential(e)&&(e=vde(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function zde(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Kr&&!Kr.findCredential(e)&&(e=vde(e)),e}const s6e=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:Vde,fromCDNUrl:zde,fromJSON:W2,itemIdFromResourceUrl:jde,prefixAndFilenameFromResourceUrl:Fde,read:J5,toCDNUrl:TG,toJSON:n2,write:r2},Symbol.toStringTag,{value:"Module"})),Ude={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Gde=Object.values(Ude),Bde=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Gde.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),o6e=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Gde.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),a6e=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Qkt(t){return Bde.test(t)}function QA(t){if(t==null)return null;const e=Fa(t),n=e?.path.match(Bde)||e?.path.match(o6e);if(!n)return null;const[,r,i,s,o]=n,a=i.indexOf("/");return{title:Wde(a!==-1?i.slice(a+1):i),serverType:Ude[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:r}}}function l6e(t){const e=Fa(t).path.match(a6e);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Wde(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function eAt(t,e){const n=[];if(t){const r=QA(t);r!=null&&r.title&&n.push(r.title)}if(e){const r=Wde(e);n.push(r)}if(n.length===2){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function sQ(t){let e=sc(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function tAt(t,e){return t&&kde(Ade(t,e))}function nAt(t){let{url:e}=t;if(!e)return{url:e};e=Ade(e,t.logger);const n=Fa(e),r=QA(n.path);let i;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(i=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const s=l6e(n.path);s!=null&&(e=s.serviceUrl,i=s.sublayerId)}return{url:kde(e),layerId:i}}function rAt(t,e,n,r,i){r2(e,r,"url",i),r.url&&t.layerId!=null&&(r.url=YA(r.url,n,t.layerId.toString()))}function iAt(t){if(!t)return!1;const e=t.toLowerCase(),n=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),i=e.includes("/imageserver/wmsserver"),s=e.includes("/wmsserver");return n&&(r||i||s)}const c6e=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function kG(t){if(!AG(t))return null;const e=r=>r instanceof RegExp?r.test(t):typeof r=="string"&&t.startsWith(r),n=Qn.apiKeys;if(Array.isArray(n.scopes)){for(const r of n.scopes)if(Array.isArray(r.urls)){if(r.urls.some(e))return r.token}else if(e(r.urls))return r.token}return n.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?n.basemapStyles:Qn.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?Qn.apiKey:null}function dF(){return Qn.apiKey!=null||Qn.apiKeys.basemapStyles!=null}function u6e(t,e){return e?AG(t):kG(t)!=null}function AG(t){const e=sc(t,!0);return!!e&&!c6e.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function h6e(t,e,n=!1,r){return new Promise((i,s)=>{if(ha(r))return void s(oQ());let o=()=>{c(),s(new Error(`Unable to load ${e}`))},a=async()=>{const u=t;try{await u.decode()}catch{}c(),i(u)},l=()=>{if(!t)return;const u=t;c(),u.src="",s(oQ())};const c=()=>{t&&(t.removeEventListener("error",o),t.removeEventListener("load",a),o=null,a=null,t=null,r?.removeEventListener("abort",l),l=null,n&&URL.revokeObjectURL(e))};r?.addEventListener("abort",l),t.addEventListener("error",o),t.addEventListener("load",a)})}function oQ(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const Hde="Timeout exceeded";function d6e(){return new Error(Hde)}function sAt(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===Hde}function f6e(t){Qn.request.crossOriginNoCorsDomains||(Qn.request.crossOriginNoCorsDomains={});const e=Qn.request.crossOriginNoCorsDomains;for(let n of t)n=n.toLowerCase(),/^https?:\/\//.test(n)?e[sc(n)??""]=0:(e[sc("http://"+n)??""]=0,e[sc("https://"+n)??""]=0)}function p6e(t){const e=Qn.request.crossOriginNoCorsDomains;if(e){let n=sc(t);if(n)return n=n.toLowerCase(),!I1(n,mG())&&e[n]<Date.now()-36e5}return!1}async function m6e(t){const e=Fa(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const n=Qn.request.crossOriginNoCorsDomains,r=sc(t);n&&r&&(n[r.toLowerCase()]=Date.now())}const fF=new Map;function g6e(t,e){const n=e?.preferredHost;if(!n||I1(t,`https://${n}`,!0))return;const r=QA(t);if(!r||r.serverType!=="FeatureServer"||yde(t))return;const i=r.url.path.toLowerCase();fF.has(i)||fF.set(i,n)}function aQ(t){const e=QA(t)?.url.path.toLowerCase();if(!e)return t;const n=fF.get(e);return n?UDe(t,n):t}async function Qi(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=gG(e.query.toString().replaceAll("+"," ")));const n=nv(t),r=XA(t);r||n||(t=pg(t));const i={url:t,requestOptions:{...e}},s=g=>({data:g,getAllHeaders:i2,getHeader:i2,httpStatus:200,requestOptions:i.requestOptions,url:i.url}),o=oF(t,Vc.internalInterceptors);if(o){const g=await cQ(o,i);if(g!=null)return s(g)}let a=oF(t);if(a){const g=await cQ(a,i);if(g!=null)return s(g);a.after||a.error||(a=null)}if(t=i.url,(e=i.requestOptions).responseType==="image"&&(ye("host-webworker")||ye("host-node")))throw rh("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),i);if(e.method==="head"){if(e.body)throw rh("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),i);if(n||r)throw rh("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),i)}if(await w6e(),r4)return r4.execute(t,e);const l=new AbortController,c=lu(e,()=>l.abort()),u={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:i,redoRequest:!1,useIdentity:Vc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=e.useRequestQueue?k6e(u):mF(u),f=await h.finally(()=>c?.remove());return a?.after?.(f),f}let r4,qde=!1;const Vc=Qn.request,Kde="FormData"in globalThis,y6e=new Set([499,498,403,401]),v6e=new Set(["COM_0056","COM_0057","SB_0008"]),_6e=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],i2=()=>null,i4=Symbol();function x6e(t){const e=sc(t);e&&!Qi._corsServers.includes(e)&&Qi._corsServers.push(e)}function lQ(t){const e=sc(t);return!e||e.endsWith(".arcgis.com")||Qi._corsServers.includes(e)||vG(e)}function rh(t,e,n,r){let i;const s={url:n.url,requestOptions:n.requestOptions,getAllHeaders:i2,getHeader:i2,ssl:!1};if(e instanceof Xe)return e.details?(e.details=Ze(e.details),e.details.url=n.url,e.details.requestOptions=n.requestOptions):e.details=s,e;if(e){const o=r&&(()=>Array.from(r.headers)),a=r&&(u=>r.headers.get(u)),l=r?.status,c=e.message;c&&(i=c),o&&a&&(s.getAllHeaders=o,s.getHeader=a),s.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,s.subCode=e.subcode,s.messageCode=e.messageCode,typeof e.details=="string"?(s.messages=[e.details],i??=e.details):(s.messages=e.details,i??=s.messages?.[0]),s.raw=i4 in e?e[i4]:e}return i??="Error",ya(e)?Tr():new Xe(t,i,s)}async function w6e(){ye("host-webworker")&&(!r4&&globalThis.invokeStaticMessage?r4=await _e(()=>import("./request-bASnp_Kr.js"),[]):qde=!0)}async function pF(){Kr||await _e(()=>import("./IdentityManager-B5JkgnVm.js"),__vite__mapDeps([85,86]))}async function b6e(t){const e=t.params.url,n=t.params.requestOptions,r=t.controller.signal,i=n.body;let s=null,o=null;if(Kde&&"HTMLFormElement"in globalThis&&(i instanceof FormData?s=i:i instanceof HTMLFormElement&&(s=new FormData(i))),typeof i=="string"&&(o=i),t.fetchOptions={cache:n.cacheBust?"no-cache":"default",credentials:"same-origin",headers:n.headers||{},keepalive:n.keepAlive??!1,method:n.method==="head"?"HEAD":"GET",mode:"cors",priority:Vc.priority,redirect:"follow",signal:r},(s||o)&&(t.fetchOptions.body=s||o),(qde||n.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||n.query?.token||s?.get("token")),!t.hasToken){const a=kG(e);a&&(n.query??={},n.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!Yde(e)&&!ha(r)){let a;n.authMode==="immediate"?(await pF(),a=await Kr.getCredential(e,{signal:r})):n.authMode==="no-prompt"?(await pF(),a=await Kr.getCredential(e,{prompt:!1,signal:r}).catch(()=>{})):Kr&&(a=Kr.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function Yde(t){return _6e.some(e=>e.test(t))}async function E6e(t){let e=t.params.url,n=aQ(e);const r=t.params.requestOptions,i=t.fetchOptions??{},s=XA(e)||nv(e),o=r.responseType||"json",a=s?0:r.timeout!=null?r.timeout:Vc.timeout;let l=!1;if(!s){t.useSSL&&(e=wG(e));let g={...r.query};t.credentialToken&&(g.token=t.credentialToken);let v=xk(g);ye("esri-url-encodes-apostrophe")&&(v=v.replaceAll("'","%27"));const x=n.length+1+v.length;let b;l=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||x>Vc.maxUrlLength;const T=r.useProxy||!!X5(e);if(T){const A=Ede(e);b=A.path,!l&&b.length+1+x>Vc.maxUrlLength&&(l=!0),A.query&&(g={...A.query,...g})}if(i.method==="HEAD"&&(l||T)){if(l)throw x>Vc.maxUrlLength?rh("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):rh("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(T)throw rh("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}l?(i.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?e=B6(e,g):(i.body=xk(g),i.headers||(i.headers={}),i.headers["Content-Type"]="application/x-www-form-urlencoded")):e=B6(e,g),T&&(t.useProxy=!0,e=`${b}?${e}`),g.token&&Kde&&i.body instanceof FormData&&!yde(e)&&i.body.set("token",g.token),r.hasOwnProperty("withCredentials")?t.withCredentials=r.withCredentials:I1(e,mG())||(vG(e)||Kr&&Kr.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(i.credentials="include",p6e(e)&&await m6e(l?B6(e,g):e)),n=aQ(e)}let c,u,h=0,f=!1;a>0&&(h=setTimeout(()=>{f=!0,t.controller.abort()},a));try{if(r.responseType==="native-request-init")u=i,u.url=n,r.signal?u.signal=r.signal:delete u.signal;else if(r.responseType!=="image"||i.cache!=="default"||i.keepalive||i.method!=="GET"||l||S6e(r.headers)||!s&&!t.useProxy&&Vc.proxyUrl&&!lQ(e)){if(Qi._beforeFetch&&await Qi._beforeFetch(e,i),c=await fetch(n,i),Qi._afterFetch&&await Qi._afterFetch(c),t.useProxy||x6e(e),r.responseType==="native")u=c;else if(i.method!=="HEAD")if(c.ok){switch(o){case"array-buffer":u=await c.arrayBuffer();break;case"blob":case"image":u=await c.blob();break;default:u=await c.text()}if(h&&(clearTimeout(h),h=0),o==="json"||o==="xml"||o==="document")if(u)switch(o){case"json":u=JSON.parse(u);break;case"xml":u=uQ(u,"application/xml");break;case"document":u=uQ(u,"text/html")}else u=null;if(u){if(o==="array-buffer"||o==="blob"){const g=c.headers.get("Content-Type");if(g&&/application\/json|text\/plain/i.test(g)&&u[o==="blob"?"size":"byteLength"]<=750)try{const v=await new Response(u).json();v.error&&(u=v)}catch{}}o==="image"&&u instanceof Blob&&(u=await hQ(URL.createObjectURL(u),t,!0))}}else{u=await c.text();try{u=JSON.parse(u)}catch{}}}else u=await hQ(n,t)}catch(g){if(g.name==="AbortError")throw f?d6e():Tr("Request canceled");if(!(!c&&g instanceof TypeError&&Vc.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||t.useProxy||lQ(e))throw g;t.redoRequest=!0,ADe({proxyUrl:Vc.proxyUrl,urlPrefix:sc(e)??""})}finally{h&&clearTimeout(h)}return[c,u]}async function cQ(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let n,r;try{r=await t.before(e)}catch(i){n=rh("request:interceptor",i,e)}if((r instanceof Error||r instanceof Xe)&&(n=rh("request:interceptor",r,e)),n)throw t.error&&t.error(n),n;return r}}function S6e(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function uQ(t,e){let n;try{n=new DOMParser().parseFromString(t,e)}catch{}if(!n||n.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return n}Qi._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Qi._beforeFetch=void 0,Qi._afterFetch=void 0;const T6e=new Map;async function k6e(t){const e=I6e(t.params.url);if(!e)return mF(t);const{QueueProcessor:n}=await _e(()=>import("./QueueProcessor-BVeWtZRX.js"),[]);return ZA(T6e,e.origin,()=>{const i=e.isHosted?ye("request-queue-concurrency-hosted"):ye("request-queue-concurrency-non-hosted");return new n({concurrency:i,process:s=>{if(ha(s.params.requestOptions))throw rh("",Tr("Request canceled"),s.params);return mF(s)}})}).push(t)}async function mF(t){let e,n;await b6e(t);try{do[e,n]=await E6e(t);while(!await A6e(t,e,n))}catch(s){const o=rh("request:server",s,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const r=t.params.url;if(n)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&n.user?.username&&!vG(r)){const s=sc(r,!0);s&&Vc.trustedServers.push(s)}Array.isArray(n.authorizedCrossOriginNoCorsDomains)&&f6e(n.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&g6e(r,n);const i=t.credential;if(i&&Kr){let o=Kr.findServerInfo(i.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const a=Kr.findCredential(o,i.userId);a&&Kr._getIdenticalSvcIdx(o,a)===-1&&a.resources.unshift(o)}}return{data:n,getAllHeaders:e?()=>Array.from(e.headers):i2,getHeader:e?s=>e.headers.get(s):i2,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function A6e(t,e,n){if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let i,s;if(n&&(n.error&&typeof n.error=="object"?i=n.error:n.status==="error"&&Array.isArray(n.messages)&&(i={...n},i[i4]=n,i.details=n.messages)),!i&&!e.ok)throw i=new Error(`Unable to load ${e.url} status: ${e.status}`),i[i4]=n,i;let o,a=null;i&&(s=Number(i.code),a=i.hasOwnProperty("subcode")?Number(i.subcode):null,o=i.messageCode,o=o?.toUpperCase());const l=r.authMode;if(s===403&&(a===4||i.message?.toLowerCase().includes("ssl")&&!i.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||s===498)&&s!==void 0&&y6e.has(s)&&!Yde(t.params.url)&&(s!==403||(!o||!v6e.has(o))&&(a==null||a===2&&t.credentialToken))){await pF();try{const c=await Kr.getCredential(t.params.url,{error:rh("request:server",i,t.params),credential:t.credential,prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=c,t.credentialToken=c.token,t.useSSL=t.useSSL||c.ssl,!1}catch(c){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;i=c}}if(i)throw i;return!0}function hQ(t,e,n=!1){const r=e.controller.signal,i=new Image;return e.withCredentials?i.crossOrigin="use-credentials":i.crossOrigin="anonymous",i.alt="",i.fetchPriority=Vc.priority,i.src=t,h6e(i,t,n,r)}function I6e(t){let e,n;return typeof t=="string"?(e=sc(t,!0),n=sQ(t)):(e=t.origin,n=sQ(t.toString())),e==null?null:{origin:e,isHosted:n}}function R6e(t){return t?.release&&typeof t.release=="function"}function P6e(t){return t?.acquire&&typeof t.acquire=="function"}var xg;let H2=(xg=class{constructor(e,n,r,i=1,s=0){this._creator=e,this._acquireFunction=n,this._releaseFunction=r,this.allocationSize=i,this._pool=new Array(s),this._initialSize=s;for(let o=0;o<s;o++)this._pool[o]=this._creator();this.allocationSize=Math.max(i,1)}destroy(){this.prune(0)}acquire(...e){let n;if(xg.test.disabled)n=this._creator();else{if(this._pool.length===0){const r=this.allocationSize;for(let i=0;i<r;i++)this._pool[i]=this._creator()}n=this._pool.pop()}return this._acquireFunction?this._acquireFunction(n,...e):P6e(n)&&n.acquire(...e),n}release(e){e&&!xg.test.disabled&&(this._releaseFunction?this._releaseFunction(e):R6e(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let n=e;n<this._pool.length;++n){const r=this._pool[n];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},xg.test={disabled:!!ye("esri-tests-disable-memory-pools")},xg);function C6e(t){t.length=0}let Aa=class{constructor(e=50,n=50){this._pool=new H2(()=>[],void 0,C6e,n,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return W6.acquire()}static release(e){return W6.release(e)}static prune(){W6.prune()}};const W6=new Aa(100),dQ=new WeakMap;function M6e(t,e,n=!1){const r=` DEPRECATED - ${e}`;if(!n)return void t.warn(r);let i=dQ.get(t);i||(i=new Set,dQ.set(t,i)),i.has(e)||(i.add(e),t.warn(r))}const s4="https://www.esriurl.com/";function N6e(t,e,n,r={}){ye("esri-deprecation-warnings")&&Pg(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${s4}${n}/`,`Esri's move to web components: ${s4}components-transition-plan/`],replacement:`<${n}></${n}>`,warnOnce:!0,...r})}function O6e(t,e,n,r={}){ye("esri-deprecation-warnings")&&Pg(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${s4}${n}/`,`Esri's move to web components: ${s4}components-transition-plan/`],replacement:`<${n}></${n}>`,warnOnce:!0,...r})}function aAt(t,e,n={}){ye("esri-deprecation-warnings")&&Pg(t,`Module: ${e}`,n)}function Xde(t,e,n={}){if(ye("esri-deprecation-warnings")){const{moduleName:r}=n;Pg(t,`Function: ${(r?r+"::":"")+e+"()"}`,n)}}function gF(t,e,n={}){if(ye("esri-deprecation-warnings")){const{moduleName:r}=n;Pg(t,`Property: ${(r?r+"::":"")+e}`,n)}}function L6e(t,e,n={}){ye("esri-deprecation-warnings")&&Pg(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...n})}function Pg(t,e,n={}){if(ye("esri-deprecation-warnings")){const{replacement:r,version:i,see:s,warnOnce:o}=n;let a=e;if(r&&(a+=`
	 Replacement: ${r}`),i&&(a+=`
	 Version: ${i}`),s)if(Array.isArray(s)){a+=`
	 See for more details:`;for(const l of s)a+=`
		${l}`}else a+=`
	 See ${s} for more details.`;M6e(t,a,o)}}function lAt(t){const e=[];return function*(){yield*e;let n,r=e.length;for(;!(n=t.next()).done;)for(e.push(n.value),yield n.value;++r<e.length;)yield e[r]}}function D6e(t,e){for(const n of t)if(n!=null&&e(n))return n}function o4(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let q2=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(n=>{e+=n.length}),e}add(e,n){if(o4(e)){const r=this._getOrCreateGroup(n);for(const i of e)pQ(i)&&r.push(i)}else pQ(e)&&this._getOrCreateGroup(n).push(e);return this}forEach(e,n){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&n&&r.forEach(n)}}has(e){return this._groups.has(pP(e))}remove(e){if(typeof e!="string"&&o4(e)){for(const n of e)this.remove(n);return this}return this.has(e)?(fQ(this._getGroup(e)),this._groups.delete(pP(e)),this):this}removeAll(){return this._groups.forEach(fQ),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const n=[];return this._groups.set(pP(e),n),n}_getGroup(e){return this._groups.get(pP(e))}};function pP(t){return t||"_default_"}function fQ(t){for(const e of t)e instanceof q2?e.removeAll():e.remove()}function pQ(t){return t!=null&&(!!t.remove||t instanceof q2)}const Zde=Symbol("Accessor-beforeDestroy");function Cg(t){return t.__accessor__??null}function $6e(t,e){return t?.metadata?.[e]!=null}function VC(t,e,n){return n?a4(t,e,{policy:n,path:""}):a4(t,e,null)}function a4(t,e,n){return e?Object.keys(e).reduce((r,i)=>{const s=i;if(s==="__proto__")return r;let o=null,a="merge";if(n&&(o=n.path?`${n.path}.${i}`:i,a=n.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[s]))return r[s]=e[s],r;if(r[s]===void 0)return r[s]=Ze(e[s]),r;let l=r[s],c=e[s];if(l===c)return r;if(Array.isArray(c)||Array.isArray(r))l=l?Array.isArray(l)?r[s]=l.slice():r[s]=[l]:r[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(u=>{l.includes(u)||l.push(u)}));else if(c&&typeof c=="object")if(n){const u=n.path;n.path=o,r[s]=a4(l,c,n),n.path=u}else r[s]=a4(l,c,null);else r.hasOwnProperty(i)&&!e.hasOwnProperty(i)||(r[s]=c);return r},t||{}):t}function Jde(t){return Array.isArray(t)?t:t.split(".")}function mQ(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function j6e(t){if(Array.isArray(t)){const e=[];for(const n of t)e.push(...mQ(n));return e}return mQ(t)}function Qde(t,e,n,r){const i=j6e(e);if(i.length!==1){const s=i.map(o=>r(t,o,n));return rv(s)}return r(t,i[0],n)}function efe(t,e){const n=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const i=parseInt(n,10);if(!isNaN(i))return Array.isArray(e)?e[i]:e.at(i)}const r=Cg(e);return $6e(r,n)?r.get(n):e[n]}function tfe(t,e,n){if(t==null)return t;const r=efe(e[n],t);return!r&&n<e.length-1?void 0:n===e.length-1?r:tfe(r,e,n+1)}function eI(t,e,n=0){return typeof e!="string"||e.includes(".")?tfe(t,Jde(e),n):efe(e,t)}function ad(t,e){return eI(t,e)}function gQ(t,e){return eI(e,t)!==void 0}const Xl={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function K2(t){let e=t.constructor.__accessorMetadata__;const n=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!n){e=Object.create(e);for(const r in e)e[r]=Ze(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function tI(t,e){const n=K2(t);let r=n[e];return r||(r=n[e]={}),r}function F6e(t,e){return VC(t,e,z6e)}const V6e=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function z6e(t){return V6e.test(t)?"replace":"merge"}let U6e=class{constructor(e,n){this._observers=e,this._observer=n}remove(){tde(this._observers,this._observer)}},nfe=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return G6e;this._observers==null&&(this._observers=[]);const n=this._observers;let r=!1,i=!1;const s=n.length;for(let o=0;o<s;++o){const a=n[o];if(a.destroyed)i=!0;else if(a===e){r=!0;break}}return r||(n.push(e),i&&this._removeDestroyedObservers()),new U6e(n,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const n=e.length;let r=0;for(let i=0;i<n;++i){for(;i+r<n&&e[i+r].destroyed;)++r;if(r>0){if(!(i+r<n))break;e[i]=e[i+r]}}e.length=n-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const n of e)n.onCommitted();this._observers=null}}};const G6e=qn(),ci={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let eO=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const l4=new eO,KE=[];let XS=l4;function tn(t){XS.onAccessed(t)}let zC=!1,UC=!1;function ap(t,e,n){if(zC)return IG(t,e,n);let r=null;return rfe(t),r=e.call(n),ife(),r}function B6e(t,e){return ap(l4,t,e)}function IG(t,e,n){const r=zC;zC=!0,rfe(t);let i=null;try{i=e.call(n)}catch(s){UC&&Tt.getLogger("esri.core.accessorSupport.tracking").error(s)}return ife(),zC=r,i}function rfe(t){XS=t,KE.push(t)}function ife(){const t=KE.length;if(t>1){const e=KE.pop();XS=KE[t-2],e.onTrackingEnd()}else if(t===1){const e=KE.pop();XS=l4,e.onTrackingEnd()}else XS=l4}function sfe(t,e){if(e.flags&ci.DepTrackingInitialized)return;e.flags|=ci.DepTrackingInitialized;const n=UC;UC=!1,e.flags&ci.AutoTracked?IG(e.trackingTarget,e.metadata.get,t):ofe(t,e),UC=n}const W6e=[];function ofe(t,e){e.flags&ci.ExplicitlyTracking||(e.flags|=ci.ExplicitlyTracking,IG(e.trackingTarget,()=>{const n=e.metadata.dependsOn||W6e;for(const r of n)if(typeof r!="string"||r.includes(".")){const i=Jde(r);for(let s=0,o=t;s<i.length&&o!=null&&typeof o=="object";++s)o=yQ(o,i[s],s!==i.length-1)}else yQ(t,r,!1)}),e.flags&=-129)}function yQ(t,e,n){const r=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const i=Cg(t);if(i){const s=i.propertiesByName.get(r);s&&(tn(s),sfe(t,s))}return n?t[r]:void 0}let vQ=class extends nfe{constructor(e,n){super(),this.propertyName=e,this.metadata=n,this.trackingTarget=new eO(this),this.flags=0,this.flags=ci.Dirty|(n.nonNullable?ci.NonNullable:0)|(n.hasOwnProperty("value")?ci.HasDefaultValue:0)|(n.get===void 0?ci.DepTrackingInitialized:0)|(n.dependsOn===void 0?ci.AutoTracked:0)}destroy(){this.flags&ci.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&tn(this);const n=e.store,r=this.propertyName,i=this.flags,s=n.get(r);if(i&ci.Computing||~i&ci.Dirty&&n.has(r))return s;this.flags|=ci.Computing;const o=e.host;let a;i&ci.AutoTracked?a=ap(this.trackingTarget,this.metadata.get,o):(ofe(o,this),a=this.metadata.get.call(o)),this.flags|=ci.DepTrackingInitialized,n.set(r,a,1);const l=n.get(r);return l===s?this.flags&=-2:B6e(this.commit,this),this.flags&=-5,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&ci.Overridden&&(this.flags|=ci.Dirty);const e=this._observers;if(e&&e.length>0)for(const n of e)n.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const n=e.slice();for(const r of n)r.onCommitted()}}};const pAt=8;function RG(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function yF(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function H6e(t){return yF(t)}let q6e=class afe{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const n=new afe;return this._values.forEach((r,i)=>{e&&e.has(i)||n.set(i,Ze(r))}),n}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,n){this._values.set(e,n)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,n){return this.has(e)}isBelowOrigin(e,n){return!this.has(e)}forEach(e){this._values.forEach(e)}};function c_(t,e,n){return t!==void 0}function _Q(t,e,n,r){return t!==void 0&&(!(n==null&&t.flags&ci.NonNullable)||(r.lifecycle,!1))}let K6e=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Xl.INITIALIZING,this.store=new q6e,this.mutable=!0,this._origin=7;const n=this.host.constructor.__accessorMetadata__;for(const r in n){const i=new vQ(r,n[r]);this.propertiesByName.set(r,i)}this.metadata=n}initialize(){this.lifecycle=Xl.CONSTRUCTING}constructed(){this.lifecycle=Xl.CONSTRUCTED}destroy(){this.lifecycle=Xl.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Xl.INITIALIZING}get(e){const n=this.propertiesByName.get(e);if(!c_(n))return;if(n.metadata.get)return n.getComputed(this);this.mutable&&tn(n);const r=this.store;return r.has(e)?r.get(e):n.metadata.value}originOf(e){const n=this.store.originOf(e);if(n===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&ci.HasDefaultValue)return"defaults"}return yF(n)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const n=this.propertiesByName.get(e);if(c_(n))return this.store.has(e)?this.store.get(e):n.metadata.value}internalSet(e,n){const r=this.propertiesByName.get(e);c_(r)&&this._internalSet(r,n)}getDependsInfo(e,n,r){const i=this.propertiesByName.get(n);if(!c_(i))return"";const s=new eO,o=ap(s,()=>i.metadata.get?.call(e));let a=`${r}${e.declaredClass.split(".").pop()}.${n}: ${o}
`;const l=s.accessed??new Set;if(l.size===0)return a;r+="  ";for(const c of l)c instanceof vQ&&(a+=`${r}${c.propertyName}: undefined
`);return a}setAtOrigin(e,n,r){const i=this.propertiesByName.get(e);if(c_(i))return this._setAtOrigin(i,n,r)}isOverridden(e){const n=this.propertiesByName.get(e);return n!==void 0&&!!(n.flags&ci.Overridden)}clearOrigin(e,n){const r=this.store,i=this.propertiesByName.get(e);if(!c_(i))return;const s=r.isAtOrigin(e,n)&&!(i.flags&ci.Overridden);r.delete(e,n),s&&i.notifyChange()}clearOverride(e){const n=this.propertiesByName.get(e);n&&n.flags&ci.Overridden&&(n.flags&=-3,n.notifyChange())}override(e,n){const r=this.propertiesByName.get(e);if(!_Q(r,e,n,this))return;const i=r.metadata.cast;if(i){const s=this._cast(i,n),{valid:o,value:a}=s;if(H6.release(s),!o)return;n=a}r.flags|=ci.Overridden,this._internalSet(r,n)}set(e,n){const r=this.propertiesByName.get(e);if(!_Q(r,e,n,this))return;const i=r.metadata.cast;if(i){const o=this._cast(i,n),{valid:a,value:l}=o;if(H6.release(o),!a)return;n=l}const s=r.metadata.set;s?s.call(this.host,n):this._internalSet(r,n)}setDefaultOrigin(e){this._origin=RG(e)}getDefaultOrigin(){return yF(this._origin)}notifyChange(e){const n=this.propertiesByName.get(e);n!==void 0&&n.notifyChange()}invalidate(e){const n=this.propertiesByName.get(e);n!==void 0&&n.invalidate()}commit(e){const n=this.propertiesByName.get(e);n!==void 0&&n.commit()}_internalSet(e,n){const r=this.lifecycle!==Xl.INITIALIZING?this._origin:0;this._setAtOrigin(e,n,r)}_setAtOrigin(e,n,r){const i=this.store,s=e.propertyName;if(i.isAtOrigin(s,r)&&fG(n,i.get(s))&&~e.flags&ci.Overridden)return;const o=i.isBelowOrigin(s,r)||i.isAtOrigin(s,r);o&&e.invalidate(),i.set(s,n,r),o&&e.commit(),sfe(this.host,e)}_cast(e,n){const r=H6.acquire();return r.valid=!0,r.value=n,e&&(r.value=e.call(this.host,n,r)),r}},Y6e=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const H6=new H2(()=>new Y6e);function c4(t,e,n){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))c4(t,r,e[r]);else{if(e.includes(".")){const i=e.split("."),s=i.splice(-1,1)[0];return void c4(ad(t,i),s,n)}const r=t.__accessor__;r!=null&&X6e(e,r),t[e]=n}}function X6e(t,e){if(ye("esri-unknown-property-errors")&&!Z6e(t,e))throw new Xe("set:unknown-property",J6e(t,e))}function Z6e(t,e){return e.metadata[t]!=null}function J6e(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let Q6e;function e$e(){return Q6e}let lfe=class extends H2{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const n=super.acquire(...e);return this._set.delete(n),n}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const mP=[];function u4(t){mP.push(t),mP.length===1&&queueMicrotask(()=>{const e=mP.slice();mP.length=0;for(const n of e)n()})}let ZS=class{constructor(e,n=30){this.name=e,this._counter=0,this._samples=new Array(n)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,n)=>e-n)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,n)=>e+n,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const h4=(t,e,n,r)=>{let i=e,s=e;const o=n>>>1,a=t[i-1];for(;s<=o;){s=i<<1,s<n&&r(t[s-1],t[s])<0&&++s;const l=t[s-1];if(r(l,a)<=0)break;t[i-1]=l,i=s}t[i-1]=a},cfe=(t,e)=>t<e?-1:t>e?1:0;function t$e(t,e,n,r){n===void 0&&(n=t.length),r===void 0&&(r=cfe);for(let s=n>>>1;s>e;s--)h4(t,s,n,r);const i=e+1;for(let s=n-1;s>e;s--){const o=t[e];t[e]=t[s],t[s]=o,h4(t,i,s,r)}}function*n$e(t,e,n,r){n===void 0&&(n=t.length),r===void 0&&(r=cfe);for(let s=n>>>1;s>e;s--)h4(t,s,n,r),yield;const i=e+1;for(let s=n-1;s>e;s--){const o=t[e];t[e]=t[s],t[s]=o,h4(t,i,s,r),yield}}const r$e=1.5,i$e=1.1;let ufe=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Jhe,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>xQ(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const n=new Array;for(let r=0;r<this._length;r++){const i=this.data[r];e(i)&&n.push(i)}return n}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,n){const r=this.data.indexOf(e,n);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let n=e;n<this._length;++n)this.data[n]=this._deallocator(this.data[n]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,n=e.length){for(let r=0;r<n;r++)this.data[this._length++]=e[r]}fill(e,n){for(let r=0;r<n;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,xQ(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const n=rF(this.data,e,this.length,this._hint);if(n!==-1)return this.data.splice(n,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(rF(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,n=e.length,r){this.length=nDe(this.data,e,this.length,n,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,n){if(e>=this.length||n>=this.length||e===n)return;const r=this.data[e];this.data[e]=this.data[n],this.data[n]=r}sort(e){t$e(this.data,0,this.length,e)}iterableSort(e){return n$e(this.data,0,this.length,e)}some(e,n){for(let r=0;r<this.length;++r)if(e.call(n,this.data[r],r,this.data))return!0;return!1}find(e,n){const{data:r,length:i}=this;for(let s=0;s<i;++s)if(e.call(n,r[s]))return r[s]}filterInPlace(e,n){let r=0;for(let i=0;i<this._length;++i){const s=this.data[i];e.call(n,s,i,this.data)&&(this.data[i]=this.data[r],this.data[r]=s,r++)}if(this._deallocator)for(let i=r;i<this._length;i++)this.data[i]=this._deallocator(this.data[i]);return this._length=r,this._shrink(),this}forAll(e,n){const{data:r,length:i}=this;for(let s=0;s<i;++s)e.call(n,r[s],s,r)}forEach(e,n){this.data.slice(0,this.length).forEach(e,n)}map(e,n){const r=new Array(this.length);for(let i=0;i<this.length;++i)r[i]=e.call(n,this.data[i],i,this.data);return r}reduce(e,n){let r=n;for(let i=0;i<this.length;++i)r=e(r,this.data[i],i,this.data);return r}has(e){const n=this.length,r=this.data;for(let i=0;i<n;++i)if(r[i]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function xQ(t){t.data.length>r$e*t.length&&(t.data.length=Math.floor(t.length*i$e))}function xAt(t){return t}function s$e(t){return 1e3*t}function wAt(t){return t}function bAt(t){return .001*t}let o$e=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},a$e=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},vF=0;const fE={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},_F=["prepare","preRender","render","postRender","update","finish"],xF=[],P1=new ufe;let l$e=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,hfe()}};function c$e(){qy!=null&&(cancelAnimationFrame(qy),qy=requestAnimationFrame(PG))}function hfe(){qy==null&&(vF=performance.now(),qy=requestAnimationFrame(PG))}const d4={frameTasks:P1,willDispatch:!1,clearFrameTasks:u$e,dispatch:ffe,executeFrameTasks:h$e,reschedule:c$e};function Y2(t){const e=new a$e(t);return xF.push(e),d4.willDispatch||(d4.willDispatch=!0,u4(ffe)),e}function s2(t){const e=new o$e(t);return P1.push(e),hfe(),new l$e(e)}let qy=null;function u$e(t=!1){P1.forAll(e=>{e.removed=!0}),t&&dfe()}function PG(){const t=performance.now();qy=null,qy=P1.some(n=>!n.paused&&!n.removed)?requestAnimationFrame(PG):null,d4.executeFrameTasks(t)}function h$e(t){const e=t-vF;vF=t;const n=1e3/60,r=Math.max(0,e-n);fE.time=t,fE.frameDuration=n-r;for(let i=0;i<_F.length;i++){const s=performance.now(),o=_F[i];P1.forAll(a=>{a.paused||a.removed||(i===0&&a.ticks++,a.phases[o]&&(fE.elapsedFrameTime=performance.now()-t,fE.deltaTime=a.ticks===0?0:e,a.phases[o]?.call(a,fE)))}),m$e[i].push(performance.now()-s)}dfe(),g$e.push(performance.now()-t)}const gP=new ufe;function dfe(){P1.forAll(t=>{t.removed&&gP.push(t)}),P1.removeUnorderedMany(gP.data,gP.length),gP.clear()}function ffe(){for(;xF.length;){const t=xF.shift();t.isActive&&t.callback()}d4.willDispatch=!1}function d$e(t=1,e){const n=uc(),r=()=>{ha(e)?n.reject(Tr()):t===0?n():(--t,u4(()=>r()))};return r(),n.promise}function f$e(t){return d$e(1,t)}async function p$e(t){await f$e(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}const m$e=_F.map(t=>new ZS(t)),g$e=new ZS("total");function pfe(t,e){for(const n of t.values())if(e(n))return!0;return!1}function wQ(t,e){if(!e)return t;for(const n of e)n!=null&&t.add(n);return t}function kAt(t,e){return e!=null&&t.add(e),t}function CG(t,e){const n=new Set;return wQ(n,t),wQ(n,e),n}function y$e(t,e){const n=new Set;for(const r of e)t.has(r)&&n.add(r);return n}function AAt(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function IAt(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function v$e(t,e){const n=new Set(t);for(const r of e)n.delete(r);return n}function _$e(t,e){return v$e(CG(t,e),y$e(t,e))}let x$e=0;function GC(){return++x$e}let tO=class extends eO{constructor(e){super(new w$e(e)),this._observer&&bQ.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&bQ.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},w$e=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=b$e}};const bQ=new FinalizationRegistry(t=>{t.deref()?.destroy()});function b$e(){}let Bx=!1;const f4=[];function mfe(t,e){let n=new tO(s),r=null,i=!1;function s(){if(!n||i)return;if(Bx)return void yfe(s);const a=r;n.clear(),Bx=!0,i=!0,r=ap(n,t),i=!1,Bx=!1,e(r,a),vfe()}function o(){n&&(n.destroy(),n=null,r=null)}return i=!0,r=ap(n,t),i=!1,qn(o)}function gfe(t,e){let n=new tO(i),r=null;function i(){e(r,o)}function s(){n&&(n.destroy(),n=null),r=null}function o(){return n?(n.clear(),r=ap(n,t),r):null}return o(),qn(s)}function E$e(t,e){let n=!1,r=!1;const i=!!e?.sync;let s=new tO(()=>{n||r||(r=!0,i?o():queueMicrotask(o))});function o(){r=!1,s&&!n&&(Bx?yfe(o):(s.clear(),Bx=!0,n=!0,ap(s,t),n=!1,Bx=!1,vfe()))}function a(){s&&(s.destroy(),s=null)}return n=!0,ap(s,t),n=!1,qn(a)}function yfe(t){f4.includes(t)||f4.unshift(t)}function vfe(){for(;f4.length;)f4.pop()()}var r1;let MG=(r1=class{constructor(){this.uid=GC(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,n,r,i,s){return this.pool.acquire(0,e,n,r,i,s,fG)}static acquireTracked(e,n,r,i){return this.pool.acquire(1,e,n,r,null,null,i)}notify(e,n){this.type===0?this.callback.call(this.target,e,n,this.path,this.target):this.callback.call(null,e,n,void 0,void 0)}acquire(e,n,r,i,s,o,a){this.uid=GC(),this.removed=!1,this.type=e,this.oldValue=n,this.callback=r,this.getValue=i,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=GC(),this.removed=!0}},r1.pool=new lfe(()=>new r1),r1);const BC=new Aa,Kf=new Set;let p4;function m4(t){Kf.delete(t),Kf.add(t),_fe()}function _fe(){p4||(p4=Y2(k$e))}function S$e(t){if(t.removed)return;const e=t.oldValue,n=t.getValue();t.equals(e,n)||(t.oldValue=n,t.notify(n,e))}function T$e(t){for(const e of Kf.values())e.target===t&&(e.removed=!0)}function k$e(){let t=10;for(;p4&&t--;){p4=null;const e=A$e(),n=BC.acquire();for(const r of e){const i=r.uid;S$e(r),i===r.uid&&r.removed&&n.push(r)}for(const r of Kf)r.removed&&(n.push(r),Kf.delete(r));for(const r of n)MG.pool.release(r);BC.release(n),BC.release(e),wF.forEach(r=>r())}}function A$e(){const t=BC.acquire();t.length=Kf.size;let e=0;for(const n of Kf)t[e]=n,++e;return Kf.clear(),t}const wF=new Set;function I$e(t){return wF.add(t),qn(()=>wF.delete(t))}function R$e(t,e,n){let r=Qde(t,e,n,(i,s,o)=>{let a,l,c=gfe(()=>eI(i,s),(u,h)=>{i.__accessor__?.lifecycle===Xl.DESTROYED||a&&a.uid!==l?r.remove():(a||(a=MG.acquireUntracked(u,o,h,i,s),l=a.uid),m4(a))});return qn(()=>{c.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,m4(a)),a=null),r=c=null})});return r}function P$e(t,e,n){const r=Qde(t,e,n,(i,s,o)=>{let a=!1;return mfe(()=>eI(i,s),(l,c)=>{i.__accessor__.lifecycle!==Xl.DESTROYED?a||(a=!0,fG(c,l)||o.call(i,l,c,s,i),a=!1):r.remove()})});return r}function C$e(t,e,n,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Xl.DESTROYED?r?P$e(t,e,n):R$e(t,e,n):qn()}function M$e(t,e,n){let r,i,s=gfe(t,(o,a)=>{r&&r.uid!==i?s.remove():(r||(r=MG.acquireTracked(o,e,a,n),i=r.uid),m4(r))});return qn(()=>{s.remove(),r&&(r.uid!==i||r.removed||(r.removed=!0,m4(r)),r=null),s=null})}function N$e(t,e,n){let r=!1;return mfe(t,(i,s)=>{r||(r=!0,n(s,i)||e(i,s),r=!1)})}function O$e(t,e,n=!1,r=ude){return n?N$e(t,e,r):M$e(t,e,r)}function EQ(t){return pfe(Kf,e=>e.oldValue===t)}const Ky=()=>Tt.getLogger("esri.core.accessorSupport.ensureTypes");function L$e(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(Ky().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function D$e(t){return t==null?t:!!t}function $$e(t){return t==null?t:t.toString()}function Zl(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function NG(t){return t==null?t:Math.round(parseFloat(t))}function j$e(t){return null}function F$e(t,e){return n=>{let r=t(n);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function xfe(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function g4(t,e){return e!=null&&t&&!(e instanceof t)}function wfe(t){return t&&"isCollection"in t}function SQ(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function V$e(t,e){if(!e?.constructor||!wfe(e.constructor))return bF(t,e)?e:new t(e);const n=SQ(t.prototype.itemType),r=SQ(e.constructor.prototype.itemType);return n?r?n===r?e:n.prototype.isPrototypeOf(r.prototype)?new t(e):(bF(t,e),e):new t(e):e}function bF(t,e){return!!xfe(e)&&(Ky().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+rO(t)+"'"),!0)}function nO(t,e){return e==null?e:wfe(t)?V$e(t,e):g4(t,e)?bF(t,e)?e:new t(e):e}function rO(t){return t?.prototype?.declaredClass||"unknown"}const z$e=new WeakMap;function U$e(t){switch(t){case Number:return e=>Zl(e);case Or:return NG;case Boolean:return D$e;case String:return $$e;case Date:return L$e;case OG:return j$e;default:return ZA(z$e,t,()=>nO.bind(null,t))}}function Va(t,e){const n=U$e(t);return arguments.length===1?n:n(e)}function wk(t,e,n){return arguments.length===1?wk.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,n)):[t(e,n)])}function G$e(t,e){return arguments.length===1?wk(n=>Va(t,n)):wk(n=>Va(t,n),e)}function bfe(t,e,n){return e!==0&&Array.isArray(n)?n.map(r=>bfe(t,e-1,r)):t(n)}function y4(t,e,n){if(arguments.length===2)return s=>y4(t,e,s);if(!n)return n;n=bfe(t,e,n);let r=e,i=n;for(;r>0&&Array.isArray(i);)r--,i=i[0];if(i!==void 0)for(let s=0;s<r;s++)n=[n];return n}function B$e(t,e,n){return arguments.length===2?y4(r=>Va(t,r),e):y4(r=>Va(t,r),e,n)}function Efe(t){return!!Array.isArray(t)&&!t.some(e=>{const n=typeof e;return!(n==="string"||n==="number"||n==="function"&&t.length>1)})}function EF(t,e){if(arguments.length===2)return EF(t).call(null,e);const n=new Set,r=t.filter(a=>typeof a!="function"),i=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||n.add(a);let s=null,o=null;return(a,l)=>{if(a==null)return a;const c=typeof a,u=c==="string"||c==="number";return u&&(n.has(a)||i.some(h=>c==="string"&&h===String||c==="number"&&h===Number))||c==="object"&&i.some(h=>!g4(h,a))?a:(u&&r.length?(s||(s=r.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),Ky().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&i.length?(o||(o=i.map(h=>rO(h)).join(", ")),Ky().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Ky().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function Mg(t,e){if(arguments.length===2)return Mg(t).call(null,e);const n={},r=[],i=[];for(const l in t.typeMap){const c=t.typeMap[l];n[l]=Va(c),r.push(rO(c)),i.push(l)}const s=()=>`'${r.join("', '")}'`,o=()=>`'${i.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!g4(t.base,l)||l==null)return l;const c=a(l)||t.defaultKeyValue,u=n[c];if(!u)return Ky().error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!g4(t.typeMap[c],l))return l;if(typeof t.key=="string"&&!xfe(l)){const h={};for(const f in l)f!==t.key&&(h[f]=l[f]);return u(h)}return u(l)}}let Or=class{},OG=class{};const NAt={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function W$e(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function Sfe(t){switch(t.type){case"native":return Va(t.value);case"array":return wk(Sfe(t.value));case"one-of":return H$e(t);default:return null}}function H$e(t){let e=null;return(n,r)=>TF(n,t)?n:(e==null&&(e=SF(t)),Ky().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function SF(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Or:return"integer";case Date:return"date";case OG:return"null";default:return rO(t.value)}case"array":return`array of ${SF(t.value)}`;case"one-of":{const e=t.values.map(n=>SF(n));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function TF(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Or:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case OG:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(n=>!TF(n,e.value));case"one-of":return e.values.some(n=>TF(t,n))}}function E(t={}){return(e,n)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${n}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,n),i=tI(e,n);r&&(r.get||r.set?(i.get=r.get||i.get,i.set=r.set||i.set):"value"in r&&("value"in t&&Tt.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${n}" on "${e.constructor.name}" already defined in the metadata`,t),i.value=t.value=r.value)),t.readOnly!=null&&(i.readOnly=t.readOnly);const s=t.aliasOf;if(s){const l=typeof s=="string"?s:s.source,c=typeof s=="string"?null:s.overridable===!0;let u;i.dependsOn=[l],i.get=function(){let h=ad(this,l);if(typeof h=="function"){u||(u=l.split(".").slice(0,-1).join("."));const f=ad(this,u);f&&(h=h.bind(f))}return h},i.readOnly||(i.set=c?function(h){this._override(n,h)}:function(h){c4(this,l,h)})}const o=t.type,a=t.types;if(!i.cast){let l;o?l=q$e(o):a&&(l=Array.isArray(a)?wk(Mg(a[0])):Mg(a)),t.cast=K$e(t.cast,l)}F6e(i,t),t.range&&(i.cast=F$e(i.cast,t.range))}}function LG(t,e,n){const r=tI(t,n);r.json||(r.json={});let i=r.json;return e!==void 0&&(i.origins||(i.origins={}),i.origins[e]||(i.origins[e]={}),i=i.origins[e]),i}function q$e(t){let e=0,n=t;if(W$e(t))return Sfe(t);for(;Array.isArray(n)&&n.length===1&&typeof n[0]!="string"&&typeof n[0]!="number";)n=n[0],e++;const r=n;if(Efe(r))return e===0?EF(r):y4(EF(r),e);if(e===1)return G$e(r);if(e>1)return B$e(r,e);const i=t;return i.from?i.from:Va(i)}function K$e(t,e){if(t||e)return t?e?(n,r)=>e(t(n,r),r):t:e}function Y$e(t){if(t.json&&t.json.origins){const e=t.json.origins,n={"web-document":["web-scene","web-map"]};for(const r in n)if(e[r]){const i=e[r];n[r].forEach(s=>{e[s]=i}),delete e[r]}}}let kd=class extends mde{constructor(e,n,r){super(e,n,r)}};kd.prototype.type="warning";function Tfe(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function X$e(t,e){return DG(t,"any",e?.origin)}function v4(t,e){return DG(t,"read",e?.origin)}function kfe(t,e){return DG(t,"write",e?.origin)}function DG(t,e,n){let r=t?.json;if(r?.origins&&n){let i;i=n==="link-chart"?r.origins[n]&&(e==="any"||e in r.origins[n])?r.origins[n]:r.origins["web-map"]:r.origins[n],i&&(e==="any"||e in i)&&(r=i)}return r}const kF=()=>Tt.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function TQ(t,e,n){t&&(!n&&!e.read||e.read?.reader||e.read?.enabled===!1||Q$e(t)&&z2("read.reader",$G(t),e))}function $G(t){const e=t.ndimArray??0;if(e>1)return J$e(t);if(e===1)return kQ(t);if("type"in t&&Ife(t.type)){const n=t.type.prototype?.itemType?.Type,r=kQ(typeof n=="function"?{type:n}:{types:n});return(i,s,o)=>{const a=r(i,s,o);return a&&new t.type(a)}}return jG(t)}function jG(t){return"type"in t?Z$e(t.type):e8e(t.types)}function Z$e(t){return t.prototype.read?(e,n,r)=>{if(e==null)return e;const i=typeof e;if(i!=="object")return void kF().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${i}'`);const s=new t;return s.read(e,r),s}:t.fromJSON}function Afe(t,e,n,r){return r!==0&&Array.isArray(e)?e.map(i=>Afe(t,i,n,r-1)):t(e,void 0,n)}function J$e(t){const e=jG(t),n=Afe.bind(null,e),r=t.ndimArray??0;return(i,s,o)=>{if(i==null)return i;i=n(i,o,r);let a=r,l=i;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let c=0;c<a;c++)i=[i];return i}}function kQ(t){const e=jG(t);return(n,r,i)=>{if(n==null)return n;if(Array.isArray(n)){const o=[];for(const a of n){const l=e(a,void 0,i);l!==void 0&&o.push(l)}return o}const s=e(n,void 0,i);return s!==void 0?[s]:void 0}}function Ife(t){if(!Tfe(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?FG(e.Type):Rfe(e.Type))}function Q$e(t){return"types"in t?Rfe(t.types):FG(t.type)}function FG(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||Ife(t))}function Rfe(t){for(const e in t.typeMap)if(!FG(t.typeMap[e]))return!1;return!0}function e8e(t){let e=null;const n=t.errorContext??"type",r=t.validate;return(i,s,o)=>{if(i==null)return i;const a=typeof i;if(a!=="object")return void kF().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=n8e(t));const l=t.key;if(typeof l!="string")return;const c=i[t8e(l,e,o)],u=c?e[c]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!u){const f=`Type '${c||"unknown"}' is not supported`;return o?.messages&&i&&o.messages.push(new kd(`${n}:unsupported`,f,{definition:i,context:o})),void kF().error(f)}const h=new u;return h.read(i,o),r?r(h):h}}function t8e(t,e,n){const r=Object.values(e)[0],i=K2(r.prototype)[t],s=v4(i,n),o=s?.read?.source;return o&&typeof o=="string"?o:t}function n8e(t){const e={};for(const n in t.typeMap){const r=t.typeMap[n],i=K2(r.prototype);if(typeof t.key=="function")continue;const s=i[t.key];if(!s)continue;if(s.json?.type&&Array.isArray(s.json.type)&&s.json.type.length===1&&typeof s.json.type[0]=="string"){e[s.json.type[0]]=r;continue}const o=s.json?.write;if(!o?.writer){e[n]=r;continue}const a=o.target,l=typeof a=="string"?a:t.key,c={};o.writer(n,c,l),c[l]&&(e[c[l]]=r)}return e}function r8e(t){if(t.json||(t.json={}),IQ(t.json),RQ(t.json),AQ(t.json),t.json.origins)for(const e in t.json.origins)IQ(t.json.origins[e]),RQ(t.json.origins[e]),AQ(t.json.origins[e]);return!0}function AQ(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function IQ(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function RQ(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function PQ(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const n=t?.ndimArray??0;t&&(n===1||"type"in t&&Tfe(t.type))?e.write.writer=o8e:n>1?e.write.writer=a8e(n):e.types?Array.isArray(e.types)?e.write.writer=s8e(e.types[0]):e.write.writer=i8e(e.types):e.write.writer=bk}function i8e(t){return(e,n,r,i)=>e?Pfe(e,t,i)?bk(e,n,r,i):void 0:bk(e,n,r,i)}function Pfe(t,e,n){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(n?.messages){const r=e.errorContext??"type",i=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;n&&n.messages&&t&&n.messages.push(new Xe(`${r}:unsupported`,i,{definition:t,context:n})),Tt.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(i)}return!1}function s8e(t){return(e,n,r,i)=>!e||!Array.isArray(e)?bk(e,n,r,i):bk(e.filter(s=>Pfe(s,t,i)),n,r,i)}function bk(t,e,n,r){z2(n,_4(t,r),e)}function _4(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?x4(t):t}function x4(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function o8e(t,e,n,r){let i;t===null?i=null:t&&typeof t.map=="function"?(i=t.map(s=>_4(s,r)),typeof i.toArray=="function"&&(i=i.toArray())):i=[_4(t,r)],z2(n,i,e)}function Cfe(t,e,n){return n!==0&&Array.isArray(t)?t.map(r=>Cfe(r,e,n-1)):_4(t,e)}function a8e(t){return(e,n,r,i)=>{let s;if(e===null)s=null;else{s=Cfe(e,i,t);let o=t,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)s=[s]}z2(r,s,n)}}function l8e(t){const e=c8e(t);if(t.json.origins)for(const n in t.json.origins){const r=t.json.origins[n],i=r.types?u8e(r):e;TQ(i,r,!1),r.types&&!r.write&&t.json.write?.enabled&&(r.write={...t.json.write}),PQ(i,r)}TQ(e,t.json,!0),PQ(e,t.json)}function c8e(t){return t.json.types?AF(t.json):t.type?Mfe(t):AF(t)}function u8e(t){return t.type?Mfe(t):AF(t)}function Mfe(t){if(!t.type)return;let e=0,n=t.type;for(;Array.isArray(n)&&!Efe(n);)n=n[0],e++;return{type:n,ndimArray:e}}function AF(t){if(!t.types)return;let e=0,n=t.types;for(;Array.isArray(n);)n=n[0],e++;return{types:n,ndimArray:e}}function h8e(t){r8e(t)&&(Y$e(t),l8e(t))}const q6=new Set,K6=new Set;function ue(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,f8e(e);const n=[],r=[];let i=e.prototype;for(;i;)i.hasOwnProperty("initialize")&&!q6.has(i.initialize)&&(q6.add(i.initialize),n.push(i.initialize)),i.hasOwnProperty("destroy")&&!K6.has(i.destroy)&&(K6.add(i.destroy),r.push(i.destroy)),i=Object.getPrototypeOf(i);q6.clear(),K6.clear();const s=class extends e{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(n.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=n.length-1;l>=0;l--)n[l].call(this)}}),r.length){let l=!1;const c=this[Zde];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){this.__accessor__.lifecycle=Xl.DESTROYING,l=!0,c.call(this);for(let u=0;u<r.length;u++)r[u].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};s.__accessorMetadata__=K2(e.prototype),s.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(s,"name",{value:o,configurable:!0}),s}}function d8e(t,e){return e.get==null?function(){const n=this.__accessor__,r=n.propertiesByName.get(t);if(r===void 0)return;n.mutable&&tn(r);const i=n.store;return i.has(t)?i.get(t):r.metadata.value}:function(){const n=this.__accessor__,r=n.propertiesByName.get(t);if(r!==void 0)return r.getComputed(n)}}function f8e(t){const e=t.prototype,n=K2(e),r={};for(const i of Object.getOwnPropertyNames(n)){const s=n[i];h8e(s),r[i]={enumerable:!0,configurable:!0,get:d8e(i,s),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&s.readOnly?CQ("read-only",i):a.lifecycle===Xl.CONSTRUCTED&&s.constructOnly?CQ("construct-only",i):void a.set(i,o)}else Object.defineProperty(this,i,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,r)}const CQ=(t,e)=>{Tt.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var MQ,NQ;function p8e(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const tm=Symbol("Accessor-Handles"),Y6=Symbol("Accessor-Initialized");var wg;let Kt=(wg=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:n,declaredClass:r,constructor:i}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...l){super(...l),this.inherited=null,i&&i.apply(this,l)}}K2(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...c){const u=this.inherited;let h;this.inherited=function(...f){if(s.prototype[a])return s.prototype[a].apply(this,f)};try{h=l.apply(this,c)}catch(f){throw this.inherited=u,f}return this.inherited=u,h}:e[a]}for(const a in n){const l=p8e(n[a]);E(l)(o.prototype,a)}return ue(r)(o)}static freeze(e){return e instanceof wg?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof wg?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[MQ]=null,this[NQ]=!1,this.constructor===wg)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const n=new K6e(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:n}),e.length>0&&(n.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,n=e.ctorArgs;e.initialize(),n&&(this.set(n),e.ctorArgs=null),e.constructed(),this.initialize(),this[Y6]=!0}initialize(){}[Zde](){this[tm]=Mi(this[tm])}destroy(){this.destroyed||(T$e(this),this.__accessor__.destroy(),e$e()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[Y6]}get destroyed(){return this.__accessor__?.lifecycle===Xl.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===Xl.DESTROYING||!1}commitProperty(e){ad(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,n){return c4(this,e,n),this}watch(e,n,r){return Xde(Tt.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),C$e(this,e,n,r)}addHandles(e,n){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const i of r)i.remove();return}(this[tm]??=new q2).add(e,n)}removeHandles(e){this[tm]?.remove(e)}removeAllHandles(){this[tm]?.removeAll()}removeHandlesReference(e){this[tm]?.removeReference(e)}hasHandles(e){return this[tm]?.has(e)===!0}_override(e,n){n===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,n)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,n){n==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,n)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,n){return this.__accessor__.internalSet(e,n),this}},MQ=tm,NQ=Y6,wg);const iO=t=>{const e=t;class n extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(i,s){let o=this._listenersMap?.get(i);if(!o)return!1;let a=!1;for(const l of o.slice()){const c="deref"in l?l.deref():l;c?c?.call(this,s):a=!0}return a&&(o=o.filter(l=>!("deref"in l)||l.deref()!=null),this._listenersMap.set(i,o)),o.length>0}on(i,s){if(Array.isArray(i)){const a=i.map(l=>this.on(l,s));return rv(a)}if(i.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(i)||[];return o.push(s),this._listenersMap.set(i,o),qn(()=>{const a=this._listenersMap?.get(i),l=a?.indexOf(s)??-1;l>=0&&a.splice(l,1)})}once(i,s){const o=this.on(i,a=>{o.remove(),("deref"in s?s.deref():s)?.call(null,a)});return o}hasEventListener(i){const s=this._listenersMap?.get(i);return s!=null&&s.length>0}}return n},Nfe=iO(class{}),m8e=Nfe,nI=iO(Kt);function Ofe(t){return(e,n)=>{e[n]=t}}let rI=class extends nfe{notify(){const e=this._observers;if(e&&e.length>0){const n=e.slice();for(const r of n)r.onInvalidated(),r.onCommitted()}}};var uf;let g8e=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},y8e=class{constructor(e,n,r,i,s){this.target=e,this.added=n,this.removed=r,this.start=i,this.deleteCount=s}};const Sc=new H2(()=>new g8e,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function OQ(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function X6(t){return t?t instanceof Im?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Z6(t){if(t?.length)return t[0]}function v8e(t,e,n,r){const i=Math.min(t.length-n,e.length-r);let s=0;for(;s<i&&t[n+s]===e[r+s];)s++;return s}function Lfe(t,e,n,r){e&&e.forEach((i,s,o)=>{t.push(i),Lfe(t,n.call(r,i,s,o),n,r)})}const nm=new Set,rm=new Set,im=new Set,J6=new Map;let _8e=0,Im=uf=class extends nI{static ofType(t){if(!t)return uf;if(J6.has(t))return J6.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const i=t.typeMap[r].prototype.declaredClass;e?e+=` | ${i}`:e=i}let n=class extends uf{};return _([Ofe({Type:t,ensureType:typeof t=="function"?Va(t):Mg(t)})],n.prototype,"itemType",void 0),n=_([ue(`esri.core.Collection<${e}>`)],n),J6.set(t,n),n}static isCollection(t){return t!=null&&t instanceof uf}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new rI,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:_8e++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof uf?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return tn(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,X6(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return qn();if(t==="change"){const n=this._chgListeners,r={removed:!1,callback:e};return n.push(r),this._notifications&&this._notifications.push({listeners:n.slice(),items:this._items.slice(),changes:[]}),qn(()=>{r.removed=!0,n.splice(n.indexOf(r),1)})}return super.on(t,e)}once(t,e){const n="deref"in e?()=>e.deref():()=>e,r=this.on(t,i=>{n()?.call(null,i),r.remove()});return r}add(t,e){if(tn(this._observable),this._emitBeforeChanges(1))return this;const n=this.getNextIndex(e??null);return this._splice(n,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(tn(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const n=this.getNextIndex(e);return this._splice(n,0,X6(t)),this._emitAfterChanges(1),this}at(t){if(tn(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return tn(this._observable),this._createNewInstance({items:this._items.map(Ze)})}concat(...t){tn(this._observable);const e=t.map(X6);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return;const n=this._splice(0,this.length),r=n.length;for(let i=0;i<r;i++)t.call(e,n[i],i,n);this._emitAfterChanges(2)}destroyAll(){this.drain(OQ)}destroyMany(t){const e=this.removeMany(t);return e.forEach(OQ),e}every(t,e){return tn(this._observable),this._items.every(t,e)}filter(t,e){tn(this._observable);const n=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:n})}find(t,e){return tn(this._observable),this._items.find(t,e)}findIndex(t,e){return tn(this._observable),this._items.findIndex(t,e)}flatten(t,e){tn(this._observable);const n=[];return Lfe(n,this,t,e),new uf(n)}forEach(t,e){return tn(this._observable),this._items.forEach(t,e)}getItemAt(t){return tn(this._observable),this._items[t]}getNextIndex(t){tn(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return tn(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return tn(this._observable),this._items.indexOf(t,e)}join(t=","){return tn(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return tn(this._observable),this._items.lastIndexOf(t,e)}map(t,e){tn(this._observable);const n=this._items.map(t,e);return new uf({items:n})}reorder(t,e=this.length-1){tn(this._observable);const n=this.indexOf(t);if(n!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),n!==e){if(this._emitBeforeChanges(4))return t;this._splice(n,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Z6(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return tn(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){tn(this._observable);const n=this._items;return arguments.length===2?n.reduce(t,e):n.reduce(t)}reduceRight(t,e){tn(this._observable);const n=this._items;return arguments.length===2?n.reduceRight(t,e):n.reduceRight(t)}remove(t){return tn(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(tn(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Z6(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(tn(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof uf?t.toArray():t,n=this._items,r=[],i=e.length;for(let s=0;s<i;s++){const o=e[s],a=n.indexOf(o);if(a>-1){const l=1+v8e(e,n,s+1,a+1),c=this._splice(a,l);c&&c.length>0&&r.push.apply(r,c),s+=l-1}}return this._emitAfterChanges(2),r}reverse(){if(tn(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Z6(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return tn(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return tn(this._observable),this._items.some(t,e)}sort(t){if(tn(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,n)=>e===n?0:e<n?-1:1){const e=this.length-1;for(let n=0;n<e;n++)if(t(this.items[n],this.items[n+1])>0)return!0;return!1}splice(t,e,...n){tn(this._observable),arguments.length===1&&(e=this.length),e??=0;const r=(e?2:0)|(n.length?1:0);if(this._emitBeforeChanges(r))return[];const i=this._splice(t,e,n)||[];return this._emitAfterChanges(r),i}toArray(){return tn(this._observable),this._items.slice()}toJSON(t){return tn(this._observable),this.toArray().map(e=>Q3(e)?e.toJSON(t):e)}toLocaleString(){return tn(this._observable),this._items.toLocaleString()}toString(){return tn(this._observable),this._items.toString()}unshift(...t){return tn(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,n){const r=this._items,i=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Y2(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=r.splice(t,e),this.hasEventListener("before-remove")){const a=Sc.acquire();a.target=this,a.cancellable=!0;for(let l=0,c=o.length;l<c;l++)s=o[l],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),r.splice(t,0,s),t+=1,l-=1,c-=1);Sc.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Sc.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let c=0;c<l;c++)a.reset(o[c]),this.emit("after-remove",a);Sc.release(a)}}if(n?.length){if(i){const u=[];for(const h of n){const f=i.ensureType(h);f==null&&h!=null||u.push(f)}n=u}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),c=t===this.length;if(a||l){const u=Sc.acquire();u.target=this,u.cancellable=!0;const h=Sc.acquire();h.target=this,h.cancellable=!1;for(const f of n)a?(u.reset(f),this.emit("before-add",u),u.defaultPrevented||(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),l&&(h.reset(f),this.emit("after-add",h)))):(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),h.reset(f),this.emit("after-add",h));Sc.release(h),Sc.release(u)}else{if(c)for(const u of n)r.push(u);else r.splice(t,0,...n);this._set("length",r.length)}}if((n?.length||o?.length)&&this._notifyChangeEvent(n,o),this.hasEventListener("after-splice")){const a=new y8e(this,n,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const n=Sc.acquire();n.target=this,n.cancellable=!0,n.type=t,this.emit("before-changes",n),e=n.defaultPrevented,Sc.release(n)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Sc.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Sc.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const n=e.changes;nm.clear(),rm.clear(),im.clear();for(const{added:l,removed:c}of n){if(l)if(im.size===0&&rm.size===0)for(const u of l)nm.add(u);else for(const u of l)rm.has(u)?(im.add(u),rm.delete(u)):im.has(u)||nm.add(u);if(c)if(im.size===0&&nm.size===0)for(const u of c)rm.add(u);else for(const u of c)nm.has(u)?nm.delete(u):(im.delete(u),rm.add(u))}const r=Aa.acquire();nm.forEach(l=>{r.push(l)});const i=Aa.acquire();rm.forEach(l=>{i.push(l)});const s=this._items,o=e.items,a=Aa.acquire();if(im.forEach(l=>{o.indexOf(l)!==s.indexOf(l)&&a.push(l)}),e.listeners&&(r.length||i.length||a.length)){const l={target:this,added:r,removed:i,moved:a},c=e.listeners.length;for(let u=0;u<c;u++){const h=e.listeners[u];h.removed||h.callback.call(this,l)}}Aa.release(r),Aa.release(i),Aa.release(a)}nm.clear(),rm.clear(),im.clear()}};_([E()],Im.prototype,"_updating",void 0),_([E()],Im.prototype,"length",void 0),_([E()],Im.prototype,"items",null),_([E({readOnly:!0})],Im.prototype,"updating",null),Im=uf=_([ue("esri.core.Collection")],Im);const Ot=Im;function pd(t,e,n=Ot){return e||(e=new n),e===t||e.destroyed||(e.removeAll(),x8e(t)?e.addMany(t):t&&e.add(t)),e}function Dfe(t){return t}function x8e(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let w8e=class $fe{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const n=new $fe;return this._values.forEach((r,i)=>{e&&e.has(i)||n.set(i,Ze(r.value),r.origin)}),n}get(e,n){n=this._normalizeOrigin(n);const r=this._values.get(e);return n==null||r?.origin===n?r?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const n=[...this._values.keys()];return e==null?n:n.filter(r=>this._values.get(r)?.origin===e)}set(e,n,r){if((r=this._normalizeOrigin(r))===0){const i=this._values.get(e);if(i?.origin!=null&&i.origin>r)return}this._values.set(e,new b8e(n,r))}delete(e,n){(n=this._normalizeOrigin(n))!=null&&this._values.get(e)?.origin!==n||this._values.delete(e)}has(e,n){return(n=this._normalizeOrigin(n))!=null?this._values.get(e)?.origin===n:this._values.has(e)}isAtOrigin(e,n){return n=this._normalizeOrigin(n),this.has(e,n)&&this.originOf(e)===n}isBelowOrigin(e,n){return n=this._normalizeOrigin(n),!this.has(e)||this.originOf(e)<n}forEach(e){this._values.forEach(({value:n},r)=>e(n,r))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},b8e=class{constructor(e,n){this.value=e,this.origin=n}};function E8e(t,e,n){e.keys().forEach(i=>{n.set(i,e.get(i),0)});const r=t.metadata;Object.keys(r).forEach(i=>{t.internalGet(i)&&n.set(i,t.internalGet(i),0)})}function S8e(t,e,n){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.startsWith(e)&&gQ(r,n))return!0}else for(const i of r)if(i===e||i.includes(".")&&i.startsWith(e)&&gQ(i,n))return!0;return!1}function T8e(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function k8e(t,e,n,r,i){let s=v4(e[n],i);T8e(s)&&(t[n]=!0);for(const o of Object.getOwnPropertyNames(e))s=v4(e[o],i),S8e(s,n,r)&&(t[o]=!0)}function A8e(t,e,n,r){const i=n.metadata,s=X$e(i[e],r),o=s?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,r):o;a!==void 0&&n.set(e,a)}const jfe={origin:"service"};function I8e(t,e,n=jfe){if(!e||typeof e!="object")return;const r=Cg(t),i=r.metadata,s={};for(const o of Object.getOwnPropertyNames(e))k8e(s,i,o,e,n);r.setDefaultOrigin(n.origin);for(const o of Object.getOwnPropertyNames(s)){const a=v4(i[o],n).read,l=a?.source;let c;c=l&&typeof l=="string"?eI(e,l):e[o],a?.reader&&(c=a.reader.call(t,c,e,n)),c!==void 0&&r.set(o,c)}if(!n||!n.ignoreDefaults){r.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(i))s[o]||A8e(t,o,r,n)}r.setDefaultOrigin("user")}function FAt(t,e,n,r=jfe){const i={...r,messages:[]};n(i),i.messages?.forEach(s=>{s.type!=="warning"||t.loaded?r?.messages&&r.messages.push(s):t.loadWarnings.push(s)})}function R8e(t,e,n,r,i){const s={};return e.write?.writer?.call(t,r,s,n,i),s}function Ffe(t,e,n,r,i,s){if(!r?.write)return!1;const o=ad(t,n);if(!i&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,o,n,s??void 0);a!==void 0&&(i=a)}if(i||(i=r.write),!i||i.enabled===!1||i.layerContainerTypes&&s?.layerContainerType&&!i.layerContainerTypes.includes(s.layerContainerType))return!1;if((o===null&&!i.allowNull&&!i.writerEnsuresNonNull||o===void 0)&&i.isRequired){const a=new Xe("web-document-write:property-required",`Missing value for required property '${n}' on '${t.declaredClass}'`,{propertyName:n,target:t});return a&&s?.messages?s.messages.push(a):a&&!s&&Tt.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!i.allowNull&&!i.writerEnsuresNonNull||!i.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(n)===0)&&P8e(t,n,s,r,o)||!i.ignoreOrigin&&s?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(n)<RG(s.origin))}function P8e(t,e,n,r,i){const s=r.default;if(s===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(i);if(typeof s=="function"){if(Array.isArray(i)){const o=s.call(t,e,n??void 0);return W5(o,i)}return!1}return s===i}function VAt(t,e,n,r){const i=Cg(t),s=i.metadata,o=kfe(s[e],r);return!!o&&Ffe(t,i,e,o,n,r)}function C8e(t,e,n){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return VC(e,t.toJSON(n));const r=Cg(t),i=r.metadata;for(const s in i){const o=kfe(i[s],n);if(!Ffe(t,r,s,o,void 0,n))continue;const a=ad(t,s),l=R8e(t,o,o.write&&typeof o.write.target=="string"?o.write.target:s,a,n);Object.keys(l).length>0&&(e=VC(e,l),n?.resources?.pendingOperations?.length&&n.resources.pendingOperations.push(Promise.all(n.resources.pendingOperations).then(()=>VC(e,l,()=>"replace-arrays"))),n?.writtenProperties&&n.writtenProperties.push({target:t,propName:s,oldOrigin:H6e(r.store.originOf(s)),newOrigin:n.origin}))}return e}const Xg=t=>{const e=t;let n=class extends e{constructor(...r){super(...r);const i=Cg(this),s=i.store,o=new w8e;i.store=o,E8e(i,s,o)}read(r,i){I8e(this,r,i)}write(r,i){return C8e(this,r??{},i)}toJSON(r){return this.write({},r)}static fromJSON(r,i){return M8e.call(this,r,i)}};return n=_([ue("esri.core.JSONSupport")],n),n.prototype.toJSON.isDefaultToJSON=!0,n};function M8e(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const n=new this;return n.read(t,e),n}const qt=Xg(Kt);let N8e=class{constructor(){this._resolver=uc(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(Tr())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=uc(),n=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(n);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},i=>{this.isFulfilled()||this._allPromise!==r||ya(i)||this._resolver.reject(i)}),e.resolve()}};const Vfe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._promiseProps=new N8e,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,i){return this._promiseProps.promise.then(()=>this).then(r,i)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}addResolvingTask(r){r&&!this._promiseProps.isFulfilled()&&(this.addHandles(KDe(r)),this._promiseProps.addResolvingPromise(r.promise))}};return n=_([ue("esri.core.Promise")],n),n},VG=Vfe(Kt),O8e="not-loaded",L8e="loading",D8e="failed",LQ="loaded",$8e=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(i=>{const s=this.load.bind(this);this.load=o=>{const a=new Promise((l,c)=>{const u=EG(o,c);this.destroyed&&c(new Xe("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(l,c).finally(()=>{u&&u.remove()})});if(this.loadStatus===O8e){this._set("loadStatus",L8e);const l=this._loadController=new AbortController;s({signal:l.signal})}return i(),a}})),this.when(()=>{this._set("loadStatus",LQ),this._loadController=null},i=>{this.destroyed||(this._set("loadStatus",D8e),this._set("loadError",i),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=R1(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===LQ}get loadWarnings(){return this._get("loadWarnings")}load(r){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Xe("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return _([E({readOnly:!0})],n.prototype,"loaded",null),_([E({readOnly:!0})],n.prototype,"loadError",void 0),_([E({clonable:!1})],n.prototype,"loadStatus",void 0),_([E({type:[kd],readOnly:!0})],n.prototype,"loadWarnings",null),n=_([ue("esri.core.Loadable")],n),n},iI=$8e(VG);function IF(t){return!(!t||!t.load)}function UAt(t,e,n){return SG(t.map((r,i)=>e.apply(n,[r,i])))}async function j8e(t,e,n){return(await SG(t.map((r,i)=>e.apply(n,[r,i])))).map(r=>r.value)}function zG(t){return{ok:!0,value:t}}function UG(t){return{ok:!1,error:t}}function F8e(t){return t!=null&&t.ok===!0?t.value:null}function V8e(t){return t!=null&&t.ok===!1?t.error:null}async function zfe(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return zG(await t)}catch(e){return UG(e)}}async function GAt(t){try{return zG(await t)}catch(e){return Dde(e),UG(e)}}function sO(t,e){return new pm(t,e)}let pm=class extends Kt{get value(){return F8e(this._result)}get error(){return V8e(this._result)}get finished(){return this._result!=null}constructor(e,n){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=R1(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(i=>{this._result=zG(i),this._cleanup()},i=>{this._result=UG(i),this._cleanup()}),this._abortHandle=lu(n,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Qr(this._abortHandle),this._abortController=null}};_([E()],pm.prototype,"value",null),_([E()],pm.prototype,"error",null),_([E()],pm.prototype,"finished",null),_([E()],pm.prototype,"promise",void 0),_([E()],pm.prototype,"_result",void 0),pm=_([ue("esri.core.asyncUtils.ReactiveTask")],pm);async function Ufe(t,e){return await t.load(),z8e(t,e)}async function z8e(t,e){const n=[],r=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?r(...o):Ot.isCollection(o)?o.forEach(a=>r(a)):IF(o)&&n.push(o))};e(r);let i=null;if(await j8e(n,async s=>{const o=await zfe(U8e(s)?s.loadAll():s.load());o.ok!==!1||i||(i=o)}),i)throw i.error;return t}function U8e(t){return"loadAll"in t&&typeof t.loadAll=="function"}function Xn(t,e,n){let r,i;return e===void 0?(i=t,r=[void 0]):typeof e!="string"?(i=t,r=[void 0],n=e):(i=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;for(const l of r){const c=LG(s,l,i);c.write&&typeof c.write=="object"||(c.write={}),n&&(c.write.target=n),c.write.writer=a[o]}}}let Gs=class{constructor(e,n={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=n,this.apiValues=[],this.jsonValues=[],this._apiToJSON=G8e(e),this.apiValues=DQ(this._apiToJSON),this.jsonValues=DQ(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,i,s)=>{const o=this.toJSON(r);o!==void 0&&z2(s,o,i)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const n=this._apiToJSON[e];return this._options.useNumericKeys?+n:n}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function G8e(t){const e={};for(const n in t)e[t[n]]=n;return e}function DQ(t){const e=[];for(const n in t)e.push(n);return e.sort(),e}function kl(){return function(t,e){return new Gs(t,{ignoreUnknown:!0,...e})}}let GG=class{constructor(e,n,r,i,s,o){this.semiMajorAxis=e,this.flattening=n,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=i,this.scaleHeight=s;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const ts=new GG(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),md=new GG(3396190,1/169.8944472236118,23e4,6e4,.111),Ng=new GG(1737400,0,0,0,0);function Gi(t){if(!Qn.assetsPath)throw Tt.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Xe("assets:path-not-set","config.assetsPath is not set");return YA(Qn.assetsPath,t)}let Q6,fe=null;function Gfe(){return!!fe}function B8e(){return!!ye("esri-wasm")}function W8e(){return Q6||(Q6=_e(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>Gi(`esri/geometry/support/${e}`)})).then(t=>{Yfe(t)}),Q6)}const WC={geogToProj(t,e,n){fe.ensureCache.prepare();const r=C1(n),i=n===r,s=fe.ensureFloat64(r),o=fe._pe_geog_to_proj(fe.getPointer(t),e,s);return o&&Og(n,e,s,i),o},projGeog(t,e,n,r){switch(r){case Oi.PE_TRANSFORM_P_TO_G:return WC.projToGeog(t,e,n);case Oi.PE_TRANSFORM_G_TO_P:return WC.geogToProj(t,e,n)}return 0},projToGeog:(t,e,n)=>WC.projToGeogCenter(t,e,n,0),projToGeogCenter(t,e,n,r){fe.ensureCache.prepare();const i=C1(n),s=n===i,o=fe.ensureFloat64(i),a=fe._pe_proj_to_geog_center(fe.getPointer(t),e,o,r);return a&&Og(n,e,o,s),a}};let Oi=class hr{static init(){hr.PE_BUFFER_MAX=fe.PeDefs.prototype.PE_BUFFER_MAX,hr.PE_NAME_MAX=fe.PeDefs.prototype.PE_NAME_MAX,hr.PE_MGRS_MAX=fe.PeDefs.prototype.PE_MGRS_MAX,hr.PE_USNG_MAX=fe.PeDefs.prototype.PE_USNG_MAX,hr.PE_DD_MAX=fe.PeDefs.prototype.PE_DD_MAX,hr.PE_DDM_MAX=fe.PeDefs.prototype.PE_DDM_MAX,hr.PE_DMS_MAX=fe.PeDefs.prototype.PE_DMS_MAX,hr.PE_UTM_MAX=fe.PeDefs.prototype.PE_UTM_MAX,hr.PE_PARM_MAX=fe.PeDefs.prototype.PE_PARM_MAX,hr.PE_TYPE_NONE=fe.PeDefs.prototype.PE_TYPE_NONE,hr.PE_TYPE_GEOGCS=fe.PeDefs.prototype.PE_TYPE_GEOGCS,hr.PE_TYPE_PROJCS=fe.PeDefs.prototype.PE_TYPE_PROJCS,hr.PE_TYPE_GEOGTRAN=fe.PeDefs.prototype.PE_TYPE_GEOGTRAN,hr.PE_TYPE_COORDSYS=fe.PeDefs.prototype.PE_TYPE_COORDSYS,hr.PE_TYPE_UNIT=fe.PeDefs.prototype.PE_TYPE_UNIT,hr.PE_TYPE_LINUNIT=fe.PeDefs.prototype.PE_TYPE_LINUNIT,hr.PE_STR_OPTS_NONE=fe.PeDefs.prototype.PE_STR_OPTS_NONE,hr.PE_STR_AUTH_NONE=fe.PeDefs.prototype.PE_STR_AUTH_NONE,hr.PE_STR_AUTH_TOP=fe.PeDefs.prototype.PE_STR_AUTH_TOP,hr.PE_STR_NAME_CANON=fe.PeDefs.prototype.PE_STR_NAME_CANON,hr.PE_STR_FMT_WKT=fe.PeDefs.prototype.PE_STR_FMT_WKT,hr.PE_STR_FMT_WKT2=fe.PeDefs.prototype.PE_STR_FMT_WKT2,hr.PE_PARM_X0=fe.PeDefs.prototype.PE_PARM_X0,hr.PE_PARM_ND=fe.PeDefs.prototype.PE_PARM_ND,hr.PE_TRANSFORM_1_TO_2=fe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,hr.PE_TRANSFORM_2_TO_1=fe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,hr.PE_TRANSFORM_P_TO_G=fe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,hr.PE_TRANSFORM_G_TO_P=fe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,hr.PE_HORIZON_RECT=fe.PeDefs.prototype.PE_HORIZON_RECT,hr.PE_HORIZON_POLY=fe.PeDefs.prototype.PE_HORIZON_POLY,hr.PE_HORIZON_LINE=fe.PeDefs.prototype.PE_HORIZON_LINE,hr.PE_HORIZON_DELTA=fe.PeDefs.prototype.PE_HORIZON_DELTA}},Bfe=null;const $Q={},jQ={},FQ=t=>{const e=t.getType();switch(e){case Oi.PE_TYPE_GEOGCS:t=fe.castObject(t,fe.PeGeogcs);break;case Oi.PE_TYPE_PROJCS:t=fe.castObject(t,fe.PeProjcs);break;case Oi.PE_TYPE_GEOGTRAN:t=fe.castObject(t,fe.PeGeogtran);break;default:e&Oi.PE_TYPE_UNIT&&(t=fe.castObject(t,fe.PeUnit))}return t},D_={initialize(){fe.PeFactory.prototype.initialize(null)},coordsys:t=>D_.factoryByType(Oi.PE_TYPE_COORDSYS,t),factoryByType(t,e){let n=null,r=$Q[t];if(r||(r={},$Q[t]=r),r.hasOwnProperty(String(e))&&(n=r[e],fe.compare(n,fe.NULL)&&(n=null)),!n){const i=fe.PeFactory.prototype.factoryByType(t,e);fe.compare(i,fe.NULL)||(n=FQ(i),r[e]=n)}return n},fromString(t,e){let n=null,r=jQ[t];if(r||(r={},jQ[t]=r),r.hasOwnProperty(e)&&(n=r[e],fe.compare(n,fe.NULL)&&(n=null)),!n){const i=fe.PeFactory.prototype.fromString(t,e);fe.compare(i,fe.NULL)||(n=FQ(i),r[e]=n)}return n},geogcs:t=>D_.factoryByType(Oi.PE_TYPE_GEOGCS,t),geogtran:t=>D_.factoryByType(Oi.PE_TYPE_GEOGTRAN,t),getCode:t=>fe.PeFactory.prototype.getCode(t),projcs:t=>D_.factoryByType(Oi.PE_TYPE_PROJCS,t),unit:t=>D_.factoryByType(Oi.PE_TYPE_UNIT,t)};let VQ,Wfe=null;const BG={PE_GTLIST_OPTS_COMMON:0,init(){BG.PE_GTLIST_OPTS_COMMON=fe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,VQ=fe._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,n,r,i,s){let o=null;const a=new fe.PeInteger(s);try{const l=fe.PeGTlistExtended.prototype.getGTlist(t,e,n,r,i,a);if((s=a.val)&&(o=[l],s>1)){const c=fe.getPointer(l);for(let u=1;u<s;u++)o.push(fe.wrapPointer(c+VQ*u,fe.PeGTlistExtendedEntry))}}finally{fe.destroy(a)}return o}},H8e={destroy(t){if(t?.length){for(const e of t)ju(e),e.getEntries().forEach(n=>{ju(n);const r=n.getGeogtran();ju(r),r.getParameters().forEach(ju),[r.getGeogcs1(),r.getGeogcs2()].forEach(i=>{ju(i);const s=i.getDatum();ju(s),ju(s.getSpheroid()),ju(i.getPrimem()),ju(i.getUnit())})});fe.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},q8e={geogToGeog(t,e,n,r,i){fe.ensureCache.prepare();const s=C1(n),o=n===s,a=fe.ensureFloat64(s);let l=0;r&&(l=fe.ensureFloat64(r));const c=fe._pe_geog_to_geog(fe.getPointer(t),e,a,l,i);return c&&Og(n,e,a,o),c}},K8e={geodesicCoordinate(t,e,n,r,i,s,o,a){fe.PeLineType.prototype.geodesic_coordinate(t,e,n,r,i,s,o,a)},geodeticCoordinate(t,e,n,r,i,s,o,a,l){fe.PeLineType.prototype.geodetic_coordinate(t,e,n,r,i,s,o,a,l)},geodeticDistance(t,e,n,r,i,s,o,a,l,c){fe.PeLineType.prototype.geodetic_distance(t,e,n,r,i,s,o,a,l,c)},greatEllipticDistance(t,e,n,r,i,s,o,a,l){fe.PeLineType.prototype.great_elliptic_distance(t,e,n,r,i,s,o,a,l)}},Y8e={phiToEta:(t,e)=>fe.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>fe.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>fe.PeMath.prototype.phi_to_phig(t,e),q:(t,e,n)=>fe.PeMath.prototype.q(t,e,n),q90:(t,e)=>fe.PeMath.prototype.q90(t,e)},e$=(t,e,n,r,i,s)=>{let o,a;switch(fe.ensureCache.prepare(),t){case"dd":o=fe._pe_geog_to_dd,a=Oi.PE_DD_MAX;break;case"ddm":o=fe._pe_geog_to_ddm,a=Oi.PE_DDM_MAX;break;case"dms":o=fe._pe_geog_to_dms,a=Oi.PE_DMS_MAX}let l=0;e&&(l=fe.getPointer(e));const c=C1(r),u=fe.ensureFloat64(c),h=oO(n,a),f=o(l,n,u,i,fe.ensureInt32(h));if(f)for(let g=0;g<n;g++)s[g]=fe.UTF8ToString(h[g]);return f},t$=(t,e,n,r,i)=>{let s;switch(fe.ensureCache.prepare(),t){case"dd":s=fe._pe_dd_to_geog;break;case"ddm":s=fe._pe_ddm_to_geog;break;case"dms":s=fe._pe_dms_to_geog}let o=0;e&&(o=fe.getPointer(e));const a=r.map(h=>fe.ensureString(h)),l=fe.ensureInt32(a),c=fe.ensureFloat64(new Array(2*n)),u=s(o,n,l,c);return u&&Og(i,n,c),u},X8e={geogToDms:(t,e,n,r,i)=>e$("dms",t,e,n,r,i),dmsToGeog:(t,e,n,r)=>t$("dms",t,e,n,r),geogToDdm:(t,e,n,r,i)=>e$("ddm",t,e,n,r,i),ddmToGeog:(t,e,n,r)=>t$("ddm",t,e,n,r),geogToDd:(t,e,n,r,i)=>e$("dd",t,e,n,r,i),ddToGeog:(t,e,n,r)=>t$("dd",t,e,n,r)};let Hfe=class $_{static init(){$_.PE_MGRS_STYLE_NEW=fe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,$_.PE_MGRS_STYLE_OLD=fe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,$_.PE_MGRS_STYLE_AUTO=fe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,$_.PE_MGRS_180_ZONE_1_PLUS=fe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,$_.PE_MGRS_ADD_SPACES=fe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,n,r,i,s,o,a){fe.ensureCache.prepare();let l=0;e&&(l=fe.getPointer(e));const c=C1(r),u=fe.ensureFloat64(c),h=oO(n,Oi.PE_MGRS_MAX),f=fe.ensureInt32(h),g=fe._pe_geog_to_mgrs_extended(l,n,u,i,s,o,f);if(g)for(let v=0;v<n;v++)a[v]=fe.UTF8ToString(h[v]);return g}static mgrsToGeogExtended(e,n,r,i,s){fe.ensureCache.prepare();let o=0;e&&(o=fe.getPointer(e));const a=r.map(h=>fe.ensureString(h)),l=fe.ensureInt32(a),c=fe.ensureFloat64(new Array(2*n)),u=fe._pe_mgrs_to_geog_extended(o,n,l,i,c);return u&&Og(s,n,c),u}};const Z8e={geogToUsng(t,e,n,r,i,s,o){fe.ensureCache.prepare();let a=0;t&&(a=fe.getPointer(t));const l=C1(n),c=fe.ensureFloat64(l),u=oO(e,Oi.PE_MGRS_MAX),h=fe.ensureInt32(u),f=fe._pe_geog_to_usng(a,e,c,r,i,s,h);if(f)for(let g=0;g<e;g++)o[g]=fe.UTF8ToString(u[g]);return f},usngToGeog(t,e,n,r){fe.ensureCache.prepare();let i=0;t&&(i=fe.getPointer(t));const s=n.map(c=>fe.ensureString(c)),o=fe.ensureInt32(s),a=fe.ensureFloat64(new Array(2*e)),l=fe._pe_usng_to_geog(i,e,o,a);return l&&Og(r,e,a),l}};let qfe=class HC{static init(){HC.PE_UTM_OPTS_NONE=fe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,HC.PE_UTM_OPTS_ADD_SPACES=fe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,HC.PE_UTM_OPTS_NS=fe.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,n,r,i,s){fe.ensureCache.prepare();let o=0;e&&(o=fe.getPointer(e));const a=C1(r),l=fe.ensureFloat64(a),c=oO(n,Oi.PE_UTM_MAX),u=fe.ensureInt32(c),h=fe._pe_geog_to_utm(o,n,l,i,u);if(h)for(let f=0;f<n;f++)s[f]=fe.UTF8ToString(c[f]);return h}static utmToGeog(e,n,r,i,s){fe.ensureCache.prepare();let o=0;e&&(o=fe.getPointer(e));const a=r.map(h=>fe.ensureString(h)),l=fe.ensureInt32(a),c=fe.ensureFloat64(new Array(2*n)),u=fe._pe_utm_to_geog(o,n,l,i,c);return u&&Og(s,n,c),u}};var ol;let Kfe=(ol=class{static init(){ol.PE_PCSINFO_OPTION_NONE=fe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,ol.PE_PCSINFO_OPTION_DOMAIN=fe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,ol.PE_POLE_OUTSIDE_BOUNDARY=fe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,ol.PE_POLE_POINT=fe.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,n=ol.PE_PCSINFO_OPTION_DOMAIN){let r=null,i=null;return ol.cache.has(e)&&(i=ol.cache.get(e),i[n]&&(r=i[n])),r||(r=fe.PePCSInfo.prototype.generate(e,n),i||(i=[],ol.cache.set(e,i)),i[n]=r),r}},ol.cache=new Map,ol);const J8e={versionString:()=>fe.PeVersion.prototype.version_string()};function Yfe(t){function e(s,o,a){s[o]=a(s[o])}fe=t,Oi.init(),BG.init(),Hfe.init(),qfe.init(),Kfe.init(),Bfe=class extends fe.PeDouble{constructor(s=NaN){super(s)}destroy(){fe.destroy(this)}[Symbol.dispose](){this.destroy()}},Wfe=class extends fe.PeGCSExtent{destroy(){fe.destroy(this)}[Symbol.dispose](){this.destroy()}};const n=[fe.PeAngunit,fe.PeDatum,fe.PeGeogcs,fe.PeGeogtran,fe.PeObject,fe.PeParameter,fe.PePrimem,fe.PeProjcs,fe.PeSpheroid,fe.PeUnit];for(const s of n)e(s.prototype,"getName",o=>function(){return o.call(this,new Array(Oi.PE_NAME_MAX))});for(const s of[fe.PeGeogtran,fe.PeProjcs])e(s.prototype,"getParameters",o=>function(){const a=new Array(Oi.PE_PARM_MAX);let l=o.call(this);for(let c=0;c<a.length;c++){const u=fe.getValue(l,"*");a[c]=u?fe.wrapPointer(u,fe.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(fe.PeHorizon.prototype,"getCoord",s=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return Og(l,a,s.call(this),o),l}),e(fe.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=fe._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=s.call(this);if(!fe.compare(l,fe.NULL)){a=[l];const c=this.getSteps();if(c>1){const u=fe.getPointer(l);for(let h=1;h<c;h++)a.push(fe.wrapPointer(u+o*h,fe.PeGTlistExtendedGTs))}}return a}});const r=fe._pe_getPeHorizonSize(),i=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const l=s.call(this);if(!fe.compare(l,fe.NULL)){a=[l];const c=l.getNump();if(c>1){const u=fe.getPointer(l);for(let h=1;h<c;h++)a.push(fe.wrapPointer(u+r*h,fe.PeHorizon))}}return o.set(s,a),a};e(fe.PeProjcs.prototype,"horizonGcsGenerate",i),e(fe.PeProjcs.prototype,"horizonPcsGenerate",i),fe.PeObject.prototype.toString=function(s=Oi.PE_STR_OPTS_NONE){fe.ensureCache.prepare();const o=fe.getPointer(this),a=fe.ensureInt8(new Array(Oi.PE_BUFFER_MAX));return fe.UTF8ToString(fe._pe_object_to_string_ext(o,s,a))},fe.PeGeogcs.prototype.destroy=function(){this.Delete(),ju(this),this.ptr=0},fe.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},fe.PeProjcs.prototype.destroy=function(){this.Delete(),ju(this),this.ptr=0},fe.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function ju(t){if(!t)return;const e=fe.getClass(t);if(!e)return;const n=fe.getCache(e);if(!n)return;const r=fe.getPointer(t);r&&delete n[r]}function oO(t,e){const n=[],r=new Array(e);for(let i=0;i<t;i++)n.push(fe.ensureInt8(r));return n}function C1(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function Og(t,e,n,r=!1){if(r)for(let i=0;i<2*e;i++)t[i]=fe.getValue(n+i*Float64Array.BYTES_PER_ELEMENT,"double");else{const i=t.length===0;for(let s=0;s<e;s++)i&&(t[s]=new Array(2)),t[s][0]=fe.getValue(n,"double"),t[s][1]=fe.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}const qAt=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:WC,PeDefs:Oi,get PeDouble(){return Bfe},PeFactory:D_,get PeGCSExtent(){return Wfe},PeGTTransformations:q8e,PeGTlistExtended:BG,PeGTlistExtendedEntry:H8e,PeLineType:K8e,PeMath:Y8e,PeNotationDms:X8e,PeNotationMgrs:Hfe,PeNotationUsng:Z8e,PeNotationUtm:qfe,PePCSInfo:Kfe,PeVersion:J8e,_init:Yfe,get _pe(){return fe},isLoaded:Gfe,isSupported:B8e,load:W8e},Symbol.toStringTag,{value:"Module"}));let y;const H={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(y=2e3;y<=2045;y++)H[y]=0;for(y=2056;y<=2065;y++)H[y]=0;for(y=2067;y<=2135;y++)H[y]=0;for(y=2137;y<=2154;y++)H[y]=0;for(y=2161;y<=2170;y++)H[y]=0;for(y=2172;y<=2193;y++)H[y]=0;for(y=2195;y<=2198;y++)H[y]=0;for(y=2200;y<=2203;y++)H[y]=0;for(y=2205;y<=2217;y++)H[y]=0;for(y=2222;y<=2224;y++)H[y]=1;for(y=2225;y<=2250;y++)H[y]=2;for(y=2251;y<=2253;y++)H[y]=1;for(y=2257;y<=2264;y++)H[y]=2;for(y=2274;y<=2279;y++)H[y]=2;for(y=2280;y<=2282;y++)H[y]=1;for(y=2283;y<=2289;y++)H[y]=2;for(y=2290;y<=2292;y++)H[y]=0;for(y=2308;y<=2313;y++)H[y]=0;for(y=2315;y<=2491;y++)H[y]=0;for(y=2494;y<=2866;y++)H[y]=0;for(y=2867;y<=2869;y++)H[y]=1;for(y=2870;y<=2888;y++)H[y]=2;for(y=2891;y<=2895;y++)H[y]=2;for(y=2896;y<=2898;y++)H[y]=1;for(y=2902;y<=2908;y++)H[y]=2;for(y=2915;y<=2920;y++)H[y]=2;for(y=2921;y<=2923;y++)H[y]=1;for(y=2924;y<=2930;y++)H[y]=2;for(y=2931;y<=2962;y++)H[y]=0;for(y=2964;y<=2968;y++)H[y]=2;for(y=2969;y<=2973;y++)H[y]=0;for(y=2975;y<=2991;y++)H[y]=0;for(y=2995;y<=3051;y++)H[y]=0;for(y=3054;y<=3079;y++)H[y]=0;for(y=3081;y<=3088;y++)H[y]=0;for(y=3092;y<=3101;y++)H[y]=0;for(y=3106;y<=3138;y++)H[y]=0;for(y=3146;y<=3151;y++)H[y]=0;for(y=3153;y<=3166;y++)H[y]=0;for(y=3168;y<=3172;y++)H[y]=0;for(y=3174;y<=3203;y++)H[y]=0;for(y=3294;y<=3358;y++)H[y]=0;for(y=3367;y<=3403;y++)H[y]=0;for(y=3408;y<=3416;y++)H[y]=0;for(y=3417;y<=3438;y++)H[y]=2;for(y=3441;y<=3446;y++)H[y]=2;for(y=3447;y<=3450;y++)H[y]=0;for(y=3451;y<=3459;y++)H[y]=2;for(y=3460;y<=3478;y++)H[y]=0;for(y=3554;y<=3559;y++)H[y]=0;for(y=3560;y<=3570;y++)H[y]=2;for(y=3571;y<=3581;y++)H[y]=0;for(y=3594;y<=3597;y++)H[y]=0;for(y=3601;y<=3604;y++)H[y]=0;for(y=3637;y<=3639;y++)H[y]=0;for(y=3665;y<=3667;y++)H[y]=0;for(y=3693;y<=3695;y++)H[y]=0;for(y=3701;y<=3727;y++)H[y]=0;for(y=3728;y<=3739;y++)H[y]=2;for(y=3740;y<=3751;y++)H[y]=0;for(y=3753;y<=3760;y++)H[y]=2;for(y=3761;y<=3773;y++)H[y]=0;for(y=3775;y<=3777;y++)H[y]=0;for(y=3779;y<=3781;y++)H[y]=0;for(y=3783;y<=3785;y++)H[y]=0;for(y=3788;y<=3791;y++)H[y]=0;for(y=3797;y<=3802;y++)H[y]=0;for(y=3814;y<=3816;y++)H[y]=0;for(y=3825;y<=3829;y++)H[y]=0;for(y=3832;y<=3841;y++)H[y]=0;for(y=3844;y<=3852;y++)H[y]=0;for(y=3873;y<=3885;y++)H[y]=0;for(y=3890;y<=3893;y++)H[y]=0;for(y=3907;y<=3912;y++)H[y]=0;for(y=3942;y<=3950;y++)H[y]=0;for(y=3968;y<=3970;y++)H[y]=0;for(y=3973;y<=3976;y++)H[y]=0;for(y=3986;y<=3989;y++)H[y]=0;for(y=3994;y<=3997;y++)H[y]=0;for(y=4048;y<=4051;y++)H[y]=0;for(y=4056;y<=4063;y++)H[y]=0;for(y=4093;y<=4096;y++)H[y]=0;for(y=4390;y<=4398;y++)H[y]=0;for(y=4399;y<=4413;y++)H[y]=2;for(y=4418;y<=4433;y++)H[y]=2;for(y=4455;y<=4457;y++)H[y]=2;for(y=4484;y<=4489;y++)H[y]=0;for(y=4491;y<=4554;y++)H[y]=0;for(y=4568;y<=4589;y++)H[y]=0;for(y=4652;y<=4656;y++)H[y]=0;for(y=4766;y<=4800;y++)H[y]=0;for(y=5014;y<=5016;y++)H[y]=0;for(y=5069;y<=5072;y++)H[y]=0;for(y=5105;y<=5130;y++)H[y]=0;for(y=5167;y<=5188;y++)H[y]=0;for(y=5253;y<=5259;y++)H[y]=0;for(y=5269;y<=5275;y++)H[y]=0;for(y=5292;y<=5311;y++)H[y]=0;for(y=5329;y<=5331;y++)H[y]=0;for(y=5343;y<=5349;y++)H[y]=0;for(y=5355;y<=5357;y++)H[y]=0;for(y=5387;y<=5389;y++)H[y]=0;for(y=5459;y<=5463;y++)H[y]=0;for(y=5479;y<=5482;y++)H[y]=0;for(y=5518;y<=5520;y++)H[y]=0;for(y=5530;y<=5539;y++)H[y]=0;for(y=5550;y<=5552;y++)H[y]=0;for(y=5562;y<=5583;y++)H[y]=0;for(y=5623;y<=5625;y++)H[y]=2;for(y=5631;y<=5639;y++)H[y]=0;for(y=5649;y<=5653;y++)H[y]=0;for(y=5663;y<=5680;y++)H[y]=0;for(y=5682;y<=5685;y++)H[y]=0;for(y=5875;y<=5877;y++)H[y]=0;for(y=5896;y<=5899;y++)H[y]=0;for(y=5921;y<=5940;y++)H[y]=0;for(y=6050;y<=6125;y++)H[y]=0;for(y=6244;y<=6275;y++)H[y]=0;for(y=6328;y<=6348;y++)H[y]=0;for(y=6350;y<=6356;y++)H[y]=0;for(y=6366;y<=6372;y++)H[y]=0;for(y=6381;y<=6387;y++)H[y]=0;for(y=6393;y<=6404;y++)H[y]=0;for(y=6480;y<=6483;y++)H[y]=0;for(y=6511;y<=6514;y++)H[y]=0;for(y=6579;y<=6581;y++)H[y]=0;for(y=6619;y<=6624;y++)H[y]=0;for(y=6625;y<=6627;y++)H[y]=2;for(y=6628;y<=6632;y++)H[y]=0;for(y=6634;y<=6637;y++)H[y]=0;for(y=6669;y<=6692;y++)H[y]=0;for(y=6707;y<=6709;y++)H[y]=0;for(y=6720;y<=6723;y++)H[y]=0;for(y=6732;y<=6738;y++)H[y]=0;for(y=6931;y<=6933;y++)H[y]=0;for(y=6956;y<=6959;y++)H[y]=0;for(y=7005;y<=7007;y++)H[y]=0;for(y=7057;y<=7070;y++)H[y]=2;for(y=7074;y<=7082;y++)H[y]=0;for(y=7109;y<=7118;y++)H[y]=0;for(y=7119;y<=7127;y++)H[y]=1;for(y=7374;y<=7376;y++)H[y]=0;for(y=7528;y<=7586;y++)H[y]=0;for(y=7587;y<=7645;y++)H[y]=2;for(y=7692;y<=7696;y++)H[y]=0;for(y=7755;y<=7787;y++)H[y]=0;for(y=7791;y<=7795;y++)H[y]=0;for(y=7799;y<=7801;y++)H[y]=0;for(y=7803;y<=7805;y++)H[y]=0;for(y=7825;y<=7831;y++)H[y]=0;for(y=7845;y<=7859;y++)H[y]=0;for(y=8013;y<=8032;y++)H[y]=0;for(y=8065;y<=8068;y++)H[y]=1;for(y=8518;y<=8529;y++)H[y]=2;for(y=8533;y<=8536;y++)H[y]=2;for(y=8538;y<=8540;y++)H[y]=2;for(y=8677;y<=8679;y++)H[y]=0;for(y=8836;y<=8840;y++)H[y]=0;for(y=8857;y<=8859;y++)H[y]=0;for(y=8908;y<=8910;y++)H[y]=0;for(y=9154;y<=9159;y++)H[y]=0;for(y=9205;y<=9218;y++)H[y]=0;for(y=9271;y<=9273;y++)H[y]=0;for(y=9295;y<=9297;y++)H[y]=0;for(y=9356;y<=9360;y++)H[y]=0;for(y=9404;y<=9407;y++)H[y]=0;for(y=9476;y<=9482;y++)H[y]=0;for(y=9487;y<=9494;y++)H[y]=0;for(y=9697;y<=9699;y++)H[y]=0;for(y=9821;y<=9865;y++)H[y]=0;for(y=10285;y<=10291;y++)H[y]=0;for(y=10314;y<=10317;y++)H[y]=0;for(y=10448;y<=10465;y++)H[y]=0;for(y=10726;y<=10729;y++)H[y]=0;for(y=10731;y<=10733;y++)H[y]=0;for(y=11114;y<=11118;y++)H[y]=0;for(y=20004;y<=20032;y++)H[y]=0;for(y=20047;y<=20049;y++)H[y]=0;for(y=20062;y<=20092;y++)H[y]=0;for(y=20135;y<=20138;y++)H[y]=0;for(y=20248;y<=20258;y++)H[y]=0;for(y=20348;y<=20358;y++)H[y]=0;for(y=20436;y<=20440;y++)H[y]=0;for(y=20822;y<=20824;y++)H[y]=0;for(y=20904;y<=20932;y++)H[y]=0;for(y=20934;y<=20936;y++)H[y]=0;for(y=21004;y<=21032;y++)H[y]=0;for(y=21035;y<=21037;y++)H[y]=0;for(y=21095;y<=21097;y++)H[y]=0;for(y=21148;y<=21150;y++)H[y]=0;for(y=21207;y<=21264;y++)H[y]=0;for(y=21307;y<=21364;y++)H[y]=0;for(y=21413;y<=21423;y++)H[y]=0;for(y=21453;y<=21463;y++)H[y]=0;for(y=21473;y<=21483;y++)H[y]=0;for(y=21780;y<=21782;y++)H[y]=0;for(y=21891;y<=21894;y++)H[y]=0;for(y=21896;y<=21899;y++)H[y]=0;for(y=22171;y<=22177;y++)H[y]=0;for(y=22181;y<=22187;y++)H[y]=0;for(y=22191;y<=22197;y++)H[y]=0;for(y=22207;y<=22222;y++)H[y]=0;for(y=22229;y<=22232;y++)H[y]=0;for(y=22234;y<=22236;y++)H[y]=0;for(y=22243;y<=22250;y++)H[y]=0;for(y=22262;y<=22265;y++)H[y]=0;for(y=22307;y<=22322;y++)H[y]=0;for(y=22348;y<=22357;y++)H[y]=0;for(y=22407;y<=22422;y++)H[y]=0;for(y=22462;y<=22465;y++)H[y]=0;for(y=22521;y<=22525;y++)H[y]=0;for(y=22607;y<=22622;y++)H[y]=0;for(y=22641;y<=22646;y++)H[y]=0;for(y=22648;y<=22657;y++)H[y]=0;for(y=22707;y<=22722;y++)H[y]=0;for(y=22762;y<=22765;y++)H[y]=0;for(y=22807;y<=22822;y++)H[y]=0;for(y=22991;y<=22994;y++)H[y]=0;for(y=23028;y<=23038;y++)H[y]=0;for(y=23301;y<=23333;y++)H[y]=2;for(y=23830;y<=23853;y++)H[y]=0;for(y=23866;y<=23872;y++)H[y]=0;for(y=23877;y<=23884;y++)H[y]=0;for(y=23886;y<=23894;y++)H[y]=0;for(y=23946;y<=23948;y++)H[y]=0;for(y=24311;y<=24313;y++)H[y]=0;for(y=24342;y<=24347;y++)H[y]=0;for(y=24370;y<=24374;y++)H[y]=10;for(y=24375;y<=24381;y++)H[y]=0;for(y=24718;y<=24721;y++)H[y]=0;for(y=24817;y<=24821;y++)H[y]=0;for(y=24877;y<=24882;y++)H[y]=0;for(y=24891;y<=24893;y++)H[y]=0;for(y=25391;y<=25395;y++)H[y]=0;for(y=25828;y<=25838;y++)H[y]=0;for(y=26191;y<=26195;y++)H[y]=0;for(y=26391;y<=26393;y++)H[y]=0;for(y=26701;y<=26722;y++)H[y]=0;for(y=26729;y<=26799;y++)H[y]=2;for(y=26801;y<=26803;y++)H[y]=2;for(y=26811;y<=26813;y++)H[y]=2;for(y=26847;y<=26870;y++)H[y]=2;for(y=26891;y<=26899;y++)H[y]=0;for(y=26901;y<=26923;y++)H[y]=0;for(y=26929;y<=26946;y++)H[y]=0;for(y=26948;y<=26998;y++)H[y]=0;for(y=27037;y<=27040;y++)H[y]=0;for(y=27205;y<=27232;y++)H[y]=0;for(y=27258;y<=27260;y++)H[y]=0;for(y=27391;y<=27398;y++)H[y]=0;for(y=27561;y<=27564;y++)H[y]=0;for(y=27571;y<=27574;y++)H[y]=0;for(y=27581;y<=27584;y++)H[y]=0;for(y=27591;y<=27594;y++)H[y]=0;for(y=27700;y<=27707;y++)H[y]=0;for(y=28191;y<=28193;y++)H[y]=0;for(y=28348;y<=28358;y++)H[y]=0;for(y=28402;y<=28432;y++)H[y]=0;for(y=28462;y<=28492;y++)H[y]=0;for(y=29118;y<=29122;y++)H[y]=0;for(y=29168;y<=29172;y++)H[y]=0;for(y=29177;y<=29185;y++)H[y]=0;for(y=29187;y<=29195;y++)H[y]=0;for(y=29900;y<=29903;y++)H[y]=0;for(y=30161;y<=30179;y++)H[y]=0;for(y=30491;y<=30494;y++)H[y]=0;for(y=30729;y<=30732;y++)H[y]=0;for(y=31251;y<=31259;y++)H[y]=0;for(y=31265;y<=31268;y++)H[y]=0;for(y=31275;y<=31279;y++)H[y]=0;for(y=31281;y<=31297;y++)H[y]=0;for(y=31461;y<=31469;y++)H[y]=0;for(y=31491;y<=31495;y++)H[y]=0;for(y=31917;y<=31922;y++)H[y]=0;for(y=31965;y<=32e3;y++)H[y]=0;for(y=32001;y<=32003;y++)H[y]=2;for(y=32005;y<=32031;y++)H[y]=2;for(y=32033;y<=32060;y++)H[y]=2;for(y=32064;y<=32067;y++)H[y]=2;for(y=32074;y<=32077;y++)H[y]=2;for(y=32081;y<=32086;y++)H[y]=0;for(y=32107;y<=32130;y++)H[y]=0;for(y=32133;y<=32159;y++)H[y]=0;for(y=32164;y<=32167;y++)H[y]=2;for(y=32180;y<=32199;y++)H[y]=0;for(y=32201;y<=32260;y++)H[y]=0;for(y=32301;y<=32360;y++)H[y]=0;for(y=32401;y<=32460;y++)H[y]=0;for(y=32501;y<=32560;y++)H[y]=0;for(y=32601;y<=32662;y++)H[y]=0;for(y=32664;y<=32667;y++)H[y]=2;for(y=32701;y<=32761;y++)H[y]=0;for(y=53001;y<=53004;y++)H[y]=0;for(y=53008;y<=53019;y++)H[y]=0;for(y=53021;y<=53032;y++)H[y]=0;for(y=53034;y<=53037;y++)H[y]=0;for(y=53042;y<=53046;y++)H[y]=0;for(y=53074;y<=53080;y++)H[y]=0;for(y=54001;y<=54004;y++)H[y]=0;for(y=54008;y<=54019;y++)H[y]=0;for(y=54021;y<=54032;y++)H[y]=0;for(y=54034;y<=54037;y++)H[y]=0;for(y=54042;y<=54046;y++)H[y]=0;for(y=54048;y<=54053;y++)H[y]=0;for(y=54074;y<=54080;y++)H[y]=0;for(y=54090;y<=54096;y++)H[y]=0;for(y=54098;y<=54101;y++)H[y]=0;for(y=65161;y<=65163;y++)H[y]=0;for(y=102001;y<=102040;y++)H[y]=0;for(y=102042;y<=102063;y++)H[y]=0;for(y=102065;y<=102067;y++)H[y]=0;for(y=102070;y<=102117;y++)H[y]=0;for(y=102122;y<=102216;y++)H[y]=0;for(y=102221;y<=102377;y++)H[y]=0;for(y=102382;y<=102388;y++)H[y]=0;for(y=102389;y<=102398;y++)H[y]=2;for(y=102399;y<=102444;y++)H[y]=0;for(y=102445;y<=102447;y++)H[y]=2;for(y=102448;y<=102458;y++)H[y]=0;for(y=102459;y<=102468;y++)H[y]=2;for(y=102469;y<=102499;y++)H[y]=0;for(y=102500;y<=102519;y++)H[y]=1;for(y=102520;y<=102524;y++)H[y]=0;for(y=102525;y<=102529;y++)H[y]=2;for(y=102530;y<=102588;y++)H[y]=0;for(y=102590;y<=102598;y++)H[y]=0;for(y=102601;y<=102603;y++)H[y]=0;for(y=102605;y<=102628;y++)H[y]=0;for(y=102629;y<=102646;y++)H[y]=2;for(y=102648;y<=102700;y++)H[y]=2;for(y=102701;y<=102703;y++)H[y]=0;for(y=102707;y<=102730;y++)H[y]=2;for(y=102733;y<=102758;y++)H[y]=2;for(y=102767;y<=102900;y++)H[y]=0;for(y=102901;y<=102933;y++)H[y]=2;for(y=102934;y<=102950;y++)H[y]=13;for(y=102951;y<=102963;y++)H[y]=0;for(y=102965;y<=102969;y++)H[y]=0;for(y=102971;y<=102973;y++)H[y]=0;for(y=102975;y<=102989;y++)H[y]=0;for(y=102990;y<=102992;y++)H[y]=1;for(y=102997;y<=103002;y++)H[y]=0;for(y=103003;y<=103008;y++)H[y]=2;for(y=103009;y<=103011;y++)H[y]=0;for(y=103012;y<=103014;y++)H[y]=2;for(y=103019;y<=103021;y++)H[y]=0;for(y=103022;y<=103024;y++)H[y]=2;for(y=103029;y<=103031;y++)H[y]=0;for(y=103032;y<=103034;y++)H[y]=2;for(y=103065;y<=103068;y++)H[y]=0;for(y=103074;y<=103076;y++)H[y]=0;for(y=103077;y<=103079;y++)H[y]=1;for(y=103080;y<=103082;y++)H[y]=0;for(y=103083;y<=103085;y++)H[y]=2;for(y=103090;y<=103093;y++)H[y]=0;for(y=103097;y<=103099;y++)H[y]=0;for(y=103100;y<=103102;y++)H[y]=2;for(y=103107;y<=103109;y++)H[y]=0;for(y=103110;y<=103112;y++)H[y]=2;for(y=103113;y<=103116;y++)H[y]=0;for(y=103117;y<=103120;y++)H[y]=2;for(y=103153;y<=103157;y++)H[y]=0;for(y=103158;y<=103162;y++)H[y]=2;for(y=103163;y<=103165;y++)H[y]=0;for(y=103166;y<=103168;y++)H[y]=1;for(y=103169;y<=103171;y++)H[y]=2;for(y=103186;y<=103188;y++)H[y]=0;for(y=103189;y<=103191;y++)H[y]=2;for(y=103192;y<=103195;y++)H[y]=0;for(y=103196;y<=103199;y++)H[y]=2;for(y=103200;y<=103224;y++)H[y]=0;for(y=103225;y<=103227;y++)H[y]=1;for(y=103232;y<=103237;y++)H[y]=0;for(y=103238;y<=103243;y++)H[y]=2;for(y=103244;y<=103246;y++)H[y]=0;for(y=103247;y<=103249;y++)H[y]=2;for(y=103254;y<=103256;y++)H[y]=0;for(y=103257;y<=103259;y++)H[y]=2;for(y=103264;y<=103266;y++)H[y]=0;for(y=103267;y<=103269;y++)H[y]=2;for(y=103300;y<=103375;y++)H[y]=0;for(y=103381;y<=103383;y++)H[y]=0;for(y=103384;y<=103386;y++)H[y]=1;for(y=103387;y<=103389;y++)H[y]=0;for(y=103390;y<=103392;y++)H[y]=2;for(y=103397;y<=103399;y++)H[y]=0;for(y=103400;y<=103471;y++)H[y]=2;for(y=103476;y<=103478;y++)H[y]=0;for(y=103479;y<=103481;y++)H[y]=2;for(y=103486;y<=103488;y++)H[y]=0;for(y=103489;y<=103491;y++)H[y]=2;for(y=103492;y<=103495;y++)H[y]=0;for(y=103496;y<=103499;y++)H[y]=2;for(y=103528;y<=103543;y++)H[y]=0;for(y=103544;y<=103548;y++)H[y]=2;for(y=103549;y<=103551;y++)H[y]=0;for(y=103552;y<=103554;y++)H[y]=1;for(y=103555;y<=103557;y++)H[y]=2;for(y=103558;y<=103560;y++)H[y]=0;for(y=103571;y<=103573;y++)H[y]=0;for(y=103574;y<=103576;y++)H[y]=2;for(y=103577;y<=103580;y++)H[y]=0;for(y=103581;y<=103583;y++)H[y]=2;for(y=103595;y<=103694;y++)H[y]=0;for(y=103696;y<=103699;y++)H[y]=0;for(y=103700;y<=103793;y++)H[y]=2;for(y=103794;y<=103890;y++)H[y]=0;for(y=103891;y<=103896;y++)H[y]=2;for(y=103900;y<=103971;y++)H[y]=2;for(y=103972;y<=103977;y++)H[y]=0;for(y=112e3;y<=112101;y++)H[y]=0;const Xfe=[102100,102113,3857,3785,900913],Q8e=[104905,104971],eje=[104903],tje=[4326,...Xfe,...Q8e,...eje],Ek=[-20037508342788905e-9,20037508342788905e-9],RF=[-20037508342787e-6,20037508342787e-6],n$={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:Ek,origin:RF,dx:1e-5},Zfe={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Ek,origin:RF,dx:1e-5},102100:n$,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Ek,origin:RF,dx:1e-5},3857:n$,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:n$,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function uo(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const n=t.wkid,r=e.wkid;if(n!=null||r!=null){if(n===r||Ad(t)&&Ad(e))return!0;const o=t.latestWkid;if(o!=null&&r===o)return!0;const a=e.latestWkid;return a!=null&&n===a}let i,s;return t.wkt2&&e.wkt2?(i=t.wkt2,s=e.wkt2):t.wkt&&e.wkt&&(i=t.wkt,s=e.wkt),!(!i||!s)&&i.toUpperCase()===s.toUpperCase()}function La(t){const e=t?.wkid;return e!=null&&e>=2e3&&Zfe[e]||null}function Jfe(t){if(!t)return;const{wkid:e,vcsWkid:n}=t;if(e)return n?JSON.stringify({wkid:e,vcsWkid:n}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?n?{wkt:r,vcsWkid:n}:{wkt:r}:{})}function X2(t){if(!rc(t))return!1;const{wkid:e}=t;if(e)return H[e]==null;const n=t.wkt2||t.wkt;return!!n&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(n)}function nje(t){return!(Qfe(t)||epe(t))}function M1(t){return t?.wkid===4326}function KAt(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function zQ(t){return t?.wkid===4490}function Ad(t){const e=t?.wkid;return e!=null&&e>=2e3&&Xfe.includes(e)}function rje(t){return t?.wkid===32662}function aO(t){return t===104971||t===104905}function Qfe(t){return aO(t?.wkid)}function lO(t){return t===104903}function epe(t){return lO(t?.wkid)}function ije(t){const e=t?.wkid;return e!=null&&e>=2e3&&tje.includes(e)}function rc(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const tpe={wkid:4326,wkt:fde(Zfe[4326].wkTemplate,{Central_Meridian:"0.0"})},npe={wkid:102100,latestWkid:3857},sje={wkid:32662};function WG(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const oje=WG(ts),HG=WG(md),qG=WG(Ng),aje={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${ts.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},lje=HG.wkt.toUpperCase(),cje=qG.wkt.toUpperCase();function uje(t){if(t!=null&&rc(t)){const e=t.wkid,n=t.wkt2??t.wkt;if(aO(e))return md;const r=n?.toUpperCase();if(n&&r===lje)return md;if(lO(e)||r&&r===cje)return Ng}return ts}function YAt(t){return aO(t)?md:lO(t)?Ng:ts}function w4(t){return uo(t,oje)}function Lg(t){return w4(t)||uo(t,HG)||uo(t,qG)}const XAt=39.37,hje=ts.radius*Math.PI/200,rpe=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,o2=H,ipe=/UNIT\[([^\]]+)]/i,dje=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),fje=kl()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),ku=t=>t*t,sm=t=>t*t*t,Sk={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:ku(.001)},"square-centimeters":{inBaseUnits:ku(.01)},"square-decimeters":{inBaseUnits:ku(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:ku(1e3)},"square-inches":{inBaseUnits:ku(.0254)},"square-feet":{inBaseUnits:ku(.3048)},"square-yards":{inBaseUnits:ku(.9144)},"square-miles":{inBaseUnits:ku(1609.344)},"square-nautical-miles":{inBaseUnits:ku(1852)},"square-us-feet":{inBaseUnits:ku(1200/3937)},acres:{inBaseUnits:.0015625*ku(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*sm(.001)},"cubic-centimeters":{inBaseUnits:1e3*sm(.01)},"cubic-decimeters":{inBaseUnits:1e3*sm(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*sm(1e3)},"cubic-inches":{inBaseUnits:1e3*sm(.0254)},"cubic-feet":{inBaseUnits:1e3*sm(.3048)},"cubic-yards":{inBaseUnits:1e3*sm(.9144)},"cubic-miles":{inBaseUnits:1e3*sm(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},pje=(()=>{const t={};for(const e in Sk)for(const n in Sk[e].units)t[n]=e;return t})();function mje(t,e,n){return t*Sk[n].units[e].inBaseUnits}function gje(t,e,n){return t/Sk[n].units[e].inBaseUnits}const yje=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],vje=["metric","imperial"],spe=[...vje,...yje],_je=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function PF(t){const e=pje[t];if(!e)throw new Error("unknown type");return e}function UQ(t,e=null){return e=e||PF(t),Sk[e].baseUnit===t}function lh(t,e,n){if(e===n)return t;const r=PF(e);if(r!==PF(n))throw new Error("incompatible units");const i=UQ(e,r)?t:mje(t,e,r);return UQ(n,r)?i:gje(i,n,r)}function ZAt(t,e,n,r=!1){if(!r&&X2(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const i=iv(e);return i!==n&&(t=i?lh(t,i,n):lh(t*=$d(e),"meters",n)),t}function JAt(t,e,n,r=!1){if(!r&&X2(n))throw new Error("Unable to convert from a linear unit to an angular unit.");const i=iv(n);return e!==i&&(t=i?lh(t,e,i):lh(t,e,"meters")/$d(n)),t}function xje(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function QAt(t){return xje(t)}function eIt(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function tIt(t,e,n){switch(n){case"metric":return wje(t,e);case"imperial":return Eje(t,e);default:return n}}function nIt(t,e,n){switch(n){case"metric":return bje(t,e);case"imperial":return Sje(t,e);default:return n}}function wje(t,e){const n=lh(t,e,"meters");return Math.abs(n)<3e3?"meters":"kilometers"}function bje(t,e){const n=lh(t,e,"meters");return Math.abs(n)<1e5?"meters":"kilometers"}function Eje(t,e){const n=lh(t,e,"feet");return Math.abs(n)<1e3?"feet":"miles"}function Sje(t,e){const n=lh(t,e,"feet");return Math.abs(n)<1e5?"feet":"miles"}function rIt(t,e){const n=lh(t,e,"square-meters");return Math.abs(n)<3e6?"square-meters":"square-kilometers"}function iIt(t,e){const n=lh(t,e,"square-feet");return Math.abs(n)<1e6?"square-feet":"square-miles"}function sIt(t,e,n){return lh(t,e,"meters")/(n*Math.PI/180)}function KG(t){return fje.fromJSON(t.toLowerCase())||null}function GQ(t){if(t!=null&&!nje(t))return 1;const e=$d(t);return e>1e5?1:e}function ope(t){return $d(t)>=uje(t).metersPerDegree?"meters":iv(t)}function $d(t,e=ts.metersPerDegree){return Tje(t,!0)??e}function Tje(t,e=!1){const n=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(n){if(aO(n))return md.metersPerDegree;if(lO(n))return Ng.metersPerDegree;i=o2.values[o2[n]],!i&&e&&dje.has(n)&&(i=hje)}else r&&(cpe(r)?i=BQ(rpe.exec(r),i):lpe(r)&&(i=BQ(ipe.exec(r),i)));return i}function oIt(t){return X2(t)?1:$d(t)}function BQ(t,e){return t?.[1]?ape(t[1]):e}function ape(t){return parseFloat(t.split(",")[1])}function iv(t){const e=t?.wkid??null,n=t?.wkt2??t?.wkt??null;let r=null;if(e)r=o2.units[o2[e]];else if(n){const i=cpe(n)?rpe:lpe(n)?ipe:null;if(i){const s=i.exec(n);s?.[1]&&(r=Aje(s[1]))}}return r!=null?KG(r):null}function aIt(t){const e=iv(t);return e!=null&&spe.includes(e)?e:null}function lIt(t){const e=ope(t);return e!=null&&spe.includes(e)?e:null}function cIt(t){const e=iv(t);return e==null?null:_je.get(e)}function lpe(t){return/^GEOCCS/i.test(t)}function cpe(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const kje=1e-7;function Aje(t){let n=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!n||!KG(n)){const r=ape(t);n=null;const i=o2.values;for(let s=0;s<i.length;++s)if(Math.abs(r-i[s])<kje){n=o2.units[s];break}}return n}function uIt(t){const e=iv(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const Ije={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},Rje={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},Pje={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},hIt=kl()(Ije),dIt=kl()(Rje),fIt=kl()(Pje);var Dh,ed;let Bt=(ed=class extends qt{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return Dh.WebMercator;if(e?.wkid===4326)return Dh.WGS84;const n=new Dh;return n.read(e),n}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return M1(this)}get isWebMercator(){return Ad(this)}get isGeographic(){return X2(this)}get isWrappable(){return ije(this)}get metersPerUnit(){return $d(this)}get unit(){return iv(this)||(this.isGeographic?"degrees":null)}writeWkt(e,n){this.wkid||(n.wkt=e)}clone(){if(this===Dh.WGS84)return new Dh(tpe);if(this===Dh.WebMercator)return new Dh(npe);const e=new Dh;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=Ze(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:n,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:i}=e.imageCoordinateSystem,s=this.imageCoordinateSystem;return n==null||i?JSON.stringify(s)===JSON.stringify(e.imageCoordinateSystem):r?s.id===n&&s.referenceServiceName===r:s.id===n}return uo(this,e)}toJSON(e){return this.write(void 0,e)}},Dh=ed,ed.GCS_NAD_1927=null,ed.WGS84=null,ed.WebMercator=null,ed.PlateCarree=null,ed);_([E({readOnly:!0})],Bt.prototype,"isWGS84",null),_([E({readOnly:!0})],Bt.prototype,"isWebMercator",null),_([E({readOnly:!0})],Bt.prototype,"isGeographic",null),_([E({readOnly:!0})],Bt.prototype,"isWrappable",null),_([E({type:Or,json:{write:!0}})],Bt.prototype,"latestWkid",void 0),_([E({readOnly:!0})],Bt.prototype,"metersPerUnit",null),_([E({readOnly:!0})],Bt.prototype,"unit",null),_([E({type:Or,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Bt.prototype,"wkid",void 0),_([E({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Bt.prototype,"wkt",void 0),_([Xn("wkt"),Xn("web-scene","wkt")],Bt.prototype,"writeWkt",null),_([E({type:String,json:{write:!1}})],Bt.prototype,"wkt2",void 0),_([E({type:Or,json:{write:!0}})],Bt.prototype,"vcsWkid",void 0),_([E({type:Or,json:{write:!0}})],Bt.prototype,"latestVcsWkid",void 0),_([E()],Bt.prototype,"imageCoordinateSystem",void 0),Bt=Dh=_([ue("esri.geometry.SpatialReference")],Bt),Bt.prototype.toJSON.isDefaultToJSON=!0,Bt.GCS_NAD_1927=Kt.freeze(new Bt({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Bt.WGS84=Kt.freeze(new Bt(tpe)),Bt.WebMercator=Kt.freeze(new Bt(npe)),Bt.PlateCarree=Kt.freeze(new Bt(sje));function or(t,e,n){let r,i;return e===void 0||Array.isArray(e)?(i=t,n=e,r=[void 0]):(i=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;r.forEach(l=>{const c=LG(s,l,i);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],n&&(c.read.source=(c.read.source||[]).concat(n))})}}let Ds=class extends qt{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Bt.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,n){if(e instanceof Bt)return e;if(e!=null){const r=new Bt;return r.read(e,n),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,n){this.cache[e]=n}};_([E()],Ds.prototype,"type",void 0),_([E({readOnly:!0})],Ds.prototype,"cache",null),_([E({readOnly:!0})],Ds.prototype,"extent",null),_([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ds.prototype,"hasM",void 0),_([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ds.prototype,"hasZ",void 0),_([E({type:Bt,json:{write:!0},value:Bt.WGS84})],Ds.prototype,"spatialReference",void 0),_([or("spatialReference")],Ds.prototype,"readSpatialReference",null),Ds=_([ue("esri.geometry.Geometry")],Ds);const Cje=Object.prototype.toString;function Mje(t){const e="__accessorMetadata__"in t?Va(t):t;return function(...n){if(n.push(e),typeof n[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Nje.apply(this,n)}}function Nje(t,e,n,r){tI(t,e).cast=r}function Oje(t){return(e,n)=>{tI(e,t).cast=e[n]}}function zs(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&Cje.call(t[0])==="[object Function]"?Mje(t[0]):t.length===1&&typeof t[0]=="string"?Oje(t[0]):void 0}function a2(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new Xe("internal:mesh","Mesh geometries are not supported for this operation")}function Lje(t){t.forEach(a2)}const Dje=57.29577951308232,$je=.017453292519943;function WQ(t){return t*Dje}function HQ(t){return t*$je}function mIt(t){return Math.PI/2-2*Math.atan(Math.exp(-t/ts.radius))}function CF(t){return t.wkid!=null||t.wkt!=null}const r$=[0,0];function b4(t,e,n,r,i){const s=t,o=i;if(o.spatialReference=n,"x"in s&&"x"in o)[o.x,o.y]=e(s.x,s.y,r$,r);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=e(s.xmin,s.ymin,r$,r),[o.xmax,o.ymax]=e(s.xmax,s.ymax,r$,r);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,l=[];let c;for(let u=0;u<a.length;u++){const h=a[u];c=[],l.push(c);for(let f=0;f<h.length;f++)c.push(e(h[f][0],h[f][1],[0,0],r)),h[f].length>2&&c[f].push(h[f][2]),h[f].length>3&&c[f].push(h[f][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in s&&"points"in o){const a=s.points,l=[];for(let c=0;c<a.length;c++)l[c]=e(a[c][0],a[c][1],[0,0],r),a[c].length>2&&l[c].push(a[c][2]),a[c].length>3&&l[c].push(a[c][3]);o.points=l}return i}function qC(t,e){const n=t&&(CF(t)?t:t.spatialReference),r=e&&(CF(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!n||!r)&&(!!uo(r,n)||Ad(r)&&M1(n)||Ad(n)&&M1(r))}function cO(t,e){if(t==null)return null;const n=t.spatialReference,r=e&&(CF(e)?e:e.spatialReference);return qC(n,r)?uo(n,r)?Ze(t):Ad(r)?b4(t,fx,Bt.WebMercator,!1,Ze(t)):M1(r)?b4(t,uO,Bt.WGS84,!1,Ze(t)):null:null}function fx(t,e,n=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=HQ(e);return n[0]=HQ(t)*ts.radius,n[1]=ts.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),n}function uO(t,e,n=[0,0],r=!1){if(t===Ek[0])n[0]=-180;else if(t===Ek[1])n[0]=180;else{const i=WQ(t/ts.radius);n[0]=r?i:i-360*Math.floor((i+180)/360)}return n[1]=WQ(Math.PI/2-2*Math.atan(Math.exp(-e/ts.radius))),n}function Yy(t,e=!1,n=Ze(t)){return a2(t),a2(n),b4(t,fx,Bt.WebMercator,e,n)}function YE(t,e=!1,n=Ze(t)){return a2(t),a2(n),b4(t,uO,Bt.WGS84,e,n)}function upe(t,e){const n=t.x-e.x,r=t.y-e.y,i=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(n*n+r*r+i*i)}function jje(t){return hpe(t,dpe)?.[0]??null}function Fje(t){return hpe(t,dpe)?.[1]??null}function hpe({x:t,y:e,spatialReference:n},r=[0,0]){if(n){if(Ad(n))return uO(t,e,r);if(X2(n))return r[0]=t,r[1]=e,r}return null}const dpe=[0,0];var KC;const i$=[0,0];function qQ(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Jt=KC=class extends Ds{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const n=t._get("spatialReference");e._set("spatialReference",Kt.isFrozen(n)?n:n.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,n,r,i){let s;if(Array.isArray(t))s=t,i=e,t=s[0],e=s[1],n=s[2],r=s[3];else if(t&&typeof t=="object"){if(s=t,t=s.x!=null?s.x:s.longitude,e=s.y!=null?s.y:s.latitude,n=s.z,r=s.m,(i=s.spatialReference)&&i.declaredClass!=="esri.geometry.SpatialReference"&&(i=new Bt(i)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)Tt.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)Tt.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&i?.isWebMercator){const a=fx(s.longitude,s.latitude,i$);t=a[0],e=a[1]}}}else qQ(n)?(i=n,n=null):qQ(r)&&(i=r,r=null);const o={x:t,y:e};return o.x==null&&o.y!=null?Tt.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&Tt.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),i!=null&&(o.spatialReference=i),n!=null&&(o.z=n),r!=null&&(o.m=r),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return Fje(this)}set latitude(t){const{spatialReference:e,x:n}=this;t!=null&&e&&(e.isWebMercator?this._set("y",fx(n,t,i$)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return jje(this)}set longitude(t){const{y:e,spatialReference:n}=this;t!=null&&n&&(n.isWebMercator?this._set("x",fx(t,e,i$)[0]):n.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,n){e[n]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new KC;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return KC.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:n,z:r,m:i,spatialReference:s}=this,{z:o,m:a}=t;let{x:l,y:c,spatialReference:u}=t;if(!s.equals(u))if(s.isWebMercator&&u.isWGS84)[l,c]=fx(l,c),u=s;else{if(!s.isWGS84||!u.isWebMercator)return!1;[l,c]=uO(l,c),u=s}return e===l&&n===c&&r===o&&i===a&&s.wkid===u.wkid}offset(t,e,n){return this.x+=t,this.y+=e,n!=null&&(this.z=(this.z??0)+n),this}normalize(){if(!this.spatialReference)return this;const t=La(this.spatialReference);if(!t)return this;let e=this.x;const[n,r]=t.valid,i=2*r;let s;return e>r?(s=Math.ceil(Math.abs(e-r)/i),e-=s*i):e<n&&(s=Math.ceil(Math.abs(e-n)/i),e+=s*i),this._set("x",e),this}distance(t){return upe(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};_([E({readOnly:!0})],Jt.prototype,"cache",null),_([E({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Jt.prototype,"hasM",null),_([E({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Jt.prototype,"hasZ",null),_([E({type:Number})],Jt.prototype,"latitude",null),_([E({type:Number})],Jt.prototype,"longitude",null),_([E({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),zs(t=>isNaN(t)?t:Zl(t))],Jt.prototype,"x",void 0),_([Xn("x")],Jt.prototype,"writeX",null),_([or("x")],Jt.prototype,"readX",null),_([E({type:Number,json:{write:!0}})],Jt.prototype,"y",void 0),_([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Jt.prototype,"z",void 0),_([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Jt.prototype,"m",void 0),Jt=KC=_([ue("esri.geometry.Point")],Jt),Jt.prototype.toJSON.isDefaultToJSON=!0;const s$=[0,0];function sI(t,e){return e!=null&&ba(t,e.x,e.y,e.z)}function gIt(t,e){if(!e.points?.length)return!1;for(const n of e.points)if(!l2(t,n))return!1;return!0}function Vje(t,e){const{xmin:n,ymin:r,zmin:i,xmax:s,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?ba(t,n,r,i)&&ba(t,n,o,i)&&ba(t,s,o,i)&&ba(t,s,r,i)&&ba(t,n,r,a)&&ba(t,n,o,a)&&ba(t,s,o,a)&&ba(t,s,r,a):ba(t,n,r)&&ba(t,n,o)&&ba(t,s,o)&&ba(t,s,r)}function l2(t,e){return ba(t,e[0],e[1])}function zje(t,e){return ba(t,e[0],e[1],e[2])}function ba(t,e,n,r){return e>=t.xmin&&e<=t.xmax&&n>=t.ymin&&n<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function YG(t,e){return s$[1]=e.y,s$[0]=e.x,Uje(t,s$)}function Uje(t,e){return XG(t.rings,e)}function XG(t,e){if(!t||t.length<1)return!1;if(Gje(t))return KQ(!1,t,e);let n=!1;for(let r=0,i=t.length;r<i;r++)n=KQ(n,t[r],e);return n}function Gje(t){return!Array.isArray(t[0][0])}function KQ(t,e,n){const[r,i]=n;let s=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[c,u]=e[a],[h,f]=e[o];(u<i&&f>=i||f<i&&u>=i)&&c+(i-u)/(f-u)*(h-c)<r&&(s=!s)}return s}function Bje(t,e){return sI(t,e)}function Wje(t,e){const n=t.hasZ&&e.hasZ;let r,i,s;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(i=e.ymin,t.ymax<i)return!1}else if(i=t.ymin,e.ymax<i)return!1;if(n&&e.hasZ){if(t.zmin<=e.zmin){if(s=e.zmin,t.zmax<s)return!1}else if(s=t.zmin,e.zmax<s)return!1}return!0}function Hje(t,e){const{points:n,hasZ:r}=e,i=r?zje:l2;for(const s of n)if(i(t,s))return!0;return!1}const N1=[0,0],O1=[0,0],L1=[0,0],D1=[0,0],qje=[N1,O1,L1,D1],fpe=[[L1,N1],[N1,O1],[O1,D1],[D1,L1]];function Kje(t,e){return Yje(t,e.rings)}function Yje(t,e){N1[0]=t.xmin,N1[1]=t.ymax,O1[0]=t.xmax,O1[1]=t.ymax,L1[0]=t.xmin,L1[1]=t.ymin,D1[0]=t.xmax,D1[1]=t.ymin;for(const n of qje)if(XG(e,n))return!0;for(const n of e){if(!n.length)continue;let r=n[0];if(l2(t,r))return!0;for(let i=1;i<n.length;i++){const s=n[i];if(l2(t,s)||ppe(r,s,fpe))return!0;r=s}}return!1}function Xje(t,e){N1[0]=t.xmin,N1[1]=t.ymax,O1[0]=t.xmax,O1[1]=t.ymax,L1[0]=t.xmin,L1[1]=t.ymin,D1[0]=t.xmax,D1[1]=t.ymin;const n=e.paths;for(const r of n){if(!n.length)continue;let i=r[0];if(l2(t,i))return!0;for(let s=1;s<r.length;s++){const o=r[s];if(l2(t,o)||ppe(i,o,fpe))return!0;i=o}}return!1}const Ys=[0,0];function Zje(t){for(let e=0;e<t.length;e++){const n=t[e];for(let i=0;i<n.length-1;i++){const s=n[i],o=n[i+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],u=t[a][l+1];if(MF(s,o,c,u,Ys)&&!(Ys[0]===s[0]&&Ys[1]===s[1]||Ys[0]===c[0]&&Ys[1]===c[1]||Ys[0]===o[0]&&Ys[1]===o[1]||Ys[0]===u[0]&&Ys[1]===u[1]))return!0}}const r=n.length;if(!(r<=4))for(let i=0;i<r-3;i++){let s=r-1;i===0&&(s=r-2);const o=n[i],a=n[i+1];for(let l=i+2;l<s;l++){const c=n[l],u=n[l+1];if(MF(o,a,c,u,Ys)&&!(Ys[0]===o[0]&&Ys[1]===o[1]||Ys[0]===c[0]&&Ys[1]===c[1]||Ys[0]===a[0]&&Ys[1]===a[1]||Ys[0]===u[0]&&Ys[1]===u[1]))return!0}}}return!1}function ppe(t,e,n){for(let r=0;r<n.length;r++)if(MF(t,e,n[r][0],n[r][1]))return!0;return!1}function MF(t,e,n,r,i){const[s,o]=t,[a,l]=e,[c,u]=n,[h,f]=r,g=h-c,v=s-c,x=a-s,b=f-u,T=o-u,A=l-o,I=b*x-g*A;if(I===0)return!1;const R=(g*T-b*v)/I,M=(x*T-A*v)/I;return R>=0&&R<=1&&M>=0&&M<=1&&(i&&(i[0]=s+R*(a-s),i[1]=o+R*(l-o)),!0)}function Jje(t){switch(t){case"esriGeometryEnvelope":case"extent":return Wje;case"esriGeometryMultipoint":case"multipoint":return Hje;case"esriGeometryPoint":case"point":return Bje;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return Kje;case"esriGeometryPolyline":case"polyline":return Xje}}var Ou;function Qje(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function om(t,e,n){return e==null?n:n==null?e:t(e,n)}let Dn=Ou=class extends Ds{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,n,r,i){return Qje(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Bt.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:n,ymax:r,spatialReference:i??Bt.WGS84}}static fromPoint(t){return new Ou({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Jt({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Ou;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,n=t.spatialReference;return e&&n&&!e.equals(n)&&qC(e,n)&&(t=e.isWebMercator?Yy(t):YE(t,!0)),t.type==="point"?sI(this,t):t.type==="extent"&&Vje(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,n=t.spatialReference;return e&&n&&!e.equals(n)&&qC(e,n)&&(t=e.isWebMercator?Yy(t):YE(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),n=this.width*e,r=this.height*e;if(this.xmin+=n,this.ymin+=r,this.xmax-=n,this.ymax-=r,this.hasZ){const i=(this.zmax-this.zmin)*e;this.zmin+=i,this.zmax-=i}if(this.hasM){const i=(this.mmax-this.mmin)*e;this.mmin+=i,this.mmax-=i}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,n=t.spatialReference;return e&&n&&!uo(e,n)&&qC(e,n)&&(t=e.isWebMercator?Yy(t):YE(t,!0)),Jje(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,n){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,n!=null&&(this.zmin+=n,this.zmax+=n),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=om(Math.min,this.zmin,t.zmin),this.zmax=om(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=om(Math.min,this.mmin,t.mmin),this.mmax=om(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=om(Math.max,this.zmin,t.zmin),this.zmax=om(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=om(Math.max,this.mmin,t.mmin),this.mmax=om(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=La(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,n=this._getCM(t);if(n){const r=e.isWebMercator?YE(n):n;this.xmin-=n.x,this.xmax-=n.x,e.isWebMercator||(r.x=o$(r.x,t).x),this.spatialReference=new Bt(fde((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[n,r]=t.valid,i=this.xmin,s=this.xmax;return i>=n&&i<=r&&s>=n&&s<=r||(e=this.center),e}_normalize(t,e,n){const r=this.spatialReference;if(!r)return this;const i=n??La(r);if(i==null)return this;const s=this._getParts(i).map(l=>l.extent);if(s.length<2)return s[0]||this;if(s.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return s;let o=!0,a=!0;return s.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:s.map(l=>{const c=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const u=(l.zmax-l.zmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}if(a){const u=(l.mmax-l.mmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}return c}),hasZ:o,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:o}=this,a=this.width,l=this.xmin,c=this.xmax;let u;t=t||La(o);const[h,f]=t.valid;u=o$(this.xmin,t);const g=u.x,v=u.frameId;u=o$(this.xmax,t);const x=u.x,b=u.frameId,T=g===x&&a>0;if(a>2*f){const A=new Ou(l<c?g:x,i,f,s,o),I=new Ou(h,i,l<c?x:g,s,o),R=new Ou(0,i,f,s,o),M=new Ou(h,i,0,s,o),F=[],C=[];A.contains(R)&&F.push(v),A.contains(M)&&C.push(v),I.contains(R)&&F.push(b),I.contains(M)&&C.push(b);for(let N=v+1;N<b;N++)F.push(N),C.push(N);e.push({extent:A,frameIds:[v]},{extent:I,frameIds:[b]},{extent:R,frameIds:F},{extent:M,frameIds:C})}else g>x||T?e.push({extent:new Ou(g,i,f,s,o),frameIds:[v]},{extent:new Ou(h,i,x,s,o),frameIds:[b]}):e.push({extent:new Ou(g,i,x,s,o),frameIds:[v]});this.cache._parts=e}const n=this.hasZ,r=this.hasM;if(n||r){const i={};n&&(i.zmin=this.zmin,i.zmax=this.zmax),r&&(i.mmin=this.mmin,i.mmax=this.mmax);for(let s=0;s<e.length;s++)e[s].extent.set(i)}return e}};function o$(t,e){const[n,r]=e.valid,i=2*r;let s,o=0;return t>r?(s=Math.ceil(Math.abs(t-r)/i),t-=s*i,o=s):t<n&&(s=Math.ceil(Math.abs(t-n)/i),t+=s*i,o=-s),{x:t,frameId:o}}_([E({readOnly:!0})],Dn.prototype,"cache",null),_([E({readOnly:!0})],Dn.prototype,"center",null),_([E({readOnly:!0})],Dn.prototype,"extent",null),_([E({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Dn.prototype,"hasM",null),_([E({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Dn.prototype,"hasZ",null),_([E({readOnly:!0})],Dn.prototype,"height",null),_([E({readOnly:!0})],Dn.prototype,"width",null),_([E({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Dn.prototype,"xmin",void 0),_([E({type:Number,json:{write:!0}})],Dn.prototype,"ymin",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Dn.prototype,"mmin",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Dn.prototype,"zmin",void 0),_([E({type:Number,json:{write:!0}})],Dn.prototype,"xmax",void 0),_([E({type:Number,json:{write:!0}})],Dn.prototype,"ymax",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Dn.prototype,"mmax",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Dn.prototype,"zmax",void 0),Dn=Ou=_([ue("esri.geometry.Extent")],Dn),Dn.prototype.toJSON.isDefaultToJSON=!0;let JS;const eFe=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,NF=globalThis.document?.documentElement;function mpe(){const t=NF?.getAttribute("lang"),e=globalThis.navigator?.language;return eFe??t??e??"en"}function eu(){return JS===void 0&&(JS=mpe()),JS}const tFe=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function ZG(t=eu()){return ype(t)?.language}function gpe(t=eu()){const e=ype(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function ype(t=eu()){return tFe.exec(t)?.groups}const YC=[];function vpe(t){return YC.push(t),qn(()=>{YC.splice(YC.indexOf(t),1)})}const XC=[];function JG(t){return XC.push(t),qn(()=>XC.splice(XC.indexOf(t),1))}function YQ(){const t=mpe();JS!==t&&([...XC].forEach(e=>e(t)),JS=t,[...YC].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",YQ),NF&&new MutationObserver(()=>{YQ()}).observe(NF,{attributeFilter:["lang"]});let yP;function nFe(t){return yP&&!yP.destroyed||(yP=t()),yP}var OF;const rFe=new Gs({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let as=OF=class extends Kt{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new OF({categories:this.categories?Ze(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let n=[];this.categories&&(n=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let r="";if(this.extent){const o=cO(this.extent,Bt.WGS84);o!=null&&(r=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let i=this.query;!this.disableExtraQuery&&t.extraQuery&&(i="("+i+")"+t.extraQuery);const s={categories:n,bbox:r,q:i,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>rFe.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...e,...s}}}};_([E()],as.prototype,"categories",void 0),_([E()],as.prototype,"disableExtraQuery",void 0),_([E({type:Dn})],as.prototype,"extent",void 0),_([E()],as.prototype,"filter",void 0),_([E()],as.prototype,"num",void 0),_([E()],as.prototype,"query",void 0),_([E()],as.prototype,"sortField",void 0),_([E()],as.prototype,"sortOrder",null),_([E()],as.prototype,"start",void 0),as=OF=_([ue("esri.portal.PortalQueryParams")],as);var LF;let Ui=LF=class extends qt{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const n=e.categorySchema||[];return n.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):n})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Xe("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new LF({sourceJSON:t});return e.read(t),e}queryItems(t,e){let n=Va(as,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(n=n||new as,r.queryPortal(`/content/groups/${this.id}/search`,n,"PortalItem",e)):(n=n?n.clone():new as,n.query="group:"+this.id+(n.query?" "+n.query:""),r.queryItems(n,e))}_fetchCategorySchemaSet(t,e){const n=this.portal;return n.fetchSelf(n.authMode,!0,e).then(r=>{const i=r.contentCategorySetsGroupQuery;if(i){const s=new as({disableExtraQuery:!0,num:1,query:i});return n.queryGroups(s,e)}throw new Xe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const i=r.results[0],s=new as({num:1,query:`typekeywords:"${t}"`});return i.queryItems(s,e)}throw new Xe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(i=>{const s=i?.categorySchema;return s?.length?s:[]}):[])}};_([E()],Ui.prototype,"access",void 0),_([E({type:Date})],Ui.prototype,"created",void 0),_([E()],Ui.prototype,"description",void 0),_([E()],Ui.prototype,"id",void 0),_([E()],Ui.prototype,"isInvitationOnly",void 0),_([E({type:Date})],Ui.prototype,"modified",void 0),_([E()],Ui.prototype,"owner",void 0),_([E()],Ui.prototype,"portal",void 0),_([E()],Ui.prototype,"snippet",void 0),_([E()],Ui.prototype,"sortField",void 0),_([E()],Ui.prototype,"sortOrder",void 0),_([E()],Ui.prototype,"sourceJSON",void 0),_([E()],Ui.prototype,"tags",void 0),_([E()],Ui.prototype,"thumbnail",void 0),_([E({readOnly:!0})],Ui.prototype,"thumbnailUrl",null),_([E()],Ui.prototype,"title",void 0),_([E({readOnly:!0})],Ui.prototype,"url",null),Ui=LF=_([ue("esri.portal.PortalGroup")],Ui);let U0=class extends Kt{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};_([E()],U0.prototype,"nextQueryParams",void 0),_([E()],U0.prototype,"queryParams",void 0),_([E()],U0.prototype,"results",void 0),_([E()],U0.prototype,"total",void 0),U0=_([ue("esri.portal.PortalQueryResult")],U0);let hf=class extends qt{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Xe("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};_([E({type:Date})],hf.prototype,"created",void 0),_([E()],hf.prototype,"id",void 0),_([E()],hf.prototype,"portal",void 0),_([E()],hf.prototype,"title",void 0),_([E({readOnly:!0})],hf.prototype,"url",null),_([E()],hf.prototype,"username",void 0),hf=_([ue("esri.portal.PortalFolder")],hf);var DF;let $r=DF=class extends qt{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,n=t?.data,r=t?.folder,i={method:"post"};e&&(i.query=e.createPostQuery(),n!=null&&(typeof n=="string"?i.query.text=n:typeof n=="object"&&(i.query.text=JSON.stringify(n))));let s=this.userContentUrl;return r&&(s+="/"+(typeof r=="string"?r:r.id)),this.portal.request(s+"/addItem",i).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let n=this.userContentUrl;t.ownerFolder&&(n+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(n+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const n=this.userContentUrl+"/deleteItems",r=[],i=t.map(s=>s.id);if(i.length){const s={method:"post",query:{items:i.join(","),permanentDelete:e}},o=await this.portal.request(n,s);for(const a of o.results){const l=t.find(h=>a.itemId===h.id),c=a.success;let u=null;c?(l.id=null,l.portal=null):a.error&&(u=new Xe("portal:delete-item-failed",a.error.message,a.error)),r.push({item:l,success:c,error:u})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let n;return n=e&&e.folders?e.folders.map(r=>{const i=hf.fromJSON(r);return i.portal=this.portal,i}):[],n})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(n=>{const r=Ui.fromJSON(n);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:n}=await _e(()=>Promise.resolve().then(()=>_pe),void 0),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},i=await this.portal.request(e,{query:r});let s;return i?.items?(s=i.items.map(o=>{const a=n.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(s.map(o=>o.load())),{items:s,nextStart:i.nextStart,total:i.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Ui({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Xe("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const n=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(n+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new Xe("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new DF({sourceJSON:t});return e.read(t),e}};_([E()],$r.prototype,"access",void 0),_([E({type:Date})],$r.prototype,"created",void 0),_([E()],$r.prototype,"culture",void 0),_([E()],$r.prototype,"description",void 0),_([E()],$r.prototype,"email",void 0),_([E()],$r.prototype,"favGroupId",void 0),_([E()],$r.prototype,"fullName",void 0),_([E()],$r.prototype,"id",void 0),_([E({type:Date})],$r.prototype,"modified",void 0),_([E()],$r.prototype,"orgId",void 0),_([E()],$r.prototype,"portal",void 0),_([E()],$r.prototype,"preferredView",void 0),_([E()],$r.prototype,"privileges",void 0),_([E()],$r.prototype,"region",void 0),_([E()],$r.prototype,"role",void 0),_([E()],$r.prototype,"roleId",void 0),_([E()],$r.prototype,"sourceJSON",void 0),_([E()],$r.prototype,"thumbnail",void 0),_([E({readOnly:!0})],$r.prototype,"thumbnailUrl",null),_([E()],$r.prototype,"units",void 0),_([E({readOnly:!0})],$r.prototype,"userContentUrl",null),_([E({readOnly:!0})],$r.prototype,"url",null),_([E()],$r.prototype,"username",void 0),_([E()],$r.prototype,"userLicenseTypeId",void 0),_([E()],$r.prototype,"userType",void 0),$r=DF=_([ue("esri.portal.PortalUser")],$r);var jl;let pE;const XQ={PortalGroup:()=>Promise.resolve({default:Ui}),PortalItem:()=>_e(()=>Promise.resolve().then(()=>_pe),void 0),PortalUser:()=>Promise.resolve({default:$r})};var td;let it=(td=class extends Xg(iI){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Qn.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){ZQ.unregister(this),this.defaultBasemap=Mi(this.defaultBasemap),this.defaultDevBasemap=Mi(this.defaultDevBasemap),this.defaultVectorBasemap=Mi(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Qr(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const n of e)Qn.request.trustedServers.includes(n)||Qn.request.trustedServers.push(n);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,n=!e||this.canSearchPublic;return this.id&&!n?` AND orgid:${this.id}`:null}get hasAPIKey(){return u6e(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const n=e.indexOf("/sharing");e=n>0?e.slice(0,n):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,n=this.thumbnail;return e&&n?this._normalizeSSL(e+"/portals/self/resources/"+n):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let n=null;return e&&(n=$r.fromJSON(e),n.portal=this),n}load(e){const n=_e(async()=>{const{default:r}=await Promise.resolve().then(()=>eVe);return{default:r}},void 0).then(({default:r})=>{hi(e),pE=r}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(r=>{if(!this.hasAPIKey&&Kr){const i=Kr;this.credential=i.findCredential(this.restUrl),this.credential||this.authMode!==jl.AUTH_MODE_AUTO&&this.authMode!==jl.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=i.on("credential-create",iFe(new WeakRef(this))),ZQ.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(n),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),n=(await _e(async()=>{const{default:r}=await import("./ElevationLayer-CqNA76vi.js");return{default:r}},__vite__mapDeps([87,2,88,89,90,35,36,49,54,5,6,7,8,59,60,91]))).default;return e?e.map(r=>new n({id:r.id,url:r.url})):[]}async fetchBasemaps(e,n){const r=await this._fetchBasemaps(e,n);if(n?.include3d===!0&&this.use3dBasemaps!==!1){const i=await this._fetchBasemaps3D(e,n);r.unshift(...i)}return r}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const n=new as;n.query=this.default3DBasemapQuery,n.disableExtraQuery=!0;const r=(await this.queryItems(n,e)).results.find(i=>i.type==="Web Scene");return r?new pE({portalItem:r}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(n=>n.categorySchema):ha(e)?Promise.reject(Tr()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(n=>n.classificationSchema):null}fetchFeaturedGroups(e){const n=this.featuredGroups,r=new as({num:100,sortField:"title"});if(n?.length){const i=[];for(const s of n)i.push(`(title:"${s.title}" AND owner:${s.owner})`);return r.query=i.join(" OR "),this.queryGroups(r,e).then(s=>s.results)}return ha(e)?Promise.reject(Tr()):Promise.resolve([])}fetchRegions(e){const n=this.user?.culture||this.culture||eu();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:n}})}fetchSettings(e){const n=this.user?.culture||this.culture||eu();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:n}})}static getDefault(){return nFe(()=>new jl)}queryGroups(e,n){return this.queryPortal("/community/groups",e,"PortalGroup",n)}queryItems(e,n){return this.queryPortal("/search",e,"PortalItem",n)}queryUsers(e,n){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",n)}fetchSelf(e=this.authMode,n=!1,r){const i=this.restUrl+"/portals/self",s={authMode:e,query:{culture:eu().toLowerCase()},withCredentials:!0,...r};return s.authMode==="auto"&&(s.authMode="no-prompt"),n&&(s.query.default=!0),this.request(i,s)}queryPortal(e,n,r,i){const s=Va(as,n),o=a=>this.request(this.restUrl+e,{...s.toRequestOptions(this),...i}).then(l=>{const c=s.clone();return c.start=l.nextStart,new U0({nextQueryParams:c,queryParams:s,total:l.total,results:jl._resultsToTypedArray(a,{portal:this},l,i)})}).then(l=>Promise.all(l.results.map(c=>typeof c.when=="function"?c.when():l)).then(()=>l,c=>(Dde(c),l)));return r&&XQ[r]?XQ[r]().then(({default:a})=>(hi(i),o(a))):o()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new Xe("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===jl.AUTH_MODE_ANONYMOUS||this.authMode===jl.AUTH_MODE_NO_PROMPT&&!Kr)return Promise.reject(new Xe("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=n=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(n||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=n,this.fetchSelf("immediate"))):this.user&&this.credential===n?null:(this.credential=n,this.fetchSelf("immediate"))).then(r=>{r&&(this.sourceJSON=r,this.read(r))});return Kr?Kr.getCredential(this.restUrl,{prompt:this.authMode!==jl.AUTH_MODE_NO_PROMPT}).then(n=>e(n)):e(this.credential)}normalizeUrl(e){const n=this.credential?.token;return this._normalizeSSL(n?e+(e.includes("?")?"&":"?")+"token="+n:e)}requestToTypedArray(e,n,r){return this.request(e,n).then(i=>{const s=jl._resultsToTypedArray(r,{portal:this},i);return Promise.all(s.map(o=>typeof o.when=="function"?o.when():i)).then(()=>s,()=>s)})}request(e,n={}){const r={f:"json",...n.query},{authMode:i=this.authMode===jl.AUTH_MODE_ANONYMOUS||this.authMode===jl.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:s=null,cacheBust:o=!1,method:a="auto",responseType:l="json",signal:c}=n,u={authMode:i,body:s,cacheBust:o,method:a,query:r,responseType:l,timeout:0,signal:c};return n.withCredentials&&(u.withCredentials=!0),Qi(this._normalizeSSL(e),u).then(h=>h.data)}toJSON(){throw new Xe("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new jl({sourceJSON:e})}_getHelperService(e){const n=this.helperServices?.[e];if(!n)throw new Xe("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return n}async _fetchBasemaps(e,n){const r=new as;r.query=e||(dF()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const i=await this.queryGroups(r,n);if(!i.total)return[];const s=i.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=s.sortField||"name",r.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(r,n);return o.total?o.results.filter(a=>a.type==="Web Map").map(a=>new pE({portalItem:a})):[]}async _fetchBasemaps3D(e,n){const r=e||this.basemapGalleryGroupQuery3D;if(!r)return[];if(dF())return[];const i=new as({query:r,disableExtraQuery:!0}),s=await this.queryGroups(i,n);if(!s.total)return[];const o=s.results[0];i.num=100,i.query='type:"Web Scene"',i.sortField=o.sortField||"name",i.sortOrder=o.sortOrder||"desc";const a=await o.queryItems(i,n);return a.total?a.results.filter(l=>l.type==="Web Scene").map(l=>new pE({portalItem:l})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const n=pE.fromJSON(e);return n.portalItem={portal:this},n}return null}static _resultsToTypedArray(e,n,r,i){let s;if(r){const o=i!=null?i.signal:null;s=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||n)&&(s=s.map(a=>{const l=Object.assign(e?e.fromJSON(a):a,n);return typeof l.load=="function"&&l.load(o),l}))}else s=[];return s}},jl=td,td.AUTH_MODE_ANONYMOUS="anonymous",td.AUTH_MODE_AUTO="auto",td.AUTH_MODE_IMMEDIATE="immediate",td.AUTH_MODE_NO_PROMPT="no-prompt",td);_([E()],it.prototype,"access",void 0),_([E()],it.prototype,"allSSL",void 0),_([E()],it.prototype,"authMode",void 0),_([E()],it.prototype,"authorizedCrossOriginDomains",void 0),_([or("authorizedCrossOriginDomains")],it.prototype,"readAuthorizedCrossOriginDomains",null),_([E()],it.prototype,"basemapGalleryGroupQuery",void 0),_([E({json:{name:"3DBasemapGalleryGroupQuery"}})],it.prototype,"basemapGalleryGroupQuery3D",void 0),_([E({json:{name:"g3DTilesGalleryGroupQuery"}})],it.prototype,"g3DTilesGalleryGroupQuery",void 0),_([E({json:{name:"g3dTilesEnabled"}})],it.prototype,"g3dTilesEnabled",void 0),_([E()],it.prototype,"bingKey",void 0),_([E()],it.prototype,"canListApps",void 0),_([E()],it.prototype,"canListData",void 0),_([E()],it.prototype,"canListPreProvisionedItems",void 0),_([E()],it.prototype,"canProvisionDirectPurchase",void 0),_([E()],it.prototype,"canSearchPublic",void 0),_([E()],it.prototype,"canShareBingPublic",void 0),_([E()],it.prototype,"canSharePublic",void 0),_([E()],it.prototype,"canSignInArcGIS",void 0),_([E()],it.prototype,"canSignInIDP",void 0),_([E()],it.prototype,"colorSetsGroupQuery",void 0),_([E()],it.prototype,"commentsEnabled",void 0),_([E({type:Date})],it.prototype,"created",void 0),_([E()],it.prototype,"credential",void 0),_([E()],it.prototype,"culture",void 0),_([E()],it.prototype,"currentVersion",void 0),_([E()],it.prototype,"customBaseUrl",void 0),_([E()],it.prototype,"default3DBasemapQuery",void 0),_([E()],it.prototype,"defaultBasemap",void 0),_([or("defaultBasemap")],it.prototype,"readDefaultBasemap",null),_([E()],it.prototype,"defaultDevBasemap",void 0),_([or("defaultDevBasemap")],it.prototype,"readDefaultDevBasemap",null),_([E({type:Dn})],it.prototype,"defaultExtent",void 0),_([E()],it.prototype,"defaultVectorBasemap",void 0),_([or("defaultVectorBasemap")],it.prototype,"readDefaultVectorBasemap",null),_([E()],it.prototype,"description",void 0),_([E()],it.prototype,"devBasemapGalleryGroupQuery",void 0),_([E()],it.prototype,"eueiEnabled",void 0),_([E({readOnly:!0})],it.prototype,"extraQuery",null),_([E()],it.prototype,"featuredGroups",void 0),_([E()],it.prototype,"featuredItemsGroupQuery",void 0),_([E()],it.prototype,"galleryTemplatesGroupQuery",void 0),_([E()],it.prototype,"layoutGroupQuery",void 0),_([E()],it.prototype,"livingAtlasGroupQuery",void 0),_([E({readOnly:!0})],it.prototype,"hasAPIKey",null),_([E()],it.prototype,"hasCategorySchema",void 0),_([E()],it.prototype,"hasClassificationSchema",void 0),_([E()],it.prototype,"helpBase",void 0),_([E()],it.prototype,"helperServices",void 0),_([E()],it.prototype,"helpMap",void 0),_([E()],it.prototype,"homePageFeaturedContent",void 0),_([E()],it.prototype,"homePageFeaturedContentCount",void 0),_([E()],it.prototype,"httpPort",void 0),_([E()],it.prototype,"httpsPort",void 0),_([E()],it.prototype,"id",void 0),_([E()],it.prototype,"ipCntryCode",void 0),_([E({readOnly:!0})],it.prototype,"isOrganization",null),_([E()],it.prototype,"isPortal",void 0),_([E()],it.prototype,"isReadOnly",void 0),_([E({readOnly:!0})],it.prototype,"itemPageUrl",null),_([E()],it.prototype,"layerTemplatesGroupQuery",void 0),_([E()],it.prototype,"maxTokenExpirationMinutes",void 0),_([E({type:Date})],it.prototype,"modified",void 0),_([E()],it.prototype,"name",void 0),_([E()],it.prototype,"portalHostname",void 0),_([E()],it.prototype,"portalMode",void 0),_([E()],it.prototype,"portalProperties",void 0),_([E()],it.prototype,"region",void 0),_([E()],it.prototype,"recycleBinEnabled",void 0),_([E({readOnly:!0})],it.prototype,"restUrl",null),_([E()],it.prototype,"rotatorPanels",void 0),_([E()],it.prototype,"showHomePageDescription",void 0),_([E()],it.prototype,"sourceJSON",void 0),_([E()],it.prototype,"staticImagesUrl",void 0),_([E({json:{name:"2DStylesGroupQuery"}})],it.prototype,"stylesGroupQuery2d",void 0),_([E({json:{name:"stylesGroupQuery"}})],it.prototype,"stylesGroupQuery3d",void 0),_([E()],it.prototype,"supportsHostedServices",void 0),_([E()],it.prototype,"symbolSetsGroupQuery",void 0),_([E()],it.prototype,"templatesGroupQuery",void 0),_([E()],it.prototype,"thumbnail",void 0),_([E({readOnly:!0})],it.prototype,"thumbnailUrl",null),_([E()],it.prototype,"units",void 0),_([E()],it.prototype,"url",void 0),_([E()],it.prototype,"urlKey",void 0),_([or("urlKey")],it.prototype,"readUrlKey",null),_([E()],it.prototype,"user",void 0),_([or("user")],it.prototype,"readUser",null),_([E()],it.prototype,"use3dBasemaps",void 0),_([E()],it.prototype,"useDefault3dBasemap",void 0),_([E()],it.prototype,"useStandardizedQuery",void 0),_([E()],it.prototype,"useVectorBasemaps",void 0),_([E()],it.prototype,"vectorBasemapGalleryGroupQuery",void 0),it=jl=_([ue("esri.portal.Portal")],it);const ZQ=new FinalizationRegistry(t=>{t.remove()});function iFe(t){const e=Kr;return()=>{const n=t.deref();n&&e.findCredential(n.restUrl)&&n.signIn().catch(()=>{})}}let df=class extends Kt{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:JQ(e.path,e.portalItem)}:e}set path(e){e!=null&&vl(e)?Tt.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return JQ(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",n){const r=this.cdnUrl;if(r==null)throw new Xe("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:e,query:{token:this.portalItem.apiKey,_ts:n?.cacheBust?Date.now():null},signal:n?.signal})}async update(e,n){const{addOrUpdateResources:r}=await _e(()=>import("./resourceUtils-BnGKovJC.js"),[]);return await r(this.portalItem,[{resource:this,content:e,compress:n?.compress,access:n?.access}],"update",n),this}hasPath(){return this.path!=null}};function JQ(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&vl(t)&&(t=_G(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}_([E()],df.prototype,"portalItem",void 0),_([E({type:String,value:null})],df.prototype,"path",null),_([zs("path")],df.prototype,"_castPath",null),_([E({type:String,readOnly:!0})],df.prototype,"url",null),_([E({type:String,readOnly:!0})],df.prototype,"cdnUrl",null),_([E({type:String,readOnly:!0})],df.prototype,"itemRelativeUrl",null),df=_([ue("esri.portal.PortalItemResource")],df);let Ry=class extends Kt{constructor(e){super(e),this.created=null,this.rating=null}};_([E({type:Date})],Ry.prototype,"created",void 0),_([E()],Ry.prototype,"rating",void 0),Ry=_([ue("esri.portal.PortalRating")],Ry);var G0;const sFe=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),oFe=new Set(["KML","GeoJson","CSV"]);let vn=G0=class extends Xg(iI){static from(t){return nO(G0,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let n=t;return t==="Feature Service"||t==="Feature Collection"?n=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?n=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?n="Scene Layer":t==="Video Service"?n="Video Layer":t==="Scene Package"?n="Scene Layer Package":t==="Stream Service"?n="Feature Layer":t==="Geoprocessing Service"?n=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?n="GeoEnrichment Service":t==="Geocoding Service"?n="Locator":t==="Microsoft Powerpoint"?n="Microsoft PowerPoint":t==="GeoJson"?n="GeoJSON":t==="Globe Service"?n="Globe Layer":t==="Vector Tile Service"?n="Tile Layer":t==="netCDF"?n="NetCDF":t==="Map Service"?n=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?n=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?n="Big Data File Share":t==="Compact Tile Package"?n="Tile Package (tpkx)":t==="Raster function template"?n="Raster Function Template":t==="OGCFeatureServer"?n="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?n="Instant App":t==="Insights Page"?n="Insights Report":t==="Excalibur Imagery Project"?n="Excalibur Project":t==="3DTiles Service"?n="3D tiles layer":t==="3DTiles Package"&&(n="3D tiles package"),n}readExtent(t){return t&&t.length?new Dn(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],n="esri/images/portal/",r="16";let i,s=!1,o=!1,a=!1,l=!1,c=!1,u=!1,h=!1,f=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(s=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),c=e.includes("Spatiotemporal"),u=e.includes("UtilityNetwork"),i=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":c?"spatiotemporal":u?"utilitynetwork":s?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(c=e.includes("Spatiotemporal"),h=e.includes("Relational"),i=c||h?"mapimages":s||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):i=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":e.includes("GaussianSplat")?"gaussiansplatlayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?i="maps":t==="web scene"?i=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?i="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?i="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?i="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?i="datafiles":t==="360 vr experience"?i="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?i="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?i="addindesktop":t==="pdf"?i="pdf":t==="microsoft word"?i="word":t==="microsoft excel"?i="excel":t==="microsoft powerpoint"?i="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?i="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?i="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?i="layersgray":t==="analysis model"?i="analysismodel":t==="scene package"?i="scenepackage":t==="3dtiles package"?i="3dtileslayerpackage":t==="3dtiles service"?i="3dtileslayer":t==="mobile scene package"?i="mobilescenepackage":t==="tile package"||t==="compact tile package"?i="tilepackage":t==="task file"?i="taskfile":t==="report template"?i="report-template":t==="statistical data collection"?i="statisticaldatacollection":t==="insights workbook"?i="workbook":t==="insights model"?i="insightsmodel":t==="insights page"?i="insightspage":t==="insights theme"?i="insightstheme":t==="hub initiative"?i="hubinitiative":t==="hub page"?i="hubpage":t==="hub site application"?i="hubsite":t==="hub event"?i="hubevent":t==="hub project"?i="hubproject":t==="relational database connection"?i="relationaldatabaseconnection":t==="big data file share"?i="datastorecollection":t==="image collection"?i="imagecollection":t==="desktop style"?i="desktopstyle":t==="style"?i=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?i="dashboard":t==="raster function template"?i="rasterprocessingtemplate":t==="vector tile package"?i="vectortilepackage":t==="ortho mapping project"?i="orthomappingproject":t==="ortho mapping template"?i="orthomappingtemplate":t==="solution"?i="solutions":t==="geopackage"?i="geopackage":t==="deep learning package"?i="deeplearningpackage":t==="real time analytic"?i="realtimeanalytics":t==="reality mapping project"?i="realitymappingproject":t==="big data analytic"?i="bigdataanalytics":t==="feed"?i="feed":t==="excalibur imagery project"?i="excaliburimageryproject":t==="notebook"?i="notebook":t==="storymap"?i="storymap":t==="survey123 add in"?i="survey123addin":t==="mission"?i="mission":t==="mission report"?i="missionreport":t==="mission template"?i="missiontemplate":t==="quickcapture project"?i="quickcaptureproject":t==="pro report"?i="proreport":t==="pro report template"?i="proreporttemplate":t==="urban model"?i="urbanmodel":t==="urban project"?i="urbanproject":t==="web experience"?i="experiencebuilder":t==="web experience template"?i="webexperiencetemplate":t==="experience builder widget"?i="experiencebuilderwidget":t==="experience builder widget package"?i="experiencebuilderwidgetpackage":t==="workflow"?i="workflow":t==="kernel gateway connection"?i="kernelgatewayconnection":t==="insights script"?i="insightsscript":t==="hub initiative template"?i="hubinitiativetemplate":t==="storymap theme"?i="storymaptheme":t==="knowledge graph"?i="knowledgegraph":t==="knowledge graph layer"?i="knowledgegraphlayer":t==="knowledge studio project"?i="knowledgestudio":t==="native application"?i="nativeapp":t==="native application installer"?i="nativeappinstaller":t==="web link chart"?i="linkchart":t==="knowledge graph web investigation"?i="investigation":t==="ogcfeatureserver"?i="features":t==="pro presentation"?i="propresentation":t==="pro project"?i="proproject":t==="insights workbook package"?i="insightsworkbookpackage":t==="apache parquet"?i="apacheparquet":t==="notebook code snippet library"?i="notebookcodesnippets":t==="suitability model"?i="suitabilitymodel":t==="esri classifier definition"?i="classifierdefinition":t==="esri classification schema"?i="classificationschema":t==="insights data engineering workbook"?i="dataengineeringworkbook":t==="insights data engineering model"?i="dataengineeringmodel":t==="deep learning studio project"?i="deeplearningproject":t==="discussion"?i="discussion":t==="allsource project"?i="allsourceproject":t==="api key"?i="apikey":t==="data pipeline"?i="datapipelines":t==="group layer"?(f=e.includes("Map"),i=f?"layergroup2d":"layergroup"):i=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":t==="xr experience"?"xrexperience":"maps",i?Gi(n+i+r+".png"):null}get isLayer(){return this.type!=null&&sFe.has(this.type)}get itemCdnUrl(){return TG(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get loaded(){return super.loaded}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=it.getDefault()),n=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(n),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},n=t instanceof Ry?t.rating:t;return n==null||isNaN(n)||typeof t!="number"||(e.query.rating=n),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new Ry({rating:n,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:Ze(this.applicationProxies),avgRating:this.avgRating,categories:Ze(this.categories),classification:Ze(this.classification),created:Ze(this.created),culture:this.culture,description:this.description,extent:Ze(this.extent),groupCategories:Ze(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:Ze(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:Ze(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:Ze(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Ze(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new G0({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const n=t[e];n&&(t[e]=JSON.stringify(n))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new Ry(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},G0)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t?.data,n={method:"post"};n.query=this.createPostQuery();for(const r in n.query)n.query[r]===null&&(n.query[r]="");return n.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?n.query.text=e:typeof e=="object"&&(n.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,n).then(()=>this.reload())}):Promise.reject(new Xe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new Xe("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:n}=this;await e.signIn();const{copyResources:r,folder:i,tags:s,title:o}=t||{},a={method:"post",query:{copyPrivateResources:r==="all",folder:typeof i=="string"?i:i?.id,includeResources:!!r,tags:s?.join(","),title:o}},{itemId:l}=await e.request(`${n}/copy`,a);return new G0({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,n=t.filename,r={method:"post"};if(typeof e=="string")nv(e)?r.query={data:e}:r.query={url:Bc(e)},n!=null&&(r.query.filename=n);else{const i=new FormData;n!=null?i.append("file",e,n):i.append("file",e),r.body=i}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new Xe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:n}=await _e(()=>import("./resourceUtils-BnGKovJC.js"),[]);return n(this,t,e)}async addResource(t,e,n){const{addOrUpdateResources:r}=await _e(()=>import("./resourceUtils-BnGKovJC.js"),[]);return t.portalItem=this,await r(this,[{resource:t,content:e,compress:n?.compress,access:n?.access}],"add",n),t}async removeResource(t,e){const{removeResource:n}=await _e(()=>import("./resourceUtils-BnGKovJC.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Xe("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return n(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await _e(()=>import("./resourceUtils-BnGKovJC.js"),[]);return e(this,t)}resourceFromPath(t){return new df({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:Ze(this.categories),classification:Ze(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:Ze(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Ze(this.typeKeywords),url:this.url};return oDe(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new G0({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};_([E({type:["private","shared","org","public"]})],vn.prototype,"access",void 0),_([E()],vn.prototype,"accessInformation",void 0),_([E({type:String})],vn.prototype,"apiKey",void 0),_([E({json:{read:{source:"appProxies"}}})],vn.prototype,"applicationProxies",void 0),_([E()],vn.prototype,"avgRating",void 0),_([E()],vn.prototype,"categories",void 0),_([E()],vn.prototype,"classification",void 0),_([E({type:Date})],vn.prototype,"created",void 0),_([E()],vn.prototype,"culture",void 0),_([E()],vn.prototype,"description",void 0),_([E({readOnly:!0})],vn.prototype,"displayName",null),_([E({type:Dn})],vn.prototype,"extent",void 0),_([or("extent")],vn.prototype,"readExtent",null),_([E()],vn.prototype,"groupCategories",void 0),_([E({readOnly:!0})],vn.prototype,"iconUrl",null),_([E()],vn.prototype,"id",void 0),_([E({readOnly:!0})],vn.prototype,"isLayer",null),_([E({type:Boolean,readOnly:!0})],vn.prototype,"isOrgItem",void 0),_([E()],vn.prototype,"itemControl",void 0),_([E({readOnly:!0})],vn.prototype,"itemPageUrl",null),_([E({readOnly:!0})],vn.prototype,"itemUrl",null),_([E()],vn.prototype,"licenseInfo",void 0),_([E({type:Date})],vn.prototype,"modified",void 0),_([E()],vn.prototype,"name",void 0),_([E()],vn.prototype,"numComments",void 0),_([E()],vn.prototype,"numRatings",void 0),_([E()],vn.prototype,"numViews",void 0),_([E()],vn.prototype,"owner",void 0),_([E()],vn.prototype,"ownerFolder",void 0),_([E({type:it})],vn.prototype,"portal",void 0),_([E()],vn.prototype,"screenshots",void 0),_([E()],vn.prototype,"size",void 0),_([E()],vn.prototype,"snippet",void 0),_([E()],vn.prototype,"sourceJSON",void 0),_([E({type:String})],vn.prototype,"sourceUrl",void 0),_([E({type:String})],vn.prototype,"spatialReference",void 0),_([E()],vn.prototype,"tags",void 0),_([E()],vn.prototype,"thumbnail",void 0),_([E({readOnly:!0})],vn.prototype,"thumbnailUrl",null),_([E()],vn.prototype,"title",void 0),_([E()],vn.prototype,"type",void 0),_([E()],vn.prototype,"typeKeywords",void 0),_([E({type:String,json:{read(t,e){if(oFe.has(e.type)){const n=this.portal?.restUrl;t||=n&&this.id?`${n}/content/items/${this.id}/data`:null}return t}}})],vn.prototype,"url",void 0),_([E({readOnly:!0})],vn.prototype,"userItemUrl",null),vn=G0=_([ue("esri.portal.PortalItem")],vn);const _pe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return vn}},Symbol.toStringTag,{value:"Module"})),xpe={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function aFe(t){return t in xpe}function QQ(t){if(aFe(t)){const e=xpe[t];return e===!0?t:e}return null}const XE=[],Wx=new Map;function eee(t){for(const e of Wx.keys())Epe(t.pattern,e)&&Wx.delete(e)}function lFe(t){return XE.includes(t)||(eee(t),XE.unshift(t)),qn(()=>{const e=XE.indexOf(t);e>-1&&(XE.splice(e,1),eee(t))})}async function wpe(t){const e=eu();Wx.has(t)||Wx.set(t,cFe(t,e));const n=Wx.get(t);return n&&await uFe.add(n),n}function bpe(t){const e=ZG(t);return e?QQ(t)??QQ(e):null}async function cFe(t,e){const n=[];for(const r of XE)if(Epe(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(i){n.push(i)}throw n.length?new Xe("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:n}):new Xe("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function Epe(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}JG(()=>{Wx.clear()});const uFe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=uc())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function hFe(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,n=await wpe("esri/t9n/basemaps");return n[t]||n[e]}const $F={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Gi("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Gi("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Gi("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Gi("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Gi("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Gi("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}},Id="system",QG="unknown",Tk="UTC",dFe=Intl.DateTimeFormat().resolvedOptions().timeZone,tee=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class sv extends Error{}class fFe extends sv{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class pFe extends sv{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class mFe extends sv{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class px extends sv{}class Spe extends sv{constructor(e){super(`Invalid unit ${e}`)}}class Qo extends sv{}class am extends sv{constructor(){super("Zone is an abstract class")}}const Pt="numeric",ch="short",oc="long",E4={year:Pt,month:Pt,day:Pt},Tpe={year:Pt,month:ch,day:Pt},gFe={year:Pt,month:ch,day:Pt,weekday:ch},kpe={year:Pt,month:oc,day:Pt},Ape={year:Pt,month:oc,day:Pt,weekday:oc},Ipe={hour:Pt,minute:Pt},Rpe={hour:Pt,minute:Pt,second:Pt},Ppe={hour:Pt,minute:Pt,second:Pt,timeZoneName:ch},Cpe={hour:Pt,minute:Pt,second:Pt,timeZoneName:oc},Mpe={hour:Pt,minute:Pt,hourCycle:"h23"},Npe={hour:Pt,minute:Pt,second:Pt,hourCycle:"h23"},Ope={hour:Pt,minute:Pt,second:Pt,hourCycle:"h23",timeZoneName:ch},Lpe={hour:Pt,minute:Pt,second:Pt,hourCycle:"h23",timeZoneName:oc},Dpe={year:Pt,month:Pt,day:Pt,hour:Pt,minute:Pt},$pe={year:Pt,month:Pt,day:Pt,hour:Pt,minute:Pt,second:Pt},jpe={year:Pt,month:ch,day:Pt,hour:Pt,minute:Pt},Fpe={year:Pt,month:ch,day:Pt,hour:Pt,minute:Pt,second:Pt},yFe={year:Pt,month:ch,day:Pt,weekday:ch,hour:Pt,minute:Pt},Vpe={year:Pt,month:oc,day:Pt,hour:Pt,minute:Pt,timeZoneName:ch},zpe={year:Pt,month:oc,day:Pt,hour:Pt,minute:Pt,second:Pt,timeZoneName:ch},Upe={year:Pt,month:oc,day:Pt,weekday:oc,hour:Pt,minute:Pt,timeZoneName:oc},Gpe={year:Pt,month:oc,day:Pt,weekday:oc,hour:Pt,minute:Pt,second:Pt,timeZoneName:oc};class oI{get type(){throw new am}get name(){throw new am}get ianaName(){return this.name}get isUniversal(){throw new am}offsetName(e,n){throw new am}formatOffset(e,n){throw new am}offset(e){throw new am}equals(e){throw new am}get isValid(){throw new am}}let a$=null;class hO extends oI{static get instance(){return a$===null&&(a$=new hO),a$}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return eme(e,n,r)}formatOffset(e,n){return QS(this.offset(e),n)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const jF=new Map;function vFe(t){let e=jF.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),jF.set(t,e)),e}const _Fe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function xFe(t,e){const n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,i,s,o,a,l,c,u]=r;return[o,i,s,a,l,c,u]}function wFe(t,e){const n=t.formatToParts(e),r=[];for(let i=0;i<n.length;i++){const{type:s,value:o}=n[i],a=_Fe[s];s==="era"?r[a]=o:Sn(a)||(r[a]=parseInt(o,10))}return r}const l$=new Map;class uh extends oI{static create(e){let n=l$.get(e);return n===void 0&&l$.set(e,n=new uh(e)),n}static resetCache(){l$.clear(),jF.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=uh.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return eme(e,n,r,this.name)}formatOffset(e,n){return QS(this.offset(e),n)}offset(e){if(!this.valid)return NaN;const n=new Date(e);if(isNaN(n))return NaN;const r=vFe(this.name);let[i,s,o,a,l,c,u]=r.formatToParts?wFe(r,n):xFe(r,n);a==="BC"&&(i=-Math.abs(i)+1);const f=fO({year:i,month:s,day:o,hour:l===24?0:l,minute:c,second:u,millisecond:0});let g=+n;const v=g%1e3;return g-=v>=0?v:1e3+v,(f-g)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let nee={};function bFe(t,e={}){const n=JSON.stringify([t,e]);let r=nee[n];return r||(r=new Intl.ListFormat(t,e),nee[n]=r),r}const FF=new Map;function VF(t,e={}){const n=JSON.stringify([t,e]);let r=FF.get(n);return r===void 0&&(r=new Intl.DateTimeFormat(t,e),FF.set(n,r)),r}const zF=new Map;function EFe(t,e={}){const n=JSON.stringify([t,e]);let r=zF.get(n);return r===void 0&&(r=new Intl.NumberFormat(t,e),zF.set(n,r)),r}const UF=new Map;function SFe(t,e={}){const{base:n,...r}=e,i=JSON.stringify([t,r]);let s=UF.get(i);return s===void 0&&(s=new Intl.RelativeTimeFormat(t,e),UF.set(i,s)),s}let ZE=null;function TFe(){return ZE||(ZE=new Intl.DateTimeFormat().resolvedOptions().locale,ZE)}const GF=new Map;function Bpe(t){let e=GF.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),GF.set(t,e)),e}const BF=new Map;function kFe(t){let e=BF.get(t);if(!e){const n=new Intl.Locale(t);e="getWeekInfo"in n?n.getWeekInfo():n.weekInfo,"minimalDays"in e||(e={...Wpe,...e}),BF.set(t,e)}return e}function AFe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const n=t.indexOf("-u-");if(n===-1)return[t];{let r,i;try{r=VF(t).resolvedOptions(),i=t}catch{const l=t.substring(0,n);r=VF(l).resolvedOptions(),i=l}const{numberingSystem:s,calendar:o}=r;return[i,s,o]}}function IFe(t,e,n){return(n||e)&&(t.includes("-u-")||(t+="-u"),n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`)),t}function RFe(t){const e=[];for(let n=1;n<=12;n++){const r=hn.utc(2009,n,1);e.push(t(r))}return e}function PFe(t){const e=[];for(let n=1;n<=7;n++){const r=hn.utc(2016,11,13+n);e.push(t(r))}return e}function vP(t,e,n,r){const i=t.listingMode();return i==="error"?null:i==="en"?n(e):r(e)}function CFe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||Bpe(t.locale).numberingSystem==="latn"}class MFe{constructor(e,n,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:i,floor:s,...o}=r;if(!n||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=EFe(e,a)}}format(e){if(this.inf){const n=this.floor?Math.floor(e):e;return this.inf.format(n)}else{const n=this.floor?Math.floor(e):iB(e,3);return _s(n,this.padTo)}}}class NFe{constructor(e,n,r){this.opts=r,this.originalZone=void 0;let i;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&uh.create(a).valid?(i=a,this.dt=e):(i="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,i=e.zone.name):(i="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||i,this.dtf=VF(n,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(n=>{if(n.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...n,value:r}}else return n}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class OFe{constructor(e,n,r){this.opts={style:"long",...r},!n&&Jpe()&&(this.rtf=SFe(e,r))}format(e,n){return this.rtf?this.rtf.format(e,n):n9e(n,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,n){return this.rtf?this.rtf.formatToParts(e,n):[]}}const Wpe={firstDay:1,minimalDays:4,weekend:[6,7]};class Mr{static fromOpts(e){return Mr.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,n,r,i,s=!1){const o=e||qi.defaultLocale,a=o||(s?"en-US":TFe()),l=n||qi.defaultNumberingSystem,c=r||qi.defaultOutputCalendar,u=HF(i)||qi.defaultWeekSettings;return new Mr(a,l,c,u,o)}static resetCache(){ZE=null,FF.clear(),zF.clear(),UF.clear(),GF.clear(),BF.clear()}static fromObject({locale:e,numberingSystem:n,outputCalendar:r,weekSettings:i}={}){return Mr.create(e,n,r,i)}constructor(e,n,r,i,s){const[o,a,l]=AFe(e);this.locale=o,this.numberingSystem=n||a||null,this.outputCalendar=r||l||null,this.weekSettings=i,this.intl=IFe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=CFe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),n=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&n?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Mr.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,HF(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,n=!1){return vP(this,e,rme,()=>{const r=this.intl==="ja"||this.intl.startsWith("ja-");n&=!r;const i=n?{month:e,day:"numeric"}:{month:e},s=n?"format":"standalone";if(!this.monthsCache[s][e]){const o=r?a=>this.dtFormatter(a,i).format():a=>this.extract(a,i,"month");this.monthsCache[s][e]=RFe(o)}return this.monthsCache[s][e]})}weekdays(e,n=!1){return vP(this,e,ome,()=>{const r=n?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=n?"format":"standalone";return this.weekdaysCache[i][e]||(this.weekdaysCache[i][e]=PFe(s=>this.extract(s,r,"weekday"))),this.weekdaysCache[i][e]})}meridiems(){return vP(this,void 0,()=>ame,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[hn.utc(2016,11,13,9),hn.utc(2016,11,13,19)].map(n=>this.extract(n,e,"dayperiod"))}return this.meridiemCache})}eras(e){return vP(this,e,lme,()=>{const n={era:e};return this.eraCache[e]||(this.eraCache[e]=[hn.utc(-40,1,1),hn.utc(2017,1,1)].map(r=>this.extract(r,n,"era"))),this.eraCache[e]})}extract(e,n,r){const i=this.dtFormatter(e,n),s=i.formatToParts(),o=s.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(e={}){return new MFe(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,n={}){return new NFe(e,this.intl,n)}relFormatter(e={}){return new OFe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return bFe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||Bpe(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Qpe()?kFe(this.locale):Wpe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let c$=null;class aa extends oI{static get utcInstance(){return c$===null&&(c$=new aa(0)),c$}static instance(e){return e===0?aa.utcInstance:new aa(e)}static parseSpecifier(e){if(e){const n=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new aa(pO(n[1],n[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${QS(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${QS(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,n){return QS(this.fixed,n)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class LFe extends oI{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function jm(t,e){if(Sn(t)||t===null)return e;if(t instanceof oI)return t;if(zFe(t)){const n=t.toLowerCase();return n==="default"?e:n==="local"||n==="system"?hO.instance:n==="utc"||n==="gmt"?aa.utcInstance:aa.parseSpecifier(n)||uh.create(t)}else return mg(t)?aa.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new LFe(t)}const eB={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},ree={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},DFe=eB.hanidec.replace(/[\[|\]]/g,"").split("");function $Fe(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(t[n].search(eB.hanidec)!==-1)e+=DFe.indexOf(t[n]);else for(const i in ree){const[s,o]=ree[i];r>=s&&r<=o&&(e+=r-s)}}return parseInt(e,10)}else return e}const WF=new Map;function jFe(){WF.clear()}function Au({numberingSystem:t},e=""){const n=t||"latn";let r=WF.get(n);r===void 0&&(r=new Map,WF.set(n,r));let i=r.get(e);return i===void 0&&(i=new RegExp(`${eB[n]}${e}`),r.set(e,i)),i}let iee=()=>Date.now(),see="system",oee=null,aee=null,lee=null,cee=60,uee,hee=null,qi=class{static get now(){return iee}static set now(e){iee=e}static set defaultZone(e){see=e}static get defaultZone(){return jm(see,hO.instance)}static get defaultLocale(){return oee}static set defaultLocale(e){oee=e}static get defaultNumberingSystem(){return aee}static set defaultNumberingSystem(e){aee=e}static get defaultOutputCalendar(){return lee}static set defaultOutputCalendar(e){lee=e}static get defaultWeekSettings(){return hee}static set defaultWeekSettings(e){hee=HF(e)}static get twoDigitCutoffYear(){return cee}static set twoDigitCutoffYear(e){cee=e%100}static get throwOnInvalid(){return uee}static set throwOnInvalid(e){uee=e}static resetCaches(){Mr.resetCache(),uh.resetCache(),hn.resetCache(),jFe()}};class Zu{constructor(e,n){this.reason=e,this.explanation=n}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Hpe=[0,31,59,90,120,151,181,212,243,273,304,334],qpe=[0,31,60,91,121,152,182,213,244,274,305,335];function Xc(t,e){return new Zu("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function tB(t,e,n){const r=new Date(Date.UTC(t,e-1,n));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const i=r.getUTCDay();return i===0?7:i}function Kpe(t,e,n){return n+(aI(t)?qpe:Hpe)[e-1]}function Ype(t,e){const n=aI(t)?qpe:Hpe,r=n.findIndex(s=>s<e),i=e-n[r];return{month:r+1,day:i}}function nB(t,e){return(t-e+7)%7+1}function S4(t,e=4,n=1){const{year:r,month:i,day:s}=t,o=Kpe(r,i,s),a=nB(tB(r,i,s),n);let l=Math.floor((o-a+14-e)/7),c;return l<1?(c=r-1,l=kk(c,e,n)):l>kk(r,e,n)?(c=r+1,l=1):c=r,{weekYear:c,weekNumber:l,weekday:a,...mO(t)}}function dee(t,e=4,n=1){const{weekYear:r,weekNumber:i,weekday:s}=t,o=nB(tB(r,1,e),n),a=Hx(r);let l=i*7+s-o-7+e,c;l<1?(c=r-1,l+=Hx(c)):l>a?(c=r+1,l-=Hx(r)):c=r;const{month:u,day:h}=Ype(c,l);return{year:c,month:u,day:h,...mO(t)}}function u$(t){const{year:e,month:n,day:r}=t,i=Kpe(e,n,r);return{year:e,ordinal:i,...mO(t)}}function fee(t){const{year:e,ordinal:n}=t,{month:r,day:i}=Ype(e,n);return{year:e,month:r,day:i,...mO(t)}}function pee(t,e){if(!Sn(t.localWeekday)||!Sn(t.localWeekNumber)||!Sn(t.localWeekYear)){if(!Sn(t.weekday)||!Sn(t.weekNumber)||!Sn(t.weekYear))throw new px("Cannot mix locale-based week fields with ISO-based week fields");return Sn(t.localWeekday)||(t.weekday=t.localWeekday),Sn(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Sn(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function FFe(t,e=4,n=1){const r=dO(t.weekYear),i=Zc(t.weekNumber,1,kk(t.weekYear,e,n)),s=Zc(t.weekday,1,7);return r?i?s?!1:Xc("weekday",t.weekday):Xc("week",t.weekNumber):Xc("weekYear",t.weekYear)}function VFe(t){const e=dO(t.year),n=Zc(t.ordinal,1,Hx(t.year));return e?n?!1:Xc("ordinal",t.ordinal):Xc("year",t.year)}function Xpe(t){const e=dO(t.year),n=Zc(t.month,1,12),r=Zc(t.day,1,T4(t.year,t.month));return e?n?r?!1:Xc("day",t.day):Xc("month",t.month):Xc("year",t.year)}function Zpe(t){const{hour:e,minute:n,second:r,millisecond:i}=t,s=Zc(e,0,23)||e===24&&n===0&&r===0&&i===0,o=Zc(n,0,59),a=Zc(r,0,59),l=Zc(i,0,999);return s?o?a?l?!1:Xc("millisecond",i):Xc("second",r):Xc("minute",n):Xc("hour",e)}function Sn(t){return typeof t>"u"}function mg(t){return typeof t=="number"}function dO(t){return typeof t=="number"&&t%1===0}function zFe(t){return typeof t=="string"}function UFe(t){return Object.prototype.toString.call(t)==="[object Date]"}function Jpe(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Qpe(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function GFe(t){return Array.isArray(t)?t:[t]}function mee(t,e,n){if(t.length!==0)return t.reduce((r,i)=>{const s=[e(i),i];return r&&n(r[0],s[0])===r[0]?r:s},null)[1]}function BFe(t,e){return e.reduce((n,r)=>(n[r]=t[r],n),{})}function c2(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function HF(t){if(t==null)return null;if(typeof t!="object")throw new Qo("Week settings must be an object");if(!Zc(t.firstDay,1,7)||!Zc(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Zc(e,1,7)))throw new Qo("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Zc(t,e,n){return dO(t)&&t>=e&&t<=n}function WFe(t,e){return t-e*Math.floor(t/e)}function _s(t,e=2){const n=t<0;let r;return n?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function Rm(t){if(!(Sn(t)||t===null||t===""))return parseInt(t,10)}function k0(t){if(!(Sn(t)||t===null||t===""))return parseFloat(t)}function rB(t){if(!(Sn(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function iB(t,e,n="round"){const r=10**e;switch(n){case"expand":return t>0?Math.ceil(t*r)/r:Math.floor(t*r)/r;case"trunc":return Math.trunc(t*r)/r;case"round":return Math.round(t*r)/r;case"floor":return Math.floor(t*r)/r;case"ceil":return Math.ceil(t*r)/r;default:throw new RangeError(`Value rounding ${n} is out of range`)}}function aI(t){return t%4===0&&(t%100!==0||t%400===0)}function Hx(t){return aI(t)?366:365}function T4(t,e){const n=WFe(e-1,12)+1,r=t+(e-n)/12;return n===2?aI(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function fO(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function gee(t,e,n){return-nB(tB(t,1,e),n)+e-1}function kk(t,e=4,n=1){const r=gee(t,e,n),i=gee(t+1,e,n);return(Hx(t)-r+i)/7}function qF(t){return t>99?t:t>qi.twoDigitCutoffYear?1900+t:2e3+t}function eme(t,e,n,r=null){const i=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(n,o).formatToParts(i).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function pO(t,e){let n=parseInt(t,10);Number.isNaN(n)&&(n=0);const r=parseInt(e,10)||0,i=n<0||Object.is(n,-0)?-r:r;return n*60+i}function tme(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new Qo(`Invalid unit value ${t}`);return e}function k4(t,e){const n={};for(const r in t)if(c2(t,r)){const i=t[r];if(i==null)continue;n[e(r)]=tme(i)}return n}function QS(t,e){const n=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),i=t>=0?"+":"-";switch(e){case"short":return`${i}${_s(n,2)}:${_s(r,2)}`;case"narrow":return`${i}${n}${r>0?`:${r}`:""}`;case"techie":return`${i}${_s(n,2)}${_s(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function mO(t){return BFe(t,["hour","minute","second","millisecond"])}const HFe=["January","February","March","April","May","June","July","August","September","October","November","December"],nme=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],qFe=["J","F","M","A","M","J","J","A","S","O","N","D"];function rme(t){switch(t){case"narrow":return[...qFe];case"short":return[...nme];case"long":return[...HFe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const ime=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],sme=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],KFe=["M","T","W","T","F","S","S"];function ome(t){switch(t){case"narrow":return[...KFe];case"short":return[...sme];case"long":return[...ime];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const ame=["AM","PM"],YFe=["Before Christ","Anno Domini"],XFe=["BC","AD"],ZFe=["B","A"];function lme(t){switch(t){case"narrow":return[...ZFe];case"short":return[...XFe];case"long":return[...YFe];default:return null}}function JFe(t){return ame[t.hour<12?0:1]}function QFe(t,e){return ome(e)[t.weekday-1]}function e9e(t,e){return rme(e)[t.month-1]}function t9e(t,e){return lme(e)[t.year<0?0:1]}function n9e(t,e,n="always",r=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(n==="auto"&&s){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${i[t][0]}`;case-1:return h?"yesterday":`last ${i[t][0]}`;case 0:return h?"today":`this ${i[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=i[t],u=r?l?c[1]:c[2]||c[1]:l?i[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}function yee(t,e){let n="";for(const r of t)r.literal?n+=r.val:n+=e(r.val);return n}const r9e={D:E4,DD:Tpe,DDD:kpe,DDDD:Ape,t:Ipe,tt:Rpe,ttt:Ppe,tttt:Cpe,T:Mpe,TT:Npe,TTT:Ope,TTTT:Lpe,f:Dpe,ff:jpe,fff:Vpe,ffff:Upe,F:$pe,FF:Fpe,FFF:zpe,FFFF:Gpe};class sa{static create(e,n={}){return new sa(e,n)}static parseFormat(e){let n=null,r="",i=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?((r.length>0||i)&&s.push({literal:i||/^\s+$/.test(r),val:r===""?"'":r}),n=null,r="",i=!i):i||a===n?r+=a:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=a,n=a)}return r.length>0&&s.push({literal:i||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(e){return r9e[e]}constructor(e,n){this.opts=n,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,n){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...n}).format()}dtFormatter(e,n={}){return this.loc.dtFormatter(e,{...this.opts,...n})}formatDateTime(e,n){return this.dtFormatter(e,n).format()}formatDateTimeParts(e,n){return this.dtFormatter(e,n).formatToParts()}formatInterval(e,n){return this.dtFormatter(e.start,n).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,n){return this.dtFormatter(e,n).resolvedOptions()}num(e,n=0,r=void 0){if(this.opts.forceSimple)return _s(e,n);const i={...this.opts};return n>0&&(i.padTo=n),r&&(i.signDisplay=r),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,n){const r=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(g,v)=>this.loc.extract(e,g,v),o=g=>e.isOffsetFixed&&e.offset===0&&g.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,g.format):"",a=()=>r?JFe(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(g,v)=>r?e9e(e,g):s(v?{month:g}:{month:g,day:"numeric"},"month"),c=(g,v)=>r?QFe(e,g):s(v?{weekday:g}:{weekday:g,month:"long",day:"numeric"},"weekday"),u=g=>{const v=sa.macroTokenToFormatOpts(g);return v?this.formatWithSystemDefault(e,v):g},h=g=>r?t9e(e,g):s({era:g},"era"),f=g=>{switch(g){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return i?s({day:"numeric"},"day"):this.num(e.day);case"dd":return i?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return i?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return i?s({month:"numeric"},"month"):this.num(e.month);case"MM":return i?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return i?s({year:"numeric"},"year"):this.num(e.year);case"yy":return i?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(g)}};return yee(sa.parseFormat(n),f)}formatDurationFromString(e,n){const r=this.opts.signMode==="negativeLargestOnly"?-1:1,i=u=>{switch(u[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},s=(u,h)=>f=>{const g=i(f);if(g){const v=h.isNegativeDuration&&g!==h.largestUnit?r:1;let x;return this.opts.signMode==="negativeLargestOnly"&&g!==h.largestUnit?x="never":this.opts.signMode==="all"?x="always":x="auto",this.num(u.get(g)*v,f.length,x)}else return f},o=sa.parseFormat(n),a=o.reduce((u,{literal:h,val:f})=>h?u:u.concat(f),[]),l=e.shiftTo(...a.map(i).filter(u=>u)),c={isNegativeDuration:l<0,largestUnit:Object.keys(l.values)[0]};return yee(o,s(l,c))}}const cme=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Z2(...t){const e=t.reduce((n,r)=>n+r.source,"");return RegExp(`^${e}$`)}function J2(...t){return e=>t.reduce(([n,r,i],s)=>{const[o,a,l]=s(e,i);return[{...n,...o},a||r,l]},[{},null,1]).slice(0,2)}function Q2(t,...e){if(t==null)return[null,null];for(const[n,r]of e){const i=n.exec(t);if(i)return r(i)}return[null,null]}function ume(...t){return(e,n)=>{const r={};let i;for(i=0;i<t.length;i++)r[t[i]]=Rm(e[n+i]);return[r,null,n+i]}}const hme=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,i9e=`(?:${hme.source}?(?:\\[(${cme.source})\\])?)?`,sB=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,dme=RegExp(`${sB.source}${i9e}`),oB=RegExp(`(?:[Tt]${dme.source})?`),s9e=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,o9e=/(\d{4})-?W(\d\d)(?:-?(\d))?/,a9e=/(\d{4})-?(\d{3})/,l9e=ume("weekYear","weekNumber","weekDay"),c9e=ume("year","ordinal"),u9e=/(\d{4})-(\d\d)-(\d\d)/,fme=RegExp(`${sB.source} ?(?:${hme.source}|(${cme.source}))?`),h9e=RegExp(`(?: ${fme.source})?`);function qx(t,e,n){const r=t[e];return Sn(r)?n:Rm(r)}function d9e(t,e){return[{year:qx(t,e),month:qx(t,e+1,1),day:qx(t,e+2,1)},null,e+3]}function eb(t,e){return[{hours:qx(t,e,0),minutes:qx(t,e+1,0),seconds:qx(t,e+2,0),milliseconds:rB(t[e+3])},null,e+4]}function lI(t,e){const n=!t[e]&&!t[e+1],r=pO(t[e+1],t[e+2]),i=n?null:aa.instance(r);return[{},i,e+3]}function cI(t,e){const n=t[e]?uh.create(t[e]):null;return[{},n,e+1]}const f9e=RegExp(`^T?${sB.source}$`),p9e=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function m9e(t){const[e,n,r,i,s,o,a,l,c]=t,u=e[0]==="-",h=l&&l[0]==="-",f=(g,v=!1)=>g!==void 0&&(v||g&&u)?-g:g;return[{years:f(k0(n)),months:f(k0(r)),weeks:f(k0(i)),days:f(k0(s)),hours:f(k0(o)),minutes:f(k0(a)),seconds:f(k0(l),l==="-0"),milliseconds:f(rB(c),h)}]}const g9e={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function aB(t,e,n,r,i,s,o){const a={year:e.length===2?qF(Rm(e)):Rm(e),month:nme.indexOf(n)+1,day:Rm(r),hour:Rm(i),minute:Rm(s)};return o&&(a.second=Rm(o)),t&&(a.weekday=t.length>3?ime.indexOf(t)+1:sme.indexOf(t)+1),a}const y9e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function v9e(t){const[,e,n,r,i,s,o,a,l,c,u,h]=t,f=aB(e,i,r,n,s,o,a);let g;return l?g=g9e[l]:c?g=0:g=pO(u,h),[f,new aa(g)]}function _9e(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const x9e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,w9e=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,b9e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function vee(t){const[,e,n,r,i,s,o,a]=t;return[aB(e,i,r,n,s,o,a),aa.utcInstance]}function E9e(t){const[,e,n,r,i,s,o,a]=t;return[aB(e,a,n,r,i,s,o),aa.utcInstance]}const S9e=Z2(s9e,oB),T9e=Z2(o9e,oB),k9e=Z2(a9e,oB),A9e=Z2(dme),pme=J2(d9e,eb,lI,cI),I9e=J2(l9e,eb,lI,cI),R9e=J2(c9e,eb,lI,cI),P9e=J2(eb,lI,cI);function C9e(t){return Q2(t,[S9e,pme],[T9e,I9e],[k9e,R9e],[A9e,P9e])}function M9e(t){return Q2(_9e(t),[y9e,v9e])}function N9e(t){return Q2(t,[x9e,vee],[w9e,vee],[b9e,E9e])}function O9e(t){return Q2(t,[p9e,m9e])}const L9e=J2(eb);function D9e(t){return Q2(t,[f9e,L9e])}const $9e=Z2(u9e,h9e),j9e=Z2(fme),F9e=J2(eb,lI,cI);function V9e(t){return Q2(t,[$9e,pme],[j9e,F9e])}const _ee="Invalid Duration",mme={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},z9e={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...mme},Tc=146097/400,u_=146097/4800,U9e={years:{quarters:4,months:12,weeks:Tc/7,days:Tc,hours:Tc*24,minutes:Tc*24*60,seconds:Tc*24*60*60,milliseconds:Tc*24*60*60*1e3},quarters:{months:3,weeks:Tc/28,days:Tc/4,hours:Tc*24/4,minutes:Tc*24*60/4,seconds:Tc*24*60*60/4,milliseconds:Tc*24*60*60*1e3/4},months:{weeks:u_/7,days:u_,hours:u_*24,minutes:u_*24*60,seconds:u_*24*60*60,milliseconds:u_*24*60*60*1e3},...mme},Py=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],G9e=Py.slice(0).reverse();function tf(t,e,n=!1){const r={values:n?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new dr(r)}function gme(t,e){let n=e.milliseconds??0;for(const r of G9e.slice(1))e[r]&&(n+=e[r]*t[r].milliseconds);return n}function xee(t,e){const n=gme(t,e)<0?-1:1;Py.reduceRight((r,i)=>{if(Sn(e[i]))return r;if(r){const s=e[r]*n,o=t[i][r],a=Math.floor(s/o);e[i]+=a*n,e[r]-=a*o*n}return i},null),Py.reduce((r,i)=>{if(Sn(e[i]))return r;if(r){const s=e[r]%1;e[r]-=s,e[i]+=s*t[r][i]}return i},null)}function wee(t){const e={};for(const[n,r]of Object.entries(t))r!==0&&(e[n]=r);return e}class dr{constructor(e){const n=e.conversionAccuracy==="longterm"||!1;let r=n?U9e:z9e;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Mr.create(),this.conversionAccuracy=n?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,n){return dr.fromObject({milliseconds:e},n)}static fromObject(e,n={}){if(e==null||typeof e!="object")throw new Qo(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new dr({values:k4(e,dr.normalizeUnit),loc:Mr.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})}static fromDurationLike(e){if(mg(e))return dr.fromMillis(e);if(dr.isDuration(e))return e;if(typeof e=="object")return dr.fromObject(e);throw new Qo(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,n){const[r]=O9e(e);return r?dr.fromObject(r,n):dr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,n){const[r]=D9e(e);return r?dr.fromObject(r,n):dr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,n=null){if(!e)throw new Qo("need to specify a reason the Duration is invalid");const r=e instanceof Zu?e:new Zu(e,n);if(qi.throwOnInvalid)throw new mFe(r);return new dr({invalid:r})}static normalizeUnit(e){const n={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!n)throw new Spe(e);return n}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,n={}){const r={...n,floor:n.round!==!1&&n.floor!==!1};return this.isValid?sa.create(this.loc,r).formatDurationFromString(this,e):_ee}toHuman(e={}){if(!this.isValid)return _ee;const n=e.showZeros!==!1,r=Py.map(i=>{const s=this.values[i];return Sn(s)||s===0&&!n?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(s)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=iB(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const n=this.toMillis();return n<0||n>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},hn.fromMillis(n,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?gme(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e),r={};for(const i of Py)(c2(n.values,i)||c2(this.values,i))&&(r[i]=n.get(i)+this.get(i));return tf(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e);return this.plus(n.negate())}mapUnits(e){if(!this.isValid)return this;const n={};for(const r of Object.keys(this.values))n[r]=tme(e(this.values[r],r));return tf(this,{values:n},!0)}get(e){return this[dr.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const n={...this.values,...k4(e,dr.normalizeUnit)};return tf(this,{values:n})}reconfigure({locale:e,numberingSystem:n,conversionAccuracy:r,matrix:i}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:n}),matrix:i,conversionAccuracy:r};return tf(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return xee(this.matrix,e),tf(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=wee(this.normalize().shiftToAll().toObject());return tf(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>dr.normalizeUnit(o));const n={},r={},i=this.toObject();let s;for(const o of Py)if(e.indexOf(o)>=0){s=o;let a=0;for(const c in r)a+=this.matrix[c][o]*r[c],r[c]=0;mg(i[o])&&(a+=i[o]);const l=Math.trunc(a);n[o]=l,r[o]=(a*1e3-l*1e3)/1e3}else mg(i[o])&&(r[o]=i[o]);for(const o in r)r[o]!==0&&(n[s]+=o===s?r[o]:r[o]/this.matrix[s][o]);return xee(this.matrix,n),tf(this,{values:n},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const n of Object.keys(this.values))e[n]=this.values[n]===0?0:-this.values[n];return tf(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=wee(this.values);return tf(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function n(r,i){return r===void 0||r===0?i===void 0||i===0:r===i}for(const r of Py)if(!n(this.values[r],e.values[r]))return!1;return!0}}const h_="Invalid Interval";function B9e(t,e){return!t||!t.isValid?Bi.invalid("missing or invalid start"):!e||!e.isValid?Bi.invalid("missing or invalid end"):e<t?Bi.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Bi{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,n=null){if(!e)throw new Qo("need to specify a reason the Interval is invalid");const r=e instanceof Zu?e:new Zu(e,n);if(qi.throwOnInvalid)throw new pFe(r);return new Bi({invalid:r})}static fromDateTimes(e,n){const r=mE(e),i=mE(n),s=B9e(r,i);return s??new Bi({start:r,end:i})}static after(e,n){const r=dr.fromDurationLike(n),i=mE(e);return Bi.fromDateTimes(i,i.plus(r))}static before(e,n){const r=dr.fromDurationLike(n),i=mE(e);return Bi.fromDateTimes(i.minus(r),i)}static fromISO(e,n){const[r,i]=(e||"").split("/",2);if(r&&i){let s,o;try{s=hn.fromISO(r,n),o=s.isValid}catch{o=!1}let a,l;try{a=hn.fromISO(i,n),l=a.isValid}catch{l=!1}if(o&&l)return Bi.fromDateTimes(s,a);if(o){const c=dr.fromISO(i,n);if(c.isValid)return Bi.after(s,c)}else if(l){const c=dr.fromISO(r,n);if(c.isValid)return Bi.before(a,c)}}return Bi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",n){if(!this.isValid)return NaN;const r=this.start.startOf(e,n);let i;return n?.useLocaleWeeks?i=this.end.reconfigure({locale:r.locale}):i=this.end,i=i.startOf(e,n),Math.floor(i.diff(r,e).get(e))+(i.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:n}={}){return this.isValid?Bi.fromDateTimes(e||this.s,n||this.e):this}splitAt(...e){if(!this.isValid)return[];const n=e.map(mE).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),r=[];let{s:i}=this,s=0;for(;i<this.e;){const o=n[s]||this.e,a=+o>+this.e?this.e:o;r.push(Bi.fromDateTimes(i,a)),i=a,s+=1}return r}splitBy(e){const n=dr.fromDurationLike(e);if(!this.isValid||!n.isValid||n.as("milliseconds")===0)return[];let{s:r}=this,i=1,s;const o=[];for(;r<this.e;){const a=this.start.plus(n.mapUnits(l=>l*i));s=+a>+this.e?this.e:a,o.push(Bi.fromDateTimes(r,s)),r=s,i+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const n=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return n>=r?null:Bi.fromDateTimes(n,r)}union(e){if(!this.isValid)return this;const n=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return Bi.fromDateTimes(n,r)}static merge(e){const[n,r]=e.sort((i,s)=>i.s-s.s).reduce(([i,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[i,s.union(o)]:[i.concat([s]),o]:[i,o],[[],null]);return r&&n.push(r),n}static xor(e){let n=null,r=0;const i=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((l,c)=>l.time-c.time);for(const l of a)r+=l.type==="s"?1:-1,r===1?n=l.time:(n&&+n!=+l.time&&i.push(Bi.fromDateTimes(n,l.time)),n=null);return Bi.merge(i)}difference(...e){return Bi.xor([this].concat(e)).map(n=>this.intersection(n)).filter(n=>n&&!n.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:h_}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=E4,n={}){return this.isValid?sa.create(this.s.loc.clone(n),e).formatInterval(this):h_}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:h_}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:h_}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:h_}toFormat(e,{separator:n="  "}={}){return this.isValid?`${this.s.toFormat(e)}${n}${this.e.toFormat(e)}`:h_}toDuration(e,n){return this.isValid?this.e.diff(this.s,e,n):dr.invalid(this.invalidReason)}mapEndpoints(e){return Bi.fromDateTimes(e(this.s),e(this.e))}}let _P=class{static hasDST(e=qi.defaultZone){const n=hn.now().setZone(e).set({month:12});return!e.isUniversal&&n.offset!==n.set({month:6}).offset}static isValidIANAZone(e){return uh.isValidZone(e)}static normalizeZone(e){return jm(e,qi.defaultZone)}static getStartOfWeek({locale:e=null,locObj:n=null}={}){return(n||Mr.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:n=null}={}){return(n||Mr.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:n=null}={}){return(n||Mr.create(e)).getWeekendDays().slice()}static months(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Mr.create(n,r,s)).months(e)}static monthsFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Mr.create(n,r,s)).months(e,!0)}static weekdays(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Mr.create(n,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Mr.create(n,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Mr.create(e).meridiems()}static eras(e="short",{locale:n=null}={}){return Mr.create(n,null,"gregory").eras(e)}static features(){return{relative:Jpe(),localeWeek:Qpe()}}};function bee(t,e){const n=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(e)-n(t);return Math.floor(dr.fromMillis(r).as("days"))}function W9e(t,e,n){const r=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const u=bee(l,c);return(u-u%7)/7}],["days",bee]],i={},s=t;let o,a;for(const[l,c]of r)n.indexOf(l)>=0&&(o=l,i[l]=c(t,e),a=s.plus(i),a>e?(i[l]--,t=s.plus(i),t>e&&(a=t,i[l]--,t=s.plus(i))):t=a);return[t,i,a,o]}function H9e(t,e,n,r){let[i,s,o,a]=W9e(t,e,n);const l=e-i,c=n.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);c.length===0&&(o<e&&(o=i.plus({[a]:1})),o!==i&&(s[a]=(s[a]||0)+l/(o-i)));const u=dr.fromObject(s,r);return c.length>0?dr.fromMillis(l,r).shiftTo(...c).plus(u):u}const q9e="missing Intl.DateTimeFormat.formatToParts support";function _r(t,e=n=>n){return{regex:t,deser:([n])=>e($Fe(n))}}const K9e="",yme=`[ ${K9e}]`,vme=new RegExp(yme,"g");function Y9e(t){return t.replace(/\./g,"\\.?").replace(vme,yme)}function Eee(t){return t.replace(/\./g,"").replace(vme," ").toLowerCase()}function Iu(t,e){return t===null?null:{regex:RegExp(t.map(Y9e).join("|")),deser:([n])=>t.findIndex(r=>Eee(n)===Eee(r))+e}}function See(t,e){return{regex:t,deser:([,n,r])=>pO(n,r),groups:e}}function xP(t){return{regex:t,deser:([e])=>e}}function X9e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Z9e(t,e){const n=Au(e),r=Au(e,"{2}"),i=Au(e,"{3}"),s=Au(e,"{4}"),o=Au(e,"{6}"),a=Au(e,"{1,2}"),l=Au(e,"{1,3}"),c=Au(e,"{1,6}"),u=Au(e,"{1,9}"),h=Au(e,"{2,4}"),f=Au(e,"{4,6}"),g=b=>({regex:RegExp(X9e(b.val)),deser:([T])=>T,literal:!0}),x=(b=>{if(t.literal)return g(b);switch(b.val){case"G":return Iu(e.eras("short"),0);case"GG":return Iu(e.eras("long"),0);case"y":return _r(c);case"yy":return _r(h,qF);case"yyyy":return _r(s);case"yyyyy":return _r(f);case"yyyyyy":return _r(o);case"M":return _r(a);case"MM":return _r(r);case"MMM":return Iu(e.months("short",!0),1);case"MMMM":return Iu(e.months("long",!0),1);case"L":return _r(a);case"LL":return _r(r);case"LLL":return Iu(e.months("short",!1),1);case"LLLL":return Iu(e.months("long",!1),1);case"d":return _r(a);case"dd":return _r(r);case"o":return _r(l);case"ooo":return _r(i);case"HH":return _r(r);case"H":return _r(a);case"hh":return _r(r);case"h":return _r(a);case"mm":return _r(r);case"m":return _r(a);case"q":return _r(a);case"qq":return _r(r);case"s":return _r(a);case"ss":return _r(r);case"S":return _r(l);case"SSS":return _r(i);case"u":return xP(u);case"uu":return xP(a);case"uuu":return _r(n);case"a":return Iu(e.meridiems(),0);case"kkkk":return _r(s);case"kk":return _r(h,qF);case"W":return _r(a);case"WW":return _r(r);case"E":case"c":return _r(n);case"EEE":return Iu(e.weekdays("short",!1),1);case"EEEE":return Iu(e.weekdays("long",!1),1);case"ccc":return Iu(e.weekdays("short",!0),1);case"cccc":return Iu(e.weekdays("long",!0),1);case"Z":case"ZZ":return See(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return See(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return xP(/[a-z_+-/]{1,256}?/i);case" ":return xP(/[^\S\n\r]/);default:return g(b)}})(t)||{invalidReason:q9e};return x.token=t,x}const J9e={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function Q9e(t,e,n){const{type:r,value:i}=t;if(r==="literal"){const l=/^\s+$/.test(i);return{literal:!l,val:l?" ":i}}const s=e[r];let o=r;r==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=n.hour12?"hour12":"hour24");let a=J9e[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function e7e(t){return[`^${t.map(n=>n.regex).reduce((n,r)=>`${n}(${r.source})`,"")}$`,t]}function t7e(t,e,n){const r=t.match(e);if(r){const i={};let s=1;for(const o in n)if(c2(n,o)){const a=n[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(r.slice(s,s+l))),s+=l}return[r,i]}else return[r,{}]}function n7e(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let n=null,r;return Sn(t.z)||(n=uh.create(t.z)),Sn(t.Z)||(n||(n=new aa(t.Z)),r=t.Z),Sn(t.q)||(t.M=(t.q-1)*3+1),Sn(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Sn(t.u)||(t.S=rB(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),n,r]}let h$=null;function r7e(){return h$||(h$=hn.fromMillis(1555555555555)),h$}function i7e(t,e){if(t.literal)return t;const n=sa.macroTokenToFormatOpts(t.val),r=bme(n,e);return r==null||r.includes(void 0)?t:r}function _me(t,e){return Array.prototype.concat(...t.map(n=>i7e(n,e)))}class xme{constructor(e,n){if(this.locale=e,this.format=n,this.tokens=_me(sa.parseFormat(n),e),this.units=this.tokens.map(r=>Z9e(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,i]=e7e(this.units);this.regex=RegExp(r,"i"),this.handlers=i}}explainFromTokens(e){if(this.isValid){const[n,r]=t7e(e,this.regex,this.handlers),[i,s,o]=r?n7e(r):[null,null,void 0];if(c2(r,"a")&&c2(r,"H"))throw new px("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:n,matches:r,result:i,zone:s,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function wme(t,e,n){return new xme(t,n).explainFromTokens(e)}function s7e(t,e,n){const{result:r,zone:i,specificOffset:s,invalidReason:o}=wme(t,e,n);return[r,i,s,o]}function bme(t,e){if(!t)return null;const r=sa.create(e,t).dtFormatter(r7e()),i=r.formatToParts(),s=r.resolvedOptions();return i.map(o=>Q9e(o,t,s))}const d$="Invalid DateTime",Tee=864e13;function JE(t){return new Zu("unsupported zone",`the zone "${t.name}" is not supported`)}function f$(t){return t.weekData===null&&(t.weekData=S4(t.c)),t.weekData}function p$(t){return t.localWeekData===null&&(t.localWeekData=S4(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function A0(t,e){const n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new hn({...n,...e,old:n})}function Eme(t,e,n){let r=t-e*60*1e3;const i=n.offset(r);if(e===i)return[r,e];r-=(i-e)*60*1e3;const s=n.offset(r);return i===s?[r,i]:[t-Math.min(i,s)*60*1e3,Math.max(i,s)]}function wP(t,e){t+=e*60*1e3;const n=new Date(t);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function ZC(t,e,n){return Eme(fO(t),e,n)}function kee(t,e){const n=t.o,r=t.c.year+Math.trunc(e.years),i=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:r,month:i,day:Math.min(t.c.day,T4(r,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=dr.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=fO(s);let[l,c]=Eme(a,n,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function d_(t,e,n,r,i,s){const{setZone:o,zone:a}=n;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=hn.fromObject(t,{...n,zone:l,specificOffset:s});return o?c:c.setZone(a)}else return hn.invalid(new Zu("unparsable",`the input "${i}" can't be parsed as ${r}`))}function bP(t,e,n=!0){return t.isValid?sa.create(Mr.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(t,e):null}function m$(t,e,n){const r=t.c.year>9999||t.c.year<0;let i="";if(r&&t.c.year>=0&&(i+="+"),i+=_s(t.c.year,r?6:4),n==="year")return i;if(e){if(i+="-",i+=_s(t.c.month),n==="month")return i;i+="-"}else if(i+=_s(t.c.month),n==="month")return i;return i+=_s(t.c.day),i}function Aee(t,e,n,r,i,s,o){let a=!n||t.c.millisecond!==0||t.c.second!==0,l="";switch(o){case"day":case"month":case"year":break;default:if(l+=_s(t.c.hour),o==="hour")break;if(e){if(l+=":",l+=_s(t.c.minute),o==="minute")break;a&&(l+=":",l+=_s(t.c.second))}else{if(l+=_s(t.c.minute),o==="minute")break;a&&(l+=_s(t.c.second))}if(o==="second")break;a&&(!r||t.c.millisecond!==0)&&(l+=".",l+=_s(t.c.millisecond,3))}return i&&(t.isOffsetFixed&&t.offset===0&&!s?l+="Z":t.o<0?(l+="-",l+=_s(Math.trunc(-t.o/60)),l+=":",l+=_s(Math.trunc(-t.o%60))):(l+="+",l+=_s(Math.trunc(t.o/60)),l+=":",l+=_s(Math.trunc(t.o%60)))),s&&(l+="["+t.zone.ianaName+"]"),l}const Sme={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},o7e={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},a7e={ordinal:1,hour:0,minute:0,second:0,millisecond:0},JC=["year","month","day","hour","minute","second","millisecond"],l7e=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],c7e=["year","ordinal","hour","minute","second","millisecond"];function QC(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new Spe(t);return e}function Iee(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return QC(t)}}function u7e(t){if(QE===void 0&&(QE=qi.now()),t.type!=="iana")return t.offset(QE);const e=t.name;let n=KF.get(e);return n===void 0&&(n=t.offset(QE),KF.set(e,n)),n}function Ree(t,e){const n=jm(e.zone,qi.defaultZone);if(!n.isValid)return hn.invalid(JE(n));const r=Mr.fromObject(e);let i,s;if(Sn(t.year))i=qi.now();else{for(const l of JC)Sn(t[l])&&(t[l]=Sme[l]);const o=Xpe(t)||Zpe(t);if(o)return hn.invalid(o);const a=u7e(n);[i,s]=ZC(t,a,n)}return new hn({ts:i,zone:n,loc:r,o:s})}function Pee(t,e,n){const r=Sn(n.round)?!0:n.round,i=Sn(n.rounding)?"trunc":n.rounding,s=(a,l)=>(a=iB(a,r||n.calendary?0:2,n.calendary?"round":i),e.loc.clone(n).relFormatter(n).format(a,l)),o=a=>n.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(n.unit)return s(o(n.unit),n.unit);for(const a of n.units){const l=o(a);if(Math.abs(l)>=1)return s(l,a)}return s(t>e?-0:0,n.units[n.units.length-1])}function Cee(t){let e={},n;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],n=Array.from(t).slice(0,t.length-1)):n=Array.from(t),[e,n]}let QE;const KF=new Map;class hn{constructor(e){const n=e.zone||qi.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new Zu("invalid input"):null)||(n.isValid?null:JE(n));this.ts=Sn(e.ts)?qi.now():e.ts;let i=null,s=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(n))[i,s]=[e.old.c,e.old.o];else{const a=mg(e.o)&&!e.old?e.o:n.offset(this.ts);i=wP(this.ts,a),r=Number.isNaN(i.year)?new Zu("invalid input"):null,i=r?null:i,s=r?null:a}this._zone=n,this.loc=e.loc||Mr.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=i,this.o=s,this.isLuxonDateTime=!0}static now(){return new hn({})}static local(){const[e,n]=Cee(arguments),[r,i,s,o,a,l,c]=n;return Ree({year:r,month:i,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,n]=Cee(arguments),[r,i,s,o,a,l,c]=n;return e.zone=aa.utcInstance,Ree({year:r,month:i,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,n={}){const r=UFe(e)?e.valueOf():NaN;if(Number.isNaN(r))return hn.invalid("invalid input");const i=jm(n.zone,qi.defaultZone);return i.isValid?new hn({ts:r,zone:i,loc:Mr.fromObject(n)}):hn.invalid(JE(i))}static fromMillis(e,n={}){if(mg(e))return e<-Tee||e>Tee?hn.invalid("Timestamp out of range"):new hn({ts:e,zone:jm(n.zone,qi.defaultZone),loc:Mr.fromObject(n)});throw new Qo(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,n={}){if(mg(e))return new hn({ts:e*1e3,zone:jm(n.zone,qi.defaultZone),loc:Mr.fromObject(n)});throw new Qo("fromSeconds requires a numerical input")}static fromObject(e,n={}){e=e||{};const r=jm(n.zone,qi.defaultZone);if(!r.isValid)return hn.invalid(JE(r));const i=Mr.fromObject(n),s=k4(e,Iee),{minDaysInFirstWeek:o,startOfWeek:a}=pee(s,i),l=qi.now(),c=Sn(n.specificOffset)?r.offset(l):n.specificOffset,u=!Sn(s.ordinal),h=!Sn(s.year),f=!Sn(s.month)||!Sn(s.day),g=h||f,v=s.weekYear||s.weekNumber;if((g||u)&&v)throw new px("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&u)throw new px("Can't mix ordinal dates with month/day");const x=v||s.weekday&&!g;let b,T,A=wP(l,c);x?(b=l7e,T=o7e,A=S4(A,o,a)):u?(b=c7e,T=a7e,A=u$(A)):(b=JC,T=Sme);let I=!1;for(const j of b){const V=s[j];Sn(V)?I?s[j]=T[j]:s[j]=A[j]:I=!0}const R=x?FFe(s,o,a):u?VFe(s):Xpe(s),M=R||Zpe(s);if(M)return hn.invalid(M);const F=x?dee(s,o,a):u?fee(s):s,[C,N]=ZC(F,c,r),O=new hn({ts:C,zone:r,o:N,loc:i});return s.weekday&&g&&e.weekday!==O.weekday?hn.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${O.toISO()}`):O.isValid?O:hn.invalid(O.invalid)}static fromISO(e,n={}){const[r,i]=C9e(e);return d_(r,i,n,"ISO 8601",e)}static fromRFC2822(e,n={}){const[r,i]=M9e(e);return d_(r,i,n,"RFC 2822",e)}static fromHTTP(e,n={}){const[r,i]=N9e(e);return d_(r,i,n,"HTTP",n)}static fromFormat(e,n,r={}){if(Sn(e)||Sn(n))throw new Qo("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:s=null}=r,o=Mr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0}),[a,l,c,u]=s7e(o,e,n);return u?hn.invalid(u):d_(a,l,r,`format ${n}`,e,c)}static fromString(e,n,r={}){return hn.fromFormat(e,n,r)}static fromSQL(e,n={}){const[r,i]=V9e(e);return d_(r,i,n,"SQL",e)}static invalid(e,n=null){if(!e)throw new Qo("need to specify a reason the DateTime is invalid");const r=e instanceof Zu?e:new Zu(e,n);if(qi.throwOnInvalid)throw new fFe(r);return new hn({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,n={}){const r=bme(e,Mr.fromObject(n));return r?r.map(i=>i?i.val:null).join(""):null}static expandFormat(e,n={}){return _me(sa.parseFormat(e),Mr.fromObject(n)).map(i=>i.val).join("")}static resetCache(){QE=void 0,KF.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?f$(this).weekYear:NaN}get weekNumber(){return this.isValid?f$(this).weekNumber:NaN}get weekday(){return this.isValid?f$(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?p$(this).weekday:NaN}get localWeekNumber(){return this.isValid?p$(this).weekNumber:NaN}get localWeekYear(){return this.isValid?p$(this).weekYear:NaN}get ordinal(){return this.isValid?u$(this.c).ordinal:NaN}get monthShort(){return this.isValid?_P.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?_P.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?_P.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?_P.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,n=6e4,r=fO(this.c),i=this.zone.offset(r-e),s=this.zone.offset(r+e),o=this.zone.offset(r-i*n),a=this.zone.offset(r-s*n);if(o===a)return[this];const l=r-o*n,c=r-a*n,u=wP(l,o),h=wP(c,a);return u.hour===h.hour&&u.minute===h.minute&&u.second===h.second&&u.millisecond===h.millisecond?[A0(this,{ts:l}),A0(this,{ts:c})]:[this]}get isInLeapYear(){return aI(this.year)}get daysInMonth(){return T4(this.year,this.month)}get daysInYear(){return this.isValid?Hx(this.year):NaN}get weeksInWeekYear(){return this.isValid?kk(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?kk(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:n,numberingSystem:r,calendar:i}=sa.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:n,numberingSystem:r,outputCalendar:i}}toUTC(e=0,n={}){return this.setZone(aa.instance(e),n)}toLocal(){return this.setZone(qi.defaultZone)}setZone(e,{keepLocalTime:n=!1,keepCalendarTime:r=!1}={}){if(e=jm(e,qi.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(n||r){const s=e.offset(this.ts),o=this.toObject();[i]=ZC(o,s,e)}return A0(this,{ts:i,zone:e})}else return hn.invalid(JE(e))}reconfigure({locale:e,numberingSystem:n,outputCalendar:r}={}){const i=this.loc.clone({locale:e,numberingSystem:n,outputCalendar:r});return A0(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const n=k4(e,Iee),{minDaysInFirstWeek:r,startOfWeek:i}=pee(n,this.loc),s=!Sn(n.weekYear)||!Sn(n.weekNumber)||!Sn(n.weekday),o=!Sn(n.ordinal),a=!Sn(n.year),l=!Sn(n.month)||!Sn(n.day),c=a||l,u=n.weekYear||n.weekNumber;if((c||o)&&u)throw new px("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new px("Can't mix ordinal dates with month/day");let h;s?h=dee({...S4(this.c,r,i),...n},r,i):Sn(n.ordinal)?(h={...this.toObject(),...n},Sn(n.day)&&(h.day=Math.min(T4(h.year,h.month),h.day))):h=fee({...u$(this.c),...n});const[f,g]=ZC(h,this.o,this.zone);return A0(this,{ts:f,o:g})}plus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e);return A0(this,kee(this,n))}minus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e).negate();return A0(this,kee(this,n))}startOf(e,{useLocaleWeeks:n=!1}={}){if(!this.isValid)return this;const r={},i=dr.normalizeUnit(e);switch(i){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(i==="weeks")if(n){const s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(r.weekNumber=this.weekNumber-1),r.weekday=s}else r.weekday=1;if(i==="quarters"){const s=Math.ceil(this.month/3);r.month=(s-1)*3+1}return this.set(r)}endOf(e,n){return this.isValid?this.plus({[e]:1}).startOf(e,n).minus(1):this}toFormat(e,n={}){return this.isValid?sa.create(this.loc.redefaultToEN(n)).formatDateTimeFromString(this,e):d$}toLocaleString(e=E4,n={}){return this.isValid?sa.create(this.loc.clone(n),e).formatDateTime(this):d$}toLocaleParts(e={}){return this.isValid?sa.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:n=!1,suppressMilliseconds:r=!1,includeOffset:i=!0,extendedZone:s=!1,precision:o="milliseconds"}={}){if(!this.isValid)return null;o=QC(o);const a=e==="extended";let l=m$(this,a,o);return JC.indexOf(o)>=3&&(l+="T"),l+=Aee(this,a,n,r,i,s,o),l}toISODate({format:e="extended",precision:n="day"}={}){return this.isValid?m$(this,e==="extended",QC(n)):null}toISOWeekDate(){return bP(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:n=!1,includeOffset:r=!0,includePrefix:i=!1,extendedZone:s=!1,format:o="extended",precision:a="milliseconds"}={}){return this.isValid?(a=QC(a),(i&&JC.indexOf(a)>=3?"T":"")+Aee(this,o==="extended",n,e,r,s,a)):null}toRFC2822(){return bP(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return bP(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?m$(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:n=!1,includeOffsetSpace:r=!0}={}){let i="HH:mm:ss.SSS";return(n||e)&&(r&&(i+=" "),n?i+="z":e&&(i+="ZZ")),bP(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():d$}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const n={...this.c};return e.includeConfig&&(n.outputCalendar=this.outputCalendar,n.numberingSystem=this.loc.numberingSystem,n.locale=this.loc.locale),n}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,n="milliseconds",r={}){if(!this.isValid||!e.isValid)return dr.invalid("created by diffing an invalid DateTime");const i={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=GFe(n).map(dr.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=H9e(a,l,s,i);return o?c.negate():c}diffNow(e="milliseconds",n={}){return this.diff(hn.now(),e,n)}until(e){return this.isValid?Bi.fromDateTimes(this,e):this}hasSame(e,n,r){if(!this.isValid)return!1;const i=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(n,r)<=i&&i<=s.endOf(n,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const n=e.base||hn.fromObject({},{zone:this.zone}),r=e.padding?this<n?-e.padding:e.padding:0;let i=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(i=e.unit,s=void 0),Pee(n,this.plus(r),{...e,numeric:"always",units:i,unit:s})}toRelativeCalendar(e={}){return this.isValid?Pee(e.base||hn.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(hn.isDateTime))throw new Qo("min requires all arguments be DateTimes");return mee(e,n=>n.valueOf(),Math.min)}static max(...e){if(!e.every(hn.isDateTime))throw new Qo("max requires all arguments be DateTimes");return mee(e,n=>n.valueOf(),Math.max)}static fromFormatExplain(e,n,r={}){const{locale:i=null,numberingSystem:s=null}=r,o=Mr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return wme(o,e,n)}static fromStringExplain(e,n,r={}){return hn.fromFormatExplain(e,n,r)}static buildFormatParser(e,n={}){const{locale:r=null,numberingSystem:i=null}=n,s=Mr.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0});return new xme(s,e)}static fromFormatParser(e,n,r={}){if(Sn(e)||Sn(n))throw new Qo("fromFormatParser requires an input string and a format parser");const{locale:i=null,numberingSystem:s=null}=r,o=Mr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});if(!o.equals(n.locale))throw new Qo(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${n.locale}`);const{result:a,zone:l,specificOffset:c,invalidReason:u}=n.explainFromTokens(e);return u?hn.invalid(u):d_(a,l,r,`format ${n.format}`,e,c)}static get DATE_SHORT(){return E4}static get DATE_MED(){return Tpe}static get DATE_MED_WITH_WEEKDAY(){return gFe}static get DATE_FULL(){return kpe}static get DATE_HUGE(){return Ape}static get TIME_SIMPLE(){return Ipe}static get TIME_WITH_SECONDS(){return Rpe}static get TIME_WITH_SHORT_OFFSET(){return Ppe}static get TIME_WITH_LONG_OFFSET(){return Cpe}static get TIME_24_SIMPLE(){return Mpe}static get TIME_24_WITH_SECONDS(){return Npe}static get TIME_24_WITH_SHORT_OFFSET(){return Ope}static get TIME_24_WITH_LONG_OFFSET(){return Lpe}static get DATETIME_SHORT(){return Dpe}static get DATETIME_SHORT_WITH_SECONDS(){return $pe}static get DATETIME_MED(){return jpe}static get DATETIME_MED_WITH_SECONDS(){return Fpe}static get DATETIME_MED_WITH_WEEKDAY(){return yFe}static get DATETIME_FULL(){return Vpe}static get DATETIME_FULL_WITH_SECONDS(){return zpe}static get DATETIME_HUGE(){return Upe}static get DATETIME_HUGE_WITH_SECONDS(){return Gpe}}function mE(t){if(hn.isDateTime(t))return t;if(t&&t.valueOf&&mg(t.valueOf()))return hn.fromJSDate(t);if(t&&typeof t=="object")return hn.fromObject(t);throw new Qo(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const h7e="shortOffset";function d7e(t){return"timeZoneIANA"in t}function f7e(t){return t.startsWith("UTC")}function EIt(t,e=!1){return{json:{read:{source:t,reader:(n,r)=>r[t]?p7e(r[t]):null},write:!!e&&{allowNull:!0,writer(n,r){r[t]=n?m7e(n):null}}}}}function p7e(t,e=Id){return t?d7e(t)?t.timeZoneIANA:g7e(t,e):e}function m7e(t){return{timeZoneIANA:t}}function g7e(t,e=Id){if(!t||!tee.has(t.timeZone))return e;const n=tee.get(t.timeZone);return f7e(t.timeZone)||t.respectsDaylightSaving?n:y7e(n)}function y7e(t){const e=hn.local().setZone(t),n=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return n===0?"Etc/UTC":`Etc/GMT${aa.instance(-n).formatOffset(0,"narrow")}`}function SIt(t,e,n,r,i){if(e&&i==="date")return{timeZone:Tk,timeZoneName:void 0};const s=r.hour,o=n===QG;return{timeZone:o?i==="timestamp-offset"?void 0:t??Tk:n,timeZoneName:o&&s?h7e:void 0}}function v7e(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),n=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));return t===Id||t===QG||e.has(t.toLowerCase())||n.has(t.toLowerCase())}const _7e={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},x7e={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},Tme={timeZone:Tk},Nh={year:"numeric",month:"numeric",day:"numeric"},gE={year:"numeric",month:"long",day:"numeric"},yE={year:"numeric",month:"short",day:"numeric"},vE={year:"numeric",month:"long",weekday:"long",day:"numeric"},Pm={hour:"numeric",minute:"numeric"},B0={...Pm,second:"numeric"},kme={hourCycle:"h23"},_E={...Pm,...kme},xE={...B0,...kme},Ame={"short-date":Nh,"short-date-short-time":{...Nh,...Pm},"short-date-short-time-24":{...Nh,..._E},"short-date-long-time":{...Nh,...B0},"short-date-long-time-24":{...Nh,...xE},"short-date-le":Nh,"short-date-le-short-time":{...Nh,...Pm},"short-date-le-short-time-24":{...Nh,..._E},"short-date-le-long-time":{...Nh,...B0},"short-date-le-long-time-24":{...Nh,...xE},"long-month-day-year":gE,"long-month-day-year-short-time":{...gE,...Pm},"long-month-day-year-short-time-24":{...gE,..._E},"long-month-day-year-long-time":{...gE,...B0},"long-month-day-year-long-time-24":{...gE,...xE},"day-short-month-year":yE,"day-short-month-year-short-time":{...yE,...Pm},"day-short-month-year-short-time-24":{...yE,..._E},"day-short-month-year-long-time":{...yE,...B0},"day-short-month-year-long-time-24":{...yE,...xE},"long-date":vE,"long-date-short-time":{...vE,...Pm},"long-date-short-time-24":{...vE,..._E},"long-date-long-time":{...vE,...B0},"long-date-long-time-24":{...vE,...xE},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Pm,"long-time":B0},w7e=kl()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Ime={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},b7e=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),E7e=b7e.find(({type:t})=>t==="month")?.value.toLowerCase();function Rme(){const t=ZG();return(t&&Ime[t])??gpe()}E7e!=="mart"&&(Ime.bs="sr-Latn-CS");let YF=new WeakMap;const gO=Ame["short-date-short-time"];function S7e(t){let e=YF.get(t);if(!e){const n=Rme(),r=cB(t.timeZone??Id),i={...t,timeZone:r};e=new Intl.DateTimeFormat(n,i),YF.set(t,e)}return e}function TIt(t){return Ame[t]}function kIt(t){const{dateStyle:e,timeStyle:n,hour12:r,year:i,month:s}=t,o={};return e?o.dateStyle=e:i&&(o.year=i,o.month=s||void 0),n&&!o.year&&(o.timeStyle=n,o.hour12=r==="auto"?void 0:r==="always"),o}function lB(t,e=gO){return S7e(e).format(t)}function AIt(t,e=gO){return lB(new Date(t),{...e,...Tme,...x7e})}function IIt(t,e=gO){return lB(new Date(`1970-01-01T${t}Z`),{...e,...Tme,..._7e})}function RIt(t,e=gO){if(e.timeZone)return lB(new Date(t),e);const n=hn.fromISO(t,{setZone:!0}),r=n.offset===0?Tk:e.timeZone,i={...e,timeZone:r};return n.toLocaleString(i,{locale:Rme()})}function cB(t){switch(t){case Id:return dFe;case QG:return Tk;default:return t}}JG(()=>{YF=new WeakMap});const T7e={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let eM=new WeakMap,Pme={};function XF(t){const e=t||Pme;if(!eM.has(e)){const n=ZG(),r=n&&T7e[n]||gpe();eM.set(e,new Intl.NumberFormat(r,t))}return eM.get(e)}function PIt(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function CIt(t){const{minimumFractionDigits:e,maximumFractionDigits:n,useGrouping:r}=t;return{minimumFractionDigits:e,maximumFractionDigits:n,useGrouping:r==="auto"?"auto":r==="always"}}function MIt(t,e){return Object.is(t,-0)&&(t=0),XF(e).format(t)}function NIt(t,e=eu()){if(!t)return null;let n=Mee.get(e);if(!n){const r=XF().formatToParts(12345.6),i=[...XF({useGrouping:!1}).format(9876543210)].reverse(),s=new Map(i.map((h,f)=>[h,f])),o=new RegExp(`[${r.find(h=>h.type==="group")?.value}]`,"g"),a=new RegExp(`[${r.find(h=>h.type==="decimal")?.value}]`),l=new RegExp(`[${i.join("")}]`,"g"),c=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,u=/[-\u2212\u2013\u2014\u2015]/g;n=h=>{if((h=h.trim().replaceAll(o,"").replace(a,".").replace(l,g=>String(s.get(g))).replaceAll(c,"").replaceAll(u,"-"))==="")return null;const f=Number(h);return isNaN(f)?null:f},Mee.set(e,n)}return n(t)}JG(()=>{eM=new WeakMap,Pme={}});const Mee=new Map;async function k7e(t,e,n,r){const i=e.exec(n);if(!i)throw new Xe("esri-intl:invalid-bundle",`Bundle id "${n}" is not compatible with the pattern "${e}"`);const s=i[1]?`${i[1]}/`:"",o=i[2],a=bpe(r),l=`${s}${o}.json`,c=a?`${s}${o}_${a}.json`:l;let u;try{u=await Nee(t(c))}catch(h){if(c===l)throw new Xe("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:h});try{u=await Nee(t(l))}catch(f){throw new Xe("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:f})}}return u}async function Nee(t){if(Oee.fetchBundleAsset!=null)return Oee.fetchBundleAsset(t);const e=await Qi(t,{responseType:"text"});return JSON.parse(e.data)}let A7e=class{constructor({base:e="",pattern:n,location:r=new URL(window.location.href)}){let i;i=typeof r=="string"?s=>new URL(s,new URL(r,window.location.href)).href:r instanceof URL?s=>new URL(s,r).href:r,this.pattern=typeof n=="string"?new RegExp(`^${n}`):n,this.getAssetUrl=i,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,n){return k7e(this.getAssetUrl,this.matcher,e,n)}};function I7e(t){return new A7e(t)}const Oee={};lFe(I7e({pattern:"esri/",location:Gi}));let ff=class extends Kt{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let n=e==="local"||e==="global"?e:bpe(e??eu())??"global";return n=n==="no"?"nb":n,n}};_([E()],ff.prototype,"apiKey",void 0),_([E()],ff.prototype,"id",void 0),_([E()],ff.prototype,"language",void 0),_([E()],ff.prototype,"places",void 0),_([E()],ff.prototype,"serviceUrl",void 0),_([E()],ff.prototype,"worldview",void 0),ff=_([ue("esri.support.BasemapStyle")],ff);const R7e=ff,Cme=Symbol("BasemapInstance");function DIt(t){return t!=null&&typeof t=="object"&&Cme in t}function dn(t,e,n={}){return uB(t,e,n,Mme)}function hc(t,e,n={}){return uB(t,e,n,Nme)}function uB(t,e,n={},r){let i=null;const s=n.once?(o,a)=>{r(o)&&(Qr(i),e(o,a))}:(o,a)=>{r(o)&&e(o,a)};if(i=O$e(t,s,n.sync,n.equals),n.initial){const o=t();s(o,o)}return i}function $1(t,e,n,r={}){let i=null,s=null,o=null;function a(){i&&s&&(s.remove(),r.onListenerRemove?.(i),i=null,s=null)}function l(u){r.once&&r.once&&Qr(o),n(u)}const c=dn(t,(u,h)=>{a(),Z5(u)&&(i=u,s=B2(u,e,l),r.onListenerAdd?.(u))},{sync:r.sync,initial:!0});return o=qn(()=>{c.remove(),a()}),o}function hB(t,e){return P7e(t,Nme,e)}function P7e(t,e,n){if(ha(n))return Promise.reject(Tr());const r=t();if(e?.(r))return Promise.resolve(r);let i=null;function s(){i=Qr(i)}return new Promise((o,a)=>{i=rv([lu(n,()=>{s(),a(Tr())}),uB(t,l=>{s(),o(l)},{sync:!1,once:!0},e??Mme)])})}function Mme(t){return!0}function Nme(t){return!!t}function $It(t,e,n={}){let r=!1;const i=dn(t,(s,o)=>{r||e(s,o)},n);return{remove(){i.remove()},pause(){r=!0},resume(){r=!1}}}const Dg={sync:!0},fa={initial:!0},ea={sync:!0,initial:!0};let Ome=0;const dB=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Ome++})}};return n=_([ue("esri.core.Identifiable")],n),n},fB=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Ome++})}};return n=_([ue("esri.core.Identifiable.NumericIdentifiable")],n),n};dB(class{});async function C7e(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:n}=await _e(async()=>{const{fromItem:r}=await import("./portalLayers-BlY7XnG4.js");return{fromItem:r}},__vite__mapDeps([92,93,94,95,96,60]));try{return await n(e)}catch(r){const i=e?.portalItem,s=i?.id||"unset",o=i?.portal?.url||Qn.portalUrl;throw Tt.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+s+"')",r),r}}const Lee={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function g$(t,e,n,r=Id){const i=new uh(cB(r)),s=hn.fromJSDate(t,{zone:i}),o=n==="decades"||n==="centuries"?"year":Lme(n);return n==="decades"&&(e*=10),n==="centuries"&&(e*=100),s.plus({[o]:e}).toJSDate()}function jIt(t,e,n="milliseconds"){const r=t.getTime(),i=M7e(e,n,"milliseconds");return new Date(r+i)}function Dee(t,e,n=Id){const r=new uh(cB(n)),i=hn.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const o=i.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const s=Lme(e);return i.startOf(s).toJSDate()}function M7e(t,e,n){return t===0?0:t*Lee[e]/Lee[n]}function FIt(t,e){return t&&e?t.intersection(e):t||e}function Lme(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Ac,pw;let Ea=(pw=class extends qt{static get allTime(){return $ee}static get empty(){return N7e}static fromArray(e){return new Ac({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,n){return n.end!=null?new Date(n.end):null}writeEnd(e,n){n.end=e?.getTime()??null}get isAllTime(){return this.equals(Ac.allTime)}get isEmpty(){return this.equals(Ac.empty)}readStart(e,n){return n.start!=null?new Date(n.start):null}writeStart(e,n){n.start=e?.getTime()??null}clone(){return new Ac({end:this.end,start:this.start})}equals(e){if(!e)return!1;const n=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,i=e.start?.getTime()??e.start,s=e.end?.getTime()??e.end;return n===i&&r===s}expandTo(e,n=Id){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=Dee(r,e,n));let i=this.end;if(i){const s=Dee(i,e,n);i=i.getTime()===s.getTime()?s:g$(s,1,e,n)}return new Ac({start:r,end:i})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Ac.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const n=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,i=e.start?.getTime()??-1/0,s=e.end?.getTime()??1/0;let o,a;return i>=n&&i<=r?o=i:n>=i&&n<=s&&(o=n),r>=i&&r<=s?a=r:s>=n&&s<=r&&(a=s),o==null||a==null||isNaN(o)||isNaN(a)?Ac.empty:new Ac({start:o===-1/0?null:new Date(o),end:a===1/0?null:new Date(a)})}offset(e,n,r=Id){if(this.isEmpty||this.isAllTime)return this.clone();const i=new Ac,{start:s,end:o}=this;return s!=null&&(i.start=g$(s,e,n,r)),o!=null&&(i.end=g$(o,e,n,r)),i}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return $ee.clone();const n=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Ac({start:n,end:r})}},Ac=pw,pw);_([E({type:Date,json:{write:{allowNull:!0}}})],Ea.prototype,"end",void 0),_([or("end")],Ea.prototype,"readEnd",null),_([Xn("end")],Ea.prototype,"writeEnd",null),_([E({readOnly:!0,json:{read:!1}})],Ea.prototype,"isAllTime",null),_([E({readOnly:!0,json:{read:!1}})],Ea.prototype,"isEmpty",null),_([E({type:Date,json:{write:{allowNull:!0}}})],Ea.prototype,"start",void 0),_([or("start")],Ea.prototype,"readStart",null),_([Xn("start")],Ea.prototype,"writeStart",null),Ea=Ac=_([ue("esri.time.TimeExtent")],Ea);const $ee=new Ea,N7e=new Ea({start:void 0,end:void 0});let O7e=0,yi=class extends iO(dB(iI)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Dn(-180,-90,180,90,Bt.WGS84),this.id=Date.now().toString(16)+"-layer-"+O7e++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Bt.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const n=typeof e=="string"?{url:e}:e;return(await _e(async()=>{const{fromUrl:r}=await import("./arcgisLayers-6oP3SkHa.js");return{fromUrl:r}},__vite__mapDeps([97,93,94,96]))).fromUrl(n)}static fromPortalItem(e){return C7e(e)}initialize(){this.when().catch(e=>{ya(e)||Tt.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return Fa(this.url)}createLayerView(e,n){return Promise.reject(new Xe("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Qi(e,{query:{f:"json"},responseType:"json"})).data;throw new Xe("layer:no-attribution-data","Layer does not have attribution data")}};_([E({type:String})],yi.prototype,"attributionDataUrl",void 0),_([E({readOnly:!0})],yi.prototype,"effectiveVisible",null),_([E({type:Dn})],yi.prototype,"fullExtent",void 0),_([E({readOnly:!0})],yi.prototype,"hasAttributionData",null),_([E({type:String,clonable:!1})],yi.prototype,"id",void 0),_([E({type:Boolean,nonNullable:!0})],yi.prototype,"legendEnabled",void 0),_([E({type:["show","hide","hide-children"]})],yi.prototype,"listMode",void 0),_([E({type:Number,range:{min:0,max:1},nonNullable:!0})],yi.prototype,"opacity",void 0),_([E({clonable:!1})],yi.prototype,"parent",void 0),_([E({readOnly:!0})],yi.prototype,"parsedUrl",null),_([E({type:Boolean,readOnly:!0})],yi.prototype,"persistenceEnabled",void 0),_([E({type:Boolean})],yi.prototype,"popupEnabled",void 0),_([E({type:Boolean})],yi.prototype,"attributionVisible",void 0),_([E({type:Bt})],yi.prototype,"spatialReference",void 0),_([E({type:String})],yi.prototype,"title",void 0),_([E({readOnly:!0,json:{read:!1}})],yi.prototype,"type",void 0),_([E()],yi.prototype,"url",void 0),_([E({type:Ea})],yi.prototype,"visibilityTimeExtent",void 0),_([E({type:Boolean,nonNullable:!0})],yi.prototype,"visible",void 0),yi=_([ue("esri.layers.Layer")],yi);const EP=new WeakMap;function Dme(t){return!t.destroyed&&(EP.has(t)||t.addHandles([dn(()=>{const{parent:e}=t;return!!(e&&e instanceof yi)&&(e.type==="catalog-dynamic-group"||Dme(e))},e=>EP.set(t,e),ea),qn(()=>EP.delete(t))]),EP.get(t))}function L7e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function zIt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function D7e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function $7e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function UIt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function jee(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function j_(t){return t?.type==="subtype-sublayer"}const GIt={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function BIt(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function WIt(t){return t.type==="integrated-mesh"||t.type==="integrated-mesh-3dtiles"}function yO(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function HIt(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function j7e(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function qIt(t){return L7e(t)&&j7e(t)}async function KIt(t,e){const n=Kr?.findServerInfo(t);if(n?.currentVersion!=null)return n.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const i=`${t.slice(0,r)}/rest/info`,s=e!=null?e.signal:null,{data:o}=await Qi(i,{query:{f:"json"},responseType:"json",signal:s});return o?.owningSystemUrl||null}function F7e(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function V7e(t){return F7e(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function z7e(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function U7e(t){return!!z7e(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function G7e(t,e){return null}function YIt(t){return null}function B7e(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function XIt(t,e){!e||!B7e(t)||G7e(t.url)}const W7e=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),H7e=new Set(["integrated-mesh-3dtiles"]),$me=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),q7e=new Set([...$me,"link-chart"]);function K7e(t){switch(t.layerContainerType){case"basemap-base-layers":return W7e;case"basemap-ground-layers":return H7e;case"operational-layers":return t.origin==="link-chart"?q7e:$me;default:return null}}function Y7e(t,e){if(e.restrictedWebMapWriting){const n=K7e(e);return n==null||n.has(t.type)&&!yO(t)}return!0}function X7e(t,e){if(e)if(yO(t)){const n=K5("featureCollection.layers",e),r=n?.[0]?.layerDefinition;r&&Fee(t,r)}else t.type!=="group"&&Fee(t,e)}function Fee(t,e){"maxScale"in t&&(e.maxScale=x4(t.maxScale)??void 0),"minScale"in t&&(e.minScale=x4(t.minScale)??void 0)}function Z7e(t,e){if(X7e(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=x4(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(yO(t)){const n=e.featureCollection;n&&(n.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function y$(t,e,n){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return n?.messages&&n.messages.push(new Xe("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(yO(t)&&!t.isTable)e=t.resourceInfo;else if(Y7e(t,n)){const r={};return t.write(r,n)?r:null}return e!=null&&Z7e(t,e=Ze(e)),e}var Vee,F_,i1;let Ka=(i1=class extends Xg(iI){constructor(e){super(e),this[Vee]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+F_.idCounter++,this.baseLayers=new Ot,this.referenceLayers=new Ot,this.groundLayers=new Ot;const n=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this,a.type!=="elevation"&&a.type!=="integrated-mesh-3dtiles"||Tt.getLogger(this).error(`Layer '${a.title}, id:${a.id}' of type '${a.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this},i=a=>{const l=a.item;return l.parent===this?(Tt.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' already a ground layer, second add will be ignored.`),void a.preventDefault()):l.type!=="integrated-mesh-3dtiles"&&l.type!=="integrated-mesh"?(Tt.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' is not supported as a ground layer and will therefore be ignored.`),void a.preventDefault()):void 0},s=a=>{a.parent=null},o=a=>{a.parent===this&&(a.parent=null)};this.addHandles([this.baseLayers.on("after-add",a=>n(a.item)),this.baseLayers.on("after-remove",a=>s(a.item)),this.referenceLayers.on("after-add",a=>n(a.item)),this.referenceLayers.on("after-remove",a=>s(a.item)),this.groundLayers.on("before-add",i),this.groundLayers.on("after-add",a=>r(a.item)),this.groundLayers.on("after-remove",a=>o(a.item))])}initialize(){this.when().catch(e=>{Tt.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const i of e)i.destroyed||i.destroy();const n=this.groundLayers.toArray();for(const i of n)i.destroyed||i.destroy();const r=this.referenceLayers.toArray();for(const i of r)i.destroyed||i.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=Mi(this.portalItem)}removeChildLayer(e){for(const n of[this.baseLayers,this.referenceLayers,this.groundLayers])n.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",pd(e,this._get("baseLayers")))}_writeBaseLayers(e,n,r){const i=[];e&&(r={...r,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(s=>{const o=y$(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&i.push(o)}),this.referenceLayers.forEach(s=>{const o=y$(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&(s.type!=="scene"&&(o.isReference=!0),i.push(o))})),n.baseMapLayers=i}set groundLayers(e){this._set("groundLayers",pd(e,this._get("groundLayers")))}_writeGroundLayers(e,n,r){const i=[];e&&(r={...r,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(s=>{const o=y$(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&i.push(o)}),i.length>0&&(n.groundLayers=i))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",pd(e,this._get("referenceLayers")))}writeTitle(e,n){n.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Ufe(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(n=>YS(n)?n.clone():n),groundLayers:this.groundLayers.map(n=>YS(n)?n.clone():n),referenceLayers:this.referenceLayers.map(n=>YS(n)?n.clone():n)};return this.loaded&&(e.loadStatus="loaded"),new F_({resourceInfo:this.resourceInfo}).set(e)}read(e,n){this.resourceInfo||this._set("resourceInfo",{data:e,context:n}),super.read(e,n)}write(e,n){return e=e||{},n?.origin||(n={origin:"web-map",...n}),super.write(e,n),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(r=>{const i=Ze(r);return i.url&&Td(i.url)&&(i.url=`https:${i.url}`),i.templateUrl&&Td(i.templateUrl)&&(i.templateUrl=`https:${i.templateUrl}`),i})),e}async _loadFromSource(e){const{resourceInfo:n,portalItem:r,style:i}=this;hi(e);const s=[];if(n){const o=n.context?n.context.url:null;if(s.push(this._loadLayersFromJSON(n.data,o,e)),n.data.id&&!n.data.title){const a=n.data.id;s.push(hFe(a).then(l=>{l&&this.read({title:l},n.context)}))}}else r?s.push(this._loadFromItem(r,e)):i&&s.push(this._loadFromStylesService(i,e));await Promise.all(s)}async _loadLayersFromJSON(e,n,r){const i=this.resourceInfo?.context,s=this.portalItem?.portal||i?.portal||null,o=Q7e[i?.origin||""]??"web-map",{populateOperationalLayers:a}=await _e(async()=>{const{populateOperationalLayers:c}=await import("./layersCreator-CitNrbkO.js");return{populateOperationalLayers:c}},__vite__mapDeps([98,95,94,93,96,92,60,99])),l=[];if(hi(r),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const c={context:{...i,origin:o,url:n,portal:s,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},u=g=>o==="web-scene"&&g.layerType==="ArcGISSceneServiceLayer"||g.isReference,h=a(this.baseLayers,e.baseMapLayers.filter(g=>!u(g)),c);l.push(h);const f=a(this.referenceLayers,e.baseMapLayers.filter(u),c);l.push(f)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const c={context:{...i,origin:o,url:n,portal:s,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},u=a(this.groundLayers,e.groundLayers,c);l.push(u)}await Promise.allSettled(l)}async _loadFromItem(e,n){const r=await e.load(n),i=await r.fetchData("json",n),s=Fa(e.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:J7e[e.type||""]??"web-map",portal:e.portal||it.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||it.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,n)}async _loadFromStylesService(e,n){const r=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,i=`${r}/styles/${e.id}/self`,s=`${r}/webmaps/${e.id}`,o=e.apiKey??Qn.apiKeys.basemapStyles,[a,l]=await Promise.all([(await Qi(i,{query:{token:o},signal:n?.signal})).data,(await Qi(s,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:n?.signal})).data]);this.thumbnailUrl??=a.thumbnailUrl;const c=Fa(s);if(this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:c}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:l.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,c,n),o)for(const u of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in u&&(u.apiKey=o)}static fromId(e){const n=$F[e];return n?n.itemId?new F_({portalItem:{id:n.itemId,portal:{url:"https://www.arcgis.com"}}}):F_.fromJSON(n,n.is3d?{origin:"web-scene",portal:new it({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},Vee=Cme,F_=i1,i1.idCounter=0,i1);_([E({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,n,r){this._writeBaseLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Ot}},writer(t,e,n,r){this._writeBaseLayers(t,e,r)}}}}}})],Ka.prototype,"baseLayers",null),_([E({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(t,e,n,r){this._writeGroundLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:Ot}},writer(t,e,n,r){this._writeGroundLayers(t,e,r)}}}}}})],Ka.prototype,"groundLayers",null),_([E({type:String,json:{origins:{"web-scene":{write:!0}}}})],Ka.prototype,"id",void 0),_([E({type:vn})],Ka.prototype,"portalItem",void 0),_([E()],Ka.prototype,"referenceLayers",null),_([E({readOnly:!0})],Ka.prototype,"resourceInfo",void 0),_([E({type:Bt})],Ka.prototype,"spatialReference",void 0),_([E({type:R7e})],Ka.prototype,"style",void 0),_([E()],Ka.prototype,"thumbnailUrl",void 0),_([E({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Ka.prototype,"title",void 0),_([Xn("title")],Ka.prototype,"writeTitle",null),Ka=F_=_([ue("esri.Basemap")],Ka);const J7e={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},Q7e={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},eT=Ka,eVe=Object.freeze(Object.defineProperty({__proto__:null,default:eT},Symbol.toStringTag,{value:"Module"})),A4={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function tVe(t){return!!A4[t]||!!A4[t.toLowerCase()]}function jme(t){return A4[t]??A4[t.toLowerCase()]}function ZIt(t){return[...jme(t)]}function v$(t,e,n){n<0&&++n,n>1&&--n;const r=6*n;return r<1?t+(e-t)*r:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function nVe(t,e,n,r=1){const i=(t%360+360)%360/360,s=n<=.5?n*(e+1):n+e-n*e,o=2*n-s;return[Math.round(255*v$(o,s,i+1/3)),Math.round(255*v$(o,s,i)),Math.round(255*v$(o,s,i-1/3)),r]}function JIt(t){const e=t.length>5,n=e?8:4,r=(1<<n)-1,i=e?1:17,s=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return s&&(l=o&r,o>>=n,a[3]=i*l/255),l=o&r,o>>=n,a[2]=i*l,l=o&r,o>>=n,a[1]=i*l,l=o&r,o>>=n,a[0]=i*l,a}function Fme(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),n=parseInt(t.slice(2,3),16),r=parseInt(t.slice(3,4),16),i=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,n+16*n,r+16*r,(i+16*i)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function Vme(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const n=e[2].split(/\s*,\s*/),r=e[1];if(r==="rgb"&&n.length===3||r==="rgba"&&n.length===4){if(n[0].endsWith("%")){const i=n.map(s=>2.56*parseFloat(s));return n.length===4&&(i[3]=parseFloat(n[3])),zee(i)}return zee(n.map(i=>parseFloat(i)))}if(r==="hsl"&&n.length===3||r==="hsla"&&n.length===4)return nVe(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3]??"1"))}return null}function zee(t){return t[0]=Kx(t[0]),t[1]=Kx(t[1]),t[2]=Kx(t[2]),t[3]=t.length===4?Ume(t[3]):1,t}function zme(t){let e=tVe(t)?jme(t):null;return e??=Vme(t),e??=Fme(t),e}function QIt(t){const e=zme(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function Ume(t){return Gme(t,0,1)}function Kx(t){return Math.round(Gme(t,0,255))}function Gme(t,e,n){return t=Number(t),isNaN(t)?n:t<e?e:t>n?n:t}const Bme=2.2,rVe=1/Bme;function eRt(t){return t**Bme}function tRt(t){return t**rVe}const Uee=new Float32Array(1);function nRt(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function cu(t,e,n){return Math.min(Math.max(t,e),n)}function rRt(t){return!(t&t-1)}function iRt(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function eS(t,e,n){return t+(e-t)*n}function sRt(t,e,n,r,i){return eS(r,i,(t-e)/(n-e))}function uI(t){return t*Math.PI/180}function Wme(t){return 180*t/Math.PI}function oRt(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function aRt(t){return Math.acos(cu(t,-1,1))}function iVe(t){return Math.asin(cu(t,-1,1))}function gg(t,e,n=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=n}function lRt(t,e,n=1e-6){return!gg(t,e,n)&&t>e}function cRt(t,e,n=1e-6){return!gg(t,e,n)&&t<e}function uRt(t,e,n=1e-6){return gg(t,e,n)||t>e}const I4=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function ZF(t){return I4.setFloat64(0,t),I4.getBigInt64(0)}function sVe(t){return I4.setBigInt64(0,t),I4.getFloat64(0)}const tM=1000000n,oVe=Hme(1);function Hme(t){const e=ZF(t=Math.abs(t)),n=sVe(e<=tM?tM:e-tM);return Math.abs(t-n)}function hRt(t,e,n=oVe){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(n!=null&&Hme(Math.min(Math.abs(t),Math.abs(e)))<n)return Math.abs(t-e)<=n;const r=ZF(t),i=ZF(e);return r<0!=i<0?!1:!((r<i?i-r:r-i)>tM)}function qme(t,e,n=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const r=Math.abs(t-e),i=Math.abs(t),s=Math.abs(e);if(t===0||e===0||i<1e-12&&s<1e-12){if(r>.01*n)return!1}else if(r/(i+s)>n)return!1;return!0}function dRt(t){return Kme(Math.max(-Gee,Math.min(t,Gee)))}function Kme(t){return Uee[0]=t,Uee[0]}function fRt(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(gg(e,1)&&gg(n,1)&&gg(r,1))}function pRt(t,e){return(t%e+e)%e}const Gee=Kme(34028234663852886e22);function mRt(t,e,n){if(n===void 0||+n==0)return Math[t](e);if(e=+e,n=+n,isNaN(e)||typeof n!="number"||n%1!=0)return NaN;let r=e.toString().split("e");return r=(e=Math[t](+(r[0]+"e"+(r[1]?+r[1]-n:-n)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+n:n))}function SP(t){return cu(NG(t),0,255)}function TP(t,e){const n=t.toString(16).padStart(2,"0");return e?n.slice(0,1):n}let Kn=class Ic{static blendColors(e,n,r,i=new Ic){return i.r=Math.round(e.r+(n.r-e.r)*r),i.g=Math.round(e.g+(n.g-e.g)*r),i.b=Math.round(e.b+(n.b-e.b)*r),i.a=e.a+(n.a-e.a)*r,i._sanitize()}static fromRgb(e,n){const r=Vme(e);return r?Ic.fromArray(r,n):null}static fromHex(e,n=new Ic){const r=Fme(e);return r?Ic.fromArray(r,n):null}static fromArray(e,n=new Ic){return n._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(n.a)&&(n.a=1),n._sanitize()}static fromString(e,n){const r=zme(e);return r?Ic.fromArray(r,n):null}static fromJSON(e){return e!=null?new Ic([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,n){return e==null?null:(n??=[0,0,0,0],n[0]=e.r/255,n[1]=e.g/255,n[2]=e.b/255,n[3]=e.a!=null?e.a:1,n)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Ic.fromString(e,this):Array.isArray(e)?Ic.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Ic||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const n=e?.capitalize??!1,r=e?.digits??6,i=r===3||r===4,s=r===4||r===8,o=`#${TP(this.r,i)}${TP(this.g,i)}${TP(this.b,i)}${s?TP(Math.round(255*this.a),i):""}`;return n?o.toUpperCase():o}toCss(e=!1){const n=this.r+", "+this.g+", "+this.b;return e?`rgba(${n}, ${this.a})`:`rgb(${n})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const n=SP(this.r),r=SP(this.g),i=SP(this.b);return e===0||this.a!==1?[n,r,i,SP(255*this.a)]:[n,r,i]}clone(){return new Ic(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Kx(this.r),this.g=Kx(this.g),this.b=Kx(this.b),this.a=Ume(this.a),this}_set(e,n,r,i){this.r=e,this.g=n,this.b=r,this.a=i}};Kn.prototype.declaredClass="esri.Color";let Hu=class extends Ot{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(E$e(()=>this._refresh(),Dg))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections?.();if(e==null)return void this.removeAll();let n=0;for(const r of e)r!=null&&(n=this._processCollection(n,r));this.splice(n)}_createNewInstance(e){return new Ot(e)}_processCollection(e,n){if(!n)return e;const r=this.itemFilterFunction??(i=>!!i);for(const i of n)if(i){if(r(i)){const s=this.indexOf(i,e);s>=0?s!==e&&this.reorder(i,e):this.add(i,e),++e}if(this.getChildrenFunction){const s=this.getChildrenFunction(i);if(Array.isArray(s))for(const o of s)e=this._processCollection(e,o);else e=this._processCollection(e,s)}}return e}};_([E()],Hu.prototype,"getCollections",void 0),_([E()],Hu.prototype,"getChildrenFunction",void 0),_([E()],Hu.prototype,"itemFilterFunction",void 0),Hu=_([ue("esri.core.CollectionFlattener")],Hu);function pn(t,e={}){const n=t instanceof Gs?t:new Gs(t,e),{alwaysWriteDefaults:r,default:i,ignoreUnknown:s=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return E({type:s?n.apiValues:String,json:{type:n.jsonValues,default:i,name:o,read:!l&&{reader:n.read},write:{writer:n.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:l})}var JF;let nM=JF=class extends qt{constructor(t){super(t),this.type="none"}clone(){return new JF({type:this.type})}};_([pn({none:"none",stayAbove:"stay-above"}),E({json:{write:{isRequired:!0}}})],nM.prototype,"type",void 0),nM=JF=_([ue("esri.ground.NavigationConstraint")],nM);const Yme=Symbol("GroundInstance");function yRt(t){return t!=null&&typeof t=="object"&&Yme in t}function Xme(t){const e=NG(100*(1-t));return Math.max(0,Math.min(e,100))}function Zme(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var Bee,QF,Loe;let Rc=QF=(Loe=class extends Xg(iI){constructor(t){super(t),this[Bee]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Ot;const e=r=>{const{parent:i}=r;i&&i!==this&&"remove"in i&&i.remove?.(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&Tt.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},n=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>n(r.item))]),this.allLayers=new Hu({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(t){this.layers.remove(t)}initialize(){this.when().catch(t=>{ya(t)||Tt.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const t=this.parent?.basemap?.groundLayers.at(0);return t?.replacesTerrain?t:null}destroy(){const t=this.layers.removeAll();for(const e of t)Mi(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(t){this._set("layers",pd(t,this._get("layers")))}writeLayers(t,e,n,r){const i=[];t&&(r={...r,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const o={};ZLe(s)().write(o,r)&&i.push(o)}else r?.messages&&r.messages.push(new Xe("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=i}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return Ufe(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e?.signal});const{queryAll:n}=await _e(()=>import("./ElevationQuery-9WHXmw90.js"),__vite__mapDeps([100,101]));return hi(e),n(this.layers.filter(Wee).toArray(),t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{createSampler:n}=await _e(()=>import("./ElevationQuery-9WHXmw90.js"),__vite__mapDeps([100,101]));return hi(e),n(this.layers.filter(Wee).toArray(),t,e)}clone(){const t={opacity:this.opacity,surfaceColor:Ze(this.surfaceColor),navigationConstraint:Ze(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new QF({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,n){const r=e?.origin||"web-scene",i=e?.portal||null,s=e?.url||null,{populateOperationalLayers:o}=await _e(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-CitNrbkO.js");return{populateOperationalLayers:l}},__vite__mapDeps([98,95,94,93,96,92,60,99]));hi(n);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:r,url:s,portal:i,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}},Bee=Yme,Loe);function Wee(t){return t&&"createElevationSampler"in t}_([E()],Rc.prototype,"parent",void 0),_([E()],Rc.prototype,"integratedMeshGround",null),_([E({json:{read:!1,write:{isRequired:!0}}})],Rc.prototype,"layers",null),_([E()],Rc.prototype,"allLayers",void 0),_([Xn("layers")],Rc.prototype,"writeLayers",null),_([E({readOnly:!0})],Rc.prototype,"resourceInfo",void 0),_([E({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Or,read:{reader:Zme,source:"transparency"},write:{writer:(t,e)=>{e.transparency=Xme(t)},target:"transparency"}}})],Rc.prototype,"opacity",void 0),_([E({type:Kn,json:{type:[Or],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Rc.prototype,"surfaceColor",void 0),_([E({type:nM,json:{write:!0}})],Rc.prototype,"navigationConstraint",void 0),Rc=QF=_([ue("esri.Ground")],Rc);const R4=Rc,aVe=Symbol("ClonableMixin"),fo=t=>{var i;var e;const n=t;let r=(i=class extends n{constructor(){super(...arguments),this[e]=!0}clone(s){const o=Cg(this);Lde(o,"unable to clone instance of non-accessor class");const a=o.metadata,l=o.store,c={},u=new Map;for(const f in a){const g=a[f],v=l?.originOf(f),x=g.clonable;if(g.readOnly||x===!1||v!==7&&v!==0&&v!==5&&v!==4)continue;const b=this[f];let T=null;if(typeof x=="function")T=x(b,s);else if(x==="reference")T=b;else if(T=sF(b,s),b!=null&&T==null)continue;v===0?u.set(f,T):c[f]=T}const h=new(Object.getPrototypeOf(this)).constructor(c);if(u.size){const f=Cg(h)?.store;if(f)for(const[g,v]of u)f.set(g,v,0)}return h}},e=aVe,i);return r=_([ue("esri.core.Clonable")],r),r},pB=fo(Kt),lVe="randomUUID"in crypto;function hI(){if(lVe)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=n=>t[n].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function vRt(){return`{${hI().toUpperCase()}}`}function _Rt(){return`{${hI()}}`}function xRt(t){const e=t.toUpperCase();return t.startsWith("{")?e:`{${e}}`}const f_={Base64:0,Hex:1,String:2,Raw:3},Yx=8,Jme=(1<<Yx)-1;function Ym(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function cVe(t){const e=[];for(let n=0,r=t.length*Yx;n<r;n+=Yx)e[n>>5]|=(t.charCodeAt(n/Yx)&Jme)<<n%32;return e}function uVe(t){const e=[];for(let n=0,r=32*t.length;n<r;n+=Yx)e.push(String.fromCharCode(t[n>>5]>>>n%32&Jme));return e.join("")}function hVe(t){const e="0123456789abcdef",n=[];for(let r=0,i=4*t.length;r<i;r++)n.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return n.join("")}function dVe(t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let i=0,s=4*t.length;i<s;i+=3){const o=(t[i>>2]>>i%4*8&255)<<16|(t[i+1>>2]>>(i+1)%4*8&255)<<8|t[i+2>>2]>>(i+2)%4*8&255;for(let a=0;a<4;a++)8*i+6*a>32*t.length?r.push("="):r.push(n.charAt(o>>6*(3-a)&63))}return r.join("")}function fVe(t,e){return t<<e|t>>>32-e}function vO(t,e,n,r,i,s){return Ym(fVe(Ym(Ym(e,t),Ym(r,s)),i),n)}function zo(t,e,n,r,i,s,o){return vO(e&n|~e&r,t,e,i,s,o)}function Uo(t,e,n,r,i,s,o){return vO(e&r|n&~r,t,e,i,s,o)}function Go(t,e,n,r,i,s,o){return vO(e^n^r,t,e,i,s,o)}function Bo(t,e,n,r,i,s,o){return vO(n^(e|~r),t,e,i,s,o)}function pVe(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const a=n,l=r,c=i,u=s;n=zo(n,r,i,s,t[o],7,-680876936),s=zo(s,n,r,i,t[o+1],12,-389564586),i=zo(i,s,n,r,t[o+2],17,606105819),r=zo(r,i,s,n,t[o+3],22,-1044525330),n=zo(n,r,i,s,t[o+4],7,-176418897),s=zo(s,n,r,i,t[o+5],12,1200080426),i=zo(i,s,n,r,t[o+6],17,-1473231341),r=zo(r,i,s,n,t[o+7],22,-45705983),n=zo(n,r,i,s,t[o+8],7,1770035416),s=zo(s,n,r,i,t[o+9],12,-1958414417),i=zo(i,s,n,r,t[o+10],17,-42063),r=zo(r,i,s,n,t[o+11],22,-1990404162),n=zo(n,r,i,s,t[o+12],7,1804603682),s=zo(s,n,r,i,t[o+13],12,-40341101),i=zo(i,s,n,r,t[o+14],17,-1502002290),r=zo(r,i,s,n,t[o+15],22,1236535329),n=Uo(n,r,i,s,t[o+1],5,-165796510),s=Uo(s,n,r,i,t[o+6],9,-1069501632),i=Uo(i,s,n,r,t[o+11],14,643717713),r=Uo(r,i,s,n,t[o],20,-373897302),n=Uo(n,r,i,s,t[o+5],5,-701558691),s=Uo(s,n,r,i,t[o+10],9,38016083),i=Uo(i,s,n,r,t[o+15],14,-660478335),r=Uo(r,i,s,n,t[o+4],20,-405537848),n=Uo(n,r,i,s,t[o+9],5,568446438),s=Uo(s,n,r,i,t[o+14],9,-1019803690),i=Uo(i,s,n,r,t[o+3],14,-187363961),r=Uo(r,i,s,n,t[o+8],20,1163531501),n=Uo(n,r,i,s,t[o+13],5,-1444681467),s=Uo(s,n,r,i,t[o+2],9,-51403784),i=Uo(i,s,n,r,t[o+7],14,1735328473),r=Uo(r,i,s,n,t[o+12],20,-1926607734),n=Go(n,r,i,s,t[o+5],4,-378558),s=Go(s,n,r,i,t[o+8],11,-2022574463),i=Go(i,s,n,r,t[o+11],16,1839030562),r=Go(r,i,s,n,t[o+14],23,-35309556),n=Go(n,r,i,s,t[o+1],4,-1530992060),s=Go(s,n,r,i,t[o+4],11,1272893353),i=Go(i,s,n,r,t[o+7],16,-155497632),r=Go(r,i,s,n,t[o+10],23,-1094730640),n=Go(n,r,i,s,t[o+13],4,681279174),s=Go(s,n,r,i,t[o],11,-358537222),i=Go(i,s,n,r,t[o+3],16,-722521979),r=Go(r,i,s,n,t[o+6],23,76029189),n=Go(n,r,i,s,t[o+9],4,-640364487),s=Go(s,n,r,i,t[o+12],11,-421815835),i=Go(i,s,n,r,t[o+15],16,530742520),r=Go(r,i,s,n,t[o+2],23,-995338651),n=Bo(n,r,i,s,t[o],6,-198630844),s=Bo(s,n,r,i,t[o+7],10,1126891415),i=Bo(i,s,n,r,t[o+14],15,-1416354905),r=Bo(r,i,s,n,t[o+5],21,-57434055),n=Bo(n,r,i,s,t[o+12],6,1700485571),s=Bo(s,n,r,i,t[o+3],10,-1894986606),i=Bo(i,s,n,r,t[o+10],15,-1051523),r=Bo(r,i,s,n,t[o+1],21,-2054922799),n=Bo(n,r,i,s,t[o+8],6,1873313359),s=Bo(s,n,r,i,t[o+15],10,-30611744),i=Bo(i,s,n,r,t[o+6],15,-1560198380),r=Bo(r,i,s,n,t[o+13],21,1309151649),n=Bo(n,r,i,s,t[o+4],6,-145523070),s=Bo(s,n,r,i,t[o+11],10,-1120210379),i=Bo(i,s,n,r,t[o+2],15,718787259),r=Bo(r,i,s,n,t[o+9],21,-343485551),n=Ym(n,a),r=Ym(r,l),i=Ym(i,c),s=Ym(s,u)}return[n,r,i,s]}function mVe(t,e=f_.Hex){const n=e||f_.Base64,r=pVe(cVe(t),t.length*Yx);switch(n){case f_.Raw:return r;case f_.Hex:return hVe(r);case f_.String:return uVe(r);case f_.Base64:return dVe(r)}}function gVe(t){return t&&"getAtOrigin"in t&&"originOf"in t}function e9(t){return mB[yVe(t)]||_Ve}function yVe(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:vVe(t.url)}function vVe(t){const e=Ide(t);return t9[e]||Qme}const mB={},Qme="text/plain",_Ve=mB[Qme],t9={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in t9)mB[t9[t]]=t;function xVe(t){const e=t?.origins??[void 0];return(n,r)=>{const i=wVe(t,n,r);for(const s of e){const o=LG(n,s,r);for(const a in i)o[a]=i[a]}}}function wVe(t,e,n){if(t?.type==="resource")return bVe(t,e,n);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:r,write:i}=s6e;return{read:r,write:i}}}}function bVe(t,e,n){const r=tI(e,n);return{type:String,read:(i,s,o)=>{const a=J5(i,s,o);return r.type===String?a:typeof r.type=="function"?new r.type({url:a}):void 0},write:{isRequired:r.json?.write?.isRequired,writer(i,s,o,a){if(!a?.resources)return typeof i=="string"?void(s[o]=n2(i,a)):void(s[o]=i.write({},a));const l=TVe(i),c=n2(l,{...a,verifyItemRelativeUrls:a?.verifyItemRelativeUrls?{writtenUrls:a.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1),u=r.type!==String&&(!gVe(this)||a?.origin&&this.originIdOf(n)>RG(a.origin)),h={object:this,propertyName:n,value:i,targetUrl:c,dest:s,targetPropertyName:o,context:a,params:t};a?.portalItem&&c&&!vl(c)?u&&t?.contentAddressed?n9(h):u?EVe(h):SVe(h):a?.portalItem&&(c==null||jde(c)!=null||XA(c)||u)?n9(h):s[o]=c}}}}function n9(t){const{targetUrl:e,params:n,value:r,context:i,dest:s,targetPropertyName:o}=t;if(!i.portalItem)return;const a=Fde(e),l=tge(r,e,i);if(n?.contentAddressed&&l.type!=="json")return void i.messages?.push(new Xe("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${l.type} with content addressing. Content addressing is only supported for json resources.`,{content:l}));const c=n?.contentAddressed&&l.type==="json"?mVe(l.jsonString):a?.filename??hI(),u=YA(n?.prefix??a?.prefix,c),h=`${u}.${e9(l)}`;if(n?.contentAddressed&&i.resources&&l.type==="json"){const v=i.resources.toKeep.find(({resource:x})=>x.path===h)??i.resources.toAdd.find(({resource:x})=>x.path===h);if(v)return void(s[o]=v.resource.itemRelativeUrl)}const f=i.portalItem.resourceFromPath(h);XA(e)&&i.resources&&i.resources.pendingOperations.push(MDe(e).then(v=>{f.path=`${u}.${e9({type:"blob",blob:v})}`,s[o]=f.itemRelativeUrl}).catch(()=>{}));const g=n?.compress??!1;i.resources&&ege({...t,resource:f,content:l,compress:g,updates:i.resources.toAdd}),s[o]=f.itemRelativeUrl}function EVe(t){const{context:e,targetUrl:n,params:r,value:i,dest:s,targetPropertyName:o}=t;if(!e.portalItem)return;const a=e.portalItem.resourceFromPath(n),l=tge(i,n,e),c=e9(l),u=Ide(a.path),h=r?.compress??!1;c===u?(e.resources&&ege({...t,resource:a,content:l,compress:h,updates:e.resources.toUpdate}),s[o]=n):n9(t)}function SVe({context:t,targetUrl:e,dest:n,targetPropertyName:r}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),n[r]=e)}function ege({object:t,propertyName:e,updates:n,resource:r,content:i,compress:s}){const o=a=>{kVe(t,e,a)};n.push({resource:r,content:i,compress:s,finish:o})}function tge(t,e,n){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(n))}}function TVe(t){return t==null?null:typeof t=="string"?t:t.url}function kVe(t,e,n){typeof t[e]=="string"?t[e]=n.url:t[e].url=n.url}let rM=class extends fo(qt){constructor(e){super(e),this.color=null}};_([E({type:Kn,json:{type:[Or],write:!0}})],rM.prototype,"color",void 0),rM=_([ue("esri.effects.FocusAreaOutline")],rM);const AVe=rM;function bRt(t){const e=[];for(t.reset();t.nextPath();){const n=[];for(;t.nextPoint();)n.push([t.x,t.y]);e.push(n)}return t.reset(),e}function IVe(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function ERt(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,n=t.hasM;if(t.type==="point")return n&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:n?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.map(r=>[r]);if(t.type==="extent"){const r=t.clone().normalize();if(!r)return null;let i=!1,s=!1;return r.forEach(o=>{o.hasZ&&(i=!0),o.hasM&&(s=!0)}),r.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(s&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a})}return null}function _O(t,e){const n=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}return Math.sqrt(n*n+r*r)}function nge(t,e,n){const r=t[0]+n*(e[0]-t[0]),i=t[1]+n*(e[1]-t[1]);return t.length>2&&e.length>2?[r,i,t[2]+n*(e[2]-t[2])]:[r,i]}function RVe(t,e,n,r){return PVe(t,e,n[r],n[r+1])}function PVe(t,e,n,r){const[i,s]=e,[o,a]=n,[l,c]=r,u=l-o,h=c-a,f=u*u+h*h,g=(i-o)*u+(s-a)*h,v=Math.min(1,Math.max(0,g/f));return t[0]=o+u*v,t[1]=a+h*v,t}function SRt(t,e,n,r,i,s){let o=n,a=r,l=i-o,c=s-a;if(l!==0||c!==0){const u=((t-o)*l+(e-a)*c)/(l*l+c*c);u>1?(o=i,a=s):u>0&&(o+=l*u,a+=c*u)}return l=t-o,c=e-a,l*l+c*c}function rge(t,e){return nge(t,e,.5)}function TRt(t){const e=t.length;let n=0;for(let r=0;r<e-1;++r)n+=_O(t[r],t[r+1]);return n}function kRt(t,e){if(e<=0)return t[0];const n=t.length;let r=0;for(let i=0;i<n-1;++i){const s=_O(t[i],t[i+1]);if(e-r<s){const o=(e-r)/s;return nge(t[i],t[i+1],o)}r+=s}return t[n-1]}function ige(t,e=0,n=1){let r=0;const i=t.length;let s=t[0];for(let o=1;o<i;o++){const a=t[o];r+=(a[e]-s[e])*(a[n]+s[n]),s=a}if(sge(t)){const o=t[0];r+=(o[e]-s[e])*(o[n]+s[n])}return r>=0}function sge(t){const e=t.length;return e>0&&!W5(t[0],t[e-1])}function ARt(t){"rings"in t&&(CVe(t),MVe(t))}function CVe(t){if("rings"in t)for(const e of t.rings)sge(e)&&e.push(e[0].slice())}function MVe(t){if(!("rings"in t)||t.rings.length===0||ige(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function IRt(t){return t.type!=="polygon"&&t.type!=="polyline"||NVe(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function NVe(t,e){const n=La(e);if(!n)return;const r=n.valid[0],i=n.valid[1],s=i-r;for(const o of t){let a=1/0,l=-1/0;for(const u of o){const h=OVe(u[0],r,i);a=Math.min(a,h),l=Math.max(l,h),u[0]=h}const c=l-a;s-c<c&&o.forEach(u=>{u[0]<0&&(u[0]+=s)})}}function OVe(t,e,n){const r=n-e;return t<e?n-(e-t)%r:t>n?e+(t-e)%r:t}function RRt(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[n,r]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return n.length===r.length&&n.every((i,s)=>i.length===r[s].length)}function PRt(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function LVe(t){return $Ve(t.rings,t.hasZ??!1)}function DVe(t){const e=LVe(t);if(!e)return null;const{hasZ:n,spatialReference:r}=t,[i,s,o]=e;return isNaN(i)||isNaN(s)||n&&isNaN(o)?null:{x:i,y:s,z:n?o:void 0,spatialReference:r}}function $Ve(t,e){if(!t?.length)return null;const n=[],r=[],i=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=t.length;s<o;s++){const a=oge(t[s],e,i);a&&r.push(a)}if(r.sort((s,o)=>{let a=s[2]-o[2];return a===0&&e&&(a=s[4]-o[4]),a}),r.length&&(n[0]=r[0][0],n[1]=r[0][1],e&&(n[2]=r[0][3]),(n[0]<i[0]||n[0]>i[1]||n[1]<i[2]||n[1]>i[3]||e&&(n[2]<i[4]||n[2]>i[5]))&&(n.length=0)),!n.length){const s=t[0]&&t[0].length?jVe(t[0],e):null;if(!s)return null;n[0]=s[0],n[1]=s[1],e&&s.length>2&&(n[2]=s[2])}return n}function oge(t,e,n){let r=0,i=0,s=0,o=0,a=0;const l=t.length?t[0][0]:0,c=t.length?t[0][1]:0,u=t.length&&e?t[0][2]:0;for(let f=0;f<t.length;f++){const g=t[f],v=t[(f+1)%t.length],[x,b,T]=g,A=x-l,I=b-c,[R,M,F]=v,C=R-l,N=M-c,O=A*N-C*I;if(o+=O,r+=(A+C)*O,i+=(I+N)*O,e&&g.length>2&&v.length>2){const j=T-u,V=F-u,W=A*V-C*j;s+=(j+V)*W,a+=W}x<n[0]&&(n[0]=x),x>n[1]&&(n[1]=x),b<n[2]&&(n[2]=b),b>n[3]&&(n[3]=b),e&&(T<n[4]&&(n[4]=T),T>n[5]&&(n[5]=T))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[r/(6*o)+l,i/(6*o)+c,o];return e&&(n[4]===n[5]||a===0?(h[3]=(n[4]+n[5])/2,h[4]=0):(h[3]=s/(6*a)+u,h[4]=a)),h}function CRt(t,e){let n=0,r=0,i=0;t.nextPoint();const s=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const c=[t.x,t.y],[u,h]=l,f=u-s,g=h-o,[v,x]=c,b=v-s,T=x-o,A=f*T-b*g;i+=A,n+=(f+b)*A,r+=(g+T)*A,u<e[0]&&(e[0]=u),u>e[1]&&(e[1]=u),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}return i>0&&(i*=-1),i?(i*=.5,[n/(6*i)+s,r/(6*i)+o,i]):null}function jVe(t,e){const n=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let i=0,s=0,o=0,a=0;for(let l=0,c=t.length;l<c-1;l++){const u=t[l],h=t[l+1];if(u&&h){n[0]=u[0],n[1]=u[1],r[0]=h[0],r[1]=h[1],e&&u.length>2&&h.length>2&&(n[2]=u[2],r[2]=h[2]);const f=_O(n,r);if(f){i+=f;const g=rge(u,h);s+=f*g[0],o+=f*g[1],e&&g.length>2&&(a+=f*g[2])}}}return i>0?e?[s/i,o/i,a/i]:[s/i,o/i]:t.length?t[0]:null}function FVe(t){const{hasZ:e,totalSize:n}=t;if(n===0)return null;const r=[],i=[],s=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=oge(IVe(t),t.hasZ,s);o&&i.push(o)}if(i.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const o=t.pathSize?VVe(t):null;if(!o)return null;r[0]=o[0],r[1]=o[1],e&&o.length>2&&(r[2]=o[2])}return r}function VVe(t){const{hasZ:e}=t,n=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let i=0,s=0,o=0,a=0;if(t.nextPoint()){let l=t.x,c=t.y,u=t.z;for(;t.nextPoint();){const h=t.x,f=t.y,g=t.z;n[0]=l,n[1]=c,r[0]=h,r[1]=f,e&&(n[2]=u,r[2]=g);const v=_O(n,r);if(v){i+=v;const x=rge(n,r);s+=v*x[0],o+=v*x[1],e&&x.length>2&&(a+=v*x[2])}l=h,c=f,u=g}}return i>0?e?[s/i,o/i,a/i]:[s/i,o/i]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const zVe=1e-6;function MRt(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<zVe){const i=FVe(t);return i?[i[0],i[1]]:null}const n=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)GVe(n,r,t);return n[0]*=1/e,n[1]*=1/e,n[0]+=r[0],n[1]+=r[1],n}const UVe=1/3;function GVe(t,e,n){if(!t||!n||n.pathSize<3)return null;n.nextPoint();const r=n.x,i=n.y;n.nextPoint();let s,o=n.x-r,a=n.y-i,l=0,c=0;for(;n.nextPoint();)l=n.x-r,c=n.y-i,s=.5*UVe*(l*a-c*o),t[0]+=s*(o+l),t[1]+=s*(a+c),o=l,a=c;const u=n.getCurrentRingArea(),h=[r,i];return h[0]-=e[0],h[1]-=e[1],h[0]*=u,h[1]*=u,t[0]+=h[0],t[1]+=h[1],t}function ml(t=YVe){return[t[0],t[1],t[2],t[3]]}function age(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function BVe(t,e,n,r,i=ml()){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function NRt(t,e=ml()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function WVe(t,e,n=new Dn){return n.xmin=t[0],n.ymin=t[1],n.xmax=t[2],n.ymax=t[3],n.spatialReference=e,n}function Wc(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function HVe(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function qVe(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function ORt(t,e,n){if(e!=null)if("length"in e)i9(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[0]),n[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":n[0]=Math.min(t[0],e.xmin),n[1]=Math.min(t[1],e.ymin),n[2]=Math.max(t[2],e.xmax),n[3]=Math.max(t[3],e.ymax);break;case"point":n[0]=Math.min(t[0],e.x),n[1]=Math.min(t[1],e.y),n[2]=Math.max(t[2],e.x),n[3]=Math.max(t[3],e.y)}else age(n,t)}function LRt(t,e,n=t){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3];for(let l=0;l<r;l++){const c=e[l];i=Math.min(i,c[0]),s=Math.min(s,c[1]),o=Math.max(o,c[0]),a=Math.max(a,c[1])}return n[0]=i,n[1]=s,n[2]=o,n[3]=a,n}function DRt(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function gB(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function yB(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function $Rt(t){return gB(t)*yB(t)}function jRt(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function FRt(t){const e=gB(t),n=yB(t);return Math.sqrt(e*e+n*n)}function VRt(t,e){return!!t&&r9(t,e.x,e.y)}function r9(t,e,n){return e>=t[0]&&n>=t[1]&&e<=t[2]&&n<=t[3]}function zRt(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function URt(t,e,n){return Math.max(e[0],t[0])-n<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-n<=Math.min(e[3],t[3])}function KVe(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function GRt(t,e,n,r){return r??=t,r[0]=t[0]+e,r[1]=t[1]+n,r[2]=t[2]+e,r[3]=t[3]+n,r}function BRt(t){return t?age(t,Hee):ml(Hee)}function i9(t){return t!=null&&t.length===4}function WRt(t,e){return i9(t)&&i9(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const Hee=[1/0,1/0,-1/0,-1/0],YVe=[0,0,0,0];let vB=1e-6;function _l(){return vB}function XVe(t){vB=t}const _B=Math.random,ZVe=Math.PI/180,JVe=180/Math.PI;function xB(t){return t*ZVe}function QVe(t){return t*JVe}function eze(t,e){return Math.abs(t-e)<=vB*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:_B,equals:eze,getEpsilon:_l,setEpsilon:XVe,toDegree:QVe,toRadian:xB},Symbol.toStringTag,{value:"Module"}));function Xx(t,e){return t[0]=e[0],t[1]=e[1],t}function to(t,e,n){return t[0]=e,t[1]=n,t}function lge(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ak(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function cge(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function uge(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function tze(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function nze(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function rze(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function ize(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function sze(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function dI(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function oze(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function xO(t,e){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Ik(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function P4(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function hge(t){const e=t[0],n=t[1];return e*e+n*n}function dge(t,e){return t[0]=-e[0],t[1]=-e[1],t}function aze(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function s9(t,e){const n=e[0],r=e[1];let i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t}function fge(t,e){return t[0]*e[0]+t[1]*e[1]}function pge(t,e,n){const r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function lze(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function cze(t,e=1){const n=2*_B()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function uze(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function Xh(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function iM(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function hze(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function dze(t,e,n,r){const i=e[0]-n[0],s=e[1]-n[1],o=Math.sin(r),a=Math.cos(r);return t[0]=i*a-s*o+n[0],t[1]=i*o+s*a+n[1],t}function fze(t,e){const n=t[0],r=t[1],i=e[0],s=e[1];let o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));let a=i*i+s*s;a>0&&(a=1/Math.sqrt(a));const l=(n*i+r*s)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function pze(t){return"vec2("+t[0]+", "+t[1]+")"}function mze(t,e){return t[0]===e[0]&&t[1]===e[1]}function gze(t,e){const n=t[0],r=t[1],i=e[0],s=e[1],o=_l();return Math.abs(n-i)<=o*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))}function yze(t,e,n,r,i){let s=e[0]-n[0],o=e[1]-n[1];const a=(r[0]*s+r[1]*o)*(i-1);return s=r[0]*a,o=r[1]*a,t[0]=e[0]+s,t[1]=e[1]+o,t}const vze=P4,wB=Ak,_ze=cge,xze=uge,wze=xO,bze=Ik,Eze=hge;Object.freeze(Object.defineProperty({__proto__:null,add:lge,angle:fze,ceil:tze,copy:Xx,cross:pge,dist:wze,distance:xO,div:xze,divide:uge,dot:fge,equals:gze,exactEquals:mze,floor:nze,inverse:aze,len:vze,length:P4,lerp:lze,max:ize,min:rze,mul:_ze,multiply:cge,negate:dge,normalize:s9,projectAndScale:yze,random:cze,rotate:dze,round:sze,scale:dI,scaleAndAdd:oze,set:to,sqrDist:bze,sqrLen:Eze,squaredDistance:Ik,squaredLength:hge,str:pze,sub:wB,subtract:Ak,transformMat2:uze,transformMat2d:Xh,transformMat3:iM,transformMat4:hze},Symbol.toStringTag,{value:"Module"}));function Cf(t,e,n,r){return t[0]=e[0]*(1-r)+n[0]*r,t[1]=e[1]*(1-r)+n[1]*r,t}function Ma(t,e){return Ik(t,e)}function HRt(t,e,n){const r=Ma(e,n);if(r===0)return Ma(e,t);const i=(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0]);return i*i/r}function Sze(t,e,n,r,i){const[s,o]=e,[a,l]=n,[c,u]=r,[h,f]=i,g=(s-a)*(u-f)-(o-l)*(c-h);if(g===0)return null;const v=(s*l-o*a)*(c-h)-(s-a)*(c*f-u*h),x=(s*l-o*a)*(u-f)-(o-l)*(c*f-u*h);return t[0]=v/g,t[1]=x/g,t}const Ju=2*Math.PI;function Xy(t,e){const n=Math.atan2(t,e);return n<0?n+Ju:n}function mge(t){return Math.abs(t)%Ju}function qee(t){const e=mge(t);return e<Math.PI?e:Ju-e}function wO(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function gge(t,e,n,r){if(gg(mge(t-e),0))return n?[t,t]:[t,r?t-Ju:t+Ju];const[i,s]=r?[t-Ju,t]:[t,t+Ju];return[t,fI({min:i,max:s},e)]}function fI({min:t,max:e},n){let r;return r=e-n,r>=Ju?(r-=r%Ju,n+r):(r=n-t,r>=Ju?(r-=r%Ju,n-r):n)}function Tze(t,e){const n=fI(t,e);return n>t.min&&n<t.max?n:qee(n-t.min)<qee(n-t.max)?t.min:t.max}function yge(t,e,n,r=10){return e.map(i=>{let s=i;for(let o=0;o<r;o++){const[a,l,c,u,h,f]=n(s),g=t[0]-a,v=t[1]-l,x=-c,b=-u;s+=-(2*g*x+2*v*b)/(2*x*x+2*g*-h+2*b*b+2*v*-f||1e-6)}return s})}const kze=[0,0];function vge(t){const e=1-t,n=e*e,r=t*t;return[n*e,3*t*n,3*r*e,r*t]}function o9(t,e,n,r,i){const[s,o,a,l]=vge(i);return[t[0]*s+e[0]*o+n[0]*a+r[0]*l,t[1]*s+e[1]*o+n[1]*a+r[1]*l]}function Kee(t,e,n,r,i){const[s,o,a,l]=vge(i);return t*s+e*o+n*a+r*l}function qRt(t,e,n){const r=t,[i,s,o]=e.b;return o9(r,s,o,i,n)}function Aze(t,e,n){const r=t,[i,s,o]=e.b,a=Cf([0,0],r,s,n),l=Cf(kze,s,o,n),c=Cf([0,0],o,i,n),u=Cf([0,0],a,l,n),h=Cf([0,0],l,c,n);return[{b:[Cf([],u,h,n),a,u]},{b:[[...i],h,c]}]}function KRt(t,e,n){const r=t,[i,s,o]=e.b,a=yge(n,[.1,.5,.9],h=>{const f=1-h,[g,v]=o9(r,s,o,i,h);return[g,v,3*f*f*(s[0]-r[0])+6*f*h*(o[0]-s[0])+3*h*h*(i[0]-o[0]),3*f*f*(s[1]-r[1])+6*f*h*(o[1]-s[1])+3*h*h*(i[1]-o[1]),6*f*(o[0]-2*s[0]+r[0])+6*h*(i[0]-2*o[0]+s[0]),6*f*(o[1]-2*s[1]+r[1])+6*h*(i[1]-2*o[1]+s[1])]}).map(h=>Math.min(1,Math.max(0,h)));a.push(0,1);let l=1/0;const c=a.map(h=>{const f=o9(r,s,o,i,h),[g,v]=f,x=n[0]-g,b=n[1]-v,T=Math.sqrt(x*x+b*b);return l=Math.min(T,l),{t:h,curvePoint:f,distance:T}}),u=[];for(const h of c){const{t:f,distance:g}=h;qme(g,l)&&!u.some(({t:v})=>gg(v,f))&&u.push(h)}return u}function Ize(t,e,n){const r=e,[i,s,o]=n.b;if(Wc(t,r),Wc(t,i),r9(t,s[0],s[1])&&r9(t,o[0],o[1]))return t;for(const a of Yee(r[0],s[0],o[0],i[0]))a>0&&a<1&&HVe(t,Kee(r[0],s[0],o[0],i[0],a));for(const a of Yee(r[1],s[1],o[1],i[1]))a>0&&a<1&&qVe(t,Kee(r[1],s[1],o[1],i[1],a));return t}function Yee(t,e,n,r){const i=3*(3*(e-n)-t+r),s=6*(t-2*e+n),o=3*(e-t);if(i===0)return s!==0?[-o/s]:[];const a=Math.sqrt(s*s-4*i*o);return[(-s+a)/(2*i),(-s-a)/(2*i)]}function YRt(t,e,n){let i=0,s=[e];for(let o=0;o<16;o++){let a=t;const l=[];for(const u of s)l.push(...Aze(a,u,.5)),a=u.b[0];s=l,a=t,i=0;let c=0;for(const u of s){const[h,f,g]=u.b,v=Math.sqrt(Ma(a,h));i+=(v+(Math.sqrt(Ma(a,f))+Math.sqrt(Ma(f,g))+Math.sqrt(Ma(g,h))))/2,c+=v,a=h}if(i-c<n)return i}return i}function Rze(t,e,n){const[r,i]=t,[s,o]=e,[a,l]=n,[c,u]=[s-r,o-i];let h=c*(a-r)+u*(l-i);h/=c**2+u**2,h=cu(h,0,1);const f=Cf([0,0],t,e,h);return{t:h,curvePoint:f,distance:Math.sqrt(Ma(f,n))}}let _ge=class{constructor(e,n,r,i,s,o){this.cx=e,this.cy=n,this.radius=r,this.thetaStart=i,this.thetaEnd=s,this.isInvalid=o}get startPoint(){const{cx:e,cy:n,radius:r,thetaStart:i}=this;return[e+r*Math.cos(i),n+r*Math.sin(i)]}get endPoint(){const{cx:e,cy:n,radius:r,thetaEnd:i}=this;return[e+r*Math.cos(i),n+r*Math.sin(i)]}};function C4(t,e){const{cx:n,cy:r,radius:i}=t;return[n+i*Math.cos(e),r+i*Math.sin(e)]}function sM(t,e){if(t.isInvalid)return Cf([0,0],t.startPoint,t.endPoint,e);const{thetaStart:n,thetaEnd:r}=t;return C4(t,n*(1-e)+r*e)}function ZRt(t,e){if(t.isInvalid)return Rze(t.startPoint,t.endPoint,e);const{cx:n,cy:r,thetaStart:i,thetaEnd:s}=t,[o,a]=e,l=Tze(wO(i,s),Math.atan2(a-r,o-n)),c=C4(t,l);return{t:(l-i)/(s-i),curvePoint:c,distance:Math.sqrt(Ma(e,c))}}function Xee(t,e){if(e.isInvalid)return Wc(t,e.startPoint),Wc(t,e.endPoint),t;const{cx:n,cy:r,radius:i,thetaStart:s,thetaEnd:o}=e;Wc(t,C4(e,s)),Wc(t,C4(e,o));const a=wO(s,o),l=Math.PI/2;let c=0;for(const u of[[n+i,r],[n,r+i],[n-i,r],[n,r-i]])c=fI(a,c),c>a.min&&c<a.max&&Wc(t,u),c+=l;return t}function JRt(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:n,thetaEnd:r}=t;return e*Math.abs(r-n)}function Pze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Cze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Zx(t,e,n,r,i,s,o,a,l,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t}function xge(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function wge(t,e){if(t===e){const n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function bge(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l;let v=n*h+r*f+i*g;return v?(v=1/v,t[0]=h*v,t[1]=(-u*r+i*c)*v,t[2]=(a*r-i*o)*v,t[3]=f*v,t[4]=(u*n-i*l)*v,t[5]=(-a*n+i*s)*v,t[6]=g*v,t[7]=(-c*n+r*l)*v,t[8]=(o*n-r*s)*v,t):null}function Mze(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-a*c,t[1]=i*c-r*u,t[2]=r*a-i*o,t[3]=a*l-s*u,t[4]=n*u-i*l,t[5]=i*s-n*a,t[6]=s*c-o*l,t[7]=r*l-n*c,t[8]=n*o-r*s,t}function oM(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*s-o*l)+n*(-c*i+o*a)+r*(l*i-s*a)}function Rk(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],g=n[1],v=n[2],x=n[3],b=n[4],T=n[5],A=n[6],I=n[7],R=n[8];return t[0]=f*r+g*o+v*c,t[1]=f*i+g*a+v*u,t[2]=f*s+g*l+v*h,t[3]=x*r+b*o+T*c,t[4]=x*i+b*a+T*u,t[5]=x*s+b*l+T*h,t[6]=A*r+I*o+R*c,t[7]=A*i+I*a+R*u,t[8]=A*s+I*l+R*h,t}function a9(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],g=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=f*r+g*o+c,t[7]=f*i+g*a+u,t[8]=f*s+g*l+h,t}function Ege(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(n),g=Math.cos(n);return t[0]=g*r+f*o,t[1]=g*i+f*a,t[2]=g*s+f*l,t[3]=g*o-f*r,t[4]=g*a-f*i,t[5]=g*l-f*s,t[6]=c,t[7]=u,t[8]=h,t}function Nze(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function Oze(t,e,n){const r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t}function Lze(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Dze(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function $ze(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function jze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Fze(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,g=i*a,v=i*l,x=s*o,b=s*a,T=s*l;return t[0]=1-h-v,t[3]=u-T,t[6]=f+b,t[1]=u+T,t[4]=1-c-v,t[7]=g-x,t[2]=f-b,t[5]=g+x,t[8]=1-c-h,t}function Vze(t,e){const n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l,v=n*h+r*f+i*g;if(!v)return null;const x=1/v;return t[0]=h*x,t[1]=(-u*r+i*c)*x,t[2]=(a*r-i*o)*x,t[3]=f*x,t[4]=(u*n-i*l)*x,t[5]=(-a*n+i*s)*x,t[6]=g*x,t[7]=(-c*n+r*l)*x,t[8]=(o*n-r*s)*x,t}function zze(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],v=e[12],x=e[13],b=e[14],T=e[15],A=n*a-r*o,I=n*l-i*o,R=n*c-s*o,M=r*l-i*a,F=r*c-s*a,C=i*c-s*l,N=u*x-h*v,O=u*b-f*v,j=u*T-g*v,V=h*b-f*x,W=h*T-g*x,U=f*T-g*b;let pe=A*U-I*W+R*V+M*j-F*O+C*N;return pe?(pe=1/pe,t[0]=(a*U-l*W+c*V)*pe,t[1]=(l*j-o*U-c*O)*pe,t[2]=(o*W-a*j+c*N)*pe,t[3]=(i*W-r*U-s*V)*pe,t[4]=(n*U-i*j+s*O)*pe,t[5]=(r*j-n*W-s*N)*pe,t[6]=(x*C-b*F+T*M)*pe,t[7]=(b*R-v*C-T*I)*pe,t[8]=(v*F-x*R+T*A)*pe,t):null}function Uze(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Gze(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Bze(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function Wze(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Sge(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Hze(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function qze(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Kze(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Yze(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=e[0],f=e[1],g=e[2],v=e[3],x=e[4],b=e[5],T=e[6],A=e[7],I=e[8],R=_l();return Math.abs(n-h)<=R*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-f)<=R*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-g)<=R*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-v)<=R*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(o-x)<=R*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-b)<=R*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(l-T)<=R*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-A)<=R*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(u-I)<=R*Math.max(1,Math.abs(u),Math.abs(I))}function Xze(t){const e=_l(),n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(i*i+a*a+u*u))<=e}const Zze=Rk,Jze=Sge;Object.freeze(Object.defineProperty({__proto__:null,add:Wze,adjoint:Mze,copy:Cze,determinant:oM,equals:Yze,exactEquals:Kze,frob:Bze,fromMat2d:jze,fromMat4:Pze,fromQuat:Fze,fromRotation:Dze,fromScaling:$ze,fromTranslation:Lze,identity:xge,invert:bge,isOrthoNormal:Xze,mul:Zze,multiply:Rk,multiplyScalar:Hze,multiplyScalarAndAdd:qze,normalFromMat4:zze,normalFromMat4Legacy:Vze,projection:Uze,rotate:Ege,scale:Nze,scaleByVec2:Oze,set:Zx,str:Gze,sub:Jze,subtract:Sge,translate:a9,transpose:wge},Symbol.toStringTag,{value:"Module"}));function ov(){return[1,0,0,0,1,0,0,0,1]}function Qze(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function eUe(t,e,n,r,i,s,o,a,l){return[t,e,n,r,i,s,o,a,l]}const tUe=ov();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:tUe,clone:Qze,create:ov,fromValues:eUe},Symbol.toStringTag,{value:"Module"}));const p_=ov();function nUe(t,e,n){const[r,i]=t,[s,o]=e,[a,l]=n;Zx(p_,r,s,a,i,o,l,1,1,1);const c=oM(p_),u=4*c/(Ma(t,e)+Ma(e,n)+Ma(n,t));if(!isFinite(u)||Math.abs(u)<1e-8)return null;const h=r**2+i**2,f=s**2+o**2,g=a**2+l**2;Zx(p_,h,f,g,i,o,l,1,1,1);const v=oM(p_);return Zx(p_,h,f,g,r,s,a,1,1,1),[v/c*.5,oM(p_)/c*-.5]}function Tge(t,e){const[n,r]=e.c,i=nUe(t,r,n),s=i==null,o=i??Cf([],t,n,.5),[a,l]=t,[c,u]=r,[h,f]=n,[g,v]=o,x=a-g,b=l-v,T=Math.sqrt(x*x+b*b),A=Xy(l-v,a-g),I=Xy(u-v,c-g);let R=Xy(f-v,h-g);return(I-A)*(R-I)<0&&(R+=2*Math.sign(A-R)*Math.PI),new _ge(g,v,T,A,R,s)}function QRt(t,e,n){const r=sM(t,n/2),i=sM(t,n),s=sM(t,(n+1)/2);return[{c:[i,r]},{c:[[...e.c[0]],s]}]}function ePt(t,e){const[n]=e.c,{cx:r,cy:i,thetaStart:s,thetaEnd:o,radius:a,isInvalid:l}=Tge(t,e);return{a:[n,[r,i],Math.abs(o-s)<Math.PI?1:0,s>o?1:0,l?s:0,a,l?0:1]}}function tPt(t){return"curveRings"in t&&!!t.curveRings?.length||"curvePaths"in t&&!!t.curvePaths?.length}function nPt(t){return"curveRings"in t?t.curveRings:t.curvePaths}function bB(t){return"b"in t}function EB(t){return"c"in t}function bO(t){return Array.isArray(t)}function rPt(t){return"a"in t}function kge(t){return"a"in t&&t.a.length===4}function rUe(t){return"a"in t&&t.a.length===7}function _$(t){return bO(t)?t:bB(t)?t.b[0]:EB(t)?t.c[0]:t.a[0]}function iUe(t){if(bB(t)){const[e,n,r]=t.b;return{b:[[...e],[...n],[...r]]}}if(EB(t)){const[e,n]=t.c;return{c:[[...e],[...n]]}}if(bO(t))return[...t];if(kge(t)){const[e,n,r,i]=t.a;return{a:[[...e],[...n],r,i]}}if(rUe(t)){const[e,n,r,i,s,o,a]=t.a;return{a:[[...e],[...n],r,i,s,o,a]}}return t}function sUe(t,e){const[n,r,i,s]=e.a,[o,a]=t,[l,c]=n,[u,h]=r,f=o-u,g=a-h,v=Math.sqrt(f*f+g*g),x=l-u,b=c-h,T=Math.sqrt(x*x+b*b),A=v===0||T===0||!qme(v,T),I=v,[R,M]=gge(Xy(a-h,o-u),Math.atan2(c-h,l-u),i,s);return new _ge(u,h,I,R,M,A)}function iPt(t,e,n){const{cx:r,cy:i,thetaStart:s,thetaEnd:o}=t,[a,l,c,u]=e.a,h=s*(1-n)+o*n;return[{a:[sM(t,n),[r,i],Math.abs(h-s)<Math.PI?1:0,u]},{a:[[...a],[r,i],Math.abs(o-h)<Math.PI?1:0,u]}]}let oUe=class{constructor(e,n,r,i,s,o,a,l,c){this.cx=e,this.cy=n,this.a=r,this.b=i,this.cosR=s,this.sinR=o,this.u1=a,this.u2=l,this.isInvalid=c}};function SB(t,e){const[n,r,i,s,o,a,l]=e.a,[c,u]=t,[h,f]=n,[g,v]=r,x=a*l,b=Math.cos(o),T=Math.sin(o),[A,I]=gge(Xy(1/x*(u-v)*b-1/x*(c-g)*T,1/a*(u-v)*T+1/a*(c-g)*b),Math.atan2(1/x*(f-v)*b-1/x*(h-g)*T,1/a*(f-v)*T+1/a*(h-g)*b),i,s);return new oUe(g,v,a,x,b,T,A,I,a===0||x===0)}function Pk(t,e){const{a:n,b:r,cosR:i,sinR:s,cx:o,cy:a}=t,l=Math.cos(e),c=Math.sin(e);return[n*l*i-r*c*s+o,n*l*s+r*c*i+a]}function V_(t,e){const{u1:n,u2:r}=t;return Pk(t,n*(1-e)+r*e)}function oPt(t,e,n){if(n<0||n>1)return[];if(n===0||n===1)return[iUe(e)];const[r,[i,s],o,a,l,c,u]=e.a,{u1:h,u2:f}=t,g=h*(1-n)+f*n;return[{a:[[...V_(t,n)],[i,s],Math.abs(g-h)<Math.PI?1:0,a,l,c,u]},{a:[[...r],[i,s],Math.abs(f-g)<Math.PI?1:0,a,l,c,u]}]}function aPt(t,e){const{a:n,b:r,cosR:i,sinR:s,u1:o,u2:a}=t,l=Math.PI/6,c=yge(e,[1*l,2*l,4*l,5*l,7*l,8*l,10*l,11*l],x=>{const b=Math.cos(x),T=Math.sin(x),[A,I]=Pk(t,x);return[A,I,-n*i*T-r*s*b,-n*s*T+r*i*b,-n*i*b+r*s*T,-n*s*b-r*i*T]}),u=wO(o,a),h=new Set(c.map(x=>fI(u,x)).filter(x=>x>u.min&&x<u.max));h.add(o),h.add(a);let f,g,v=1/0;for(const x of h){const b=Pk(t,x),[T,A]=b,I=e[0]-T,R=e[1]-A,M=I*I+R*R;M<v&&(f=(x-o)/(a-o),g=b,v=M)}return{t:f,curvePoint:g,distance:Math.sqrt(v)}}function aUe(t,e,n){const r=SB(e,n),{a:i,b:s,u1:o,u2:a,cosR:l,sinR:c,isInvalid:u}=r,h=n.a[0];if(Wc(t,e),Wc(t,h),u)return t;const f=Math.atan2(-s*c,i*l),g=f+Math.PI,v=Math.atan2(s*l,i*c),x=v+Math.PI,b=wO(o,a);for(const T of[f,g,v,x].map(A=>fI(b,A)))T>b.min&&T<b.max&&Wc(t,Pk(r,T));return t}function lPt(t,e,n){const[r,i,s,o,a,l,c]=e.a,u=SB(t,e),{u1:h,u2:f,isInvalid:g}=u,v=f-h;if(g)return Math.sqrt(Ma(t,r));const x=14,b=[0,0];let T=0,A=[V_(u,0),V_(u,.25),V_(u,.5),V_(u,.75),V_(u,1)];for(let I=0;I<x;I++){const R=A.length-1,M=v/(2*R),F=[];for(let N=0;N<R;N++)F.push(A[N]),F.push(Pk(u,h+(2*N+1)*M));F.push(A[A.length-1]),A=F,T=0;let C=0;for(let N=1;N<A.length;N++){const O=A[N-1],j=A[N];if(T+=Math.sqrt(Ma(O,j)),N>1){const V=A[N-2],W=Sze(b,V,O,i,j);C+=W?Math.sqrt(Ma(O,W)):Math.abs(j[0]-O[0])+Math.abs(j[1]-O[1])}else C+=T}if(C-T<n)return T}return T}const Zee=ov(),kP=ov(),Jee=ov(),lm=ov();function cPt(t,e,n){const[r,i,s,o,a,l,c]=e.a,u=SB(t,e),{cosR:h,sinR:f,a:g,b:v,cx:x,cy:b}=u,T=iM([0,0],r,n),A=iM([0,0],i,n),I=n[0]*n[4]<0?1-o:o;{const R=g*g*f*f+v*v*h*h,M=2*(v*v-g*g)*f*h,F=g*g*h*h+v*v*f*f,C=-2*R*x-M*b,N=-M*x-2*F*b;Zx(Zee,R,M/2,C/2,M/2,F,N/2,C/2,N/2,R*x*x+M*x*b+F*b*b-g*g*v*v)}if(bge(kP,n),kP==null){const R=iM([0,0],t,n);return{a:[T,A,s,o,Xy(T[1],T[0]),Math.sqrt(Ma(T,R))/2,0]}}wge(Jee,kP),Rk(lm,Rk(lm,Jee,Zee),kP);{const R=lm[0],M=2*lm[1],F=lm[4],C=2*lm[2],N=2*lm[5],O=M*M-4*R*F,j=2*(R*N*N+F*C*C-M*C*N+O*lm[8]),V=Math.sqrt((R-F)**2+M*M),W=-Math.sqrt(j*(R+F+V))/O,U=-Math.sqrt(j*(R+F-V))/O;return{a:[T,A,s,I,.5*Xy(-M,F-R),W,U/W]}}}function lUe(t,e,n){if(bO(n))return Wc(t,e),Wc(t,n),t;if(bB(n))return Ize(t,e,n);if(EB(n)){const r=Tge(e,n);return Xee(t,r)}if(kge(n)){const r=sUe(e,n);return Xee(t,r)}return aUe(t,e,n)}function Age(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Ige(t){return t.points!==void 0}function Rge(t){return t.x!==void 0&&t.y!==void 0}function Pge(t){return t.paths!==void 0}function Cge(t){return t.rings!==void 0}function Mge(t){function e(n,r){return n==null?r:r==null?n:t(n,r)}return e}const Xm=Mge(Math.min),Zm=Mge(Math.max);function uPt(t,e){return Pge(e)?u2(t,e.curvePaths??e.paths,!1,!1)??t:Cge(e)?u2(t,e.curveRings??e.rings,!1,!1)??t:Ige(e)?TB(t,e.points,!1,!1,!1,!1):Age(e)?Nge(t,e):(Rge(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function hPt(t){let e,n,r,i;for(t.reset(),e=r=1/0,n=i=-1/0;t.nextPath();){const s=cUe(t);e=Math.min(s[0],e),r=Math.min(s[1],r),n=Math.max(s[2],n),i=Math.max(s[3],i)}return ml([e,r,n,i])}function cUe(t){let e,n,r,i;for(e=r=1/0,n=i=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),n=Math.max(t.x,n),i=Math.max(t.y,i);return ml([e,r,n,i])}function dPt(t,e){return Pge(e)?u2(t,e.curvePaths??e.paths,!0,!1)??t:Cge(e)?u2(t,e.curveRings??e.rings,!0,!1)??t:Ige(e)?TB(t,e.points,!0,!1,!0,!1):Age(e)?Nge(t,e,!0,!1,!0,!1):(Rge(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function u2(t,e,n,r){const i=n?3:2;if(!e.length||!e[0].length)return null;let s,o,a,l,[c,u]=_$(e[0][0]),h=c,f=u;for(let g=0;g<e.length;g++){const v=e[g];for(let x=0;x<v.length;x++){const b=_$(v[x]),[T,A]=b;if(c=Xm(c,T),u=Xm(u,A),h=Zm(h,T),f=Zm(f,A),n&&b.length>2){const F=b[2];s=Xm(s,F),o=Zm(o,F)}if(r&&b.length>i){const F=b[i];a=Xm(s,F),l=Zm(o,F)}const I=v[x];if(bO(I)||x<1)continue;const R=_$(v[x-1]),M=BVe(c,u,h,f);[c,u,h,f]=lUe(M,R,I)}}return n?r?(t[0]=c,t[1]=u,t[2]=s,t[3]=a,t[4]=h,t[5]=f,t[6]=o,t[7]=l,t.length=8,t):(t[0]=c,t[1]=u,t[2]=s,t[3]=h,t[4]=f,t[5]=o,t.length=6,t):r?(t[0]=c,t[1]=u,t[2]=a,t[3]=h,t[4]=f,t[5]=l,t.length=6,t):(t[0]=c,t[1]=u,t[2]=h,t[3]=f,t.length=4,t)}function Nge(t,e,n,r,i,s){const o=e.xmin,a=e.xmax,l=e.ymin,c=e.ymax;let u=e.zmin,h=e.zmax,f=e.mmin,g=e.mmax;return i?(u=u||0,h=h||0,s?(f=f||0,g=g||0,t[0]=o,t[1]=l,t[2]=u,t[3]=f,t[4]=a,t[5]=c,t[6]=h,t[7]=g,t):(t[0]=o,t[1]=l,t[2]=u,t[3]=a,t[4]=c,t[5]=h,t)):s?(f=f||0,g=g||0,t[0]=o,t[1]=l,t[2]=f,t[3]=a,t[4]=c,t[5]=g,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=c,t)}function TB(t,e,n,r,i,s){const o=n?3:2,a=r&&s,l=n&&i;if(!e.length||!e[0].length)return null;let c,u,h,f,[g,v]=e[0],[x,b]=e[0];for(let T=0;T<e.length;T++){const A=e[T],[I,R]=A;if(g=Xm(g,I),v=Xm(v,R),x=Zm(x,I),b=Zm(b,R),l&&A.length>2){const M=A[2];c=Xm(c,M),u=Zm(u,M)}if(a&&A.length>o){const M=A[o];h=Xm(c,M),f=Zm(u,M)}}return i?(c=c||0,u=u||0,s?(h=h||0,f=f||0,t[0]=g,t[1]=v,t[2]=c,t[3]=h,t[4]=x,t[5]=b,t[6]=u,t[7]=f,t):(t[0]=g,t[1]=v,t[2]=c,t[3]=x,t[4]=b,t[5]=u,t)):s?(h=h||0,f=f||0,t[0]=g,t[1]=v,t[2]=h,t[3]=x,t[4]=b,t[5]=f,t):(t[0]=g,t[1]=v,t[2]=x,t[3]=b,t)}function uUe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function hUe(t){return t.points!==void 0}function dUe(t){return t.x!==void 0&&t.y!==void 0}function fUe(t){return t.paths!==void 0}function pUe(t){return t.rings!==void 0}const kB=[];function Oge(t,e,n,r){return{xmin:t,ymin:e,xmax:n,ymax:r}}function Lge(t,e,n,r,i,s){return{xmin:t,ymin:e,zmin:n,xmax:r,ymax:i,zmax:s}}function Dge(t,e,n,r,i,s){return{xmin:t,ymin:e,mmin:n,xmax:r,ymax:i,mmax:s}}function $ge(t,e,n,r,i,s,o,a){return{xmin:t,ymin:e,zmin:n,mmin:r,xmax:i,ymax:s,zmax:o,mmax:a}}function AB(t,e=!1,n=!1){return e?n?$ge(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Lge(t[0],t[1],t[2],t[3],t[4],t[5]):n?Dge(t[0],t[1],t[2],t[3],t[4],t[5]):Oge(t[0],t[1],t[2],t[3])}function fPt(t){return t?uUe(t)?t:dUe(t)?mUe(t):pUe(t)?Fge(t):fUe(t)?Vge(t):hUe(t)?jge(t):null:null}function jge(t){const{hasZ:e,hasM:n,points:r}=t,i=TB(kB,r,e??!1,n??!1,e??!1,n??!1);return i?AB(i,e,n):null}function mUe(t){const{x:e,y:n,z:r,m:i}=t,s=i!=null;return r!=null?s?$ge(e,n,r,i,e,n,r,i):Lge(e,n,r,e,n,r):s?Dge(e,n,i,e,n,i):Oge(e,n,e,n)}function Fge(t){const{hasZ:e,hasM:n,rings:r,curveRings:i}=t,s=u2(kB,i??r,e??!1,n??!1);return s?AB(s,e,n):null}function Vge(t){const{hasZ:e,hasM:n,paths:r,curvePaths:i}=t,s=u2(kB,i??r,e??!1,n??!1);return s?AB(s,e,n):null}function h2(t,e,n=!1){let{hasM:r,hasZ:i}=t;Array.isArray(e)?e.length!==4||r||i?e.length===3&&n&&!r?(i=!0,r=!1):e.length===3&&r&&i&&(r=!1,i=!1):(r=!0,i=!0):(i=!i&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!i||e.hasZ)),t.hasZ=i,t.hasM=r}var aM;function Qee(t){return!Array.isArray(t[0])}function gUe(t){return typeof t[0]?.[0]=="number"}function yUe(t){if(!t)return;let{rings:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],gUe(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,rings:e,spatialReference:i}}let vi=aM=class extends Ds{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:n}=t;let r=!1,i=!1;for(const o of e)o.hasZ&&(r=!0),o.hasM&&(i=!0);const s={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(i&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a}),spatialReference:n};return r&&(s.hasZ=!0),i&&(s.hasM=!0),new aM(s)}constructor(t){super(yUe(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){gF(Tt.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=DVe(this);return t?Jt.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=Ze(t)}get extent(){const t=Fge(this),{spatialReference:e}=this;return t?new Dn({...t,spatialReference:e}):null}get isSelfIntersecting(){return gF(Tt.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),Zje(this.rings)}writeRings(t,e){e.rings=Ze(this.rings)}addRing(t){if(!t)return;const e=this.rings,n=e.length;if(Qee(t)){const r=[];for(let i=0,s=t.length;i<s;i++)r[i]=t[i].toArray();e[n]=r}else e[n]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new aM;return t.spatialReference=this.spatialReference,t.rings=Ze(this.rings),t.curveRings=Ze(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,n=t.spatialReference;if(e!=null!=(n!=null)||e!=null&&n!=null&&!e.equals(n)||this.rings.length!==t.rings.length)return!1;const r=([i,s,o,a],[l,c,u,h])=>i===l&&s===c&&(o==null&&u==null||o===u)&&(a==null&&h==null||a===h);for(let i=0;i<this.rings.length;i++){const s=this.rings[i],o=t.rings[i];if(!W5(s,o,r))return!1}return!0}contains(t){if(!t)return!1;const e=cO(t,this.spatialReference);return YG(this,e??t)}isClockwise(t){const e=Qee(t)?t.map(n=>this.hasZ?this.hasM?[n.x,n.y,n.z,n.m]:[n.x,n.y,n.z]:[n.x,n.y]):t;return ige(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const n=this.rings[t][e],r=this.hasZ,i=this.hasM;return r&&!i?new Jt(n[0],n[1],n[2],void 0,this.spatialReference):i&&!r?new Jt(n[0],n[1],void 0,n[2],this.spatialReference):r&&i?new Jt(n[0],n[1],n[2],n[3],this.spatialReference):new Jt(n[0],n[1],this.spatialReference)}insertPoint(t,e,n){return this._validateInputs(t,e,!0)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.rings[t].splice(e,0,n),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const n=new Jt(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),n}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],n=this.spatialReference,r=e.map(i=>new Jt(i,n));return this.notifyChange("rings"),r}setPoint(t,e,n){return this._validateInputs(t,e)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.rings[t][e]=n,this.notifyChange("rings"),this):this}_validateInputs(t,e,n=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(n&&(e<0||e>r.length)||!n&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};_([E({readOnly:!0})],vi.prototype,"cache",null),_([E({readOnly:!0})],vi.prototype,"centroid",null),_([E({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],vi.prototype,"curveRings",void 0),_([Xn("curveRings")],vi.prototype,"writeCurveRings",null),_([E({readOnly:!0})],vi.prototype,"extent",null),_([E({readOnly:!0})],vi.prototype,"isSelfIntersecting",null),_([E({type:[[[Number]]],json:{write:{isRequired:!0}}})],vi.prototype,"rings",void 0),_([Xn("rings")],vi.prototype,"writeRings",null),vi=aM=_([ue("esri.geometry.Polygon")],vi),vi.prototype.toJSON.isDefaultToJSON=!0;function Zg(){return[0,0,0]}function vUe(t){return[t[0],t[1],t[2]]}function tb(t,e,n){return[t,e,n]}function _Ue(t,e,n){return[t,e,n]}function xUe(t,e=Zg()){const n=Math.min(3,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function zge(){return Zg()}function Uge(){return tb(1,1,1)}function Gge(){return tb(1,0,0)}function Bge(){return tb(0,1,0)}function Wge(){return tb(0,0,1)}const wUe=zge(),bUe=Uge(),EUe=Gge(),SUe=Bge(),TUe=Wge();Object.freeze(Object.defineProperty({__proto__:null,ONES:bUe,UNIT_X:EUe,UNIT_Y:SUe,UNIT_Z:TUe,ZEROS:wUe,clone:vUe,create:Zg,freeze:_Ue,fromArray:xUe,fromValues:tb,ones:Uge,unitX:Gge,unitY:Bge,unitZ:Wge,zeros:zge},Symbol.toStringTag,{value:"Module"}));var l9;function kUe(t){if(!t)return;let{points:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],e?.at(0)?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,points:e,spatialReference:i}}let Gu=l9=class extends Ds{constructor(t){super(kUe(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=jge(this);return t?new Dn({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=Ze(this.points)}clone(){const{points:t,spatialReference:e,hasM:n,hasZ:r}=this;return new l9({points:Ze(t),spatialReference:e.clone(),hasM:n,hasZ:r})}addPoint(t){return h2(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],n={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(n.z=e[2],r=3),this.hasM&&(n.m=e[r]),new Jt(n)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Jt(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(h2(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};_([E({readOnly:!0})],Gu.prototype,"cache",null),_([E({readOnly:!0})],Gu.prototype,"extent",null),_([E({type:[[Number]],json:{write:{isRequired:!0}}})],Gu.prototype,"points",void 0),_([Xn("points")],Gu.prototype,"writePoints",null),Gu=l9=_([ue("esri.geometry.Multipoint")],Gu),Gu.prototype.toJSON.isDefaultToJSON=!0;var c9;function AUe(t){return!Array.isArray(t[0])}function IUe(t){return typeof t[0]?.[0]=="number"}function RUe(t){if(!t)return;let{paths:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],IUe(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,paths:e,spatialReference:i}}let xs=c9=class extends Ds{constructor(t){super(RUe(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=Ze(t)}get extent(){const t=Vge(this),{spatialReference:e}=this;return t?new Dn({...t,spatialReference:e}):null}writePaths(t,e){e.paths=Ze(this.paths)}addPath(t){if(!t)return;const e=this.paths,n=e.length;if(AUe(t)){const r=[];for(let i=0,s=t.length;i<s;i++)r[i]=t[i].toArray();e[n]=r}else e[n]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new c9;return t.spatialReference=this.spatialReference,t.paths=Ze(this.paths),t.curvePaths=Ze(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const n=this.paths[t][e],r=this.hasZ,i=this.hasM;return r&&!i?new Jt(n[0],n[1],n[2],void 0,this.spatialReference):i&&!r?new Jt(n[0],n[1],void 0,n[2],this.spatialReference):r&&i?new Jt(n[0],n[1],n[2],n[3],this.spatialReference):new Jt(n[0],n[1],this.spatialReference)}insertPoint(t,e,n){return this._validateInputs(t,e,!0)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.paths[t].splice(e,0,n),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],n=this.spatialReference,r=e.map(i=>new Jt(i,n));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const n=new Jt(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),n}setPoint(t,e,n){return this._validateInputs(t,e)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.paths[t][e]=n,this.notifyChange("paths"),this):this}_validateInputs(t,e,n=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(n&&(e<0||e>r.length)||!n&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};_([E({readOnly:!0})],xs.prototype,"cache",null),_([E({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],xs.prototype,"curvePaths",void 0),_([Xn("curvePaths")],xs.prototype,"writeCurvePaths",null),_([E({readOnly:!0})],xs.prototype,"extent",null),_([E({type:[[[Number]]],json:{write:{isRequired:!0}}})],xs.prototype,"paths",void 0),_([Xn("paths")],xs.prototype,"writePaths",null),xs=c9=_([ue("esri.geometry.Polyline")],xs),xs.prototype.toJSON.isDefaultToJSON=!0;var u9;let z_=u9=class extends Kt{constructor(t){super(t),this.isInverse=!1,this.wkt=null,this.wkid=null}getInverse(){return new u9({isInverse:!this.isInverse,wkid:this.wkid,wkt:this.wkt})}};_([E()],z_.prototype,"isInverse",void 0),_([E()],z_.prototype,"wkt",void 0),_([E()],z_.prototype,"wkid",void 0),z_=u9=_([ue("esri.geometry.operators.support.GeographicTransformationStep")],z_);var h9;let tT=h9=class extends Kt{constructor(t){super(t),this.steps=[]}getInverse(){const t=new h9;for(let e=this.steps.length-1;e>=0;e--){const n=this.steps[e];t.steps.push(n.getInverse())}return t}};_([E({type:[z_],nonNullable:!0})],tT.prototype,"steps",void 0),tT=h9=_([ue("esri.geometry.operators.support.GeographicTransformation")],tT);const pPt=Math.PI/180,mPt=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,cm=ts.radius,Ru=ts.eccentricitySquared,PUe={a1:cm*Ru,a2:cm*Ru*cm*Ru,a3:cm*Ru*Ru/2,a4:cm*Ru*cm*Ru*2.5,a5:cm*Ru+cm*Ru*Ru/2,a6:1-Ru},gPt={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:ts.radius,f:ts.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Ng.radius,f:Ng.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:md.radius,f:md.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:md.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}},CUe={2:{5:li,7:null,9:null,10:li,1:rT,6:null,8:null,0:null,3:Jx,11:Qx,2:li,4:nw},5:{5:li,7:null,9:null,10:li,1:rT,6:null,8:null,0:null,3:Jx,11:Qx,2:li,4:nw},7:{5:null,7:li,9:null,10:li,1:null,6:nte,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:li,10:li,1:null,6:null,8:tte,0:null,3:null,11:null,2:null,4:null},3:{5:nT,7:null,9:null,10:nT,1:NUe,6:null,8:null,0:null,3:li,11:DUe,2:nT,4:OUe},4:{5:rw,7:null,9:null,10:rw,1:WUe,6:null,8:null,0:null,3:HUe,11:$Ue,2:rw,4:li},1:{5:tw,7:null,9:null,10:tw,1:li,6:null,8:null,0:null,3:UUe,11:jUe,2:tw,4:GUe},6:{5:null,7:ite,9:null,10:ite,1:null,6:li,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:rte,10:rte,1:null,6:null,8:li,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:li,3:null,11:null,2:null,4:null},10:{5:li,7:li,9:li,10:li,1:rT,6:nte,8:tte,0:null,3:Jx,11:Qx,2:li,4:nw},11:{5:ew,7:null,9:null,10:ew,1:FUe,6:null,8:null,0:null,3:VUe,11:li,2:ew,4:zUe}};function Hge(t,e){return MUe(t,e)?.projector}function MUe(t,e){if(t==null||e==null)return null;if(nf.source.spatialReference===t&&nf.dest.spatialReference===e)return nf;const n=ete(t,nf.source),r=ete(e,nf.dest);return n===0&&r===0?uo(t,e)?nf.projector=li:nf.projector=null:nf.projector=CUe[n][r],nf}function ete(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=$d(t,1)),w4(t)?e.spatialReferenceId=1:M1(t)?e.spatialReferenceId=2:Ad(t)?e.spatialReferenceId=3:rje(t)?e.spatialReferenceId=11:t.wkt===aje.wkt?e.spatialReferenceId=4:t.wkid===4490?e.spatialReferenceId=5:t.wkt===HG.wkt?e.spatialReferenceId=6:t.wkt===qG.wkt?e.spatialReferenceId=8:Qfe(t)?e.spatialReferenceId=7:epe(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function li(t,e,n,r){t!==n&&(n[r++]=t[e++],n[r++]=t[e++],n[r]=t[e])}function nT(t,e,n,r){n[r]=f2*(t[e]/Zy),n[r+1]=f2*(qge-2*Math.atan(Math.exp(-t[e+1]/Zy))),n[r+2]=t[e+2]}function NUe(t,e,n,r){const i=t[e]/Zy,s=qge-2*Math.atan(Math.exp(-t[e+1]/Zy)),o=Zy+t[e+2],a=Math.cos(s)*o;n[r]=Math.cos(i)*a,n[r+1]=Math.sin(i)*a,n[r+2]=Math.sin(s)*o}function OUe(t,e,n,r){nT(t,e,n,r),nw(n,r,n,r)}function LUe(t,e,n,r,i){const s=.4999999*Math.PI,o=cu(d2*t[e+1],-s,s),a=Math.sin(o);n[r++]=d2*t[e]*i.radius,n[r++]=i.halfSemiMajorAxis*Math.log((1+a)/(1-a)),n[r]=t[e+2]}function Jx(t,e,n,r){LUe(t,e,n,r,ts)}function Qx(t,e,n,r){n[r]=t[e]*ste,n[r+1]=t[e+1]*ste,n[r+2]=t[e+2]}function ew(t,e,n,r){n[r]=t[e]*ote,n[r+1]=t[e+1]*ote,n[r+2]=t[e+2]}function DUe(t,e,n,r){nT(t,e,n,r),Qx(n,r,n,r)}function $Ue(t,e,n,r){rw(t,e,n,r),Qx(n,r,n,r)}function jUe(t,e,n,r){tw(t,e,n,r),Qx(n,r,n,r)}function FUe(t,e,n,r){ew(t,e,n,r),rT(n,r,n,r)}function VUe(t,e,n,r){ew(t,e,n,r),Jx(n,r,n,r)}function zUe(t,e,n,r){ew(t,e,n,r),nw(n,r,n,r)}function IB(t,e,n,r,i){const s=i+t[e+2],o=d2*t[e+1],a=d2*t[e],l=Math.cos(o)*s;n[r]=Math.cos(a)*l,n[r+1]=Math.sin(a)*l,n[r+2]=Math.sin(o)*s}function tte(t,e,n,r){IB(t,e,n,r,Ng.radius)}function nte(t,e,n,r){IB(t,e,n,r,md.radius)}function rT(t,e,n,r){IB(t,e,n,r,ts.radius)}function RB(t,e,n,r,i){const s=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(s*s+o*o+a*a),c=iVe(a/(l===0?1:l)),u=Math.atan2(o,s);n[r++]=f2*u,n[r++]=f2*c,n[r]=l-i}function rte(t,e,n,r){RB(t,e,n,r,Ng.radius)}function ite(t,e,n,r){RB(t,e,n,r,md.radius)}function tw(t,e,n,r){RB(t,e,n,r,ts.radius)}function UUe(t,e,n,r){tw(t,e,n,r),Jx(n,r,n,r)}function GUe(t,e,n,r){tw(t,e,n,r),nw(n,r,n,r)}function BUe(t,e,n,r,i){const s=d2*t[e],o=d2*t[e+1],a=t[e+2],l=Math.sin(o),c=Math.cos(o),u=i.radius/Math.sqrt(1-i.eccentricitySquared*l*l);n[r++]=(u+a)*c*Math.cos(s),n[r++]=(u+a)*c*Math.sin(s),n[r++]=(u*(1-i.eccentricitySquared)+a)*l}function nw(t,e,n,r){BUe(t,e,n,r,ts)}function rw(t,e,n,r){const i=PUe,s=t[e],o=t[e+1],a=t[e+2];let l,c,u,h,f,g,v,x,b,T,A,I,R,M,F,C,N,O,j,V,W;l=Math.abs(a),c=s*s+o*o,u=Math.sqrt(c),h=c+a*a,f=Math.sqrt(h),V=Math.atan2(o,s),g=a*a/h,v=c/h,M=i.a2/f,F=i.a3-i.a4/f,v>.3?(x=l/f*(1+v*(i.a1+M+g*F)/f),j=Math.asin(x),T=x*x,b=Math.sqrt(1-T)):(b=u/f*(1-g*(i.a5-M-v*F)/f),j=Math.acos(b),T=1-b*b,x=Math.sqrt(T)),A=1-ts.eccentricitySquared*T,I=ts.radius/Math.sqrt(A),R=i.a6*I,M=u-I*b,F=l-R*x,N=b*M+x*F,C=b*F-x*M,O=C/(R/A+N),j+=O,W=N+C*O/2,a<0&&(j=-j),n[r++]=f2*V,n[r++]=f2*j,n[r]=W}function WUe(t,e,n,r){rw(t,e,n,r),rT(n,r,n,r)}function HUe(t,e,n,r){rw(t,e,n,r),Jx(n,r,n,r)}const nf={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:li},d2=uI(1),f2=Wme(1),qge=.5*Math.PI,Zy=ts.radius,ste=Zy*Math.PI/180,ote=180/(Zy*Math.PI);function pI(t,e,n,r,i,s,o=Math.floor(t.length/3)){const a=Hge(e,i);if(a==null)return!1;if(a===li){if(t===r&&n===s)return!0;const c=n+3*o;for(let u=n,h=s;u<c;u++,h++)r[h]=t[u];return!0}const l=n+3*o;for(let c=n,u=s;c<l;c+=3,u+=3)a(t,c,r,u);return!0}const yPt=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:pI},Symbol.toStringTag,{value:"Module"}));function ate(t,e,n,r,i,s){return AP[0]=t,AP[1]=e,AP[2]=n,pI(AP,r,0,i,s,0)}const AP=Zg();function qUe(t,e,n){if(e==null||n==null||n.vcsWkid||uo(e,n)||Lg(e)||Lg(n))return null;const r=GQ(e)/GQ(n);if(r===1)return null;switch(t){case"point":case"esriGeometryPoint":return i=>KUe(i,r);case"polyline":case"esriGeometryPolyline":return i=>XUe(i,r);case"polygon":case"esriGeometryPolygon":return i=>YUe(i,r);case"multipoint":case"esriGeometryMultipoint":return i=>ZUe(i,r);case"extent":case"esriGeometryEnvelope":return i=>JUe(i,r);default:return null}}function KUe(t,e){t?.z!=null&&(t.z*=e)}function YUe(t,e){if(t)for(const n of t.rings)for(const r of n)r.length>2&&(r[2]*=e)}function XUe(t,e){if(t)for(const n of t.paths)for(const r of n)r.length>2&&(r[2]*=e)}function ZUe(t,e){if(t)for(const n of t.points)n.length>2&&(n[2]*=e)}function JUe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let iT=null,Ck=null,Mk=null,p2=null,d9={};const PB=new rI;function _p(){return!!(Ck?.isLoaded()&&Mk?.isLoaded()&&p2?.isLoaded())}function Kge(){return!!_p()||(tn(PB),$g(),!1)}function Yge(t,e){return!t||!e||hh(t,e)||Kge()}function QUe(t,e){return!hh(t,e)&&!_p()}async function $g(t){iT==null&&(iT=Promise.all([_e(()=>import("./projectOperator-CjRTGjL7.js"),__vite__mapDeps([102,103,104])).then(e=>(Ck=e,Ck.load())),_e(()=>import("./projectOperator-Cb0tTcLz.js"),__vite__mapDeps([105,103,104])).then(e=>(Mk=e,Mk.load())),_e(()=>import("./geographicTransformationUtils-BtqPP5__.js"),[]).then(e=>(p2=e,p2.load()))])),await iT,hi(t),PB.notify()}function av(t,e,n){return Array.isArray(t)?t.length===0?[]:(Lje(t),f9(t,t[0].spatialReference,e,n)):(a2(t),f9([t],t.spatialReference,e,n)[0])}function f9(t,e,n,r){if(e==null||n==null)return t;if(hh(e,n,r))return t.map(i=>lM(i,e,n));if(r?.geographicTransformation==null&&w4(e))return t.map(i=>lM(i,e,Bt.WGS84)).map(i=>Nk(i,n));if(r?.geographicTransformation==null&&w4(n))return t.map(i=>Nk(i,Bt.WGS84)).map(i=>lM(i,Bt.WGS84,n));if(!_p())throw new Zge;if(!r?.geographicTransformation){if(r?.extendedParams)r={...r,geographicTransformation:p2.getTransformation(e,n,r.areaOfInterestExtent)||new tT};else if(!r?.areaOfInterestExtent){const i=eGe(e,n);let s=d9[i];s||(s=p2.getTransformation(e,n)||new tT,d9[i]=s),r={geographicTransformation:s}}}return t[0].spatialReference||(t[0].spatialReference=e),t[0]instanceof Ds?Ck.executeMany(t,n,r):Mk.executeMany(t,n,r)}function eGe(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}function tGe(t,e){const n=Xge([t],e);return n.pending!=null?{pending:n.pending,geometry:null}:n.geometries!=null?{pending:null,geometry:n.geometries[0]}:{pending:null,geometry:null}}function Xge(t,e){if(!_p()){for(const n of t)if(n!=null&&!uo(n.spatialReference,e)&&rc(n.spatialReference)&&rc(e)&&!hh(n.spatialReference,e))return tn(PB),{pending:$g(),geometries:null}}return{pending:null,geometries:t.map(n=>n==null?null:uo(n.spatialReference,e)?n:rc(n.spatialReference)&&rc(e)?Nk(n,e):null)}}let Zge=class extends Xe{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function nGe(){iT=null,Ck=null,Mk=null,p2=null,d9={}}const rGe={get loadPromise(){return iT}};function Nk(t,e){try{const n=av(t,e);if(n==null)return null;"xmin"in t&&"xmin"in n&&(n.zmin=t.zmin,n.zmax=t.zmax);const r=qUe(n.type,t.spatialReference,e);return r?.(n),n}catch(n){if(!(n instanceof Zge))throw n;return null}}async function Jge(t,e,n){const r=t.spatialReference;return r!=null&&e!=null&&await Qge(r,e,null,n),Nk(t,e)}function hh(t,e,n){return!(n?.areaOfInterestExtent||n?.extendedParams||n?.geographicTransformation)&&(!!uo(t,e)||rc(t)&&rc(e)&&!!Hge(t,e))}function iGe(t,e){if(uo(t,e))return!0;if(!rc(t)||!rc(e))return!1;const n=M1(t)||Ad(t)||zQ(t),r=M1(e)||Ad(e)||zQ(e);return n&&r}async function Qge(t,e,n,r){if(_p())return iQ(r);if(Array.isArray(t)){for(const{source:i,dest:s,options:o}of t)if(i&&s&&!hh(i,s,o))return $g(r)}else if(t&&e&&!hh(t,e,n))return $g(r);return iQ(r)}function lM(t,e,n){return t?"x"in t?e0e(t,e,new Jt,n,0):"xmin"in t?s0e(t,e,new Dn,n,0):"rings"in t?i0e(t,e,new vi,n,0):"paths"in t?n0e(t,e,new xs,n,0):"points"in t?t0e(t,e,new Gu,n,0):null:null}function sGe(t,e,n=e.spatialReference,r=0){return n!=null&&t.spatialReference!=null&&e0e(t,t.spatialReference,e,n,r)!=null}function e0e(t,e,n,r,i){ta[0]=t.x,ta[1]=t.y;const s=t.z;return ta[2]=s!==void 0?s:i,pI(ta,e,0,ta,r,0)?(n.x=ta[0],n.y=ta[1],n.spatialReference=r,s!==void 0||Lg(r)?(n.z=ta[2],n.hasZ=!0):(n.z=void 0,n.hasZ=!1),t.m===void 0?(n.m=void 0,n.hasM=!1):(n.m=t.m,n.hasM=!0),n):null}function oGe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&t0e(t,t.spatialReference,e,n,r)!=null}function t0e(t,e,n,r,i){const{points:s,hasZ:o,hasM:a}=t,l=[],c=s.length,u=[];for(const f of s)u.push(f[0],f[1],o?f[2]:i);if(!pI(u,e,0,u,r,0,c))return null;const h=o||Lg(r);for(let f=0;f<c;++f){const g=3*f,v=u[g],x=u[g+1];h&&a?l.push([v,x,u[g+2],s[f][3]]):h?l.push([v,x,u[g+2]]):a?l.push([v,x,s[f][2]]):l.push([v,x])}return n.points=l,n.spatialReference=r,n.hasZ=o,n.hasM=a,n}function aGe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&n0e(t,t.spatialReference,e,n,r)!=null}function n0e(t,e,n,r,i){const{paths:s,hasZ:o,hasM:a}=t,l=[];if(!o0e(s,o??!1,a??!1,e,l,r,i))return null;const c=o||Lg(r);return n.paths=l,n.spatialReference=r,n.hasZ=c,n.hasM=a,n}function r0e(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&i0e(t,t.spatialReference,e,n,r)!=null}function i0e(t,e,n,r,i){const{rings:s,hasZ:o,hasM:a}=t,l=[];if(!o0e(s,o??!1,a??!1,e,l,r,i))return null;const c=o||Lg(r);return n.rings=l,n.spatialReference=r,n.hasZ=c,n.hasM=a,n}function lGe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&s0e(t,t.spatialReference,e,n,r)!=null}function s0e(t,e,n,r,i){const{xmin:s,ymin:o,xmax:a,ymax:l,hasZ:c,hasM:u}=t,h=c?t.zmin:i;if(!ate(s,o,h,e,ta,r))return null;const f=c||Lg(r);n.xmin=ta[0],n.ymin=ta[1],f&&(n.zmin=ta[2]);const g=c?t.zmax:i;return ate(a,l,g,e,ta,r)?(n.xmax=ta[0],n.ymax=ta[1],f&&(n.zmax=ta[2]),u&&(n.mmin=t.mmin,n.mmax=t.mmax),n.spatialReference=r,n):null}function o0e(t,e,n,r,i,s,o=0){const a=new Array;for(const u of t)for(const h of u)a.push(h[0],h[1],e?h[2]:o);if(!pI(a,r,0,a,s,0))return!1;let l=0;i.length=0;const c=e||Lg(s);for(const u of t){const h=new Array;for(const f of u)c&&n?h.push([a[l++],a[l++],a[l++],f[3]]):c?h.push([a[l++],a[l++],a[l++]]):n?(h.push([a[l++],a[l++],f[2]]),l++):(h.push([a[l++],a[l++]]),l++);i.push(h)}return!0}const ta=Zg(),_Pt=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:hh,initializeProjection:Qge,isEqualBaseGCS:iGe,isLoaded:_p,isLoadedOrLoad:Kge,isLoadedOrLoadFor:Yge,load:$g,project:av,projectExtent:lGe,projectMany:f9,projectMultipoint:oGe,projectOrLoad:tGe,projectOrLoadMany:Xge,projectPoint:sGe,projectPolygon:r0e,projectPolyline:aGe,projectWithZConversion:Jge,projectWithoutEngine:lM,requiresLoad:QUe,test:rGe,tryProjectWithZConversion:Nk,unload:nGe},Symbol.toStringTag,{value:"Module"}));var cM;let p9=cM=class extends Xg(Ot.ofType(vi)){constructor(t){super(t)}clone(){return new cM(this.items.map(t=>t.clone()))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map(n=>{if(!e.equals(n.spatialReference)){if(!hh(n.spatialReference,e))return t?.messages?.push(new kd("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const i=new vi;r0e(n,i,e),n=i}const r=n.toJSON(t);return delete r.spatialReference,r}).filter(n=>n!=null):this.toArray().map(n=>n.toJSON(t))}static fromJSON(t,e){const n=new cM;return t.forEach(r=>n.add(vi.fromJSON(r,e))),n}};p9=cM=_([ue("esri.layers.support.PolygonCollection")],p9);const sT=p9;let pf=class extends Xg(pB){constructor(e){super(e),this.id=`focusarea-${hI()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new sT}readGeometries(e,n,r){Array.isArray(e)?this.geometries=sT.fromJSON(e,r):r.origin!=="web-scene"&&r.origin!=="portal-item"||r.hooks?.onAfterLoad?.(()=>this._loadGeometries(W2(e,r),r))}async _loadGeometries(e,n){const r=await Qi(e,{responseType:"json"});this.geometries=sT.fromJSON(r.data,n)}};_([E({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),E()],pf.prototype,"id",void 0),_([E({type:String,json:{write:!0}})],pf.prototype,"title",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],pf.prototype,"enabled",void 0),_([E({type:AVe,json:{write:!0}})],pf.prototype,"outline",void 0),_([E({type:sT,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new sT(t.items.map(e=>e.clone()))}),xVe({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],pf.prototype,"geometries",void 0),_([or(["web-scene","portal-item","service"],"geometries")],pf.prototype,"readGeometries",null),pf=_([ue("esri.effects.FocusArea")],pf);const cGe=pf;let tS=class extends Xg(pB){constructor(e){super(e),this.areas=new Ot,this.style="bright"}};_([E({type:Ot.ofType(cGe),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new Ot(t.items.map(e=>e.clone()))})],tS.prototype,"areas",void 0),_([E({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],tS.prototype,"style",void 0),tS=_([ue("esri.effects.FocusAreas")],tS);const a0e=tS;function uGe(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function hGe(t){return!(!uGe(t)||!V7e(t)?.operations?.supportsEditing||"editingEnabled"in t&&!U7e(t)||Dme(t))}const dGe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,fGe="screenUtils.toPt: input not recognized!",l0e=96;function bPt(t){return t?t/72*l0e:0}function j1(t){return t?72*t/l0e:0}function bi(t){if(typeof t=="string"){const e=t.match(dGe);if(e){const n=Number(e[1]),r=e[3]&&e[3].toLowerCase(),i=t.startsWith("-"),s=r==="px"?j1(n):n;return i?-s:s}return console.warn(fGe),null}return t}function Fs(t=0,e=0){return{x:t,y:e}}function EPt(t){return t?Fs(t.x,t.y):null}function SPt(t=0,e=0){return[t,e]}function TPt(t=0,e=0,n=0){return[t,e,n]}function kPt(t){return t}function APt(t){return t}function IPt(t){return t}function RPt(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function c0e(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function pGe(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function mGe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x){const b=new Float32Array(16);return b[0]=t,b[1]=e,b[2]=n,b[3]=r,b[4]=i,b[5]=s,b[6]=o,b[7]=a,b[8]=l,b[9]=c,b[10]=u,b[11]=h,b[12]=f,b[13]=g,b[14]=v,b[15]=x,b}const gGe=c0e();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:gGe,clone:pGe,create:c0e,fromValues:mGe},Symbol.toStringTag,{value:"Module"}));function u0e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function yGe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x,b){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=g,t[13]=v,t[14]=x,t[15]=b,t}function EO(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vGe(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function _Ge(t,e){return h0e(t,e)||EO(t),t}function h0e(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],v=e[12],x=e[13],b=e[14],T=e[15],A=n*a-r*o,I=n*l-i*o,R=n*c-s*o,M=r*l-i*a,F=r*c-s*a,C=i*c-s*l,N=u*x-h*v,O=u*b-f*v,j=u*T-g*v,V=h*b-f*x,W=h*T-g*x,U=f*T-g*b;let pe=A*U-I*W+R*V+M*j-F*O+C*N;return pe?(pe=1/pe,t[0]=(a*U-l*W+c*V)*pe,t[1]=(i*W-r*U-s*V)*pe,t[2]=(x*C-b*F+T*M)*pe,t[3]=(f*F-h*C-g*M)*pe,t[4]=(l*j-o*U-c*O)*pe,t[5]=(n*U-i*j+s*O)*pe,t[6]=(b*R-v*C-T*I)*pe,t[7]=(u*C-f*R+g*I)*pe,t[8]=(o*W-a*j+c*N)*pe,t[9]=(r*j-n*W-s*N)*pe,t[10]=(v*F-x*R+T*A)*pe,t[11]=(h*R-u*F-g*A)*pe,t[12]=(a*O-o*V-l*N)*pe,t[13]=(n*V-r*O+i*N)*pe,t[14]=(x*I-v*M-b*A)*pe,t[15]=(u*M-h*I+f*A)*pe,t):null}function xGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],v=e[12],x=e[13],b=e[14],T=e[15];return t[0]=a*(f*T-g*b)-h*(l*T-c*b)+x*(l*g-c*f),t[1]=-(r*(f*T-g*b)-h*(i*T-s*b)+x*(i*g-s*f)),t[2]=r*(l*T-c*b)-a*(i*T-s*b)+x*(i*c-s*l),t[3]=-(r*(l*g-c*f)-a*(i*g-s*f)+h*(i*c-s*l)),t[4]=-(o*(f*T-g*b)-u*(l*T-c*b)+v*(l*g-c*f)),t[5]=n*(f*T-g*b)-u*(i*T-s*b)+v*(i*g-s*f),t[6]=-(n*(l*T-c*b)-o*(i*T-s*b)+v*(i*c-s*l)),t[7]=n*(l*g-c*f)-o*(i*g-s*f)+u*(i*c-s*l),t[8]=o*(h*T-g*x)-u*(a*T-c*x)+v*(a*g-c*h),t[9]=-(n*(h*T-g*x)-u*(r*T-s*x)+v*(r*g-s*h)),t[10]=n*(a*T-c*x)-o*(r*T-s*x)+v*(r*c-s*a),t[11]=-(n*(a*g-c*h)-o*(r*g-s*h)+u*(r*c-s*a)),t[12]=-(o*(h*b-f*x)-u*(a*b-l*x)+v*(a*f-l*h)),t[13]=n*(h*b-f*x)-u*(r*b-i*x)+v*(r*f-i*h),t[14]=-(n*(a*b-l*x)-o*(r*b-i*x)+v*(r*l-i*a)),t[15]=n*(a*f-l*h)-o*(r*f-i*h)+u*(r*l-i*a),t}function wGe(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],g=t[12],v=t[13],x=t[14],b=t[15];return(e*o-n*s)*(h*b-f*x)-(e*a-r*s)*(u*b-f*v)+(e*l-i*s)*(u*x-h*v)+(n*a-r*o)*(c*b-f*g)-(n*l-i*o)*(c*x-h*g)+(r*l-i*a)*(c*v-u*g)}function d0e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],g=e[10],v=e[11],x=e[12],b=e[13],T=e[14],A=e[15];let I=n[0],R=n[1],M=n[2],F=n[3];return t[0]=I*r+R*a+M*h+F*x,t[1]=I*i+R*l+M*f+F*b,t[2]=I*s+R*c+M*g+F*T,t[3]=I*o+R*u+M*v+F*A,I=n[4],R=n[5],M=n[6],F=n[7],t[4]=I*r+R*a+M*h+F*x,t[5]=I*i+R*l+M*f+F*b,t[6]=I*s+R*c+M*g+F*T,t[7]=I*o+R*u+M*v+F*A,I=n[8],R=n[9],M=n[10],F=n[11],t[8]=I*r+R*a+M*h+F*x,t[9]=I*i+R*l+M*f+F*b,t[10]=I*s+R*c+M*g+F*T,t[11]=I*o+R*u+M*v+F*A,I=n[12],R=n[13],M=n[14],F=n[15],t[12]=I*r+R*a+M*h+F*x,t[13]=I*i+R*l+M*f+F*b,t[14]=I*s+R*c+M*g+F*T,t[15]=I*o+R*u+M*v+F*A,t}function bGe(t,e,n){const r=n[0],i=n[1],s=n[2];if(e===t)t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15];else{const o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],g=e[7],v=e[8],x=e[9],b=e[10],T=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=g,t[8]=v,t[9]=x,t[10]=b,t[11]=T,t[12]=o*r+u*i+v*s+e[12],t[13]=a*r+h*i+x*s+e[13],t[14]=l*r+f*i+b*s+e[14],t[15]=c*r+g*i+T*s+e[15]}return t}function EGe(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function SGe(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o);if(a<=_l())return void u0e(t,e);a=1/a,i*=a,s*=a,o*=a;const l=Math.sin(n),c=Math.cos(n),u=1-c,h=e[0],f=e[1],g=e[2],v=e[3],x=e[4],b=e[5],T=e[6],A=e[7],I=e[8],R=e[9],M=e[10],F=e[11],C=i*i*u+c,N=s*i*u+o*l,O=o*i*u-s*l,j=i*s*u-o*l,V=s*s*u+c,W=o*s*u+i*l,U=i*o*u+s*l,pe=s*o*u-i*l,Ne=o*o*u+c;t[0]=h*C+x*N+I*O,t[1]=f*C+b*N+R*O,t[2]=g*C+T*N+M*O,t[3]=v*C+A*N+F*O,t[4]=h*j+x*V+I*W,t[5]=f*j+b*V+R*W,t[6]=g*j+T*V+M*W,t[7]=v*j+A*V+F*W,t[8]=h*U+x*pe+I*Ne,t[9]=f*U+b*pe+R*Ne,t[10]=g*U+T*pe+M*Ne,t[11]=v*U+A*pe+F*Ne,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function TGe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+h*r,t[7]=l*i+f*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=h*i-a*r,t[11]=f*i-l*r,t}function kGe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-h*r,t[3]=l*i-f*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+h*i,t[11]=l*r+f*i,t}function AGe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+h*r,t[3]=l*i+f*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=h*i-a*r,t[7]=f*i-l*r,t}function IGe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function RGe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function PGe(t,e,n){if(e===0)return EO(t);let r=n[0],i=n[1],s=n[2],o=Math.sqrt(r*r+i*i+s*s);if(o<=_l())return null;o=1/o,r*=o,i*=o,s*=o;const a=Math.sin(e),l=Math.cos(e),c=1-l;return t[0]=r*r*c+l,t[1]=i*r*c+s*a,t[2]=s*r*c-i*a,t[3]=0,t[4]=r*i*c-s*a,t[5]=i*i*c+l,t[6]=s*i*c+r*a,t[7]=0,t[8]=r*s*c+i*a,t[9]=i*s*c-r*a,t[10]=s*s*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function CGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function MGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function NGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function f0e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=r+r,l=i+i,c=s+s,u=r*a,h=r*l,f=r*c,g=i*l,v=i*c,x=s*c,b=o*a,T=o*l,A=o*c;return t[0]=1-(g+x),t[1]=h+A,t[2]=f-T,t[3]=0,t[4]=h-A,t[5]=1-(u+x),t[6]=v+b,t[7]=0,t[8]=f+T,t[9]=v-b,t[10]=1-(u+g),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function OGe(t,e){const n=LGe,r=-e[0],i=-e[1],s=-e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=r*r+i*i+s*s+o*o;return h>0?(n[0]=2*(a*o+u*r+l*s-c*i)/h,n[1]=2*(l*o+u*i+c*r-a*s)/h,n[2]=2*(c*o+u*s+a*i-l*r)/h):(n[0]=2*(a*o+u*r+l*s-c*i),n[1]=2*(l*o+u*i+c*r-a*s),n[2]=2*(c*o+u*s+a*i-l*r)),f0e(t,e,n),t}const LGe=Zg();function DGe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function $Ge(t,e){const n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(l*l+c*c+u*u),t}function jGe(t,e){const n=e[0]+e[5]+e[10];let r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function FGe(t,e,n,r){const i=e[0],s=e[1],o=e[2],a=e[3],l=i+i,c=s+s,u=o+o,h=i*l,f=i*c,g=i*u,v=s*c,x=s*u,b=o*u,T=a*l,A=a*c,I=a*u,R=r[0],M=r[1],F=r[2];return t[0]=(1-(v+b))*R,t[1]=(f+I)*R,t[2]=(g-A)*R,t[3]=0,t[4]=(f-I)*M,t[5]=(1-(h+b))*M,t[6]=(x+T)*M,t[7]=0,t[8]=(g+A)*F,t[9]=(x-T)*F,t[10]=(1-(h+v))*F,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function VGe(t,e,n,r,i){const s=e[0],o=e[1],a=e[2],l=e[3],c=s+s,u=o+o,h=a+a,f=s*c,g=s*u,v=s*h,x=o*u,b=o*h,T=a*h,A=l*c,I=l*u,R=l*h,M=r[0],F=r[1],C=r[2],N=i[0],O=i[1],j=i[2],V=(1-(x+T))*M,W=(g+R)*M,U=(v-I)*M,pe=(g-R)*F,Ne=(1-(f+T))*F,Se=(b+A)*F,je=(v+I)*C,de=(b-A)*C,Oe=(1-(f+x))*C;return t[0]=V,t[1]=W,t[2]=U,t[3]=0,t[4]=pe,t[5]=Ne,t[6]=Se,t[7]=0,t[8]=je,t[9]=de,t[10]=Oe,t[11]=0,t[12]=n[0]+N-(V*N+pe*O+je*j),t[13]=n[1]+O-(W*N+Ne*O+de*j),t[14]=n[2]+j-(U*N+Se*O+Oe*j),t[15]=1,t}function zGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,g=i*a,v=i*l,x=s*o,b=s*a,T=s*l;return t[0]=1-h-v,t[1]=u+T,t[2]=f-b,t[3]=0,t[4]=u-T,t[5]=1-c-v,t[6]=g+x,t[7]=0,t[8]=f+b,t[9]=g-x,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function UGe(t,e,n,r,i,s,o){const a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function GGe(t,e,n,r,i){const s=1/Math.tan(e/2);let o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function BGe(t,e,n,r){const i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(i+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(i-s)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function WGe(t,e,n,r,i,s,o){const a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}function HGe(t,e,n,r){const i=e[0],s=e[1],o=e[2];let a=i-n[0],l=s-n[1],c=o-n[2];const u=_l();if(Math.abs(a)<u&&Math.abs(l)<u&&Math.abs(c)<u)return void EO(t);let h=1/Math.sqrt(a*a+l*l+c*c);a*=h,l*=h,c*=h;const f=r[0],g=r[1],v=r[2];let x=g*c-v*l,b=v*a-f*c,T=f*l-g*a;h=Math.sqrt(x*x+b*b+T*T),h?(h=1/h,x*=h,b*=h,T*=h):(x=0,b=0,T=0);let A=l*T-c*b,I=c*x-a*T,R=a*b-l*x;h=Math.sqrt(A*A+I*I+R*R),h?(h=1/h,A*=h,I*=h,R*=h):(A=0,I=0,R=0),t[0]=x,t[1]=A,t[2]=a,t[3]=0,t[4]=b,t[5]=I,t[6]=l,t[7]=0,t[8]=T,t[9]=R,t[10]=c,t[11]=0,t[12]=-(x*i+b*s+T*o),t[13]=-(A*i+I*s+R*o),t[14]=-(a*i+l*s+c*o),t[15]=1}function qGe(t,e,n,r){const i=e[0],s=e[1],o=e[2],a=r[0],l=r[1],c=r[2];let u=i-n[0],h=s-n[1],f=o-n[2],g=u*u+h*h+f*f;g>0&&(g=1/Math.sqrt(g),u*=g,h*=g,f*=g);let v=l*f-c*h,x=c*u-a*f,b=a*h-l*u;return g=v*v+x*x+b*b,g>0&&(g=1/Math.sqrt(g),v*=g,x*=g,b*=g),t[0]=v,t[1]=x,t[2]=b,t[3]=0,t[4]=h*b-f*x,t[5]=f*v-u*b,t[6]=u*x-h*v,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=s,t[14]=o,t[15]=1,t}function KGe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function YGe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function XGe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function p0e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ZGe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function JGe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function QGe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function eBe(t,e){if(t===e)return!0;const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],g=t[11],v=t[12],x=t[13],b=t[14],T=t[15],A=e[0],I=e[1],R=e[2],M=e[3],F=e[4],C=e[5],N=e[6],O=e[7],j=e[8],V=e[9],W=e[10],U=e[11],pe=e[12],Ne=e[13],Se=e[14],je=e[15],de=_l();return Math.abs(n-A)<=de*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(r-I)<=de*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(i-R)<=de*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(s-M)<=de*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(o-F)<=de*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(a-C)<=de*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(l-N)<=de*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(c-O)<=de*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(u-j)<=de*Math.max(1,Math.abs(u),Math.abs(j))&&Math.abs(h-V)<=de*Math.max(1,Math.abs(h),Math.abs(V))&&Math.abs(f-W)<=de*Math.max(1,Math.abs(f),Math.abs(W))&&Math.abs(g-U)<=de*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(v-pe)<=de*Math.max(1,Math.abs(v),Math.abs(pe))&&Math.abs(x-Ne)<=de*Math.max(1,Math.abs(x),Math.abs(Ne))&&Math.abs(b-Se)<=de*Math.max(1,Math.abs(b),Math.abs(Se))&&Math.abs(T-je)<=de*Math.max(1,Math.abs(T),Math.abs(je))}function tBe(t){const e=_l(),n=t[0],r=t[1],i=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(i*i+a*a+u*u))<=e}function nBe(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const rBe=d0e,iBe=p0e;Object.freeze(Object.defineProperty({__proto__:null,add:XGe,adjoint:xGe,copy:u0e,determinant:wGe,equals:eBe,exactEquals:QGe,frob:YGe,fromQuat:zGe,fromQuat2:OGe,fromRotation:PGe,fromRotationTranslation:f0e,fromRotationTranslationScale:FGe,fromRotationTranslationScaleOrigin:VGe,fromScaling:RGe,fromTranslation:IGe,fromXRotation:CGe,fromYRotation:MGe,fromZRotation:NGe,frustum:UGe,getRotation:jGe,getScale:$Ge,getTranslation:DGe,hasIdentityRotation:nBe,identity:EO,invert:h0e,invertOrIdentity:_Ge,isOrthoNormal:tBe,lookAt:HGe,mul:rBe,multiply:d0e,multiplyScalar:ZGe,multiplyScalarAndAdd:JGe,ortho:WGe,perspective:GGe,perspectiveFromFieldOfView:BGe,rotate:SGe,rotateX:TGe,rotateY:kGe,rotateZ:AGe,scale:EGe,set:yGe,str:KGe,sub:iBe,subtract:p0e,targetTo:qGe,translate:bGe,transpose:vGe},Symbol.toStringTag,{value:"Module"}));const x$=()=>Tt.getLogger("esri.support.basemapUtils");function sBe(){return{}}function oBe(t){for(const e in t){const n=t[e];n&&!n.destroyed&&n.destroy(),delete t[e]}}function aBe(t,e){let n;if(typeof t=="string"){const r=t in $F,i=!r&&t.includes("/");if(!r&&!i){if(dF())x$().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const s=Object.entries($F).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");x$().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${s}`)}return null}e&&(n=e[t]),n||(n=r?eT.fromId(t):new eT({style:{id:t}}),e&&(e[t]=n))}else n=Va(eT,t);return n?.destroyed&&(x$().warn("The provided basemap is already destroyed",{basemap:n}),n=null),n}function lBe(t){return new Hu({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const n=[];return"tables"in e&&n.push(e.tables),"layers"in e&&n.push(e.layers),n},itemFilterFunction:e=>{const n=e.parent;return!!n&&"tables"in n&&n.tables.includes(e)}})}function IP(t){for(const e of t.values())e?.destroy();t.clear()}const lte={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function cBe(t){let e=null;if(typeof t=="string")if(t in lte){const n=lte[t];e=new R4({resourceInfo:{data:{layers:[n]}}})}else Tt.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=Va(R4,t);return e}function m9(t,e,n){let r,i;if(t)for(let s=0,o=t.length;s<o;s++){if(r=t.at(s),r?.[e]===n)return r;if(r?.type==="group"&&(i=m9(r.layers,e,n),i))return i}}const uBe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.layers=new Ot;const i=a=>{a.parent&&a.removeFromParent()},s=a=>{a.parent=this,this.layerAdded(a),a.type!=="elevation"&&a.type!=="base-elevation"||Tt.getLogger(this).error(`Layer 'title:${a.title}, id:${a.id}' of type '${a.type}' is not supported as an operational layer and will therefore be ignored.`)},o=a=>{a.parent=null,this.layerRemoved(a)};this.addHandles([this.layers.on("before-add",a=>{if(a.item===this)return a.preventDefault(),void Tt.getLogger(this).error("#add()","Cannot add layer to itself.");i(a.item)}),this.layers.on("after-add",a=>s(a.item)),this.layers.on("after-remove",a=>o(a.item))])}destroy(){const r=this.layers.toArray();for(const i of r)i.destroy();this.layers.destroy()}removeChildLayer(r){this.layers.remove(r),super.removeChildLayer?.(r)}set layers(r){this._set("layers",pd(r,this._get("layers")))}add(r,i){const s=this.layers;if(i=s.getNextIndex(i),r instanceof yi){const o=r;o.parent===this?this.reorder(o,i):s.add(o,i)}else da(r)?r.then(o=>{this.destroyed||this.add(o,i)}):Tt.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(r,i){const s=this.layers;let o=s.getNextIndex(i);r.slice().forEach(a=>{a.parent!==this?(s.add(a,o),o+=1):this.reorder(a,o)})}findLayerById(r){return m9(this.layers,"id",r)}findLayerByUid(r){return m9(this.layers,"uid",r)}remove(r){return this.layers.remove(r)}removeMany(r){return this.layers.removeMany(r)}removeAll(){return this.layers.removeAll()}reorder(r,i){return this.layers.reorder(r,i)}layerAdded(r){}layerRemoved(r){}};return _([E()],n.prototype,"layers",null),n=_([ue("esri.support.LayersMixin")],n),n},hBe=new Set(["feature","subtype-group"]);function g9(t,e,n){if(t)for(let r=0,i=t.length;r<i;r++){const s=t.at(r);if(s[e]===n)return s;if(s?.type==="group"){const o=g9(s.tables,e,n);if(o)return o}}}const dBe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.tables=new Ot,this.addHandles([this.tables.on("after-add",i=>{const s=i.item;s.parent&&s.parent!==this&&s.removeFromParent(),s.parent=this,hBe.has(s.type)||Tt.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",i=>{i.item.parent=null})])}destroy(){const r=this.tables.toArray();for(const i of r)i.destroy();this.tables.destroy()}removeChildLayer(r){this.tables.remove(r),super.removeChildLayer?.(r)}set tables(r){this._set("tables",pd(r,this._get("tables")))}findTableById(r){return g9(this.tables,"id",r)}findTableByUid(r){return g9(this.tables,"uid",r)}};return _([E()],n.prototype,"tables",null),n=_([ue("esri.support.TablesMixin")],n),n};let Pc=class extends dBe(uBe(nI)){constructor(e){super(e),this.allLayers=new Hu({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:n=>"layers"in n?n.layers:null}),this.focusAreas=new a0e,this.allTables=lBe(this),this.basemap=null,this.editableLayers=new Hu({getCollections:()=>[this.allLayers],itemFilterFunction:hGe}),this.ground=new R4,this._basemapCache=sBe(),this.addHandles(hc(()=>this.ground,(n,r)=>{r?.parent===this&&(r.parent=null),n.parent=this},{sync:!0}))}destroy(){oBe(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=Mi(this.basemap),Mi(this.ground),this._set("ground",null)}castBasemap(e){return aBe(e,this._basemapCache)}castGround(e){return cBe(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(n=>n.id===e)}findTableById(e){return this.allTables.find(n=>n.id===e)}};_([E({readOnly:!0,dependsOn:[]})],Pc.prototype,"allLayers",void 0),_([E({type:a0e,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Pc.prototype,"focusAreas",void 0),_([E({readOnly:!0})],Pc.prototype,"allTables",void 0),_([E({type:eT,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Pc.prototype,"basemap",void 0),_([zs("basemap")],Pc.prototype,"castBasemap",null),_([E({readOnly:!0})],Pc.prototype,"editableLayers",void 0),_([E({type:R4,nonNullable:!0})],Pc.prototype,"ground",void 0),_([zs("ground")],Pc.prototype,"castGround",null),_([E()],Pc.prototype,"undoRedo",void 0),Pc=_([ue("esri.Map")],Pc);const m0e=Pc;let W0=class extends pB{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"row",void 0),_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"column",void 0),_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"rows",void 0),_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"columns",void 0),W0=_([ue("esri.CameraLayout")],W0);const g0e=W0;let SO=class{constructor(e,n){this.min=e,this.max=n,this.range=n-e}normalize(e,n=0,r=!1){return cte(this.range,this.min,this.max,e,n,r)}clamp(e,n=0){return cu(e-n,this.min,this.max)+n}monotonic(e,n,r){return e<n?n:n+y9(this.range,e-n,r)}minimalMonotonic(e,n,r){return cte(this.range,e,e+this.range,n,r)}center(e,n,r){return n=this.monotonic(e,n,r),this.normalize((e+n)/2,r)}diff(e,n,r){return this.monotonic(e,n,r)-e}shortestSignedDiff(e,n){e=this.normalize(e);const r=(n=this.normalize(n))-e,i=n<e?this.minimalMonotonic(e,n)-e:n-this.minimalMonotonic(n,e);return Math.abs(r)<Math.abs(i)?r:i}contains(e,n,r){return n=this.minimalMonotonic(e,n),(r=this.minimalMonotonic(e,r))>e&&r<n}};function cte(t,e,n,r,i=0,s=!1){return(r-=i)<e?r+=y9(t,e-r):r>n&&(r-=y9(t,r-n)),s&&r===n&&(r=e),r+i}function y9(t,e,n=0){return Math.ceil((e-n)/t)*t+n}const NPt=new SO(0,2*Math.PI),OPt=new SO(-Math.PI,Math.PI),fBe=new SO(0,360);let $h=class extends fo(qt){constructor(...e){super(...e),this.position=new Jt([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new g0e}normalizeCtorArgs(e,n,r,i){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return n!=null&&(s.heading=n),r!=null&&(s.tilt=r),i!=null&&(s.fov=i),s}return e}writePosition(e,n,r,i){const s=e.clone();s.x=Zl(e.x||0),s.y=Zl(e.y||0),s.z=e.hasZ?Zl(e.z||0):e.z,n[r]=s.write({},i)}readPosition(e,n){const r=new Jt;return r.read(e,n),r.x=Zl(r.x||0),r.y=Zl(r.y||0),r.z=r.hasZ?Zl(r.z||0):r.z,r}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};_([E({type:Jt,json:{write:{isRequired:!0}}})],$h.prototype,"position",void 0),_([Xn("position")],$h.prototype,"writePosition",null),_([or("position")],$h.prototype,"readPosition",null),_([E({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),zs(t=>fBe.normalize(Zl(t)))],$h.prototype,"heading",void 0),_([E({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),zs(t=>cu(Zl(t),-180,180))],$h.prototype,"tilt",void 0),_([E({type:Number,nonNullable:!0,json:{default:55,write:!0}}),zs(t=>cu(Zl(t,55),1,170))],$h.prototype,"fov",void 0),_([E({type:g0e,nonNullable:!0,json:{read:!1,write:!1}})],$h.prototype,"layout",void 0),$h=_([ue("esri.Camera")],$h);const pBe=$h;function y0e(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function v0e(t){return t.points!==void 0}function _0e(t){return t.x!==void 0&&t.y!==void 0}function x0e(t){return t.paths!==void 0||t.curvePaths!==void 0}function CB(t){return t.rings!==void 0||t.curveRings!==void 0}function m2(t){return t==null?null:t instanceof Ds?t:_0e(t)?Jt.fromJSON(t):x0e(t)?xs.fromJSON(t):CB(t)?vi.fromJSON(t):v0e(t)?Gu.fromJSON(t):y0e(t)?Dn.fromJSON(t):null}function MB(t){return t?_0e(t)?"esriGeometryPoint":x0e(t)?"esriGeometryPolyline":CB(t)?"esriGeometryPolygon":y0e(t)?"esriGeometryEnvelope":v0e(t)?"esriGeometryMultipoint":null:null}const mBe={esriGeometryPoint:Jt,esriGeometryPolyline:xs,esriGeometryPolygon:vi,esriGeometryEnvelope:Dn,esriGeometryMultipoint:Gu,esriGeometryMultiPatch:vi};function gBe(t){return t&&mBe[t]||null}const yBe=kl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),DPt=kl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),NB={base:Ds,key:"type",typeMap:{extent:Dn,multipoint:Gu,point:Jt,polyline:xs,polygon:vi}};function $Pt(t){return t.type==="point"}function jPt(t){return t.type==="multipoint"}function FPt(t){return t.type==="polygon"}function VPt(t){return t.type==="polyline"}var v9;let mm=v9=class extends qt{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new v9({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};_([E({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:w$}}}}})],mm.prototype,"rotation",void 0),_([zs("rotation")],mm.prototype,"castRotation",null),_([E({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:w$}}}}})],mm.prototype,"scale",void 0),_([E({types:NB,json:{read:m2,write:!0,origins:{"web-scene":{read:m2,write:{overridePolicy:w$}}}}})],mm.prototype,"targetGeometry",void 0),_([E({type:pBe,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],mm.prototype,"camera",void 0),mm=v9=_([ue("esri.Viewpoint")],mm);const tu=mm;function w$(){return{enabled:!this.camera}}let Ok=class{constructor(e=n=>n.values().next().value){this._peeker=e,this._observable=new rI,this._items=new Set}get length(){return tn(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return tn(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const n=this.length;return this._items.forEach(r=>{e(r)||this._items.delete(r)}),n!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){tn(this._observable),yield*this._items}};const w0e=new FinalizationRegistry(t=>{t.close()});function vBe(t,e){w0e.register(t,e,e)}function _Be(t){w0e.unregister(t)}function b0e(t,e){return new Proxy({},{get:(n,r,i)=>(...s)=>{let o,a;const l=s[s.length-1];return xBe(l)&&(o=l.signal,a=l.transferList,s.pop()),t.apply(e?`${e}.${r.toString()}`:r.toString(),s,{transferList:a,signal:o})}})}function xBe(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const wBe={statsWorker:()=>_e(()=>import("./statsWorker-CbLzvriU.js"),__vite__mapDeps([106,107,108,109,29,30,110,111,37])),geometryEngineWorker:()=>_e(()=>import("./geometryEngineWorker-BkMQzpX8.js"),__vite__mapDeps([112,113,114,26])),arcadeGeometryOperatorsWorker:()=>_e(()=>import("./operatorsWorker--f3S_nXk.js"),[]),CSVSourceWorker:()=>_e(()=>import("./CSVSourceWorker-DH2Uzn2t.js"),__vite__mapDeps([115,116,50,49,117,118,51,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,133,134,135,19])),EdgeProcessingWorker:()=>_e(()=>import("./EdgeProcessingWorker-C87gQ_PF.js"),__vite__mapDeps([136,137,138,139,29,30,140,141,142,143,144,145,146])),ElevationSamplerWorker:()=>_e(()=>import("./ElevationSamplerWorker-CUinB0Hl.js"),__vite__mapDeps([147,120,148,149,150,151,152,153,154,139,29,30,155])),FeatureServiceSnappingSourceWorker:()=>_e(()=>import("./FeatureServiceSnappingSourceWorker-GQscbrJL.js"),__vite__mapDeps([156,117,118,50,49,51,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,7,8,157,47,48,46,52])),GaussianSplatSortWorker:()=>_e(()=>import("./GaussianSplatSortWorker-CkystscD.js"),[]),GeoJSONSourceWorker:()=>_e(()=>import("./GeoJSONSourceWorker-DyHR0YyV.js"),__vite__mapDeps([158,118,50,49,51,117,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,159,116,135,19,160])),LercWorker:()=>_e(()=>import("./LercWorker-CObfjQjb.js"),[]),MemorySourceWorker:()=>_e(()=>import("./MemorySourceWorker-CyyliqFE.js"),__vite__mapDeps([161,118,50,49,51,162,117,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,135,19,160,116])),PBFDecoderWorker:()=>_e(()=>import("./PBFDecoderWorker-C0qEI-SJ.js"),__vite__mapDeps([163,164,49,118,50,51,47,48])),FeaturePipelineWorker:()=>_e(()=>import("./FeaturePipelineWorker-D43b8QFH.js"),__vite__mapDeps([165,22,166,167,168,141,169,170,127,128,40,39,171,50,49,118,51,172,108,173,33,34,174,122,121,175,176,177,178,179,180,181,182,18,19,183,184,185,186,123,124,125,35,36,126,129,107,109,29,30,110,111,37,130,131,132,187,188,189,190,104,191,192,193,194,195,159,116,135,160,46,47,48,52,196,197])),PointCloudWorker:()=>_e(()=>import("./PointCloudWorker-BCtxY5w1.js"),__vite__mapDeps([198,199,200,29,201,202,20,14,203,204,30,150,151,205,206])),RasterWorker:()=>_e(()=>import("./RasterWorker-I3_d2MK7.js"),__vite__mapDeps([207,25,24,26,27,28,29,30,208,209,210,13,211,38])),SceneLayerSnappingSourceWorker:()=>_e(()=>import("./SceneLayerSnappingSourceWorker-De_uAVXc.js"),__vite__mapDeps([212,213,214,30,206,200,215,216,29,205,139,143,144,145,138,140,141,142,146])),SceneLayerWorker:()=>_e(()=>import("./SceneLayerWorker-BcxCVNI5.js"),__vite__mapDeps([217,148,154,218,152])),WFSSourceWorker:()=>_e(()=>import("./WFSSourceWorker-DaqAagwq.js"),__vite__mapDeps([219,118,50,49,51,117,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,159,116,160,220,221])),WorkerTileHandler:()=>_e(()=>import("./WorkerTileHandler-BWluGeg1.js"),__vite__mapDeps([222,181,223,182,224,48,49,184,225,226,142,141,28,29,30,227,180])),Lyr3DWorker:()=>_e(()=>import("./Lyr3DWorker-BuA7lkNT.js"),[]),Feature3DPipelineWorker:()=>_e(()=>import("./Feature3DPipelineWorker-8ZQcil6y.js"),__vite__mapDeps([228,124,118,50,49,51,125,35,36,126,127,128,40,121,122,129,108,107,109,29,30,110,111,37,130,131,132,39,229,230,11,12,13,14,15,8,16,17,18,19,20,176,170,33,34,231,21,22,23,232,153,148,218,152,233,201,234,145,139,235,214,206,200,213,236,237,216,205,204,199,150,151,142,141,138,140,238,239,240,241,242,243,244,245,246,247,120,46,47,48,52,248])),TextureCompressionWorker:()=>_e(()=>import("./TextureCompressionWorker-DaGlKNrr.js"),[]),FlowWorker:()=>_e(()=>import("./FlowWorker-CRtLauKv.js"),__vite__mapDeps([249,38])),ParquetSourceWorker:()=>_e(()=>import("./ParquetSourceWorker-DVYX8NaV.js"),__vite__mapDeps([250,186,124,118,50,49,51,125,35,36,126,127,128,40,121,122,129,108,107,109,29,30,110,111,37,130,131,132,39,135,19,251,134,189,171,172,188,187])),PanoramicMeshWorker:()=>_e(()=>import("./PanoramicMeshWorker-CFebDxOV.js"),__vite__mapDeps([252,25]))},E0e="worker:port-closed",Yf={HANDSHAKE:0,OPEN:1,OPENED:2,RESPONSE:3,INVOKE:4,ABORT:5,CLOSE:6,OPEN_PORT:7,ON:8};let bBe=0;function S0e(){return bBe++}function EBe(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function M4(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function T0e(t,e,n,r){if(e.type===Yf.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Yf.INVOKE&&e.type!==Yf.RESPONSE)return void t.postMessage(e);let i;EBe(n)?(i=ute(n.transferList),e.data=n.result):(i=ute(r),e.data=n),i?t.postMessage(e,i):t.postMessage(e)}function Lk(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function ute(t){if(!t?.length)return null;if(ye("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(n=>!SBe(n));return e.length?e:null}function SBe(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function UPt(t){try{return await t}catch(e){const n=e?.name===E0e;if(!(ya(e)||n))throw e;return}}const{CLOSE:RP,ABORT:_9,INVOKE:hte,RESPONSE:wE,OPEN_PORT:dte,ON:fte}=Yf,TBe=2;let kBe=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===_9?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var zc;let g2=(zc=class{static connect(e,n){const r=new MessageChannel;let i;i=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const s=new zc(r.port1,{channel:r,client:i,schedule:n});return typeof i=="object"&&"remoteClient"in i&&(i.remoteClient=s),zc.clients.set(s,i),r.port2}static loadWorker(e){const n=wBe[e];return n?n():Promise.resolve(null)}constructor(e,n,r,i){this._port=e,this._jobQueue=r,this._lowPriorityJobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new kBe(s=>this._onInvokeMessage(s)),this._client=n.client,this._onMessage=this._onMessage.bind(this),this._channel=n.channel,this._schedule=n.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:RP}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,n,r){return this.apply(e,[n],r)}apply(e,n,r){const i=r?.signal,s=r?.transferList;if(!this._port)return Promise.reject(new Xe(E0e,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:n}));const o=S0e();return new Promise((a,l)=>{if(ha(i))return this._processWork(),void l(Tr());const c=lu(i,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),Qr(h.abortHandle),this._post({type:_9,jobId:o}),l(Tr()))}),u={resolve:a,reject:l,abortHandle:c,debugInfo:e};this._outJobs.set(o,u),this._post({type:hte,jobId:o,methodName:e,abortable:i!=null},n,s)})}createInvokeProxy(e){return b0e(this,e)}on(e,n){const r=new MessageChannel;function i(s){n(s.data)}return this._port.postMessage({type:fte,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",i),r.port1.start(),qn(()=>{r.port1.postMessage({type:RP}),r.port1.close(),r.port1.removeEventListener("message",i)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:dte,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=TBe)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:n,data:r,invokeOptions:i,resolver:s}=e;this.apply(n,r,i).then(o=>s.resolve(o)).catch(o=>s.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{Qr(e.abortHandle),e.reject(Tr(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null,this._onMessage=null,this._channel=null,this._jobQueue=void 0,this._invokeQueue=void 0,this._lowPriorityJobQueue=void 0}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,n){const r=Lk(e);if(r)switch(r.type){case wE:this._onResponseMessage(r);break;case hte:n?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case _9:this._onAbortMessage(r);break;case RP:this._onCloseMessage();break;case dte:this._onOpenPortMessage(r);break;case fte:this._onOnMessage(r)}}_onAbortMessage(e){const n=this._inJobs,r=e.jobId,i=n.get(r);this._invokeQueue.push(e),i&&(i.controller&&i.controller.abort(),n.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&zc.clients.get(this)===e&&e.destroy(),zc.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:n,jobId:r,data:i=[],abortable:s}=e,o=s?new AbortController:null,a=this._inJobs;let l,c=this._client,u=c[n];try{if(!u&&n&&n.includes(".")){const h=n.split(".");for(let f=0;f<h.length-1;f++)c=c[h[f]],u=c[h[f+1]]}if(typeof u!="function")throw new TypeError(`${n} is not a function`);i.push({client:this,signal:o?o.signal:null}),l=u.apply(c,i)}catch(h){return void this._post({type:wE,jobId:r,error:M4(h)})}da(l)?(a.set(r,{controller:o,promise:l}),l.then(h=>{a.has(r)&&(a.delete(r),this._post({type:wE,jobId:r},h))},h=>{a.has(r)&&(a.delete(r),ya(h)||this._post({type:wE,jobId:r,error:M4(h||{message:`Error encountered at method ${n}`})}))})):this._post({type:wE,jobId:r},l)}_onOpenPortMessage(e){new zc(e.port,{client:this._client})}_onOnMessage(e){const{port:n}=e,r=this._client.on(e.eventType,s=>{n.postMessage(s)}),i=B2(e.port,"message",s=>{Lk(s)?.type===RP&&(i.remove(),r.remove(),n.close())})}_onResponseMessage(e){const{jobId:n,error:r,data:i}=e,s=this._outJobs;if(!s.has(n))return;const o=s.get(n);s.delete(n),this._processWork(),Qr(o.abortHandle),r?o.reject(Xe.fromJSON(JSON.parse(r))):o.resolve(i)}_post(e,n,r){return T0e(this._port,e,n,r)}},zc.kernelInfo={buildDate:Pde,fullVersion:bG,revision:Cde},zc.clients=new Map,zc),ABe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Ok,this._ongoingLowPriorityJobsQueue=new Ok}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,n){return new Promise((r,i)=>{let s=!0;const o=a=>{hi(n.signal),s&&(s=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];da(l)?this._clientPromises[a]=l.then(c=>(this._clients[a]=new g2(c,n,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(r),this._clients[a]),()=>(o(i),null)):(this._clients[a]=new g2(l,n,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(r))}})}broadcast(e,n,r){const i=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];i[s]=o.then(a=>a?.invoke(e,n,r))}return i}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(Tr(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(Tr(`Worker closing, aborting job calling '${e.methodName}'`));for(const n of this._clientPromises)n.then(r=>r?.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,_Be(this)}invoke(e,n,r){return this.apply(e,[n],r)}apply(e,n,r){const i=uc();(r?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:n,invokeOptions:r,resolver:i});for(let s=0;s<this._clientPromises.length;s++){const o=this._clients[s];o?o.jobAdded():this._clientPromises[s].then(a=>a?.jobAdded())}return i.promise}createInvokeProxy(e){return b0e(this,e)}on(e,n){return Promise.all(this._clientPromises).then(()=>rv(this._clients.map(r=>r.on(e,n))))}openPorts(){return new Promise(e=>{const n=new Array(this._clientPromises.length);let r=n.length;for(let i=0;i<this._clientPromises.length;++i)this._clientPromises[i].then(s=>{s&&(n[i]=s.openPort()),--r===0&&e(n)})})}get test(){}};const IBe={async request(t,e){const n=t.options,r=n.responseType;n.signal=e?.signal,n.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&oF(t.url)?.after?r:"array-buffer";const i=await Qi(t.url,n),s={data:i.data,httpStatus:i.httpStatus,ssl:i.ssl};switch(i.requestOptions?.responseType){case"native-request-init":return delete s.data.signal,s;case"blob":s.data=await s.data.arrayBuffer();break;case"json":s.data=new TextEncoder().encode(JSON.stringify(s.data)).buffer;break;case"text":s.data=new TextEncoder().encode(s.data).buffer}return{result:s,transferList:[s.data]}}},pte={};function RBe(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...pte.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=pte.baseUrl),e}let PBe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(n=>{this[n]=(...r)=>e[n](...r)})}},uM=class{constructor(){this._dispatcher=new PBe,this._workerPostMessage({type:Yf.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){u4(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,n,r){this._dispatcher.addEventListener(e,n,r)}removeEventListener(e,n,r){this._dispatcher.removeEventListener(e,n,r)}_workerPostMessage(e){u4(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const n=Lk(e);if(n&&n.type===Yf.OPEN){const{modulePath:r,jobId:i}=n;let s=await g2.loadWorker(r);s||(s=await import(r));const o=g2.connect(s);this._workerPostMessage({type:Yf.OPENED,jobId:i,data:o})}}};const x9=()=>Tt.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:CBe}=Yf,MBe='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}).finally(()=>{t&&t.removeEventListener("abort",s)})}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://esriurl.com/using-local-assets.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||new Promise(e=>{require([o.modulePath],e)})).then(t)}):"System"in self&&"function"==typeof System.import?System.import(workerPath).then(e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath))).then(e=>e||System.import(o.modulePath)).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||import(o.modulePath)).then(t)}):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let PP,CP;const mte="Failed to create Worker. Fallback to execute module in main thread";async function NBe(){if(!ye("esri-workers"))return gte(new uM);if(!PP&&!CP)try{const e=MBe.split("{CONFIGURATION}").join(OBe());PP=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){CP=e||{}}let t;if(PP)try{t=new Worker(PP,{name:"esri-worker-"+LBe++})}catch{x9().warn(mte,CP),t=new uM}else x9().warn(mte,CP),t=new uM;return gte(t)}async function gte(t){return new Promise(e=>{function n(i){const s=Lk(i);s&&s.type===CBe&&(t.removeEventListener("message",n),t.removeEventListener("error",r),e(t))}function r(i){i.preventDefault(),t.removeEventListener("message",n),t.removeEventListener("error",r),x9().warn("Failed to create Worker. Fallback to execute module in main thread",i),(t=new uM).addEventListener("message",n),t.addEventListener("error",r)}t.addEventListener("message",n),t.addEventListener("error",r)})}function OBe(){let t;if(Qn.default!=null){const i={...Qn};delete i.default,t=JSON.parse(JSON.stringify(i))}else t=JSON.parse(JSON.stringify(Qn));t.assetsPath=Bc(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?Bc(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=eu(),t.has={"esri-csp-restrictions":ye("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ye("esri-2d-update-debug"),"esri-2d-log-updating":ye("esri-2d-log-updating"),"featurelayer-pbf":ye("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":ye("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":ye("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ye("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ye("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":ye("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":ye("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":ye("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":ye("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":ye("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":ye("featurelayer-snapshot-enabled"),"parquetlayer-full-query-feature-count":ye("parquetlayer-full-query-feature-count"),"esri-atomics":ye("esri-atomics"),"esri-shared-array-buffer":ye("esri-shared-array-buffer"),"esri-tiles-debug":ye("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ye("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ye("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=Bc(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=Bc(t.workers.workerPath):t.workers.workerPath=Bc(Gi("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Qn.workers.loaderConfig,n=RBe({baseUrl:e?.baseUrl,locale:eu(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:n,kernelInfo:{buildDate:Pde,fullVersion:bG,revision:Cde}})}let LBe=0;const{ABORT:yte,INVOKE:DBe,OPEN:$Be,OPENED:jBe,RESPONSE:bE}=Yf;let FBe=class k0e{static async create(e){const n=await NBe();return new k0e(n,e)}constructor(e,n){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=n,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",r=>{r.preventDefault(),Tt.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(e,n={}){const{signal:r}=n,i=S0e();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:EG(r,()=>{this._outJobs.delete(i),this._post({type:yte,jobId:i})})};this._outJobs.set(i,a),this._post({type:$Be,jobId:i,modulePath:e})})}_onMessage(e){const n=Lk(e);if(n)switch(n.type){case jBe:this._onOpenedMessage(n);break;case bE:this._onResponseMessage(n);break;case yte:this._onAbortMessage(n);break;case DBe:this._onInvokeMessage(n)}}_onAbortMessage(e){const n=this._inJobs,r=e.jobId,i=n.get(r);i&&(i.controller&&i.controller.abort(),n.delete(r))}_onInvokeMessage(e){const{methodName:n,jobId:r,data:i,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs,l=IBe[n];let c;try{if(typeof l!="function")throw new TypeError(`${n} is not a function`);c=l.call(null,i,{signal:o?o.signal:null})}catch(u){return void this._post({type:bE,jobId:r,error:M4(u)})}da(c)?(a.set(r,{controller:o,promise:c}),c.then(u=>{a.has(r)&&(a.delete(r),this._post({type:bE,jobId:r},u))},u=>{a.has(r)&&(a.delete(r),u||(u={message:"Error encountered at method"+n}),ya(u)||this._post({type:bE,jobId:r,error:M4(u||{message:`Error encountered at method ${n}`})}))})):this._post({type:bE,jobId:r},c)}_onOpenedMessage(e){const{jobId:n,data:r}=e,i=this._outJobs.get(n);i&&(this._outJobs.delete(n),Qr(i.abortHandle),i.resolve(r))}_onResponseMessage(e){const{jobId:n,error:r,data:i}=e,s=this._outJobs.get(n);s&&(this._outJobs.delete(n),Qr(s.abortHandle),r?s.reject(Xe.fromJSON(JSON.parse(r))):s.resolve(i))}_post(e,n,r){return T0e(this.worker,e,n,r)}};const vte=ye("host-browser")?Math.min(navigator.hardwareConcurrency-1,ye("workers-pool-size")??8):0;let Cy=ye("esri-mobile")?Math.min(vte,3):vte;Cy||(Cy=ye("safari")&&ye("mac")?7:2);let _te=0;const hM=[];function VBe(){A0e()}async function MP(t,e){const n=new ABe,{registryTarget:r,...i}=e;return await n.open(t,i),r&&vBe(r,n),n}async function qPt(t,e={}){if(typeof t!="string")throw new Xe("workers:undefined-module","modulePath is missing");let n=e.strategy||"distributed";if(ye("host-webworker")&&!ye("esri-workers")&&(n="local"),n==="local"){let r=await g2.loadWorker(t);r||(r=await import(t)),hi(e.signal);const i=e.client||r;return MP([g2.connect(r,e.schedule)],{...e,client:i})}if(await A0e(),hi(e.signal),n==="dedicated"){const r=_te++%Cy;return MP([await hM[r].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const r=Math.min(e.maxNumWorkers,Cy);if(r<Cy){const i=new Array(r);for(let s=0;s<r;++s){const o=_te++%Cy;i[s]=hM[o].open(t,e)}return MP(i,e)}}return MP(hM.map(r=>r.open(t,e)),e)}let NP=null;async function A0e(){if(NP)return NP;new AbortController;const t=[];for(let e=0;e<Cy;e++){const n=FBe.create(e).then(r=>(hM[e]=r,r));t.push(n)}return NP=Promise.all(t),NP}let oT=class extends Ot{constructor(e){super(e),this.addHandles([this.on("before-add",n=>{n.item==null&&n.preventDefault()}),this.on("after-add",n=>this._own(n.item)),this.on("after-remove",n=>this._release(n.item))])}get owner(){return this._get("owner")}set owner(e){this.destroyed||e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Ot.ofType(this.itemType.Type))(e):new Ot(e)}};function w9(t,e){return{type:t,cast:Dfe,set(n){const r=pd(n,this._get(e),t);r&&!r.destroyed&&(r.owner=this),this._set(e,r)}}}_([E()],oT.prototype,"owner",null),oT=_([ue("esri.core.support.OwningCollection")],oT);var b9,mw;let To=(mw=class extends qt{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new b9({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},b9=mw,mw);_([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],To.prototype,"cols",void 0),_([E({type:Or,json:{write:!0}})],To.prototype,"level",void 0),_([E({type:String,json:{write:!0}})],To.prototype,"levelValue",void 0),_([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],To.prototype,"origin",void 0),_([E({type:Number,json:{write:!0}})],To.prototype,"resolution",void 0),_([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],To.prototype,"rows",void 0),_([E({type:Number,json:{write:!0}})],To.prototype,"scale",void 0),To=b9=_([ue("esri.layers.support.LOD")],To);let zBe=class I0e{constructor(e,n,r,i=ml()){this._level=e,this._row=n,this._col=r,this.extent=i}get id(){return this._id??=`${this.level}/${this.row}/${this.col}`,this._id}get level(){return this._level}set level(e){this._level=e,this._id=null}get row(){return this._row}set row(e){this._row=e,this._id=null}get col(){return this._col}set col(e){this._col=e,this._id=null}toJSON(){return{level:this._level,row:this._row,col:this._col,extent:this.extent}}static fromJSON(e){return new I0e(e.level,e.row,e.col,e.extent)}};var U_;const xte=new Gs({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var gw;let xa=(gw=class extends qt{static create(e={}){const{resolutionFactor:n=1,scales:r,size:i=256,spatialReference:s=Bt.WebMercator,numLODs:o=24}=e;if(!rc(s)){const f=[];if(r)for(let g=0;g<r.length;g++){const v=r[g];f.push(new To({level:g,scale:v,resolution:v}))}else{let g=5e-4;for(let v=o-1;v>=0;v--)f.unshift(new To({level:v,scale:g,resolution:g})),g*=2}return new U_({dpi:96,lods:f,origin:new Jt(0,0,s),size:[i,i],spatialReference:s})}const a=La(s),l=e.origin?new Jt({x:e.origin.x,y:e.origin.y,spatialReference:s}):new Jt(a?{x:a.origin[0],y:a.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),c=96,u=1/($d(s)*39.37*c),h=[];if(r)for(let f=0;f<r.length;f++){const g=r[f],v=g*u;h.push(new To({level:f,scale:g,resolution:v}))}else{let f=X2(s)?512/i*5916575275917094e-7:256/i*591657527591555e-6;const g=Math.ceil(o/n);h.push(new To({level:0,scale:f,resolution:f*u}));for(let v=1;v<g;v++){const x=f/2**n,b=x*u;h.push(new To({level:v,scale:x,resolution:b})),f=x}}return new U_({dpi:c,lods:h,origin:l,size:[i,i],spatialReference:s})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:n}=this;if(e&&n){const r=La(e);return e.isWrappable&&!!r&&Math.abs(r.origin[0]-n.x)<=r.dx}return!1}readOrigin(e,n){return Jt.fromJSON({spatialReference:n.spatialReference,...e})}set lods(e){let n=0,r=0;const i=[],s=this._levelToLOD={};e&&(n=-1/0,r=1/0,e.forEach(o=>{i.push(o.scale),n=o.scale>n?o.scale:n,r=o.scale<r?o.scale:r,s[o.level]=o})),this._set("scales",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,n){return[n.cols,n.rows]}writeSize(e,n){n.cols=e[0],n.rows=e[1]}zoomToScale(e){const n=this.scales;if(e<=0)return n[0];if(e>=n.length-1)return n[n.length-1];const r=Math.floor(e),i=r+1;return n[r]/(n[r]/n[i])**(e-r)}scaleToZoom(e){const n=this.scales,r=n.length-1;let i=0;for(;i<r;i++){const s=n[i],o=n[i+1];if(s<=e)return i;if(o===e)return i+1;if(s>e&&o<e)return i+Math.log(s/e)/Math.log(s/o)}return i}tileAt(e,n,r,i){const s=this.lodAt(e);if(!s)return null;let o,a;if(typeof n=="number")o=n,a=r;else if(uo(n.spatialReference,this.spatialReference))o=n.x,a=n.y,i=r;else{const u=cO(n,this.spatialReference);if(u==null)return null;o=u.x,a=u.y,i=r}const l=s.resolution*this.size[0],c=s.resolution*this.size[1];return i??=new zBe(0,0,0),i.level=e,i.row=Math.floor((this.origin.y-a)/c+.001),i.col=Math.floor((o-this.origin.x)/l+.001),this.updateTileInfo(i),i}updateTileInfo(e,n=0){if(!("extent"in e))return!1;let r=this.lodAt(e.level);if(!r&&n===1){const a=this.lods[this.lods.length-1];a.level<e.level&&(r=a)}if(!r)return!1;const i=e.level-r.level,s=r.resolution*this.size[0]/2**i,o=r.resolution*this.size[1]/2**i;return e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+o,!0}upsampleTile(e){const n=this._upsampleLevels[e.level];return!(!n||n.parentLevel===-1)&&(e.level=n.parentLevel,e.row=Math.floor(e.row/n.factor+.001),e.col=Math.floor(e.col/n.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,n){const r=this.lodAt(n.level);if(r==null)return null;const{resolution:i}=r,s=i*this.size[0],o=i*this.size[1];return e[0]=this.origin.x+n.col*s,e[1]=this.origin.y-(n.row+1)*o,e[2]=e[0]+s,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return U_.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const n=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&n===0)return this;const r=[],i=this.lods.length-n;for(let s=0;s<i;s++){const o=s+n,{scale:a,resolution:l}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};r.push(new To({level:s,scale:a,resolution:l}))}return new U_({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:r})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let n=null;for(let r=0;r<e.length;r++){const i=e[r];this._upsampleLevels[i.level]={parentLevel:n?n.level:-1,factor:n?n.resolution/i.resolution:0},n=i}}},U_=gw,gw);_([E({type:Number,json:{write:!0}})],xa.prototype,"compressionQuality",void 0),_([E({type:Number,json:{write:!0}})],xa.prototype,"dpi",void 0),_([E({type:String,json:{read:xte.read,write:xte.write,origins:{"web-scene":{read:!1,write:!1}}}})],xa.prototype,"format",void 0),_([E({readOnly:!0})],xa.prototype,"isWrappable",null),_([E({type:Jt,json:{write:!0}})],xa.prototype,"origin",void 0),_([or("origin")],xa.prototype,"readOrigin",null),_([E({type:[To],value:null,json:{write:!0}})],xa.prototype,"lods",null),_([E({readOnly:!0})],xa.prototype,"scales",void 0),_([E({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],xa.prototype,"size",void 0),_([or("size",["rows","cols"])],xa.prototype,"readSize",null),_([Xn("size",{cols:{type:Or},rows:{type:Or}})],xa.prototype,"writeSize",null),_([E({type:Bt,json:{write:!0}})],xa.prototype,"spatialReference",void 0),xa=U_=_([ue("esri.layers.support.TileInfo")],xa);let y2=class extends oT{constructor(e){super(e),this.addHandles(this.on("before-add",n=>{n.item!=null&&n.item.parent===this.owner&&(Tt.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),n.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};y2=_([ue("esri.support.AnalysesCollection")],y2);const dM={widthBreakpoint:{getValue(t){const e=t.viewSize[0],n=t.breakpoints,r=this.values;return e<=n.xsmall?r.xsmall:e<=n.small?r.small:e<=n.medium?r.medium:e<=n.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],n=t.breakpoints,r=this.values;return e<=n.xsmall?r.xsmall:e<=n.small?r.small:e<=n.medium?r.medium:e<=n.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,n=e[0],r=e[1],i=this.values;return r>=n?i.portrait:i.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},b$={xsmall:544,small:768,medium:992,large:1200};function UBe(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function E$(t,e){return e?dM[t].valueToClassName[e].split(" "):[]}const GBe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=b$}initialize(){this.addHandles(dn(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),fa))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(r){if(r!==this._get("breakpoints")){if(!UBe(r)){const i=JSON.stringify(b$,null,2);console.warn("provided breakpoints are not valid, using defaults:"+i),r=b$}this._set("breakpoints",{...r})}}_updateClassNames(){if(!this.container)return;const r=Aa.acquire(),i=Aa.acquire();let s,o=!1;for(s in dM){const a=this[s],l=dM[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(o=!0,this[s]=l,E$(s,a).forEach(c=>i.push(c)),E$(s,l).forEach(c=>r.push(c)))}o&&(this._applyClassNameChanges(r,i),Aa.release(r),Aa.release(i))}_applyClassNameChanges(r,i){const s=this.container;s&&(i.forEach(o=>s.classList.remove(o)),r.forEach(o=>s.classList.add(o)))}_removeActiveClassNames(){const r=this.container;if(!r)return;let i;for(i in dM)E$(i,this[i]).forEach(s=>r.classList.remove(s))}};return _([E()],n.prototype,"breakpoints",null),_([E()],n.prototype,"orientation",void 0),_([E()],n.prototype,"widthBreakpoint",void 0),_([E()],n.prototype,"heightBreakpoint",void 0),n=_([ue("esri.views.BreakpointsOwner")],n),n};function OB(t){return typeof t=="string"?document.getElementById(t):t??null}function wte(t,e){for(;;){const n=t.firstChild;if(!n)break;e.appendChild(n)}}let Jy=class extends Kt{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,n,r={}){return this._installWatch(e,n,r,dn)}addWhen(e,n,r={}){return this._installWatch(e,n,r,hc)}addOnCollectionChange(e,n,{initial:r=!1,final:i=!1}={}){const s=++this._handleId;return this.addHandles([$1(e,"after-changes",this._createSyncUpdatingCallback(),Dg),$1(e,"change",n,{onListenerAdd:r?o=>n({added:o.toArray(),removed:[]}):void 0,onListenerRemove:i?o=>n({added:[],removed:o.toArray()}):void 0})],s),qn(()=>this.removeHandles(s))}addPromise(e){if(e==null)return e;const n=++this._handleId;this.addHandles(qn(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(OP)||this._set("updating",!1))}),n),this._pendingPromises.add(e),this._set("updating",!0);const r=()=>this.removeHandles(n);return e.then(r,r),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,n,r={},i){const s=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,s);const o=i(e,n,r);return this.addHandles(o,s),qn(()=>this.removeHandles(s))}_installSyncUpdatingWatch(e,n){const r=this._createSyncUpdatingCallback(),i=dn(e,r,{sync:!0,equals:()=>!1});return this.addHandles(i,n),i}_createSyncUpdatingCallback(){return()=>{this.removeHandles(OP),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Y2(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(OP))}),OP)}}};_([E({readOnly:!0})],Jy.prototype,"updating",void 0),Jy=_([ue("esri.core.support.UpdatingHandles")],Jy);const OP=-42;var N4=function(){return N4=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},N4.apply(this,arguments)},E9={exports:{}},ji={},S9={exports:{}},lv={};function R0e(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function BBe(t,e,n){}function WBe(t,e,n){}var HBe=/javascript\s*\:/img;function qBe(t,e){return HBe.test(e)?"":e}lv.whiteList=R0e();lv.getDefaultWhiteList=R0e;lv.onAttr=BBe;lv.onIgnoreAttr=WBe;lv.safeAttrValue=qBe;var KBe={indexOf:function(t,e){var n,r;if(Array.prototype.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},forEach:function(t,e,n){var r,i;if(Array.prototype.forEach)return t.forEach(e,n);for(r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},EE=KBe;function YBe(t,e){t=EE.trimRight(t),t[t.length-1]!==";"&&(t+=";");var n=t.length,r=!1,i=0,s=0,o="";function a(){if(!r){var u=EE.trim(t.slice(i,s)),h=u.indexOf(":");if(h!==-1){var f=EE.trim(u.slice(0,h)),g=EE.trim(u.slice(h+1));if(f){var v=e(i,o.length,f,g,u);v&&(o+=v+"; ")}}}i=s+1}for(;s<n;s++){var l=t[s];if(l==="/"&&t[s+1]==="*"){var c=t.indexOf("*/",s+2);if(c===-1)break;s=c+1,i=s+1,r=!1}else l==="("?r=!0:l===")"?r=!1:l===";"?r||a():l===`
`&&a()}return EE.trim(o)}var XBe=YBe,LP=lv,ZBe=XBe;function bte(t){return t==null}function JBe(t){var e={};for(var n in t)e[n]=t[n];return e}function P0e(t){t=JBe(t||{}),t.whiteList=t.whiteList||LP.whiteList,t.onAttr=t.onAttr||LP.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||LP.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||LP.safeAttrValue,this.options=t}P0e.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,n=e.options,r=n.whiteList,i=n.onAttr,s=n.onIgnoreAttr,o=n.safeAttrValue,a=ZBe(t,function(l,c,u,h,f){var g=r[u],v=!1;if(g===!0?v=g:typeof g=="function"?v=g(h):g instanceof RegExp&&(v=g.test(h)),v!==!0&&(v=!1),h=o(u,h),!!h){var x={position:c,sourcePosition:l,source:f,isWhite:v};if(v){var b=i(u,h,x);return bte(b)?u+":"+h:b}else{var b=s(u,h,x);if(!bte(b))return b}}});return a};var QBe=P0e;(function(t,e){var n=lv,r=QBe;function i(o,a){var l=new r(a);return l.process(o)}e=t.exports=i,e.FilterCSS=r;for(var s in n)e[s]=n[s]})(S9,S9.exports);var LB=S9.exports,DB={indexOf:function(t,e){var n,r;if(Array.prototype.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},forEach:function(t,e,n){var r,i;if(Array.prototype.forEach)return t.forEach(e,n);for(r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,n=e.exec(t);return n?n.index:-1}},eWe=LB.FilterCSS,tWe=LB.getDefaultWhiteList,O4=DB;function C0e(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var M0e=new eWe;function nWe(t,e,n){}function rWe(t,e,n){}function iWe(t,e,n){}function sWe(t,e,n){}function N0e(t){return t.replace(aWe,"&lt;").replace(lWe,"&gt;")}function oWe(t,e,n,r){if(n=F0e(n),e==="href"||e==="src"){if(n=O4.trim(n),n==="#")return"#";if(!(n.substr(0,7)==="http://"||n.substr(0,8)==="https://"||n.substr(0,7)==="mailto:"||n.substr(0,4)==="tel:"||n.substr(0,11)==="data:image/"||n.substr(0,6)==="ftp://"||n.substr(0,2)==="./"||n.substr(0,3)==="../"||n[0]==="#"||n[0]==="/"))return""}else if(e==="background"){if(DP.lastIndex=0,DP.test(n))return""}else if(e==="style"){if(Ete.lastIndex=0,Ete.test(n)||(Ste.lastIndex=0,Ste.test(n)&&(DP.lastIndex=0,DP.test(n))))return"";r!==!1&&(r=r||M0e,n=r.process(n))}return n=V0e(n),n}var aWe=/</g,lWe=/>/g,cWe=/"/g,uWe=/&quot;/g,hWe=/&#([a-zA-Z0-9]*);?/gim,dWe=/&colon;?/gim,fWe=/&newline;?/gim,DP=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Ete=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Ste=/u\s*r\s*l\s*\(.*/gi;function O0e(t){return t.replace(cWe,"&quot;")}function L0e(t){return t.replace(uWe,'"')}function D0e(t){return t.replace(hWe,function(n,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function $0e(t){return t.replace(dWe,":").replace(fWe," ")}function j0e(t){for(var e="",n=0,r=t.length;n<r;n++)e+=t.charCodeAt(n)<32?" ":t.charAt(n);return O4.trim(e)}function F0e(t){return t=L0e(t),t=D0e(t),t=$0e(t),t=j0e(t),t}function V0e(t){return t=O0e(t),t=N0e(t),t}function pWe(){return""}function mWe(t,e){typeof e!="function"&&(e=function(){});var n=!Array.isArray(t);function r(o){return n?!0:O4.indexOf(t,o)!==-1}var i=[],s=!1;return{onIgnoreTag:function(o,a,l){if(r(o))if(l.isClosing){var c="[/removed]",u=l.position+c.length;return i.push([s!==!1?s:l.position,u]),s=!1,c}else return s||(s=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return O4.forEach(i,function(c){a+=o.slice(l,c[0]),l=c[1]}),a+=o.slice(l),a}}}function gWe(t){for(var e="",n=0;n<t.length;){var r=t.indexOf("<!--",n);if(r===-1){e+=t.slice(n);break}e+=t.slice(n,r);var i=t.indexOf("-->",r);if(i===-1)break;n=i+3}return e}function yWe(t){var e=t.split("");return e=e.filter(function(n){var r=n.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),e.join("")}ji.whiteList=C0e();ji.getDefaultWhiteList=C0e;ji.onTag=nWe;ji.onIgnoreTag=rWe;ji.onTagAttr=iWe;ji.onIgnoreTagAttr=sWe;ji.safeAttrValue=oWe;ji.escapeHtml=N0e;ji.escapeQuote=O0e;ji.unescapeQuote=L0e;ji.escapeHtmlEntities=D0e;ji.escapeDangerHtml5Entities=$0e;ji.clearNonPrintableCharacter=j0e;ji.friendlyAttrValue=F0e;ji.escapeAttrValue=V0e;ji.onIgnoreTagStripAll=pWe;ji.StripTagBody=mWe;ji.stripCommentTag=gWe;ji.stripBlankChar=yWe;ji.cssFilter=M0e;ji.getDefaultCSSWhiteList=tWe;var TO={},Cm=DB;function vWe(t){var e=Cm.spaceIndex(t),n;return e===-1?n=t.slice(1,-1):n=t.slice(1,e+1),n=Cm.trim(n).toLowerCase(),n.slice(0,1)==="/"&&(n=n.slice(1)),n.slice(-1)==="/"&&(n=n.slice(0,-1)),n}function _We(t){return t.slice(0,2)==="</"}function xWe(t,e,n){var r="",i=0,s=!1,o=!1,a=0,l=t.length,c="",u="";e:for(a=0;a<l;a++){var h=t.charAt(a);if(s===!1){if(h==="<"){s=a;continue}}else if(o===!1){if(h==="<"){r+=n(t.slice(i,a)),s=a,i=a;continue}if(h===">"){r+=n(t.slice(i,s)),u=t.slice(s,a+1),c=vWe(u),r+=e(s,r.length,c,u,_We(u)),i=a+1,s=!1;continue}if(h==='"'||h==="'")for(var f=1,g=t.charAt(a-f);g.trim()===""||g==="=";){if(g==="="){o=h;continue e}g=t.charAt(a-++f)}}else if(h===o){o=!1;continue}}return i<t.length&&(r+=n(t.substr(i))),r}var wWe=/[^a-zA-Z0-9\\_:.-]/gim;function bWe(t,e){var n=0,r=0,i=[],s=!1,o=t.length;function a(f,g){if(f=Cm.trim(f),f=f.replace(wWe,"").toLowerCase(),!(f.length<1)){var v=e(f,g||"");v&&i.push(v)}}for(var l=0;l<o;l++){var c=t.charAt(l),u,h;if(s===!1&&c==="="){s=t.slice(n,l),n=l+1,r=t.charAt(n)==='"'||t.charAt(n)==="'"?n:SWe(t,l+1);continue}if(s!==!1&&l===r){if(h=t.indexOf(c,l+1),h===-1)break;u=Cm.trim(t.slice(r+1,h)),a(s,u),s=!1,l=h,n=l+1;continue}if(/\s|\n|\t/.test(c))if(t=t.replace(/\s|\n|\t/g," "),s===!1)if(h=EWe(t,l),h===-1){u=Cm.trim(t.slice(n,l)),a(u),s=!1,n=l+1;continue}else{l=h-1;continue}else if(h=TWe(t,l-1),h===-1){u=Cm.trim(t.slice(n,l)),u=Tte(u),a(s,u),s=!1,n=l+1;continue}else continue}return n<t.length&&(s===!1?a(t.slice(n)):a(s,Tte(Cm.trim(t.slice(n))))),Cm.trim(i.join(" "))}function EWe(t,e){for(;e<t.length;e++){var n=t[e];if(n!==" ")return n==="="?e:-1}}function SWe(t,e){for(;e<t.length;e++){var n=t[e];if(n!==" ")return n==="'"||n==='"'?e:-1}}function TWe(t,e){for(;e>0;e--){var n=t[e];if(n!==" ")return n==="="?e:-1}}function kWe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function Tte(t){return kWe(t)?t.substr(1,t.length-2):t}TO.parseTag=xWe;TO.parseAttr=bWe;var AWe=LB.FilterCSS,zu=ji,z0e=TO,IWe=z0e.parseTag,RWe=z0e.parseAttr,fM=DB;function $P(t){return t==null}function PWe(t){var e=fM.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=fM.trim(t.slice(e+1,-1));var n=t[t.length-1]==="/";return n&&(t=fM.trim(t.slice(0,-1))),{html:t,closing:n}}function CWe(t){var e={};for(var n in t)e[n]=t[n];return e}function MWe(t){var e={};for(var n in t)Array.isArray(t[n])?e[n.toLowerCase()]=t[n].map(function(r){return r.toLowerCase()}):e[n.toLowerCase()]=t[n];return e}function U0e(t){t=CWe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=zu.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=MWe(t.whiteList||t.allowList):t.whiteList=zu.whiteList,t.onTag=t.onTag||zu.onTag,t.onTagAttr=t.onTagAttr||zu.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||zu.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||zu.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||zu.safeAttrValue,t.escapeHtml=t.escapeHtml||zu.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new AWe(t.css))}U0e.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,n=e.options,r=n.whiteList,i=n.onTag,s=n.onIgnoreTag,o=n.onTagAttr,a=n.onIgnoreTagAttr,l=n.safeAttrValue,c=n.escapeHtml,u=e.cssFilter;n.stripBlankChar&&(t=zu.stripBlankChar(t)),n.allowCommentTag||(t=zu.stripCommentTag(t));var h=!1;n.stripIgnoreTagBody&&(h=zu.StripTagBody(n.stripIgnoreTagBody,s),s=h.onIgnoreTag);var f=IWe(t,function(g,v,x,b,T){var A={sourcePosition:g,position:v,isClosing:T,isWhite:Object.prototype.hasOwnProperty.call(r,x)},I=i(x,b,A);if(!$P(I))return I;if(A.isWhite){if(A.isClosing)return"</"+x+">";var R=PWe(b),M=r[x],F=RWe(R.html,function(C,N){var O=fM.indexOf(M,C)!==-1,j=o(x,C,N,O);return $P(j)?O?(N=l(x,C,N,u),N?C+'="'+N+'"':C):(j=a(x,C,N,O),$P(j)?void 0:j):j});return b="<"+x,F&&(b+=" "+F),R.closing&&(b+=" /"),b+=">",b}else return I=s(x,b,A),$P(I)?c(b):I},c);return h&&(f=h.remove(f)),f};var NWe=U0e;(function(t,e){var n=ji,r=TO,i=NWe;function s(a,l){var c=new i(l);return c.process(a)}e=t.exports=s,e.filterXSS=s,e.FilterXSS=i,(function(){for(var a in n)e[a]=n[a];for(var l in r)e[l]=r[l]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(E9,E9.exports);var m_=E9.exports,OWe=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},G0e=(function(){function t(e,n){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=N4(N4({},m_.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,l){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?r.sanitizeUrl(a):m_.safeAttrValue(s,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var i;e&&!n?i=e:e&&n?(i=Object.create(this.arcgisFilterOptions),i.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(s){if(s==="whiteList")i.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]);else if(s==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return i.css.whiteList[a]=o[a]})}else i[s]=e[s]})):(i=Object.create(this.arcgisFilterOptions),i.whiteList=this.arcgisWhiteList,i.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=i,this._xssFilter=new m_.FilterXSS(i)}return t.prototype.sanitize=function(e,n){switch(n===void 0&&(n={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,n);default:return n.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,n){var r=(n??{}).isProtocolRequired,i=r===void 0?!0:r,s=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||l?m_.escapeAttrValue(e):!s&&!i?m_.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,n,r,i){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,n,r,i):m_.safeAttrValue(e,n,r,i)},t.prototype.validate=function(e,n){n===void 0&&(n={});var r=this.sanitize(e,n);return{isValid:e===r,sanitized:r}},t.prototype.encodeHTML=function(e){var n=this;return String(e).replace(/[&<>"'\/]/g,function(r){return n._entityMap[r]})},t.prototype.encodeAttrValue=function(e){var n=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,i){return n.test(r)?r:"&#x".concat(Number(e.charCodeAt(i)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var n={};return e.forEach(function(r){Object.keys(r).forEach(function(i){Array.isArray(r[i])&&Array.isArray(n[i])?n[i]=n[i].concat(r[i]):n[i]=r[i]})}),n},t.prototype._iterateOverObject=function(e,n){var r=this;n===void 0&&(n={});try{var i=!1,s=void 0;if(Array.isArray(e))s=e.reduce(function(a,l){var c=r.validate(l,n);return c.isValid?a.concat([l]):(i=!0,a.concat([c.sanitized]))},[]);else if(OWe(e)){var o=Object.keys(e);s=o.reduce(function(a,l){var c=e[l],u=r.validate(c,n);return u.isValid?a[l]=c:(i=!0,a[l]=u.sanitized),a},{})}else return n.allowUndefined&&typeof e>"u"?void 0:null;return i?s:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const LWe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],DWe=LWe.reduce((t,e)=>(t[e]=[],t),{}),$We=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],B0e=new G0e({whiteList:DWe,onTagAttr:(t,e,n)=>{const r=`${e}="${n}"`;if($We.includes(e))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),ZPt=new G0e({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:t=>t},!1),W0e="http://www.w3.org/",kO=`${W0e}2000/svg`,H0e=`${W0e}1999/xlink`;let kte=[],$B=(t,e)=>{let n={};return Object.keys(t).forEach(r=>{n[r]=t[r]}),e&&Object.keys(e).forEach(r=>{n[r]=e[r]}),n},jB=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),q0e=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},jWe=(t,e,n)=>{if(e.vnodeSelector!==""){for(let r=n;r<t.length;r++)if(jB(t[r],e))return r}return-1},S$=(t,e,n,r)=>{let i=t[e];if(i.vnodeSelector==="")return;let s=i.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(jB(a,i))throw new Error(`${n.vnodeSelector} had a ${i.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},FWe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},T9=[],k9=!1,K0e=t=>{(t.children||[]).forEach(K0e),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},Ate=()=>{k9=!1,T9.forEach(K0e),T9.length=0},Ite=t=>{T9.push(t),k9||(k9=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(Ate,{timeout:16}):setTimeout(Ate,16))},Rte=t=>{let e=t.domNode;if(t.properties){let n=t.properties.exitAnimation;if(n)return e.style.pointerEvents="none",void n(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),Ite(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),Ite(t))},VWe=(t,e,n)=>{if(!e)return;let r=n.eventHandlerInterceptor,i=Object.keys(e),s=i.length;for(let o=0;o<s;o++){let a=i[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")I9(t,l,!0);else if(a==="classes"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h];l[f]&&t.classList.add(f)}}else if(a==="styles"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h],g=l[f];g&&(q0e(g),n.styleApplyer(t,f,g))}}else if(a!=="key"&&l!=null){let c=typeof l;c==="function"?(a.lastIndexOf("on",0)===0&&(r&&(l=r(a,l,t,e)),a==="oninput"&&(function(){let u=l;l=function(h){u.apply(this,[h]),h.target["oninput-value"]=h.target.value}})()),t[a]=l):n.namespace===kO?a==="href"?t.setAttributeNS(H0e,a,l):t.setAttribute(a,l):c==="string"&&a!=="value"?a==="innerHTML"?t[a]=B0e.sanitize(l):A9(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function A9(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let L4,zWe=(t,e,n)=>{if(e)for(let r of e)aT(r,t,void 0,n)},Y0e=(t,e,n)=>{zWe(t,e.children,n),e.text&&(t.textContent=e.text),VWe(t,e.properties,n),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,n,e.vnodeSelector,e.properties,e.children])},aT=(t,e,n,r)=>{let i,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")i=t.domNode=a.createTextNode(t.text),n!==void 0?e.insertBefore(i,n):e.appendChild(i);else{for(let l=0;l<=o.length;++l){let c=o.charAt(l);if(l===o.length||c==="."||c==="#"){let u=o.charAt(s-1),h=o.slice(s,l);u==="."?i.classList.add(h):u==="#"?i.id=h:(h==="svg"&&(r=$B(r,{namespace:kO})),r.namespace!==void 0?i=t.domNode=a.createElementNS(r.namespace,h):(i=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&i.setAttribute("type",t.properties.type)),n!==void 0?e.insertBefore(i,n):i.parentNode!==e&&e.appendChild(i)),s=l+1}}Y0e(i,t,r)}},I9=(t,e,n)=>{e&&e.split(" ").forEach(r=>{r&&t.classList.toggle(r,n)})},UWe=(t,e,n,r)=>{if(!n)return;let i=!1,s=Object.keys(n),o=s.length;for(let a=0;a<o;a++){let l=s[a],c=n[l],u=e[l];if(l==="class")u!==c&&(I9(t,u,!1),I9(t,c,!0));else if(l==="classes"){let h=t.classList,f=Object.keys(c),g=f.length;for(let v=0;v<g;v++){let x=f[v],b=!!c[x];b!==!!u[x]&&(i=!0,b?h.add(x):h.remove(x))}}else if(l==="styles"){let h=Object.keys(c),f=h.length;for(let g=0;g<f;g++){let v=h[g],x=c[v];x!==u[v]&&(i=!0,x?(q0e(x),r.styleApplyer(t,v,x)):r.styleApplyer(t,v,""))}}else if(c||typeof u!="string"||(c=""),l!=="value"||A9(t)){if(c!==u){let h=typeof c;h==="function"&&r.eventHandlerInterceptor||(r.namespace===kO?l==="href"?t.setAttributeNS(H0e,l,c):t.setAttribute(l,c):h==="string"?l==="innerHTML"?t[l]=B0e.sanitize(c):l==="role"&&c===""?t.removeAttribute(l):A9(t)&&l in t?t[l]=c:t.setAttribute(l,c):t[l]!==c&&(t[l]=c),i=!0)}}else{let h=t[l];h!==c&&(t["oninput-value"]?h===t["oninput-value"]:c!==u)&&(t[l]=c,t["oninput-value"]=void 0),c!==u&&(i=!0)}}return i},GWe=(t,e,n,r,i)=>{if(n===r)return!1;r=r||kte;let s,o=(n=n||kte).length,a=r.length,l=0,c=0,u=!1;for(;c<a;){let h=l<o?n[l]:void 0,f=r[c];if(h!==void 0&&jB(h,f))u=L4(h,f,i)||u,l++;else{let g=jWe(n,f,l+1);if(g>=0){for(s=l;s<g;s++)Rte(n[s]),S$(n,s,t,"removed");u=L4(n[g],f,i)||u,l=g+1}else aT(f,e,l<o?n[l].domNode:void 0,i),FWe(f),S$(r,c,t,"added")}c++}if(o>l)for(s=l;s<o;s++)Rte(n[s]),S$(n,s,t,"removed");return u};L4=(t,e,n)=>{let r=t.domNode,i=!1;if(t===e)return!1;let s=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=r.ownerDocument.createTextNode(e.text);return r.parentNode.replaceChild(o,r),e.domNode=o,i=!0,i}e.domNode=r}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(n=$B(n,{namespace:kO})),t.text!==e.text&&(s=!0,e.text===void 0?r.removeChild(r.firstChild):r.textContent=e.text),e.domNode=r,s=GWe(e,r,t.children,e.children,n)||s,s=UWe(r,t.properties,e.properties,n)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[r,n,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(r,e.properties,t.properties),i};let jP=(t,e)=>({getLastRender:()=>t,update:n=>{if(t.vnodeSelector!==n.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=t;t=n,L4(r,n,e)},domNode:t.domNode});const BWe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,n)=>{e.charAt(0)==="-"?t.style.setProperty(e,n):t.style[e]=n}};let nS=t=>$B(BWe,t),Jm={append:(t,e,n)=>(n=nS(n),aT(e,t,void 0,n),jP(e,n)),insertBefore:(t,e,n)=>(n=nS(n),aT(e,t.parentNode,t,n),jP(e,n)),merge:(t,e,n)=>(n=nS(n),e.domNode=t,Y0e(t,e,n),jP(e,n)),replace:(t,e,n)=>(n=nS(n),aT(e,t.parentNode,t,n),t.parentNode.removeChild(t),jP(e,n))},X0e,WWe=(t,e)=>{let n=[];for(;t&&t!==e;)n.push(t),t=t.parentNode;return n};X0e=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let HWe=(t,e)=>{let n=t;return e.forEach(r=>{n=n&&n.children?X0e(n.children,i=>i.domNode===r):void 0}),n},qWe=(t,e,n)=>{let r=function(i){n("domEvent",i);let s=e(),o=WWe(i.currentTarget,s.domNode);o.reverse();let a,l=HWe(s.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${i.type}`].apply(l.properties.bind||this,arguments)),n("domEventProcessed",i),a};return(i,s,o,a)=>r},Pte=t=>{let e,n,r=nS(t),i=r.performanceLogger,s=!0,o=!1,a=[],l=[],c=(h,f,g)=>{let v,x=()=>v;r.eventHandlerInterceptor=qWe(e,x,i),v=h(f,g(),r),a.push(v),l.push(g)},u=()=>{if(n=void 0,s){s=!1,i("renderStart",void 0);for(let h=0;h<a.length;h++){let f=l[h]();i("rendered",void 0),a[h].update(f),i("patched",void 0)}i("renderDone",void 0),s=!0}};return e={renderNow:u,scheduleRender:()=>{n||o||(n=requestAnimationFrame(u))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),o=!0},resume:()=>{o=!1,s=!0,e.scheduleRender()},append:(h,f)=>{c(Jm.append,h,f)},insertBefore:(h,f)=>{c(Jm.insertBefore,h,f)},merge:(h,f)=>{c(Jm.merge,h,f)},replace:(h,f)=>{c(Jm.replace,h,f)},detach:h=>{for(let f=0;f<l.length;f++)if(l[f]===h)return l.splice(f,1),a.splice(f,1)[0];throw new Error("renderFunction was not found")}},e},gm=class extends Kt{constructor(){super(...arguments),this.items=new Ot,this._watchUpdatingTracking=new Jy,this._callbacks=new Map,this._projector=Pte(),this._hiddenProjector=Pte()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,n=>{for(const r of n.added){const i=()=>r.render();this._callbacks.set(r,i),this._projector.append(this.surface,i)}for(const r of n.removed){const i=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(i.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const n=this._hiddenSurface,r=this._hiddenProjector;let i;const s=()=>(i=e.render(),i);r.append(n,s),r.renderNow();const o={left:0,top:0,right:0,bottom:0};if(i?.domNode){const a=i.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(r.detach(s);n.firstChild;)n.removeChild(n.firstChild);return o}overlaps(e,n){const r=this.computeBoundingRect(e),i=this.computeBoundingRect(n);return Math.max(r.left,i.left)<=Math.min(r.right,i.right)&&Math.max(r.top,i.top)<=Math.min(r.bottom,i.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,n){const r=!!n?.disableDecorations;if(!this.items.some(s=>s.visible&&!(r&&s.isDecoration)))return;const i=e.getContext("2d");i.save(),i.font=this._fontString(),this.items.forEach(s=>{r&&s.isDecoration||(i.save(),s.renderCanvas(i),i.restore())}),i.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};_([E({readOnly:!0})],gm.prototype,"surface",void 0),_([E({readOnly:!0})],gm.prototype,"items",void 0),_([E({readOnly:!0})],gm.prototype,"needsRender",null),_([E({readOnly:!0})],gm.prototype,"_watchUpdatingTracking",void 0),_([E({readOnly:!0})],gm.prototype,"updating",null),gm=_([ue("esri.views.overlay.ViewOverlay")],gm);const Cte=gm,T$=[0,0];function KWe(t){const e=(t.ownerDocument||window.document).defaultView,n=t.getBoundingClientRect();return T$[0]=n.left+(e?.pageXOffset??0),T$[1]=n.top+(e?.pageYOffset??0),T$}function Mte(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function YWe(t){const e=document.createElement("div");return t.appendChild(e),e}const g_=16,SE=750,XWe=512,ZWe=2,JWe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._freqInfo={freq:g_,time:SE},this._overlayRenderTaskHandle=null,this.aria={},this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([dn(()=>this.cursor,i=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",i)}),dn(()=>this.navigating,i=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",i.toString())}),dn(()=>[this.aria,this.surface],()=>this._updateAria(),{initial:!0})])}initialize(){const r=this;this.addHandles([dn(()=>this.ui,(i,s)=>this._handleUIChange(i,s),fa),r.on("focus",()=>this.notifyChange("focused")),r.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(r){const i=this._get("container"),s=OB(r);if(s||typeof r!="string"||Tt.getLogger(this).error("#container",`element with id '${r}' not found`),i===s)return;if(this._stopMeasuring(),i&&(i.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Mte(this.root),this._set("root",null)),this.userContent&&(wte(this.userContent,i),Mte(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",wte(s,o),s.appendChild(o),this._set("userContent",o);const a=document.createElement("div");a.className="esri-view-root",s.insertBefore(a,s.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const c=new Cte;a.appendChild(c.surface),this._set("overlay",c),this.addHandles(dn(()=>c.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=s2({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=Qr(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const r=document.activeElement===this.surface;return document.hasFocus()&&r}get size(){return[this.width,this.height]}set ui(r){const i=this._get("ui");i!==r&&i?.destroy(),this._set("ui",r)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(r,i,s){const o=this.position;return r-=o?o[0]:0,i-=o?o[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}containerToPage(r,i,s){const o=this.position;return r+=o?o[0]:0,i+=o?o[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}_updateAria(){const{surface:r,aria:i}=this;r&&(r.ariaLabelledByElements=i?.labelledByElements??null,r.ariaDescribedByElements=i?.describedByElements??null,r.ariaLabel=i?.label??null,r.ariaDescription=i?.description??null)}_handleUIChange(r,i){this.removeHandles("ui"),i&&i!==r&&i.destroy(),r&&(r.view=this,this.addHandles(dn(()=>this.root,s=>{r.container=s?YWe(s):null},fa),"ui")),this._set("ui",r)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const r=this._freqInfo;r.freq=g_,r.time=SE;const i=s2({prepare:a=>{const l=this._measure(),c=this._freqInfo;if(c.time+=a.deltaTime,l&&(c.freq=g_,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const u=this._position();c.freq=u||l?g_:Math.min(SE,c.freq*ZWe),!l&&c.freq>=XWe&&(i.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver(a=>{r.freq=g_,r.time=SE,i.resume()});this.container!=null&&s.observe(this.container);const o=qn(()=>s.disconnect());this.addHandles([B2(window,"resize",()=>{r.freq=g_,r.time=SE,i.resume()}),o,i],"measuring"),this._measure(),this._position()}_measure(){const r=this.container,i=r?r.clientWidth:0,s=r?r.clientHeight:0;if(i===0||s===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,a=this.height;return i===o&&s===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",i),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:a,width:i,height:s}),!0)}_position(){const r=this.container,i=this.position,s=r&&KWe(r);return!!s&&(!i||s[0]!==i[0]||s[1]!==i[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return _([E()],n.prototype,"aria",void 0),_([E()],n.prototype,"container",null),_([E({readOnly:!0})],n.prototype,"focused",null),_([E({readOnly:!0})],n.prototype,"height",void 0),_([E()],n.prototype,"messagesCommon",void 0),_([E({type:Cte})],n.prototype,"overlay",void 0),_([E({readOnly:!0})],n.prototype,"position",void 0),_([E({readOnly:!0})],n.prototype,"resizing",void 0),_([E({readOnly:!0})],n.prototype,"root",void 0),_([E({value:null,readOnly:!0})],n.prototype,"size",null),_([E({readOnly:!0})],n.prototype,"surface",void 0),_([E({readOnly:!0})],n.prototype,"suspended",void 0),_([E({nonNullable:!0})],n.prototype,"ui",null),_([E({readOnly:!0})],n.prototype,"userContent",void 0),_([E({readOnly:!0})],n.prototype,"width",void 0),_([E()],n.prototype,"widthBreakpoint",void 0),n=_([ue("esri.views.DOMContainer")],n),n},FP="popup",Nte="manual";function gd(t){return t!=null&&"open"in t&&"declaredClass"in t}function lp(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function QWe(t,e,n){const[r,i,s]=e;if(n){const[o,a,l]=n;o&&gd(a)&&(a.view=null,o.remove(a,FP),a!==i&&i&&a.destroy()),o&&l&&lp(l)&&(l.view=null,o.remove(l,FP),l!==s&&s&&l.remove())}r&&gd(i)&&(i.view=t,r.add(i,{key:FP,position:Nte,internal:!0})),r&&s&&lp(s)&&(s.view=t,r.add(s,{key:FP,position:Nte,internal:!0}))}async function eHe(t,e){const{popup:n,popupElement:r}=t;gd(n)?await VP(n,null,e):r&&lp(r)?await VP(null,r,e):e?.defer(async()=>{await t.setupPopup();const{popup:i,popupElement:s}=t;gd(i)&&!t.destroyed&&t.ready&&t.popupEnabled?await VP(i,null,e):s&&lp(s)&&await VP(null,s,e)})}function tHe(t,e){const{popup:n,popupElement:r}=t;if(gd(n))return n.open(e);r&&lp(r)&&r.open(e)}function nHe(t,e){gd(t)&&t.close(),e&&lp(e)&&(e.visible=!1)}async function VP(t,e,n){if(gd(t)){const r=await t.viewModel.handleViewClick(n);return void(r?.promises?.length?t.open(r):t.visible&&t.close())}if(e&&lp(e)){const r=await e.handleViewClick(n);r?.promises?.length?e.open(r):e.visible&&(e.visible=!1)}}const Z0e=ye("mac")?"Meta":"Control",rHe=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),iHe=t=>rHe.has(t);let sHe=class{constructor(e,n=[]){this.eventType=e,this.keyModifiers=n}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const n=e.modifiers;for(const r of this.keyModifiers)if(!n.has(r))return!1;return!0}},Ws=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const n=this._incoming[e];for(const r of n)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(n=>this._handleEvent(n)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,n,r){let i;typeof n=="function"?(r=n,i=[]):i=n||[];const s=typeof e=="string"?new sHe(e,i):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=u=>{const h=this._incoming[u.match.eventType];if(h){const f=h.indexOf(u);h.splice(f,1),o(),this._manager&&this._manager.updateDependencies()}},l=new oHe(s,r,{onPause:a,onRemove:a,onResume:u=>{const h=this._incoming[u.match.eventType];h&&!h.includes(u)&&(h.push(u),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const n=new aHe(e,{onEmit:(r,i,s,o)=>{this._manager?.emit(r.eventType,i,s,o)},onRemove:r=>{delete this._outgoing[r.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=n,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),n}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const n=this._incoming[e.type];if(n){for(const r of n)if(r.match.matches(e)&&(r.callback?.(e),e.shouldStopPropagation()))break}}},oHe=class{constructor(e,n,r){this.match=e,this._callback=n,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},aHe=class{constructor(e,n){this.eventType=e,this._removed=!1,this._handler=n}emit(e,n,r){this._removed||this._handler.onEmit(this,e,n,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},lHe=class extends Ws{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this._id=null,this.registerIncoming("pointer-move",n=>this._update(n.data))}_update(e){const n=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:i,native:{pointerId:s}}=e;n===this._value&&this._x===r&&this._y===i&&this._id===s||(this._value=n,this._x=r,this._y=i,this._id=s,this._onChange(s,n,r,i))}},cHe=class{constructor(e,n){this._observable=new rI,this._value=e,this._equalityFunction=n}get value(){return tn(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function v2(t,e=ude){return new cHe(t,e)}let uHe=class extends Ws{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=v2(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},hHe=class{constructor(e,n){this._owner=n,this._properties={},this._afterDispatchHandle=null;for(const r in e){const i=e[r],s=new lfe(i,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=I$e(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const n=this._properties[e];for(const r of n.acquired)EQ(r)||n.pool.release(r);n.pool.destroy(),n.pool=null,n.acquired=null}this._properties=null,this._owner=null}get(e){const n=this._owner._get(e),r=this._properties[e];let i=r.pool.acquire();for(r.acquired.push(i);i===n;)i=r.pool.acquire(),r.acquired.push(i);return _fe(),i}_release(){for(const e in this._properties){const n=this._properties[e];let r=0;for(const i of n.acquired)EQ(i)?n.acquired[r++]=i:n.pool.release(i);n.acquired.length=r}}},dHe=class{constructor(){this.id=0,this.type="mouse",this.location=Fs()}},Lu=class extends Kt{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=Z0e,this._propertiesPool=new hHe({latestPointerInfo:()=>new dHe},this),this._latestPointerInfo=void 0,this._paused=!1,this._testTimestamp=void 0}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const n of e)this.uninstallHandlers(n);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get latestPointerInfo(){return this._latestPointerInfo}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,n,r=Xf.INTERNAL){if(this._nameToGroup[e]||n.length===0)return;const i={name:e,handlers:n.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=i;for(let s=i.handlers.length-1;s>=0;s--){const o=i.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,c,u,h)=>{this._emitInputEvent(o.priorityIndex+1,a,l,c,h,u)},setPointerCapture:(a,l)=>{this._setPointerCapture(i,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const n=this._nameToGroup[e];n?(n.handlers.forEach(r=>{r.removed=!0,r.uninstallCallback?.()}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):Tt.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,n=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const i=this._handlers[r];i.priorityIndex=r,this._handlersPriority.push(i)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let s=i.handler.hasSideEffects;if(!s){for(const o of i.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}}if(s)for(const o of i.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)iHe(a)||n.add(a)}i.active=s}this._sourceEvents=e,this._keyModifiers=n,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,n,r,i){const s=this._latestPointerInfo;if(s==null||s.id!==e||s.type!==n||s.location.x!==r||s.location.y!==i){const o=this._propertiesPool.get("latestPointerInfo");o.id=e,o.type=n,o.location.x=r,o.location.y=i,this._latestPointerInfo=o}}_onEventReceived(e,n){if(e==="pointer-capture-lost"){const s=n;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,n);const r=this._testTimestamp??n.native?.timestamp,i=n.native?.cancelable;this._emitInputEventFromSource(e,n,r,i)}_updateKeyModifiers(e,n){if(!n)return;let r=!1;const i=()=>{r||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),r=!0)},s=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(i(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(i(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=n.key;this._keyModifiers.has(a)&&s(a,e==="key-down")}const o=n.native;s("Alt",!!o?.altKey),s("Control",!!o?.ctrlKey),s("Ctrl",!!o?.ctrlKey),s("Shift",!!o?.shiftKey),s("Meta",!!o?.metaKey),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new lHe((e,n,r,i)=>this._setLatestPointer(e,n,r,i)),this._multiTouchHandler=new uHe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Xf.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Xf.INTERNAL)}_setPointerCapture(e,n,r,i){const s=e.name+"-"+n.priorityIndex,o=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,o),i?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,n,r,i){this._emitInputEvent(0,e,n,r,i)}_emitInputEvent(e,n,r,i,s,o){const a=i??this._currentPropagation?.timestamp??performance.now(),l=s??!1,c={event:new fHe(n,r,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new Ok,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:n,priorityIndex:r}=e.events.pop(),i=n.data?.eventId;if(!(i!=null&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&e.currentHandler.eventCallback?.(n),n.shouldStopPropagation()){i!=null&&this._stoppedPropagationEventIds.add(i);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const n=new Ok;n.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)n.push(r.events.pop());r.events=n,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,n){if(e.handler.hasSideEffects!==n.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==n.groupPriority)return e.groupPriority>n.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const i of n.handler.incomingEventMatches){if(r.eventType!==i.eventType)continue;const s=r.keyModifiers.filter(o=>i.keyModifiers.includes(o));if(s.length===r.keyModifiers.length!=(s.length===i.keyModifiers.length))return r.keyModifiers.length>i.keyModifiers.length?-1:1}return e.priorityIndex>n.priorityIndex?-1:1}_sortHandlersPriority(e){const n=[];for(const r of e){let i=0;for(;i<n.length&&this._compareHandlerPriority(r,n[i])>=0;)i++;n.splice(i,0,r)}return n}get test(){}};_([E({readOnly:!0})],Lu.prototype,"hasPendingInputs",null),_([E({constructOnly:!0})],Lu.prototype,"eventSource",void 0),_([E({constructOnly:!0})],Lu.prototype,"recognizers",void 0),_([E()],Lu.prototype,"multiTouchActive",null),_([E()],Lu.prototype,"_latestPointerInfo",void 0),_([E()],Lu.prototype,"latestPointerInfo",null),_([E()],Lu.prototype,"_paused",void 0),_([E({readOnly:!0})],Lu.prototype,"updating",null),Lu=_([ue("esri.views.input.InputManager")],Lu);let fHe=class{constructor(e,n,r,i,s){this.type=e,this.data=n,this.timestamp=r,this.modifiers=i,this.cancelable=s,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return!!(1&this._propagationState)}defer(e){this._propagationState|=2;const n=(r,i)=>{this._propagationState&=-3;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),i)throw r;return r};return(typeof e=="function"?e():e).then(r=>n(r,!1),r=>n(r,!0))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};const Xf={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},pHe=t=>{const e=t;let n=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([dn(()=>[this.ui,this.popup,this.popupElement],([r,i,s],o)=>{const[a,l,c]=o??[];QWe(this,[r,i,s],[a,l,c])},ea),this.on("click",r=>{this.popup&&this.popupEnabled&&(r.pointerType!=="mouse"||r.button===0)&&eHe(this,r)},Xf.WIDGET)]),hB(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>_e(()=>import("./Popup-DvUaP8S5.js").then(r=>r.P),__vite__mapDeps([253,254,86,255,256,257,258,231,12,13,14,15,8,16,17,18,19,21,22,20,23,132,173,259,110,31,32,33,34,35,36,230,11,176,39,40,170,127,128,109,29,30,53,46,47,48,49,50,51,52,43,260,4,261,262,2,6,263,3,264,265,54,55,56,57,58,266,267,194,268,269,270,271,272,5,7,273,274,275,276,277,60,278,279,229,280,281,59,61,62,63,64,282,283,284,285,286,65,99,67,175,287,288,289,290])))}destroy(){this.destroyed||this.closePopup()}async openPopup(r){if(gd(this.popup))return this.popup.open(r);if(this.popupElement&&lp(this.popupElement))this.popupElement.open(r).catch(()=>{});else try{if(await this.setupPopup(),!this.popup)return void Tt.getLogger(this).error(new Xe("view:null-popup","Popup is null and can't be opened"));tHe(this,r)}catch{}}closePopup(){this._popupSetupTask?.abort(),nHe(this.popup,this.popupElement)}async fetchPopupFeatures(r,i){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(r,i),i)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!gd(this.popup))return this._popupSetupTask=sO(async r=>{if(!this.popupEnabled||!lp(this.popupElement))if(this.dependencies.popup&&typeof this.dependencies.popup=="function")await this.dependencies.popup(),hi(r),customElements.get("arcgis-popup")||Tt.getLogger(this).error(new Xe("view:undefined-popup-element","`arcgis-popup` custom element is undefined and can't be opened")),this.popupElement=document.createElement("arcgis-popup");else{const{default:i}=await _e(()=>import("./Popup-DvUaP8S5.js").then(o=>o.P),__vite__mapDeps([253,254,86,255,256,257,258,231,12,13,14,15,8,16,17,18,19,21,22,20,23,132,173,259,110,31,32,33,34,35,36,230,11,176,39,40,170,127,128,109,29,30,53,46,47,48,49,50,51,52,43,260,4,261,262,2,6,263,3,264,265,54,55,56,57,58,266,267,194,268,269,270,271,272,5,7,273,274,275,276,277,60,278,279,229,280,281,59,61,62,63,64,282,283,284,285,286,65,99,67,175,287,288,289,290]));if(hi(r),!this.popup||gd(this.popup))return;const s=this.popup;if("open"in s||"close"in s){const{open:o,close:a,...l}=s;this.popup=new i({...l})}else this.popup=new i(s)}}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:r,hits:i},s){const o=[],a=[];let l=!1;const c=n6e(s,ye("popup-view-fetch-timeout")??gHe),u=g=>{const v=new mHe(g);return a.push(v),o.push(v.promise),v},h=g=>{const v=a.at(-1);return v&&v.layerView===g&&!l?v:u(g)};for(const g of i)"graphic"in g?(h(g.layerView).graphics.push(g.graphic),l=!1):(o.push(g.layerView.fetchPopupFeaturesAtLocation(g.mapPoint,c)),l=!0);a.forEach(g=>g.resolve(c));const f=t6e(o).then(g=>g.filter(v=>!!v).flat());return{pendingFeatures:o,allGraphicsPromise:f,location:r}}async _getPopupHits(r,i){const{hits:s,location:o}=await this.popupHitTest(r);hi(i);const a=[];for(const l of s)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,i)){const c=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:o}}_isValidPopupGraphic(r,i){return r&&!!r.getEffectivePopupTemplate(i?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(r){return!r||(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesFromGraphics"in r}_isValidPopupLocationLayerView(r){return(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesAtLocation"in r}};return _([E()],n.prototype,"popup",void 0),_([E()],n.prototype,"popupElement",void 0),_([E()],n.prototype,"popupEnabled",void 0),n=_([ue("esri.views.PopupView")],n),n};let mHe=class{constructor(e){this.layerView=e,this._resolver=uc(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:n,graphics:r,_resolver:i}=this;if(!n)return i.resolve(r),i.promise;let s;return n.fetchPopupFeaturesFromGraphics(r,e).catch(o=>(s=o,null)).then(o=>{o?i.resolve(o):i.reject(s)}),i.promise}};const gHe=5e3;var rS;const D4=kl()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),J0e=D4.jsonValues.slice();iF(J0e,"orthometric");const lT=kl()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let el=rS=class extends qt{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,n){return D4.write(t,e,n)}readHeightModel(t,e,n){return D4.read(t)||(n?.messages&&n.messages.push(yHe(t,{context:n})),null)}readHeightUnit(t,e,n){return lT.read(t)||(n?.messages&&n.messages.push(Ote(t,{context:n})),null)}readHeightUnitService(t,e,n){return KG(t)||lT.read(t)||(n?.messages&&n.messages.push(Ote(t,{context:n})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new rS({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const n=ope(e);return new rS({heightModel:t.heightModel,heightUnit:n??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new rS;return e.read(t,{origin:"web-scene"}),e}};function Ote(t,e){return new kd("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function yHe(t,e){return new kd("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}_([E({type:D4.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:J0e,default:"ellipsoidal",write:{isRequired:!0}}}}})],el.prototype,"heightModel",void 0),_([Xn("web-scene","heightModel")],el.prototype,"writeHeightModel",null),_([or(["web-scene","service"],"heightModel")],el.prototype,"readHeightModel",null),_([E({type:lT.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:lT.jsonValues,write:{writer:lT.write,isRequired:!0}}}}})],el.prototype,"heightUnit",void 0),_([or("web-scene","heightUnit")],el.prototype,"readHeightUnit",null),_([or("service","heightUnit")],el.prototype,"readHeightUnitService",null),_([E({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],el.prototype,"vertCRS",void 0),_([or("service","vertCRS",["vertCRS","ellipsoid","geoid"])],el.prototype,"readVertCRS",null),el=rS=_([ue("esri.geometry.HeightModelInfo")],el);let k$;async function vHe(){return k$==null&&(k$=_e(()=>import("./WhereClauseCache-BlP3sz7h.js"),__vite__mapDeps([125,35,36,126,127,128,40])).then(t=>new t.WhereClauseCache(500,500))),k$}async function _He(t,e){const n=await vHe(),r=n.get(t,e);if(r==null)throw n.getError(t,e);return r}function hCt(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function dCt(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function fCt(t,e){return e.length===0?null:`${t} IN (${xHe(e)})`}function xHe(t){return t.map(e=>typeof e=="string"?wHe(e):e).join(",")}function wHe(t){return`'${t.replaceAll("'","''")}'`}function pCt(t){return typeof t=="number"}function mCt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function gCt(t){return typeof t=="boolean"}function mI(t){return typeof t=="string"||t instanceof String}function bHe(t){return t==null||mI(t)}function yCt(t){return Array.isArray(t)}function vCt(t){return t?.declaredClass==="esri.Graphic"}function _Ct(t){return t instanceof Date}const EHe="HH:mm",SHe="HH:mm:ss",THe="HH:mm:ss.SSS",kHe=[THe,SHe,EHe,"TT"],AHe="yyyy-MM-dd";function Lte(t){if(!t||!mI(t))return null;const e=hn.fromFormat(t,AHe);return e.isValid?e:null}function Dte(t){return t&&mI(t)?QDe(kHe,e=>{const n=hn.fromFormat(t,e);return n.isValid?n:null})??null:null}function $te(t){if(!t||!mI(t))return null;const e=hn.fromISO(t);return e.isValid?e:null}const Q0e=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function IHe(t){return t!=null&&Q0e.has(t.type)}function eye(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function tye(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function nye(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const RHe=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);CG(Q0e,RHe);function xCt(t,e){const n=t?.domain;if(!n||n.type!=="range")return;const r="range"in n?n.range[0]:n.minValue,i="range"in n?n.range[1]:n.maxValue,s=IHe(t);return eye(t)||nye(t)||tye(t)?{...PHe(t,i,r),isInteger:s}:{min:r!=null&&typeof r=="number"?r:null,max:i!=null&&typeof i=="number"?i:null,rawMin:r,rawMax:i,isInteger:s}}function PHe(t,e,n){return eye(t)?{min:Lte(n)?.toMillis(),max:Lte(e)?.toMillis(),rawMin:n,rawMax:e}:nye(t)?{min:Dte(n)?.toMillis(),max:Dte(e)?.toMillis(),rawMin:n,rawMax:e}:tye(t)?{min:$te(n)?.toMillis(),max:$te(e)?.toMillis(),rawMin:n,rawMax:e}:{max:null,min:null}}function CHe(t){if(!t)return;const e=t.match(MHe);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const MHe=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function wCt(t){return t.match(NHe)?.[1]?.replaceAll("\\'","'")??null}const NHe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let A$;function OHe(){return A$||(A$=(async()=>{const[t,e,n]=await Promise.all([_e(()=>import("./arcadeUtils-DB3UA28m.js"),__vite__mapDeps([291,292,293,128,294,127,40,295,260,133,296,118,50,49,51,39,297,298,126,175,299,4,261,42])),_e(()=>import("./batchExec-K1JZqLHo.js"),__vite__mapDeps([300,186])),_e(()=>import("./aiServices-pXEvxrTW.js").then(r=>r.a),__vite__mapDeps([297,40,294,127,128,295,260,133,298,293]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:n,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),A$}const LHe=/^([0-9_])/,DHe=/[^a-z0-9_\u0080-\uffff]+/gi;function bCt(t){return t==null?null:t.trim().replaceAll(DHe,"_").replace(LHe,"F$1")||null}const $He=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],jHe=["field","normalizationField"];function ECt(t,e){if(t!=null&&e!=null){for(const n of Array.isArray(t)?t:[t])if(jte($He,n,e),"visualVariables"in n&&n.visualVariables)for(const r of n.visualVariables)jte(jHe,r,e)}}function jte(t,e,n){if(t)for(const r of t){const i=K5(r,e),s=i&&typeof i!="function"&&n.get(i);s&&z2(r,s.name,e)}}function SCt(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const n=e.get(t.startField),r=e.get(t.endField);t.startField=n?.name??null,t.endField=r?.name??null}else{const n=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=n?.name??null,t.endTimeField=r?.name??null}}const I$=new Set;function FB(t,e){return t&&e?(I$.clear(),Dk(I$,t,e),Array.from(I$).sort()):[]}function Dk(t,e,n){if(n)if(e?.fields?.length)if(n.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of n)$k(t,e,r);else{if(n.includes("*"))return t.clear(),void t.add("*");for(const r of n)r!=null&&t.add(r)}}function $k(t,e,n){if(typeof n=="string")if(e){const r=e.get(n);r&&t.add(r.name)}else t.add(n)}function TCt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(n=>n.name):e}function kCt(t,e,n=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const r=FB(t,e);return r.length/t.fields.length>=n?["*"]:r}async function F1(t,e,n,r){if(!r)return;const i=CHe(r);if(i)$k(t,e,i);else{const{arcadeUtils:s}=await OHe(),o=s.extractFieldNames(r,n?.partitions??e?.fields?.map(a=>a.name));for(const a of o)$k(t,n?.index??e,a)}}async function VB(t,e,n){if(n&&n!=="1=1"){const r=await _He(n,e);if(!r.isStandardized)throw new Xe("fieldUtils:collectFilterFields","Where clause is not standardized",{where:n});Dk(t,e,r.fieldNames)}}function ACt({displayField:t,fields:e}){return t||(e?.length?FHe(e):null)}function FHe(t){return R$(t,"name-or-title")||R$(t,"unique-identifier")||R$(t,"type-or-category")||VHe(t)}function VHe(t){for(const e of t){if(!e?.name)continue;const n=e.name.toLowerCase();if(n.includes("name")||n.includes("title"))return e.name}return null}function R$(t,e){for(const n of t)if(n?.valueType&&n.valueType===e)return n.name;return null}async function ICt(t,e){if(!e)return;const n=e.elevationInfo?.featureExpressionInfo;return n?n.collectRequiredFields(t,e.fieldsIndex):void 0}function zHe(t,e,n){n.onStatisticExpression?F1(t,e,null,n.onStatisticExpression.expression):t.add(n.onStatisticField)}async function RCt(t,e,n){if(!e||!n||!("fields"in n))return;const r=[],i=n.popupTemplate;r.push(rye(t,e,i)),n.fields&&r.push(...n.fields.map(async s=>zHe(t,e.fieldsIndex,s))),await Promise.all(r)}async function PCt(t,e){const{fieldsIndex:n,trackInfo:r}=e;if(!e||!r||!n)return;const i=[r.latestObservations.renderer?.collectRequiredFields(t,n),r.previousObservations.renderer?.collectRequiredFields(t,n),r.trackLines.renderer?.collectRequiredFields(t,n)];r.popupTemplate&&i.push(rye(t,e,r.popupTemplate));for(const s of[r.latestObservations.labelingInfo,r.previousObservations.labelingInfo,r.trackLines.labelingInfo])if(s)for(const o of s)i.push(oye(t,n,o));await Promise.all(i)}async function rye(t,e,n){const r=[];n?.expressionInfos&&r.push(...n.expressionInfos.map(s=>F1(t,e.fieldsIndex,null,s.expression)));const i=n?.content;if(Array.isArray(i))for(const s of i)s.type==="expression"&&s.expressionInfo&&r.push(F1(t,e.fieldsIndex,null,s.expressionInfo.expression));await Promise.all(r)}async function CCt(t,e,n){e&&(e.timeInfo&&n?.timeExtent&&Dk(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&Dk(t,e.fieldsIndex,[e.floorInfo.floorField]),n?.where!=null&&await VB(t,e.fieldsIndex,n.where))}async function MCt(t,e,n){e&&n&&await Promise.all(n.map(r=>UHe(t,e,r)))}async function UHe(t,e,n){e&&n&&(n.valueExpression?await F1(t,e.fieldsIndex,null,n.valueExpression):n.field&&$k(t,e.fieldsIndex,n.field))}function NCt(t){return t?FB(t.fieldsIndex,iye(t)):[]}function GHe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?FB(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function OCt(t,e,n){if(!e||!n)return;const r=e.fieldsIndex;await Promise.all(n.filters.map(i=>VB(t,r,i.where)))}const BHe=new Set(["oid","global-id","guid"]),WHe=new Set(["oid","global-id"]),HHe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function qHe(t){const e=new Set;sye(t).forEach(r=>e.add(r)),GHe(t).forEach(r=>e.add(r.toLowerCase()));const n=t&&"infoFor3D"in t?t.infoFor3D:void 0;return n&&(Object.values(n.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(n.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function iye(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:n,creatorField:r,editDateField:i,editorField:s}=e;return[n,r,i,s].filter(Boolean)}function sye(t){return iye(t).map(e=>e.toLowerCase())}function LCt(t,e){return t.editable&&!BHe.has(t.type)&&!sye(e).includes(t.name?.toLowerCase()??"")}function DCt(t,e){const n=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&n===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&n===e.globalIdField.toLowerCase()||qHe(e).includes(n)||WHe.has(t.type)||HHe.some(r=>r.test(n)))}async function $Ct(t,e){const{labelingInfo:n,fieldsIndex:r}=e;n?.length&&await Promise.all(n.map(i=>oye(t,r,i)))}async function oye(t,e,n){if(!n)return;const r=n.getLabelExpression(),i=n.where;if(r.type==="arcade")await F1(t,e,null,r.expression);else{const s=r.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{$k(t,e,o.slice(1,-1))})}await VB(t,e,i)}function jCt(t){const e=t.defaultValue;return e!==void 0&&lye(t,e)?e:t.nullable?null:void 0}function FCt(t){const e=typeof t=="string"?{type:t}:t;return rqe(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function aye(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function KHe(t){return t===null||aye(t)}function YHe(t){return t===null||Number.isInteger(t)}function XHe(){return!0}function lye(t,e){let n;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":n=t.nullable?YHe:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":n=t.nullable?KHe:aye;break;case"string":case"esriFieldTypeString":n=t.nullable?bHe:mI;break;default:n=XHe}return arguments.length===1?n:n(e)}const ZHe=["integer","small-integer","big-integer","long"],JHe=["single","double"],QHe=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],eqe=["esriFieldTypeSingle","esriFieldTypeDouble"],cye=new Set([...ZHe,...QHe]),tqe=new Set([...JHe,...eqe]),nqe=CG(cye,tqe);function VCt(t){return t!=null&&cye.has(t.type)}function uye(t){return t!=null&&nqe.has(t.type)}function rqe(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function iqe(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function sqe(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function oqe(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function aqe(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function zCt(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function UCt(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function GCt(t,e){return lqe(t,e)===null}function BCt(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function lqe(t,e){return t==null||t.nullable&&e===null?null:lye(t,e)?uye(t)&&!cqe(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function cqe(t,e){const n=typeof t=="string"?hye(t):t;if(!n)return!1;const r=n.min,i=n.max;return n.isInteger?Number.isInteger(e)&&e>=r&&e<=i:e>=r&&e<=i}function hye(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return uqe;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return hqe;case"esriFieldTypeBigInteger":case"big-integer":return dqe;case"esriFieldTypeSingle":case"single":return fqe;case"esriFieldTypeDouble":case"double":return pqe}}const uqe={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},hqe={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},dqe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},zP=(2-2**-23)*2**127,fqe={min:-zP,max:zP,isInteger:!1,rawMin:-zP,rawMax:zP},pqe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function WCt(t,e,n){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${n} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${n} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${n} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:r,max:i}=hye(e.type);return`Value ${n} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${i}`}}}function HCt(t,e){return!mqe(t,e,null)}function mqe(t,e,n){if(!t?.attributes||!e)return!0;const r=new Set(Object.keys(t.attributes));let i=!1;for(const s of e)if(!r.has(s)&&(i=!0,n==null))break;return i}function qCt(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function gqe(t){const e=t?.match(/{[^}]+}/g);return e?e.map(n=>n.slice(1,-1).split(":")[0].trim()):[]}let pM=class extends qt{constructor(e){super(e),this.type=null}};_([E({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],pM.prototype,"type",void 0),pM=_([ue("esri.popup.content.Content")],pM);const xp=pM,UP=new Gs({asc:"ascending",desc:"descending"});let iS=class extends fo(qt){constructor(e){super(e),this.field=null,this.order="ascending"}};_([E({type:String,json:{write:!0}})],iS.prototype,"field",void 0),_([E({type:UP.apiValues,json:{type:UP.jsonValues,read:UP.read,write:UP.write}})],iS.prototype,"order",void 0),iS=_([ue("esri.popup.support.AttachmentsOrderByInfo")],iS);const yqe=iS;let jh=class extends fo(xp){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};_([E({type:[String],json:{write:!0}})],jh.prototype,"attachmentKeywords",void 0),_([E({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],jh.prototype,"attachmentTypes",void 0),_([E({type:String,json:{write:!0}})],jh.prototype,"description",void 0),_([E({type:["auto","preview","list"],json:{write:!0}})],jh.prototype,"displayType",void 0),_([E({type:[yqe],json:{write:!0}})],jh.prototype,"orderByFields",void 0),_([E({type:String,json:{write:!0}})],jh.prototype,"title",void 0),_([E({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],jh.prototype,"type",void 0),jh=_([ue("esri.popup.content.AttachmentsContent")],jh);const jk=jh;var R9;let H0=R9=class extends xp{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new R9({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?Ze(this.outFields):null})}};_([E()],H0.prototype,"creator",void 0),_([E()],H0.prototype,"destroyer",void 0),_([E()],H0.prototype,"outFields",void 0),_([E({type:["custom"],readOnly:!0})],H0.prototype,"type",void 0),H0=R9=_([ue("esri.popup.content.CustomContent")],H0);const vqe=H0;var P9;let G_=P9=class extends qt{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new P9({title:this.title,expression:this.expression})}};_([E({type:String,json:{write:!0}})],G_.prototype,"title",void 0),_([E({type:String,json:{write:!0}})],G_.prototype,"expression",void 0),_([E({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],G_.prototype,"returnType",void 0),G_=P9=_([ue("esri.popup.ElementExpressionInfo")],G_);const _qe=G_;var C9;let sS=C9=class extends xp{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new C9({expressionInfo:this.expressionInfo?.clone()})}};_([E({type:_qe,json:{write:!0}})],sS.prototype,"expressionInfo",void 0),_([E({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],sS.prototype,"type",void 0),sS=C9=_([ue("esri.popup.content.ExpressionContent")],sS);const AO=sS;let mM=class extends fo(qt){constructor(e){super(e),this.type=null}};_([E({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],mM.prototype,"type",void 0),mM=_([ue("esri.layers.support.FieldFormat")],mM);const zB=mM,dye="auto";let mf=class extends zB{constructor(e){super(e),this.dateStyle=null,this.hour12=dye,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};_([E({type:["full","long","medium","short"],json:{write:!0}})],mf.prototype,"dateStyle",void 0),_([E({type:["always","auto","never"],nonNullable:!0,json:{default:dye,write:!0}})],mf.prototype,"hour12",void 0),_([E({type:["long","short"],json:{write:!0}})],mf.prototype,"month",void 0),_([E({type:["full","long","medium","short"],json:{write:!0}})],mf.prototype,"timeStyle",void 0),_([E({type:["date-time"]})],mf.prototype,"type",void 0),_([E({type:["numeric"],json:{write:!0}})],mf.prototype,"year",void 0),mf=_([ue("esri.layers.support.DateTimeFieldFormat")],mf);const Qy=mf,Fte={min:0,max:20},fye=2,pye=0,mye="decimal",gye="auto";let ym=class extends zB{constructor(e){super(e),this.maximumFractionDigits=fye,this.minimumFractionDigits=pye,this.style=mye,this.type="number",this.useGrouping=gye}};_([E({type:Or,nonNullable:!0,range:Fte,json:{default:fye,write:!0}})],ym.prototype,"maximumFractionDigits",void 0),_([E({type:Or,nonNullable:!0,range:Fte,json:{default:pye,write:!0}})],ym.prototype,"minimumFractionDigits",void 0),_([E({type:["decimal"],nonNullable:!0,json:{default:mye,write:!0}})],ym.prototype,"style",void 0),_([E({type:["number"]})],ym.prototype,"type",void 0),_([E({type:["always","auto","never"],nonNullable:!0,json:{default:gye,write:!0}})],ym.prototype,"useGrouping",void 0),ym=_([ue("esri.layers.support.NumberFieldFormat")],ym);const $4=ym;let B_=class extends fo(qt){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};_([pn(w7e)],B_.prototype,"dateFormat",void 0),_([E({type:Boolean,json:{write:!0}})],B_.prototype,"digitSeparator",void 0),_([E({type:Or,json:{write:!0}})],B_.prototype,"places",void 0),B_=_([ue("esri.popup.support.FieldInfoFormat")],B_);const nb=B_,xqe={base:zB,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":Qy,number:$4}};function tMt(t,e){const{format:n}=t;return e&&IO(e)?n?yye(n,e):gM(e,{hour12:"always",useGrouping:"always"}):null}function yye(t,e){const{dateFormat:n}=t;if(!e)return n?zte(t):Vte(t);if(!IO(e))return;const r={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return vye(t);case"single":case"double":return Vte(t);case"date":case"timestamp-offset":return n?zte(t):gM(e,r);case"date-only":return n?wqe(t):gM(e);case"time-only":return n?bqe(t):gM(e,r)}}function IO(t){return uye(t)||iqe(t)||sqe(t)||aqe(t)||oqe(t)}function vye(t){return new $4({useGrouping:t.digitSeparator?"always":"never"})}function Vte(t){const e=vye(t),{places:n}=t;return e.minimumFractionDigits=n??0,e.maximumFractionDigits=n??2,e}function zte(t){return new Qy({dateStyle:_ye(t),year:Eye(t),month:wye(t),timeStyle:bye(t),hour12:xye(t)})}function wqe(t){return new Qy({dateStyle:_ye(t),year:Eye(t),month:wye(t)})}function bqe(t){return new Qy({timeStyle:bye(t),hour12:xye(t)})}function _ye(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function xye(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function wye(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function bye(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function Eye(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function Eqe(t,e){const n=t.type==="number",r=t.type==="date-time";if(!e)return n?Ute(t):r?Gte(t):null;if(IO(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return n?Sye(t):null;case"single":case"double":return n?Ute(t):null;case"date":case"timestamp-offset":return r?Gte(t):null;case"date-only":return r?Sqe(t):null;case"time-only":return r?Tqe(t):null}}function Sye(t){return new nb({digitSeparator:t.useGrouping!=="never"})}function Ute(t){const e=Sye(t);return e.places=t.maximumFractionDigits,e}function Gte(t){let e;const n=Tye(t),r=kye(t),i=t.hour12==="never"?"24":null,s=t.year==="numeric"?"year":null,o=Aye(t);return n&&r&&i?e=`${n}-${r}-${i}`:n&&r?e=`${n}-${r}`:n?e=n:s&&o?e=`${o}-${s}`:s&&(e=s),e?new nb({dateFormat:e}):null}function Sqe(t){let e;const n=Tye(t),r=t.year==="numeric"?"year":null,i=Aye(t);return n?e=n:r&&i?e=`${i}-${r}`:r&&(e=r),e?new nb({dateFormat:e}):null}function Tqe(t){let e;const n=kye(t),r=t.hour12==="never"?"24":null;return n&&r?e=`short-date-${n}-${r}`:n&&(e=`short-date-${n}`),e?new nb({dateFormat:e}):null}function Tye(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function kye(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function Aye(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function gM(t,e){if(!IO(t))return;const n=e?.useGrouping??"auto",r=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new $4({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:n});case"single":case"double":return new $4({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:n});case"date":case"timestamp-offset":return new Qy({dateStyle:"short",timeStyle:"short",hour12:r});case"date-only":return new Qy({dateStyle:"short"});case"time-only":return new Qy({timeStyle:"short",hour12:r})}}let Fl=class extends fo(qt){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?Eqe(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?yye(e):null)}readFormat(e,n){if(!n.fieldFormat)return e?nb.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};_([E({value:null,clonable:!1,types:xqe,json:{write:{overridePolicy(t,e,n){const{fieldName:r}=this;return{enabled:!!r&&!r.startsWith("expression/")&&!r.startsWith("relationships/")&&!!n?.writeFieldFormat}}}}})],Fl.prototype,"fieldFormat",null),_([E({type:String,json:{write:!0}})],Fl.prototype,"fieldName",void 0),_([E({value:null,clonable:!1,type:nb,json:{write:!0}})],Fl.prototype,"format",null),_([or("format")],Fl.prototype,"readFormat",null),_([E({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Fl.prototype,"isEditable",void 0),_([E({type:String,json:{write:!0}})],Fl.prototype,"label",void 0),_([E({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Fl.prototype,"statisticType",void 0),_([pn(new Gs({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Fl.prototype,"stringFieldOption",void 0),_([E({type:String,json:{write:!0}})],Fl.prototype,"tooltip",void 0),_([E({type:Boolean,json:{write:!0}})],Fl.prototype,"visible",void 0),Fl=_([ue("esri.popup.FieldInfo")],Fl);const Iye=Fl;var M9;let vm=M9=class extends xp{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new M9(Ze({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};_([E({type:Object,json:{write:!0}})],vm.prototype,"attributes",void 0),_([E({type:String,json:{write:!0}})],vm.prototype,"description",void 0),_([E({type:[Iye],json:{write:!0}})],vm.prototype,"fieldInfos",void 0),_([E({type:String,json:{write:!0}})],vm.prototype,"title",void 0),_([E({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],vm.prototype,"type",void 0),vm=M9=_([ue("esri.popup.content.FieldsContent")],vm);const Fk=vm;let q0=class extends qt{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};_([E({type:String,json:{write:!0}})],q0.prototype,"altText",void 0),_([E({type:String,json:{write:!0}})],q0.prototype,"caption",void 0),_([E({type:String,json:{write:!0}})],q0.prototype,"title",void 0),_([E({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],q0.prototype,"type",void 0),q0=_([ue("esri.popup.content.mixins.MediaInfo")],q0);const UB=q0;var N9;let K0=N9=class extends Kt{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new N9({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};_([E()],K0.prototype,"color",void 0),_([E()],K0.prototype,"fieldName",void 0),_([E()],K0.prototype,"tooltip",void 0),_([E()],K0.prototype,"value",void 0),K0=N9=_([ue("esri.popup.content.support.ChartMediaInfoValueSeries")],K0);const kqe=K0;var O9;let _m=O9=class extends qt{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new O9({colors:Ze(this.colors),fields:Ze(this.fields),normalizeField:this.normalizeField,series:Ze(this.series),tooltipField:this.tooltipField})}};_([E({type:[Kn],json:{type:[[Or]],write:!0}})],_m.prototype,"colors",void 0),_([E({type:[String],json:{write:{isRequired:!0}}})],_m.prototype,"fields",void 0),_([E({type:String,json:{write:!0}})],_m.prototype,"normalizeField",void 0),_([E({type:[kqe],json:{read:!1}})],_m.prototype,"series",void 0),_([E({type:String,json:{write:!0}})],_m.prototype,"tooltipField",void 0),_m=O9=_([ue("esri.popup.content.support.ChartMediaInfoValue")],_m);const Aqe=_m;let oS=class extends UB{constructor(e){super(e),this.type=null,this.value=void 0}};_([E({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],oS.prototype,"type",void 0),_([E({type:Aqe,json:{write:{isRequired:!0}}})],oS.prototype,"value",void 0),oS=_([ue("esri.popup.content.mixins.ChartMediaInfo")],oS);const RO=oS,PO=kl()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var L9;let yM=L9=class extends RO{constructor(t){super(t),this.type="bar-chart"}clone(){return new L9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:PO.write,isRequired:!0}}})],yM.prototype,"type",void 0),yM=L9=_([ue("esri.popup.content.BarChartMediaInfo")],yM);const Rye=yM;var D9;let vM=D9=class extends RO{constructor(t){super(t),this.type="column-chart"}clone(){return new D9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:PO.write,isRequired:!0}}})],vM.prototype,"type",void 0),vM=D9=_([ue("esri.popup.content.ColumnChartMediaInfo")],vM);const Pye=vM;var $9;let aS=$9=class extends qt{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new $9({linkURL:this.linkURL,sourceURL:this.sourceURL})}};_([E({type:String,json:{write:!0}})],aS.prototype,"linkURL",void 0),_([E({type:String,json:{write:{isRequired:!0}}})],aS.prototype,"sourceURL",void 0),aS=$9=_([ue("esri.popup.content.support.ImageMediaInfoValue")],aS);const Iqe=aS;var j9;let W_=j9=class extends UB{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new j9({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};_([E({type:Number,json:{write:!0}})],W_.prototype,"refreshInterval",void 0),_([E({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],W_.prototype,"type",void 0),_([E({type:Iqe,json:{write:{isRequired:!0}}})],W_.prototype,"value",void 0),W_=j9=_([ue("esri.popup.content.ImageMediaInfo")],W_);const Cye=W_;var F9;let _M=F9=class extends RO{constructor(t){super(t),this.type="line-chart"}clone(){return new F9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:PO.write,isRequired:!0}}})],_M.prototype,"type",void 0),_M=F9=_([ue("esri.popup.content.LineChartMediaInfo")],_M);const Mye=_M;var V9;let xM=V9=class extends RO{constructor(t){super(t),this.type="pie-chart"}clone(){return new V9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:PO.write,isRequired:!0}}})],xM.prototype,"type",void 0),xM=V9=_([ue("esri.popup.content.PieChartMediaInfo")],xM);const Nye=xM,z9={base:UB,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":Rye,"column-chart":Pye,"line-chart":Mye,"pie-chart":Nye,image:Cye}};var U9;let Du=U9=class extends xp{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?Cye.fromJSON(e):e.type==="barchart"?Rye.fromJSON(e):e.type==="columnchart"?Pye.fromJSON(e):e.type==="linechart"?Mye.fromJSON(e):e.type==="piechart"?Nye.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(n=>n.toJSON())}clone(){return new U9(Ze({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};_([E()],Du.prototype,"activeMediaInfoIndex",void 0),_([E({type:Object,json:{write:!0}})],Du.prototype,"attributes",void 0),_([E({type:String,json:{write:!0}})],Du.prototype,"description",void 0),_([E({types:[z9]})],Du.prototype,"mediaInfos",void 0),_([or("mediaInfos")],Du.prototype,"readMediaInfos",null),_([Xn("mediaInfos")],Du.prototype,"writeMediaInfos",null),_([E({type:String,json:{write:!0}})],Du.prototype,"title",void 0),_([E({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Du.prototype,"type",void 0),Du=U9=_([ue("esri.popup.content.MediaContent")],Du);const Vk=Du;var G9;let lS=G9=class extends qt{constructor(t){super(t),this.field=null,this.order=null}clone(){return new G9({field:this.field,order:this.order})}};_([E({type:String,json:{write:!0}})],lS.prototype,"field",void 0),_([E({type:["asc","desc"],json:{write:!0}})],lS.prototype,"order",void 0),lS=G9=_([ue("esri.popup.support.RelatedRecordsInfoFieldOrder")],lS);const Oye=lS;let Fh=class extends fo(xp){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};_([E({type:String,json:{write:!0}})],Fh.prototype,"description",void 0),_([E({type:Number,json:{type:Or,write:!0}})],Fh.prototype,"displayCount",void 0),_([E({type:["list"],json:{write:{isRequired:!0}}})],Fh.prototype,"displayType",void 0),_([E({type:[Oye],json:{write:!0}})],Fh.prototype,"orderByFields",void 0),_([E({type:Number,json:{type:Or,write:{isRequired:!0}}})],Fh.prototype,"relationshipId",void 0),_([E({type:String,json:{write:!0}})],Fh.prototype,"title",void 0),_([E({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Fh.prototype,"type",void 0),Fh=_([ue("esri.popup.content.RelationshipContent")],Fh);const zk=Fh;var B9;let cS=B9=class extends xp{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new B9({text:this.text})}};_([E({type:String,json:{write:!0}})],cS.prototype,"text",void 0),_([E({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],cS.prototype,"type",void 0),cS=B9=_([ue("esri.popup.content.TextContent")],cS);const Uk=cS;let gf=class extends fo(qt){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};_([E({type:String,json:{write:!0}})],gf.prototype,"title",void 0),_([E({type:String,json:{write:!0}})],gf.prototype,"description",void 0),_([E({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],gf.prototype,"type",void 0),_([E({type:Number,json:{type:Or,write:!0}})],gf.prototype,"associatedNetworkSourceId",void 0),_([E({type:Number,json:{type:Or,write:!0}})],gf.prototype,"associatedAssetGroup",void 0),_([E({type:Number,json:{type:Or,write:!0}})],gf.prototype,"associatedAssetType",void 0),gf=_([ue("esri.popup.support.UtilityNetworkAssociationType")],gf);const Rqe=gf;let xm=class extends fo(xp){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};_([E({type:String,json:{write:!0}})],xm.prototype,"description",void 0),_([E({type:Number,json:{type:Or,write:!0}})],xm.prototype,"displayCount",void 0),_([E({type:String,json:{write:!0}})],xm.prototype,"title",void 0),_([E({type:[Rqe],json:{write:!0}})],xm.prototype,"associationTypes",void 0),_([pn({utilityNetworkAssociations:"utility-network-associations"})],xm.prototype,"type",void 0),xm=_([ue("esri.popup.content.UtilityNetworkAssociationsContent")],xm);const GB=xm,Pqe={base:null,key:"type",typeMap:{attachment:jk,media:Vk,text:Uk,expression:AO,field:Fk,relationship:zk,utilityNetworkAssociations:GB}},Cqe={base:null,key:"type",typeMap:{attachment:jk,media:Vk,text:Uk,expression:AO,field:Fk,relationship:zk}};var W9;let Y0=W9=class extends qt{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new W9({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};_([E({type:String,json:{write:!0}})],Y0.prototype,"name",void 0),_([E({type:String,json:{write:!0}})],Y0.prototype,"title",void 0),_([E({type:String,json:{write:!0}})],Y0.prototype,"expression",void 0),_([E({type:["string","number"],json:{write:!0}})],Y0.prototype,"returnType",void 0),Y0=W9=_([ue("esri.popup.ExpressionInfo")],Y0);const Mqe=Y0;var H9;let uS=H9=class extends qt{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new H9({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};_([E({type:Boolean,json:{write:!0}})],uS.prototype,"returnTopmostRaster",void 0),_([E({type:Boolean,json:{write:!0}})],uS.prototype,"showNoDataRecords",void 0),uS=H9=_([ue("esri.popup.LayerOptions")],uS);const Nqe=uS;var q9;let hS=q9=class extends qt{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new q9({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?Ze(this.orderByFields):null})}};_([E({type:Boolean,json:{write:!0}})],hS.prototype,"showRelatedRecords",void 0),_([E({type:[Oye],json:{write:!0}})],hS.prototype,"orderByFields",void 0),hS=q9=_([ue("esri.popup.RelatedRecordsInfo")],hS);const Bte=hS;var K9;let Cc=K9=class extends dB(Kt){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new K9({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};_([E()],Cc.prototype,"active",void 0),_([E()],Cc.prototype,"className",void 0),_([E()],Cc.prototype,"disabled",void 0),_([E()],Cc.prototype,"icon",void 0),_([E()],Cc.prototype,"id",void 0),_([E()],Cc.prototype,"indicator",void 0),_([E()],Cc.prototype,"title",void 0),_([E()],Cc.prototype,"type",void 0),_([E()],Cc.prototype,"visible",void 0),Cc=K9=_([ue("esri.support.actions.ActionBase")],Cc);const BB=Cc;var Y9;let wM=Y9=class extends BB{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new Y9({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};_([E()],wM.prototype,"image",void 0),wM=Y9=_([ue("esri.support.actions.ActionButton")],wM);const Oqe=wM;var X9;let dS=X9=class extends BB{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new X9({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};_([E()],dS.prototype,"image",void 0),_([E()],dS.prototype,"value",void 0),dS=X9=_([ue("esri.support.actions.ActionToggle")],dS);const Lqe=dS,TE="relationships/",Wte="expression/",Dqe=Ot.ofType({key:"type",defaultKeyValue:"button",base:BB,typeMap:{button:Oqe,toggle:Lqe}}),$qe={base:xp,key:"type",typeMap:{media:Vk,custom:vqe,text:Uk,attachments:jk,fields:Fk,expression:AO,relationship:zk,utilityNetworkAssociations:GB}},Lye=new Set(["attachments","fields","media","text","expression","relationship"]),jqe=new Set([...Lye,"utility-network-associations"]);let ms=class extends fo(qt){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(n=>Mg($qe,n)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||da(e)?e:(Tt.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,n){const{popupElements:r}=n;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(n.description,n.mediaInfos,r):this._readPopupInfo(n)}writeWebSceneContent(e,n,r,i){this._writePopupTemplateContent(e,n,i)}writeWebMapContent(e,n,r,i){this._writePopupTemplateContent(e,n,i)}writeFieldInfos(e,n,r,i){const{content:s}=this,o=Array.isArray(s)?s:null,{writeFieldFormat:a,...l}=i||{};if(e){const c=o?o.filter(h=>h.type==="fields"):[],u=c.length&&c.every(h=>h.fieldInfos?.length);n.fieldInfos=e.filter(Boolean).map(h=>{const f=h.toJSON(l);return u&&(f.visible=!1),f})}if(o)for(const c of o)c.type==="fields"&&this._writeFieldsContent(c,n,l)}writeLayerOptions(e,n,r,i){n[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(i)}writeTitle(e,n){n.title=e||""}async collectRequiredFields(e,n,r){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(e,n,r,[...i,...this._getContentExpressionInfos(this.content,i)]),Dk(e,n,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,n){const r=new Set;return await this.collectRequiredFields(r,e,n),[...r].sort()}_writePopupTemplateContent(e,n,r){typeof e!="string"?Array.isArray(e)&&(n.popupElements=e.filter(i=>r?.origin==="web-scene"?Lye.has(i.type):jqe.has(i.type)).map(i=>i?.toJSON(r)),n.popupElements.forEach(i=>{i.type==="attachments"?this._writeAttachmentContent(n):i.type==="media"?this._writeMediaContent(i,n):i.type==="text"?this._writeTextContent(i,n):i.type==="relationship"&&this._writeRelationshipContent(i,n)})):n.description=e}_writeFieldsContent(e,n,r){const i=e.fieldInfos;if(!Array.isArray(i)||!i.length)return;const s=n.fieldInfos;if(Array.isArray(s))for(const o of i){const a=s.find(l=>l.fieldName?.toLowerCase()===o.fieldName?.toLowerCase());a?a.visible=!0:s.push(o.toJSON(r))}else n.fieldInfos=i.map(o=>o.toJSON(r))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,n){const r=e.orderByFields?.map(s=>this._toFieldOrderJSON(s,e.relationshipId))||[],i=[...n.relatedRecordsInfo?.orderByFields||[],...r];n.relatedRecordsInfo={showRelatedRecords:!0,...i?.length&&{orderByFields:i}}}_writeTextContent(e,n){!n.description&&e.text&&(n.description=e.text)}_writeMediaContent(e,n){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=Ze(e.mediaInfos);Array.isArray(n.mediaInfos)?n.mediaInfos=[...n.mediaInfos,...r]:n.mediaInfos=r}_readPopupInfoElements(e,n,r){const i={description:!1,mediaInfos:!1};return r.map(s=>s.type==="media"?(s.mediaInfos||!n||i.mediaInfos||(s.mediaInfos=n,i.mediaInfos=!0),Vk.fromJSON(s)):s.type==="text"?(s.text||!e||i.description||(s.text=e,i.description=!0),Uk.fromJSON(s)):s.type==="attachments"?jk.fromJSON(s):s.type==="fields"?Fk.fromJSON(s):s.type==="expression"?AO.fromJSON(s):s.type==="relationship"?zk.fromJSON(s):s.type==="utilityNetworkAssociations"?GB.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:n,order:r}=e;if(!n?.startsWith(TE))return null;const i=n.replace(TE,"").split("/");if(i.length!==2)return null;const s=parseInt(i[0],10),o=i[1];return!Number.isNaN(s)&&o?zk.fromJSON({relationshipId:s,orderByFields:[{field:o,order:r}]}):null}_toFieldOrderJSON(e,n){const{order:r,field:i}=e;return{field:`${TE}${n}/${i}`,order:r}}_readPopupInfo({description:e,mediaInfos:n,showAttachments:r,relatedRecordsInfo:i={showRelatedRecords:!1}}){const s=[];e?s.push(new Uk({text:e})):s.push(new Fk),Array.isArray(n)&&n.length&&s.push(Vk.fromJSON({mediaInfos:n})),r&&s.push(jk.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=i;return o&&a?.length&&a.forEach(l=>{const c=this._toRelationshipContent(l);c&&s.push(c)}),s.length?s:e}_getContentElementFields(e){const n=e?.type;if(n==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(n==="custom")return e.outFields||[];if(n==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(n==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((i,s)=>[...i,...this._getMediaInfoFields(s)],[])]}return n==="text"?this._extractFieldNames(e.text):n==="relationship"||n==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:n,title:r,value:i}=e,s=i||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:c,linkURL:u}=s,h=[...this._extractFieldNames(r),...this._extractFieldNames(n),...this._extractFieldNames(c),...this._extractFieldNames(u),...o??[]];return a&&h.push(a),l&&h.push(l),h}_getContentExpressionInfos(e,n){return Array.isArray(e)?e.reduce((r,i)=>[...r,...i.type==="expression"&&i.expressionInfo?[i.expressionInfo]:[]],n):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((n,r)=>[...n,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,n,r,i){i&&await Promise.all(i.map(s=>F1(e,n,r,s.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:n,visible:r})=>!(r!==void 0&&!r||!n||n.startsWith(TE)||n.startsWith(Wte))).map(n=>n.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((n,r)=>[...n,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:n,title:r,type:i}=e,s=i==="button"||i==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(n),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return gqe(e).filter(n=>!(n.startsWith(TE)||n.startsWith(Wte)))}};_([E({type:Dqe})],ms.prototype,"actions",void 0),_([E()],ms.prototype,"content",void 0),_([zs("content")],ms.prototype,"castContent",null),_([or("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],ms.prototype,"readContent",null),_([Xn("web-scene","content",{popupElements:{type:Ot.ofType(Cqe)},showAttachments:{type:Boolean},mediaInfos:{type:Ot.ofType(z9)},description:{type:String},relatedRecordsInfo:{type:Bte}})],ms.prototype,"writeWebSceneContent",null),_([Xn("content",{popupElements:{type:Ot.ofType(Pqe)},showAttachments:{type:Boolean},mediaInfos:{type:Ot.ofType(z9)},description:{type:String},relatedRecordsInfo:{type:Bte}})],ms.prototype,"writeWebMapContent",null),_([E({type:[Mqe],json:{write:!0}})],ms.prototype,"expressionInfos",void 0),_([E({type:[Iye]})],ms.prototype,"fieldInfos",void 0),_([Xn("fieldInfos")],ms.prototype,"writeFieldInfos",null),_([E({type:Nqe})],ms.prototype,"layerOptions",void 0),_([Xn("layerOptions")],ms.prototype,"writeLayerOptions",null),_([E({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],ms.prototype,"lastEditInfoEnabled",void 0),_([E()],ms.prototype,"outFields",void 0),_([E()],ms.prototype,"overwriteActions",void 0),_([E()],ms.prototype,"returnGeometry",void 0),_([E({json:{type:String}})],ms.prototype,"title",void 0),_([Xn("title")],ms.prototype,"writeTitle",null),ms=_([ue("esri.PopupTemplate")],ms);const Fqe=ms,Dye=Symbol("idFieldsProviderSymbol");function Vqe(t){return!!t&&Dye in t}function Hte(t){return Vqe(t)?t[Dye]:void 0}const $ye=Symbol("popupProvider");function cMt(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function zqe(t){return!!t&&$ye in t}function Uqe(t){return zqe(t)?t[$ye]:null}function uMt(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const n=[];for(const r of e.fieldNames)n.push(t.attributes[r]??null);return JSON.stringify(n)}}}function qte(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const n=e.uniqueIdFields.map(r=>t.attributes?.[r]);return JSON.stringify(n)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const Kte=new Gs({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Gqe=0,us=class extends qt{constructor(e){super(e),this.id="sym"+Gqe++,this.type=null,this.color=new Kn([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,n){}hash(){return JSON.stringify(this.toJSON())}clone(){}};_([E({type:Kte.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:Kte.write,isRequired:!0}}})],us.prototype,"type",void 0),_([E({type:Kn,json:{write:{allowNull:!0}}})],us.prototype,"color",void 0),_([or("color")],us.prototype,"readColor",null),us=_([ue("esri.symbols.Symbol")],us);var Z9;let al=Z9=class extends us{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const n=this.data.primitiveOverrides;if(n){const r=n.map(i=>{const s=i.valueExpressionInfo;return s?F1(t,e,null,s.expression):null});await Promise.all(r)}}}clone(){return new Z9({data:Ze(this.data)})}hash(){return pde(JSON.stringify(this.data)).toString()}};_([E({json:{write:!1}})],al.prototype,"color",void 0),_([E({json:{write:!0}})],al.prototype,"data",void 0),_([or("data",["symbol"])],al.prototype,"readData",null),_([Xn("data",{})],al.prototype,"writeData",null),_([pn({CIMSymbolReference:"cim"},{readOnly:!0})],al.prototype,"type",void 0),al=Z9=_([ue("esri.symbols.CIMSymbol")],al);let Pa=class extends qt{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,n,r){e||(n[r]=e)}};_([E({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Pa.prototype,"enabled",void 0),_([Xn("enabled")],Pa.prototype,"writeEnabled",null),_([E({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Pa.prototype,"type",void 0),Pa=_([ue("esri.symbols.Symbol3DLayer")],Pa);function Bqe(t,e){const n=e.transparency!=null?Zme(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new Kn([r[0]||0,r[1]||0,r[2]||0,n]):null}function Wqe(t,e){e.color=t.toJSON().slice(0,3);const n=Xme(t.a);n!==0&&(e.transparency=n)}function Jg(t){return{type:Kn,nonNullable:t?.nonNullable,json:{type:[Or],default:null,read:{source:["color","transparency"],reader:Bqe},write:{target:{color:{type:[Or],isRequired:t?.colorRequiredOnWrite},transparency:{type:Or}},writer:Wqe}}}}const Rd={type:Number,cast:bi,json:{write:!0}};function fMt(t){return t==="emissive"?0:1}let X0=class extends qt{constructor(e){super(e),this.color=new Kn([0,0,0,1]),this.extensionLength=0,this.size=j1(1)}clone(){}cloneProperties(){return{color:Ze(this.color),size:this.size,extensionLength:this.extensionLength}}};_([E({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],X0.prototype,"type",void 0),_([E(Jg({colorRequiredOnWrite:!0}))],X0.prototype,"color",void 0),_([E({...Rd,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],X0.prototype,"extensionLength",void 0),_([E(Rd)],X0.prototype,"size",void 0),X0=_([ue("esri.symbols.edges.Edges3D")],X0);const WB=X0;var J9;let bM=J9=class extends WB{constructor(t){super(t),this.type="sketch"}clone(){return new J9(this.cloneProperties())}};_([pn({sketch:"sketch"},{readOnly:!0})],bM.prototype,"type",void 0),bM=J9=_([ue("esri.symbols.edges.SketchEdges3D")],bM);const Hqe=bM;var Q9;let EM=Q9=class extends WB{constructor(t){super(t),this.type="solid"}clone(){return new Q9(this.cloneProperties())}};_([pn({solid:"solid"},{readOnly:!0})],EM.prototype,"type",void 0),EM=Q9=_([ue("esri.symbols.edges.SolidEdges3D")],EM);const qqe=EM,jye={types:{key:"type",base:WB,typeMap:{solid:qqe,sketch:Hqe}},json:{write:!0}};var e7;let mx=e7=class extends qt{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new e7(t)}};_([E({json:{write:!1}})],mx.prototype,"strength",void 0),_([E({json:{write:!1}})],mx.prototype,"source",void 0),mx=e7=_([ue("esri.symbols.support.Symbol3DEmissive")],mx);var t7;let ic=t7=class extends qt{constructor(t){super(t),this.color=null,this.emissive=new mx({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new t7(t)}};_([E(Jg())],ic.prototype,"color",void 0),_([E({type:mx,json:{write:!1}})],ic.prototype,"emissive",void 0),ic=t7=_([ue("esri.symbols.support.Symbol3DMaterial")],ic);var n7,yw;let Sf=(yw=class extends Pa{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new n7({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},n7=yw,yw);_([pn({Extrude:"extrude"},{readOnly:!0})],Sf.prototype,"type",void 0),_([E({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Sf.prototype,"size",void 0),_([E({type:ic,json:{write:!0}})],Sf.prototype,"material",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Sf.prototype,"castShadows",void 0),_([E(jye)],Sf.prototype,"edges",void 0),Sf=n7=_([ue("esri.symbols.ExtrudeSymbol3DLayer")],Sf);let cT=class extends qt{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};_([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],cT.prototype,"type",void 0),cT=_([ue("esri.symbols.patterns.LinePattern3D")],cT);const Kqe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var r7;const Yqe=kl()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let My=r7=class extends cT{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new r7(t)}};_([E({type:["style"],json:{write:{isRequired:!0}}})],My.prototype,"type",void 0),_([pn(Yqe),E({type:Kqe,json:{write:{isRequired:!0}}})],My.prototype,"style",void 0),My=r7=_([ue("esri.symbols.patterns.LineStylePattern3D")],My);let uT=class extends qt{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};_([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],uT.prototype,"type",void 0),uT=_([ue("esri.symbols.patterns.Pattern3D")],uT);const Xqe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var i7;let gx=i7=class extends uT{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new i7({style:this.style})}};_([E({type:["style"],json:{write:{isRequired:!0}}})],gx.prototype,"type",void 0),_([E({type:Xqe,json:{read:!0,write:{isRequired:!0}}})],gx.prototype,"style",void 0),gx=i7=_([ue("esri.symbols.patterns.StylePattern3D")],gx);const Zqe={types:{key:"type",base:uT,typeMap:{style:gx}},json:{write:!0}},Fye={types:{key:"type",base:cT,typeMap:{style:My}},json:{write:!0}},hT=new Kn("white"),Jqe=new Kn([255,255,255,0]);function Qqe(t){return t.r===0&&t.g===0&&t.b===0}var s7;let dT=s7=class extends ic{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new s7(t)}};_([pn({multiply:"multiply",replace:"replace",tint:"tint"})],dT.prototype,"colorMixMode",void 0),dT=s7=_([ue("esri.symbols.support.Symbol3DFillMaterial")],dT);function HB(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function eKe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function tKe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x){return[t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x]}const nKe=HB();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:nKe,clone:eKe,create:HB,fromValues:tKe},Symbol.toStringTag,{value:"Module"}));function rKe(t){return t<=ode?new Array(t).fill(0):new Float64Array(t)}function yMt(t){return(sDe(t)?t.byteLength/8:t.length)<=ode?Array.from(t):new Float64Array(t)}function vMt(t,e,n){return Array.isArray(t)?t.slice(e,e+n):t.subarray(e,e+n)}function _Mt(t){return[...t]}function xMt(t){const e=HB();for(let n=0;n<16;++n)e[n]=t[n];return e}function gI(t=aKe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function qB(t,e,n,r,i,s,o=gI()){return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=s,o}function wMt(t,e=gI()){return iKe(t,0,t.length/3,e)}function iKe(t,e,n,r=gI()){return Vye(r,o7),sKe(r,t,e,n),r}function bMt(t,e=rKe(24)){const[n,r,i,s,o,a]=t;return e[0]=n,e[1]=r,e[2]=i,e[3]=n,e[4]=r,e[5]=a,e[6]=n,e[7]=o,e[8]=i,e[9]=n,e[10]=o,e[11]=a,e[12]=s,e[13]=r,e[14]=i,e[15]=s,e[16]=r,e[17]=a,e[18]=s,e[19]=o,e[20]=i,e[21]=s,e[22]=o,e[23]=a,e}function EMt(t,e){const n=isFinite(t[2])||isFinite(t[5]);return new Dn(n?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function SMt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function TMt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function kMt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function sKe(t,e,n=0,r=e.length/3){let i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let u=0;u<r;u++)i=Math.min(i,e[n+3*u]),s=Math.min(s,e[n+3*u+1]),o=Math.min(o,e[n+3*u+2]),a=Math.max(a,e[n+3*u]),l=Math.max(l,e[n+3*u+1]),c=Math.max(c,e[n+3*u+2]);t[0]=i,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function AMt(t,e,n){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];if(n)for(let u=0;u<r;u++){const h=e[u];i=Math.min(i,h[0]),s=Math.min(s,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),l=Math.max(l,h[1]),c=Math.max(c,h[2])}else for(let u=0;u<r;u++){const h=e[u];i=Math.min(i,h[0]),s=Math.min(s,h[1]),a=Math.max(a,h[0]),l=Math.max(l,h[1])}t[0]=i,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function IMt(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function yI(t){return t[0]>=t[3]?0:t[3]-t[0]}function vI(t){return t[1]>=t[4]?0:t[4]-t[1]}function _I(t){return t[2]>=t[5]?0:t[5]-t[2]}function RMt(t){const e=yI(t),n=_I(t),r=vI(t);return Math.sqrt(e*e+n*n+r*r)}function PMt(t,e=[0,0,0]){return e[0]=t[0]+yI(t)/2,e[1]=t[1]+vI(t)/2,e[2]=t[2]+_I(t)/2,e}function CMt(t,e=[0,0,0]){return e[0]=yI(t),e[1]=vI(t),e[2]=_I(t),e}function MMt(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function oKe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function NMt(t,e){return e==null||oKe(t,e)}function OMt(t,e,n,r,i=t){return i[0]=t[0]+e,i[1]=t[1]+n,i[2]=t[2]+r,i[3]=t[3]+e,i[4]=t[4]+n,i[5]=t[5]+r,i}function LMt(t,e,n=t){const r=t[0]+yI(t)/2,i=t[1]+vI(t)/2,s=t[2]+_I(t)/2;return n[0]=r+(t[0]-r)*e,n[1]=i+(t[1]-i)*e,n[2]=s+(t[2]-s)*e,n[3]=r+(t[3]-r)*e,n[4]=i+(t[4]-i)*e,n[5]=s+(t[5]-s)*e,n}function DMt(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function $Mt(t,e,n=t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n!==t&&(n[3]=t[3],n[4]=t[4],n[5]=t[5]),n}function jMt(t,e,n=t){return n[3]=e[0],n[4]=e[1],n[5]=e[2],n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),t}function Vye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function FMt(t){return t?Vye(t,o7):gI(o7)}function VMt(t,e=ml()){return e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function zMt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function UMt(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=i,t[5]=Number.POSITIVE_INFINITY,t}function Yte(t){return t.length===6}function GMt(t){return yI(t)===0&&vI(t)===0&&_I(t)===0}function BMt(t,e,n){if(t==null||e==null)return t===e;if(!Yte(t)||!Yte(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const o7=[1/0,1/0,1/0,-1/0,-1/0,-1/0],aKe=[0,0,0,0,0,0];gI();function WMt(t,{isPrimitive:e,width:n,depth:r,height:i}){const s=e?10:1;if(n==null&&i==null&&r==null)return[s*t[0],s*t[1],s*t[2]];const o=tb(n,r,i);let a;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const lKe=qB(-.5,-.5,-.5,.5,.5,.5),cKe=qB(-.5,-.5,0,.5,.5,1),uKe=qB(-.5,-.5,0,.5,.5,.5);function HMt(t){switch(t){case"sphere":case"cube":case"diamond":return lKe;case"cylinder":case"cone":case"inverted-cone":return cKe;case"tetrahedron":return uKe;default:return}}const KB=["butt","square","round"],hKe=[...KB,"none"],zye=["miter","bevel","round"];var a7;let Z0=a7=class extends qt{constructor(t){super(t),this.color=new Kn([0,0,0,1]),this.size=j1(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new a7(t)}};_([E(Jg({colorRequiredOnWrite:!0}))],Z0.prototype,"color",void 0),_([E({...Rd,json:{write:{isRequired:!0}}})],Z0.prototype,"size",void 0),_([E(Fye)],Z0.prototype,"pattern",void 0),_([E({type:KB,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Z0.prototype,"patternCap",void 0),Z0=a7=_([ue("esri.symbols.support.Symbol3DOutline")],Z0);var SM,vw;let Wl=(vw=class extends Pa{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new SM(e)}static fromSimpleFillSymbol(e){const n=e.outline&&e.outline.style&&e.outline.style!=="solid"?new My({style:e.outline.style}):null,r={size:e.outline?.width??0,color:(e.outline?.color??hT).clone(),pattern:n};return n&&e.outline?.cap&&(r.patternCap=e.outline.cap),new SM({material:new dT({color:(e.color??Jqe).clone()}),pattern:e.style&&e.style!=="solid"?new gx({style:e.style}):null,outline:r})}},SM=vw,vw);_([pn({Fill:"fill"},{readOnly:!0})],Wl.prototype,"type",void 0),_([E({type:dT,json:{write:!0}})],Wl.prototype,"material",void 0),_([E(Zqe)],Wl.prototype,"pattern",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Wl.prototype,"castShadows",void 0),_([E({type:Z0,json:{write:!0}})],Wl.prototype,"outline",void 0),_([E(jye)],Wl.prototype,"edges",void 0),Wl=SM=_([ue("esri.symbols.FillSymbol3DLayer")],Wl);var l7;const dKe=kl()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let J0=l7=class extends qt{constructor(t){super(t)}readHref(t,e,n){return t?W2(t,n):e.dataURI}writeHref(t,e,n,r){t&&(nv(t)?e.dataURI=t:(e.href=n2(t,r),vl(e.href)&&(e.href=pg(e.href))))}clone(){return new l7({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};_([E({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],J0.prototype,"href",void 0),_([or("href")],J0.prototype,"readHref",null),_([Xn("href",{href:{type:String},dataURI:{type:String}})],J0.prototype,"writeHref",null),_([pn(dKe)],J0.prototype,"primitive",void 0),J0=l7=_([ue("esri.symbols.support.IconSymbol3DLayerResource")],J0);const qMt="circle";let TM=class extends fo(qt){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};_([E({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],TM.prototype,"mode",void 0),TM=_([ue("esri.symbols.support.OccludedVisibility")],TM);const Uye=TM;var c7;let yx=c7=class extends Kt{constructor(t){super(t),this.x=0,this.y=0}clone(){return new c7({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};_([E({type:Number})],yx.prototype,"x",void 0),_([E({type:Number})],yx.prototype,"y",void 0),yx=c7=_([ue("esri.symbols.support.Symbol3DAnchorPosition2D")],yx);var u7;let fS=u7=class extends qt{constructor(t){super(t),this.color=new Kn([0,0,0,1]),this.size=j1(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new u7(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};_([E(Jg({colorRequiredOnWrite:!0}))],fS.prototype,"color",void 0),_([E({...Rd,json:{write:{isRequired:!0}}})],fS.prototype,"size",void 0),fS=u7=_([ue("esri.symbols.support.Symbol3DIconOutline")],fS);var H_,_w;let Js=(_w=class extends Pa{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new H_({anchor:this.anchor,anchorPosition:Ze(this.anchorPosition),enabled:this.enabled,material:Ze(this.material),outline:Ze(this.outline),resource:Ze(this.resource),angle:this.angle,size:this.size,occludedVisibility:Ze(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const n=e.color||hT,r=Xte(e),i=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||hT).clone()}:null;return new H_({size:e.size,angle:e.angle,resource:{primitive:pKe(()=>Tt.getLogger(this.prototype),e.style)},material:{color:n},outline:i,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const n=!e.color||Qqe(e.color)?hT:e.color,r=Xte(e);return new H_({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:n.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new H_({resource:{href:Tde({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},H_=_w,_w);function Xte(t){const e="width"in t?t.width:t.size,n="height"in t?t.height:t.size,r=Zte(t.xoffset),i=Zte(t.yoffset);return(r||i)&&e&&n?{x:-r/e,y:i/n}:null}function Zte(t){return isFinite(t)?t:0}_([E({type:ic,json:{write:!0}})],Js.prototype,"material",void 0),_([E({type:J0,json:{write:!0}})],Js.prototype,"resource",void 0),_([pn({Icon:"icon"},{readOnly:!0})],Js.prototype,"type",void 0),_([E({...Rd,json:{write:{isRequired:!0}}})],Js.prototype,"size",void 0),_([pn({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],Js.prototype,"anchor",void 0),_([E({type:yx,json:{type:[Number],read:{reader:t=>new yx({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Js.prototype,"anchorPosition",void 0),_([E({type:fS,json:{write:!0}})],Js.prototype,"outline",void 0),_([E({type:Number,json:{write:!0,default:0}})],Js.prototype,"angle",void 0),_([E({type:Uye})],Js.prototype,"occludedVisibility",void 0),Js=H_=_([ue("esri.symbols.IconSymbol3DLayer")],Js);const fKe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function pKe(t,e){return fKe[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const mKe=["begin","end","begin-end"],Gye=["arrow","circle","square","diamond","cross","x"];let Mf=class extends fo(qt){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};_([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Mf.prototype,"type",void 0),_([E({type:mKe,json:{default:"begin-end",write:!0}})],Mf.prototype,"placement",void 0),_([E({type:Gye,json:{default:"arrow",write:!0}})],Mf.prototype,"style",void 0),_([E({type:Kn,json:{type:[Or],default:null,write:!0}})],Mf.prototype,"color",void 0),Mf=_([ue("esri.symbols.LineStyleMarker3D")],Mf);var kM,xw;let rl=(xw=class extends Pa{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=j1(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new kM(e)}static fromSimpleLineSymbol(e){const n={enabled:!0,size:e.width??j1(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new My({style:e.style}):null,material:new ic({color:(e.color||hT).clone()}),marker:e.marker?new Mf({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new kM(n)}},kM=xw,xw);_([E({type:ic,json:{write:!0}})],rl.prototype,"material",void 0),_([pn({Line:"line"},{readOnly:!0})],rl.prototype,"type",void 0),_([E({type:zye,json:{write:!0,default:"miter"}})],rl.prototype,"join",void 0),_([E({type:KB,json:{write:!0,default:"butt"}})],rl.prototype,"cap",void 0),_([E({...Rd,json:{write:{isRequired:!0}}})],rl.prototype,"size",void 0),_([E(Fye)],rl.prototype,"pattern",void 0),_([E({types:{key:"type",base:Mf,typeMap:{style:Mf}},json:{write:!0}})],rl.prototype,"marker",void 0),rl=kM=_([ue("esri.symbols.LineSymbol3DLayer")],rl);var h7;const gKe=kl()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let pS=h7=class extends qt{clone(){return new h7({href:this.href,primitive:this.primitive})}};_([E({type:String,json:{read:J5,write:r2}})],pS.prototype,"href",void 0),_([pn(gKe)],pS.prototype,"primitive",void 0),pS=h7=_([ue("esri.symbols.support.ObjectSymbol3DLayerResource")],pS);const XMt="sphere";var d7;let gy=d7=class extends Kt{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new d7({x:this.x,y:this.y,z:this.z})}};_([E({type:Number})],gy.prototype,"x",void 0),_([E({type:Number})],gy.prototype,"y",void 0),_([E({type:Number})],gy.prototype,"z",void 0),gy=d7=_([ue("esri.symbols.support.Symbol3DAnchorPosition3D")],gy);var f7,ww;let Zs=(ww=class extends Pa{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new f7({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},f7=ww,ww);_([E({type:ic,json:{write:!0}})],Zs.prototype,"material",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Zs.prototype,"castShadows",void 0),_([E({type:pS,json:{write:!0}})],Zs.prototype,"resource",void 0),_([pn({Object:"object"},{readOnly:!0})],Zs.prototype,"type",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"width",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"height",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"depth",void 0),_([pn({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],Zs.prototype,"anchor",void 0),_([E({type:gy,json:{type:[Number],read:{reader:t=>new gy({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Zs.prototype,"anchorPosition",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"heading",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"tilt",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"roll",void 0),_([E({readOnly:!0})],Zs.prototype,"isPrimitive",null),Zs=f7=_([ue("esri.symbols.ObjectSymbol3DLayer")],Zs);var p7,bw;let wo=(bw=class extends Pa{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,n){return e??(n.height==null&&n.size!=null?n.size:void 0)}readHeight(e,n){return e??(n.width==null&&n.size!=null?n.size:void 0)}clone(){return new p7({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},p7=bw,bw);_([E({type:ic,json:{write:!0}})],wo.prototype,"material",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],wo.prototype,"castShadows",void 0),_([pn({Path:"path"},{readOnly:!0})],wo.prototype,"type",void 0),_([E({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],wo.prototype,"profile",void 0),_([E({type:zye,nonNullable:!0,json:{write:!0,default:"miter"}})],wo.prototype,"join",void 0),_([E({type:hKe,nonNullable:!0,json:{write:!0,default:"butt"}})],wo.prototype,"cap",void 0),_([E({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],wo.prototype,"width",void 0),_([or("width",["width","size","height"])],wo.prototype,"readWidth",null),_([E({type:Number,json:{write:!0}})],wo.prototype,"height",void 0),_([or("height",["height","size","width"])],wo.prototype,"readHeight",null),_([E({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],wo.prototype,"anchor",void 0),_([E({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],wo.prototype,"profileRotation",void 0),wo=p7=_([ue("esri.symbols.PathSymbol3DLayer")],wo);const yKe=["none","underline","line-through"],vKe=["normal","italic","oblique"],_Ke=["normal","lighter","bold","bolder"],Bye={type:Number,cast:t=>{const e=Zl(t);return e===0?1:cu(e,.1,4)},nonNullable:!0},xKe=["left","right","center"],wKe=["baseline","top","middle","bottom"],Wye={type:xKe,nonNullable:!0},Hye={type:wKe,nonNullable:!0},ZMt=8;var m7;let $c=m7=class extends qt{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return bi(t)}clone(){return new m7({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};_([E({type:yKe,json:{default:"none",write:!0}})],$c.prototype,"decoration",void 0),_([E({type:String,json:{write:!0}})],$c.prototype,"family",void 0),_([E({type:Number,json:{write:{overridePolicy:(t,e,n)=>({enabled:!n||!n.textSymbol3D})}}})],$c.prototype,"size",void 0),_([zs("size")],$c.prototype,"castSize",null),_([E({type:vKe,json:{default:"normal",write:!0}})],$c.prototype,"style",void 0),_([E({type:_Ke,json:{default:"normal",write:!0}})],$c.prototype,"weight",void 0),$c=m7=_([ue("esri.symbols.Font")],$c);var g7;let vx=g7=class extends qt{constructor(){super(...arguments),this.color=new Kn([0,0,0,1]),this.size=0}clone(){const t={color:Ze(this.color),size:this.size};return new g7(t)}};_([E(Jg())],vx.prototype,"color",void 0),_([E(Rd)],vx.prototype,"size",void 0),vx=g7=_([ue("esri.symbols.support.Symbol3DHalo")],vx);let fT=class extends fo(qt){constructor(e){super(e),this.color=null}};_([E(Jg())],fT.prototype,"color",void 0),fT=_([ue("esri.symbols.support.Symbol3DTextBackground")],fT);var AM,Ew;let vs=(Ew=class extends Pa{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,n,r,i){const s={...i,textSymbol3D:!0};n.font=e.write({},s),delete n.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new AM({enabled:this.enabled,font:Ze(this.font),halo:Ze(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:Ze(this.background),occludedVisibility:Ze(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new AM({font:e.font!=null?e.font.clone():new $c,halo:bKe(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new ic({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new fT({color:e.backgroundColor.clone()}):null})}},AM=Ew,Ew);function bKe(t,e){return t&&e!=null&&e>0?new vx({color:Ze(t),size:e}):null}_([E({type:$c,json:{write:!0}})],vs.prototype,"font",null),_([Xn("font")],vs.prototype,"writeFont",null),_([E({type:vx,json:{write:!0}})],vs.prototype,"halo",void 0),_([E({...Wye,json:{default:"center",write:!0}})],vs.prototype,"horizontalAlignment",void 0),_([E({...Bye,json:{default:1,write:!0}})],vs.prototype,"lineHeight",void 0),_([E({type:ic,json:{write:!0}})],vs.prototype,"material",void 0),_([E({type:fT,json:{write:!0}})],vs.prototype,"background",void 0),_([E(Rd)],vs.prototype,"size",null),_([E({type:String,json:{write:!0}})],vs.prototype,"text",void 0),_([pn({Text:"text"},{readOnly:!0})],vs.prototype,"type",void 0),_([E({...Hye,json:{default:"baseline",write:!0}})],vs.prototype,"verticalAlignment",void 0),_([E({type:Uye})],vs.prototype,"occludedVisibility",void 0),vs=AM=_([ue("esri.symbols.TextSymbol3DLayer")],vs);var y7,Sw;let Tf=(Sw=class extends Pa{constructor(e){super(e),this.color=v7.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new y7({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},y7=Sw,Sw);_([E({type:Kn,nonNullable:!0,json:{type:[Or],write:(t,e,n)=>e[n]=t.toArray(1),default:()=>v7.clone(),defaultEquals:t=>t.toCss(!0)===v7.toCss(!0)}})],Tf.prototype,"color",void 0),_([pn({Water:"water"},{readOnly:!0})],Tf.prototype,"type",void 0),_([E({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Tf.prototype,"waterbodySize",void 0),_([E({type:Number,json:{write:!0,default:null}})],Tf.prototype,"waveDirection",void 0),_([E({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Tf.prototype,"waveStrength",void 0),Tf=y7=_([ue("esri.symbols.WaterSymbol3DLayer")],Tf);const v7=new Kn([0,119,190]);var _7;let Nf=_7=class extends Kt{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new _7({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};_([E({type:String})],Nf.prototype,"name",void 0),_([E({type:String})],Nf.prototype,"styleUrl",void 0),_([E({type:String})],Nf.prototype,"styleName",void 0),_([E({type:it})],Nf.prototype,"portal",void 0),Nf=_7=_([ue("esri.symbols.support.StyleOrigin")],Nf);var x7;let pT=x7=class extends Kt{constructor(){super(...arguments),this.url=""}clone(){return new x7({url:this.url})}};_([E({type:String})],pT.prototype,"url",void 0),pT=x7=_([ue("esri.symbols.support.Thumbnail")],pT);const qye={icon:Js,object:Zs,line:rl,path:wo,fill:Wl,extrude:Sf,text:vs,water:Tf},EKe=Ot.ofType({base:Pa,key:"type",typeMap:qye,errorContext:"symbol-layer"});let il=class extends us{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const n=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=n?.type,i=r||Ot;this._set("symbolLayers",new i)}get color(){return null}set color(e){this.constructed&&Tt.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){pd(e,this._get("symbolLayers"))}readStyleOrigin(e,n,r){if(e.styleUrl&&e.name){const i=W2(e.styleUrl,r);return new Nf({styleUrl:i,name:e.name})}if(e.styleName&&e.name)return new Nf({portal:r?.portal||it.getDefault(),styleName:e.styleName,name:e.name});r?.messages&&r.messages.push(new kd("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,n,r,i){if(e.styleUrl&&e.name){let s=n2(e.styleUrl,i);vl(s)&&(s=pg(s)),n.styleOrigin={styleUrl:s,name:e.name}}else e.styleName&&e.name&&(e.portal&&i?.portal&&!IDe(e.portal.restUrl,i.portal.restUrl)?i?.messages&&i.messages.push(new kd("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):n.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Pa||e&&qye[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};_([E({json:{read:!1,write:!1}})],il.prototype,"color",null),_([E({type:EKe,nonNullable:!0,json:{write:!0}}),zs(Dfe)],il.prototype,"symbolLayers",null),_([E({type:Nf})],il.prototype,"styleOrigin",void 0),_([or("styleOrigin")],il.prototype,"readStyleOrigin",null),_([Xn("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],il.prototype,"writeStyleOrigin",null),_([E({type:pT,json:{read:!1}})],il.prototype,"thumbnail",void 0),_([E({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],il.prototype,"type",void 0),il=_([ue("esri.symbols.Symbol3D")],il);let _x=class extends qt{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};_([E({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],_x.prototype,"type",void 0),_([E({readOnly:!0})],_x.prototype,"visible",void 0),_x=_([ue("esri.symbols.callouts.Callout3D")],_x);var w7;let IM=w7=class extends qt{constructor(t){super(t),this.color=new Kn("white")}clone(){return new w7({color:Ze(this.color)})}};_([E(Jg({colorRequiredOnWrite:!0}))],IM.prototype,"color",void 0),IM=w7=_([ue("esri.symbols.callouts.LineCallout3DBorder")],IM);const SKe=IM;var b7;let kf=b7=class extends _x{constructor(t){super(t),this.type="line",this.color=new Kn([0,0,0,1]),this.size=j1(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new b7({color:Ze(this.color),size:this.size,border:Ze(this.border)})}};_([pn({line:"line"})],kf.prototype,"type",void 0),_([E(Jg({colorRequiredOnWrite:!0}))],kf.prototype,"color",void 0),_([E({...Rd,json:{write:{isRequired:!0}}})],kf.prototype,"size",void 0),_([E({type:SKe,json:{write:!0}})],kf.prototype,"border",void 0),_([E({readOnly:!0})],kf.prototype,"visible",null),kf=b7=_([ue("esri.symbols.callouts.LineCallout3D")],kf);function YB(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function Kye(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!YB(t)}function t3t(t){return t.type==="point-3d"||t.type==="label-3d"}function n3t(t){return t.horizontalAlignment==="center"}const Yye={types:{key:"type",base:_x,typeMap:{line:kf}},json:{write:!0}};var E7;let Fm=E7=class extends qt{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new E7({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};_([E({...Rd,json:{write:{isRequired:!0}}})],Fm.prototype,"screenLength",void 0),_([E({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Fm.prototype,"minWorldLength",void 0),_([E({type:Number,json:{write:!0}})],Fm.prototype,"maxWorldLength",void 0),Fm=E7=_([ue("esri.symbols.support.Symbol3DVerticalOffset")],Fm);var RM;const Xye=Ot.ofType({base:null,key:"type",typeMap:{text:vs}});let Kh=RM=class extends il{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new Xye,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Kye(this)}hasVisibleVerticalOffset(){return YB(this)}clone(){return new RM({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail),callout:Ze(this.callout),verticalOffset:Ze(this.verticalOffset)})}static fromTextSymbol(t){return new RM({symbolLayers:new Ot([vs.fromTextSymbol(t)])})}};_([E({type:Fm,json:{write:!0}})],Kh.prototype,"verticalOffset",void 0),_([E(Yye)],Kh.prototype,"callout",void 0),_([E({json:{read:!1,write:!1}})],Kh.prototype,"styleOrigin",void 0),_([E({type:Xye})],Kh.prototype,"symbolLayers",void 0),_([pn({LabelSymbol3D:"label-3d"},{readOnly:!0})],Kh.prototype,"type",void 0),Kh=RM=_([ue("esri.symbols.LabelSymbol3D")],Kh);var PM;const Zye=Ot.ofType({base:null,key:"type",typeMap:{line:rl,path:wo}}),TKe=Ot.ofType({base:null,key:"type",typeMap:{line:rl,path:wo}});let Qm=PM=class extends il{constructor(t){super(t),this.symbolLayers=new Zye,this.type="line-3d"}clone(){return new PM({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleLineSymbol(t){return new PM({symbolLayers:new Ot([rl.fromSimpleLineSymbol(t)])})}};_([E({type:Zye,json:{type:TKe}})],Qm.prototype,"symbolLayers",void 0),_([pn({LineSymbol3D:"line-3d"},{readOnly:!0})],Qm.prototype,"type",void 0),Qm=PM=_([ue("esri.symbols.LineSymbol3D")],Qm);var CM;const Jye=Ot.ofType({base:null,key:"type",typeMap:{fill:Wl}});let Ny=CM=class extends il{constructor(t){super(t),this.symbolLayers=new Jye,this.type="mesh-3d"}clone(){return new CM({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleFillSymbol(t){return new CM({symbolLayers:new Ot([Wl.fromSimpleFillSymbol(t)])})}};_([E({type:Jye})],Ny.prototype,"symbolLayers",void 0),_([pn({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Ny.prototype,"type",void 0),Ny=CM=_([ue("esri.symbols.MeshSymbol3D")],Ny);let mS=class extends us{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};_([pn({esriSLS:"simple-line"},{readOnly:!0})],mS.prototype,"type",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],mS.prototype,"width",void 0),mS=_([ue("esri.symbols.LineSymbol")],mS);var S7;let Vh=S7=class extends qt{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,n,r){e[n]=r?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,n,r){r?.origin==="web-map"||(e[n]=t)}clone(){return new S7({color:Ze(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};_([E({type:["begin","end","begin-end"],json:{write:!0}})],Vh.prototype,"placement",void 0),_([pn({"line-marker":"line-marker"},{readOnly:!0}),E({json:{origins:{"web-map":{write:!1}}}})],Vh.prototype,"type",void 0),_([E({type:Gye})],Vh.prototype,"style",void 0),_([Xn("style")],Vh.prototype,"writeStyle",null),_([E({type:Kn,value:null,json:{write:{allowNull:!0}}})],Vh.prototype,"color",null),_([or("color")],Vh.prototype,"readColor",null),_([Xn("color")],Vh.prototype,"writeColor",null),Vh=S7=_([ue("esri.symbols.LineSymbolMarker")],Vh);const kKe=Vh;var T7;const P$=new Gs({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Sa=T7=class extends mS{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,n,r,i,s){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),n!=null&&(o.width=bi(n)),r!=null&&(o.cap=r),i!=null&&(o.join=i),s!=null&&(o.miterLimit=bi(s)),o}clone(){return new T7({color:Ze(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};_([pn({esriSLS:"simple-line"},{readOnly:!0})],Sa.prototype,"type",void 0),_([E({type:P$.apiValues,json:{read:P$.read,write:P$.write}})],Sa.prototype,"style",void 0),_([E({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,n)=>({enabled:t!=="round"&&n?.origin==null})}}})],Sa.prototype,"cap",void 0),_([E({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,n)=>({enabled:t!=="round"&&n?.origin==null})}}})],Sa.prototype,"join",void 0),_([E({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":kKe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Sa.prototype,"marker",void 0),_([E({type:Number,json:{read:!1,write:!1}})],Sa.prototype,"miterLimit",void 0),Sa=T7=_([ue("esri.symbols.SimpleLineSymbol")],Sa);let xx=class extends us{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};_([E({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Sa}},json:{default:null,write:!0}})],xx.prototype,"outline",void 0),_([E({type:["simple-fill","picture-fill"],readOnly:!0})],xx.prototype,"type",void 0),xx=_([ue("esri.symbols.FillSymbol")],xx);function AKe(t,e,n){return e.imageData?Tde({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):Qye(e.url,n)}function Qye(t,e){if(!vl(t)){const n=RKe(e);if(n)return YA(n,"images",t)}return W2(t,e)}function IKe(t,e,n,r){if(nv(t)){const i=t2(t);if(!i)return;e.contentType=i.mediaType,e.imageData=i.data,n&&n.imageData===e.imageData&&n.url&&r2(n.url,e,"url",r)}else r2(t,e,"url",r)}const e1e={json:{read:{source:["imageData","url"],reader:AKe},write:{writer(t,e,n,r){IKe(t,e,this.source,r)}}}},t1e={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,n){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=Qye(e.url,n)),r}}}};function RKe(t){if(!t)return null;const{origin:e,layer:n}=t;if(e!=="service"&&e!=="portal-item")return null;const r=n?.type;return r==="feature"||r==="stream"?n.parsedUrl?.path:r==="map-image"||r==="tile"?t.url?.path:null}var k7;let Ja=k7=class extends xx{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,n,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e&&(i.outline=e),n!=null&&(i.width=bi(n)),r!=null&&(i.height=bi(r)),i}clone(){const t=new k7({color:Ze(this.color),height:this.height,outline:Ze(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",Ze(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};_([pn({esriPFS:"picture-fill"},{readOnly:!0})],Ja.prototype,"type",void 0),_([E(e1e)],Ja.prototype,"url",void 0),_([E({type:Number,json:{write:!0}})],Ja.prototype,"xscale",void 0),_([E({type:Number,json:{write:!0}})],Ja.prototype,"yscale",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Ja.prototype,"width",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Ja.prototype,"height",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Ja.prototype,"xoffset",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Ja.prototype,"yoffset",void 0),_([E(t1e)],Ja.prototype,"source",void 0),Ja=k7=_([ue("esri.symbols.PictureFillSymbol")],Ja);let Af=class extends us{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};_([E({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Af.prototype,"angle",void 0),_([E({type:["simple-marker","picture-marker"],readOnly:!0})],Af.prototype,"type",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Af.prototype,"xoffset",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Af.prototype,"yoffset",void 0),_([E({cast:t=>t==="auto"?t:Zl(bi(t)),json:{write:!0}})],Af.prototype,"size",void 0),Af=_([ue("esri.symbols.MarkerSymbol")],Af);var A7;let tl=A7=class extends Af{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=bi(e)),n!=null&&(r.height=bi(n)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new A7({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",Ze(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};_([E({json:{write:!1}})],tl.prototype,"color",void 0),_([pn({esriPMS:"picture-marker"},{readOnly:!0})],tl.prototype,"type",void 0),_([E(e1e)],tl.prototype,"url",void 0),_([E(t1e)],tl.prototype,"source",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],tl.prototype,"height",void 0),_([or("height",["height","size"])],tl.prototype,"readHeight",null),_([E({type:Number,cast:bi,json:{write:!0}})],tl.prototype,"width",void 0),_([E({json:{write:!1}})],tl.prototype,"size",void 0),tl=A7=_([ue("esri.symbols.PictureMarkerSymbol")],tl);var Q0;const n1e=Ot.ofType({base:null,key:"type",typeMap:{icon:Js,object:Zs,text:vs}});let Zh=Q0=class extends il{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new n1e,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Kye(this)}hasVisibleVerticalOffset(){return YB(this)}clone(){return new Q0({verticalOffset:Ze(this.verticalOffset),callout:Ze(this.callout),styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Q0({symbolLayers:new Ot([Js.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Q0({symbolLayers:new Ot([Js.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const n=t.data.symbol;return new Q0(n?.callout?{symbolLayers:new Ot([Js.fromCIMSymbol(t)]),callout:new kf({size:.5,color:new Kn([0,0,0])}),verticalOffset:new Fm({screenLength:40})}:{symbolLayers:new Ot([Js.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Q0({symbolLayers:new Ot([vs.fromTextSymbol(t)])})}};_([E({type:Fm,json:{write:!0}})],Zh.prototype,"verticalOffset",void 0),_([E(Yye)],Zh.prototype,"callout",void 0),_([E({type:n1e,json:{origins:{"web-scene":{write:!0}}}})],Zh.prototype,"symbolLayers",void 0),_([pn({PointSymbol3D:"point-3d"},{readOnly:!0})],Zh.prototype,"type",void 0),Zh=Q0=_([ue("esri.symbols.PointSymbol3D")],Zh);var gS;const r1e=Ot.ofType({base:null,key:"type",typeMap:{extrude:Sf,fill:Wl,icon:Js,line:rl,object:Zs,text:vs,water:Tf}});let eg=gS=class extends il{constructor(t){super(t),this.symbolLayers=new r1e,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&Pg(Tt.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&Pg(Tt.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles($1(()=>this.symbolLayers,"after-add",({item:e})=>t(e),Dg))}clone(){return new gS({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromJSON(t){const e=new gS;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const n=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(n.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new gS({symbolLayers:new Ot([Wl.fromSimpleFillSymbol(t)])})}};_([E({type:r1e,json:{write:!0}})],eg.prototype,"symbolLayers",void 0),_([pn({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],eg.prototype,"type",void 0),eg=gS=_([ue("esri.symbols.PolygonSymbol3D")],eg);var I7;const C$=new Gs({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Of=I7=class extends xx{constructor(...t){super(...t),this.color=new Kn([0,0,0,.25]),this.outline=new Sa,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),n&&(r.color=n),r}clone(){return new I7({color:Ze(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};_([E()],Of.prototype,"color",void 0),_([E()],Of.prototype,"outline",void 0),_([pn({esriSFS:"simple-fill"},{readOnly:!0})],Of.prototype,"type",void 0),_([E({type:C$.apiValues,json:{read:C$.read,write:C$.write}})],Of.prototype,"style",void 0),Of=I7=_([ue("esri.symbols.SimpleFillSymbol")],Of);var R7;const M$=new Gs({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Gl=R7=class extends Af{constructor(...t){super(...t),this.color=new Kn([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Sa}normalizeCtorArgs(t,e,n,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e!=null&&(i.size=bi(e)),n&&(i.outline=n),r&&(i.color=r),i}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new R7({angle:this.angle,color:Ze(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};_([E()],Gl.prototype,"color",void 0),_([Xn("color")],Gl.prototype,"writeColor",null),_([pn({esriSMS:"simple-marker"},{readOnly:!0})],Gl.prototype,"type",void 0),_([E()],Gl.prototype,"size",void 0),_([E({type:M$.apiValues,json:{read:M$.read,write:M$.write}})],Gl.prototype,"style",void 0),_([E({type:String,json:{write:!0}})],Gl.prototype,"path",null),_([E({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Sa}},json:{default:null,write:!0}})],Gl.prototype,"outline",void 0),Gl=R7=_([ue("esri.symbols.SimpleMarkerSymbol")],Gl);var P7;let Hr=P7=class extends us{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new $c,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),n&&(r.color=n),r}writeLineWidth(t,e,n,r){r&&typeof r!="string"?r.origin:e[n]=t}castLineWidth(t){return bi(t)}writeLineHeight(t,e,n,r){r&&typeof r!="string"?r.origin:e[n]=t}clone(){return new P7({angle:this.angle,backgroundColor:Ze(this.backgroundColor),borderLineColor:Ze(this.borderLineColor),borderLineSize:this.borderLineSize,color:Ze(this.color),font:this.font&&this.font.clone(),haloColor:Ze(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};_([E({type:Kn,json:{write:!0}})],Hr.prototype,"backgroundColor",void 0),_([E({type:Kn,json:{write:!0}})],Hr.prototype,"borderLineColor",void 0),_([E({type:Number,json:{write:!0},cast:bi})],Hr.prototype,"borderLineSize",void 0),_([E({type:$c,json:{write:!0}})],Hr.prototype,"font",void 0),_([E({...Wye,json:{write:!0}})],Hr.prototype,"horizontalAlignment",void 0),_([E({type:Boolean,json:{write:!0}})],Hr.prototype,"kerning",void 0),_([E({type:Kn,json:{write:!0}})],Hr.prototype,"haloColor",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Hr.prototype,"haloSize",void 0),_([E({type:Boolean,json:{write:!0}})],Hr.prototype,"rightToLeft",void 0),_([E({type:Boolean,json:{write:!0}})],Hr.prototype,"rotated",void 0),_([E({type:String,json:{write:!0}})],Hr.prototype,"text",void 0),_([pn({esriTS:"text"},{readOnly:!0})],Hr.prototype,"type",void 0),_([E({...Hye,json:{write:!0}})],Hr.prototype,"verticalAlignment",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Hr.prototype,"xoffset",void 0),_([E({type:Number,cast:bi,json:{write:!0}})],Hr.prototype,"yoffset",void 0),_([E({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Hr.prototype,"angle",void 0),_([E({type:Number,json:{write:!0}})],Hr.prototype,"width",void 0),_([E({type:Number})],Hr.prototype,"lineWidth",void 0),_([Xn("lineWidth")],Hr.prototype,"writeLineWidth",null),_([zs("lineWidth")],Hr.prototype,"castLineWidth",null),_([E(Bye)],Hr.prototype,"lineHeight",void 0),_([Xn("lineHeight")],Hr.prototype,"writeLineHeight",null),Hr=P7=_([ue("esri.symbols.TextSymbol")],Hr);var C7;let nl=C7=class extends us{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:it.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new C7({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){Xde(Tt.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new Xe("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,n=e?this._fetchCacheKey:null;if(e!=null){const o=n&&e.get(n);if(o)return o.clone()}const{resolveWebStyleSymbol:r}=await _e(()=>import("./webStyleSymbolUtils-DvphAHGx.js"),__vite__mapDeps([301,302,16,17,18,19,23]));hi(t);const i=r(this,{portal:this.portal},t);i.catch(o=>{Tt.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const s=await i;return e?.set(n,s.clone()),s}};_([E({json:{write:!1}})],nl.prototype,"color",void 0),_([E({type:String,json:{write:!0}})],nl.prototype,"styleName",void 0),_([E({type:it,json:{write:!1}})],nl.prototype,"portal",void 0),_([E({type:String,json:{read:J5,write:r2}})],nl.prototype,"styleUrl",void 0),_([E({type:pT,json:{read:!1}})],nl.prototype,"thumbnail",void 0),_([E({type:String,json:{write:!0}})],nl.prototype,"name",void 0),_([pn({styleSymbolReference:"web-style"},{readOnly:!0})],nl.prototype,"type",void 0),_([E()],nl.prototype,"_fetchCacheKey",null),nl=C7=_([ue("esri.symbols.WebStyleSymbol")],nl);function o3t(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function a3t(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const XB={base:us,key:"type",typeMap:{"simple-fill":Of,"picture-fill":Ja,"picture-marker":tl,"simple-line":Sa,"simple-marker":Gl,text:Hr,"label-3d":Kh,"line-3d":Qm,"mesh-3d":Ny,"point-3d":Zh,"polygon-3d":eg,"web-style":nl,cim:al},errorContext:"symbol"},l3t={base:us,key:"type",typeMap:{"picture-marker":tl,"simple-marker":Gl,"point-3d":Zh,cim:al},errorContext:"symbol"},c3t={base:us,key:"type",typeMap:{"simple-line":Sa,"line-3d":Qm,cim:al},errorContext:"symbol"},u3t={base:us,key:"type",typeMap:{"simple-fill":Of,"picture-fill":Ja,"polygon-3d":eg,cim:al},errorContext:"symbol"},h3t={base:us,key:"type",typeMap:{"picture-marker":tl,"simple-marker":Gl,text:Hr,"web-style":nl,cim:al},errorContext:"symbol"},d3t=$G({types:XB}),f3t={base:us,key:"type",typeMap:{"simple-fill":Of,"picture-fill":Ja,"picture-marker":tl,"simple-line":Sa,"simple-marker":Gl,text:Hr,"line-3d":Qm,"mesh-3d":Ny,"point-3d":Zh,"polygon-3d":eg,"web-style":nl,cim:al},errorContext:"symbol"},p3t={base:us,key:"type",typeMap:{text:Hr,"label-3d":Kh},errorContext:"symbol"},m3t={base:us,key:"type",typeMap:{"line-3d":Qm,"mesh-3d":Ny,"point-3d":Zh,"polygon-3d":eg,"web-style":nl,cim:al},errorContext:"symbol"},g3t={base:us,key:"type",typeMap:{"label-3d":Kh},errorContext:"symbol"},y3t=Mg(XB);var M7;function PKe(t){if(!t)return null;const e={};for(const n in t){const r=m2(t[n]);r&&(e[n]=r)}return Object.keys(e).length!==0?e:null}function CKe(t){if(t==null)return null;const e={};for(const n in t){const r=t[n];r&&(e[n]=r.toJSON())}return Object.keys(e).length!==0?e:null}var Tw;let Yo=(Tw=class extends fo(qt){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:GC(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&L6e(Tt.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const n=this._get("aggregateGeometries");JSON.stringify(n)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const n=this._get("attributes");n!==e&&(this._set("attributes",e),this._notifyLayer("attributes",n,e))}set geometry(e){const n=this._get("geometry");n!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",n,e))}set popupTemplate(e){const n=this._get("popupTemplate");n!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",n,e))}set symbol(e){const n=this._get("symbol");n!==e&&(this._set("symbol",e),this._notifyLayer("symbol",n,e))}get version(){return this._version}set visible(e){const n=this._get("visible");n!==e&&(this._set("visible",e),this._notifyLayer("visible",n,e))}cloneShallow(){return new M7({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const n=Uqe(this.origin);if(n)return n.popupTemplate??(e?n.defaultPopupTemplate:null)??null;const r=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[r,this.sourceLayer,this.layer])if(i&&typeof i=="object"){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(e&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,n){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=n,this._notifyLayer("attributes",r,n,e)}else this.attributes={[e]:n}}getObjectId(){const e=Hte(this.origin);if(e)return qte(this,e);const n=this.sourceLayer??this.layer;return n?qte(this,n):null}getGlobalId(){const e=Hte(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const n=this.sourceLayer??this.layer;return n&&"globalIdField"in n&&n.globalIdField?this.getAttribute(n.globalIdField):null}toJSON(){return{aggregateGeometries:CKe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:Q3(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:n}=this;if(n?.type==="mesh"){const r={origin:n.origin,transform:n.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,n,r,i){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:n,newValue:r};e==="origin-transform"&&(s.action=i),e==="attributes"&&(s.attributeName=i),this.layer.graphicChanged(s)}_watchMeshGeometryChanges(){this.addHandles([hc(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:n})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===n||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=n,this.notifyMeshTransformChanged())}),hc(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,n)=>e===n,sync:!0})])}},M7=Tw,Tw);_([E({value:null,json:{read:PKe}})],Yo.prototype,"aggregateGeometries",null),_([E({value:null})],Yo.prototype,"attributes",null),_([E({value:null,types:NB,json:{read:m2}})],Yo.prototype,"geometry",null),_([E({type:Boolean})],Yo.prototype,"isAggregate",void 0),_([E({clonable:!1})],Yo.prototype,"layer",void 0),_([E({clonable:"reference"})],Yo.prototype,"origin",void 0),_([E({type:Fqe,value:null})],Yo.prototype,"popupTemplate",null),_([E({clonable:"reference"})],Yo.prototype,"sourceLayer",void 0),_([E({value:null,types:XB})],Yo.prototype,"symbol",null),_([E({clonable:!1,json:{read:!1,write:!1}})],Yo.prototype,"_version",void 0),_([E({type:Boolean,value:!0})],Yo.prototype,"visible",null),Yo=M7=_([ue("esri.Graphic")],Yo);let mT=class extends oT{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};_([Ofe({Type:Yo,ensureType:Va(Yo)})],mT.prototype,"itemType",void 0),mT=_([ue("esri.support.GraphicsCollection")],mT);let yf=class extends Kt{constructor(e){super(e),this.view=null,this.baseLayerViews=new Ot,this.groundLayerViews=new Ot,this.referenceLayerViews=new Ot,this._loadingHandle=dn(()=>this.view?.map?.basemap,n=>{n&&n.load().catch(()=>{})},fa)}destroy(){this._set("view",null),this._loadingHandle=Qr(this._loadingHandle),this.baseLayerViews.destroyAll(),this.groundLayerViews.destroyAll(),this.referenceLayerViews.destroyAll()}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.groundLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};_([E({constructOnly:!0})],yf.prototype,"view",void 0),_([E({readOnly:!0})],yf.prototype,"baseLayerViews",void 0),_([E({readOnly:!0})],yf.prototype,"groundLayerViews",void 0),_([E({readOnly:!0})],yf.prototype,"referenceLayerViews",void 0),_([E({readOnly:!0})],yf.prototype,"suspended",null),_([E({type:Boolean,readOnly:!0})],yf.prototype,"updating",null),yf=_([ue("esri.views.BasemapView")],yf);const MKe=yf;let Vl=class extends Kt{constructor(e){super(e),this.factor=1.5,this.offset=Fs(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};_([E({type:Number})],Vl.prototype,"factor",void 0),_([E({nonNullable:!0})],Vl.prototype,"offset",void 0),_([E()],Vl.prototype,"position",void 0),_([E({type:Number,range:{min:0}})],Vl.prototype,"size",void 0),_([E()],Vl.prototype,"maskUrl",void 0),_([E()],Vl.prototype,"maskEnabled",void 0),_([E()],Vl.prototype,"overlayUrl",void 0),_([E()],Vl.prototype,"overlayEnabled",void 0),_([E({readOnly:!0})],Vl.prototype,"version",null),_([E({type:Boolean})],Vl.prototype,"visible",void 0),Vl=_([ue("esri.views.Magnifier")],Vl);const i1e=Vl;let iw=class{constructor(e){this._observable=new rI,this._map=new Map(e)}get size(){return tn(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const n=this._map.delete(e);return n&&this._observable.notify(),n}entries(){return tn(this._observable),this._map.entries()}forEach(e,n){tn(this._observable),this._map.forEach((r,i)=>e.call(n,r,i,this),n)}get(e){return tn(this._observable),this._map.get(e)}has(e){return tn(this._observable),this._map.has(e)}keys(){return tn(this._observable),this._map.keys()}set(e,n){return this._map.set(e,n),this._observable.notify(),this}values(){return tn(this._observable),this._map.values()}[Symbol.iterator](){return tn(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var N7;let yS=N7=class extends qt{constructor(t){super(t),this.name=null,this.code=null}clone(){return new N7({name:this.name,code:this.code})}};_([E({type:String,json:{write:{isRequired:!0}}})],yS.prototype,"name",void 0),_([E({type:[String,Number],json:{write:{isRequired:!0}}})],yS.prototype,"code",void 0),yS=N7=_([ue("esri.layers.support.CodedValue")],yS);const NKe=new Gs({inherited:"inherited",codedValue:"coded-value",range:"range"});let tg=class extends qt{constructor(e){super(e),this.name=null,this.type=null}};_([E({type:String,json:{write:!0}})],tg.prototype,"name",void 0),_([pn(NKe),E({json:{write:{isRequired:!0}}})],tg.prototype,"type",void 0),tg=_([ue("esri.layers.support.Domain")],tg);var O7,kw;let wx=(kw=class extends tg{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let n=null;if(this.codedValues){const r=String(e);this.codedValues.some(i=>(String(i.code)===r&&(n=i.name),!!n))}return n}clone(){return new O7({codedValues:Ze(this.codedValues),name:this.name})}},O7=kw,kw);_([E({type:[yS],json:{write:{isRequired:!0}}})],wx.prototype,"codedValues",void 0),_([pn({codedValue:"coded-value"})],wx.prototype,"type",void 0),wx=O7=_([ue("esri.layers.support.CodedValueDomain")],wx);var L7,Aw;let gT=(Aw=class extends tg{constructor(e){super(e),this.type="inherited"}clone(){return new L7}},L7=Aw,Aw);_([pn({inherited:"inherited"})],gT.prototype,"type",void 0),gT=L7=_([ue("esri.layers.support.InheritedDomain")],gT);var D7,Iw;let yy=(Iw=class extends tg{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new D7({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},D7=Iw,Iw);_([E({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,n){e[n]=[this.minValue||0,t]},isRequired:!0}}})],yy.prototype,"maxValue",void 0),_([E({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,n){e[n]=[t,this.maxValue||0]},isRequired:!0}}})],yy.prototype,"minValue",void 0),_([pn({range:"range"})],yy.prototype,"type",void 0),yy=D7=_([ue("esri.layers.support.RangeDomain")],yy);const OKe={key:"type",base:tg,typeMap:{range:yy,"coded-value":wx,inherited:gT}};function LKe(t){if(!t?.type)return null;switch(t.type){case"range":return yy.fromJSON(t);case"codedValue":return wx.fromJSON(t);case"inherited":return gT.fromJSON(t)}return null}const DKe=new Gs({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var $7;const $Ke=new Gs({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var Rw;let Wo=(Rw=class extends qt{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:n}){let r=null;try{r=n?JSON.parse(n):null}catch{}return r?.value??null}readValueType(e,{description:n}){let r=null;try{r=n?JSON.parse(n):null}catch{}return r?$Ke.fromJSON(r.fieldValueType):null}clone(){return new $7({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},$7=Rw,Rw);_([E({type:String,json:{write:!0}})],Wo.prototype,"alias",void 0),_([E({type:[String,Number],json:{write:{allowNull:!0}}})],Wo.prototype,"defaultValue",void 0),_([E()],Wo.prototype,"description",void 0),_([or("description")],Wo.prototype,"readDescription",null),_([E({types:OKe,json:{read:{reader:LKe},write:!0}})],Wo.prototype,"domain",void 0),_([E({type:Boolean,json:{write:!0}})],Wo.prototype,"editable",void 0),_([E({type:Or,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Wo.prototype,"length",void 0),_([E({type:String,json:{write:!0}})],Wo.prototype,"name",void 0),_([E({type:Boolean,json:{write:!0}})],Wo.prototype,"nullable",void 0),_([pn(DKe)],Wo.prototype,"type",void 0),_([E()],Wo.prototype,"valueType",void 0),_([or("valueType",["description"])],Wo.prototype,"readValueType",null),_([E({type:Boolean,json:{read:!1}})],Wo.prototype,"visible",void 0),Wo=$7=_([ue("esri.layers.support.Field")],Wo);var j7;let q_=j7=class extends qt{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new j7({mapLayerId:t,gdbVersion:e})}};_([pn({mapLayer:"map-layer"}),E({json:{write:{isRequired:!0}}})],q_.prototype,"type",void 0),_([E({type:Or,json:{write:{isRequired:!0}}})],q_.prototype,"mapLayerId",void 0),_([E({type:String,json:{write:!0}})],q_.prototype,"gdbVersion",void 0),q_=j7=_([ue("esri.layers.support.source.MapLayerSource")],q_);var F7;let vf=F7=class extends qt{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:n,spatialReference:r,geometryType:i}=this,s={workspaceId:t,query:e,oidFields:n,spatialReference:r?.clone()??void 0,geometryType:i};return new F7(s)}};_([pn({queryTable:"query-table"}),E({json:{write:{isRequired:!0}}})],vf.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],vf.prototype,"workspaceId",void 0),_([E({type:String,json:{write:!0}})],vf.prototype,"query",void 0),_([E({type:String,json:{write:!0}})],vf.prototype,"oidFields",void 0),_([E({type:Bt,json:{write:!0}})],vf.prototype,"spatialReference",void 0),_([pn(yBe)],vf.prototype,"geometryType",void 0),vf=F7=_([ue("esri.layers.support.source.QueryTableDataSource")],vf);var V7;let K_=V7=class extends qt{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new V7({workspaceId:t,dataSourceName:e})}};_([pn({raster:"raster"}),E({json:{write:{isRequired:!0}}})],K_.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],K_.prototype,"dataSourceName",void 0),_([E({type:String,json:{write:!0}})],K_.prototype,"workspaceId",void 0),K_=V7=_([ue("esri.layers.support.source.RasterDataSource")],K_);var z7;let ey=z7=class extends qt{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:n}=this;return new z7({workspaceId:t,gdbVersion:e,dataSourceName:n})}};_([pn({table:"table"}),E({json:{write:{isRequired:!0}}})],ey.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],ey.prototype,"workspaceId",void 0),_([E({type:String,json:{write:!0}})],ey.prototype,"gdbVersion",void 0),_([E({type:String,json:{write:!0}})],ey.prototype,"dataSourceName",void 0),ey=z7=_([ue("esri.layers.support.source.TableDataSource")],ey);var U7,G7;const jKe=kl()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let zl=U7=class extends qt{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,n){return Jte()(t,e,n)}castLeftTableSource(t){return Mg(B7(),t)}readRightTableSource(t,e,n){return Jte()(t,e,n)}castRightTableSource(t){return Mg(B7(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:n,rightTableSource:r,joinType:i}=this,s={leftTableKey:t,rightTableKey:e,leftTableSource:n?.clone()??void 0,rightTableSource:r?.clone()??void 0,joinType:i};return new U7(s)}};_([pn({joinTable:"join-table"}),E({json:{write:{isRequired:!0}}})],zl.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],zl.prototype,"leftTableKey",void 0),_([E({type:String,json:{write:!0}})],zl.prototype,"rightTableKey",void 0),_([E({json:{write:!0}})],zl.prototype,"leftTableSource",void 0),_([or("leftTableSource")],zl.prototype,"readLeftTableSource",null),_([zs("leftTableSource")],zl.prototype,"castLeftTableSource",null),_([E({json:{write:!0}})],zl.prototype,"rightTableSource",void 0),_([or("rightTableSource")],zl.prototype,"readRightTableSource",null),_([zs("rightTableSource")],zl.prototype,"castRightTableSource",null),_([pn(jKe)],zl.prototype,"joinType",void 0),zl=U7=_([ue("esri.layers.support.source.JoinTableDataSource")],zl);let N$=null;function Jte(){return N$||(N$=$G({types:B7()})),N$}let O$=null;function B7(){return O$||(O$={key:"type",base:null,typeMap:{"data-layer":If,"map-layer":q_}}),O$}const FKe={key:"type",base:null,typeMap:{"join-table":zl,"query-table":vf,raster:K_,table:ey}};var Pw;let If=(Pw=class extends qt{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:n}=this;return new G7({fields:e,dataSource:n})}},G7=Pw,Pw);_([pn({dataLayer:"data-layer"}),E({json:{write:{isRequired:!0}}})],If.prototype,"type",void 0),_([E({type:[Wo],json:{write:!0}})],If.prototype,"fields",void 0),_([E({types:FKe,json:{write:!0}})],If.prototype,"dataSource",void 0),If=G7=_([ue("esri.layers.support.source.DataLayerSource")],If),If.from=Va(If);let ty=class extends fo(qt){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};_([E({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],ty.prototype,"onFields",void 0),_([E({type:String,json:{write:!0}})],ty.prototype,"operator",void 0),_([E({type:String,json:{write:!0}})],ty.prototype,"searchTerm",void 0),_([E({type:String,json:{write:!0}})],ty.prototype,"searchType",void 0),ty=_([ue("esri.rest.support.FullTextSearch")],ty);const VKe=ty;var W7;const Qte=new Gs({upperLeft:"upper-left",lowerLeft:"lower-left"});let Mm=W7=class extends qt{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new W7(Ze({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};_([E({type:Dn,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Mm.prototype,"extent",void 0),_([E({type:["view","edit"],json:{write:!0}})],Mm.prototype,"mode",void 0),_([E({type:String,json:{read:Qte.read,write:Qte.write}})],Mm.prototype,"originPosition",void 0),_([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Mm.prototype,"tolerance",void 0),Mm=W7=_([ue("esri.rest.support.QuantizationParameters")],Mm);const zKe=t=>{const e=t;let n=class extends e{};return n=_([ue("esri.rest.support.QueryMixin")],n),n},UKe=new Gs({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var H7;const ene=new Gs({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let $u=H7=class extends qt{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=Ze(t))}clone(){return new H7({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Ze(this.statisticParameters)})}};_([E({type:Number,json:{write:!0}})],$u.prototype,"maxPointCount",void 0),_([E({type:Number,json:{write:!0}})],$u.prototype,"maxRecordCount",void 0),_([E({type:Number,json:{write:!0}})],$u.prototype,"maxVertexCount",void 0),_([E({type:String,json:{write:!0}})],$u.prototype,"onStatisticField",void 0),_([E({type:String,json:{write:!0}})],$u.prototype,"outStatisticFieldName",void 0),_([E({type:String,json:{read:{source:"statisticType",reader:ene.read},write:{target:"statisticType",writer:ene.write}}})],$u.prototype,"statisticType",void 0),_([E({type:Object})],$u.prototype,"statisticParameters",void 0),_([Xn("statisticParameters")],$u.prototype,"writeStatisticParameters",null),$u=H7=_([ue("esri.rest.support.StatisticDefinition")],$u);var MM;const GKe=new Gs({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var s1;let en=(s1=class extends zKe(qt){static from(e){return nO(MM,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,n){n.historicMoment=e&&e.getTime()}writeParameterValues(e,n){if(e){const r={};for(const i in e){const s=e[i];Array.isArray(s)?r[i]=s.map(o=>o instanceof Date?o.getTime():o):s instanceof Date?r[i]=s.getTime():r[i]=s}n.parameterValues=r}}writeStart(e,n){n.resultOffset=this.start,n.resultRecordCount=this.num||10,n.where="1=1"}writeWhere(e,n){n.where=e||"1=1"}clone(){return new MM(Ze({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},MM=s1,s1.MAX_MAX_RECORD_COUNT_FACTOR=5,s1);_([E({json:{write:!0}})],en.prototype,"aggregateIds",void 0),_([E({type:Boolean,json:{write:!0}})],en.prototype,"cacheHint",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"compactGeometryEnabled",void 0),_([E({json:{write:!0}})],en.prototype,"datumTransformation",void 0),_([zs("datumTransformation")],en.prototype,"castDatumTransformation",null),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"defaultSpatialReferenceEnabled",void 0),_([E({type:Number,json:{write:!0}})],en.prototype,"distance",void 0),_([E({type:If,json:{write:!0}})],en.prototype,"dynamicDataSource",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"formatOf3DObjects",void 0),_([E({type:[VKe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],en.prototype,"fullText",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"gdbVersion",void 0),_([E({types:NB,json:{read:m2,write:!0}})],en.prototype,"geometry",void 0),_([E({type:Number,json:{write:!0}})],en.prototype,"geometryPrecision",void 0),_([E({type:[String],json:{write:!0}})],en.prototype,"groupByFieldsForStatistics",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"having",void 0),_([E({type:Date})],en.prototype,"historicMoment",void 0),_([Xn("historicMoment")],en.prototype,"writeHistoricMoment",null),_([E({type:Number,json:{write:!0}})],en.prototype,"maxAllowableOffset",void 0),_([E({type:Number,cast:t=>t<1?1:t>en.MAX_MAX_RECORD_COUNT_FACTOR?en.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],en.prototype,"maxRecordCountFactor",void 0),_([E({type:["xyFootprint"],json:{write:!0}})],en.prototype,"multipatchOption",void 0),_([E({type:Number,json:{read:{source:"resultRecordCount"}}})],en.prototype,"num",void 0),_([E({json:{write:!0}})],en.prototype,"objectIds",void 0),_([E({type:[String],json:{write:!0}})],en.prototype,"orderByFields",void 0),_([E({type:[String],json:{write:!0}})],en.prototype,"outFields",void 0),_([E({type:Bt,json:{name:"outSR",write:!0}})],en.prototype,"outSpatialReference",void 0),_([E({type:[$u],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],en.prototype,"outStatistics",void 0),_([E({json:{write:!0}})],en.prototype,"parameterValues",void 0),_([Xn("parameterValues")],en.prototype,"writeParameterValues",null),_([E({type:Jt,json:{write:!0}})],en.prototype,"pixelSize",void 0),_([E({type:Mm,json:{write:!0}})],en.prototype,"quantizationParameters",void 0),_([E({type:[Object],json:{write:!0}})],en.prototype,"rangeValues",void 0),_([E({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],en.prototype,"relationParameter",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"resultType",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnCentroid",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnDistinctValues",void 0),_([E({type:Boolean,json:{default:!0,write:!0}})],en.prototype,"returnExceededLimitFeatures",void 0),_([E({type:Boolean,json:{write:!0}})],en.prototype,"returnGeometry",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnQueryGeometry",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnM",void 0),_([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],en.prototype,"returnZ",void 0),_([E({type:Boolean,json:{write:!0}})],en.prototype,"returnTrueCurves",void 0),_([E({type:Bt,json:{write:!0}})],en.prototype,"sourceSpatialReference",void 0),_([pn(UKe,{ignoreUnknown:!1,name:"spatialRel"})],en.prototype,"spatialRelationship",void 0),_([E({type:Number,json:{read:{source:"resultOffset"}}})],en.prototype,"start",void 0),_([Xn("start"),Xn("num")],en.prototype,"writeStart",null),_([E({type:String,json:{write:!0}})],en.prototype,"sqlFormat",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"text",void 0),_([E({type:Ea,json:{write:!0}})],en.prototype,"timeExtent",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"timeReferenceUnknownClient",void 0),_([pn(GKe,{ignoreUnknown:!1}),E({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],en.prototype,"units",void 0),_([E({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],en.prototype,"where",void 0),_([Xn("where")],en.prototype,"writeWhere",null),en=MM=_([ue("esri.rest.support.Query")],en);function um(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let Mc=class extends nI{constructor(e){super(e),this._selectionMap=new iw,this._sources=new Ot,this._trashCan=[],this._layerEditHandles=new Ot,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([dn(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),dn(()=>this.view,e=>{e?.when().then(()=>this.syncSources())},fa),$1(()=>this.sources,"change",e=>{const n=this._selectionMap,r=[];for(const i of e.removed){const s=n.get(i);s&&(n.delete(i),s.highlightHandle?.remove(),r.push({layer:i,selection:[],added:[],removed:[...s.selection]}))}this._refreshListeners(),r.length&&this._onSelectionChange(r)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(Qr)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[n,r]=e;return{layer:n,selection:[...r.selection]}})}get count(){let e=0;for(const n of this._selectionMap.values())e+=n.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){pd(e,this._sources)}syncSources(){const e=new Set,n=this.view?.map;if(!n)return;const r=i=>{$7e(i)?(i.layers?.forEach(r),i.tables?.forEach(r)):D7e(i)?(i.sublayers?.forEach(r),i.subtables?.forEach(r)):jee(i)?i.sublayers?.forEach(r):um(i)&&e.add(i)};n.allLayers.forEach(r),n.allTables.forEach(r),this.sources=[...e]}async getSelectedFeatures(e,n={},r="layerView"){const{view:i,selections:s}=this;if(!i&&r==="layerView")return Tt.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?s.filter(a=>e.includes(a.layer)):s).map(async a=>{const{layer:l,selection:c}=a;if(!c.length)return;const u=j_(l)?l.parent:l;if(u!=null){if(i&&r==="layerView"&&!tne(u)&&nne(u)){const h=await i.whenLayerView(u).catch(()=>null);if(h)return rne(h,c,n)}return rne(u,c,n)}}).filter(e2);return(await Promise.all(o)).filter(e2)}updateSelection(e){const n=new Map;for(const[s,o]of this._selectionMap)n.set(s,[...o.selection]);let r=!1;const i=e.current.concat(e.added);for(const s of i){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(um(o)||j_(o))&&a!==null){const l=ZA(n,o,()=>[]);l.includes(a)||(l.push(a),r=!0)}}for(const s of e.removed){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(um(o)||j_(o))&&a!==null){const l=n.get(o),c=l?.indexOf(a);c!==void 0&&c>=0&&(l?.splice(c,1),r=!0)}}if(r){const{_selectionMap:s,_trashCan:o}=this,a=[];for(const[l,c]of n){const u=s.get(l);u!==void 0&&o.push(u),s.set(l,{selection:c}),a.push({layer:l,selection:c,...qJ(u!==void 0?u.selection:[],c)})}this._onSelectionChange(a)}}setSelection(e,n){this._setSelection(e,n)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,n){const r=this._selectionMap.get(e),i=r!==void 0?[...r.selection]:[];for(const s of n)i.includes(s)||i.push(s);this._setSelection(e,i)}removeFromSelection(e,n){const r=this._selectionMap.get(e);if(!r)return;const i=[];for(const s of r.selection)n.includes(s)||i.push(s);this._setSelection(e,i)}toggleInSelection(e,n){const r=this._selectionMap.get(e);if(!r||r.selection.length===0)return void this._setSelection(e,n);const i=new Set(r.selection),s=new Set(n),o=_$e(i,s);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const n=[];for(const[r,i]of this._selectionMap.entries())n.push({layer:r,added:[],removed:[...i.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(n)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:n,_selectionMap:r,showHighlight:i}=this,s=this._vizTaskId;for(const o of e){const a=r.get(o),l=j_(o)?o.parent:o;if(l!=null&&nne(l)){if(tne(l))continue;n.whenLayerView(l).then(c=>{a?.highlightHandle?.remove(),a!=null&&i&&s===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&a.selection.length>0&&(a.highlightHandle=c.highlight(a.selection,this.highlightName))}).catch(()=>{a?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(Qr);const e=new Set(this.sources.map(n=>j_(n)?n.parent:n));for(const n of e)um(n)&&"on"in n&&n.on&&this._layerEditHandles.push(n.on("edits",r=>this._onLayerEdit(r,n)))}_onLayerEdit(e,n){if(jee(n))this._onParentLayerEdit(e,n);else if(e.deletedFeatures.length&&this._selectionMap.has(n)){const r=[];e.deletedFeatures.forEach(({error:i,objectId:s})=>{s!=null&&i==null&&r.push(s)}),this.removeFromSelection(n,r)}}_onParentLayerEdit(e,n){const{deletedFeatures:r,edits:i,updatedFeatures:s}=e;if(i?.updateFeatures?.forEach(o=>{const a=o.getObjectId()??o.attributes[n.objectIdField];if(a==null||s.find(u=>u.objectId===a)?.error)return;const l=n.findSublayerForFeature(o);if(!um(l))return;const c=n.sublayers.find(u=>!(!um(u)||!this.getSelection(u)?.includes(a)));um(c)&&c!==l&&(this.removeFromSelection(c,[a]),this.appendToSelection(l,[a]))}),r.length){const o=[];r.forEach(({error:a,objectId:l})=>{l!=null&&a==null&&o.push(l)}),n.sublayers.forEach(a=>{um(a)&&this._selectionMap.has(a)&&this.removeFromSelection(a,o)})}}_setSelection(e,n){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const r=this._selectionMap.get(e);if(r===void 0||!WKe(r,{selection:n})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(e,{selection:[...n]});const i={layer:e,selection:[...n],...qJ(r!==void 0?r.selection:[],n)};this._onSelectionChange([i])}}};_([E()],Mc.prototype,"_selectionMap",void 0),_([E()],Mc.prototype,"_sources",void 0),_([E({readOnly:!0,nonNullable:!0})],Mc.prototype,"selections",null),_([E({readOnly:!0,nonNullable:!0})],Mc.prototype,"count",null),_([E()],Mc.prototype,"view",void 0),_([E({readOnly:!0,nonNullable:!0})],Mc.prototype,"hasSelection",null),_([E()],Mc.prototype,"showHighlight",void 0),_([E()],Mc.prototype,"sources",null),_([E()],Mc.prototype,"highlightName",void 0),Mc=_([ue("esri.views.SelectionManager")],Mc);const tne=t=>j_(t)?t.parent?.isTable===!0:t.isTable,BKe=t=>t.layer!==void 0,nne=t=>t?.when!==void 0,WKe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const n=[...t.selection],r=[...e.selection];if(n.length!==r.length)return!1;n.sort(),r.sort();for(let i=0;i<n.length;i++)if(n[i]!==r[i])return!1}return!0},rne=async(t,e,n={})=>{let r;if(BKe(t)){const i=t;r=i===void 0?null:await i.queryFeatures(new en({...n,objectIds:e})).then(s=>({data:s,layer:t.layer}))}else{const i=t;r=i===void 0?null:await i.queryFeatures(new en({...n,objectIds:e})).then(s=>({data:s,layer:i}))}return r},HKe=Mc;let vS=class extends fo(Kt){constructor(e){super(e),this.accentColor=new Kn([255,127,0]),this.textColor=new Kn([255,255,255])}};_([E({type:Kn,nonNullable:!0})],vS.prototype,"accentColor",void 0),_([E({type:Kn,nonNullable:!0})],vS.prototype,"textColor",void 0),vS=_([ue("esri.views.Theme")],vS);const q7=vS,s1e=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],o1e={};function a1e(t){return!!o1e[t]}function qKe(t){for(const e of t)if(!a1e(e))return!1;return!0}s1e.forEach(t=>{o1e[t]=!0});let l1e=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:n,priority:r},i)=>this.inputManager?.installHandlers(i,[n],r))}disconnect(){this.inputManager&&this._handlers.forEach((e,n)=>this.inputManager?.uninstallHandlers(n)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,n,r,i){const s=Array.isArray(e)?e:e.split(",");if(!qKe(s))return s.some(a1e)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(n)?a=n:(o=n,a=[]),typeof r=="function"?o=r:i=r,i=i??Xf.DEFAULT;const l=this._createUniqueGroupName(),c=new KKe(this.view,s,a,o);this._handlers.set(l,{handler:c,priority:i});for(const u of s){const h=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,h+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],i),qn(()=>this._removeHandler(l,s))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,n){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of n){const i=this._handlerCounts.get(r);i===void 0||(i===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,i-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},KKe=class extends Ws{constructor(e,n,r,i){super(!0),this._latestDragStart=void 0,this.view=e;for(const s of n)switch(s){case"click":this.registerIncoming("click",r,o=>i(ZKe(e,o)));break;case"double-click":this.registerIncoming("double-click",r,o=>i(JKe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",r,o=>i(QKe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,o=>i(eYe(e,o)));break;case"hold":this.registerIncoming("hold",r,o=>i(tYe(e,o)));break;case"drag":this.registerIncoming("drag",r,o=>{const a=this._wrapDrag(o);a&&i(a)});break;case"key-down":this.registerIncoming("key-down",r,o=>i(nYe(o)));break;case"key-up":this.registerIncoming("key-up",r,o=>i(rYe(o)));break;case"pointer-down":this.registerIncoming("pointer-down",r,o=>i(kE(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,o=>i(kE(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,o=>i(kE(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,o=>i(iYe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,o=>i(sYe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,o=>i(kE(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,o=>i(kE(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,o=>{i(oYe(o))});break;case"focus":this.registerIncoming("focus",r,o=>{i(YKe(o))});break;case"blur":this.registerIncoming("blur",r,o=>{i(XKe(o))})}}_wrapDrag(e){const n=e.data,{x:r,y:i}=n.center,{action:s,pointerType:o,button:a}=n;if(s==="start"&&(this._latestDragStart=n),!this._latestDragStart)return;const l=n.pointer.native,c=n.buttons,{cancelable:u,timestamp:h}=e,f={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:i,origin:f,pointerType:o,button:a,buttons:c,radius:n.radius,angle:Wme(n.angle),native:l,timestamp:h,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:g=>e.defer(g),preventDefault:()=>e.preventDefault()}}};function YKe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function XKe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function ZKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:u,screenPoint:Fs(s,o),mapPoint:xI(t,s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function JKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:u,mapPoint:xI(t,s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function QKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-click",pointerId:c,pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:h,mapPoint:xI(t,s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function eYe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-double-click",pointerId:c,pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:h,mapPoint:xI(t,s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function tYe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:c,mapPoint:xI(t,s,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),defer:u=>e.defer(u),preventDefault:()=>e.preventDefault()}}function xI(t,e,n){return t.toMap(Fs(e,n),{exclude:[]})}function nYe(t){const{key:e,repeat:n,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-down",key:e,repeat:n,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function rYe(t){const{key:e,native:n}=t.data,{cancelable:r,timestamp:i}=t;return{type:"key-up",key:e,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),defer:s=>t.defer(s),preventDefault:()=>t.preventDefault()}}function kE(t,e){const{x:n,y:r,button:i,buttons:s,native:o,eventId:a}=t.data,l=o.pointerId,c=o.pointerType,{cancelable:u,timestamp:h}=t;return{type:e,x:n,y:r,pointerId:l,pointerType:c,button:i,buttons:s,native:o,timestamp:h,eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),defer:f=>t.defer(f),preventDefault:()=>t.preventDefault()}}function iYe(t){const{x:e,y:n,buttons:r,native:i,eventId:s}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,c=t.data.action,u={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:f}=t;return{type:"pointer-drag",x:e,y:n,pointerId:a,pointerType:l,button:o,buttons:r,action:c,origin:u,native:i,timestamp:f,eventId:s,cancelable:h,stopPropagation:()=>t.stopPropagation(),defer:g=>t.defer(g),preventDefault:()=>t.preventDefault()}}function sYe(t){const{cancelable:e,data:n,timestamp:r}=t,{x:i,y:s,deltaY:o,native:a}=n;return{type:"mouse-wheel",x:i,y:s,deltaY:o,native:a,timestamp:r,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}function oYe(t){const{action:e,state:n,device:r}=t.data,{cancelable:i,timestamp:s}=t,{buttons:o,axes:a}=n;return{type:"gamepad",device:r,timestamp:s,action:e,buttons:o,axes:a,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}const aYe="z",lYe="r",c1e={cancel:"Escape",complete:"Enter"},I3t={...c1e,redo:lYe,undo:aYe,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},R3t={toggle:"Control"},P3t={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},C3t={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:Z0e,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let M3t=class{constructor(){this._bindings=new Map}add(e,n){return this.addToggle(e,r=>{r.type==="key-down"&&n(r)})}addToggle(e,n){const r=cYe.fromDefinition(e,n),i=ZA(this._bindings,r.key,()=>[]);return i.push(r),qn(()=>tde(i,r))}register(e,n=Xf.WIDGET){return rv([e.on("key-down",r=>this.dispatch(e.inputManager,r),n),e.on("key-up",r=>this.dispatch(e.inputManager,r),n)])}dispatch(e,n){const r=n.key,i=this._bindings.get(r);if(i)for(const s of i)s.process(e,n)}},cYe=class K7{constructor(e,n,r,i,s){this.key=e,this.modifiers=n,this.repeats=r,this.continuePropagation=i,this.callback=s}process(e,n){if(!(n.key!==this.key||"repeat"in n&&n.repeat&&!this.repeats)){for(const r of this.modifiers)if(!e.isModifierKeyDown(r))return;this.continuePropagation||n.stopPropagation(),this.callback(n)}}static fromDefinition(e,n){if(typeof e=="string")return new K7(e,[],!1,!1,n);const{key:r,modifier:i,repeats:s,continuePropagation:o}=e;return new K7(r,i?Array.isArray(i)?i:[i]:[],!!s,!!o,n)}};function uYe(t){return[t.on("before-add",e=>{const n=e.item;if(n==null||t.includes(n))return Tt.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();n.onAdd()}),t.on("after-remove",e=>{const n=e.item;n.active&&(n.view.activeTool=null),n.destroy()})]}function Y7(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function hYe(t){return t.type==="key-down"&&t.key===c1e.cancel}function zh(t){return Fs(t.x,t.y)}function u1e(t,e){const n=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return n?Fs(e.clientX-n.left,e.clientY-n.top):Fs(0,0)}function h1e(t,e){return e instanceof Event?u1e(t,e):zh(e)}function d1e(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let NM=class extends Kt{constructor(){super(...arguments),this._pointerLocations=new Map,this._hoveredManipulators=new iw,this._grabbedManipulators=new iw,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1}get cursor(){return this._cursorFromMap(this._grabbedManipulators,"grabbing")??this._cursorFromMap(this._hoveredManipulators,"pointer")}get hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,n){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":ine(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!sne(e))break;const i=zh(e),s=y_(i,e.pointerType,n.tools);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,n),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:i,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&n.activeTool==null&&(this._revertToNullActiveTool=!0,n.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:i}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,n);break;case"pointer-drag":{if(!sne(e))break;const i=this._grabbedManipulators.get(e.pointerId),s=i?.manipulator,o=i?.tool;if(s==null||o==null)break;const a=zh(e);a.x=cu(a.x,0,n.view.width),a.y=cu(a.y,0,n.view.height);const l=i.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:a}):s.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,n)}r();break}case"immediate-click":{const i=zh(e),s=y_(i,e.pointerType,n.tools);if(!dYe(e)){for(const c of n.tools)if((s==null||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}if(s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:r}),L$(o,r);break}case"click":{const i=zh(e),s=y_(i,e.pointerType,n.tools),o=s?.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a}),r();break}case"double-click":{const i=zh(e),s=y_(i,e.pointerType,n.tools),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),L$(o,r);break}case"immediate-double-click":{const i=zh(e),s=y_(i,e.pointerType,n.tools),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),e.pointerType==="mouse"&&L$(o,r);break}}this._onFocusChange(n.tools)}_releaseManipulatorBeforeDragging(e,n,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:n.pointerType,screenPoint:zh(n)}),this._grabbedManipulators.forEach(({manipulator:i},s)=>{i===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(e,n){const r=this._grabbedManipulators.get(e.pointerId)?.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:zh(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(n.setActiveTool))}_onFocusChange(e){this._updateFocusedManipulatorTools(e)}_updateFocusedManipulatorTools(e){const n=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:i})=>n.add(i)),this._hoveredManipulators.forEach(({tool:i})=>r.add(i));for(const i of e){i.hasGrabbedManipulators=n.has(i),i.hasHoveredManipulators=r.has(i);const s=this._grabbedManipulators.values(),o=D6e(s,({tool:a})=>a===i);i.firstGrabbedManipulator=o!=null?o.manipulator:null}}clearPointers(e,{tools:n,setActiveTool:r},i=!0,s){const o=(a,l)=>a===e&&(s==null||s===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:c},u)=>{o(a,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),i&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(n)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((n,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Fs(n.x,n.y),r,n.pointerType,e)})}handleHoverEvent(e,n){const r=e.type;r!=="pointer-up"&&r!=="immediate-click"&&r!=="pointer-move"||!ine(e.pointerType)||(r!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(zh(e),e.pointerId,e.pointerType,n))}_updateHoveredStateForPointerAtScreenPosition(e,n,r,i){let s=y_(e,r,i);const o=this._hoveredManipulators.get(n)?.manipulator;s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(n,s)):this._hoveredManipulators.delete(n),this._onFocusChange(i))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:n},r)=>{e===r&&(this._hoveredManipulators.delete(e),n.hovering=!1)})}_cursorFromMap(e,n){if(!e?.size)return null;for(const{manipulator:r}of e.values())if(r?.interactive){if(r.grabbing&&r.grabCursor)return r.grabCursor;if(r.cursor)return r.cursor}return n}};function y_(t,e,n){for(const r of n){if(r.manipulators==null||!Y7(r))continue;const i=r.manipulators.intersect(t,e);if(i!=null)return{tool:r,manipulator:i}}return null}function ine(t){return t==="mouse"}function sne(t){return t.pointerType!=="mouse"||t.button===0}function dYe(t){return!!t.native.shiftKey}function L$(t,e){t?.consumesClicks&&e()}_([E()],NM.prototype,"cursor",null),NM=_([ue("esri.views.interactive.ToolViewManagerManipulatorState")],NM);const one="attached",D$="tools",fYe=1e3;let Uh=class extends Kt{constructor(e){super(e),this._updatingHandles=new Jy,this._clock=G2,this._manipulatorState=new NM,this.tools=new Ot,this._interacting=!1,this._interactingTimeout=fYe,this._interactingTimeoutHandle=null}initialize(){this.addHandles([this.view.on(s1e,e=>{this._handleInputEvent(e)},Xf.TOOL),...uYe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy(),this._manipulatorState.destroy()}get _manipulatorStateEventArgs(){return{tools:this.tools,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void Tt.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const n=this.activeTool;this._set("activeTool",e),n?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const i=Y7(r);this.activeTool!=null&&i||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!i)}}get cursor(){const e=this._manipulatorState.cursor;if(e!=null)return e;for(const n of this.tools)if(n.visible&&n.cursor!=null)return n.cursor;return null}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Qr(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([dn(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider.on("elevation-change",e=>this._forEachManipulator(n=>n.onElevationChange(e)))],one):this.addHandles(dn(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(one),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){for(const n of this.tools)n.manipulators&&n.manipulators.forEach(({manipulator:r})=>e(r,n))}_handleInputEvent(e){let n=!1;const r={...e,stopPropagation:()=>{n=!0,e.stopPropagation()}};if(this.activeTool!=null)this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r);else for(const i of this.tools)!n&&i.visible&&i.handleInputEvent(r);!n&&hYe(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),n||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this.tools),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(D$);for(const e of this.tools){if(e instanceof Kt){const n=dn(()=>[e.cursor,e.visible,e.editable],()=>{Y7(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)});this.addHandles(n,D$)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",n=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,n.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)})],D$)}this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)}_updateToolEditableFlag(e){e.setEditableFlag?.(1,this.activeTool==null||e===this.activeTool)}_removeIncompleteTools(e){this.tools.filter(n=>(e==null||n!==e)&&!n.created&&n.removeIncompleteOnCancel).forEach(n=>{this.tools.remove(n)})}get test(){}};_([E({constructOnly:!0,nonNullable:!0})],Uh.prototype,"view",void 0),_([E({value:null})],Uh.prototype,"activeTool",null),_([E({readOnly:!0,type:Ot})],Uh.prototype,"tools",void 0),_([E()],Uh.prototype,"cursor",null),_([E({readOnly:!0})],Uh.prototype,"updating",null),_([E()],Uh.prototype,"_interacting",void 0),_([E({readOnly:!0})],Uh.prototype,"interacting",null),Uh=_([ue("esri.views.ToolViewManager")],Uh);const pYe=new Kn("cyan"),mYe=1,gYe=.25,yYe=new Kn("black"),vYe=.4,_Ye=.2,D3t=.25,f1e="default",xYe="temporary",wYe=new Kn("yellow");var X7;let Ul=X7=class extends Kt{constructor(t){super(t),this.name=f1e,this.color=pYe.clone(),this.haloColor=null,this.haloOpacity=mYe,this.fillOpacity=gYe,this.shadowColor=yYe.clone(),this.shadowOpacity=vYe,this.shadowDifference=_Ye,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new X7({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};_([E({type:String,constructOnly:!0,nonNullable:!0})],Ul.prototype,"name",void 0),_([E({type:Kn,nonNullable:!0})],Ul.prototype,"color",void 0),_([E({type:Kn})],Ul.prototype,"haloColor",void 0),_([E({nonNullable:!0})],Ul.prototype,"haloOpacity",void 0),_([E({nonNullable:!0})],Ul.prototype,"fillOpacity",void 0),_([E({type:Kn,nonNullable:!0})],Ul.prototype,"shadowColor",void 0),_([E({nonNullable:!0})],Ul.prototype,"shadowOpacity",void 0),_([E({nonNullable:!0})],Ul.prototype,"shadowDifference",void 0),_([E({nonNullable:!0})],Ul.prototype,"haloWidth",void 0),_([E({nonNullable:!0})],Ul.prototype,"haloBlur",void 0),Ul=X7=_([ue("esri.views.support.HighlightOptions")],Ul);const yg=Ul;function bYe(){return new(Ot.ofType(yg))([new yg({name:f1e}),new yg({name:xYe,color:wYe})])}let Y_=class extends Kt{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":EYe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return SYe[this.deviceType]}};_([E({nonNullable:!0,readOnly:!0})],Y_.prototype,"nativeIndex",void 0),_([E({type:String,readOnly:!0})],Y_.prototype,"deviceType",null),_([E({type:Number,readOnly:!0})],Y_.prototype,"axisThreshold",null),Y_=_([ue("esri.views.input.gamepad.GamepadInputDevice")],Y_);const ZB=Y_,EYe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),SYe={standard:.15,spacemouse:.025,unknown:0};let _S=class extends Kt{constructor(e){super(e),this.devices=new Ot,this.enabledFocusMode="document"}};_([E({type:Ot.ofType(ZB),readOnly:!0})],_S.prototype,"devices",void 0),_([E({type:["document","view","none"]})],_S.prototype,"enabledFocusMode",void 0),_S=_([ue("esri.views.input.gamepad.GamepadSettings")],_S);const TYe=_S;let OM=class extends Kt{constructor(){super(...arguments),this.gamepad=new TYe}};_([E({readOnly:!0})],OM.prototype,"gamepad",void 0),OM=_([ue("esri.views.input.Input")],OM);const kYe=OM,$$=()=>E({type:["pan","rotate","zoom","none"],nonNullable:!0});let ny=class extends Kt{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};_([$$()],ny.prototype,"dragPrimary",void 0),_([$$()],ny.prototype,"dragSecondary",void 0),_([$$()],ny.prototype,"dragTertiary",void 0),_([E({type:["zoom","none"],nonNullable:!0})],ny.prototype,"mouseWheel",void 0),ny=_([ue("esri.views.navigation.NavigationActionMap")],ny);const JB=ny;let wm=class extends Kt{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};_([E({type:Boolean,nonNullable:!0})],wm.prototype,"enabled",void 0),_([E({type:ZB})],wm.prototype,"device",void 0),_([E({type:["pan","zoom"],nonNullable:!0})],wm.prototype,"mode",void 0),_([E({type:["forward-down","forward-up"],nonNullable:!0})],wm.prototype,"tiltDirection",void 0),_([E({type:Number,nonNullable:!0})],wm.prototype,"velocityFactor",void 0),wm=_([ue("esri.views.navigation.gamepad.GamepadSettings")],wm);const p1e=wm;let bm=class extends Kt{constructor(e){super(e),this.actionMap=new JB,this.browserTouchPanEnabled=!0,this.gamepad=new p1e,this.momentumEnabled=!0}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){gF(Tt.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};_([E({type:JB,nonNullable:!0})],bm.prototype,"actionMap",void 0),_([E({type:Boolean})],bm.prototype,"browserTouchPanEnabled",void 0),_([E({type:p1e,nonNullable:!0})],bm.prototype,"gamepad",void 0),_([E({type:Boolean})],bm.prototype,"momentumEnabled",void 0),_([E({type:Boolean})],bm.prototype,"mouseWheelZoomEnabled",null),bm=_([ue("esri.views.navigation.Navigation")],bm);const CO=bm;function G3t(t,e,n){const r=m1e(t),i=e,s=AYe(r,i,n);if(r){const o=el.deriveUnitFromSR(r,t.spatialReference).heightUnit;if(!n&&o!==r.heightUnit){const a=new Xe("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new Xe("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:a})}}if(!IYe(t)||s===4)return new Xe("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case 1:{const o=r?.heightUnit||"unknown",a=i?.heightUnit||"unknown",l=new Xe("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}case 2:{const o=r?.heightModel||"unknown",a=i?.heightModel||"unknown",l=new Xe("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}case 3:{const o=r?.vertCRS||"unknown",a=i?.vertCRS||"unknown",l=new Xe("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}}return null}function AYe(t,e,n){if(!ane(t)||!ane(e))return 4;if(t==null||e==null)return 0;if(!n&&t.heightUnit!==e.heightUnit)return 1;if(t.heightModel!==e.heightModel)return 2;switch(t.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return t.vertCRS===e.vertCRS?0:3;default:return 4}}function ane(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function IYe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!v1e(t)}function m1e(t){if(t.type==="integrated-mesh-3dtiles"||t.type==="gaussian-splat")return null;const e=t.url?QA(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&g1e(t)&&t.heightModelInfo?t.heightModelInfo:v1e(t)?el.deriveUnitFromSR(PYe,t.spatialReference):null}function g1e(t){return"heightModelInfo"in t}function y1e(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function v1e(t){return y1e(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):_1e(t)}function RYe(t){return t.layers!=null||_1e(t)||y1e(t)||g1e(t)}function _1e(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"gaussian-splat":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const PYe=new el({heightModel:"gravity-related-height"});let Z7,j$=null;async function CYe(t){j$||(j$=_e(()=>import("./geometryServiceUtils-CVw8Hojt.js"),__vite__mapDeps([303,304])).then(e=>Z7=e)),await j$,hi(t)}async function x1e(t,e,n,r){if(!t)return null;const i=t.spatialReference;return _p()||hh(i,e)?av(t,e):Z7?Z7.projectGeometry(t,e,n,r):(await Promise.race([CYe(r),$g(r)]),x1e(t,e,n,r))}async function B3t(t,e){try{return t?.spatialReference?await Jge(t,e):null}catch{return null}}let Wr=class extends Kt{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=R1(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),n=[];return this.priorityCollection!=null&&n.push(this.priorityCollection),n.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),n}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,r=>{const i=this._getSupportedSpatialReferences(r);if(i.length>0){const s=this._narrowDownSpatialReferenceCandidates(e,i);s!=null&&(e=s)}return e?.length===1})&&e?.length!==1)return{updating:!0};const n=this._pickSpatialReferenceCandidate(e);return{spatialReference:n?.spatialReference??null,viewingMode:n?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),n=this.spatialReference;if(!n)return{updating:this._spatialReferenceTask.updating};let r;const i=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers}],s=>!(!("tileInfo"in s)||!s.tileInfo?.spatialReference.equals(n))&&(r=s,!0),s=>"tileInfo"in s);return r?{tileInfo:r.tileInfo,updating:!1}:{updating:i}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const n=this._collectLayers(this.mapCollections,r=>{const i=m1e(r);return!!i&&(e={heightModelInfo:i,vcsWkid:r.spatialReference?.vcsWkid,latestVcsWkid:r.spatialReference?.latestVcsWkid},!0)},r=>RYe(r));return{...e,updating:n}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],n=this._collectLayers(this.mapCollections,r=>{const i="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),s=this.requiresExtentInSpatialReference?null:i[0],o=i.find(a=>a.spatialReference.equals(this.spatialReference))??s;if(o)return e.push({extent:o,layer:r}),!0;if(this._getSupportedSpatialReferences(r).length>0)for(const a of i)e.push({extent:a,layer:r});return!1});return{candidates:e,updating:n}}get _extentTask(){const{candidates:e,updating:n}=this._extentCandidatesTask;if(n)return{updating:n};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),i=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&i.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=R1(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:i.clone(),task:sO(async s=>{try{const o=await x1e(r.extent,i,"portalItem"in r.layer?r.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(ha(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,n){if(e==null)return n;const r=new Array;for(const i of e)for(const s of n){if(!i.spatialReference.equals(s.spatialReference))continue;const o=NYe(i.viewingMode,s.viewingMode);if(o!==!1){r.push({spatialReference:i.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const n=this.defaultSpatialReference;return e==null||e.length<1?n?{spatialReference:n,viewingMode:null}:null:(n!=null&&e.length>1&&e.some(({spatialReference:r})=>r.equals(n))&&(e=e.filter(({spatialReference:r})=>r.equals(n))),e.length>1&&e.some(({viewingMode:r})=>r!==2)&&(e=e.filter(({viewingMode:r})=>r!==2)),e[0])}_getSupportedSpatialReferences(e){const n="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(n.length===0)return[];const r=[];for(const i of n){const s=this.getSpatialReferenceSupport(i,e);if(s!=null){const o=s.constraints??[{spatialReference:i,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||r.push({spatialReference:a,viewingMode:l})}}return r}_pickExtentCandidate(e){const n=this.spatialReference;return e.find(({extent:r})=>n.equals(r.spatialReference))||e[0]}_collectLayers(e,n,r=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const i=new MYe(r,n);for(const s of e)if(this._collectCollection(s,i),i.done||i.preloading===this.sourcePreloadCount)break;return i.updating}_collectCollection(e,n){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return n.updating=!0,void++n.preloading;case"failed":return}for(const r of e.layers)if((r.type!=="graphics"||!r.internal)&&n.layerFilter(r)){switch(this._loadMaybe(r)){case"failed":continue;case"loading":n.updating=!0,++n.preloading;break;case"loaded":if(n.updating||(n.done=n.pushLayer(r)),n.done||n.preloading===this.sourcePreloadCount)break;"layers"in r&&this._collectCollection({layers:r.layers},n)}if(n.done||n.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(n=>{ya(n)}),"loading"):e.loadStatus:"loaded"}};_([E()],Wr.prototype,"required",void 0),_([E({constructOnly:!0})],Wr.prototype,"map",void 0),_([E({constructOnly:!0})],Wr.prototype,"getSpatialReferenceSupport",void 0),_([E()],Wr.prototype,"defaultSpatialReference",void 0),_([E()],Wr.prototype,"userSpatialReference",void 0),_([E()],Wr.prototype,"sourcePreloadCount",void 0),_([E()],Wr.prototype,"priorityCollection",void 0),_([E()],Wr.prototype,"requiresExtentInSpatialReference",void 0),_([E()],Wr.prototype,"suspended",void 0),_([E({readOnly:!0})],Wr.prototype,"ready",null),_([E({readOnly:!0})],Wr.prototype,"heightModelInfoReady",null),_([E({readOnly:!0})],Wr.prototype,"spatialReference",null),_([E({readOnly:!0})],Wr.prototype,"extent",null),_([E({readOnly:!0})],Wr.prototype,"heightModelInfo",null),_([E({readOnly:!0})],Wr.prototype,"vcsWkid",null),_([E({readOnly:!0})],Wr.prototype,"latestVcsWkid",null),_([E({readOnly:!0})],Wr.prototype,"viewingMode",null),_([E({readOnly:!0})],Wr.prototype,"tileInfo",null),_([E({readOnly:!0})],Wr.prototype,"mapCollections",null),_([E({readOnly:!0})],Wr.prototype,"_spatialReferenceTask",null),_([E({readOnly:!0})],Wr.prototype,"_tileInfoTask",null),_([E({readOnly:!0})],Wr.prototype,"_heightModelInfoTask",null),_([E({readOnly:!0})],Wr.prototype,"_extentCandidatesTask",null),_([E()],Wr.prototype,"_extentTask",null),_([E()],Wr.prototype,"_projectExtentTask",void 0),Wr=_([ue("esri.views.support.DefaultsFromMap")],Wr);let MYe=class{constructor(e,n){this.layerFilter=e,this.pushLayer=n,this.preloading=-1,this.updating=!1,this.done=!1}};function NYe(t,e){return t!=null?e!=null?t===e&&t:t:e}function OYe(t){return"tryRecycleWith"in t}let LYe=class{constructor(e,n,r){this.layer=e,this.view=n,this.layerViewImporter=r,this._controller=new AbortController,this._started=!1,this.done=!1,this._deferred=uc(),this.promise=this._deferred.promise,lu(this._controller.signal,()=>{this._recycleController?.abort();const i=new Xe("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred?.reject(i)})}tryRecycle(e){if(!this.done||!this.layerView||!OYe(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const n=this.layer.type,r=this._recycleController.signal;for(let i=0;i<e.length;i++){const s=e[i];if(s.type!==n)continue;const o=this.layerView.tryRecycleWith(s,{signal:r});if(o){e.splice(i,1),this.layer=s;const a=this.layerView,l=a.view;return this.promise=o.then(()=>(hi(r),s.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),s.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:n,view:r}=this;n.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:n,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:n},layer:r}=this;this._map=e.map;try{let i,s;if(await r.load({signal:n}),r.prefetchResources&&await r.prefetchResources({signal:n}),DYe(r))i=await r.createLayerView(e,{signal:n});else{if(!this.layerViewImporter.hasLayerViewModule(r))throw new Xe("layer:view-not-supported","No layerview implementation was found");const l=await this.layerViewImporter.importLayerView(r);hi(n),i="default"in l?new l.default({layer:r,view:e}):new l({layer:r,view:e})}const o=()=>{s=Qr(s),i.destroyed||i.destroy(),this.done=!0};s=lu(n,o),hi(n);try{await i.when()}catch(l){throw o(),l}if(!this._map?.allLayers?.includes(r))return o(),void this._deferred?.reject(new Xe("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=i,r.emit("layerview-create",{view:e,layerView:i}),e.emit("layerview-create",{layer:r,layerView:i}),this.done=!0,this._deferred?.resolve(i)}catch(i){r.emit("layerview-create-error",{view:e,error:i}),e.emit("layerview-create-error",{layer:r,error:i}),this.done=!0,this._deferred?.reject(new Xe("layerview:create-error","layerview creation failed",{layer:r,error:i}))}}};function DYe(t){return t.createLayerView!==yi.prototype.createLayerView}function $Ye(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let Ya=class extends Kt{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Jy,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const n=this.view.map?.allLayers;if(n)for(const r of n)this.layerViewFilter?.(r)!==!1&&this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=uc(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Y2(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const{map:n}=this.view;if(!n)return void this.clear();if(this._map!==n&&(this.clear(),this._map=n),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,i=[],s=this.view.ready,o=u=>{if(u!=null){for(const h of u)if(h){if(this.layerViewFilter?.(h)===!1)continue;r.add(h);const f=this._layerLayerViewInfoMap.get(h);f&&s?f.start():f||this._recyclingInfoMap.has(h)||i.push(h),"layers"in h&&h.layers&&o(h.layers)}}};for(const u of this._rootCollectionNames)o(ad(this,u));const a=new Array,l=u=>{const h=u.tryRecycle(i);h?(this._recyclingInfoMap.set(u.layer,u),this.notifyChange("updating"),h.then(()=>{this._recyclingInfoMap.delete(u.layer),this._layerLayerViewInfoMap.set(u.layer,u),this._reschedule(),this.notifyChange("updating")}).catch(f=>{ya(f)||(this._recyclingInfoMap.delete(u.layer),u.destroy(),this._reschedule(),this.notifyChange("updating"))})):a.push(u)};for(const u of this._layerLayerViewInfoMap.values())r.has(u.layer)||(this._layerLayerViewInfoMap.delete(u.layer),l(u));for(const u of this._recyclingInfoMap.values())r.has(u.layer)||(this._recyclingInfoMap.delete(u.layer),l(u));for(const u of i)this._createLayerView(u);this._refreshCollections(),a.forEach(u=>u.destroy());const c=[n?.ground?.layers,n?.basemap?.baseLayers,n?.basemap?.groundLayers,n?.basemap?.referenceLayers,n?.layers].filter(u=>!!u);r.forEach(u=>"layers"in u&&c.push(u.layers)),this.addHandles(c.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null},this._layersToLayerViews=new Map(e.layerviewMapping)}initialize(){this.addHandles([$1(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),dn(()=>{const e=this.view,n=e?.map;return[n?.basemap,n?.ground,n?.layers,e?.ready]},()=>this._reschedule(),ea)]),this._preloadLayerViewModules(),this._reschedule()}clearHandles(){this._watchUpdatingTracking.removeAll()}destroy(){this.clear(),IP(this._recyclingInfoMap),IP(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Tr()),this._workPromise=null)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||HDe(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const n of this._layerLayerViewInfoMap.values())n.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),IP(this._layerLayerViewInfoMap),IP(this._recyclingInfoMap))}async whenLayerView(e){await this._reschedule();const n=this._layerLayerViewInfoMap.get(e)?.promise;if(!n){const r=this._recyclingInfoMap.get(e)?.promise;if(!r)throw new Xe("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return r}return n}isCreatingLayerViewsForLayer(e,n){this.commitProperty("updatingRemaining");const r=this._layerLayerViewInfoMap.get(e);if(!r?.done)return!0;const i=r.layerView;return!(!i||!n||i.parent===n)||!!(r.done&&i&&"layers"in e&&e.layers?.length)&&e.layers.some(s=>this.isCreatingLayerViewsForLayer(s,i))}_refreshCollections(){for(const[e,n]of this._layersToLayerViews)this._populateLayerViewsOwners(ad(this,e),ad(this,n),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())ad(this,e)?.removeAll()}_populateLayerViewsOwners(e,n,r){if(!e||!n)return void n?.removeAll();let i=0;for(const s of e){const o=this._layerLayerViewInfoMap.get(s);if(!o?.layerView)continue;const{layerView:a}=o;a.layer=s,a.parent=r,n.at(i)!==a&&n.splice(i,0,a),"layers"in s&&$Ye(a)&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),++i}i<n.length&&n.splice(i)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const n=new LYe(e,this.view,this.layerViewImporter);n.promise?.then(()=>this._refreshCollections(),r=>{r&&(ya(r)||r.name==="cancelled:layerview-create")||Tt.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this.destroyed||this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,n),this.view.ready&&n.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};_([E()],Ya.prototype,"_workPromise",void 0),_([E({readOnly:!0})],Ya.prototype,"_watchUpdatingTracking",void 0),_([E({readOnly:!0})],Ya.prototype,"_layersToLayerViews",void 0),_([E({constructOnly:!0})],Ya.prototype,"layerviewMapping",void 0),_([E({readOnly:!0})],Ya.prototype,"_rootCollectionNames",null),_([E({constructOnly:!0})],Ya.prototype,"layerViewFilter",void 0),_([E()],Ya.prototype,"layerViewImporter",void 0),_([E()],Ya.prototype,"supportsGround",void 0),_([E({readOnly:!0})],Ya.prototype,"updating",null),_([E({readOnly:!0})],Ya.prototype,"updatingRemaining",null),_([E({constructOnly:!0})],Ya.prototype,"view",void 0),Ya=_([ue("esri.views.support.LayerViewManager")],Ya);const jYe=Ya;let X_=class extends Kt{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};_([E()],X_.prototype,"featureTitleFields",void 0),_([E()],X_.prototype,"utilityNetworkFields",void 0),_([E()],X_.prototype,"globalIdField",void 0),X_=_([ue("esri.views.support.RequiredFieldsOptions")],X_);const FYe=X_;var Z_,bg;let Lt=(bg=class extends iO(VG){constructor(e){super(e),this._userSpatialReference=null,this.handles=new q2,this.updatingHandles=new Jy,this.allLayerViews=new Hu({getCollections:()=>this.layerviewCollections,getChildrenFunction:zYe}),this.analyses=new y2,this.basemapView=null,this.dependencies={popup:void 0},this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new mT,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Ot,this.magnifier=new i1e,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this._lowPriorityCursorHandles=new Ot,this._highPriorityCursorHandles=new Ot,this.input=new kYe,this.navigation=new CO,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new l1e(this),this.persistableViewModels=new Ot,this.requiredFieldsOptions=new FYe,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(dn(()=>this.preconditionsReady,n=>{const r=this.ready;if(n?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Z_.views.add(this)):(this._lockedSpatialReference=null,Z_.views.remove(this)),this.notifyChange("spatialReference"),!n&&r)this.toolViewManager?.detach(),this.analysisViewManager?.detach(),this.layerViewManager?.clear(),this._teardown();else if(n&&!r){try{this._startup()}catch(i){return void queueMicrotask(()=>{this.fatalError=new Xe("view:startup-error","View._startup failed",i)})}this.analysisViewManager?.attach(),this.toolViewManager.attach()}},Dg))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this._validateWithErrorDisplay()]).then(()=>(this._isValid=!0,hB(()=>this.ready)))),this.basemapView=new MKe({view:this}),this.layerViewManager=new jYe({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},layerviewMapping:this._layerToLayerviewMapping}),this.toolViewManager=new Uh({view:this}),this.selectionManager=new HKe({view:this}),this.addHandles([hc(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{Tt.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),dn(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},ea),dn(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},Dg),dn(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},ea)])}get _layerToLayerviewMapping(){return Z_._layerToLayerview}destroy(){this.destroyed||(Z_.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Mi(this.graphics),this.analyses=Mi(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.analysisViewManager=Mi(this.analysisViewManager),this.toolViewManager=Mi(this.toolViewManager),this.layerViewManager=Mi(this.layerViewManager),this.selectionManager=Mi(this.selectionManager),this.basemapView=Mi(this.basemapView),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this.handles.destroy(),this.map=Mi(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return Tt.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get layerviewCollections(){return[this.basemapView?.baseLayerViews,this.basemapView?.groundLayerViews,this.layerViews,this.basemapView?.referenceLayerViews]}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Wr({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,n)=>this.getSpatialReferenceSupport(e,n),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??bYe()}set highlights(e){this._set("highlights",pd(e,this._get("highlights"),Ot.ofType(yg)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||IF(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(Tt.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),IF(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,n=this.map.ground.loaded,r=this.map.basemap?.loaded??!0;return e&&r&&n&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=sO(i=>$de(ye("view-readyState-waiting-delay"),null,i)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=R1(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const n=e.clone();return n.vcsWkid=this.defaultsFromMap.vcsWkid,n.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,n}return e}set spatialReference(e){const n=!uo(e,this._get("spatialReference"));this._set("_userSpatialReference",e),n&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Id}set timeZone(e){this._userTimeZone=e,v7e(e)||Tt.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._highPriorityCursorHandles.at(-1)?.cursor??this._lowPriorityCursorHandles.at(-1)?.cursor??"default"}acquireCursor(e,n="low"){const r=n==="high"?this._highPriorityCursorHandles:this._lowPriorityCursorHandles,i={cursor:e},s=qn(()=>r.remove(i));return r.add(i),this.addHandles(s),s}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new q7}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}getSurface(){return null}importLayerView(e){throw new Xe("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,n){return this.isResolved()&&!this.ready&&Tt.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,n)}forceReadyCycle(){this.ready&&(hc(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}on(e,n){return super.on(e,n)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}async _validateWithErrorDisplay(){try{await this.validate()}catch(e){const n=document.createElement("div");n.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const r=document.createElement("div");r.innerHTML="Unable to display map. WebGL2 support is required.",r.setAttribute("style","font-size: 24px; font-weight: bold;");const i=document.createElement("div");i.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",i.setAttribute("style","font-size: 18px;");const s=document.createElement("a");s.innerHTML="https://esriurl.com/webgl-faq",s.target="_blank",s.setAttribute("style","font-size: 18px;"),s.href="https://esriurl.com/webgl-faq",n.appendChild(r),n.appendChild(i),n.appendChild(s);const o=this.getSurface();throw o&&o.appendChild(n),e}}},Z_=bg,bg._layerToLayerview=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.basemap.groundLayers","view.basemapView.groundLayerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"],["view.map.layers","view.layerViews"]],bg.views=new Ot,bg);_([E()],Lt.prototype,"_userSpatialReference",void 0),_([E()],Lt.prototype,"activeTool",null),_([E({readOnly:!0})],Lt.prototype,"allLayerViews",void 0),_([E({readOnly:!0})],Lt.prototype,"layerviewCollections",null),_([E(w9(y2,"analyses"))],Lt.prototype,"analyses",void 0),_([E()],Lt.prototype,"animation",null),_([E()],Lt.prototype,"basemapView",void 0),_([E()],Lt.prototype,"center",null),_([E()],Lt.prototype,"defaultsFromMapSettings",null),_([E()],Lt.prototype,"defaultsFromMap",null),_([E()],Lt.prototype,"dependencies",void 0),_([E()],Lt.prototype,"displayFilterEnabled",void 0),_([E({type:Dn})],Lt.prototype,"extent",null),_([E()],Lt.prototype,"fatalError",void 0),_([E(w9(mT,"graphics"))],Lt.prototype,"graphics",void 0),_([E({readOnly:!0,type:el})],Lt.prototype,"heightModelInfo",null),_([E({type:Ot.ofType(yg)})],Lt.prototype,"highlights",null),_([E({readOnly:!0})],Lt.prototype,"interacting",null),_([E({constructOnly:!0})],Lt.prototype,"layerViewFilter",void 0),_([E({readOnly:!0})],Lt.prototype,"navigating",null),_([E({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Lt.prototype,"preconditionsReady",null),_([E({readOnly:!0})],Lt.prototype,"typeSpecificPreconditionsReady",void 0),_([E({type:Ot,readOnly:!0})],Lt.prototype,"layerViews",void 0),_([E()],Lt.prototype,"resolution",null),_([E({type:i1e})],Lt.prototype,"magnifier",void 0),_([E({value:null,type:m0e})],Lt.prototype,"map",null),_([E()],Lt.prototype,"padding",void 0),_([E({readOnly:!0})],Lt.prototype,"ready",void 0),_([E()],Lt.prototype,"_readyStateWaitingTask",void 0),_([E({readOnly:!0})],Lt.prototype,"readyState",null),_([E({type:Bt})],Lt.prototype,"spatialReference",null),_([E()],Lt.prototype,"stationary",null),_([E({type:Ea})],Lt.prototype,"timeExtent",null),_([E({type:String,nonNullable:!0})],Lt.prototype,"timeZone",null),_([E()],Lt.prototype,"tools",null),_([E()],Lt.prototype,"toolViewManager",void 0),_([E({readOnly:!0})],Lt.prototype,"type",void 0),_([E({type:Number})],Lt.prototype,"scale",void 0),_([E({readOnly:!0})],Lt.prototype,"updating",void 0),_([E({readOnly:!0})],Lt.prototype,"initialExtentRequired",void 0),_([E({readOnly:!0})],Lt.prototype,"initialExtent",null),_([E()],Lt.prototype,"cursor",null),_([E({readOnly:!0})],Lt.prototype,"input",void 0),_([E({type:CO,nonNullable:!0})],Lt.prototype,"navigation",void 0),_([E()],Lt.prototype,"layerViewManager",void 0),_([E()],Lt.prototype,"analysisViewManager",void 0),_([E()],Lt.prototype,"selectionManager",void 0),_([E()],Lt.prototype,"width",void 0),_([E()],Lt.prototype,"height",void 0),_([E({readOnly:!0})],Lt.prototype,"resizing",void 0),_([E({value:null,readOnly:!0})],Lt.prototype,"size",null),_([E({readOnly:!0})],Lt.prototype,"suspended",void 0),_([E({readOnly:!0})],Lt.prototype,"viewEvents",void 0),_([E({readOnly:!0})],Lt.prototype,"persistableViewModels",void 0),_([E()],Lt.prototype,"_isValid",void 0),_([E()],Lt.prototype,"_readyCycleForced",void 0),_([E()],Lt.prototype,"_lockedSpatialReference",void 0),_([E()],Lt.prototype,"_userTimeZone",void 0),_([E()],Lt.prototype,"_lockedTimeZone",void 0),_([E()],Lt.prototype,"_userTimeExtent",void 0),_([E()],Lt.prototype,"_lockedTimeExtent",void 0),_([E({type:q7})],Lt.prototype,"theme",void 0),_([E({readOnly:!0,type:q7})],Lt.prototype,"effectiveTheme",null),Lt=Z_=_([ue("esri.views.View")],Lt);const F$=globalThis.$arcgis;F$&&!F$.views&&Object.defineProperty(F$,"views",{configurable:!1,enumerable:!0,writable:!1,value:Lt.views});const VYe=Lt;function zYe(t){return t.layerViews}function Di(){return[0,0]}function UYe(t){return[t[0],t[1]]}function wI(t,e){return[t,e]}function GYe(t,e){return[t,e]}function BYe(t,e=Di()){const n=Math.min(2,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function w1e(){return Di()}function b1e(){return wI(1,1)}function E1e(){return wI(1,0)}function S1e(){return wI(0,1)}const WYe=w1e(),HYe=b1e(),qYe=E1e(),KYe=S1e();Object.freeze(Object.defineProperty({__proto__:null,ONES:HYe,UNIT_X:qYe,UNIT_Y:KYe,ZEROS:WYe,clone:UYe,create:Di,freeze:GYe,fromArray:BYe,fromValues:wI,ones:b1e,unitX:E1e,unitY:S1e,zeros:w1e},Symbol.toStringTag,{value:"Module"}));function YYe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function T1e(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function XYe(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function QB(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5];let l=n*s-r*i;return l?(l=1/l,t[0]=s*l,t[1]=-r*l,t[2]=-i*l,t[3]=n*l,t[4]=(i*a-s*o)*l,t[5]=(r*o-n*a)*l,t):null}function ZYe(t){return t[0]*t[3]-t[1]*t[2]}function k1e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1],h=n[2],f=n[3],g=n[4],v=n[5];return t[0]=r*c+s*u,t[1]=i*c+o*u,t[2]=r*h+s*f,t[3]=i*h+o*f,t[4]=r*g+s*v+a,t[5]=i*g+o*v+l,t}function bI(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*c,t[1]=i*u+o*c,t[2]=r*-c+s*u,t[3]=i*-c+o*u,t[4]=a,t[5]=l,t}function MO(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=r*c,t[1]=i*c,t[2]=s*u,t[3]=o*u,t[4]=a,t[5]=l,t}function _2(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=r*c+s*u+a,t[5]=i*c+o*u+l,t}function A1e(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function I1e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function eW(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function JYe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function QYe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function eXe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function R1e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function tXe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function nXe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function rXe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function iXe(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],g=e[5],v=_l();return Math.abs(n-l)<=v*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=v*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=v*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-h)<=v*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-f)<=v*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-g)<=v*Math.max(1,Math.abs(a),Math.abs(g))}const sXe=k1e,oXe=R1e;Object.freeze(Object.defineProperty({__proto__:null,add:eXe,copy:YYe,determinant:ZYe,equals:iXe,exactEquals:rXe,frob:QYe,fromRotation:A1e,fromScaling:I1e,fromTranslation:eW,identity:T1e,invert:QB,mul:sXe,multiply:k1e,multiplyScalar:tXe,multiplyScalarAndAdd:nXe,rotate:bI,scale:MO,set:XYe,str:JYe,sub:oXe,subtract:R1e,translate:_2},Symbol.toStringTag,{value:"Module"}));function yd(){return[1,0,0,1,0,0]}function aXe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function lXe(t,e,n,r,i,s){return[t,e,n,r,i,s]}const cXe=yd();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:cXe,clone:aXe,create:yd,fromValues:lXe},Symbol.toStringTag,{value:"Module"}));const GP={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new xs({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Bt.WebMercator}),minus180Line:new xs({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Bt.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new xs({paths:[[[180,-180],[180,180]]],spatialReference:Bt.WGS84}),minus180Line:new xs({paths:[[[-180,-180],[-180,180]]],spatialReference:Bt.WGS84})}};function Oy(t,e){return Math.ceil((t-e)/(2*e))}function P1e(t,e){const n=yT(t);for(const r of n)for(const i of r)i[0]+=e;return t}function yT(t){return CB(t)?t.rings:t.paths}function X3t(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function uXe(t){return typeof t=="string"?Fa(t):Ze(t)}function hXe(t,e,n){const r={};for(const i in t){if(i==="declaredClass")continue;const s=t[i];if(s!=null&&typeof s!="function")if(Array.isArray(s))r[i]=s.map(o=>hXe(o));else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(n?.[i]);r[i]=e?o:JSON.stringify(o)}else r[i]=e?s:JSON.stringify(s);else r[i]=s}return r}function dXe(t,e){return t?e&&AG(t)?e:kG(t)??Kr?.findCredential(t)?.token:null}async function Z3t(t,e,n){const r=dXe(t,e);return r||(!Kr&&Qn.request.useIdentity&&await _e(()=>import("./IdentityManager-B5JkgnVm.js"),__vite__mapDeps([85,86])),(await Kr.getCredential(t,n))?.token)}async function fXe(t,e,n,r){const i=uXe(t),s=e[0].spatialReference,o={...r,responseType:"json",query:{...i.query,f:"json",sr:Jfe(s),target:JSON.stringify({geometryType:MB(e[0]),geometries:e}),cutter:JSON.stringify(n)}},a=await Qi(i.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map(u=>{const h=m2(u);return h.spatialReference=s,h})}}function pXe(t){return{geometryType:MB(t[0]),geometries:t.map(e=>e.toJSON())}}function mXe(t,e,n){const r=gBe(e);return t.map(i=>{const s=r.fromJSON(i);return s.spatialReference=n,s})}async function gXe(t,e,n){const r=typeof t=="string"?Fa(t):t,i=e[0].spatialReference,s=MB(e[0]),o={...n,query:{...r.query,f:"json",sr:Jfe(i),geometries:JSON.stringify(pXe(e))}},{data:a}=await Qi(r.path+"/simplify",o);return mXe(a.geometries,s,i)}const C1e=()=>Tt.getLogger("esri.geometry.support.normalizeUtils");function yXe(t){return t.type==="polygon"}function vXe(t){return t[0].type==="polygon"}function _Xe(t){return t[0].type==="polyline"}function lne(t){const e=[];let n=0,r=0;for(let i=0;i<t.length;i++){const s=t[i];let o=null;for(let a=0;a<s.length;a++)o=s[a],e.push(o),a===0?(n=o[0],r=n):(n=Math.min(n,o[0]),r=Math.max(r,o[0]));o&&e.push([(n+r)/2,0])}return e}function xXe(t,e){if(!(t instanceof xs||t instanceof vi)){const i="straightLineDensify: the input geometry is neither polyline nor polygon";throw C1e().error(i),new Xe("internal:geometry",i)}const n=yT(t),r=[];for(const i of n){const s=[];r.push(s),s.push([i[0][0],i[0][1]]);for(let o=0;o<i.length-1;o++){const a=i[o][0],l=i[o][1],c=i[o+1][0],u=i[o+1][1],h=Math.sqrt((c-a)*(c-a)+(u-l)*(u-l)),f=(u-l)/h,g=(c-a)/h,v=h/e;if(v>1){for(let A=1;A<=v-1;A++){const I=A*e,R=g*I+a,M=f*I+l;s.push([R,M])}const x=(h+Math.floor(v-1)*e)/2,b=g*x+a,T=f*x+l;s.push([b,T])}s.push([c,u])}}return yXe(t)?new vi({rings:r,spatialReference:t.spatialReference}):new xs({paths:r,spatialReference:t.spatialReference})}function cne(t,e,n){if(e){const r=xXe(t,1e6);t=YE(r,!0)}return n&&(t=P1e(t,n)),t}function une(t,e,n){if(Array.isArray(t)){const r=t[0];if(r>e){const i=Oy(r,e);t[0]=r+i*(-2*e)}else if(r<n){const i=Oy(r,n);t[0]=r+i*(-2*n)}}else{const r=t.x;if(r>e){const i=Oy(r,e);t=t.clone().offset(i*(-2*e),0)}else if(r<n){const i=Oy(r,n);t=t.clone().offset(i*(-2*n),0)}}return t}function wXe(t,e){let n=-1;for(let r=0;r<e.cutIndexes.length;r++){const i=e.cutIndexes[r],s=e.geometries[r],o=yT(s);for(let a=0;a<o.length;a++){const l=o[a];l.some(c=>{if(c[0]<180)return!0;{let u=0;for(let f=0;f<l.length;f++){const g=l[f][0];u=g>u?g:u}u=Number(u.toFixed(9));const h=-360*Oy(u,180);for(let f=0;f<l.length;f++){const g=s.getPoint(a,f);s.setPoint(a,f,g.clone().offset(h,0))}return!0}})}if(i===n){if(vXe(t))for(const a of yT(s))t[i]=t[i].addRing(a);else if(_Xe(t))for(const a of yT(s))t[i]=t[i].addPath(a)}else n=i,t[i]=s}return t}async function bXe(t,e,n){if(!Array.isArray(t))return bXe([t],e);e&&typeof e!="string"&&C1e().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof e=="string"?e:e?.url??Qn.geometryServiceUrl;let i,s,o,a,l,c,u,h,f=0;const g=[],v=[];for(const R of t)if(R!=null)if(i||(i=R.spatialReference,s=La(i),o=i.isWebMercator,c=o?102100:4326,a=GP[c].maxX,l=GP[c].minX,u=GP[c].plus180Line,h=GP[c].minus180Line),s)if(R.type==="mesh")v.push(R);else if(R.type==="point")v.push(une(R.clone(),a,l));else if(R.type==="multipoint"){const M=R.clone();M.points=M.points.map(F=>une(F,a,l)),v.push(M)}else if(R.type==="extent"){const M=R.clone()._normalize(!1,!1,s);v.push(M.rings?new vi(M):M)}else if(R.extent){const M=R.extent,F=Oy(M.xmin,l)*(2*a);let C=F===0?R.clone():P1e(R.clone(),F);M.offset(F,0);let{xmin:N,xmax:O}=M;N=Number(N.toFixed(9)),O=Number(O.toFixed(9)),M.intersects(u)&&O!==a?(f=O>f?O:f,C=cne(C,o),g.push(C),v.push("cut")):M.intersects(h)&&N!==l?(f=O*(2*a)>f?O*(2*a):f,C=cne(C,o,360),g.push(C),v.push("cut")):v.push(C)}else v.push(R.clone());else v.push(R);else v.push(R);let x=Oy(f,a),b=-90;const T=x,A=new xs;for(;x>0;){const R=360*x-180;A.addPath([[R,b],[R,-1*b]]),b*=-1,x--}if(g.length>0&&T>0){const R=wXe(g,await fXe(r,g,A,n)),M=[],F=[];for(let O=0;O<v.length;O++){const j=v[O];if(j!=="cut")F.push(j);else{const V=R.shift(),W=t[O];W!=null&&W.type==="polygon"&&W.rings&&W.rings.length>1&&V.rings.length>=W.rings.length?(M.push(V),F.push("simplify")):F.push(o?Yy(V):V)}}if(!M.length)return F;const C=await gXe(r,M,n),N=[];for(let O=0;O<F.length;O++){const j=F[O];j!=="simplify"?N.push(j):N.push(o?Yy(C.shift()):C.shift())}return N}const I=[];for(let R=0;R<v.length;R++){const M=v[R];if(M!=="cut")I.push(M);else{const F=g.shift();I.push(o===!0?Yy(F):F)}}return I}function EXe(t){if(!t)return null;const e=t.extent;if(!e)return null;const n=t.spatialReference&&La(t.spatialReference);if(!n)return e;const[r,i]=n.valid,s=2*i,{width:o}=e;let a,{xmin:l,xmax:c}=e;if([l,c]=[c,l],t.type==="extent"||o===0||o<=i||o>s||l<r||c>i)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=lne(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=lne(t.paths);break;case"multipoint":a=t.points}const u=e.clone();for(let h=0;h<a.length;h++){let f=a[h][0];f<0?(f+=i,c=Math.max(f,c)):(f-=i,l=Math.min(f,l))}return u.xmin=l,u.xmax=c,u.width<o?(u.xmin-=i,u.xmax-=i,u):e}function tW(t,e,n){const r=La(n);if(r==null)return t;const[i,s]=r.valid,o=2*s;let a=0,l=0;e>s?a=Math.ceil(Math.abs(e-s)/o):e<i&&(a=-Math.ceil(Math.abs(e-i)/o)),t>s?l=Math.ceil(Math.abs(t-s)/o):t<i&&(l=-Math.ceil(Math.abs(t-i)/o));let c=t+(a-l)*o;const u=c-e;return u>s?c-=o:u<i&&(c+=o),c}function J3t(t,e){return nW(e)?.normalize(t)??t}function nW(t){const e=La(t);if(e==null)return null;const[n,r]=e.valid;return new SO(n,r)}const Q3t=nW(Bt.WGS84);nW(Bt.WebMercator);const M1e=96,N1e=39.37,SXe=180/Math.PI;function O1e(t){return t.wkid?t:t.spatialReference||Bt.WGS84}function rW(t,e){return e.type?to(t,e.x,e.y):Xx(t,e)}function L1e(t){return $d(t)}function NO(t,e,n=0){let r=t.width,i=t.height;if(n!==0){const a=uI(n),l=Math.abs(Math.cos(a)),c=Math.abs(Math.sin(a));r=t.width*l+t.height*c,i=t.width*c+t.height*l}const s=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(r/s,i/o)*MXe(t.spatialReference)}async function xS(t,e,n,r){let i,s;if(!t||Array.isArray(t)&&!t.length)return null;if(Ot.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const a=t.every(u=>"attributes"in u),l=t.some(u=>!u.geometry);let c=t;if(a&&l&&e&&e.allLayerViews){const u=new Map;for(const v of t){const x=v.layer,b=u.get(x)||[],T=v.attributes[x.objectIdField];T!=null&&b.push(T),u.set(x,b)}const h=[];u.forEach((v,x)=>{const b=e.allLayerViews?.find(T=>T.layer.id===x.id);if(b&&"queryFeatures"in b){const T=x.createQuery();T.objectIds=v,T.returnGeometry=!0,h.push(b.queryFeatures(T))}});const f=await Promise.all(h),g=[];for(const v of f)if(v&&v.features&&v.features.length)for(const x of v.features)x.geometry!=null&&g.push(x.geometry);c=g}for(const u of c)r=await xS(u,e,n,r);return r}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")i=new Jt(t);else if(t instanceof Ds)i=t;else if("geometry"in t){if(t.geometry)i=t.geometry;else if(t.layer){const a=t.layer,l=e.allLayerViews?.find(c=>c.layer.id===a.id);if(l&&"queryFeatures"in l){const c=a.createQuery();c.objectIds=[t.attributes[a.objectIdField]],c.returnGeometry=!0,i=(await l.queryFeatures(c))?.features?.[0]?.geometry}}}if(i==null)return null;switch(i.type){case"point":s=new Dn({xmin:i.x,ymin:i.y,xmax:i.x,ymax:i.y,spatialReference:i.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=EXe(i);break;default:s=i.extent}if(!s)return null;_p()||hh(s.spatialReference,n)||await $g();const o=av(s,n);if(!o)return null;if(r){const a=o.center,l=a.clone();l.x=tW(a.x,r.center.x,n),l.x!==a.x&&o.centerAt(l),r=r.union(o)}else r=o;return r}function TXe(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,n=0;for(const r of t){const i=r.layer;i?.minScale&&i.maxScale&&(e=i.minScale<e?i.minScale:e,n=i.maxScale>n?i.maxScale:n)}return e&&n?{min:e,max:n}:null}}}function hne(t,e){const n=O1e(t);return uo(n,e)||n.imageCoordinateSystem||e.imageCoordinateSystem?t:av(t,e)}async function kXe(t,e){if(!t||!e)return new tu({targetGeometry:new Jt,scale:0,rotation:0});let n=e.spatialReference;const{constraints:r,padding:i,viewpoint:s,size:o}=e,a=[i?o[0]-i.left-i.right:o[0],i?o[1]-i.top-i.bottom:o[1]];let l=null;t instanceof tu?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l?.targetGeometry?c=l.targetGeometry:t instanceof Dn?c=t:t instanceof Ds?c=await xS(t,e,n):t&&(c=await xS(t.center,e,n)||await xS(t.target,e,n)||await xS(t,e,n)),!c&&s?.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),n||(n=O1e(e.spatialReference||e.extent||c)),_p()||uo(c.spatialReference,n)||hh(c.spatialReference,n)||await $g();const u=hne(c,n),h="center"in u?u.center:u;e.pickClosestTarget!==!1&&h.type==="point"&&s.targetGeometry?.type==="point"&&(h.x=tW(h.x,s.targetGeometry.x,h.spatialReference));let f=0;l?f=l.rotation:t.hasOwnProperty("rotation")?f=t.rotation:s&&(f=s.rotation);let g=0;g=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&r&&r.effectiveLODs?r.zoomToScale(t.zoom):Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0?s.scale:NO(hne(c.extent,n),a,f);const v=TXe(t.target??t);v&&(v.min&&v.min<g?g=v.min:v.max&&v.max>g&&(g=v.max));let x=new tu({targetGeometry:h,scale:g,rotation:f});return r&&(x=r.fit(x),r.constrainByGeometry(x),r.rotationEnabled||(x.rotation=s.rotation)),x}function la(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function AXe(t,e,n){return n?to(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):dI(t,e,.5)}const IXe=(function(){const t=Di();return function(e,n,r){const i=n.targetGeometry;rW(t,i);const s=.5*rb(n);return e.xmin=t[0]-s*r[0],e.ymin=t[1]-s*r[1],e.xmax=t[0]+s*r[0],e.ymax=t[1]+s*r[1],e.spatialReference=i.spatialReference,e}})();function RXe(t,e,n,r,i){return J7(t,e,n.center),t.scale=NO(n,r),i?.constraints?.constrain(t),t}function PXe(t,e,n,r){return oW(t,e,n,r),QB(t,t)}const D1e=(function(){const t=Di();return function(e,n,r){return wB(e,NXe(e,n),AXe(t,n,r))}})(),CXe=(function(){const t=yd(),e=Di();return function(n,r,i,s){const o=rb(r),a=iW(r);return to(e,o,o),I1e(t,e),bI(t,t,a),_2(t,t,D1e(e,i,s)),_2(t,t,[0,s.top-s.bottom]),to(n,t[4],t[5])}})();function rb(t){return t.scale*$1e(t.targetGeometry?.spatialReference)}function $1e(t){return rc(t)?1/(L1e(t)*N1e*M1e):1}function iW(t){return xB(t.rotation)||0}function MXe(t){return rc(t)?L1e(t)*N1e*M1e:1}function NXe(t,e){return dI(t,e,.5)}const sW=(function(){const t=Di(),e=Di(),n=Di();return function(r,i,s,o,a,l){return dge(t,i),dI(e,s,.5*l),to(n,1/o*l,-1/o*l),eW(r,e),a&&bI(r,r,a),MO(r,r,n),_2(r,r,t),r}})(),oW=(function(){const t=Di();return function(e,n,r,i){const s=rb(n),o=iW(n);return rW(t,n.targetGeometry),sW(e,t,r,s,o,i)}})(),OXe=(function(){const t=Di();return function(e,n,r,i){const s=rb(n);return rW(t,n.targetGeometry),sW(e,t,r,s,0,i)}})();function j1e(t){const e=La(t);return e?e.valid[1]-e.valid[0]:0}function LXe(t,e){return Math.round(j1e(t)/e)}const DXe=(function(){const t=Di(),e=Di(),n=[0,0,0];return function(r,i,s){Ak(t,r,i),s9(t,t),Ak(e,r,s),s9(e,e),pge(n,t,e);let o=Math.acos(fge(t,e)/(P4(t)*P4(e)))*SXe;return n[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),$Xe=(function(){const t=Di();return function(e,n,r,i){const s=e.targetGeometry;return la(e,n),CXe(t,n,r,i),s.x+=t[0],s.y+=t[1],e}})(),J7=function(t,e,n){la(t,e);const r=t.targetGeometry;return r.x=n.x,r.y=n.y,r.spatialReference=n.spatialReference,t},jXe=(function(){const t=Di();return function(e,n,r,i,s){s||(s="center"),wB(t,r,i),dI(t,t,.5);const o=t[0],a=t[1];switch(s){case"center":to(t,0,0);break;case"left":to(t,-o,0);break;case"top":to(t,0,a);break;case"right":to(t,o,0);break;case"bottom":to(t,0,-a);break;case"top-left":to(t,-o,a);break;case"bottom-left":to(t,-o,-a);break;case"top-right":to(t,o,a);break;case"bottom-right":to(t,o,-a)}return OO(e,n,t),e}})();function e4t(t,e,n){return la(t,e),t.rotation+=n,t}function FXe(t,e,n){return la(t,e),t.rotation=n,t}const VXe=(function(){const t=Di();return function(e,n,r,i,s){return la(e,n),isNaN(r)||r===0||(V1e(t,i,n,s),e.scale=n.scale*r,z1e(t,t,e,s),OO(e,e,to(t,t[0]-i[0],i[1]-t[1]))),e}})();function dne(t,e,n){return la(t,e),t.scale=n,t}const F1e=(function(){const t=Di();return function(e,n,r,i,s,o){return la(e,n),isNaN(r)||r===0||(V1e(t,s,n,o),e.scale=n.scale*r,e.rotation+=i,z1e(t,t,e,o),OO(e,e,to(t,t[0]-s[0],s[1]-t[1]))),e}})(),t4t=(function(){const t=Di(),e=Di();return function(n,r,i,s,o,a,l){return D1e(e,a,l),lge(t,o,e),s?F1e(n,r,i,s,t,a):VXe(n,r,i,t,a)}})(),V1e=(function(){const t=yd();return function(e,n,r,i){return Xh(e,n,PXe(t,r,i,1))}})(),z1e=(function(){const t=yd();return function(e,n,r,i){return Xh(e,n,oW(t,r,i,1))}})(),OO=(function(){const t=Di(),e=yd();return function(n,r,i){la(n,r);const s=rb(r),o=n.targetGeometry;return A1e(e,iW(r)),MO(e,e,wI(s,s)),Xh(t,i,e),o.x+=t[0],o.y+=t[1],n}})();function U1e(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function zXe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function UXe(t,e,n,r,i,s){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=s,o}function G1e(t,e,n,r){const i=e[r],s=e[r+1];t[r]=n[0]*i+n[2]*s+n[4],t[r+1]=n[1]*i+n[3]*s+n[5]}function GXe(t,e,n,r=0,i=0,s=2){const o=i||e.length/s;for(let a=r;a<o;a++)G1e(t,e,n,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:zXe,create:U1e,fromValues:UXe,transform:G1e,transformMany:GXe},Symbol.toStringTag,{value:"Module"}));function LM(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function BXe(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function WXe(t,e,n,r,i,s,o,a,l){const c=new Float32Array(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=s,c[6]=o,c[7]=a,c[8]=l,c}Object.freeze(Object.defineProperty({__proto__:null,clone:BXe,create:LM,fromValues:WXe},Symbol.toStringTag,{value:"Module"}));function B1e(){return new Float32Array(2)}function HXe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function x2(t,e){const n=new Float32Array(2);return n[0]=t,n[1]=e,n}function W1e(){return B1e()}function H1e(){return x2(1,1)}function q1e(){return x2(1,0)}function K1e(){return x2(0,1)}const qXe=W1e(),KXe=H1e(),YXe=q1e(),XXe=K1e();Object.freeze(Object.defineProperty({__proto__:null,ONES:KXe,UNIT_X:YXe,UNIT_Y:XXe,ZEROS:qXe,clone:HXe,create:B1e,fromValues:x2,ones:H1e,unitX:q1e,unitY:K1e,zeros:W1e},Symbol.toStringTag,{value:"Module"}));function ZXe(t){return t instanceof Float32Array&&t.length>=2}function JXe(t){return Array.isArray(t)&&t.length>=2}function V$(t){return ZXe(t)||JXe(t)}var Q7;const rf=[0,0];let _f=Q7=class extends qt{constructor(t){super(t),this._viewpoint2D={center:Di(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Dn,this.id=0,this.inverseTransform=yd(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=yd(),this.transformNoRotation=yd(),this.displayMat3=LM(),this.displayViewMat3=LM(),this.viewMat3=LM(),this.viewMat2d=U1e(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,n=t.targetGeometry;e.center[0]=n.x,e.center[1]=n.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=n.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,n=this.viewpoint;return n&&e?(this.viewpoint=la(n,t.viewpoint),this._set("size",Xx(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new Q7({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,n){return V$(e)?Xh(t,e,this.inverseTransform):(rf[0]=e,rf[1]=n,Xh(t,rf,this.inverseTransform))}toScreen(t,e,n){return V$(e)?Xh(t,e,this.transform):(rf[0]=e,rf[1]=n,Xh(t,rf,this.transform))}toScreenNoRotation(t,e,n){return V$(e)?Xh(t,e,this.transformNoRotation):(rf[0]=e,rf[1]=n,Xh(t,rf,this.transformNoRotation))}wrapMapCoordinate(t,e){Xx(t,e);const[n]=e,[r]=this.center,{extent:i,spatialReference:s}=this;let{xmin:o,xmax:a}=i;if(s.isWrappable){const l=j1e(s)/2;o=Math.max(o,r-l),a=Math.min(a,r+l)}return(n<o||n>a)&&(t[0]=tW(n,r,s)),t}getScreenTransform(t,e){const{center:n}=this._viewpoint2D,r=this._get("pixelRatio")||1,i=this._get("size");return sW(t,n,i,e,0,r),t}_update(){const{center:t,spatialReference:e,scale:n,rotation:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size"),o=new tu({targetGeometry:new Jt(t[0],t[1],e),scale:n,rotation:r});if(this._set("viewpoint",o),!s||!e||!n)return;this.resolution=rb(o),this.rotation=r,this.scale=n,this.spatialReference=e,Xx(this.center,t);const a=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;Zx(this.displayMat3,a,0,0,0,l,0,-1,1,1);const c=xge(this.viewMat3),u=x2(s[0]/2,s[1]/2),h=x2(-s[0]/2,-s[1]/2),f=xB(r);a9(c,c,u),Ege(c,c,f),a9(c,c,h),Rk(this.displayViewMat3,this.displayMat3,c);const g=eW(this.viewMat2d,u);return bI(g,g,f),_2(g,g,h),IXe(this.extent,o,s),oW(this.transform,o,s,i),QB(this.inverseTransform,this.transform),OXe(this.transformNoRotation,o,s,i),this.worldScreenWidth=LXe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};_([E({readOnly:!0})],_f.prototype,"id",void 0),_([E({value:1,json:{write:!0}})],_f.prototype,"pixelRatio",null),_([E({json:{write:!0}})],_f.prototype,"size",null),_([E()],_f.prototype,"spatialReference",void 0),_([E({type:tu,json:{write:!0}})],_f.prototype,"viewpoint",null),_([E({readOnly:!0})],_f.prototype,"visibleArea",null),_f=Q7=_([ue("esri.views.2d.ViewState")],_f);const fne=_f;var eV,tV;let Lf=eV=class extends Kt{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new eV({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};_([E()],Lf.prototype,"left",void 0),_([E()],Lf.prototype,"top",void 0),_([E()],Lf.prototype,"right",void 0),_([E()],Lf.prototype,"bottom",void 0),Lf=eV=_([ue("esri.views.2d.PaddedViewState.Padding")],Lf);let J_=tV=class extends fne{constructor(...t){super(...t),this.paddedViewState=new fne,this._updateContent=(()=>{const e=Di();return()=>{const n=this._get("size"),r=this._get("padding");if(!n||!r)return;const i=this.paddedViewState;to(e,r.left+r.right,r.top+r.bottom),Ak(e,n,e),Xx(i.size,e);const s=i.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(dn(()=>[this.size,this.padding],()=>this._updateContent(),Dg)),this.padding=new Lf,this.size=[0,0]}set padding(t){this._set("padding",t||new Lf)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const n=this._get("padding");n&&(e=$Xe(t.clone(),t,this._get("size"),n));const{targetGeometry:r,rotation:i,scale:s}=e,{x:o,y:a,spatialReference:l}=r,c=this._viewpoint2D;c.center[0]=o,c.center[1]=a,c.rotation=i,c.scale=s,c.spatialReference=l,this._update()}}clone(){return new tV({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};_([E()],J_.prototype,"paddedViewState",void 0),_([E({type:Lf})],J_.prototype,"padding",null),_([E()],J_.prototype,"viewpoint",null),J_=tV=_([ue("esri.views.2d.PaddedViewState")],J_);const aW=J_;let wS=class extends Kt{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};_([E()],wS.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),_([E()],wS.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),wS=_([ue("esri.views.support.debugFlags")],wS);const QXe=new wS,Y1e=Symbol("Yield");let eZe=class{constructor(){this._tasks=new Array,this._numPendingTasks=v2(0),this._readyToRun=v2(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get readyToRun(){return this._readyToRun.value}_updateReadyToRun(){this._readyToRun.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return Y1e;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,n,r){return this._addTask((i,s)=>new mne(i,s,e,n,r),Array.prototype.push)}unshift(e,n,r){return this._addTask((i,s)=>new mne(i,s,e,n,r),Array.prototype.unshift)}pushGenerator(e,n,r){return this._addTask((i,s)=>new tZe(i,s,e,n,r),Array.prototype.push)}_process(e){if(this._tasks.length===0)return!1;const n=this._tasks.shift();this._updateReadyToRun();try{if(ha(n.signal))this._cancelTask(n,Tr());else switch(n.type){case 0:this._processSimple(n,e);break;case 1:this._processGenerator(n,e);break;case 2:this._processIterator(n,e);break;default:}}catch(r){n.reject(r)}return!0}cancelAll(){const e=Tr();for(const n of this._tasks)this._cancelTask(n,e);this._tasks.length=0,this._updateReadyToRun()}_cancelTask(e,n){if(e.abortCallback){const r=e.abortCallback(n);e.type===2&&e.iterator.return&&pne(e.iterator.return()),da(r)?r.then(e.resolve,e.reject):e.resolve(r)}else e.type===2&&e.iterator.throw&&pne(e.iterator.throw(n)),e.reject(n)}_onIteratorResult(e,n){n.done?e.resolve(n.value):(this._tasks.unshift(e),this._updateReadyToRun())}_processSimple(e,n){const r=e.callback(n);da(r)?r.then(e.resolve,e.reject):e.resolve(r)}_processGenerator(e,n){const r=e.generatorFunction(n),i=new nZe(e.resolve,e.reject,r,e.signal,e.abortCallback);this._processIterator(i,n)}_processIterator(e,n){const r=e.iterator.next(n);da(r)?r.then(i=>this._onIteratorResult(e,i),e.reject):this._onIteratorResult(e,r)}_addTask(e,n){return new Promise((r,i)=>{const s=e(r,i);n.call(this._tasks,s),++this._numPendingTasks.value,this._updateReadyToRun()}).finally(()=>--this._numPendingTasks.value)}};function pne(t){da(t)?t.then(z$,z$):z$(t)}function z$(t){ya(t)||t instanceof Error||t instanceof Xe||t!=null&&typeof t=="object"&&"done"in t&&t.done||Tt.getLogger("esri.layers.support.PromiseQueue").warn("Generator iterator was aborted, but it is not done.")}let lW=class{constructor(e,n,r=void 0,i=void 0){this.resolve=e,this.reject=n,this.signal=r,this.abortCallback=i}},mne=class extends lW{constructor(e,n,r,i,s){super(e,n,i,s),this.callback=r,this.type=0}},tZe=class extends lW{constructor(e,n,r,i,s){super(e,n,i,s),this.generatorFunction=r,this.type=1}},nZe=class extends lW{constructor(e,n,r,i,s){super(e,n,i,s),this.iterator=r,this.type=2}};function rZe(){return new lZe}const Mn={RESOURCE_CONTROLLER_IMMEDIATE:"immediate",RESOURCE_CONTROLLER:"schedule",SLIDE:"slide",STREAM_DATA_LOADER:"stream loader",ELEVATION_QUERY:"elevation query",TERRAIN_SURFACE:"terrain",SURFACE_GEOMETRY_UPDATES:"surface geometry updates",LOD_RENDERER:"LoD renderer",GRAPHICS_CORE:"Graphics3D",I3S_CONTROLLER:"I3S",POINT_CLOUD_LAYER:"point cloud",FEATURE_TILE_FETCHER:"feature fetcher",STREAM_CONTROLLER:"stream controller",OVERLAY:"overlay",OVERLAY_RENDERER:"overlay renderer",STAGE:"stage",GRAPHICS_DECONFLICTOR:"graphics deconflictor",FILTER_VISIBILITY:"Graphics3D filter visibility",SCALE_VISIBILITY:"Graphics3D scale visibility",FRUSTUM_VISIBILITY:"Graphics3D frustum visibility",POINT_OF_INTEREST_FREQUENT:"POI frequent",POINT_OF_INTEREST_INFREQUENT:"POI infrequent",LABELER:"labeler",FEATURE_QUERY_ENGINE:"feature query",FEATURE_TILE_TREE:"feature tile tree",FEATURE_TILE_TREE_ACTIVE:"fast feature tile tree",ELEVATION_ALIGNMENT:"elevation alignment",ELEVATION_ALIGNMENT_SCENE:"elevation alignment scene",TEXT_TEXTURE_ATLAS:"text texture atlas",TEXTURE_UNLOAD:"texture unload",LINE_OF_SIGHT_TOOL:"line of sight tool",LINE_OF_SIGHT_TOOL_INTERACTIVE:"interactive line of sight tool",ELEVATION_PROFILE:"elevation profile",SNAPPING:"snapping",SHADOW_ACCUMULATOR:"shadow accumulator",CLOUDS_GENERATOR:"clouds generator",FLOW_GENERATOR:"flow generator",MAPVIEW_FETCH_QUEUE:"mapview fetch queue",MAPVIEW_LAYERVIEW_UPDATE:"mapview layerview update",MAPVIEW_VECTOR_TILE_PARSING_QUEUE:"mapview vector tile parsing queue",NONE:0,TEST_PRIO:1},Dc=0,gne=new Map([[Mn.RESOURCE_CONTROLLER_IMMEDIATE,Dc],[Mn.RESOURCE_CONTROLLER,4],[Mn.SLIDE,Dc],[Mn.STREAM_DATA_LOADER,Dc],[Mn.ELEVATION_QUERY,Dc],[Mn.TERRAIN_SURFACE,1],[Mn.SURFACE_GEOMETRY_UPDATES,1],[Mn.LOD_RENDERER,2],[Mn.GRAPHICS_CORE,2],[Mn.I3S_CONTROLLER,2],[Mn.POINT_CLOUD_LAYER,2],[Mn.FEATURE_TILE_FETCHER,2],[Mn.STREAM_CONTROLLER,2],[Mn.CLOUDS_GENERATOR,2],[Mn.OVERLAY,4],[Mn.OVERLAY_RENDERER,4],[Mn.STAGE,4],[Mn.GRAPHICS_DECONFLICTOR,4],[Mn.FILTER_VISIBILITY,4],[Mn.SCALE_VISIBILITY,4],[Mn.FRUSTUM_VISIBILITY,4],[Mn.POINT_OF_INTEREST_FREQUENT,6],[Mn.POINT_OF_INTEREST_INFREQUENT,30],[Mn.LABELER,8],[Mn.FEATURE_QUERY_ENGINE,8],[Mn.FEATURE_TILE_TREE,16],[Mn.FEATURE_TILE_TREE_ACTIVE,Dc],[Mn.ELEVATION_ALIGNMENT,12],[Mn.ELEVATION_ALIGNMENT_SCENE,14],[Mn.TEXT_TEXTURE_ATLAS,12],[Mn.TEXTURE_UNLOAD,12],[Mn.LINE_OF_SIGHT_TOOL,16],[Mn.LINE_OF_SIGHT_TOOL_INTERACTIVE,Dc],[Mn.SNAPPING,Dc],[Mn.SHADOW_ACCUMULATOR,30],[Mn.FLOW_GENERATOR,12],[Mn.MAPVIEW_FETCH_QUEUE,Dc],[Mn.MAPVIEW_LAYERVIEW_UPDATE,2],[Mn.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Dc]]);function yne(t){return gne.has(t)?gne.get(t):typeof t=="number"?t:1}const iZe=6.5,vne=1,sZe=30,oZe=1e3/30,aZe=100,_ne=.9;let lZe=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=v2(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new ZS("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new X1e,this.state=1,this._tasks=new Array,this._runQueue=new Array,this._load=0,this._forceTask=!1,this._debug=!1,this._debugHandle=dn(()=>QXe.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,fa);for(const e of Object.keys(Mn))this.performanceInfo.tasks.set(Mn[e],new ZS(String(Mn[e])))}destroy(){this._tasks.forEach(e=>e.remove()),this._tasks.length=0,this._runQueue.length=0,Qr(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(e,n){const r=new cZe(this,e,n);return this._tasks.push(r),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new ZS(e)),r}get load(){return this._load}frame(e){if(this._startFrameTaskTimes(),this._updateBudget(e)){const n=this._budget.now();return this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-n),!0}return this._recordFrameTaskTimes(0),!1}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let n=iZe,r=e.frameDuration,i=vne;switch(this.state){case 2:n=0,r=Math.max(aZe,e.frameDuration),i=sZe;break;case 1:r=Math.max(oZe,e.frameDuration)}return r=r-e.elapsedFrameTime-n,this.state!==2&&r<vne&&!this._forceTask?(this._forceTask=!0,!1):(r=Math.max(r,i),this._budget.reset(r),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}removeTask(e){iF(this._tasks,e),iF(this._runQueue,e),this._updatingChanged()}_updateTask(e){this._tasks.forEach(n=>{n.name===e&&n.setPriority(e)})}_getState(e){if(this._runQueue.some(r=>r.name===e))return"s";let n="i";return this._tasks.forEach(r=>{r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?n="r":n!=="r"&&(n="w"))}),n}_getRuntime(e){let n=0;return this._tasks.forEach(r=>{r.name===e&&(n+=r.runtime)}),n}_resetRuntimes(){this._tasks.forEach(e=>e.runtime=0)}_getRunning(){const e=new Map;if(this._tasks.forEach(r=>{r.needsUpdate&&e.set(r.name,(e.get(r.name)||0)+1)}),e.size===0)return null;let n="";return e.forEach((r,i)=>{n+=r>1?` ${r}x ${i}`:` ${i}`}),n}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((n,r)=>r.needsUpdate?++n:n,0);this._load=this._load*_ne+e*(1-_ne)}_schedule(){for(rDe(this._runQueue,e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)),this._tasks.forEach(e=>{e.basePriority===Dc&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});this._runQueue.length===0;){let e=!1,n=0;if(this._tasks.forEach(r=>{r.needsUpdate&&r.schedulePriority!==0&&r.basePriority!==Dc&&r.blockFrame!==this._frameNumber&&(e=!0,n=Math.max(n,r.basePriority),r.schedulePriority===1?(r.schedulePriority=0,this._runQueue.push(r)):--r.schedulePriority)}),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const e=this._budget.now(),n=this._runQueue.pop();this._budget.resetProgress();try{n.task.runTask(this._budget)===Y1e&&(n.blockFrame=this._frameNumber)}catch(i){Tt.getLogger("esri.views.support.Scheduler").error(`Exception in task "${n.name}"`,i),n.blockFrame=this._frameNumber}!this._budget.hasProgressed&&n.blockFrame!==this._frameNumber&&n.needsUpdate&&(n.name,n.blockFrame=this._frameNumber),n.schedulePriority=n.basePriority;const r=this._budget.now()-e;if(n.runtime+=r,this._frameTaskTimes.set(n.priority,this._frameTaskTimes.get(n.priority)+r),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(Mn))this._frameTaskTimes.set(Mn[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((n,r)=>this.performanceInfo.tasks.get(r).push(n)),this.performanceInfo.total.push(e)}get test(){return this._test}},cZe=class{get task(){return this._task.value}get readyToRun(){return this._queue.readyToRun}get updating(){return this._queue.updating}constructor(e,n,r){this._scheduler=e,this.name=n,this.blockFrame=0,this.runtime=0,this._queue=new eZe,this._handles=new q2,this._basePriority=yne(n),this.schedulePriority=this._basePriority,this._task=v2(r??this._queue),this._handles.add(hc(()=>this.task.readyToRun,i=>e.taskRunningChanged(i)))}remove(){this.processQueue(vT),this._scheduler.removeTask(this),this.schedule=U$.schedule,this.reschedule=U$.reschedule,this.scheduleGenerator=U$.scheduleGenerator,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const n=yne(e);this._basePriority!==Dc&&this.schedulePriority===0||(this.schedulePriority=n),this._basePriority=n}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.readyToRun||!this.task.destroyed&&this.task.readyToRun}schedule(e,n,r){return this._queue.push(e,n,r)}reschedule(e,n,r){return this._queue.unshift(e,n,r)}scheduleGenerator(e,n,r){return this._queue.pushGenerator(e,n,r)}processQueue(e){return this._queue.runTask(e)}},X1e=class{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(e()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}};const vT=new X1e;vT.enabled=!1;let uZe=class{remove(){}processQueue(){}schedule(e,n,r){try{if(ha(n)){const i=Tr();return r?Promise.resolve(r(i)):Promise.reject(i)}return uF(e(vT))}catch(i){return Promise.reject(i)}}reschedule(e,n,r){return this.schedule(e,n,r)}async scheduleGenerator(e,n,r){if(ha(n)){const s=Tr();if(r)return r(s);throw s}const i=e(vT);for(;;){const s=i.next(vT),o=da(s)?await s:s;if(ha(n)){const a=Tr();if(r){const c=r(a),u=i.return(null);return da(u)&&await n4(u),c}const l=i.throw(a);throw da(l)&&await n4(l),a}if(o.done)return o.value}}};const U$=new uZe;let hZe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=rZe(),this._schedulerHandle=hc(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||da(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=n=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:r,graphicsView:i,labelManager:s,state:{id:o}}=this.view;r?.forEach(this._updateLayerView,this),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),i!=null&&(i.lastUpdateId!==o&&(i.viewChange(),i.lastUpdateId=o),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=0:this.view.interacting?this._scheduler.state=1:this._scheduler.state=2,this._scheduler.frame(n)||this._updateRequested||this._scheduler.state!==2||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new aW,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=dn(()=>e.stationary,n=>{this.stationary=n,this.requestFrame()}),this._frameTaskHandle=s2(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const n=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0),r!==n.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=n.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function dZe(t,e){const{spatialReference:n}=e,r=[e.x,e.y];let i,s,o,a;const l=[0,0],c=fZe(t);for(let f=0;f<c.length;f++){const g=c[f];for(let v=0;v<g.length-1;v++){RVe(l,r,g,v);const x=xO(r,l);(i==null||x<i)&&(i=x,s=[...l],o=f,a=v)}}if(i==null||!s||o==null||a==null)throw new Xe("nearest-coordinate:failed","Failed to find the nearest coordinate");const[u,h]=s;return{coordinate:new Jt({x:u,y:h,spatialReference:n}),distance:i}}function fZe(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var nV;let vy=nV=class extends fB(Kt){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return av(this.geometry,this.spatialReference)}catch(t){return Tt.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const n=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?sI(this.normalizedGeometry,n):YG(this.normalizedGeometry,n))return t;const{coordinate:r}=dZe(this.normalizedGeometry,n);return r&&(t.targetGeometry=r),t}clone(){return new nV({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};_([E({constructOnly:!0})],vy.prototype,"geometry",void 0),_([E({readOnly:!0})],vy.prototype,"normalizedGeometry",null),_([E({constructOnly:!0})],vy.prototype,"spatialReference",void 0),vy=nV=_([ue("esri.views.2d.constraints.GeometryConstraint")],vy);var rV;let bS=rV=class extends fB(Kt){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new rV({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};_([E()],bS.prototype,"enabled",void 0),_([E()],bS.prototype,"rotationEnabled",void 0),bS=rV=_([ue("esri.views.2d.constraints.RotationConstraint")],bS);const Z1e=bS;var iV;let Xa=iV=class extends fB(Kt){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:n,maxScale:r,minZoom:i,maxZoom:s}=this,o=-1,a=-1,l=!1,c=!1;if(n!==0&&r!==0&&n<r&&([n,r]=[r,n]),!e?.length)return this._set("effectiveMinScale",n),void this._set("effectiveMaxScale",r);e=e.map(u=>u.clone()),e.sort((u,h)=>h.scale-u.scale),e.forEach((u,h)=>u.level=h);for(const u of e)!l&&n>0&&n>=u.scale&&(o=u.level,l=!0),!c&&r>0&&r>=u.scale&&(a=t?t.level:-1,c=!0),t=u;i===-1&&(i=n===0?0:o),s===-1&&(s=r===0?e.length-1:a),i=Math.max(i,0),i=Math.min(i,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),i>s&&([i,s]=[s,i]),n=e[i].scale,r=e[s].scale,e.splice(0,i),e.splice(s-i+1),e.forEach((u,h)=>{this._lodByScale[u.scale]=u,this._scales[h]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",i),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",n),this._set("effectiveMaxScale",r)}constrain(t,e){if(e&&t.scale===e.scale)return t;const n=this.effectiveMinScale,r=this.effectiveMaxScale,i=t.targetGeometry,s=e&&e.targetGeometry,o=r!==0&&t.scale<r,a=n!==0&&t.scale>n;if(o||a){const l=a?n:r;if(e&&s){const c=(l-e.scale)/(t.scale-e.scale);i.x=s.x+(i.x-s.x)*c,i.y=s.y+(i.y-s.y)*c}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),n=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(n>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const n=Math.floor(t),r=Math.ceil(t);return e[n]+(t-n)*(e[r]-e[n])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let n,r;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let i=0;i<e.length-1;i++){if(n=e[i],r=e[i+1],r===t)return i+this.effectiveMinZoom+1;if(n>t&&r<t)return i+this.effectiveMinZoom+1-(t-r)/(n-r)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const n=Math.round(this.scaleToZoom(t));return this.zoomToScale(n+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const n=Math.round(this.scaleToZoom(t));return this.zoomToScale(n-1)}clone(){return new iV({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,n)=>Math.abs(n-t)<=Math.abs(e-t)?n:e,this._scales[0])),this._lodByScale[t].scale}};_([E({readOnly:!0})],Xa.prototype,"effectiveLODs",void 0),_([E({readOnly:!0})],Xa.prototype,"effectiveMinZoom",void 0),_([E({readOnly:!0})],Xa.prototype,"effectiveMaxZoom",void 0),_([E({readOnly:!0})],Xa.prototype,"effectiveMinScale",void 0),_([E({readOnly:!0})],Xa.prototype,"effectiveMaxScale",void 0),_([E()],Xa.prototype,"lods",void 0),_([E()],Xa.prototype,"minZoom",void 0),_([E()],Xa.prototype,"maxZoom",void 0),_([E()],Xa.prototype,"minScale",void 0),_([E()],Xa.prototype,"maxScale",void 0),_([E()],Xa.prototype,"snapToZoom",void 0),Xa=iV=_([ue("esri.views.2d.constraints.ZoomConstraint")],Xa);const J1e=Xa,pZe={base:null,key:"type",typeMap:{extent:Dn,polygon:vi}};let zi=class extends Kt{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Ot}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new vy({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new Z1e({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),n=this.lods||this.view?.constraintsInfo.lods,r=this.minZoom,i=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===n&&e.minZoom===r&&e.maxZoom===i&&e.minScale===s&&e.maxScale===o&&e.snapToZoom===a?e:new J1e({lods:n,minZoom:r,maxZoom:i,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(e){const n=this.effectiveMaxScale;return n===0||e>=n}canZoomOutTo(e){const n=this.effectiveMinScale;return n===0||e<=n}constrain(e,n){return this._zoom.constrain(e,n),this._rotation.constrain(e,n),this._geometry.constrain(e,n),this.customConstraints.forEach(r=>r.constrain(e,n)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(n=>n.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};_([E({readOnly:!0})],zi.prototype,"effectiveLODs",null),_([E({readOnly:!0})],zi.prototype,"effectiveMinScale",null),_([E({readOnly:!0})],zi.prototype,"effectiveMaxScale",null),_([E({readOnly:!0})],zi.prototype,"effectiveMinZoom",null),_([E({readOnly:!0})],zi.prototype,"effectiveMaxZoom",null),_([E({types:pZe,value:null})],zi.prototype,"geometry",null),_([E({type:[To]})],zi.prototype,"lods",void 0),_([E()],zi.prototype,"minScale",void 0),_([E()],zi.prototype,"maxScale",void 0),_([E()],zi.prototype,"minZoom",void 0),_([E()],zi.prototype,"maxZoom",void 0),_([E()],zi.prototype,"rotationEnabled",void 0),_([E()],zi.prototype,"snapToZoom",void 0),_([E({type:Ot})],zi.prototype,"customConstraints",void 0),_([E()],zi.prototype,"view",void 0),_([E({readOnly:!0})],zi.prototype,"version",null),_([E({type:vy,readOnly:!0})],zi.prototype,"_geometry",null),_([E({type:Z1e})],zi.prototype,"_rotation",null),_([E({readOnly:!0,type:J1e})],zi.prototype,"_zoom",null),zi=_([ue("esri.views.2d.MapViewConstraints")],zi);const xne=zi;let Ho=class extends Kt{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([dn(()=>this.constraints?.version,n=>{this.constraints&&n&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Dg)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:n}=this.state.paddedViewState;return this.state.commitProperty("id"),new Jt({x:e[0],y:e[1],spatialReference:n})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let n;try{n=this._project(e,this.state.spatialReference)}catch(i){return void Tt.getLogger(this).error(new Xe("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:i}))}const r=this.viewpoint;J7(r,r,n),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void Tt.getLogger(this).error(new Xe("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let n;try{n=this._project(e,this.state.spatialReference)}catch(i){return void Tt.getLogger(this).error(new Xe("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:i}))}const r=this.viewpoint;RXe(r,r,n,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const n=this.viewpoint;FXe(n,n,e),this.viewpoint=n}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const n=this.viewpoint;dne(n,n,e),this.viewpoint=n}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let n,r;try{n=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new Xe("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(r=new Xe("mapview:invalid-viewpoint","geometry not defined"))}catch(s){r=new Xe("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(r)return void Tt.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const i=new tu({targetGeometry:new Jt,scale:0,rotation:0});la(i,n),this.constraints?.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this._set("viewpoint",i)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const n=this.constraints?.zoomToScale(e)??0;if(!n)return void this._set("zoom",-1);const r=this.viewpoint;dne(r,r,n),this.viewpoint=r,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:n,constraints:r}=this,i=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),c=this._get("zoom"),u=c!=null&&r!=null&&r.zoomToScale(c)||void 0;let h,f,g;const v=l?.rotation,x=l?.targetGeometry;x?.type==="extent"?h=x:x?.type==="point"&&(f=x,g=l?.scale);const b=s??h;return{center:i??f??b?.center,rotation:a??v,scale:(o??u??g??(b&&NO(b,[e[0]-n.left-n.right,e[1]-n.top-n.bottom])))||void 0}}startup(e,n,r,i){const s=e.targetGeometry;try{this._project(e,r)}catch(o){Tt.getLogger(this).warn(new kd("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:r,error:o})),e.targetGeometry=i||new Jt({x:0,y:0,spatialReference:r})}this.constraints?.fit(e),this._set("state",new aW({padding:this.padding,size:n,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,n],spatialReference:r,rotation:i,scale:s}=this.state.paddedViewState,o=new Jt({x:e,y:n,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",i),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){const n=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=n.scale;else{const l=n.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,n.viewpoint=l}const r=n.clone(),[i,s]=n.center;let o=null;try{o=this._project(new Jt({x:i,y:s,spatialReference:n.spatialReference}),e)}catch(l){Gfe()||Tt.getLogger(this).warn(new kd("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:l}))}o||(o=new Jt({x:0,y:0,spatialReference:e}));const a=J7(new tu({targetGeometry:new Jt,scale:0,rotation:0}),n.viewpoint,o);r.viewpoint=a;try{const c=[n.size[0]/2,n.size[1]/2],u=[c[0]+20,c[1]],h=n.toMap([0,0],u),{x:f,y:g}=this._project(new Jt({x:h[0],y:h[1],spatialReference:n.spatialReference}),e);h[0]=f,h[1]=g,r.toScreen(h,h);const v=DXe(c,h,u),x=Math.hypot(h[0]-c[0],h[1]-c[1])/20;!Number.isFinite(x)||Math.abs(x)>4?(a.rotation=0,a.targetGeometry=new Jt({x:0,y:0,spatialReference:e})):(a.scale*=x,a.scale>ye("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(v)?v:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,n){if(!this.ready)return;const r=this.state;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.slice();r.size=[e,n],jXe(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints?.constrain(i,void 0)??i,this.state.viewpoint=i}toMap(e){if(!this.ready)return null;const n=[0,0],[r,i]=this.state.toMap(n,[e.x,e.y]),s=this.state.spatialReference;return new Jt({x:r,y:i,spatialReference:s})}toScreen(e,n){if(!this.ready)return null;const r=this._project(e,this.state.spatialReference),i=[r.x,r.y];return n?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(i,i),this.state.toScreen(i,i),Fs(i[0],i[1])}_project(e,n){const r=e?.targetGeometry||e;if(!n)return e;if(!r)return null;if(n.imageCoordinateSystem||r.spatialReference?.imageCoordinateSystem||uo(n,r.spatialReference))return e;const i=av(r,n);if(!i)throw new Xe("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:n});return mZe(e)?(e.targetGeometry=i,e):i}};function mZe(t){return t?.declaredClass==="esri.Viewpoint"}_([E({type:Jt})],Ho.prototype,"center",null),_([E()],Ho.prototype,"constraints",void 0),_([E({type:Dn})],Ho.prototype,"extent",null),_([E({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],Ho.prototype,"padding",null),_([E()],Ho.prototype,"ready",void 0),_([E()],Ho.prototype,"resizeAlign",void 0),_([E({readOnly:!0})],Ho.prototype,"resolution",null),_([E({type:Number})],Ho.prototype,"rotation",null),_([E({type:Number})],Ho.prototype,"scale",null),_([E({readOnly:!0})],Ho.prototype,"state",void 0),_([E({type:tu})],Ho.prototype,"viewpoint",null),_([E({readOnly:!0})],Ho.prototype,"visibleArea",null),_([E()],Ho.prototype,"zoom",null),Ho=_([ue("esri.views.2d.ViewStateManager")],Ho);const wne=160;let ES=class extends Kt{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=wne&&this.clear()},wne))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};_([E()],ES.prototype,"_timer",void 0),_([E()],ES.prototype,"stationary",null),ES=_([ue("esri.views.2d.support.StationaryManager")],ES);const gZe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.fullOpacity=1,this.stateManager=new Ho({constraints:new xne({view:this})}),this.stationaryManager=new ES,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new hZe(this),this.viewEvents=new l1e(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([dn(()=>this.viewpoint,()=>this.stationaryManager.flip(),Dg)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(r){this.stateManager.extent=r}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(r){const i=this._get("animation");if(r===i)return;if(i&&i.stop(),r!==this.animationManager.animation&&this.animationManager.stop(),!r||r.isFulfilled())return void this._set("animation",null);this._set("animation",r);const s=()=>{this.destroyed||r===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};r.when(s,s)}get constraints(){return this.stateManager?.constraints}set constraints(r){r.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=r,i?.destroy()}get padding(){return this.stateManager?.padding}set padding(r){this.stateManager&&(this.stateManager.padding=r)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(r){this.stateManager.resizeAlign=r}get rotation(){return this.stateManager.rotation??0}set rotation(r){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=r,this.constraints.rotationEnabled=i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(r){this.stateManager.viewpoint=r,this.frameTask.requestFrame()}};return _([E({readOnly:!0})],n.prototype,"animationManager",void 0),_([E({readOnly:!0})],n.prototype,"fullOpacity",void 0),_([E()],n.prototype,"stateManager",void 0),_([E()],n.prototype,"constraintsInfo",null),_([E()],n.prototype,"extent",null),_([E({readOnly:!0})],n.prototype,"state",null),_([E({readOnly:!0})],n.prototype,"mapViewNavigation",void 0),_([E()],n.prototype,"renderingOptions",void 0),_([E({readOnly:!0})],n.prototype,"interacting",null),_([E()],n.prototype,"stationary",null),_([E()],n.prototype,"animation",null),_([E({type:xne})],n.prototype,"constraints",null),_([E()],n.prototype,"padding",null),_([E()],n.prototype,"resizeAlign",null),_([E()],n.prototype,"rotation",null),_([E({readOnly:!0})],n.prototype,"viewEvents",void 0),_([E({type:tu})],n.prototype,"viewpoint",null),n=_([ue("esri.views.Viewport2DBaseMixin")],n),n},yZe=()=>Qn.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;var Cw;let Q_=(Cw=class extends VG{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=uc(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new Xe("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,n){n||(n=da(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",n)}},Cw.state={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"},Cw);_([E({readOnly:!0})],Q_.prototype,"done",null),_([E({readOnly:!0,type:String})],Q_.prototype,"state",void 0),_([E()],Q_.prototype,"target",void 0),Q_=_([ue("esri.views.ViewAnimation")],Q_);const sV=Q_;let DM=class extends Kt{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,n){if(!e)return void Tt.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new sV;this.view.animation=r,await hB(()=>this.view.ready,n);const i={...n,animate:n?.animate??(!yZe()&&this.view.animationsEnabled),animationMode:n?.animationMode??"auto"},{extent:s,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:u,allLayerViews:h}=this.view,f=kXe(e,{extent:s,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:u,allLayerViews:h,pickClosestTarget:n?.pickClosestTarget??!0});return r?.update(f),this._gotoTask={},i.animate?this._gotoAnimated(f,i):this._gotoImmediate(f,i)}_gotoImmediate(e,n){const r=this._gotoTask,i=this.view.animation,s=e.then(o=>{if(hi(n),r!==this._gotoTask)throw new Xe("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=i.target=o,i.finish()});return this._cancellableGoTo(r,i,s,n)}_gotoAnimated(e,n){const r=this._gotoTask,i=this.view.animation;if(!i)return Promise.resolve();const s=e.then(o=>{if(hi(n),r!==this._gotoTask)throw new Xe("view:goto-interrupted","Goto was interrupted");return i.update(o),this.view.animationManager.animate(i,this.view.viewpoint,n),i.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,i,s,n)}_cancellableGoTo(e,n,r,i){const s=()=>e===this._gotoTask;return e6e(r,i).finally(()=>{s()&&(n.done||n.stop())})}};_([E({constructOnly:!0})],DM.prototype,"view",void 0),DM=_([ue("esri.views.2d.GoToManager")],DM);function Q1e(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function eve(t,e){return e.some(n=>Q1e(t,n))}function bne(t,{dragPrimary:e,dragSecondary:n,dragTertiary:r}){return[{key:"primary",value:e},{key:"secondary",value:n},{key:"tertiary",value:r}].filter(i=>i.value===t).map(i=>i.key)}let Ene=class extends Ws{constructor(e,n){super(!0),this._view=e,this.registerIncoming("double-click",n,r=>this._handleDoubleClick(r,n))}_handleDoubleClick(e,n){Q1e(e.data,"primary")&&(e.stopPropagation(),n?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},vZe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.pointerType=n,this.registerIncoming("double-tap-drag",r,i=>this._handleDoubleTapDrag(i))}_handleDoubleTapDrag(e){const{data:n}=e,{pointerType:r}=n;if(r!==this.pointerType)return;e.stopPropagation();const{action:i,delta:s}=n,{view:o}=this,{mapViewNavigation:a}=o;switch(i){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;a.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=o,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void a.end();const h=l.snapScale(this._currentScale),f=(s.y>0?Math.max(h,l.snapToPreviousScale(this._startScale)):Math.min(h,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(f).then(()=>{a.end()});break}}}},LO=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const n=e.data,r=n.pointers.size;switch(n.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},_Ze=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.pointerActions=n,this.registerIncoming("drag",r,i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new LO({start:(n,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(n,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(n,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(n,r)=>n===1&&eve(r.data,this.pointerActions)})}_handleDrag(e){const n=this.view.mapViewNavigation;n.pinch.zoomMomentum||n.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},xZe=class extends Ws{constructor(e,n,r){super(!0),this._view=e,this.pointerActions=n;const i=this._view.mapViewNavigation;this._dragEventSeparator=new LO({start:(s,o)=>{i.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{i.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{i.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&eve(o.data,this.pointerActions)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function tve(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function wZe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function bZe(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function EZe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function nve(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function rve(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function ive(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function SZe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function TZe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function kZe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function AZe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function IZe(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function RZe(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function PZe(t,e=0,n=1){return t[0]=Math.min(Math.max(t[0],e),n),t[1]=Math.min(Math.max(t[1],e),n),t[2]=Math.min(Math.max(t[2],e),n),t}function CZe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function sve(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function MZe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function ove(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function ave(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function lve(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function NZe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function OZe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function oV(t,e){const n=e[0],r=e[1],i=e[2];let s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function cve(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function LZe(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function DZe(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2],c=i*l-s*a,u=s*o-r*l,h=r*a-i*o,f=Math.sqrt(c*c+u*u+h*h);return t[0]=c/f,t[1]=u/f,t[2]=h/f,t}function $Ze(t,e,n,r){const i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function jZe(t,e,n,r,i,s){const o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return t[0]=e[0]*a+n[0]*l+r[0]*c+i[0]*u,t[1]=e[1]*a+n[1]*l+r[1]*c+i[1]*u,t[2]=e[2]*a+n[2]*l+r[2]*c+i[2]*u,t}function FZe(t,e,n,r,i,s){const o=1-s,a=o*o,l=s*s,c=a*o,u=3*s*a,h=3*l*o,f=l*s;return t[0]=e[0]*c+n[0]*u+r[0]*h+i[0]*f,t[1]=e[1]*c+n[1]*u+r[1]*h+i[1]*f,t[2]=e[2]*c+n[2]*u+r[2]*h+i[2]*f,t}function VZe(t,e=1){const n=_B,r=2*n()*Math.PI,i=2*n()-1,s=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*s,t[1]=Math.sin(r)*s,t[2]=i*e,t}function zZe(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12],t[1]=n[1]*r+n[5]*i+n[9]*s+n[13],t[2]=n[2]*r+n[6]*i+n[10]*s+n[14],t}function UZe(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function GZe(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2],u=i*c-s*l,h=s*a-r*c,f=r*l-i*a,g=i*f-s*h,v=s*u-r*f,x=r*h-i*u,b=2*o;return t[0]=a+u*b+2*g,t[1]=l+h*b+2*v,t[2]=c+f*b+2*x,t}function BZe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function WZe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function HZe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function qZe(t,e){oV(Sne,t),oV(Tne,e);const n=cve(Sne,Tne);return n>1?0:n<-1?Math.PI:Math.acos(n)}const Sne=Zg(),Tne=Zg();function KZe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function YZe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function XZe(t,e){if(t===e)return!0;const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=_l();return Math.abs(n-s)<=l*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=l*Math.max(1,Math.abs(i),Math.abs(a))}function ZZe(t,e,n){const r=n[0]-e[0],i=n[1]-e[1],s=n[2]-e[2];let o=r*r+i*i+s*s;return o>0?(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const JZe=nve,QZe=rve,eJe=ive,tJe=ove,nJe=ave,rJe=tve,iJe=lve;Object.freeze(Object.defineProperty({__proto__:null,abs:kZe,add:EZe,angle:qZe,bezier:FZe,ceil:SZe,clamp:PZe,copy:wZe,cross:LZe,crossAndNormalize:DZe,direction:ZZe,dist:tJe,distance:ove,div:eJe,divide:ive,dot:cve,equals:XZe,exactEquals:YZe,floor:TZe,hermite:jZe,inverse:OZe,len:rJe,length:tve,lerp:$Ze,max:RZe,min:IZe,mul:QZe,multiply:rve,negate:NZe,normalize:oV,random:VZe,rotateX:BZe,rotateY:WZe,rotateZ:HZe,round:CZe,scale:sve,scaleAndAdd:MZe,set:bZe,sign:AZe,sqrDist:nJe,sqrLen:iJe,squaredDistance:ave,squaredLength:lve,str:KZe,sub:JZe,subtract:nve,transformMat3:UZe,transformMat4:zZe,transformQuat:GZe},Symbol.toStringTag,{value:"Module"}));function Pu(t){let e=t*t;return t<0&&(e*=-1),e}function sJe(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function oJe(t,e,n){const r=n,i=t.state,s=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(r.translation[0]=Pu(i.axes[0]),r.translation[1]=Pu(i.axes[1]),r.translation[2]=Pu(i.buttons[7])-Pu(i.buttons[6]),r.heading=Pu(i.axes[2]),r.tilt=Pu(i.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*Pu(i.axes[0]),r.translation[1]=1.2*Pu(i.axes[1]),r.translation[2]=2*-Pu(i.axes[2]),r.heading=1.2*Pu(i.axes[5]),r.tilt=1.2*Pu(i.axes[3])),r.tilt*=o,sve(r.translation,r.translation,a),r}function aJe(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let lJe=class extends Ws{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new q2,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",n=>this._handleGamePadEvent(n)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([dn(()=>this._view.navigation.gamepad?.enabled,n=>{n?(this._handle.resume(),this._frameTask||(this._frameTask=s2({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},fa)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const n=this._view.navigation.gamepad.device;n&&e.data.device!==n||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,sJe(this._transformation)):(this._currentDevice=e.data.device,oJe(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const n=this._transformation;if(aJe(n))return void this._frameTask?.pause();const r=this._view.viewpoint.clone(),i=this._view.navigation.gamepad.velocityFactor,s=uJe*i*e;OO(r,r,[n.translation[0]*s,-n.translation[1]*s]);const o=1+n.translation[2]*hJe*e,a=this._view.constraints.rotationEnabled?-n.heading*cJe*e:0,l=this._view.size,c=[l[0]/2,l[1]];F1e(r,r,o,a,c,l);const u=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=u}};const cJe=.06,uJe=.7,hJe=6e-4;function uve(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),qn(()=>document.removeEventListener("visibilitychange",e))}let dJe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=i=>{const s=this._keyMap[i.data.key];if(i.modifiers.has("Meta")||i.modifiers.has("Control"))return void this._stopMovement();if(s==null)return;i.stopPropagation(),i.preventDefault();const o=i.type==="key-down";if(this._pressedKeys[o?"add":"delete"](s),o){if(this._direction===s)return;this._direction=s,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[n.left]:"left",[n.right]:"right",[n.up]:"up",[n.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=uve(i=>i?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const n=this._currentDirection!=null;if(e!=null){if(n||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else n&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},fJe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(n),this.registerIncoming("key-down",r,i=>this._handleKeyDown(i)),this.registerIncoming("key-up",r,i=>this._handleKeyUp(i)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=uve(i=>i?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,n){for(const r of e)this._keyToDirection.set(r,n)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,n){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const i=this._keyToDirection.get(e.data.key);if(this._pressed=i!=null,this._pressed){if(e.preventDefault(),n)switch(this.view.mapViewNavigation.begin(),i){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},pJe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._keysToZoomAction={},this.registerIncoming("key-down",r,i=>this._handleKeyDown(i)),n.zoomIn.forEach(i=>this._keysToZoomAction[i]=0),n.zoomOut.forEach(i=>this._keysToZoomAction[i]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const n=e.modifiers;if(n.size>0&&!n.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const i=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let o=null;switch(i){case 0:o=s.zoomIn();break;case 1:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),e.stopPropagation()}};const mJe=.6;let gJe=class extends Ws{constructor(e,n){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",n,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const n=this._view.mapViewNavigation,{x:r,y:i,deltaY:s}=e.data,o=1/mJe**(1/60*s),a=n.zoom(o,[r,i]);this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,n.end()})}},yJe=class extends Ws{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const n=this.view.mapViewNavigation;this._dragEventSeparator=new LO({start:(r,i)=>{n.pinch.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{n.pinch.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{n.pinch.end(this.view),i.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function kne(t){const e=t.native;return e?{buttons:e.buttons.map(n=>n.pressed?n.value||1:0),axes:e.axes.map(n=>xJe(n,t.axisThreshold))}:{buttons:[],axes:[]}}function vJe(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let n=0;n<t.axes.length;n++)if(t.axes[n]!==e.axes[n])return!1;for(let n=0;n<t.buttons.length;n++)if(t.buttons[n]!==e.buttons[n])return!1;return!0}function _Je(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function xJe(t,e){const n=Math.abs(t);return n<e?0:Math.sign(t)*(n-e)/(1-e)}let wJe=class{constructor(e,n){this._element=e,this._input=n,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,kne(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,i=window.isSecureContext;this.supported=r&&i,this.supported&&(Ane(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const n=new ZB(e);n.deviceType!=="unknown"&&(this._inputDevices[e.index]=n,this._input.gamepad.devices.add(n)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=s2({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),n=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!n;Ane(i=>{const s=this._inputDevices[i.index];if(!s)return;const o=this._latestUpdate[i.index],a=kne(s),l=r||_Je(a);o&&(o.timestamp===i.timestamp||!o.active&&l||vJe(o.state,a))||this._emitGamepadEvent(i,a,!l)})}_emitGamepadEvent(e,n,r){const i=this._latestUpdate[e.index],s=i&&i.active;if(!s&&!r)return;const o=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:n,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:n,action:o})}};function bJe(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Ane(t){for(const e of navigator.getGamepads())bJe(e)&&t(e)}const Ine=ye("edge"),EJe=ye("chrome"),SJe=ye("ff"),TJe=ye("safari"),Rne="esri-view-surface",v_={touchNone:`${Rne}--touch-none`,touchPan:`${Rne}--touch-pan`};var o1;let kJe=(o1=class{constructor(e,n){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new wJe(e,n),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=Mi(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const n in this._active)if(!e||!e.has(n)){const r=this._active[n];this._element.removeEventListener(G$[n],r),delete this._active[n]}e&&e.forEach(n=>{if(!this._active[n]&&G$[n]){const r=(this._eventHandlers[n]||this._handleDefault).bind(this,n);this._element.addEventListener(G$[n],r),this._active[n]=r}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,n){n?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?v_.touchNone:v_.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?v_.touchPan:v_.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(v_.touchNone),this._element.classList.remove(v_.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,n){const r=u1e(this._element,e);return o1.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),n.x=r.x,n.y=r.y,n}_handleKey(e,n){const{key:r}=n;r&&e==="key-up"&&this._keyDownState.delete(r);const i={native:n,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(i.key),this._callback(e,i)}_handlePointer(e,n){const r=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,pointerType:n.pointerType,button:n.button,buttons:n.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,n){const r=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,pointerType:n.pointerType,button:n.button,buttons:n.buttons,eventId:this._eventId++});n.preventDefault(),this._callback(e,r)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&ye("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,n){let r=this._getDeltaFromTrackpadOrMouseWheel(n);switch(n.deltaMode){case 0:Ine&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}Ine?r*=.7:EJe||TJe?r*=.6:SJe&&(r*=1.375);const i=100,s=Math.abs(r);s>i&&(r=r/s*200/(1+Math.exp(-.02*(s-i))));const o=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,deltaY:r});this._callback(e,o)}_handlePointerCaptureLost(e,n){this._activePointerCaptures.delete(n.pointerId),this._handleDefault(e,n)}_handleDefault(e,n){const r={native:n};n.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},o1.test={disableSubpixelCoordinates:!1},o1);const G$={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let AJe=class extends Ws{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const hve=()=>({maximumClickDelay:300}),IJe=(t={})=>({...hve(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),cW=(t={})=>({...hve(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function j4(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function RJe(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function PJe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Fs()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[I,R]=t,[M,F]=[R.x-I.x,R.y-I.y];return e.radius=Math.sqrt(M*M+F*F)/2,e.center.x=(I.x+R.x)/2,e.center.y=(I.y+R.y)/2,e}let n=0,r=0;for(let I=0;I<t.length;I++)n+=t[I].x,r+=t[I].y;n/=t.length,r/=t.length;const i=t.map(I=>I.x-n),s=t.map(I=>I.y-r);let o=0,a=0,l=0,c=0,u=0,h=0,f=0;for(let I=0;I<i.length;I++){const R=i[I],M=s[I],F=R*R,C=M*M;o+=F,a+=C,l+=R*M,c+=F*R,u+=C*M,h+=R*C,f+=M*F}const g=.5*(c+h),v=.5*(u+f),x=o*a-l*l,b=(g*a-v*l)/x,T=(o*v-l*g)/x,A=Fs(b+n,T+r);return{radius:Math.sqrt(b*b+T*T+(o+a)/t.length),center:A}}function e1(t){const{native:e}=t,{pointerId:n,button:r,pointerType:i}=e;return i==="mouse"?`${n}:${r}`:`${i}`}let CJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Fs(0,0),this._pointerState=new Map,this._parameters=cW(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new LO({start:(r,i)=>this._dragStart(r,i),update:(r,i)=>this._dragUpdate(i),end:(r,i)=>this._dragEnd(i)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Qr(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const n=this._pointerState.get(e);n&&(n.doubleTapTimeout=Qr(n.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,n){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:i}=n,{center:s}=r;this._dragStartCenter=s;const o=B$("begin",Fs(0,0),r);this._doubleTapDrag.emit(o,void 0,i),n.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:n,modifiers:r}=e,{center:i}=n,s=B$("update",Fs(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),n);this._doubleTapDrag.emit(s,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:n,modifiers:r}=e,{center:i}=n,s=B$("end",Fs(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),n);this._doubleTapDrag.emit(s,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:n}=e,r=e1(n),i=this._pointerState.get(r),{pointerType:s}=n.native;if(i){const o=s==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(r),j4(i.event.data,n)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:n}=e,{pointerType:r}=n.native,i=e1(n),s=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(i),s);this._pointerState.set(i,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function B$(t,e,n){const{button:r,buttons:i,pointer:s,pointers:o,pointerType:a,timestamp:l}=n;return{action:t,delta:e,button:r,buttons:i,pointer:s,pointers:o,pointerType:a,timestamp:l}}let MJe=class extends Ws{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,n,r,i){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:n.buttons,timestamp:i,pointers:NJe(this._activePointerMap),pointer:n,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const n=e.native.pointerId,r=BP(this._activePointerMap).angle,i={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(n,i);const s=$M(i,dve(this._activePointerMap));i.initialAngle=s,i.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const n=e.native.pointerId,r=this._activePointerMap.get(n);r?r.event=e:this._addPointer(e)}_removePointer(e){const n=BP(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(n)}_updatePointerAngles(e){const n=BP(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=$M(r,n)-e,r.lastAngle=$M(r,n)-e})}_emitEvent(e,n,r){const i=BP(this._activePointerMap);this._drag.emit(this._createPayload(e,n,i,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const n=e.data.native.pointerId,r=e.timestamp;this._activePointerMap.get(n)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(n)):(this._removePointer(n),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const n=e.data,r=n.currentEvent,i=e.timestamp;switch(n.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,i)):(this._addPointer(r),this._emitEvent("added",r,i),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,i))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function dve(t){const e=[];return t.forEach(n=>{e.push(Fs(n.event.x,n.event.y))}),PJe(e)}function BP(t){const e=dve(t);let n=0;return t.forEach(r=>{let i=$M(r,e),s=i-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;i=r.lastAngle+s,r.lastAngle=i;const o=i-r.initialAngle;n+=o}),n/=t.size||1,{angle:n,radius:e.radius,center:e.center}}function NJe(t){const e=new Map;return t.forEach((n,r)=>e.set(r,n.event)),e}function $M(t,e){const n=t.event,r=n.x-e.center.x,i=n.y-e.center.y;return Math.atan2(i,r)}let OJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=cW(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const n=e.data,r=e1(n);if(!this._pointerState.has(r)){const i={downButton:n.native.button,x:n.x,y:n.y,immediateDoubleClick:null};this._pointerState.set(r,i),this.startCapturingPointer(n.native)}}_handlePointerUp(e){const n=e.data,r=e1(n),i=this._pointerState.get(r);if(i&&i.downButton===n.native.button){const s=i.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;s?(s.timeoutHandle.remove(),j4(s,e.data)>o?this._startImmediateDoubleClick(e,i):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(n))):j4(i,e.data)>o?this._removeState(n):this._startImmediateDoubleClick(e,i)}}_startImmediateDoubleClick(e,n){const r=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;n.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const n=e1(e);this._pointerState.delete(n),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},LJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=IJe(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",r=>this._handlePointerLoss(r,"pointer-up")),this.registerIncoming("pointer-capture-lost",r=>this._handlePointerLoss(r,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",r=>this._handlePointerLoss(r,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",r=>this._handlePointerMove(r)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Qr(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const n=e.data,r=n.native.pointerId;let i=null;this._pointerState.size===0&&(i=this._clock.setTimeout(()=>{const o=this._pointerState.get(r);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._parameters.holdDelay));const s={startEvent:n,previousEvent:n,startTimestamp:e.timestamp,isDragging:!1,downButton:n.native.button,holdTimeout:i,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(n.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const n=e.data,r=n.native.pointerId,i=this._pointerState.get(r);i&&(i.isDragging?this._pointerDrag.emit(WP("update",i,n),void 0,i.modifiers):RJe(n,i.startEvent)>this._getDragThreshold(n.native.pointerType)&&this._startDragging(e),i.previousEvent=n)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const n=e.data,r=n.native.pointerId;this._pointerState.forEach(i=>{i.holdTimeout!=null&&(i.holdTimeout.remove(),i.holdTimeout=null),i.isDragging||(i.modifiers=e.modifiers,i.isDragging=!0,r===i.startEvent.native.pointerId?this._pointerDrag.emit(WP("start",i,n)):this._pointerDrag.emit(WP("start",i,i.previousEvent),e.timestamp))})}_handlePointerLoss(e,n){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(WP("end",s,n==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):n==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._parameters.maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(i),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function WP(t,e,n){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:n}}let DJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=cW(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",r=>this._handleImmediateClick(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Qr(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,n){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=Qr(r.doubleClickTimer),n&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const n=this._pointerState.get(e);n.pointerDownCount===1&&this._click.emit(n.event.data,void 0,n.event.modifiers),n.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const n=e.data,{pointerType:r}=n.native,i=$Je(n);if(!this._pointerState.has(i))return void this._startClick(e);const s=this._pointerState.get(i),{data:o,modifiers:a}=s.event,l=r==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;j4(o,n)>l?(this._clearDoubleClickTimer(i,!0),this._startClick(e)):(this._clearDoubleClickTimer(i,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const n=e1(e.data),r=this._pointerState.get(n);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:n}=e,{native:{pointerType:r}}=n,i=e1(n),s=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(i),s);this._pointerState.set(i,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function $Je(t){const{pointerId:e,pointerType:n,button:r}=t.native;return n==="mouse"?`${e}:${r}`:`${n}`}const HP={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},Pne=Symbol("handles");let ex=class extends Kt{initialize(){const e=()=>this.view?.ready;this.addHandles([hc(()=>!e(),()=>this._disconnect()),hc(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerInfo(){return this._inputManager?.latestPointerInfo}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(Pne),this._inputManager=Mi(this._inputManager)}_connect(){const e=this.view.surface,n=new kJe(e,this.view.input),r=[new OJe,new LJe,new DJe,new MJe(this.view.navigation),new CJe],i=new Lu({eventSource:n,recognizers:r}),s=new _Ze(this.view,["primary"]),o=new xZe(this.view,["secondary"]);i.installHandlers("prevent-context-menu",[new AJe],Xf.INTERNAL),i.installHandlers("navigation",[new yJe(this.view),new lJe(this.view),new gJe(this.view),new Ene(this.view),new Ene(this.view,[HP.counter]),s,new dJe(this.view,HP.pan),new pJe(this.view,HP.zoom),new fJe(this.view,HP.rotate),o,new vZe(this.view,"touch")],Xf.INTERNAL),this.view.viewEvents.connect(i),this._source=n,this._inputManager=i,this.addHandles([dn(()=>this.view?.navigation?.browserTouchPanEnabled,a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)},fa),dn(()=>{const{actionMap:a}=this.view.navigation;return{panActions:bne("pan",a),rotateActions:bne("rotate",a)}},({panActions:a,rotateActions:l})=>{s.pointerActions=a,o.pointerActions=l},ea)],Pne)}get test(){}};_([E()],ex.prototype,"view",void 0),_([E()],ex.prototype,"latestPointerInfo",null),_([E()],ex.prototype,"multiTouchActive",null),ex=_([ue("esri.views.2d.input.MapViewInputManager")],ex);const jJe=ex,FJe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.goToManager=new DM({view:this}),this.animationsEnabled=!0,this.inputManager=new jJe({view:this}),this.addHandles([this.on("resize",i=>this.stateManager.resize(i.width,i.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(r,i,s,o){return this.viewEvents.on(r,i,s,o)||super.on(r,i)}hasEventListener(r){return super.hasEventListener(r)||this.viewEvents.hasHandler(r)}goTo(r,i){return this.goToManager.goTo(r,i)}toMap(r){if(!this.ready)return null;const i=d1e(r)?h1e(this,r):r;return this.stateManager.toMap(i)}};return _([E()],n.prototype,"goToManager",void 0),_([E({readOnly:!0})],n.prototype,"interacting",null),_([E()],n.prototype,"stationary",null),_([E()],n.prototype,"animationsEnabled",void 0),_([E({readOnly:!0})],n.prototype,"inputManager",void 0),n=_([ue("esri.views.Viewport2DMixin")],n),n};let Cne=class{constructor(e){this._view=e,this.viewpoint=new tu({targetGeometry:new Jt,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,n]=this._view.size;return Math.sqrt(e*e+n*n)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return $1e(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,n){n.pan=upe(this.center,e.center);let r=Math.abs(e.rotation-this.rotation);r=r>=180?360-r:r,n.rotate=uI(r),n.sourceZoom=this.scale,n.targetZoom=e.scale}interpolate(e,n,r){const{pan:i,rotate:s,zoom:o,zoomOffset:a}=r,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=eS(e.center.x,n.center.x,i),l.y=eS(e.center.y,n.center.y,i),this.viewpoint.scale=eS(e.scale,n.scale+a,o);let c=e.rotation;const u=n.rotation;Math.abs(u-c)>=180&&(c+=360*(c<u?1:-1)),this.viewpoint.rotation=eS(c,u,s)}copyFrom(e){la(this.viewpoint,e.viewpoint),this._view=e.view}};function AE(t,e,n,r){const i=3*t,s=3*(n-t)-i,o=1-i-s,a=3*e,l=3*(r-e)-a,c=1-a-l;function u(v){return((o*v+s)*v+i)*v}function h(v){return((c*v+l)*v+a)*v}function f(v){return(3*o*v+2*s)*v+i}function g(v,x){let b,T,A,I,R,M;for(A=v,M=0;M<8;M++){if(I=u(A)-v,Math.abs(I)<x)return A;if(R=f(A),Math.abs(R)<1e-6)break;A-=I/R}if(b=0,T=1,A=v,A<b)return b;if(A>T)return T;for(;b<T;){if(I=u(A),Math.abs(I-v)<x)return A;v>I?b=A:T=A,A=.5*(T-b)+b}return A}return function(v,x=1e-6){return h(g(v,x))}}const jc={};jc.ease=AE(.25,.1,.25,1),jc.linear=AE(0,0,1,1),jc.easeIn=jc["ease-in"]=AE(.42,0,1,1),jc.easeOut=jc["ease-out"]=AE(0,0,.58,1),jc.easeInOut=jc["ease-in-out"]=AE(.42,0,.58,1);const VJe=t=>t,Gk=t=>t*t,F4=t=>1-Gk(1-t),Mne=t=>t<.5?Gk(2*t)/2:(F4(2*(t-.5))+1)/2,V4=t=>t*t*t,aV=t=>1-V4(1-t),Nne=t=>t<.5?V4(2*t)/2:(aV(2*(t-.5))+1)/2,z4=t=>t*t*t*t,lV=t=>1-z4(1-t),One=t=>t<.5?z4(2*t)/2:(lV(2*(t-.5))+1)/2,U4=t=>t*t*t*t*t,cV=t=>1-U4(1-t),Lne=t=>t<.5?U4(2*t)/2:(cV(2*(t-.5))+1)/2,G4=t=>1-Math.cos(t*Math.PI/2),uV=t=>1-G4(1-t),Dne=t=>t<.5?G4(2*t)/2:(uV(2*(t-.5))+1)/2,B4=t=>2**(10*(t-1)),W4=t=>1-B4(1-t),$ne=t=>t<.5?B4(2*t)/2:(W4(2*(t-.5))+1)/2,H4=t=>-(Math.sqrt(1-t*t)-1),hV=t=>1-H4(1-t),jne=t=>t<.5?H4(2*t)/2:(hV(2*(t-.5))+1)/2;function hu(t){const e=2*(t-Math.sqrt((t-1)*t)),n=e/2/t;return r=>r<n?t*r*r:e*r-e+1}function du(t,e){return(n,r)=>n<e?e*t(n/e,r):1-t((1-n)/(1-e),r)*(1-e)}const Fne=du(hu(1),1),Vne=du(hu(1),0),q4=du(hu(1),.5),zne=du(hu(2),1),Une=du(hu(2),0),Gne=du(hu(2),.5),Bne=du(hu(3),1),Wne=du(hu(3),0),Hne=du(hu(3),.5),qne=du(hu(4),1),Kne=du(hu(4),0),Yne=du(hu(4),.5),Xne={linear:VJe,"in-quad":Gk,"out-quad":F4,"in-out-quad":Mne,"in-coast-quad":Fne,"out-coast-quad":Vne,"in-out-coast-quad":q4,"in-cubic":V4,"out-cubic":aV,"in-out-cubic":Nne,"in-coast-cubic":zne,"out-coast-cubic":Une,"in-out-coast-cubic":Gne,"in-quart":z4,"out-quart":lV,"in-out-quart":One,"in-coast-quart":Bne,"out-coast-quart":Wne,"in-out-coast-quart":Hne,"in-quint":U4,"out-quint":cV,"in-out-quint":Lne,"in-coast-quint":qne,"out-coast-quint":Kne,"in-out-coast-quint":Yne,"in-sine":G4,"out-sine":uV,"in-out-sine":Dne,"in-expo":B4,"out-expo":W4,"in-out-expo":$ne,"in-circ":H4,"out-circ":hV,"in-out-circ":jne,"quad-in":Gk,"quad-out":F4,"quad-in-out":Mne,"quad-in-coast":Fne,"quad-out-coast":Vne,"quad-in-out-coast":q4,"cubic-in":V4,"cubic-out":aV,"cubic-in-out":Nne,"cubic-in-coast":zne,"cubic-out-coast":Une,"cubic-in-out-coast":Gne,"quart-in":z4,"quart-out":lV,"quart-in-out":One,"quart-in-coast":Bne,"quart-out-coast":Wne,"quart-in-out-coast":Hne,"quint-in":U4,"quint-out":cV,"quint-in-out":Lne,"quint-in-coast":qne,"quint-out-coast":Kne,"quint-in-out-coast":Yne,"sine-in":G4,"sine-out":uV,"sine-in-out":Dne,"expo-in":B4,"expo-out":W4,"expo-in-out":$ne,"circ-in":H4,"circ-out":hV,"circ-in-out":jne,ease:t=>jc.ease(t),"ease-in":t=>jc.easeIn(t),"ease-out":t=>jc.easeOut(t),"ease-in-out":t=>jc.easeInOut(t)};let zJe=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const K4={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},fve={maxDuration:4e3};let UJe=class pve{constructor(e){this._createCamera=e,this.compared=new zJe,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:K4.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new pve(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,n,r){this.source!==e&&this.source.copyFrom(e),this.target!==n&&this.target.copyFrom(n),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow??K4.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const n=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/n}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>_l()}get hasFov(){return Math.abs(this.compared.fov)>_l()}get hasRotate(){return this.compared.rotate>_l()}},GJe=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},BJe=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,n)=>e+n.time,0)}interpolateComponentsAt(e,n){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,i=0;const s=this.definition,o=this.segments.reduce((a,l)=>a||l.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],c=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,n),s.hasPan&&!isNaN(n.pan)&&isFinite(s.compared.pan)?n.pan=(r+c.compared.pan*n.pan)/s.compared.pan:n.pan=1,s.hasRotate&&!isNaN(n.rotate)&&isFinite(s.compared.rotate)?n.rotate=(i+c.compared.rotate*n.rotate)/s.compared.rotate:n.rotate=1,o&&!isNaN(n.zoom)&&isFinite(c.compared.targetZoom)){const{sourceZoom:u,targetZoom:h}=c.compared,f=n.zoom*(h-u)+u,g=this.segments[0].definition.compared.sourceZoom,v=this.segments[this.segments.length-1].definition.compared.targetZoom,x=Math.abs(h-g)>Math.abs(u-g)?h:u;n.zoomOffset=x-v,n.zoom=(f-g)/(x-g)}else n.zoom=1;return n}e-=l.time,r+=c.compared.pan,i+=c.compared.rotate}}segmentInterpolateComponentsAt(e,n,r){e.interpolateComponentsAt(n,r)}},W$=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,n=e.compared,r=n.sourceZoom,i=n.targetZoom;this._zoomSign=r>i?1:-1,this._panPixelsAtSource=n.pan*e.source.pixelsPerPanAtZoom(r);const s=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=n.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom,{hasZoom:r,hasPan:i,hasRotate:s}=this.definition;let o=0,a=0;r&&(i&&(o=(n/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(a=this._zoomSign*(Math.log(e/n)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&i&&s){const c=o+a+o*a;this._zoomPixelFlow=o*a/c*l,this._panPixelFlow=a/c*l,this._rotatePixelFlow=o/c*l}else if(r&&i){const c=1+o;this._zoomPixelFlow=o/c*l,this._panPixelFlow=1/c*l}else if(r&&s){const c=1+a;this._zoomPixelFlow=a/c*l,this._rotatePixelFlow=1/c*l}else if(i&&s){const c=this._panPixelsAtSource/this._rotatePixels,u=1+c;this._panPixelFlow=c/u*l,this._rotatePixelFlow=1/u*l}else i?this._panPixelFlow=l:r?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const c=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=c,this._panPixelFlow/=c,this._rotatePixelFlow/=c}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/WJe:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,n=e*this._panPixelsAtSource;return Math.log(n*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const n=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(n*(n/r)**-e-n)/(r-n)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:n,segmentEnd:r}=this.definition;return n+e*(r-n)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const n=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(n*e*this._time)-1))/(n*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,n){e=Math.min(Math.max(e,0),1),n.zoom=this._interpolateComponentsZoom(e),n.pan=this._interpolateComponentsPan(e),n.rotate=this._interpolateComponentsRotate(e),n.zoomOffset=0,n.fov=this._interpolateComponentsFov(e)}};const WJe=uI(45);function HJe(t,e,n){const r=e-t.compared.sourceZoom,i=t.halfWindowPanAtZoom(r);return-t.halfWindowSize*(n.ascensionFactor*Math.LN2*t.compared.pan+i)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*i)}function qJe(t,e,n){const r=1/e,i=Math.log(t.compared.sourceZoom*r),s=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,c=(n.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*s*o*l*c-t.halfWindowSize*i*s*o*l+t.halfWindowSize*i*s*o*c/(a*a)}function KJe(t,e,n){const r=e-t.compared.sourceZoom,i=1/r,s=1/e,o=Math.log(t.compared.sourceZoom*s),a=(n.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(r))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*(-2*i*s*a+2*i*o+2*s-2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function YJe(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function XJe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function ZJe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function JJe(t,e,n){return-t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function QJe(t,e,n){return t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function eQe(t,e,n){return-2*t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function tQe(t,e,n){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-n.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function nQe(t,e,n){const r=Math.log(e/t.compared.targetZoom),i=1/t.desiredPixelFlow,s=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-n.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*r*i*s*a+t.halfWindowSize*r*i*s*l/(o*o)+t.halfWindowSize*i*s*a*l/e}function rQe(t,e,n){const r=e-t.compared.targetZoom,i=1/r,s=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+n.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*(-2*i*s*a-2*i*o+2*s+2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function iQe(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function sQe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function oQe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function aQe(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const n=Math.LN2*t.compared.pan,r=e,i=t.halfWindowPanAtZoom(r),s=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*i);return t.compared.sourceZoom<=t.compared.targetZoom?s*(n-i):s*(n+i)}function lQe(t,e){let n=cQe(t,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},i=r.ascensionFactor===0,s=r.descensionFactor===0,o=i?YJe:HJe,a=i?XJe:qJe,l=i?ZJe:KJe,c=s?iQe:tQe,u=s?sQe:nQe,h=s?oQe:rQe,f=M=>o(t,M,r)+JJe(t,M,r)+c(t,M,r),g=M=>a(t,M,r)+QJe(t,M,r)+u(t,M,r),v=M=>l(t,M,r)+eQe(t,M,r)+h(t,M,r);let x=f(n);const b=aQe(t);let T;const A=e.maximumIterations||20,I=e.maximumDistance!=null?e.maximumDistance:1/0;for(T=0;T<A;T++){const M=e.desiredSlope??1e-6;let F=g(n);Math.abs(F)>M&&(F+=M);const C=F/v(n);if(isNaN(C)||n>=I&&C<0){if(!isFinite(I))return null;n=I,x=f(n);break}if(n-=C,n<=t.compared.sourceZoom||n<=t.compared.targetZoom)return null;const N=f(n);if(Math.abs(N-x)/x<=.005)break;x=N}return isNaN(x)||x>b*(1-.3)||n<=t.compared.sourceZoom||n<=t.compared.targetZoom?null:n}function cQe(t,e){const n=Math.max(t.compared.sourceZoom,t.compared.targetZoom),r=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return r<n?e.maximumDistance!=null?n+(e.maximumDistance-n)/2:1.5*n:e.maximumDistance?Math.min(e.maximumDistance,r):r}let uQe=class extends BJe{constructor(e,n){super(),this._preallocSegments=[new W$,new W$,new W$],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,n)}update(e,n){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const r=n?.apex?lQe(e,n.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,n?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,n,r){e.interpolateComponentsAt(n,r),e===this._ascensionSegment?r.zoom=F4(r.zoom):e===this._descensionSegment&&(r.zoom=Gk(r.zoom))}_updateWithApex(e,n){const[r,i,s]=this._preallocSegments,o=n?.ascensionFactor??.5,a=Math.min(1-o,n?.ascensionFactor!=null&&n.descensionFactor!=null?n.descensionFactor:.5),l=1-o-a;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*o,r.definition.compared.rotate=this.definition.compared.rotate*o,r.definition.segmentEnd=o,r.update(),this._ascensionSegment=r,this.segments.push(r),l>0&&(i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.copyFrom(this.definition),i.definition.compared.sourceZoom=e,i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*l,i.definition.compared.rotate=this.definition.compared.rotate*l,i.definition.segmentStart=r.definition.segmentEnd,i.definition.segmentEnd=r.definition.segmentEnd+l,i.update(),this.segments.push(i)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*a,s.definition.compared.rotate=this.definition.compared.rotate*a,s.definition.segmentStart=o+l,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const hQe=new GJe;let dQe=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=q4,this.definition=new UJe(e),this.path=new uQe}update(e,n,r){this.definition.update(e,n,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(s$e(isFinite(this.path.time)?this.path.time:0),r),this._easing=r.easing??(this._time>=1e3?q4:W4)}cameraAt(e,n){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,hQe);n.interpolate(this.definition.source,this.definition.target,r)}_normalizedEasing(e){const n=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-n)/(r-n)}_applyTimeSettings(e,n){const r=n.speedFactor!=null?n.speedFactor:1,i=n.minDuration??K4.minDuration/r,s=n.maxDuration??K4.maxDuration/r;return e=n.duration!=null?n.duration:Math.min(Math.max(e/r,i),s)}};const fQe=2e3,pQe=64;let mQe=class{constructor(e){this._view=e,this._animation=new dQe(()=>new Cne(this._view)),this._current=new Cne(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,n,r={}){la(this._current.viewpoint,e),la(this._source.viewpoint,e),la(this._target.viewpoint,n),this._animation.update(this._source,this._target,r)}applyRatio(e,n){this._animation.cameraAt(n,this._current),la(e,this._current.viewpoint)}},tx=class extends Kt{constructor(e){super(e),this._animation=null,this._destinationViewState=new aW,this.updateFunction=null,this.easing=Xne.ease,this.viewpoint=new tu({targetGeometry:new Jt,scale:0,rotation:0}),this._updateTask=s2({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new mQe(e.view)}destroy(){this._updateTask=Qr(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,n,r){this.stop();const i=this.viewpoint;la(i,n);const s=e.target;this._transition.update(this.viewpoint,s,{apex:{maximumDistance:Math.min(Math.min(n.scale,s.scale)*pQe,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:r?.duration,maxDuration:r?.animationMode==="auto"?1/0:r?.maxDuration??fve.maxDuration,speedFactor:r?.speedFactor,easing:(typeof r?.easing=="string"?Xne[r.easing]:r?.easing)||this.easing}),r?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=s,gQe(this._transition.animation,r,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,s,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,n){this.stop(),this.updateFunction=n,this.viewpoint=e;const r=new sV({target:e.clone()}),i=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(i,i),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const n=this.animation;if(n&&n.state!==sV.state.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const r=performance.now()-this._startTime,i=this._transition.duration,s=i>0?r/i:1,o=s>=1;this._transition.applyRatio(this.viewpoint,s),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function gQe(t,e,n,r){if(e?.duration!=null)return!0;const{time:i,isLinear:s}=t,o=e?.speedFactor||1;if(i>(e?.maxDuration??fve.maxDuration/o))return!1;if(s){const l=Di(),c=Fs(...r.toScreen(l,...n.center)),u=Fs(...n.toScreen(l,...r.center)),h=u!=null&&u.x>-1*n.size[0]&&u.x<(1.5+.5)*n.size[0]&&u.y>-1*n.size[1]&&u.y<(1.5+.5)*n.size[1],f=c!=null&&c.x>-1*r.size[0]&&c.x<(1.5+.5)*r.size[0]&&c.y>-1*r.size[1]&&c.y<(1.5+.5)*r.size[1];if(i>fQe/o&&!h&&!f)return!1}return!0}_([E()],tx.prototype,"easing",void 0),_([E()],tx.prototype,"view",void 0),_([E()],tx.prototype,"viewpoint",void 0),tx=_([ue("esri.views.2d.AnimationManager")],tx);const yQe=tx;function ni(){return Promise.all([_e(()=>import("./webglDeps-BqjsH8Rb.js"),__vite__mapDeps([305,247,306,307,308,49,142])),_e(()=>import("./mapViewDeps-bU-Fi3lF.js"),__vite__mapDeps([309,28,29,30,179,180,172,50,49,181,33,34,178,182,168,18,19,310,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,315,183,184,316,39,40,170,127,128,317,108,305,318,196,319,320,223,321,236,237,322,48,166,171,173,22,122,121,323,185,324,177,102,103,104,325,187,192,164,326,327,328,329,243,267,330,331]))])}const IE=()=>ni().then(()=>_e(()=>import("./TileLayerView2D-DiXzfVW4.js"),__vite__mapDeps([332,178,34,179,180,172,50,49,181,33,182,168,18,19,316,28,29,30,39,40,170,127,128,317,108,314,57,313,167,141,307,308,142,246,247,201,224,227,118,51,318,311,306,238,312,174,196,319,320,223,48,310,169,8,175,186,183,184,236,237,325,166,171,173,22,122,121,187,192,164,333,334,335,329,336,290,337,327,328,338,339,340,267,341,342,343,344,345]))),I0=()=>ni().then(()=>_e(()=>import("./FeatureLayerView2D-Hp17_mr7.js").then(t=>t.F),__vite__mapDeps([346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),Zne={"base-dynamic":()=>ni().then(()=>_e(()=>import("./BaseDynamicLayerView2D-edvgNSUJ.js"),__vite__mapDeps([351,352,313,167,168,141,307,308,49,142,246,247,201,314,57,224,227,118,50,51,334,311,306,238,335,336,290,353,338,339]))),"base-tile":IE,"bing-maps":IE,catalog:()=>ni().then(()=>_e(()=>import("./CatalogLayerView2D-i15e60qX.js"),__vite__mapDeps([354,336,314,57,290,338]))),"catalog-dynamic-group":()=>ni().then(()=>_e(()=>import("./CatalogDynamicGroupLayerView2D-k_BGeOuw.js"),__vite__mapDeps([355,336,314,57,290,338]))),"catalog-footprint":()=>ni().then(()=>_e(()=>import("./CatalogFootprintLayerView2D-ChzWgQYK.js"),__vite__mapDeps([356,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),csv:I0,"geo-rss":()=>ni().then(()=>_e(()=>import("./GeoRSSLayerView2D-BtlIz1O8.js"),__vite__mapDeps([357,3,231,12,13,14,15,8,16,17,18,19,229,230,11,20,35,36,176,39,40,170,127,128,33,34,109,29,30,21,22,23,43,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,178,182,311,238,312,174,175,186,325,316,28,317,108,166,171,173,122,121,187,192,164,338]))),feature:I0,geojson:I0,parquet:I0,graphics:()=>ni().then(()=>_e(()=>import("./GraphicsLayerView2D-CnaUkfxc.js"),__vite__mapDeps([358,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,33,34,178,182,18,19,311,238,312,174,8,175,186,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338,345]))),group:()=>ni().then(()=>_e(()=>import("./GroupLayerView2D-DQVzVq8t.js"),__vite__mapDeps([359,336,314,57,290,338]))),imagery:()=>ni().then(()=>_e(()=>import("./ImageryLayerView2D-Wk5f6XML.js"),__vite__mapDeps([360,361,308,49,142,246,247,141,38,313,167,168,307,201,314,57,224,227,118,50,51,27,25,336,290,325,39,40,179,180,172,181,33,34,178,182,18,19,316,28,29,30,170,127,128,317,108,166,169,171,173,22,174,122,121,310,311,306,238,312,8,175,186,187,192,164,337,327,328,329,352,334,335,353,210,42,347,344,338,339,345]))),"imagery-tile":()=>ni().then(()=>_e(()=>import("./ImageryTileLayerView2D-BfVdB5LH.js"),__vite__mapDeps([362,9,361,308,49,142,246,247,141,38,313,167,168,307,201,314,57,224,227,118,50,51,27,25,336,290,209,363,329,311,306,238,324,312,174,335,364,210,345,42,347,344,338,339]))),kml:()=>ni().then(()=>_e(()=>import("./KMLLayerView2D-DQa7eMxA.js"),__vite__mapDeps([365,366,229,230,11,12,13,14,15,8,16,17,18,19,20,35,36,176,39,40,170,127,128,33,34,109,29,30,231,21,22,23,43,334,314,57,311,247,306,307,238,335,352,313,167,168,141,308,49,142,246,201,224,227,118,50,51,336,290,326,327,328,169,329,310,179,180,172,181,178,182,312,174,175,186,325,316,28,317,108,166,171,173,122,121,187,192,164,338,102,103,104,210,321,305,236,237,319,363]))),"knowledge-graph":()=>ni().then(()=>_e(()=>import("./KnowledgeGraphLayerView2D-DYP__jux.js"),__vite__mapDeps([367,336,314,57,290,338]))),"link-chart":()=>ni().then(()=>_e(()=>import("./KnowledgeGraphLayerView2D-DYP__jux.js"),__vite__mapDeps([367,336,314,57,290,338]))),"knowledge-graph-sublayer":I0,"map-image":()=>ni().then(()=>_e(()=>import("./MapImageLayerView2D-wOVnJ7Ak.js"),__vite__mapDeps([368,352,313,167,168,141,307,308,49,142,246,247,201,314,57,224,227,118,50,51,334,311,306,238,335,336,290,325,39,40,179,180,172,181,33,34,178,182,18,19,316,28,29,30,170,127,128,317,108,166,169,171,173,22,174,122,121,310,312,8,175,186,187,192,164,337,327,328,329,353,338,369,267,341,343,347,339,340,342,344,345]))),"map-notes":()=>ni().then(()=>_e(()=>import("./MapNotesLayerView2D-CLlved2I.js"),__vite__mapDeps([370,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,33,34,178,182,18,19,311,238,312,174,8,175,186,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338,345]))),media:()=>ni().then(()=>_e(()=>import("./MediaLayerView2D-C3nl4_F9.js"),__vite__mapDeps([371,372,192,231,12,13,14,15,8,16,17,18,19,178,34,179,180,172,50,49,181,33,182,168,316,28,29,30,39,40,170,127,128,317,108,314,57,313,167,141,307,308,142,246,247,201,224,227,118,51,318,311,306,238,312,174,196,319,320,223,48,310,169,175,186,183,184,236,237,325,166,171,173,22,122,121,187,164,323,185,373,324,336,290,338]))),"ogc-feature":()=>ni().then(()=>_e(()=>import("./OGCFeatureLayerView2D-r27ZW3U3.js"),__vite__mapDeps([374,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),"open-street-map":IE,"oriented-imagery":I0,route:()=>ni().then(()=>_e(()=>import("./RouteLayerView2D-DGapfdfh.js"),__vite__mapDeps([375,376,377,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,33,34,178,182,18,19,311,238,312,174,8,175,186,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338,345]))),stream:()=>ni().then(()=>_e(()=>import("./StreamLayerView2D-CBlFjVdK.js"),__vite__mapDeps([378,43,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),"subtype-group":()=>ni().then(()=>_e(()=>import("./SubtypeGroupLayerView2D-CAUNhlbZ.js"),__vite__mapDeps([379,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),tile:IE,"vector-tile":()=>ni().then(()=>_e(()=>import("./VectorTileLayerView2D-CJwh_WpT.js"),__vite__mapDeps([380,22,182,48,49,178,34,35,36,223,320,224,181,247,308,142,246,313,167,168,141,307,201,314,57,227,118,50,51,329,120,3,225,226,28,29,30,336,290,338,339]))),video:()=>ni().then(()=>_e(()=>import("./VideoLayerView2D-BhBhduzm.js"),__vite__mapDeps([381,382,55,6,56,57,62,7,8,383,32,33,34,31,35,36,373,201,313,167,168,141,307,308,49,142,246,247,314,224,227,118,50,51,310,179,180,172,181,178,182,18,19,311,306,238,169,312,174,175,186,324,384,336,290,326,327,328,329,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338]))),wcs:()=>ni().then(()=>_e(()=>import("./ImageryTileLayerView2D-BfVdB5LH.js"),__vite__mapDeps([362,9,361,308,49,142,246,247,141,38,313,167,168,307,201,314,57,224,227,118,50,51,27,25,336,290,209,363,329,311,306,238,324,312,174,335,364,210,345,42,347,344,338,339]))),"web-tile":IE,wfs:I0,wms:()=>ni().then(()=>_e(()=>import("./WMSLayerView2D-Dj3mO43p.js"),__vite__mapDeps([385,352,313,167,168,141,307,308,49,142,246,247,201,314,57,224,227,118,50,51,334,311,306,238,335,336,290,353,338,339,386,347]))),wmts:()=>ni().then(()=>_e(()=>import("./WMTSLayerView2D-MxTfQZB7.js"),__vite__mapDeps([387,333,334,314,57,311,247,306,307,238,335,313,167,168,141,308,49,142,246,201,224,227,118,50,51,329,336,290,338,339]))),"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"gaussian-splat":null,"integrated-mesh-3dtiles":null,"integrated-mesh":null,"line-of-sight":null,"point-cloud":null,scene:null,unknown:null,unsupported:null,viewshed:null,voxel:null};function vQe(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",n=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Xe(`${n}:view-not-supported`,`${e} is not supported in 2D`)}const Jne={hasLayerViewModule:t=>Zne[t.type]!=null,importLayerView:t=>{const e=Zne[t.type];if(e==null)throw vQe(t);return e(t)}};var Hl;let ib=(Hl=class{static getId(e,n,r,i){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${n}/${r}/${i}`}constructor(e,n,r,i){this.set(e,n,r,i)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,n=4095&this.col,r=63&this.level;return(3&this.world)<<30|n<<22|e<<8|r}acquire(e,n,r,i){this.set(e,n,r,i)}contains(e){const n=e.level-this.level;return n>=0&&this.row===e.row>>n&&this.col===e.col>>n&&this.world===e.world}containsChild(e){const n=e.level-this.level;return n>0&&this.row===e.row>>n&&this.col===e.col>>n&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Hl(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,n,r,i){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[s,o,a,l]=e.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+n,this.col=+r,this.world=+i||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Hl(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,n,r){const i=this.clone();return i.col+=e,i.row+=n,r.normalizeKey(i),i}getChildKeys(){const e=this.level+1,n=this.row<<1,r=this.col<<1,i=this.world;return[new Hl(e,n,r,i),new Hl(e,n,r+1,i),new Hl(e,n+1,r,i),new Hl(e,n+1,r+1,i)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},Hl.pool=new H2(()=>new Hl(""),null,null,25,50),Hl);function __(t,e){return[t,e]}function R0(t,e,n){return t[0]=e,t[1]=n,t}function _Qe(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}const Cu=new ib("0/0/0/0");let xQe=class mve{static create(e,n,r=null){const i=La(e.spatialReference),s=n.origin||__(e.origin.x,e.origin.y),o=__(e.size[0]*n.resolution,e.size[1]*n.resolution),a=__(-1/0,-1/0),l=__(1/0,1/0),c=__(1/0,1/0);r!=null&&(R0(a,Math.max(0,Math.floor((r.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymax)/o[1]))),R0(l,Math.max(0,Math.floor((r.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymin)/o[1]))),R0(c,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:u,rows:h}=n;let f,g,v,x;return!r&&u&&h&&(R0(a,u[0],h[0]),R0(l,u[1],h[1]),R0(c,u[1]-u[0]+1,h[1]-h[0]+1)),e.isWrappable?(f=__(Math.ceil(Math.round((i.valid[1]-i.valid[0])/n.resolution)/e.size[0]),c[1]),g=!0,v=i.origin,x=i.valid):(f=c,g=!1),new mve(n.level,n.resolution,n.scale,s,a,l,c,o,f,g,v,x)}constructor(e,n,r,i,s,o,a,l,c,u,h,f){this.level=e,this.resolution=n,this.scale=r,this.origin=i,this.first=s,this.last=o,this.size=a,this.norm=l,this.worldSize=c,this.wrap=u,this._spatialReferenceOrigin=h,this._spatialReferenceValid=f}normalizeCol(e){if(!this.wrap)return e;const n=this.worldSize[0];return e<0?n-1-Math.abs((e+1)%n):e%n}normalizeKey(e){if(!this.wrap)return;const n=this.worldSize[0],r=e.col;r<0?(e.col=r+n,e.world-=1):r>=n&&(e.col=r-n,e.world+=1)}denormalizeCol(e,n){return this.wrap?this.worldSize[0]*n+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const n=this.origin[0]+e*this.norm[0],r=this._spatialReferenceOrigin,i=this._spatialReferenceValid;return this.wrap&&r&&i?n===r[0]?i[0]:this.origin[0]===r[0]&&e===this.worldSize[0]?i[1]:n:n}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,n,r=!1){Cu.set(n);const i=r?Cu.col:this.denormalizeCol(Cu.col,Cu.world),s=Cu.row;return _Qe(e,this.getXForColumn(i),this.getYForRow(s+1),this.getXForColumn(i+1),this.getYForRow(s)),e}getTileCoords(e,n,r=!1){Cu.set(n);const i=r?Cu.col:this.denormalizeCol(Cu.col,Cu.world);return Array.isArray(e)?R0(e,this.getXForColumn(i),this.getYForRow(Cu.row)):(e.x=this.getXForColumn(i),e.y=this.getYForRow(Cu.row)),e}};var a1;let uW=(a1=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:n,colFrom:r,colTo:i}of this.spans)for(let s=r;s<=i;s++){const o=e.getWorldForColumn(s);yield new ib(e.level,n,e.normalizeCol(s),o)}}forEach(e,n){const{spans:r,lodInfo:i}=this,{level:s}=i;if(r.length!==0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++)e.call(n,s,o,i.normalizeCol(c),i.getWorldForColumn(c))}},a1.pool=new H2(()=>new a1),a1),H$=class{constructor(e,n,r){this.row=e,this.colFrom=n,this.colTo=r}};const ai=new ib("0/0/0/0");let wQe=class gve{static create(e,n){e[1]>n[1]&&([e,n]=[n,e]);const[r,i]=e,[s,o]=n,a=s-r,l=o-i,c=l!==0?a/l:0,u=(Math.ceil(i)-i)*c,h=(Math.floor(i)-i)*c;return new gve(r,Math.floor(i),Math.ceil(o),c,a<0?u:h,a<0?h:u,a<0?s:r,a<0?r:s)}constructor(e,n,r,i,s,o,a,l){this.x=e,this.ymin=n,this.ymax=r,this.invM=i,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Dl=[[0,0],[0,0],[0,0],[0,0]],bQe=1e-6;let EQe=class{constructor(e,n=null,r=e.lods[0].level,i=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=n,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=e.lods.filter(a=>a.level>=r&&a.level<=i);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>xQe.create(e,a,n));s.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,n,r=!1){ai.set(n);const i=this._infoByLevel[ai.level];return i?i.getTileBounds(e,ai,r):e}getTileCoords(e,n,r=!1){ai.set(n);const i=this._infoByLevel[ai.level];return i?i.getTileCoords(e,ai,r):e}getTileCoverage(e,n=192,r=!0,i="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const s=i==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=uW.pool.acquire(s),a=this._wrap;let l,c,u,h=1/0,f=-1/0;const g=o.spans;Dl[0][0]=Dl[0][1]=Dl[1][1]=Dl[3][0]=-n,Dl[1][0]=Dl[2][0]=e.size[0]+n,Dl[2][1]=Dl[3][1]=e.size[1]+n;for(const T of Dl)e.toMap(T,T),T[0]=s.getColumnForX(T[0]),T[1]=s.getRowForY(T[1]);const v=[];let x=3;for(let T=0;T<4;T++){if(Dl[T][1]===Dl[x][1]){x=T;continue}const A=wQe.create(Dl[T],Dl[x]);h=Math.min(A.ymin,h),f=Math.max(A.ymax,f),v[A.ymin]===void 0&&(v[A.ymin]=[]),v[A.ymin].push(A),x=T}if(h==null||f==null||f-h>100)return null;let b=[];for(l=h;l<f;){v[l]!=null&&(b=b.concat(v[l])),c=1/0,u=-1/0;for(let T=b.length-1;T>=0;T--){const A=b[T];c=Math.min(c,A.getLeftCol()),u=Math.max(u,A.getRightCol())}if(c=Math.floor(c),u=Math.floor(u),l>=s.first[1]&&l<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const T=Math.floor(u/s.worldSize[0]);for(let A=Math.floor(c/s.worldSize[0]);A<=T;A++)g.push(new H$(l,Math.max(s.getFirstColumnForWorld(A),c),Math.min(s.getLastColumnForWorld(A),u)))}else g.push(new H$(l,c,u));else c>s.last[0]||u<s.first[0]||(c=Math.max(c,s.first[0]),u=Math.min(u,s.last[0]),g.push(new H$(l,c,u)));l+=1;for(let T=b.length-1;T>=0;T--){const A=b[T];A.ymax>=l?A.incrRow():b.splice(T,1)}}return o}getTileParentId(e){ai.set(e);const n=this._infoByLevel[ai.level],r=this._lodInfos.indexOf(n)-1;return r<0?null:(this._getTileIdAtLOD(ai,this._lodInfos[r],ai),ai.id)}getTileResolution(e){const n=this._infoByLevel[typeof e=="object"?e.level:e];return n?n.resolution:-1}getTileScale(e){const n=this._infoByLevel[e.level];return n?n.scale:-1}intersects(e,n){ai.set(n);const r=this._infoByLevel[ai.level],i=e.lodInfo;if(i.resolution>r.resolution){this._getTileIdAtLOD(ai,i,ai);const o=i.denormalizeCol(ai.col,ai.world);for(const a of e.spans)if(a.row===ai.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(i.resolution<r.resolution){const[o,a,l,c]=e.spans.reduce((x,b)=>(x[0]=Math.min(x[0],b.row),x[1]=Math.max(x[1],b.row),x[2]=Math.min(x[2],b.colFrom),x[3]=Math.max(x[3],b.colTo),x),[1/0,-1/0,1/0,-1/0]),u=r.denormalizeCol(ai.col,ai.world),h=i.getColumnForX(r.getXForColumn(u)),f=i.getRowForY(r.getYForRow(ai.row)),g=i.getColumnForX(r.getXForColumn(u+1))-1,v=i.getRowForY(r.getYForRow(ai.row+1))-1;return!(h>c||g<l||f>a||v<o)}const s=i.denormalizeCol(ai.col,ai.world);return e.spans.some(o=>o.row===ai.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(e,n,r){if(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],this._wrap){const i=La(this.tileInfo.spatialReference),s=-r*(i.valid[1]-i.valid[0]);e[0]+=s,e[2]+=s}return e}getSmallestInfoForScale(e){const n=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>n[0])return this._infoByScale[n[0]];for(let r=1;r<n.length-1;r++)if(e>n[r]+bQe)return this._infoByScale[n[r-1]];return this._infoByScale[n[n.length-1]]}getClosestInfoForScale(e){const n=this.scales;return this._infoByScale[e]||(e=n.reduce((r,i)=>Math.abs(i-e)<Math.abs(r-e)?i:r,n[0])),this._infoByScale[e]}scaleToLevel(e){const n=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let r=n.length-1;r>=0;r--)if(e<n[r])return r===n.length-1?this._infoByScale[n[n.length-1]].level:this._infoByScale[n[r]].level+(n[r]-e)/(n[r]-n[r+1]);return this._infoByScale[n[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,n,r){const i=this._infoByLevel[r.level];return e.set(r),n.resolution<i.resolution?null:(n.resolution===i.resolution||(e.level=n.level,e.col=Math.floor(r.col*i.resolution/n.resolution+.01),e.row=Math.floor(r.row*i.resolution/n.resolution+.01)),e)}},SQe=class{constructor(e,n){this.item=e,this.controller=n,this.promise=null}},TQe=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new iw,this._controllers=new iw,this._processingItems=new iw,this._pausedSignal=v2(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new Ok(e.peeker),this.process=e.process;const n=e.scheduler;e.priority&&n&&(this._task=n.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=Qr(this._schedule),this._task=Qr(this._task)}get updating(){return!!this._task?.updating||this.readyToRun}get length(){return this._processingItems.size+this._queue.length}abort(e){const n=this._controllers.get(e);n&&n.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(n=>e.push(n)),this._controllers.clear(),e.forEach(n=>n.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((n,r)=>e(r))}get(e){const n=this._deferreds.get(e);return n?n.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,n){const r=this.get(e);if(r)return r;const i=new AbortController;let s=null;n&&(s=lu(n,()=>i.abort()));const o=()=>{const u=this._processingItems.get(e);u&&u.controller.abort(),a(),c.reject(Tr())},a=()=>{l.remove(),s?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=EG(i.signal,o),c=uc();return this._deferreds.set(e,c),this._controllers.set(e,i),c.promise.then(a,a),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(Tr()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const n of e)this._queue.push(n.item),n.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get readyToRun(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Y2(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,n){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(n))}_processError(e,n){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(n))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let n;const r=new AbortController,i=new SQe(e,r);this._processingItems.set(e,i);try{n=this.process(e,r.signal)}catch(s){this._processError(i,s)}da(n)?(i.promise=n,n.then(s=>this._processResult(i,s),s=>this._processError(i,s))):this._processResult(i,n)}get test(){}};const Qne=[0,0];let xf=class extends Kt{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:n,scheduler:r,priority:i}=this;this._queue=new TQe({concurrency:e,scheduler:r,priority:i,process:(s,o)=>{const a=this._keyToItem.get(s);return n(a,{signal:o})},peeker:s=>this._peek(s)})}destroy(){this.clear(),this._queue=Mi(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const n=typeof e=="string"?e:e.id;this._queue.abort(n)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const n=e.key.id;if(this._queue.has(n))return this._queue.get(n);const r=this._queue.push(n),i=this.tileInfoView.getTileScale(e.key),s=ZA(this._tilesByScale,i,()=>new Set),o=()=>{s.delete(e.key),s.size===0&&this._tilesByScale.delete(i),this._keyToItem.delete(n)};return s.add(e.key),this._keyToItem.set(n,e),r.then(o,o),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const n=new Set;for(const o of e)n.add(this._keyToItem.get(o).key);const r=this.state.scale;let i,s=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(pfe(a,l=>n.has(l))){const l=Math.abs(o-r);l<s&&(i=a,s=l)}return this._getClosestTileKey(i,e).id}_getClosestTileKey(e,n){const r=this.tileInfoView,i=this.state.center;let s,o=Number.POSITIVE_INFINITY;for(const a of e)if(n.has(a.id)){r.getTileCoords(Qne,a);const l=xO(Qne,i);l<o&&(o=l,s=a)}return s}};_([E({constructOnly:!0})],xf.prototype,"concurrency",void 0),_([E({constructOnly:!0})],xf.prototype,"priority",void 0),_([E({constructOnly:!0})],xf.prototype,"process",void 0),_([E({constructOnly:!0})],xf.prototype,"scheduler",void 0),_([E()],xf.prototype,"state",void 0),_([E({constructOnly:!0})],xf.prototype,"tileInfoView",void 0),xf=_([ue("esri.views.2d.tiling.TileQueue")],xf);const X4t=xf;let kQe=class{constructor(e,n,r){this.maxSize=e,this._tileInfoView=n,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const n=this._tilePerId.get(e);if(!n)return;const r=n.key.level,i=this._tileKeysPerLevel[r];ere(this._tilePerId,e);for(let s=0;s<i.length;s++)if(i[s].id===e){i.splice(s,1);break}return n.visible=!0,n}add(e){e.visible=!1;const n=e.key,r=n.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,e);const i=n.level;this._tileKeysPerLevel[i]||(this._tileKeysPerLevel[i]=[]),this._tileKeysPerLevel[i].push(n)}prune(e,n,r){let i=this._tilePerId.size;if(i<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;i>this.maxSize&&s>=0;)s!==e&&(i=this._pruneAroundCenterTile(i,n,r,s)),s--;i>this.maxSize&&(i=this._pruneAroundCenterTile(i,n,r,e))}_pruneAroundCenterTile(e,n,r,i){const s=this._tileKeysPerLevel[i];if(!s||s.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=r*o[0],c=r*o[1],u=[0,0],h=[0,0];for(s.sort((f,g)=>(u[0]=a.x+l*(f.col+.5),u[1]=a.y-c*(f.row+.5),h[0]=a.x+l*(g.col+.5),h[1]=a.y-c*(g.row+.5),Ik(u,n)-Ik(h,n)));s.length>0;){const f=s.pop();if(this._removeTile(f.id),--e===this.maxSize)break}return e}_removeTile(e){const n=this._tilePerId.get(e);this._removedFunc&&n&&this._removedFunc(n),ere(this._tilePerId,e)}};function ere(t,e){t.delete(e)}const P0=new ib(0,0,0,0),sf=new Map,RE=[],q$=[];let J4t=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new kQe(e.cacheSize,this.tileInfoView,n=>{this.releaseTile(n)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:n,tileIndex:r}=this,{scale:i,center:s,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,c=!e.stationary&&i>this._previousScale;if(this._previousScale=i,!n&&(i>a||i<l))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:f}=u,{level:g}=f;this.tiles.length=0,r.forEach(T=>T.visible=!0);let v=0,x=0;if(h.length>0)for(const{row:T,colFrom:A,colTo:I}of h)for(let R=A;R<=I;R++){v++;const M=P0.set(g,T,f.normalizeCol(R),f.getWorldForColumn(R)).id;let F=r.get(M);if(F)F.isReady?(sf.set(M,F),x++):c||this._addParentTile(M,sf);else{if(this._tileCache?.has(M)){if(F=this._tileCache.pop(M),this.tileIndex.set(M,F),F.isReady){sf.set(M,F),x++;continue}}else F=this.acquireTile(P0),this.tileIndex.set(M,F);c||this._addParentTile(M,sf)}}const b=x===v;for(const[T,A]of r){if(sf.has(T))continue;P0.set(T);const I=this.tileInfoView.intersects(u,P0),R=this.cachePolicy==="purge"?P0.level!==g:P0.level>g;!I||!c&&b?!R&&I||RE.push(A):A.isReady?R&&this.cachePolicy==="purge"&&this._hasReadyAncestor(P0,g)?RE.push(A):q$.push(A):R&&RE.push(A)}for(const T of q$)T.isReady&&sf.set(T.key.id,T);for(const T of RE)this._tileCache?this._tileCache.add(T):this.releaseTile(T),r.delete(T.key.id);for(const T of sf.values())this.tiles.push(T);for(const T of r.values())sf.has(T.key.id)||(T.visible=!1);this._tileCache?.prune(g,s,o),uW.pool.release(u),q$.length=0,RE.length=0,sf.clear()}clear(){const{tileIndex:e}=this;for(const n of e.values())this.releaseTile(n);e.clear()}refresh(e){for(const n of this.tileIndex.values())e(n);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,n){let r=e,i=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(i=this.tileIndex.get(r),i?.isReady){n.has(i.key.id)||n.set(i.key.id,i);break}}else if(this._tileCache?.has(r)&&(i=this._tileCache.pop(r),this.tileIndex.set(r,i),i?.isReady)){n.has(i.key.id)||n.set(i.key.id,i);break}}_hasReadyAncestor(e,n){const r=ml();this.tileInfoView.getTileBounds(r,e,!0);for(const i of this.tileIndex.values())if(i.isReady&&i.key.level>=n&&i.key.level<e.level){const s=ml();if(this.tileInfoView.getTileBounds(s,i.key,!0),KVe(s,r))return!0}return!1}};const AQe={"area-measurement":null,dimension:null,"direct-line-measurement":null,"elevation-profile":()=>_e(()=>import("./ElevationProfileAnalysisView2D-DBmGwRel.js"),__vite__mapDeps([388,28,29,30,254,382,55,6,56,57,62,7,8,389,331,390,391,392,393,394,395,104,396,397,398,399,400,199,200,35,36,401,66,402,101,403,404,218,152,205,206,214,256,150,405,191,227,235,213])),"line-of-sight":null,slice:null,viewshed:null,"volume-measurement":null};function IQe(t){const e=AQe[t.type];if(!e)throw new Xe("analysis-view-module-import-utils:analysis-not-supported",`Analysis "${t.type}" is not supported`);return e()}let RQe=class{constructor(e,n={}){this.events=new m8e,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):n.canvas!=null&&(this._canvas=n.canvas);const r={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let i=this._canvas.getContext("webgl2",r);i||(i=this._canvas.getContext("webgl2",{...r,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=i,this._handles=rv([B2(this._canvas,"webglcontextlost",s=>this.events.emit("webgl-context-lost",s))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,n){if(this._hasMajorPerformanceCaveat||ye("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=ye("esri-performance-mode-frames-between-render")&&(n(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[r,i,s,o,a,l]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${r}, ${i}, ${s}, ${o}, ${a}, ${l})`}}else n()}resize(e){const n=this._canvas,r=n.style,{state:{size:i},pixelRatio:s}=e,o=i[0],a=i[1],l=Math.round(o*s),c=Math.round(a*s);n.width===l&&n.height===c||(n.width=l,n.height=c),r.width=o+"px",r.height=a+"px"}_computeViewTransform(e,n){const[r,i]=e.center,[s,o]=n.center,[a,l]=e.toScreen([0,0],s,o),[c,u]=e.toScreen([0,0],r,i),h=c-a,f=u-l,g=e.scale/n.scale,v=n.rotation-e.rotation,x=yd();return T1e(x),MO(x,x,[g,g]),bI(x,x,uI(v)),_2(x,x,[h,f]),x}};function PQe(t,e,n,r,i){yve(t,e,n||0,r||t.length-1,i||CQe)}function yve(t,e,n,r,i){for(;r>n;){if(r-n>600){var s=r-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);yve(t,e,Math.max(n,Math.floor(e-o*l/s+c)),Math.min(r,Math.floor(e+(s-o)*l/s+c)),i)}var u=t[e],h=n,f=r;for(PE(t,n,e),i(t[r],u)>0&&PE(t,n,r);h<f;){for(PE(t,h,f),h++,f--;i(t[h],u)<0;)h++;for(;i(t[f],u)>0;)f--}i(t[n],u)===0?PE(t,n,f):PE(t,++f,r),f<=e&&(n=f+1),e<=f&&(r=f-1)}}function PE(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function CQe(t,e){return t<e?-1:t>e?1:0}function Y4(t,e){if(!(this instanceof Y4))return new Y4(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function MQe(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function x_(t,e){SS(t,0,t.children.length,e,t)}function SS(t,e,n,r,i){i||(i=nx(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],TS(i,t.leaf?r(s):s);return i}function TS(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function tre(t,e){return t.minX-e.minX}function nre(t,e){return t.minY-e.minY}function K$(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function qP(t){return t.maxX-t.minX+(t.maxY-t.minY)}function NQe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function OQe(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function Y$(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function KP(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function nx(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function rre(t,e,n,r,i){for(var s,o=[e,n];o.length;)(n=o.pop())-(e=o.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,PQe(t,s,e,n,i),o.push(e,s,s,n))}Y4.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!KP(t,e))return n;for(var i,s,o,a,l=[];e;){for(i=0,s=e.children.length;i<s;i++)o=e.children[i],KP(t,a=e.leaf?r(o):o)&&(e.leaf?n.push(o):Y$(t,a)?this._all(o,n):l.push(o));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!KP(t,e))return!1;for(var r,i,s,o,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(s=e.children[r],KP(t,o=e.leaf?n(s):s)){if(e.leaf||Y$(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=nx([]),this},remove:function(t,e){if(t==null)return this;for(var n,r,i,s,o=this.data,a=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),r=l[l.length-1],n=c.pop(),s=!0),o.leaf&&(i=MQe(t,o.children,e))!==-1)return o.children.splice(i,1),l.push(o),this._condense(l),this;s||o.leaf||!Y$(o,a)?r?(n++,o=r.children[n],s=!1):o=null:(l.push(o),c.push(n),n=0,r=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:tre,compareMinY:nre,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,s=n-e+1,o=this._maxEntries;if(s<=o)return x_(i=nx(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),(i=nx([])).leaf=!1,i.height=r;var a,l,c,u,h=Math.ceil(s/o),f=h*Math.ceil(Math.sqrt(o));for(rre(t,e,n,f,this.compareMinX),a=e;a<=n;a+=f)for(rre(t,a,c=Math.min(a+f-1,n),h,this.compareMinY),l=a;l<=c;l+=h)u=Math.min(l+h-1,c),i.children.push(this._build(t,l,u,r-1));return x_(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,s,o,a,l,c,u,h;r.push(e),!e.leaf&&r.length-1!==n;){for(u=h=1/0,i=0,s=e.children.length;i<s;i++)l=K$(o=e.children[i]),(c=NQe(t,o)-l)<h?(h=c,u=l<u?l:u,a=o):c===h&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),s=[],o=this._chooseSubtree(i,this.data,e,s);for(o.children.push(t),TS(o,i);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(i,s,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),o=nx(n.children.splice(s,n.children.length-s));o.height=n.height,o.leaf=n.leaf,x_(n,this.toBBox),x_(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,e){this.data=nx([t,e]),this.data.height=t.height+1,this.data.leaf=!1,x_(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,s,o,a,l,c,u;for(l=c=1/0,r=e;r<=n-e;r++)o=OQe(i=SS(t,0,r,this.toBBox),s=SS(t,r,n,this.toBBox)),a=K$(i)+K$(s),o<l?(l=o,u=r,c=a<c?a:c):o===l&&a<c&&(c=a,u=r);return u},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:tre,i=t.leaf?this.compareMinY:nre;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,s,o=this.toBBox,a=SS(t,0,e,o),l=SS(t,n-e,n,o),c=qP(a)+qP(l);for(i=e;i<n-e;i++)s=t.children[i],TS(a,t.leaf?o(s):s),c+=qP(a);for(i=n-e-1;i>=e;i--)s=t.children[i],TS(l,t.leaf?o(s):s),c+=qP(l);return c},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)TS(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)t[n].children.length===0?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():x_(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function LQe(t,{timeZone:e,timeExtent:n}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:n?.start,currentEnd:n?.end}}}}let ire=class vve{constructor(e,n){this.key=new ib(0,0,0,0),this.bounds=ml(),this.objectIds=new Set,this.key.set(n);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=e.zoomToScale(r.level-1),this.maxScale=e.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return WVe(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return LQe(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),n=Aa.acquire();for(let r=0;r<e.length;r++)n[r]=new vve(this.tileInfoView,e[r]);return n}getQuantizationParameters(){return Mm.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const C0={added:[],removed:[]},X$=new Set,DQe=new ib(0,0,0,0);function $Qe(t,e){const n=La(e);if(!n)return null;const[r,i]=n.valid;return t[2]>i?[ml([t[0],t[1],i,t[3]]),ml([r,t[1],r+t[2]-i,t[3]])]:t[0]<r?[ml([r,t[1],t[2],t[3]]),ml([i-(r-t[0]),t[1],i,t[3]])]:null}let jQe=class extends Nfe{constructor(e){super(),this._tiles=new Map,this._index=Y4(9,ye("esri-csp-restrictions")?n=>({minX:n.bounds[0],minY:n.bounds[1],maxX:n.bounds[2],maxY:n.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){super.destroy(),this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||gB(e)===0||yB(e)===0)return[];const n=$Qe(e,this.tileScheme.spatialReference);return n!=null?[...new Set([...this.boundsIntersections(n[0]),...this.boundsIntersections(n[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const n={added:[],removed:[]};for(const r of e.added)if(!this.has(r)){const i=new ire(this.tileScheme,r);this._tiles.set(r,i),this._index.insert(i),n.added.push(i)}for(const r of e.removed)if(this.has(r)){const i=this.get(r);this._tiles.delete(r),this._index.remove(i),n.removed.push(i)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(n.added.length||n.removed.length)&&this.emit("update",n)}setViewState(e){const n=this.tileScheme.getTileCoverage(e,0);if(!n)return;const{spans:r,lodInfo:i}=n,{level:s}=i;if(r.length>0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++){const u=DQe.set(s,o,i.normalizeCol(c),i.getWorldForColumn(c)).id;if(X$.add(u),!this.has(u)){const h=new ire(this.tileScheme,u);this._tiles.set(u,h),this._index.insert(h),this.tiles.push(h),C0.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];X$.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),C0.removed.push(a))}(C0.added.length||C0.removed.length)&&this.emit("update",C0),uW.pool.release(n),X$.clear(),C0.added.length=0,C0.removed.length=0}};const nNt=1e-30,sre=512,YP=16777216,rNt=8,iNt=29,sNt=24,oNt=4,aNt=0,lNt=0,cNt=0,uNt=1,hNt=2,dNt=3,fNt=4,pNt=5,mNt=6,gNt=12,yNt=13,vNt=5,FQe=6,_Nt=5,xNt=6,_ve=6,VQe=1<<_ve,wNt=VQe<<1,bNt=1.05,ENt=3,SNt=1,TNt=3,kNt=3,ANt=5,INt=6,RNt=1.15,zQe=4,PNt=128,UQe=256,CNt=UQe-2*zQe,MNt=2,NNt=128,ONt=1,LNt=10,DNt=1024,$Nt=128,jNt=4,FNt=1,VNt=1<<20,zNt=.75,UNt=10,GNt=.75,BNt=256,WNt=32,HNt=512,qNt=0,KNt=1,GQe=1,YNt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],XNt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],CE=256,BQe=()=>Tt.getLogger("esri.views.webgl.checkWebGLError");function xve(t){switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const wve=!!ye("enable-feature:webgl-debug");function bve(){return wve}function ZNt(){return wve}function M0(t,e=bve()){if(e){const n=xve(t);if(n){const r=new Error().stack;BQe().error(new Xe("webgl-error","WebGL error occurred",{message:n,stack:r}))}}}const JNt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},N0={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131},Gt={RGBA4:32854,R16F:33325,RG16F:33327,RGB32F:34837,RGBA16F:34842,R32F:33326,RG32F:33328,RGBA32F:34836,R11F_G11F_B10F:35898,RGB8:32849,RGBA8:32856,RGB5_A1:32855,R8:33321,RG8:33323,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,RGB16F:34843,RGB9_E5:35901,SRGB8:35905,SRGB8_ALPHA8:35907,RGB565:36194,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2:32857,RGB10_A2UI:36975},WQe=Object.values(Gt),X4={DEPTH24_STENCIL8:35056,DEPTH32F_STENCIL8:36013},_T={DEPTH_COMPONENT16:33189,DEPTH_COMPONENT24:33190,DEPTH_COMPONENT32F:36012},dV={FLOAT:N0.FLOAT,UNSIGNED_BYTE:N0.UNSIGNED_BYTE,UNSIGNED_INT_24_8:34042,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,BYTE:N0.BYTE,UNSIGNED_SHORT:N0.UNSIGNED_SHORT,SHORT:N0.SHORT,UNSIGNED_INT:N0.UNSIGNED_INT,INT:N0.INT,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269},QNt=33984,ore={Texture:0,TileTexture:1,BufferObject:2,VertexArrayObject:3,Shader:4,Program:5,FramebufferObject:6,Renderbuffer:7,TransformFeedback:8,Sync:9,UNCOUNTED:10,LinesOfCode:10,Uniform:11,COUNT:12},e5t=1029,t5t=0,n5t=36064,r5t=36065,i5t=36066,s5t=36067,o5t=33306,a5t=36096,l5t=36128,qo={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497};function c5t(t,e,n,r=0){const i=t.gl;t.bindBuffer(n);for(const s of n.layout){const o=e.get(s.name);if(o==null){console.warn(`There is no location for vertex attribute '${s.name}' defined.`);continue}const a=r*s.stride;if(s.count<=4)i.vertexAttribPointer(o,s.count,s.type,s.normalized,s.stride,s.offset+a),i.enableVertexAttribArray(o),s.divisor>0&&i.vertexAttribDivisor(o,s.divisor);else if(s.count===9)for(let l=0;l<3;l++)i.vertexAttribPointer(o+l,3,s.type,s.normalized,s.stride,s.offset+12*l+a),i.enableVertexAttribArray(o+l),s.divisor>0&&i.vertexAttribDivisor(o+l,s.divisor);else if(s.count===16)for(let l=0;l<4;l++)i.vertexAttribPointer(o+l,4,s.type,s.normalized,s.stride,s.offset+16*l+a),i.enableVertexAttribArray(o+l),s.divisor>0&&i.vertexAttribDivisor(o+l,s.divisor);else console.error("Unsupported vertex attribute element count: "+s.count);if(bve()){const l=xve(t.gl);l&&console.error(`Unable to bind vertex attribute "${s.name}" with baseInstanceOffset ${a}:`,l,s)}}}function u5t(t){switch(t){case 6406:case 6409:case 6403:case 36244:case 6402:case 34041:return 1;case 6410:case 33319:case 33320:return 2;case 6407:case 36248:return 3;case 6408:case 36249:return 4}return 0}function HQe(t){switch(t){case 6406:case 6409:case 6403:case 36244:case Gt.R8:case Gt.R8I:case Gt.R8UI:case Gt.R8_SNORM:case 36168:return 1;case 6410:case 33319:case 33320:case Gt.RGBA4:case Gt.R16F:case Gt.R16I:case Gt.R16UI:case Gt.RG8:case Gt.RG8I:case Gt.RG8UI:case Gt.RG8_SNORM:case Gt.RGB565:case Gt.RGB5_A1:case _T.DEPTH_COMPONENT16:return 2;case 6407:case 36248:case Gt.RGB8:case Gt.RGB8I:case Gt.RGB8UI:case Gt.RGB8_SNORM:case Gt.SRGB8:case _T.DEPTH_COMPONENT24:return 3;case 6408:case 36249:case Gt.RGBA8:case Gt.R32F:case Gt.R11F_G11F_B10F:case Gt.RG16F:case Gt.R32I:case Gt.R32UI:case Gt.RG16I:case Gt.RG16UI:case Gt.RGBA8I:case Gt.RGBA8UI:case Gt.RGBA8_SNORM:case Gt.SRGB8_ALPHA8:case Gt.RGB9_E5:case Gt.RGB10_A2UI:case Gt.RGB10_A2:case _T.DEPTH_COMPONENT32F:case X4.DEPTH24_STENCIL8:return 4;case X4.DEPTH32F_STENCIL8:return 5;case Gt.RGB16F:case Gt.RGB16I:case Gt.RGB16UI:return 6;case Gt.RG32F:case Gt.RG32I:case Gt.RG32UI:case Gt.RGBA16F:case Gt.RGBA16I:case Gt.RGBA16UI:return 8;case Gt.RGB32F:case Gt.RGB32I:case Gt.RGB32UI:return 12;case Gt.RGBA32F:case Gt.RGBA32I:case Gt.RGBA32UI:return 16;case qo.COMPRESSED_RGB_S3TC_DXT1_EXT:case qo.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case qo.COMPRESSED_RGBA_S3TC_DXT3_EXT:case qo.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case qo.COMPRESSED_R11_EAC:case qo.COMPRESSED_SIGNED_R11_EAC:case qo.COMPRESSED_RGB8_ETC2:case qo.COMPRESSED_SRGB8_ETC2:case qo.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case qo.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case qo.COMPRESSED_RG11_EAC:case qo.COMPRESSED_SIGNED_RG11_EAC:case qo.COMPRESSED_RGBA8_ETC2_EAC:case qo.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let Eve=class{constructor(e=0,n=e){this.width=e,this.height=n,this.type=0,this.target=3553,this.pixelFormat=6408,this.dataType=dV.UNSIGNED_BYTE,this.samplingMode=9729,this.wrapMode=10497,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function qQe(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:HQe(t.internalFormat))*(t.target===34067?6:1))}const ME=()=>Tt.getLogger("esri/views/webgl/textureUtils");function NE(t){const{width:e,height:n,depth:r}=t;(e!=null&&e<0||n!=null&&n<0||r!=null&&r<0)&&ME().error("Negative dimension parameters are not allowed!");const{internalFormat:i}=t;if(i&&(Sve(i)||Tve(i))){const{linearFilterDepth:s,compareEnabled:o,samplingMode:a,hasMipmap:l}=t;l&&ME().error("Depth textures cannot have mipmaps"),s?a!==9729&&a!==9728&&ME().error("Depth textures cannot sample mipmaps"):(a!==9728&&ME().error("Depth textures without filtering must use NEAREST filtering"),o&&ME().error("Depth textures without filtering cannot use compare function"))}}function KQe(t){return WQe.includes(t)}function Sve(t){return Y5(_T,t)}function Tve(t){return Y5(X4,t)}function YQe(t){return t!=null&&Y5(qo,t)}function rx(t){return t!=null&&"type"in t&&t.type==="compressed"}function XQe(t){return t!=null&&"byteLength"in t}function are(t){return t!=null&&!rx(t)&&!XQe(t)}function w_(t){return t===32879||t===35866}function lre(t,e,n,r=1){let i=Math.max(e,n);return t===32879&&(i=Math.max(i,r)),Math.floor(Math.log2(i))+1}function XP(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case dV.FLOAT:switch(t.pixelFormat){case 6408:return Gt.RGBA32F;case 6407:return Gt.RGB32F;default:throw new Xe("texture:unknown-format","Unable to derive format")}case dV.UNSIGNED_BYTE:switch(t.pixelFormat){case 6408:return Gt.RGBA8;case 6407:return Gt.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===34041?X4.DEPTH24_STENCIL8:e===6402?_T.DEPTH_COMPONENT24:e,t.internalFormat}function ZQe(t){let e="width"in t?t.width:t.codedWidth,n="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,n=t.videoHeight),{width:e,height:n,depth:1}}let JQe=class kve extends Eve{constructor(e,n){switch(super(),this.context=e,Object.assign(this,n),this.internalFormat){case Gt.R16F:case Gt.R32F:case Gt.R8_SNORM:case Gt.R8:this.pixelFormat=6403;break;case Gt.R8I:case Gt.R8UI:case Gt.R16I:case Gt.R16UI:case Gt.R32I:case Gt.R32UI:this.pixelFormat=36244}}static validate(e,n){return new kve(e,n)}};const QQe=!!ye("esri-tests-disable-gpu-memory-measurements"),of=()=>Tt.getLogger("esri/views/webgl/Texture");var ys;let eet=(ys=class{constructor(e,n=null,r=null){if(this.type=1,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,r=n;else{const i=JQe.validate(e,n);if(!i)throw new Xe("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=i}this._descriptor.target===34067?this._setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return QQe?0:qQe(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this.hasWebGLTextureObject&&this._descriptor.context?.gl&&(this._descriptor.context.instanceCounter.decrement(ore.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null,this._descriptor=null)}release(){this.dispose()}[Symbol.dispose](){this.dispose()}resize(e,n){const r=this._descriptor;if(r.width!==e||r.height!==n){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-resize","Immutable textures can't be resized!");r.width=e,r.height=n,this._descriptor.target===34067?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!rx(e)&&this._descriptor.internalFormat&&Y5(qo,this._descriptor.internalFormat)&&(this._descriptor.internalFormat=void 0),this._setData(e),!rx(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,n,r,i,s,o,a=0){o||of().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||of().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=XP(l);const{context:c,pixelFormat:u,dataType:h,target:f,isImmutable:g}=l;if(g&&!this._wasImmutablyAllocated)throw new Xe("texture:uninitialized","Cannot update immutable texture before allocation!");const v=c.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES,!0);(n<0||r<0||n+i>l.width||r+s>l.height)&&of().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:x}=c;a&&(i&&s||of().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),x.pixelStorei(x.UNPACK_SKIP_ROWS,a)),are(o)?x.texSubImage2D(f,e,n,r,i,s,u,h,o):rx(o)?x.compressedTexSubImage2D(f,e,n,r,i,s,l.internalFormat,o.levels[e]):x.texSubImage2D(f,e,n,r,i,s,u,h,o),a&&x.pixelStorei(x.UNPACK_SKIP_ROWS,0),c.bindTexture(v,ys.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,n,r,i,s,o,a,l){l||of().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||of().error("An attempt to update an uninitialized texture!");const c=this._descriptor;c.internalFormat=XP(c);const{context:u,pixelFormat:h,dataType:f,isImmutable:g,target:v}=c;if(g&&!this._wasImmutablyAllocated)throw new Xe("texture:uninitialized","Cannot update immutable texture before allocation!");w_(v)||of().warn("Attempting to set 3D texture data on a non-3D texture");const x=u.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES);u.setActiveTexture(ys.TEXTURE_UNIT_FOR_UPDATES),(n<0||r<0||i<0||n+s>c.width||r+o>c.height||i+a>c.depth)&&of().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:b}=u;if(rx(l))l=l.levels[e],b.compressedTexSubImage3D(v,e,n,r,i,s,o,a,c.internalFormat,l);else{const T=l;b.texSubImage3D(v,e,n,r,i,s,o,a,h,f,T)}u.bindTexture(x,ys.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,NE(e)}e.samplingMode===9729?(this._samplingModeDirty=!0,e.samplingMode=9985):e.samplingMode===9728&&(this._samplingModeDirty=!0,e.samplingMode=9984);const n=this._descriptor.context.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ys.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(n,ys.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,NE(e)}e.samplingMode===9985?(this._samplingModeDirty=!0,e.samplingMode=9729):e.samplingMode===9984&&(this._samplingModeDirty=!0,e.samplingMode=9728)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,NE(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?9729:9728),NE(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=R1(this._compressionAbortController)}_setData(e,n){const r=this._descriptor,i=r.context?.gl;if(!i)return;M0(i),this.hasWebGLTextureObject||(this._glName=i.createTexture(),r.context.instanceCounter.increment(ore.Texture,this)),NE(r);const s=r.context.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES);r.context.setActiveTexture(ys.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),M0(i);const o=n??r.target,a=w_(o);if(are(e))this._setDataFromTexImageSource(e,o);else{const{width:l,height:c,depth:u}=r;if(l==null||c==null)throw new Xe("texture:missing-size","Width and height must be specified!");if(a&&u==null)throw new Xe("texture:missing-depth","Depth must be specified!");if(r.internalFormat=XP(r),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,r.internalFormat,r.hasMipmap,l,c,u),rx(e)){if(!YQe(r.internalFormat))throw new Xe("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,r.internalFormat,o)}else this._texImage(o,0,r.internalFormat,l,c,u,e),M0(i),r.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),M0(i),r.context.bindTexture(s,ys.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let n=34069;n<=34074;n++)this._setData(e,n)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:n,flipped:r,preMultiplyAlpha:i}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,n),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i?1:0)}_setDataFromTexImageSource(e,n){const{gl:r}=this._descriptor.context,i=this._descriptor;i.internalFormat=XP(i);const s=w_(n),{width:o,height:a,depth:l}=ZQe(e);i.width&&i.height,i.width||(i.width=o),i.height||(i.height=a),s&&i.depth,s&&(i.depth=l),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(n,i.internalFormat,i.hasMipmap,o,a,l),this._texImage(n,0,i.internalFormat,o,a,l,e),M0(r),i.hasMipmap&&(this.generateMipmap(),M0(r))}_setDataFromCompressedSource(e,n,r){const i=this._descriptor,{width:s,height:o,depth:a}=i,l=e.levels,c=lre(r,s,o,a),u=Math.min(c,l.length)-1;this._descriptor.context.gl.texParameteri(i.target,33085,u),this._forEachMipmapLevel((h,f,g,v)=>{const x=l[Math.min(h,l.length-1)];this._compressedTexImage(r,h,n,f,g,v,x)},u)}_texStorage(e,n,r,i,s,o){const{gl:a}=this._descriptor.context;if(!KQe(n)&&!Sve(n)&&!Tve(n))throw new Xe("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=r?lre(e,i,s,o):1;if(w_(e)){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,n,i,s,o)}else a.texStorage2D(e,l,n,i,s);this._wasImmutablyAllocated=!0}_texImage(e,n,r,i,s,o,a){const l=this._descriptor.context.gl,c=w_(e),{isImmutable:u,pixelFormat:h,dataType:f}=this._descriptor;if(u){if(a!=null){const g=a;if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(e,n,0,0,0,i,s,o,h,f,g)}else l.texSubImage2D(e,n,0,0,i,s,h,f,g)}}else{const g=a;if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(e,n,r,i,s,o,0,h,f,g)}else l.texImage2D(e,n,r,i,s,0,h,f,g)}}_compressedTexImage(e,n,r,i,s,o,a){const l=this._descriptor.context.gl,c=w_(e);if(this._descriptor.isImmutable){if(a!=null)if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,n,0,0,0,i,s,o,r,a)}else l.compressedTexSubImage2D(e,n,0,0,i,s,r,a)}else if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,n,r,i,s,o,0,a)}else l.compressedTexImage2D(e,n,r,i,s,0,a)}async _compressOnWorker(e){const{width:n,height:r,context:i,flipped:s,preMultiplyAlpha:o,hasMipmap:a}=this._descriptor,l=this._descriptor.compress?.compressionTracker,c=this._descriptor.compress?.compressionCallback,{compressedTextureETC:u,compressedTextureS3TC:h}=i.capabilities;if(!ys.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!u&&!h)return;this.abortCompression();const f=new AbortController;let g;this._compressionAbortController=f,l?.increment();try{e instanceof Uint8Array?g=e.buffer:(g=await createImageBitmap(e,{imageOrientation:s?"flipY":"none"}),hi(f));const v={data:g,width:n,height:r,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===6408?4:3,preMultiplyAlpha:o,hasMipmap:a,hasETC:!!u,hasS3TC:!!h},x=await ys.compressionWorkerHandle.invoke(v,f.signal,"low");if(hi(f),x.compressedTexture&&this.hasWebGLTextureObject){const b=this.usedMemory;this._descriptor.internalFormat=x.internalFormat,this._setData(x.compressedTexture),c?.(b-this.usedMemory)}}catch(v){ya(v)||of().error("Texture compression failed!")}finally{l?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null),g instanceof ImageBitmap&&g.close()}}_forEachMipmapLevel(e,n=1/0){let{width:r,height:i,depth:s,hasMipmap:o,target:a}=this._descriptor;const l=a===32879;if(r==null||i==null||l&&s==null)throw new Xe("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let c=0;e(c,r,i,s),o&&(r!==1||i!==1||l&&s!==1)&&!(c>=n);++c)r=Math.max(1,r>>1),i=Math.max(1,i>>1),l&&(s=Math.max(1,s>>1))}_applySamplingMode(){const e=this._descriptor,n=e.context?.gl;let r=e.samplingMode,i=e.samplingMode;r===9985||r===9987?(r=9729,e.hasMipmap||(i=9729)):r!==9984&&r!==9986||(r=9728,e.hasMipmap||(i=9728)),n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,r),n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,i)}_applyWrapMode(){const e=this._descriptor,n=e.context?.gl;typeof e.wrapMode=="number"?(n.texParameteri(e.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,e.wrapMode)):(n.texParameteri(e.target,n.TEXTURE_WRAP_S,e.wrapMode.s),n.texParameteri(e.target,n.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,n=e.context?.gl,r=e.compareEnabled?n.COMPARE_REF_TO_TEXTURE:n.NONE;n.texParameteri(e.target,n.TEXTURE_COMPARE_MODE,r),e.compareEnabled&&n.texParameteri(e.target,n.TEXTURE_COMPARE_FUNC,n.GREATER),M0(n)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,n=e.context.capabilities.textureFilterAnisotropic;n&&e.context.gl.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},ys.TEXTURE_UNIT_FOR_UPDATES=0,ys.compressionWorkerHandle=null,ys);const Z$=()=>Tt.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function tet(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const net=[0,0,0,0];let Ave=class{constructor(){this.type="single",this._highlightOptions=new yg,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*CE),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,n){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,FQe),n.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<_ve)-1,activeGradient:this}]}_updateGradientTexture(e){const n=ret(this._highlightOptions);if(n===this._optionsShadeTexKey)return;this._optionsShadeTexKey=n,tet(this._highlightOptions,this._convertedHighlightOptions);const r=this._convertedHighlightOptions,i=r.outlinePosition-r.outlineWidth/2-r.outerHaloWidth,s=r.outlinePosition-r.outlineWidth/2,o=r.outlinePosition+r.outlineWidth/2,a=r.outlinePosition+r.outlineWidth/2+r.innerHaloWidth,l=Math.sqrt(Math.PI/2)*GQe,c=Math.abs(i)>l?Math.round(10*(Math.abs(i)-l))/10:0,u=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let h;c&&!u?Z$().error("The outer rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!c&&u?Z$().error("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):c&&u&&Z$().error("The highlight is "+Math.max(c,u)+"px away from the edge of the feature; consider reducing some width values.");const f=[void 0,void 0,void 0,void 0];function g(x,b,T){f[0]=(1-T)*x[0]+T*b[0],f[1]=(1-T)*x[1]+T*b[1],f[2]=(1-T)*x[2]+T*b[2],f[3]=(1-T)*x[3]+T*b[3]}const{_texelData:v}=this;for(let x=0;x<CE;++x)h=i+x/(CE-1)*(a-i),h<i?(f[0]=0,f[1]=0,f[2]=0,f[3]=0):h<s?g(net,r.outlineColor,(h-i)/(s-i)):h<o?[f[0],f[1],f[2],f[3]]=r.outlineColor:h<a?g(r.outlineColor,r.fillColor,(h-o)/(a-o)):[f[0],f[1],f[2],f[3]]=r.fillColor,v[4*x]=255*f[0],v[4*x+1]=255*f[1],v[4*x+2]=255*f[2],v[4*x+3]=255*f[3];if(this._minMaxDistance[0]=i,this._minMaxDistance[1]=a,!this._shadeTex){const x=new Eve(CE,1);x.wrapMode=33071,this._shadeTex=new eet(e,x)}this._shadeTex.updateData(0,0,0,CE,1,this._texelData)}};function ret(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let iet=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let n=0;n<e.length;n++)this.gradients[n]||(this.gradients[n]=new Ave),this.gradients[n].setHighlightOptions(e[n]);for(let n=e.length+1;n<this.gradients.length;n++)this.gradients[n].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const n=[];for(let r=0;r<this.gradients.length;r++){const i=this.gradients[r];n.push({activeReasons:e,activeGradient:i}),e<<=1}return n}};const Ive={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},set={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},oet={...Ive,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function aet({pixelRatio:t,state:e,displayLevel:n,requiredLevel:r},i){const s=1/2**(n-i.key.level),o=1/2**(r-i.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:i.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:i.transforms.tileMat3,displayZoomFactor:s,requiredZoomFactor:o,tileOffset:[i.x,i.y],currentScale:e.scale,currentZoom:n,metersPerSRUnit:$d(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function Rve(t){return t.passOptions?.type==="highlight"}function Pve(t){return t.passOptions?.type==="hittest"}function cet(t){if(!Pve(t))return null;const{position:e,distance:n,smallSymbolDistance:r,smallSymbolSizeThreshold:i}=t.passOptions;return{position:e,distance:n,smallSymbolDistance:r,smallSymbolSizeThreshold:i}}function uet(t){if(!Rve(t))return null;const{activeReasons:e,highlightAll:n}=t.passOptions;return{activeReasons:e,highlightAll:n?1:0}}function p5t(t,e,n){const r={};for(const i in n)typeof n[i]!="function"?r[i]=n[i]:r[i]=n[i](t,e);return r}function m5t(t,e){const{attributeView:n,context:r}=t;return{storage:n.getUniforms(r),view:aet(t,e),hittestRequest:cet(t),highlight:uet(t)}}function g5t(t){return{inside:t.selection===2,outside:t.selection===3}}function het(t){return Pve(t)?set:Rve(t)&&t.passOptions.stepType==="clear"?oet:Ive}function y5t(t){const{row:e,col:n}=t.key,r=n*sre,i=e*sre;return{tileOffsetFromLocalOrigin:[r%YP,i%YP],maxIntsToLocalOrigin:[Math.floor(r/YP),Math.floor(i/YP)]}}const det=new Gs({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function v5t(t){return det.toJSON(t)}function _5t(t){const{bandCount:e,attributeTable:n,colormap:r,pixelType:i}=t.raster.rasterInfo;return e===1&&(n!=null||r!=null||i==="u8"||i==="s8")}function fet(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new iet:new Ave),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function x5t(t,e,n,r){const{painter:i,highlightGradient:s}=t,{highlight:o}=i.effects;if(!s)return;const a=t.passOptions,l=s.getReasonsWithGradients();for(let c=0;c<l.length;c++){const u={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(u),n(u),c<l.length-1){let f=0;for(let g=c+1;g<l.length;g++)f|=l[g].activeReasons;n({...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:f,stepType:"clear",highlightAll:e}})}const h={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"draw",highlightAll:e}};i.setPipelineState(het(t)),i.updatePipelineState(t.context),o.draw(h),o.unbind()}t.passOptions=a}const ZP=t=>parseFloat(t)/100;function pet(t,e,n){const r=typeof t.left=="string"?ZP(t.left)*e:t.left,i=typeof t.right=="string"?ZP(t.right)*e:t.right,s=typeof t.top=="string"?ZP(t.top)*n:t.top,o=typeof t.bottom=="string"?ZP(t.bottom)*n:t.bottom,a=s;return{xmin:r,xmax:Math.max(e-i,r),ymin:a,ymax:Math.max(n-o,s)}}function Cve(t,e,n,r){switch(e.type){case"rect":{const{width:i,height:s}=t,{xmin:o,xmax:a,ymin:l,ymax:c}=pet(e,i,s),{x:u,y:h}=n;return u>o&&u<a&&h>l&&h<c}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||XG(e.path,[n.x,n.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?YG(e.geometry,r):sI(e.geometry,r))}}function met(t){if(!t.highlights)return null;const e=t.highlights.findIndex(n=>n.name==="default");return e===-1?null:t.highlights.items[e]}function get(t,e){if(!t.highlights){if(!e)return;t.highlights=new Ot([new yg])}const n=t.highlights.findIndex(r=>r.name==="default");e?t.highlights.items[n].assignFrom(e):(t.highlights.removeAt(n),t.highlights.length===0&&(t.highlights=null))}async function yet(t,e,n){const r=d1e(e)?h1e(t,e):e;if(!t.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let i=new Set;const s=new Set;let o=!1,a=null,l=null;n?.include?ure(n.include,cre(t,f=>{i.add(f),J$(f,g=>s.add(g))},(f,g)=>{s.add(f),i.add(g)},f=>{a||(a=new Set),a.add(f)},f=>i.add(f),()=>o=!0)):(o=!0,i=new Set(t.allLayerViews),i.forEach(f=>{J$(f,g=>s.add(g))})),n?.exclude&&ure(n.exclude,cre(t,f=>{i.delete(f),J$(f,g=>s.delete(g))},f=>s.delete(f),f=>{l||(l=new Set),l.add(f)}));const c=t.toMap(r),u=t.allLayerViews.filter(f=>!f.suspended&&i.has(f)&&f.clips.every(g=>Cve(t,g,r,c))).reverse();let h=[...o?t.graphicsView.hitTest(c).map(f=>({type:"graphic",graphic:f,layer:null,mapPoint:c})):[],...await Promise.all(u.map(f=>f.hitTest(c,r)).toArray())].filter(e2).flat().filter(e2);return h=h.filter(f=>f.type!=="graphic"||f.layer?.type!=="subtype-group"||s.has(f.graphic.layer)),a&&(h=h.filter(f=>!("graphic"in f)||!f.graphic||a?.has(fV(f.graphic)))),l&&(h=h.filter(f=>!("graphic"in f)||!f.graphic||!l?.has(fV(f.graphic)))),{screenPoint:r,results:h}}function cre(t,e,n,r,i,s){return o=>{if(o instanceof Yo){if(o.layer===t)s?.();else{const a=t.allLayerViews.find(l=>l.layer===o.layer);a&&i?.(a)}r(fV(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(l=>l.layer===o.parent);a&&n(o,a)}else{const a=t.allLayerViews.find(l=>l.layer===o);a&&e(a)}}}function ure(t,e){if(t)if(o4(t))for(const n of t)if(o4(n))for(const r of n)e(r);else e(n);else e(t)}function fV(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function J$(t,e){const n=t.layer;n?.type==="subtype-group"&&n.sublayers.forEach(r=>{e(r)})}let OE=null,Z4=!0;function vet(t,e,n){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(Z4)try{return new ImageData(t,e)}catch{Z4=!1}return Mve(t,e,n)}function w5t(t,e,n,r){if(!e||!n)throw new Error("Cannot construct image data without dimensions");if(Z4)try{return new ImageData(t,e,n)}catch{Z4=!1}const i=Mve(e,n,r);return i.data.set(t,0),i}function _et(){return OE||(OE=document.createElement("canvas"),OE.width=1,OE.height=1),OE}function Mve(t,e,n){return n||(n=_et()),n.getContext("2d").createImageData(t,e)}async function xet(t,e){const n=window.URL.createObjectURL(t);try{const{data:r}=await Qi(n,{...e,responseType:"image"});return r}catch(r){throw ya(r)?r:new Xe("invalid-image",`Could not fetch requested image at ${n}`)}finally{window.URL.revokeObjectURL(n)}}async function b5t(t,e){const{arrayBuffer:n,mediaType:r}=await wet(t,e),i=r==="image/png";if(r==="image/gif"){const{isAnimatedGIF:s,parseGif:o}=await _e(()=>import("./gif-CyYy0nLc.js"),[]);if(s(n))return o(n,e)}if(i){const{isAnimatedPNG:s,parseApng:o}=await _e(()=>import("./apng-BBxnbr4V.js"),__vite__mapDeps([406,26]));if(s(n))return o(n,e)}return xet(new Blob([n],{type:r}),e)}async function wet(t,e){const n=t2(t);if(n?.isBase64)return{arrayBuffer:_de(n.data),mediaType:n.mediaType};const r=await Qi(t,{responseType:"array-buffer",...e});return{arrayBuffer:r.data,mediaType:r.getHeader?.("Content-Type")??""}}function Nve(t,e,n){const{ctx:r,canvas:i}=Lve(t,n),s=r.getImageData(0,0,t.width,t.height),o=$ve(i,e);return Dve(i),{dataUrl:o,data:s}}function Ove(t,e){const{ctx:n,canvas:r}=Lve(t,e),i=n.getImageData(0,0,t.width,t.height);return Dve(r),i}function Lve(t,e){const n=bet();e.premultipliedAlpha&&Aet(t),n.width=t.width,n.height=t.height;const r=n.getContext("2d",{willReadFrequently:!0});return r.putImageData(t,0,0),e.flipY&&ket(r),{ctx:r,canvas:n}}function Dve(t){t.width=0,t.height=0}function bet(){return Q$==null&&(Q$=document.createElement("canvas")),Q$}let Q$=null;function $ve(t,e){const n=Iet[e.format],r=e.quality/100;return t.toDataURL(n,r)}function jve(t,e){const n=Tet(t),r=Pet[n];return{format:n,quality:cu(e??r,0,100)}}function Fve(t,e){return e/Math.max(t[0],t[1])}function Eet(t,e,n,r=0,i=0,s=t.width-r,o=t.height-i,a=!1){const{data:l}=t,{width:c,height:u,data:h}=e,f=s/c,g=o/u,v=Math.ceil(f/2),x=Math.ceil(g/2),b=t.width;for(let T=0;T<u;T++)for(let A=0;A<c;A++){const I=4*(A+(a?u-T-1:T)*c);let R=0,M=0,F=0,C=0,N=0,O=0;const j=(T+.5)*g;for(let V=Math.floor(T*g);V<(T+1)*g;V++){const W=Math.abs(j-(V+.5))/x,U=(A+.5)*f,pe=W*W;for(let Ne=Math.floor(A*f);Ne<(A+1)*f;Ne++){const Se=Math.abs(U-(Ne+.5))/v,je=Math.sqrt(pe+Se*Se);if(je>=1)continue;let de=2*je*je*je-3*je*je+1;const Oe=4*(r+Ne+(i+V)*b);O+=de*l[Oe+3],M+=de,!n&&l[Oe+3]<255&&(de=de*l[Oe+3]/255),F+=de*l[Oe],C+=de*l[Oe+1],N+=de*l[Oe+2],R+=de}}h[I]=F/R,h[I+1]=C/R,h[I+2]=N/R,h[I+3]=O/M}return e}function Tet(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return Ret}}function ket(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function Aet(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=e[r+3];if(i!==255&&i>0){const s=255/i;e[r]=e[r]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const Iet={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},hre=98,Ret="png",Pet={png:100,jpg:hre,jpeg:hre},E5t=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:vet,encode:Nve,encodeData:Ove,getFormatAndQuality:jve,getMaximumResolutionScale:Fve,resampleHermite:Eet,toDataUrl:$ve},Symbol.toStringTag,{value:"Module"})),Vve={flipY:!0,premultipliedAlpha:!0};async function Cet(t,e){const n=await zve(t,e),{format:r,quality:i}=jve(e?.format,e?.quality);return Nve(n,{format:r,quality:i},Vve)}async function Met(t,e){const n=await zve(t,e);return Ove(n,Vve)}function zve(t,e){const n=Let(e||{},Oet(t.stage,t.size),t.size,t.padding),r=Net(e,t.allLayerViews);return t.stage.takeScreenshot(n,r,t.backgroundColor,e?.rotation)}function Net(t={},e){if(!t.layers)return;const n=[];return t.layers.forEach(r=>{const i=e.find(s=>s.layer.id===r.id);i?.container&&n.push(i.container)}),n}function Oet(t,e){return Math.min(4,Fve(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Let(t,e,n,r){t.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let i=null;t.width!=null&&t.height!=null?i=[t.width,t.height]:t.width==null&&t.height!=null?i=[t.height,t.height]:t.width!=null&&t.height==null?i=[t.width,t.width]:t.width==null&&t.height==null&&(i=null);const s=n[0]-(r.left+r.right),o=n[1]-(r.top+r.bottom);let a,l,c=t.area||{x:0,y:0,width:s,height:o};if(i){const u=s/o,h=i[0]/i[1];if(h>u){const f=c.width/h;c={x:c.x,y:Math.round(c.y+(c.height-f)/2),width:c.width,height:Math.round(f)}}else{const f=c.height*h;c={x:Math.round(c.x+(c.width-f)/2),y:c.y,width:Math.round(f),height:c.height}}}else i=[c.width,c.height];return i[0]>c.width?(a=Math.min(i[0]/c.width,e),l=i[0]/c.width/a):(a=1,l=i[0]/c.width),{cropArea:{x:Math.round((c.x+r.left)*a),y:Math.round((c.y+r.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:l,resolutionScale:a}}const Det=t=>t.includes("Brush");let Uve=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Det(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};const dre=Symbol("analyses-owner-handles");let Em=class extends Kt{constructor(e){super(e),this._allAnalysisViews=new Ot,this._creatingViewCount=0,this._attachedToViewResolver=fre(),this._items=new Map,this._moduleMap=new Map,this._scheduledUpdateHandle=null,this._emitOnView=(n,r)=>this.view.emit(n,r)}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(Tr("AnalysisViewManager was destroyed")),this._set("view",null)}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(Tr()),this._attachedToViewResolver=fre()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const n=this._items.get(e);if(n==null||n.state.list===1)throw new Xe("AnalysisViewManager:no-analysis-view-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return n.createAnalysisViewTask.promise}_connectOwners(){this.addHandles(this._connectAnalysesCollection(this.view.analyses),dre)}_disconnectOwners(){this.removeHandles(dre),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const i of e)this._addAnalysis(i);const n=e.on("after-add",i=>this._addAnalysis(i.item)),r=e.on("after-remove",i=>this._removeAnalysis(i.item));return qn(()=>{n.remove(),r.remove();for(const i of e)this._removeAnalysis(i)})}_addAnalysis(e){const n=this._items.get(e);if(n==null){const r={state:{view:0,list:0},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,r),r.createAnalysisViewTask=sO(i=>this._createAnalysisViewPromise(r,i).then(s=>(this._emitOnView("analysis-view-create",{analysis:e,analysisView:s}),s),s=>{throw this._emitOnView("analysis-view-create-error",{analysis:e,error:s}),s}))}else n.state.list=0}_removeAnalysis(e){const n=this._items.get(e);n!=null?(n.state.list=1,this._scheduleUpdate()):Tt.getLogger(this).error("Trying to remove analysis which was not added")}_scheduleUpdate(){this._scheduledUpdateHandle==null&&(this._scheduledUpdateHandle=Y2(()=>this._update()))}_update(){this._scheduledUpdateHandle=Qr(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list!==1)return;const{analysis:n,view:r}=e;switch(this._items.delete(n),e.state.view){case 0:e.createAnalysisViewTask=R1(e.createAnalysisViewTask);break;case 1:r!=null&&(this._allAnalysisViews.remove(r),e.view=Mi(r),e.createAnalysisViewTask=null,this._emitOnView("analysis-view-destroy",{analysis:n,analysisView:r}))}})}async _createAnalysisViewPromise(e,n){const{analysis:r}=e;if(this._creatingViewCount+=1,!this._moduleMap.has(r.type))try{this._moduleMap.set(r.type,await this.importAnalysisViewModule(r))}catch{throw this._creatingViewCount-=1,new Xe("AnalysisViewManager:no-analysis-view-for-analysis",`Analysis of type "${r.type}" is not supported`)}if(ha(n))throw this._creatingViewCount-=1,Tr("AnalysisView creation aborted");const i=new(this._moduleMap.get(r.type)).default({analysis:r,view:this.view});let s=!0;lu(n,()=>{s&&this._destroyAnalysisView(r,i)});try{await i.when()}catch(o){throw s=!1,this._destroyAnalysisView(r,i),o}if(ha(n))throw Tr();return s=!1,e.view=i,e.state.view=1,this._allAnalysisViews.add(i),this._creatingViewCount-=1,i}_destroyAnalysisView(e,n){n.destroyed||(this._creatingViewCount-=1,n.destroy(),this._emitOnView("analysis-view-destroy",{analysis:e,analysisView:n}))}};_([E()],Em.prototype,"updating",null),_([E({constructOnly:!0})],Em.prototype,"importAnalysisViewModule",void 0),_([E({constructOnly:!0})],Em.prototype,"view",void 0),_([E()],Em.prototype,"_allAnalysisViews",void 0),_([E()],Em.prototype,"_creatingViewCount",void 0),Em=_([ue("esri.views.support.AnalysisViewManager")],Em);const $et=Em;function fre(){const t=uc();return t.promise.catch(()=>{}),t}let jet=class{constructor(e){this.getUnmaskedRenderer=e}};function Fet(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new jet(()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL)):null}let pre;function Vet(){return pre??=Get(),pre}let zet=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function Uet(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let n=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(n==null&&(n=e.getContext("webgl2"),n!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=Fet(n)?.getUnmaskedRenderer()??"unknown")),n==null)return n;t.available=!0,t.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);return r&&(t.supportsHighPrecisionFragment=r.precision>0),n}function Get(){const t=new zet,e=Uet(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function Bet(t){const e=Vet();return e.available?t==="3d"&&e.majorPerformanceCaveat?new Xe("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new Xe("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Xe("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Xe("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Wet(t){return t&&"nodeType"in t}function Het(t){return t&&typeof t.render=="function"}const mre={component:"esri-component"};let ry=class extends Kt{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const n=this._get("node");e!==n&&(e&&e.classList.add(mre.component),n&&n.classList.remove(mre.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||Wet(e)?(this._set("widget",null),OB(e)):(Het(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};_([E()],ry.prototype,"id",null),_([E()],ry.prototype,"node",null),_([zs("node")],ry.prototype,"castNode",null),_([E({readOnly:!0})],ry.prototype,"widget",void 0),ry=_([ue("esri.views.ui.Component")],ry);const jM=ry,qet=(t,e)=>{let n=t;for(;n;){if(n===e)return!0;if(!n.parentNode)return!1;n.parentNode instanceof ShadowRoot?n=n.parentNode.host:n=n.parentNode}return!1},R5t=(t,e,n)=>{const r=Ket(e).subscribe;return r(i=>{i.some(o=>qet(t,o.target))&&n()})},e8={},Ket=t=>{const e=t.join(","),n=e8[e];if(n!==void 0)return n;const r=new Set,i=new MutationObserver(o=>r.forEach(a=>a(o)));globalThis.document&&i.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const s={subscribe:o=>(r.add(o),()=>{r.delete(o),r.size===0&&(i.disconnect(),e8[e]=void 0)})};return e8[e]=s,s},Gve=(t,e)=>{let n=t;for(;n;){const r=n.closest?.(e);if(r)return r;const i=n.getRootNode?.();if(i===globalThis.document)return;n=i.host}};function Yet(t){const e=Gve(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const P5t=(t,e,n)=>Gve(t,`[${e}]`)?.getAttribute(e)??n,Xet="--esri-calcite-mode-name";function Zet(){const t=getComputedStyle(document.body).getPropertyValue(Xet).replaceAll(/\W/g,"").toLowerCase();return t==="dark"||t==="light"?t:void 0}const Bve="calcite-mode-";function Wve(t){return Zet()??Yet(t??document.body)}function C5t(t){return Wve(t)==="dark"}function Jet(t){return`${Bve}${Wve(t)}`}function Qet(t){const e=Jet(t);ett(t),t.classList.add(e)}function ett(t){Array.from(t.classList).forEach(e=>{e.startsWith(Bve)&&t.classList.remove(e)})}const DO=new Map;function Hve(){DO.clear()}function ttt(t){return DO.get(t)}function ntt(t,e){DO.set(t,e)}function t8(t){DO.delete(t)}function rtt(...t){const e=Aa.acquire();for(let r=0;r<t.length;r++){const i=t[r],s=typeof i;if(s==="string")e.push(i);else if(Array.isArray(i))e.push.apply(e,i);else if(s==="object")for(const o in i)i[o]&&e.push(o)}const n=e.join(" ");return Aa.release(e),n}(()=>{const t=new Map,e=new ResizeObserver(r=>{Hve();for(const i of r)t.get(i.target)?.(i)}),n=(r,i,s)=>(t.set(r,i),e.observe(r,s),qn(()=>{e.unobserve(r),t.delete(r)}));return(r,i,s)=>{let o=null;return rv([dn(()=>typeof r=="function"?r():r,a=>{o?.remove(),a&&(o=n(a,i,s))},ea),qn(()=>o?.remove())])}})();function itt(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function M5t(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function N5t(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function stt(t){return t==="Enter"||t===" "}async function ott(t,e){await p$e(JA(e));const n=typeof t=="function"?t():t;n&&("setFocus"in n&&typeof n.setFocus=="function"?await n.setFocus():n instanceof HTMLElement&&n.focus())}const att={left:0,top:0,bottom:0,right:0},qve={bottom:30,top:15,right:15,left:15},af="esri-ui",qa={ui:af,corner:`${af}-corner`,innerContainer:`${af}-inner-container`,manualContainer:`${af}-manual-container`,cornerContainer:`${af}-corner-container`,topLeft:`${af}-top-left`,topRight:`${af}-top-right`,bottomLeft:`${af}-bottom-left`,bottomRight:`${af}-bottom-right`};function ltt(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function JP(t){return t===0?"0":`${t}px`}function n8(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function r8(t,{top:e,bottom:n,left:r,right:i}){t.style.top=e,t.style.bottom=n,t.style.left=r,t.style.right=i}let Gh=class extends nI{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=eu(),this.view=null,this._applyViewPadding=()=>{const n=this.container;n&&r8(n,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const n=this._innerContainer;n&&r8(n,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([dn(()=>[this.view?.padding,this.container],this._applyViewPadding,fa),dn(()=>this.padding,this._applyUIPadding,fa),dn(()=>[this.container,this._locale],([e,n])=>{e&&e.setAttribute("lang",n)},fa),vpe(e=>{this._locale=e})])}destroy(){this.removeAllHandles(),this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear(),this.view=null,this._set("view",null)}set container(e){const n=this._get("container");e!==n&&(e&&(e.classList.add(qa.ui),Qet(e),this._attachContainers(e)),n&&(n.classList.remove(qa.ui),r8(n,{top:"",bottom:"",left:"",right:""}),n.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const n=this._getViewPadding(),{top:r,bottom:i}=n;return Math.max(e-r-i,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...qve,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const n=this._getViewPadding(),{left:r,right:i}=n;return Math.max(e-r-i,0)}add(e,n){let r,i,s;if(Array.isArray(e))return void e.forEach(a=>this.add(a,n));const o=n8(e);o&&({index:r,position:n,component:e,key:i}=o),n&&typeof n=="object"&&({index:r,key:i,position:n,internal:s}=n),!e||n&&!this._isValidPosition(n)||this._add(e,n,r??this._getNumComponentsAtPosition(n),i,s)}remove(e,n){if(!e)return;if(Array.isArray(e))return e.map(i=>this.remove(i,n));const r=this._find(e);if(r){const i=this._componentMap.get(r);if(!i||i.key!==n)return;const s=this._components.indexOf(r);return r.node.parentNode?.removeChild(r.node),this._componentMap.delete(r),r.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(a=>{const l=this._componentMap.get(a);l&&l.position===i.position&&l.index>i.index&&l.index--}),this._components.splice(s,1)[0]}}empty(e,n={removeInternal:!1}){if(Array.isArray(e)){for(const s of e)this.empty(s,n);return}const r=this._positionNameToContainerLookup[e??"manual"],i=Array.prototype.slice.call(r.children).map(s=>this._findByNode(s)).filter(s=>s==null?!1:!(this._componentMap.get(s)?.internal??!1)||n.removeInternal);for(const s of i)this.remove(s)}move(e,n){if(Array.isArray(e)&&e.forEach(o=>this.move(o,n)),!e)return;let r;const i=n8(e)||n8(n);if(i&&(r=i.index,n=i.position,e=i.component||e),n&&!this._isValidPosition(n))return;const s=this.remove(e);s&&this.add(s,{position:n,index:r})}find(e){if(!e)return null;const n=this._findById(e);return n&&(n.widget||n.node)}getComponents(e,n={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(r=>this._getComponentsAtPosition(r,n)):this._getComponentsAtPosition(e,n):this._components.filter(r=>n.includeInternal||!this._componentMap.get(r)?.internal).map(({widget:r,node:i})=>r??i)}getPosition(e){for(const n in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[n].contains(e))return n;return null}_add(e,n,r,i,s){e instanceof jM||(e=new jM({node:e}));const{widget:o}=e;o!=null&&o instanceof Kt&&o.addHandles(qn(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey);const a=this._positionNameToContainerLookup[n];this._components.some(l=>{const c=this._componentMap.get(l)?.position,u=c?this._positionNameToContainerLookup[c]:null;return a===u&&this._componentMap.get(l)?.index===r})&&this._components.forEach(l=>{const c=this._componentMap.get(l),u=c?.position,h=u?this._positionNameToContainerLookup[u]:null;c&&h===a&&c.index>=r&&c.index++}),this._place({component:e,position:n,index:r}),this._components.push(e),this._componentMap.set(e,{key:i,position:n,internal:s,index:r})}_find(e){return e?e instanceof jM?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??att}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(qa.innerContainer,qa.cornerContainer);const n=document.createElement("div");n.classList.add(qa.innerContainer,qa.manualContainer);const r=document.createElement("div");r.classList.add(qa.topLeft,qa.corner),e.appendChild(r);const i=document.createElement("div");i.classList.add(qa.topRight,qa.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(qa.bottomLeft,qa.corner),e.appendChild(s);const o=document.createElement("div");o.classList.add(qa.bottomRight,qa.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=n;const a=itt();this._cornerNameToContainerLookup={"top-left":r,"top-right":i,"bottom-left":s,"bottom-right":o,"top-leading":a?i:r,"top-trailing":a?r:i,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:n,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const n=e.position??"manual",{component:r,index:i}=e,s=this._positionNameToContainerLookup[n],o=i!=null&&i>-1;if(ltt(r.widget)&&r.widget.startup(),!o)return void s.appendChild(r.node);const a=Array.from(s.children);if(a.length!==0){for(const l of a){const c=this._findByNode(l);if(c&&i<(this._componentMap.get(c)?.index??0))return void l.parentNode?.insertBefore(r.node,l)}s.appendChild(r.node)}else s.appendChild(r.node)}_toPixelPosition(e){return{top:JP(e.top),left:JP(e.left),right:JP(e.right),bottom:JP(e.bottom)}}_findByComponent(e){return this._components.find(n=>n===e)??null}_findById(e){return this._components.find(({id:n})=>n===e)??null}_findByNode(e){return e?this._components.find(({node:n})=>n===e):null}_getComponentsAtPosition(e,n){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(i=>this._findByNode(i)).filter(e2).filter(i=>n.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:s})=>i??s)}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};_([E()],Gh.prototype,"_locale",void 0),_([E()],Gh.prototype,"container",null),_([E()],Gh.prototype,"height",null),_([E({value:qve})],Gh.prototype,"padding",null),_([zs("padding")],Gh.prototype,"castPadding",null),_([E()],Gh.prototype,"view",void 0),_([E()],Gh.prototype,"width",null),Gh=_([ue("esri.views.ui.UI")],Gh);const ctt=Gh,utt={handleInterceptedEvent:(t,e,n,r)=>(t.scheduleRender(),e.properties[`on${r.type}`].apply(e.properties.bind||n,[r]))},htt={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,n)=>{e.startsWith("-")?t.style.setProperty(e,n):t.style[e]=n}},dtt=t=>({...htt,...t}),ftt=(t,e)=>{const n=[];for(;t&&t!==e;)n.push(t),t=t.parentNode;return n},ptt=(t,e)=>t.find(e),gre=(t,e,n=!1)=>{let r=t;return e.forEach((i,s)=>{const o=r?.children?ptt(r.children,a=>a.domNode===i):void 0;n&&!o&&s!==e.length-1||(r=o)}),r},mtt=t=>{let e;const n={...utt,...t},r=dtt(n),i=r.performanceLogger;let s,o=!0,a=!1;const l=[],c=[],u=(f,g,v)=>{let x;r.eventHandlerInterceptor=(T,A,I,R)=>function(M){let F;i("domEvent",M);const C=ftt(M.currentTarget,x.domNode),N=C.some(j=>customElements.get(j?.tagName?.toLowerCase()));if(M.eventPhase===Event.CAPTURING_PHASE||!N)C.reverse(),F=gre(x.getLastRender(),C);else{const j=M.composedPath(),V=j.slice(j.indexOf(M.currentTarget),j.indexOf(x.domNode)).reverse();F=gre(x.getLastRender(),V,!0)}let O;return F&&(O=n.handleInterceptedEvent(e,F,this,M)),i("domEventProcessed",M),O},n.postProcessProjectionOptions?.(r);const b=v();x=f(g,b,r),r.eventHandlerInterceptor=void 0,l.push(x),c.push(v),n.afterFirstVNodeRendered&&n.afterFirstVNodeRendered(x,b)};let h=()=>{if(s=void 0,o){o=!1,i("renderStart",void 0);for(let f=0;f<l.length;f++){const g=c[f]();i("rendered",void 0);try{l[f].update(g)}catch(v){console.error(v)}i("patched",void 0)}i("renderDone",void 0),o=!0}};return n.modifyDoRenderImplementation&&(h=n.modifyDoRenderImplementation(h,l,c)),e={renderNow:h,scheduleRender:()=>{s||a||(s=requestAnimationFrame(h))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(f,g)=>{u(Jm.append,f,g)},insertBefore:(f,g)=>{u(Jm.insertBefore,f,g)},merge:(f,g)=>{u(Jm.merge,f,g)},replace:(f,g)=>{u(Jm.replace,f,g)},detach:f=>{for(let g=0;g<c.length;g++)if(c[g]===f)return c.splice(g,1),l.splice(g,1)[0];throw new Error("renderFunction was not found")}},e},Ri=(t,e,...n)=>{try{return t?.call(e,...n)}catch(r){console.error(r,t)}},pV=async(t,e,...n)=>{try{return await t?.call(e,...n)}catch(r){console.error(r,t)}},hW=Symbol.for("controller"),gtt=t=>typeof t=="object"&&t!==null&&(hW in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),L5t=t=>typeof t?.then=="function";let kS;const AS=t=>{kS!==t&&(kS=t,queueMicrotask(()=>kS===t?kS=void 0:0))},$O=t=>kS;let iy=[];const ytt=t=>{if(t===void 0){iy=[];return}const e=iy.indexOf(t);iy=e===-1?[...iy,t]:iy.slice(0,e+1),queueMicrotask(()=>iy=[])},vtt=()=>iy;let bx;const D5t=t=>{bx!==t&&(bx=t,queueMicrotask(()=>bx===t?bx=void 0:0))},_tt=()=>{const t=bx;return bx=void 0,t},xtt=async(t,e)=>{const n=dW(t);if(n===void 0)return t;if(await n.ready,typeof e=="function"){const r=n.watchExports(i=>e(i,r))}return n.exports},wtt=async t=>{const e=dW(t);return await e.ready,e},dW=t=>{const n=$O().manager.X(t);if(n!==void 0)return n;if(gtt(t))return t;const r=_tt();if(r!==void 0)return r};let mV=!1;const $5t=t=>{mV=!0;try{return t()}finally{mV=!1}};const FM=globalThis,fW=FM.ShadowRoot&&(FM.ShadyCSS===void 0||FM.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,pW=Symbol(),yre=new WeakMap;let Kve=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==pW)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(fW&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=yre.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&yre.set(n,e))}return e}toString(){return this.cssText}};const btt=t=>new Kve(typeof t=="string"?t:t+"",void 0,pW),F5t=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,i,s)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[s+1],t[0]);return new Kve(n,t,pW)},Ett=(t,e)=>{if(fW)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),i=FM.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=n.cssText,t.appendChild(r)}},vre=fW?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return btt(n)})(t):t;const{is:Stt,defineProperty:Ttt,getOwnPropertyDescriptor:ktt,getOwnPropertyNames:Att,getOwnPropertySymbols:Itt,getPrototypeOf:Rtt}=Object,jO=globalThis,_re=jO.trustedTypes,Ptt=_re?_re.emptyScript:"",Ctt=jO.reactiveElementPolyfillSupport,xT=(t,e)=>t,gV={toAttribute(t,e){switch(e){case Boolean:t=t?Ptt:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},mW=(t,e)=>!Stt(t,e),xre={attribute:!0,type:String,converter:gV,reflect:!1,useDefault:!1,hasChanged:mW};Symbol.metadata??=Symbol("metadata"),jO.litPropertyMetadata??=new WeakMap;let ix=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=xre){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),i=this.getPropertyDescriptor(e,r,n);i!==void 0&&Ttt(this.prototype,e,i)}}static getPropertyDescriptor(e,n,r){const{get:i,set:s}=ktt(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:i,set(o){const a=i?.call(this);s?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??xre}static _$Ei(){if(this.hasOwnProperty(xT("elementProperties")))return;const e=Rtt(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(xT("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(xT("properties"))){const n=this.properties,r=[...Att(n),...Itt(n)];for(const i of r)this.createProperty(i,n[i])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,i]of n)this.elementProperties.set(r,i)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const i=this._$Eu(n,r);i!==void 0&&this._$Eh.set(i,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const i of r)n.unshift(vre(i))}else e!==void 0&&n.push(vre(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Ett(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,r);if(i!==void 0&&r.reflect===!0){const s=(r.converter?.toAttribute!==void 0?r.converter:gV).toAttribute(n,r.type);this._$Em=e,s==null?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(e,n){const r=this.constructor,i=r._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const s=r.getPropertyOptions(i),o=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:gV;this._$Em=i;const a=o.fromAttribute(n,s.type);this[i]=a??this._$Ej?.get(i)??a,this._$Em=null}}requestUpdate(e,n,r,i=!1,s){if(e!==void 0){const o=this.constructor;if(i===!1&&(s=this[e]),r??=o.getPropertyOptions(e),!((r.hasChanged??mW)(s,n)||r.useDefault&&r.reflect&&s===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:i,wrapped:s},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),s!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),i===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[i,s]of this._$Ep)this[i]=s;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[i,s]of r){const{wrapped:o}=s,a=this[i];o!==!0||this._$AL.has(i)||a===void 0||this.C(i,void 0,s,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(n=>this._$ET(n,this[n])),this._$EM()}updated(e){}firstUpdated(e){}};ix.elementStyles=[],ix.shadowRootOptions={mode:"open"},ix[xT("elementProperties")]=new Map,ix[xT("finalized")]=new Map,Ctt?.({ReactiveElement:ix}),(jO.reactiveElementVersions??=[]).push("2.1.2");const gW=globalThis,wre=t=>t,J4=gW.trustedTypes,bre=J4?J4.createPolicy("lit-html",{createHTML:t=>t}):void 0,Yve="$lit$",Vm=`lit$${Math.random().toFixed(9).slice(2)}$`,Xve="?"+Vm,Mtt=`<${Xve}>`,V1=document,Bk=()=>V1.createComment(""),Wk=t=>t===null||typeof t!="object"&&typeof t!="function",yW=Array.isArray,Ntt=t=>yW(t)||typeof t?.[Symbol.iterator]=="function",i8=`[ 	
\f\r]`,LE=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ere=/-->/g,Sre=/>/g,O0=RegExp(`>|${i8}(?:([^\\s"'>=/]+)(${i8}*=${i8}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Tre=/'/g,kre=/"/g,Zve=/^(?:script|style|textarea|title)$/i,Jve=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),z5t=Jve(1),U5t=Jve(2),jg=Symbol.for("lit-noChange"),Ji=Symbol.for("lit-nothing"),Are=new WeakMap,Ly=V1.createTreeWalker(V1,129);function Qve(t,e){if(!yW(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return bre!==void 0?bre.createHTML(e):e}const Ott=(t,e)=>{const n=t.length-1,r=[];let i,s=e===2?"<svg>":e===3?"<math>":"",o=LE;for(let a=0;a<n;a++){const l=t[a];let c,u,h=-1,f=0;for(;f<l.length&&(o.lastIndex=f,u=o.exec(l),u!==null);)f=o.lastIndex,o===LE?u[1]==="!--"?o=Ere:u[1]!==void 0?o=Sre:u[2]!==void 0?(Zve.test(u[2])&&(i=RegExp("</"+u[2],"g")),o=O0):u[3]!==void 0&&(o=O0):o===O0?u[0]===">"?(o=i??LE,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?O0:u[3]==='"'?kre:Tre):o===kre||o===Tre?o=O0:o===Ere||o===Sre?o=LE:(o=O0,i=void 0);const g=o===O0&&t[a+1].startsWith("/>")?" ":"";s+=o===LE?l+Mtt:h>=0?(r.push(c),l.slice(0,h)+Yve+l.slice(h)+Vm+g):l+Vm+(h===-2?a:g)}return[Qve(t,s+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class Hk{constructor({strings:e,_$litType$:n},r){let i;this.parts=[];let s=0,o=0;const a=e.length-1,l=this.parts,[c,u]=Ott(e,n);if(this.el=Hk.createElement(c,r),Ly.currentNode=this.el.content,n===2||n===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(i=Ly.nextNode())!==null&&l.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(const h of i.getAttributeNames())if(h.endsWith(Yve)){const f=u[o++],g=i.getAttribute(h).split(Vm),v=/([.?@])?(.*)/.exec(f);l.push({type:1,index:s,name:v[2],strings:g,ctor:v[1]==="."?Dtt:v[1]==="?"?$tt:v[1]==="@"?jtt:FO}),i.removeAttribute(h)}else h.startsWith(Vm)&&(l.push({type:6,index:s}),i.removeAttribute(h));if(Zve.test(i.tagName)){const h=i.textContent.split(Vm),f=h.length-1;if(f>0){i.textContent=J4?J4.emptyScript:"";for(let g=0;g<f;g++)i.append(h[g],Bk()),Ly.nextNode(),l.push({type:2,index:++s});i.append(h[f],Bk())}}}else if(i.nodeType===8)if(i.data===Xve)l.push({type:2,index:s});else{let h=-1;for(;(h=i.data.indexOf(Vm,h+1))!==-1;)l.push({type:7,index:s}),h+=Vm.length-1}s++}}static createElement(e,n){const r=V1.createElement("template");return r.innerHTML=e,r}}function w2(t,e,n=t,r){if(e===jg)return e;let i=r!==void 0?n._$Co?.[r]:n._$Cl;const s=Wk(e)?void 0:e._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),s===void 0?i=void 0:(i=new s(t),i._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=i:n._$Cl=i),i!==void 0&&(e=w2(t,i._$AS(t,e.values),i,r)),e}class Ltt{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,i=(e?.creationScope??V1).importNode(n,!0);Ly.currentNode=i;let s=Ly.nextNode(),o=0,a=0,l=r[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new EI(s,s.nextSibling,this,e):l.type===1?c=new l.ctor(s,l.name,l.strings,this,e):l.type===6&&(c=new Ftt(s,this,e)),this._$AV.push(c),l=r[++a]}o!==l?.index&&(s=Ly.nextNode(),o++)}return Ly.currentNode=V1,i}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class EI{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,i){this.type=2,this._$AH=Ji,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=w2(this,e,n),Wk(e)?e===Ji||e==null||e===""?(this._$AH!==Ji&&this._$AR(),this._$AH=Ji):e!==this._$AH&&e!==jg&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Ntt(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Ji&&Wk(this._$AH)?this._$AA.nextSibling.data=e:this.T(V1.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,i=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=Hk.createElement(Qve(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===i)this._$AH.p(n);else{const s=new Ltt(i,this),o=s.u(this.options);s.p(n),this.T(o),this._$AH=s}}_$AC(e){let n=Are.get(e.strings);return n===void 0&&Are.set(e.strings,n=new Hk(e)),n}k(e){yW(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of e)i===n.length?n.push(r=new EI(this.O(Bk()),this.O(Bk()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=wre(e).nextSibling;wre(e).remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class FO{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,i,s){this.type=1,this._$AH=Ji,this._$AN=void 0,this.element=e,this.name=n,this._$AM=i,this.options=s,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Ji}_$AI(e,n=this,r,i){const s=this.strings;let o=!1;if(s===void 0)e=w2(this,e,n,0),o=!Wk(e)||e!==this._$AH&&e!==jg,o&&(this._$AH=e);else{const a=e;let l,c;for(e=s[0],l=0;l<s.length-1;l++)c=w2(this,a[r+l],n,l),c===jg&&(c=this._$AH[l]),o||=!Wk(c)||c!==this._$AH[l],c===Ji?e=Ji:e!==Ji&&(e+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!i&&this.j(e)}j(e){e===Ji?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}let Dtt=class extends FO{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Ji?void 0:e}};class $tt extends FO{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Ji)}}let jtt=class extends FO{constructor(e,n,r,i,s){super(e,n,r,i,s),this.type=5}_$AI(e,n=this){if((e=w2(this,e,n,0)??Ji)===jg)return;const r=this._$AH,i=e===Ji&&r!==Ji||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,s=e!==Ji&&(r===Ji||i);i&&this.element.removeEventListener(this.name,this,r),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Ftt=class{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){w2(this,e)}};const Vtt=gW.litHtmlPolyfillSupport;Vtt?.(Hk,EI),(gW.litHtmlVersions??=[]).push("3.3.2");const ztt=(t,e,n)=>{const r=n?.renderBefore??e;let i=r._$litPart$;if(i===void 0){const s=n?.renderBefore??null;r._$litPart$=i=new EI(e.insertBefore(Bk(),s),s,void 0,n??{})}return i._$AI(t),i};const vW=globalThis;let sw=class extends ix{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=ztt(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return jg}};sw._$litElement$=!0,sw.finalized=!0,vW.litElementHydrateSupport?.({LitElement:sw});const Utt=vW.litElementPolyfillSupport;Utt?.({LitElement:sw});(vW.litElementVersions??=[]).push("4.2.2");class qk{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}const Gtt=(t,e)=>{const n=e/Btt;let r=0;const i=setInterval(()=>{r+=n,r>=e&&(clearInterval(i),t())},n);return i},Btt=4,Wtt=(t,e,n)=>{const r=Object.keys(t),i=r.length;Ex===void 0&&queueMicrotask(VO),Ex??=new Map;let s=Ex.get(t);return s===void 0&&(s={callbacks:[],keyCount:i},Ex.set(t,s)),s.keyCount!==i&&(s.callbacks.forEach(o=>o(r)),s.callbacks=[],s.keyCount=i),s.callbacks.push(o=>{const a=c=>Ri(e,null,c),l=o[i];l===void 0?a(void 0):t[l]===n?a(l):a(void 0)}),n};let Ex;const VO=()=>{Ex?.forEach(({callbacks:t},e)=>{const n=Object.keys(e);t.forEach(r=>r(n))}),Ex=void 0},Htt=(t,e,n)=>{const r=t.manager;return r.V!==Ji&&r.V!==n&&r.S(void 0,void 0),r.T.length===0&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=n,r.T.push((i,s)=>Ri(e,void 0,n===s?i:void 0)),n},qtt=(t=[$O(),...vtt()],e,n)=>{const r=Array.isArray(t)?t:[t];let i=r.length+1;const s=o=>{i-=1,o!==void 0&&(i=Math.min(i,0)),i===0&&e(o)};r.forEach(o=>Wtt(o,a=>s(a===void 0?void 0:{key:a,host:o,isReactive:!1}),n));for(const o of r)if("manager"in o&&o.manager.component===o){Htt(o,a=>s(a===void 0?void 0:{key:a,host:o,isReactive:!0}),n);break}return n},Ktt=(t="",e={},n=$O())=>{const r={emit:i=>{t===""&&VO();const s=new CustomEvent(t,{detail:i,cancelable:!0,bubbles:!0,composed:!0,...e});return n.el.dispatchEvent(s),s}};return t===""&&qtt(void 0,i=>t=i.key,r),r},q5t=Ktt.bind(null,"");var e_e;e_e=hW;class Ytt{constructor(e){this.#n=[],this.#e=[],this.#r=[],this.#l=[],this.#c=[],this.#u=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new qk,this.connectedCalled=!1,this.loadedCalled=!1,this[e_e]=!0,this.#s=[];const n=this,r=e??$O();n.#t=r,n.ready=n.P.promise,n.#i=Rre(n),n.component=r,n.#t.addController(n),n.#t.manager===void 0||(ytt(n),queueMicrotask(()=>n.catchUpLifecycle()))}#n;#e;#r;#l;#c;#u;#h;#d;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#i;get exports(){return this.#i}set exports(e){const n=this.#i;n!==e&&(this.#i=e,this.#s.forEach(Ri),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,n)),this.P.resolve(e)}setProvisionalExports(e,n=!0){this.#i=n?Rre(e):e,this.#s.forEach(Ri)}#s;watchExports(e){const n=()=>e(this.#i);return this.#s.push(n),()=>{this.#s.splice(this.#s.indexOf(n),1)}}get use(){return AS(this.#t),xtt}get useRef(){return AS(this.#t),wtt}get useRefSync(){return AS(this.#t),dW}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#n.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#r.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#c.push(e)}onUpdated(e){this.#u.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#f(e)}triggerConnected(){const e=this;e.hostConnected&&Ri(e.hostConnected,e),e.#n.forEach(Ri),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&Ri(e.hostDisconnected,e),e.#e.forEach(Ri),e.#o.forEach(Ri),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await pV(e.hostLoad,e),this.#r.length>0&&await Promise.allSettled(this.#r.map(pV)),this.P.resolve(this.#i)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&Ri(this.hostLoaded,this),this.#l.forEach(Ri),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&Ri(this.hostUpdate,this,e),this.#c.forEach(Ire,e)}triggerUpdated(e){this.hostUpdated&&Ri(this.hostUpdated,this,e),this.#u.forEach(Ire,e)}triggerDestroy(){this.hostDestroy&&Ri(this.hostDestroy,this),this.#h.forEach(Ri)}triggerLifecycle(){this.hostLifecycle&&this.#f(()=>this.hostLifecycle()),this.#d.forEach(this.#f,this)}#f(e){AS(this.#t);const n=Ri(e);(Array.isArray(n)?n:[n]).forEach(i=>{typeof i=="function"?this.#o.push(i):typeof i=="object"&&typeof i.remove=="function"&&this.#o.push(i.remove)})}}function Ire(t){Ri(t,void 0,this)}const Xtt=Ytt,Rre=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(r,i,s){if(!((i==="exports"||i==="_exports")&&i in r&&r[i]===n)&&(i in r||i in Promise.prototype||typeof i=="symbol"))return typeof r=="function"?r[i]:Reflect.get(r,i,s)}},n=new Proxy(t,e);return n},Ztt=t=>t.replace(Jtt,(e,n)=>`${n===0?"":"-"}${e.toLowerCase()}`),Jtt=/[A-Z]+(?![a-z])|[A-Z]/gu,Qtt=1,ent=2,tnt=4,nnt=8,rnt=16,int=32,snt=64,t_e=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const n=e;return n.manager?.loadedCalled||(n.J??n._offspring).push(t),(n.I??n._postLoad).promise}return!1},Pre={};function n_e(){}const VM=Object.defineProperty,ont=globalThis.HTMLElement??n_e;var Qa,Df,Mw,fA,yV;const JH=class JH extends ont{constructor(){var i;super();bu(this,fA);bu(this,Qa);bu(this,Df);bu(this,Mw);Eu(this,Df,{}),Eu(this,Mw,[]),this.I=new qk,this.H=new qk,this.J=[];const n=this,r=n.constructor;n._offspring=n.J,n._postLoad=n.I,r.C?.forEach(s=>{Object.hasOwn(n,s)&&(Ir(n,Df)[s]=n[s],delete n[s])}),r.A?Jb(i=n,fA,yV).call(i,{a:r.A}):r.B.then(async s=>{var o;await r.K.p,Jb(o=n,fA,yV).call(o,await(s.default?.then(a=>typeof a=="function"?{a}:a)??s))}).catch(s=>{n.H.reject(s),setTimeout(()=>{throw s})})}static F(){for(const n of this.C??[])VM(this.prototype,n,{configurable:!0,enumerable:!0,get(){return Ir(this,Df)[n]},set(r){Ir(this,Df)[n]=r}});for(const n of this.E??[])VM(this.prototype,n,{async value(...r){return Ir(this,Qa)||await this.H.promise,await Ir(this,Qa)[n](...r)},configurable:!0});for(const n of this.D??[])VM(this.prototype,n,{value(...r){return Ir(this,Qa)[n](...r)},configurable:!0})}get manager(){return Ir(this,Qa)?.manager}attributeChangedCallback(n,r,i){Ir(this,Qa)?.attributeChangedCallback(n,r,i),Ir(this,Qa)||Ir(this,Mw).push(n)}connectedCallback(){Ir(this,Qa)?Ir(this,Qa).connectedCallback?.():queueMicrotask(()=>this.G=t_e(this))}disconnectedCallback(){Ir(this,Qa)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){Ir(this,Qa)?.requestUpdate()}};Qa=new WeakMap,Df=new WeakMap,Mw=new WeakMap,fA=new WeakSet,yV=function(n){const r=this.constructor,i=r.L,s=Ir(this,Df),o=Object.values(n).find(f=>f.L===i),a=`${i}--lazy`;let l=o;for(;l&&!Object.hasOwn(l,"lumina");)l=Object.getPrototypeOf(l);lnt(l),!r.A&&(r.A=o,customElements.define(a,o)),o.N=this;const u=document.createElement(a);o.N=void 0,Eu(this,Qa,u),Eu(this,Df,u),Ir(this,Mw).forEach(f=>u.attributeChangedCallback(f,null,this.getAttribute(f))),Object.entries(s).forEach(ant,u);const h=this.isConnected;(h||this.G)&&(u.connectedCallback?.(),h||u.disconnectedCallback())},JH.lumina=!0;let Cre=JH;function ant([t,e]){this[t]=e}const lnt=t=>{const e=t.prototype,n=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(i,s){n.setAttribute.call(this.el,i,s)},e.removeAttribute=function(i){n.removeAttribute.call(this.el,i)},VM(e,"isConnected",{get(){return Reflect.get(n,"isConnected",this.el)}}))};const r_e={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},i_e=t=>(...e)=>({_$litDirective$:t,values:e});let s_e=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,n,r){this._$Ct=e,this._$AM=n,this._$Ci=r}_$AS(e,n){return this.update(e,n)}update(e,n){return this.render(...n)}};const cnt=i_e(class extends s_e{constructor(t){if(super(t),t.type!==r_e.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(r=>r!=="")));for(const r in e)e[r]&&!this.nt?.has(r)&&this.st.add(r);return this.render(e)}const n=t.element.classList;for(const r of this.st)r in e||(n.remove(r),this.st.delete(r));for(const r in e){const i=!!e[r];i===this.st.has(r)||this.nt?.has(r)||(i?(n.add(r),this.st.add(r)):(n.remove(r),this.st.delete(r)))}return jg}});const o_e="important",unt=" !"+o_e,hnt=i_e(class extends s_e{constructor(t){if(super(t),t.type!==r_e.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return r==null?e:e+`${n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(t,[e]){const{style:n}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const r of this.ft)e[r]==null&&(this.ft.delete(r),r.includes("-")?n.removeProperty(r):n[r]=null);for(const r in e){const i=e[r];if(i!=null){this.ft.add(r);const s=typeof i=="string"&&i.endsWith(unt);r.includes("-")||s?n.setProperty(r,s?i.slice(0,-11):i,s?o_e:""):n[r]=i}}return jg}});class dnt extends Xtt{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=Ji,this.T=[],this.#r=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=vV in e&&typeof e.destroy=="function",sw.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const n=e.el.localName;throw e.el.remove(),new Error(`The ${n} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${vV} prop.`)}this.#n!==void 0&&clearTimeout(this.#n),VO();for(const n of e.M)"triggerConnected"in n?n.triggerConnected():Ri(n.hostConnected,n)},hostDisconnected:()=>{for(const n of e.M)"triggerDisconnected"in n?n.triggerDisconnected():Ri(n.hostDisconnected,n);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const n of e.M)"triggerUpdate"in n?n.triggerUpdate(this.Q):Ri(n.hostUpdate,n,this.Q)},hostUpdated:()=>{for(const n of e.M)"triggerUpdated"in n?n.triggerUpdated(this.Q):Ri(n.hostUpdated,n,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),AS(e)}#n;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#n=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():Ri(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#n!==void 0&&clearTimeout(this.#n),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>{this.#e.destroy()};this.#n=Gtt(e,fnt)}}S(e,n){const r=this.T;this.V=Ji,this.T=[],r.forEach(i=>i(e,n))}#r;W(e,n){(typeof n=="object"&&n!==null||typeof n=="function")&&this.#r.set(n,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#r.get(e)}}let fnt=1e3;const vV="autoDestroyDisabled";var Fy,pA,mA,Vy,Yh,P2,a_e,l_e;const UT=class UT extends sw{constructor(){super();bu(this,P2);bu(this,Fy);bu(this,pA);bu(this,mA);bu(this,Vy);bu(this,Yh);this.M=[],this.manager=new dnt(this);const n=this,r=n.constructor,i=r.N,s=r.K.o,o=UT.prototype.shouldUpdate;Eu(n,Vy,i?.H??new qk),n.I=i?.I??new qk,n.J=i?.J??[],n._offspring=n.J,n._postLoad=n.I,n.el=i??n,Eu(n,mA,n.enableUpdating),n.enableUpdating=n_e,n.shouldUpdate!==o&&(Eu(n,pA,n.shouldUpdate),n.shouldUpdate=o),s&&(Eu(n,Fy,new Map),r.elementProperties.forEach((a,l)=>Ir(n,Fy).set(l,s())))}static finalizeStyles(n){const r=super.finalizeStyles(n),i=this.shadowRootOptions===Pre;return this.K?.commonStyles===void 0||i?r:[this.K.commonStyles,...r]}static createProperty(n,r){const i=typeof r=="number"?r:Array.isArray(r)?r[0]:0,s=Array.isArray(r)?r[1]:void 0,o=s?.hasChanged??mW,a={attribute:i&Qtt&&typeof n=="string"?Ztt(n):!1,reflect:!!(i&ent),type:i&tnt?Boolean:i&nnt?Number:void 0,state:!!(i&rnt),readOnly:!!(i&int),noAccessor:!!(i&snt),c:!1,...s,hasChanged(l,c){const u=o(l,c);return a.c=u,u}};super.createProperty(n,a)}static getPropertyDescriptor(n,r,i){const s=this.K,o=super.getPropertyDescriptor(n,r,i);return i.d=o,{...o,get(){return s.t?.(Ir(this,Fy).get(n)),o.get?.call(this)},set(a){const l=this.manager;if(i.readOnly&&!mV&&(l.R||l.connectedCalled))throw Error(`Cannot assign to read-only property "${n}" of ${this.el.localName}. Trying to assign "${a}"`);o.set.call(this,a??void 0),i.c&&Ir(this,Fy)?.get(n)?.notify(),l.T.length>0&&(VO(),l?.S(n,a))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const n=this.constructor.K.c?.(()=>this.requestUpdate());Eu(this,Yh,n);const r=!this.manager.connectedCalled;super.connectedCallback(),r?queueMicrotask(()=>Jb(this,P2,l_e).call(this).catch(i=>{Ir(this,Vy).reject(i),setTimeout(()=>{throw i})})):n&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),Ir(this,Yh)?.destroy(),Eu(this,Yh,void 0)}createRenderRoot(){const n=this.el.shadowRoot,r=this.constructor,i=r.shadowRootOptions,o=n??(i===Pre?this.el:this.el.attachShadow(i));if(this.isConnected){const a=o.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...r.elementStyles.map(l=>"styleSheet"in l?l.styleSheet:l)]}return o}shouldUpdate(n){var r;return this.manager.Q=n,((r=Ir(this,pA))==null?void 0:r.call(this,n))??!0}update(n){Ir(this,Yh)?Jb(this,P2,a_e).call(this,n):super.update(n)}listen(n,r,i){const s=r?.bind(this)??r;this.manager.onLifecycle(()=>(this.el.addEventListener(n,s,i),()=>this.el.removeEventListener(n,s,i)))}listenOn(n,r,i,s){const o=i?.bind(this)??i;this.manager.onLifecycle(()=>(n.addEventListener(r,o,s),()=>n.removeEventListener(r,o,s)))}async componentOnReady(){return await Ir(this,Vy).promise,this}addController(n){this.M.push(n),!(hW in n)&&this.renderRoot&&this.el.isConnected&&n.hostConnected?.()}removeController(n){this.M.splice(this.M.indexOf(n),1),n.controllerRemoved?.()}};Fy=new WeakMap,pA=new WeakMap,mA=new WeakMap,Vy=new WeakMap,Yh=new WeakMap,P2=new WeakSet,a_e=function(n){try{Ir(this,Yh).clear(),this.constructor.K.r(Ir(this,Yh),()=>lY(UT.prototype,this,"update").call(this,n))}catch(r){throw Ir(this,Yh).clear(),r}},l_e=async function(){const n=this.el.G??t_e(this.el);n&&await n;const r=[];for(const s of this.M)"triggerLoad"in s?r.push(s.triggerLoad()):r.push(pV(s.hostLoad,s));await Promise.all(r),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(s=>s.has(vV)&&this.manager.U()),Ir(this,mA).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const i=this.J.filter(s=>!s.manager?.loadedCalled);i.length&&await Promise.allSettled(i.map(async s=>await s.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const s of this.M)"triggerLoaded"in s?s.triggerLoaded():Ri(s.hostLoaded,s);this.loaded?.(),Ir(this,Vy).resolve()},UT.lumina=!0;let Mre=UT;const pnt=t=>{let e;const n=i=>{e=new URL(i,globalThis.location?.href||void 0).href},r={...t,getAssetPath(i){const s=new URL(i,e);return s.origin!==globalThis.location?.origin?s.href:s.pathname},setAssetPath:n,customElement(i,s){s.K=r,s.L=i,customElements.get(i)||customElements.define(i,s)}};return n(t.defaultAssetPath),r},Y5t=t=>typeof t=="object"&&t!=null?cnt(t):t,X5t=t=>typeof t=="object"&&t!=null?hnt(t):t,Z5t=Ji;function J5t(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}const Q5t={toAttribute:t=>t===!0?"":t===!1?null:t},mnt="calcite-mode-auto",gnt="calcite-mode-dark",eOt={rtl:"calcite--rtl"},tOt={filter:250,nextTick:0,resize:150,reposition:100},nOt=25;function Nre(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,n=()=>t.contains(gnt)||t.contains(mnt)&&e?"dark":"light",r=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),i=o=>{s!==o&&r(o),s=o};let s=n();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>i(o.matches?"dark":"light")),new MutationObserver(()=>i(n())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const wT=globalThis.calciteConfig,rOt=wT?.focusTrapStack||[],iOt=wT?.logLevel||"info",Ore="3.3.3",ynt="2025-10-08",vnt="7391af08e";function _nt(){if(wT&&wT.version)return;console.info(`Using Calcite Components ${Ore} [Date: ${ynt}, Revision: ${vnt}]`);const t=wT||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:Ore,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?Nre():document.addEventListener("DOMContentLoaded",Nre,{once:!0});queueMicrotask(_nt);const xnt=pnt({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:sOt,getAssetPath:oOt,setAssetPath:wnt}=xnt;let c_e=!1;const bnt=t=>{c_e=!0,wnt(t)};let u_e;function Ent(){c_e||bnt(Bc(Gi(u_e)))}function _W(t){const e=[];for(const n of Object.keys(t))customElements.get(`calcite-${n}`)||e.push(t[n]?.());return e.length>0?Promise.all(e):null}u_e="components/assets";const h_e=Symbol("widget"),d_e=Symbol("widget-test-data"),Snt=[],Tnt={},Q4=new WeakMap;function f_e(t,e){let n=e.children;if(n?.length)for(let i=0;i<n.length;++i)n[i]=f_e(t,n[i]);else n=Snt;const r=e.vnodeSelector;if(eN(r)){const i=e.properties||Tnt,s=i.key||r,o={key:s,afterCreate:knt,afterUpdate:Ant,afterRemoved:p_e,parentWidget:t,widgetConstructor:r,widgetProperties:{...i,key:s,children:n}};return{vnodeSelector:r.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function knt(t,e,n,{parentWidget:r,widgetConstructor:i,widgetProperties:s}){const o=new i(s);o.container=t,Q4.set(t,o),o.afterCreate?.(o,t),r.addHandles(qn(()=>p_e(t))),queueMicrotask(()=>{o[d_e].projector?.renderNow()})}function Ant(t,e,n,{widgetProperties:r}){const i=Q4.get(t);i&&(i.set(r),i.afterUpdate?.(i,t))}function p_e(t){const e=Q4.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),Q4.delete(t))}function eN(t){return typeof t=="function"&&t[h_e]}const Lre=new Set;function Int(t){Lre.add(t),t.finally(()=>Lre.delete(t))}function Rnt(t){return qn()}var Dre;let Pnt=0;function m_e(t,e){const n=Object.prototype.hasOwnProperty;for(const r in e)n.call(e,r)&&n.call(t,r)&&(t[r]!=null&&e[r]!=null&&typeof t[r]=="object"&&typeof e[r]=="object"?m_e(t[r],e[r]):t[r]=e[r]);return t}const Cnt=mtt({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,n=/capture$/i;t.eventHandlerInterceptor=(r,i,s,o)=>{const a=e?.(r,i,s,o),l=n.test(r);if(!((r=r.replace(n,"")).toLowerCase()in s)||l){const c=r[2].toLowerCase()+r.slice(3),u=g=>a?.call(s,g);s.addEventListener(c,u,l);const h=()=>s.removeEventListener(c,u,l),f=o.afterRemoved;o.afterRemoved=g=>{f?.(g),h()}}return a}},handleInterceptedEvent(t,e,n,r){const{eventPhase:i,type:s}=r,o=i===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&(Hve(),t.scheduleRender(),l[a].call(l.bind||n,r))}});let s8=!1;var l1;let Xs=(l1=class extends Vfe(nI){constructor(e,n){super(e,n),this._attached=!1,this._projector=Cnt,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=r6e(async()=>{if(this._messageBundleProps?.length){const l=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:c,propertyName:u})=>{if(this.destroyed)return;let h=await wpe(c);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(h=m_e(Ze(h),this.uiStrings)),this[u]=h)}));if(this.destroyed)return;for(const c of l)c.status==="rejected"&&Tt.getLogger(this).error("widget-intl:locale-error",this.declaredClass,c.reason)}await this.loadLocale()}),this.addHandles(Rnt()),Ent();const r="esri-widget-uid-"+hI(),i=this.render.bind(this);this._trackingTarget=new tO(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const s=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const l=i()??s(),c=l.properties??={};if(c.key??=r,eN(l.vnodeSelector)){if(!this.visible)return s()}else this.visible?c.styles||(c.styles={}):(c.class="",c.styles={display:"none"}),c.styles.display??="";let u=0;return l.children?.forEach(h=>{eN(h.vnodeSelector)||(h.properties??={},h.properties.key??=`${this.id}--${u++}`)}),f_e(this,l)};this.render=()=>{if(s8)return o();let l=ttt(this)??null;if(l)return l;this._trackingTarget.clear(),s8=!0;try{l=ap(this._trackingTarget,o)}catch(c){throw Tt.getLogger(this).error(c),c}finally{s8=!1}return l&&ntt(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Int(this._resourcesFetch)}normalizeCtorArgs(e,n){const r={...e};return n&&(r.container=n),r}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(rQ):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(Mi(this._trackingTarget),Mi(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,t8(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return OB(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Pnt++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(Dre=h_e,d_e)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(t8(this),this._projector.scheduleRender())}classes(...e){return rtt.apply(this,e)}renderNow(){t8(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(dn(()=>this.viewModel,(n,r)=>{r&&this.removeHandles("delegated-events"),n&&Z5(n)&&this.addHandles(this._delegatedEventNames.map(i=>B2(n,i,s=>{this.emit(i,s)})),"delegated-events")},ea)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(rQ),this.scheduleRender()};this.addHandles([vpe(e),dn(()=>this.uiStrings,e)]),this.addHandles(hc(()=>this.container,n=>{this.destroyed||this._attach(n)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},l1[Dre]=!0,l1.vnodeSelector="div",l1);_([E()],Xs.prototype,"_readyForTrueRender",void 0),_([E({value:null})],Xs.prototype,"container",null),_([zs("container")],Xs.prototype,"castContainer",null),_([E()],Xs.prototype,"icon",null),_([E()],Xs.prototype,"id",null),_([E()],Xs.prototype,"label",null),_([E()],Xs.prototype,"renderable",null),_([E()],Xs.prototype,"uiStrings",void 0),_([E()],Xs.prototype,"viewModel",void 0),_([E({value:!0})],Xs.prototype,"visible",null),_([E()],Xs.prototype,"key",void 0),_([E()],Xs.prototype,"children",void 0),_([E()],Xs.prototype,"afterCreate",void 0),_([E()],Xs.prototype,"afterUpdate",void 0),_([E()],Xs.prototype,"afterRemoved",void 0),Xs=_([ue("esri.widgets.Widget")],Xs);const zO=Xs,Mnt=new Map;function Nnt(t){return Mnt.get(t)}function $re(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function Ont(t,e){return t.length!==e.length||t.some((n,r)=>n.text!==e[r].text)}function QP(t,e,n){!n||!e||t.find(r=>r.layerView===e&&r.text===n)||t.push({text:n,layerView:e})}function Lnt(t){return t.type==="bing-maps"}const Oh=[];let sx=class extends Kt{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Ot,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const n=this.view?.allLayerViews;n&&(this.addHandles(n.map(r=>dn(()=>[r.suspended,r.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),n.forEach(r=>{r.declaredClass==="esri.views.3d.layers.IntegratedMesh3DTilesLayerView3D"&&this.addHandles(r.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),e?.removed&&e.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.addHandles([$1(()=>this.view?.allLayerViews,"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),hc(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;Oh.length=0;let n=!1,r=null;if(!t||!e)return void this._clear();e.forEach(s=>{if(s.suspended||!s.layer?.attributionVisible)return;const o=s.layer;if($re(o,"user"))return void QP(Oh,s,o.copyright);if(o.type==="integrated-mesh-3dtiles"&&o.hasGoogleUrl&&(n=!0,r=s),o.hasAttributionData){if(this._fetchedAttributionData.has(s)){const l=this._fetchedAttributionData.get(s);return void(l?QP(Oh,s,this._getDynamicAttribution(l,t,o)):$re(o)&&QP(Oh,s,o.copyright))}return void this._fetchAttributionData(s)}const a="portalItem"in o?o.portalItem?.accessInformation:void 0;QP(Oh,s,a||o.copyright)});const i=e.find(s=>s.layer?.type==="integrated-mesh-3dtiles");if(this.view&&i){const s=Nnt(this.view);if(s){const o=s.getAttributionText();for(let a=o.length-1;a>-1;--a)Oh.unshift({text:o[a],layerView:i})}}n&&r&&Oh.unshift({text:"Google Maps",layerView:r}),Ont(this.items,Oh)&&(this.items.removeAll(),this.items.addMany(Oh)),Oh.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await zfe(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const n=e.ok?this._createContributionIndex(e.value,Lnt(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,n)}this._updateAttributionItems()}_createContributionIndex(t,e){const n=t.contributors,r={};if(!n)return r;for(let i=0;i<n.length;i++){const s=n[i],o=s.coverageAreas;if(!o)return;for(const a of o){const l=a.bbox,c=a.zoomMin-(e&&a.zoomMin?1:0),u=a.zoomMax-(e&&a.zoomMax?1:0),h=new Dn({xmin:l[1],ymin:l[0],xmax:l[3],ymax:l[2],spatialReference:Bt.WGS84}),f={extent:Yy(h),attribution:s.attribution||"",score:a.score!=null?a.score:100,id:i};for(let g=c;g<=u;g++)r[g]??=[],r[g].push(f)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,n){const{extent:r,scale:i}=e;let s=n.tileInfo?.scaleToZoom(i)??0;if(s=Math.min(t.maxKey??0,Math.round(s)),!r||s==null||s<=-1)return"";const o=t[s],a=cO(r.center.clone().normalize(),Bt.WebMercator),l=new Set;return o?o.filter(c=>{const u=c.id,h=!l.has(u)&&a&&c.extent&&sI(c.extent,a);return h&&l.add(u),h}).sort((c,u)=>u.score-c.score||c.objectId-u.objectId).map(c=>c.attribution).join(", "):""}};_([E({readOnly:!0,type:Ot})],sx.prototype,"items",void 0),_([E({readOnly:!0})],sx.prototype,"state",null),_([E()],sx.prototype,"view",void 0),sx=_([ue("esri.widgets.Attribution.AttributionViewModel")],sx);const g_e=sx,vd={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function Dnt(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:jnt(t[e])}}}function $nt(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function jnt(t){return function(e,...n){$nt(e)?stt(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...n)}}function UO(t){return(e,n)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:n})}}var Fnt=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},y_e=function(t,e){for(var n=0,r=t.length;n<r;n++){var i=t[n];Array.isArray(i)?y_e(i,e):i!=null&&i!==!1&&(i.hasOwnProperty("vnodeSelector")||(i=Fnt(i)),e.push(i))}},Vnt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(n.length===1&&typeof n[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:n[0],domNode:null};var i=[];return y_e(n,i),{vnodeSelector:t,properties:e||void 0,children:i,text:void 0,domNode:null}};function gl(t,e,...n){return typeof t!="function"||eN(t)?Vnt(t,e??null,...n):t(e,...n)}function aOt(...t){return t}const b_="esri-attribution",E_={base:b_,poweredBy:`${b_}__powered-by`,sources:`${b_}__sources`,open:`${b_}--open`,sourcesOpen:`${b_}__sources--open`,link:`${b_}__link`};let wa=class extends zO{constructor(e,n){super(e,n),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._sourcesNode=null,this._overflowRequestAnimationFrame=null,this._resizeObserver=new ResizeObserver(r=>{r.forEach(({target:i})=>{this._scheduleOverflowCheck(i)})}),this._mutationObserver=new MutationObserver(r=>{let i=!1;for(const s of r)if(s.type==="childList"||s.type==="characterData"||s.type==="attributes"){i=!0;break}i&&this._sourcesNode&&this._scheduleOverflowCheck(this._sourcesNode)}),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new g_e}initialize(){this.addHandles($1(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._overflowRequestAnimationFrame!=null&&(cancelAnimationFrame(this._overflowRequestAnimationFrame),this._overflowRequestAnimationFrame=null)}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}_scheduleOverflowCheck(e){this._overflowRequestAnimationFrame==null&&(this._overflowRequestAnimationFrame=requestAnimationFrame(()=>{this._overflowRequestAnimationFrame=null,this._checkSourceTextOverflow(e)}))}get attributionText(){return this.viewModel.items.reduce((e,n)=>(e.includes(n.text)||e.push(n.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[E_.open]:this._isOpen};return gl("div",{bind:this,class:this.classes(E_.base,vd.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return gl("div",{class:E_.poweredBy},"Powered by"," ",gl("a",{class:E_.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,n=this._isInteractive,r=n?0:void 0,{attributionText:i}=this,s={[E_.sourcesOpen]:e,[vd.interactive]:n};return gl("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(E_.sources,s),innerHTML:i,tabIndex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._sourcesNode=e,this._resizeObserver.observe(e),this._mutationObserver.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0}),this._scheduleOverflowCheck(e)}_checkSourceTextOverflow(e){let n=!1;const{clientHeight:r,clientWidth:i,scrollWidth:s}=e,o=s>i,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(n=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,n=!0)}n&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};_([E()],wa.prototype,"_isOpen",void 0),_([E()],wa.prototype,"_isInteractive",null),_([E()],wa.prototype,"_attributionTextOverflowed",void 0),_([E()],wa.prototype,"_prevSourceNodeHeight",void 0),_([E({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],wa.prototype,"attributionText",null),_([E()],wa.prototype,"icon",null),_([E()],wa.prototype,"itemDelimiter",void 0),_([E()],wa.prototype,"label",null),_([E(),UO("esri/widgets/Attribution/t9n/Attribution")],wa.prototype,"messages",void 0),_([E()],wa.prototype,"view",null),_([E({type:g_e})],wa.prototype,"viewModel",void 0),_([Dnt()],wa.prototype,"_toggleState",null),wa=_([ue("esri.widgets.Attribution")],wa);const znt=wa;function Unt(){const t=ye("mapview-essential-goto-duration");return t==null?t:t}function Gnt(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function Bnt(t,e,n){return t.goTo(e,n)}const Wnt=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:i}=this;return Lde(i),this.goToOverride?this.goToOverride(i,r):Bnt(i,r.target,r.options)}};return _([E()],n.prototype,"goToOverride",void 0),_([E()],n.prototype,"view",void 0),n=_([ue("esri.widgets.support.GoTo")],n),n};let sy=class extends Wnt(Kt){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(fa)}destroy(){this.view=null}get canShowNorth(){return Gnt(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:Unt()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const n=-e.heading;this._set("orientation",{x:0,y:0,z:n})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?dn(()=>e?.rotation,this._updateForRotation,fa):dn(()=>e?.camera,this._updateForCamera,fa))}_watchForView(e){this.addHandles(dn(()=>this.view,this._updateRotationWatcher,e))}};_([E({readOnly:!0})],sy.prototype,"canShowNorth",null),_([E({readOnly:!0})],sy.prototype,"orientation",void 0),_([E({readOnly:!0})],sy.prototype,"state",null),_([E()],sy.prototype,"view",void 0),sy=_([ue("esri.widgets.Compass.CompassViewModel")],sy);const v_e=sy,jre="esri-compass",Fre={base:jre,iconContainer:`${jre}__icon-container`};let wf=class extends zO{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new v_e,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return _W({button:()=>_e(()=>import("./index-BGmMjSHe.js"),__vite__mapDeps([407,408,409,410,411,412,413,414,415,416,417,418,419,420])),icon:()=>_e(()=>import("./index-BukTyvfh.js").then(e=>e.i),__vite__mapDeps([412,413,414]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:n}=this.viewModel,{messages:r}=this;return gl("div",{class:this.classes(Fre.base,vd.widget)},gl("calcite-button",{class:vd.widgetButton,disabled:n==="disabled",kind:"neutral",label:r.reset,onclick:this._reset,round:!0,scale:"s",title:r.reset},gl("div",{"aria-hidden":"true",class:Fre.iconContainer,title:r.reset},gl("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};_([E()],wf.prototype,"goToOverride",null),_([E()],wf.prototype,"icon",null),_([E()],wf.prototype,"label",null),_([E(),UO("esri/widgets/Compass/t9n/Compass")],wf.prototype,"messages",void 0),_([E()],wf.prototype,"view",null),_([E({type:v_e})],wf.prototype,"viewModel",void 0),wf=_([ue("esri.widgets.Compass")],wf);const Hnt=wf,Vre="esri-navigation-toggle",zre={base:Vre,isLayoutHorizontal:`${Vre}--horizontal`};let ox=class extends Kt{constructor(t){super(t),this._navigationMode="pan",this.view=null,t?.isDefaultViewModel||O6e(Tt.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(t={}){const{isDefaultViewModel:e,...n}=t;return n}initialize(){this.addHandles(hc(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const t=this.view?.navigation?.actionMap;if(!t)return;const e=this._navigationMode==="pan";t.dragPrimary=e?"pan":"rotate",t.dragSecondary=e?"rotate":"pan"}};_([E({readOnly:!0})],ox.prototype,"state",null),_([E()],ox.prototype,"_navigationMode",void 0),_([E()],ox.prototype,"view",void 0),ox=_([ue("esri.widgets.NavigationToggle.NavigationToggleViewModel")],ox);const __e=ox;let bf=class extends zO{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new __e({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const r=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;ott(r),this.toggle()},e?.isDefaultUI||N6e(Tt.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:n,...r}=e;return r}loadDependencies(){return _W({button:()=>_e(()=>import("./index-BGmMjSHe.js"),__vite__mapDeps([407,408,409,410,411,412,413,414,415,416,417,418,419,420]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",n=this.viewModel?.navigationMode==="pan",r=this.messages.toggle;return gl("div",{class:this.classes(zre.base,vd.widget,{[zre.isLayoutHorizontal]:this.layout==="horizontal"})},gl("calcite-button",{afterCreate:i=>{this._panButton=i},appearance:n?"outline-fill":"solid",class:vd.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:n?void 0:-1,title:r}),gl("calcite-button",{afterCreate:i=>{this._rotateButton=i},appearance:n?"solid":"outline-fill",class:vd.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:n?-1:void 0,title:r}))}};_([E()],bf.prototype,"icon",null),_([E()],bf.prototype,"label",null),_([E({value:"vertical"})],bf.prototype,"layout",null),_([E(),UO("esri/widgets/NavigationToggle/t9n/NavigationToggle")],bf.prototype,"messages",void 0),_([E()],bf.prototype,"view",null),_([E({type:__e})],bf.prototype,"viewModel",void 0),bf=_([ue("esri.widgets.NavigationToggle")],bf);const qnt=bf;let oy=class extends Kt{get canZoomIn(){if(!this.view?.ready)return!1;const n=this.view?.constraints?.effectiveMaxScale;return n===0||this._scale>n}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const r=e.constraints?.effectiveMinScale;return r===0||this._scale<r}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};_([E({readOnly:!0})],oy.prototype,"canZoomIn",null),_([E({readOnly:!0})],oy.prototype,"canZoomOut",null),_([E()],oy.prototype,"view",void 0),_([E()],oy.prototype,"_scale",null),oy=_([ue("esri.widgets.Zoom.ZoomConditions2D")],oy);const Knt=oy;let ax=class extends Kt{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};_([E({readOnly:!0})],ax.prototype,"canZoomIn",null),_([E({readOnly:!0})],ax.prototype,"canZoomOut",null),_([E()],ax.prototype,"view",void 0),ax=_([ue("esri.widgets.Zoom.ZoomConditions3D")],ax);const Ynt=ax;let Sm=class extends Kt{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Knt({view:e}):e.type==="3d"&&(this._zoomConditions=new Ynt({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():n4(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():n4(e.goTo({zoomFactor:.5})))}};_([E()],Sm.prototype,"_zoomConditions",void 0),_([E()],Sm.prototype,"canZoomIn",null),_([E()],Sm.prototype,"canZoomOut",null),_([E({readOnly:!0})],Sm.prototype,"state",null),_([E()],Sm.prototype,"view",null),Sm=_([ue("esri.widgets.Zoom.ZoomViewModel")],Sm);const x_e=Sm,Ure={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Ef=class extends zO{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new x_e,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return _W({button:()=>_e(()=>import("./index-BGmMjSHe.js"),__vite__mapDeps([407,408,409,410,411,412,413,414,415,416,417,418,419,420]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[Ure.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:n,canZoomOut:r}=this.viewModel,{zoomIn:i,zoomOut:s}=this.messages;return gl("div",{class:this.classes(Ure.base,vd.widget,e)},gl("calcite-button",{class:vd.widgetButton,disabled:!n,iconStart:"plus",kind:"neutral",label:i,onclick:this.zoomIn,title:i}),gl("calcite-button",{class:vd.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};_([E()],Ef.prototype,"icon",null),_([E()],Ef.prototype,"label",null),_([E({value:"vertical"})],Ef.prototype,"layout",null),_([E(),UO("esri/widgets/Zoom/t9n/Zoom")],Ef.prototype,"messages",void 0),_([E()],Ef.prototype,"view",null),_([E({type:x_e})],Ef.prototype,"viewModel",void 0),Ef=_([ue("esri.widgets.Zoom")],Ef);const Xnt=Ef;function Znt(t){return t?.view!==void 0}let zM=class extends ctt{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(n=>{const r=this._find(n),i=r?.widget;Znt(i)&&(i.view=e)})},this._componentsWatcher=(e,n)=>{this._removeComponents(n),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([dn(()=>this.components,this._componentsWatcher,fa),dn(()=>this.view,this._updateViewAwareWidgets,fa)])}_add(t,e,n,r,i){let s=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;s=this._createComponent(t)}super._add(s,e,n,r,i)}_removeComponents(t){t.forEach(e=>{const n=this._find(e);n&&(this.remove(n),n.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(t){const e=this._createWidget(t);return new jM({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new znt({view:e});case"compass":return new Hnt({view:e});case"navigation-toggle":return new qnt({view:e,isDefaultUI:!0});case"zoom":return new Xnt({view:e})}}};_([E()],zM.prototype,"components",void 0),zM=_([ue("esri.views.ui.DefaultUI")],zM);const w_e=zM;let UM=class extends w_e{constructor(e){super(e),this.components=["attribution","zoom"]}};_([E()],UM.prototype,"components",void 0),UM=_([ue("esri.views.ui.2d.DefaultUI2D")],UM);const b_e=UM;let Jnt=class{constructor(t={},e={},n=8,r=1/0){this.disabledExtensions=t,this.debugWebGLExtensions=e,this.maxAnisotropy=n,this.maxPreferredTexturePixels=r}},Qnt=class _V{constructor(e,n,r=""){this.major=e,this.minor=n,this._context=r}lessThan(e,n){return this.major<e||e===this.major&&this.minor<n}greaterEqual(e,n){return!this.lessThan(e,n)}validate(e){if(this.major!==e.major){const n=this._context&&this._context+":",r=this._context&&this._context+" ";throw new Xe(n+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new _V(this.major,this.minor,this._context)}static parse(e,n=""){const[r,i]=e.split("."),s=/^\s*\d+\s*$/;if(!r?.match||!s.test(r))throw new Xe((n&&n+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!i?.match||!s.test(i))throw new Xe((n&&n+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(r,10),a=parseInt(i,10);return new _V(o,a,n)}};class ert extends Qnt{constructor(e,n){super(e,n,"webmap")}}function o8(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new ert(2,35);var xV;let GM=xV=class extends qt{constructor(t){super(t),this.color=new Kn([0,0,0,1])}clone(){return new xV(Ze({color:this.color}))}};_([E({type:Kn,json:{write:!0}})],GM.prototype,"color",void 0),GM=xV=_([ue("esri.webmap.background.ColorBackground")],GM);const trt=GM;let E_e,S_e,T_e,k_e,A_e,I_e,R_e;async function nrt(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:n,MapViewNavigation:r,MagnifierView2D:i,GridView2D:s,Stage:o}]=await Promise.all([_e(()=>import("./webglDeps-BqjsH8Rb.js"),__vite__mapDeps([305,247,306,307,308,49,142])),_e(()=>import("./mapViewDeps-bU-Fi3lF.js"),__vite__mapDeps([309,28,29,30,179,180,172,50,49,181,33,34,178,182,168,18,19,310,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,315,183,184,316,39,40,170,127,128,317,108,305,318,196,319,320,223,321,236,237,322,48,166,171,173,22,122,121,323,185,324,177,102,103,104,325,187,192,164,326,327,328,329,243,267,330,331]))]);S_e=t,T_e=e,k_e=n,A_e=r,I_e=i,R_e=s,E_e=o}var Nw;let jn=(Nw=class extends FJe(gZe(GBe(pHe(JWe(VYe))))){get timeZone(){return super.timeZone}set timeZone(e){super.timeZone=e}constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Hu({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new CO({actionMap:new JB({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.analyses=new y2,this.analysisViewManager=new $et({importAnalysisViewModule:n=>IQe(n),view:this}),this.floors=new Ot,this.grid=null,this.map=null,this.timeline=new Uve,this.type="2d",this.view2dType=null,this.ui=new b_e,this.animationsEnabled=!0,this.test={takeScreenshot:async n=>Met(this._getScreenshotView(n),n)},this.padding={top:0,right:0,bottom:0,left:0},VBe()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=Mi(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new jQe(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,n=this.spatialReference;return{lods:e?.spatialReference?.equals(n)?e.lods:null,spatialReference:n}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:n,center:r,viewpoint:i,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!s&&(n?.effectiveLODs||(o=-1),(!r||e===0&&o===-1)&&(i?.targetGeometry==null||i.targetGeometry.type!=="extent"&&!i.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const n=e.targetGeometry,r=this.spatialReference;return Yge(n.spatialReference,r)}get background(){return o8(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return super.constraints}set constraints(e){super.constraints=e}get highlightOptions(){return met(this)}set highlightOptions(e){get(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return super.resizeAlign}set resizeAlign(e){super.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return super.rotation}set rotation(e){super.rotation=e}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get spatialReference(){return super.spatialReference}set spatialReference(e){super.spatialReference=e}get spatialReferenceLocked(){return this._get("spatialReferenceLocked")}set spatialReferenceLocked(e){this.stage&&Tt.getLogger(this).warn("spatialReferenceLocked cannot be changed after the view has become ready"),this._set("spatialReferenceLocked",e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),n=!this.destroyed&&(!this.analysisViewManager||!this.layerViewManager||!this.labelManager||!this.graphicsView||this.analysisViewManager.updating===!0||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(r=>!r.destroyed&&!("layerViews"in r)&&r.updating===!0)||e);if(ye("esri-2d-log-updating")){const r=this.allLayerViews.reduce((i,s)=>({...i,[`${s.layer.id}(${s.layer.type})`]:!s.destroyed&&!("layerViews"in s)&&s.updating}),{});console.log(`Updating MapView: ${n}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(r)}
-> updatingMagnifier: ${e}
`)}return n}get viewpoint(){return super.viewpoint}set viewpoint(e){super.viewpoint=e}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new vi({rings:[e.map(n=>[n[0],n[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,n){return yet(this,e,n)}async takeScreenshot(e){return Cet(this._getScreenshotView(e),e)}toScreen(e,n){return this.stateManager.toScreen(e,n)}async whenAnalysisView(e){if(e.parent==null)throw new Xe("view:no-analysisview-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return this.analysisViewManager.whenAnalysisView(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return o8(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return o8(this.map)?this.map.initialViewProperties.timeExtent:null}getSurface(){return this.surface}hasLayerViewModule(e){return Jne.hasLayerViewModule(e)}importLayerView(e){return Jne.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(Tt.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const n=this.toMap(e),r=await this.hitTest(e),i=this.allLayerViews.toArray().filter(c=>c.clips.every(u=>Cve(this,u,e,n))).reverse(),s=new globalThis.Map(i.map(c=>[c.layer.uid,c])),o=[];let a=0,l=0;for(;a<r.results.length||l<i.length;){const c=r.results.at(a);if(c&&c.type!=="graphic"){++a;continue}const u=s.get((c?.layer??c?.graphic.layer)?.uid);if((!c||u)&&l<i.length&&i.at(l)!==u){const h=i.at(l);"fetchPopupFeaturesAtLocation"in h&&o.push({mapPoint:n,layerView:h}),++l}else c&&(o.push({graphic:c.graphic,layerView:u}),++a)}return{hits:o,location:n}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Bet(this.type);if(ye("safari")&&ye("safari")<9&&(e=new Xe("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ye("safari")})),e!=null)throw Tt.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return nrt()}_getDefaultViewpoint(){const{constraints:e,initialExtent:n,map:r,padding:i,size:s}=this;if(!e)return null;const o=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o?.viewpoint,c=l?.targetGeometry?.extent??n,u=c?.center,h=l?.rotation??0,f=l?.scale||c&&NO(c,[s[0]-i.left-i.right,s[1]-i.top-i.bottom]),g=a.center??u,v=a.rotation??h,x=a.scale??f;return g&&x?new tu({targetGeometry:g,scale:x,rotation:v}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const n=new RQe(this.surface),r=new E_e(this.surface,{canvas:this.renderCanvas,contextOptions:new Jnt(this.deactivatedWebGLExtensions,this.debugWebGLExtensions),renderingOptions:this.renderingOptions,timeline:this.timeline},n);this.stage=r,this._magnifierView=new I_e,this._magnifierView.magnifier=this.magnifier,this._gridView=new R_e;const i=new k_e({view:this});this._set("labelManager",i);const s=new yQe({view:this});this._set("animationManager",s);const o=new A_e({view:this,animationManager:s});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),r.on("webgl-error",l=>this.fatalError=l.error),dn(()=>this.stationary,l=>r.stationary=l,ea),dn(()=>this.background,l=>{r.backgroundColor=l?.color,this._magnifierView.backgroundColor=l?.color},ea),dn(()=>this.magnifier,l=>this._magnifierView.magnifier=l,ea),dn(()=>this.grid,l=>this._gridView.grid=l,ea),dn(()=>this.renderingOptions,l=>r.renderingOptions=l,ea),dn(()=>this.highlights.items.map(l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})),()=>{r.highlightGradient=fet(r.highlightGradient,this.highlights.items)},ea),dn(()=>this.state.id,()=>r.state=this.state,ea),dn(()=>this.animationsEnabled,l=>{this.stage.animationsEnabled=l},ea)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(n=>{this.stage.addChild(n.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new EQe(xa.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const n=new S_e({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new T_e(e)});this._set("graphicsView",n)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:n,padding:r,size:i,stage:s}=this;return{allLayerViews:n,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:r,size:i,stage:s}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const n of this.allLayerViews)n.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const n of this.allLayerViews)n.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},Nw.type="2d",Nw);_([E({constructOnly:!0})],jn.prototype,"deactivatedWebGLExtensions",void 0),_([E({constructOnly:!0})],jn.prototype,"debugWebGLExtensions",void 0),_([E({readOnly:!0})],jn.prototype,"featuresTilingScheme",void 0),_([E({readOnly:!0})],jn.prototype,"graphicsTileStore",null),_([E()],jn.prototype,"graphicsView",void 0),_([E()],jn.prototype,"constraintsInfo",null),_([E()],jn.prototype,"initialExtentRequired",null),_([E()],jn.prototype,"labelManager",void 0),_([E({type:CO,nonNullable:!0})],jn.prototype,"navigation",void 0),_([E({constructOnly:!0})],jn.prototype,"renderCanvas",void 0),_([E()],jn.prototype,"renderingOptions",void 0),_([E({constructOnly:!0})],jn.prototype,"supersampleScreenshotsEnabled",void 0),_([E()],jn.prototype,"defaultsFromMapSettings",null),_([E({readOnly:!0})],jn.prototype,"typeSpecificPreconditionsReady",null),_([E(w9(y2,"analyses"))],jn.prototype,"analyses",void 0),_([E()],jn.prototype,"analysisViewManager",void 0),_([E({type:trt})],jn.prototype,"background",null),_([E()],jn.prototype,"center",null),_([E({type:Ot})],jn.prototype,"floors",void 0),_([E()],jn.prototype,"grid",void 0),_([E({type:yg})],jn.prototype,"highlightOptions",null),_([E()],jn.prototype,"map",void 0),_([E()],jn.prototype,"padding",null),_([E({readOnly:!0})],jn.prototype,"rendering",null),_([E({readOnly:!0})],jn.prototype,"resolution",null),_([E()],jn.prototype,"scale",null),_([E({type:Boolean,value:!1})],jn.prototype,"spatialReferenceLocked",null),_([E({readOnly:!0})],jn.prototype,"tileInfo",null),_([E({type:Uve,readOnly:!0})],jn.prototype,"timeline",void 0),_([E({readOnly:!0})],jn.prototype,"type",void 0),_([E({readOnly:!0})],jn.prototype,"updating",null),_([E({readOnly:!0})],jn.prototype,"view2dType",void 0),_([E({readOnly:!0})],jn.prototype,"visibleArea",null),_([E()],jn.prototype,"zoom",null),_([E({readOnly:!0})],jn.prototype,"navigating",null),_([E(),zs(t=>t instanceof w_e?t:nO(b_e,t))],jn.prototype,"ui",void 0),_([E()],jn.prototype,"animationsEnabled",void 0),jn=_([ue("esri.views.View2D")],jn);const rrt=jn;let BM=class extends rrt{constructor(t){super(t),this.view2dType="map"}};_([E({readOnly:!0})],BM.prototype,"view2dType",void 0),BM=_([ue("esri.views.MapView")],BM);const irt=BM,Gre=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function srt(){const t=X.useRef(null),e=X.useRef(null),n=X.useRef(!1),r=X.useRef(!1),[i,s]=X.useState(!1);YLe({target:"map"});const o=$i(T=>T.map),a=$i(T=>T.setArcGISMap),l=io(T=>T.registerLayer),c=io(T=>T.setLayerVisibility),u=Nn(T=>T.defaultBackground);X.useEffect(()=>{if(!o){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const T=new Am({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new DRe}),A=new Am({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new hy({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),I=new Am({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new hy({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),R=new Am({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new hy({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),M=new Am({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new hy({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),F=new Am({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new hy({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});o.addLayer(T),o.addLayer(A),o.addLayer(I),o.addLayer(R),o.addLayer(M),o.addLayer(F),console.log(" Base layers added:",{osm:T.getVisible(),cartodb:A.getVisible(),satellite:I.getVisible()}),l("OpenStreetMap",T),l("CartoDB (licht)",A),l("Luchtfoto",I),l("Labels Overlay",R),l("TMK 1850",M),l("Bonnebladen 1900",F),o.updateSize(),console.log(" Map size:",o.getSize()),console.log(" Map center:",o.getView().getCenter()),console.log(" Map zoom:",o.getView().getZoom()),h()},[o,l]);async function h(){if(!o){console.error(" Cannot load layers: map is null");return}const T=HPe();console.log(` Loading ${T.length} immediate-load layers (WMS/Tile)...`);const A=await Promise.allSettled(T.map(async R=>{try{const M=await R.factory();return M?{name:R.name,layer:M}:null}catch(M){return console.warn(` Failed to create ${R.name}:`,M),null}}));let I=0;A.forEach(R=>{if(R.status==="fulfilled"&&R.value){const{name:M,layer:F}=R.value;o.addLayer(F),l(M,F),I++,console.log(`   ${M}`)}}),console.log(` Immediate layers loaded: ${I}/${T.length}`),console.log(` Total layers on map: ${o.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}X.useEffect(()=>{if(!o||!e.current||r.current)return;console.log(" Initializing ArcGIS MapView for AHN layers...");const T=o.getView(),A=T.getCenter(),I=T.getZoom()||8,R=A?Zn(A):[5.5,52],M=new m0e({}),F=new irt({container:e.current,map:M,center:R,zoom:I,constraints:{rotationEnabled:!1},ui:{components:[]},background:{color:[0,0,0,0]}});return F.when(()=>{console.log(" ArcGIS MapView ready"),console.log(" ArcGIS center:",F.center?.longitude,F.center?.latitude),console.log(" ArcGIS zoom:",F.zoom),a(M,F),s(!0),r.current=!0,T.on("change:center",()=>{const C=T.getCenter();if(C){const N=Zn(C);F.goTo({center:N},{animate:!1})}}),T.on("change:resolution",()=>{const C=T.getZoom();C!==void 0&&F.goTo({zoom:C},{animate:!1})})}).catch(C=>{console.error(" ArcGIS MapView initialization failed:",C),console.error("Error details:",C.message)}),()=>{F&&F.destroy()}},[o,a]),X.useEffect(()=>{if(!o||n.current)return;const T=setTimeout(()=>{const A=u||"CartoDB (licht)";Gre.forEach(I=>{c(I,!1)}),Gre.includes(A)?c(A,!0):c("CartoDB (licht)",!0),n.current=!0,console.log(` Default background: ${A}`)},100);return()=>clearTimeout(T)},[o,u,c]);const f=Nn(T=>T.gpsAutoStart),g=bs(T=>T.startTracking),v=X.useRef(!1);X.useEffect(()=>{if(!(!o||v.current)&&f){const T=setTimeout(()=>{g(),v.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(T)}},[o,f,g]);const x={width:"100%",height:"100vh"},b={opacity:i?1:0,transition:"opacity 0.3s ease"};return m.jsxs("div",{style:{position:"relative",width:"100%",height:"100vh"},children:[m.jsx("div",{id:"map",ref:t,style:x}),m.jsx("div",{id:"arcgis-map",ref:e,style:b})]})}const xW=X.createContext({});function wW(t){const e=X.useRef(null);return e.current===null&&(e.current=t()),e.current}const GO=X.createContext(null),bW=X.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class ort extends X.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function art({children:t,isPresent:e}){const n=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(bW);return X.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=i.current;if(e||!r.current||!o||!a)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return s&&(u.nonce=s),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),m.jsx(ort,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(t,{ref:r})})}const lrt=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o})=>{const a=wW(crt),l=X.useId(),c=X.useCallback(h=>{a.set(h,!0);for(const f of a.values())if(!f)return;r&&r()},[a,r]),u=X.useMemo(()=>({id:l,initial:e,isPresent:n,custom:i,onExitComplete:c,register:h=>(a.set(h,!1),()=>a.delete(h))}),s?[Math.random(),c]:[n,c]);return X.useMemo(()=>{a.forEach((h,f)=>a.set(f,!1))},[n]),X.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),o==="popLayout"&&(t=m.jsx(art,{isPresent:n,children:t})),m.jsx(GO.Provider,{value:u,children:t})};function crt(){return new Map}function P_e(t=!0){const e=X.useContext(GO);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{t&&i(s)},[t]);const o=X.useCallback(()=>t&&r&&r(s),[s,r,t]);return!n&&r?[!1,o]:[!0]}const eC=t=>t.key||"";function Bre(t){const e=[];return X.Children.forEach(t,n=>{X.isValidElement(n)&&e.push(n)}),e}const EW=typeof window<"u",C_e=EW?X.useLayoutEffect:X.useEffect,rr=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1})=>{const[a,l]=P_e(o),c=X.useMemo(()=>Bre(t),[t]),u=o&&!a?[]:c.map(eC),h=X.useRef(!0),f=X.useRef(c),g=wW(()=>new Map),[v,x]=X.useState(c),[b,T]=X.useState(c);C_e(()=>{h.current=!1,f.current=c;for(let R=0;R<b.length;R++){const M=eC(b[R]);u.includes(M)?g.delete(M):g.get(M)!==!0&&g.set(M,!1)}},[b,u.length,u.join("-")]);const A=[];if(c!==v){let R=[...c];for(let M=0;M<b.length;M++){const F=b[M],C=eC(F);u.includes(C)||(R.splice(M,0,F),A.push(F))}s==="wait"&&A.length&&(R=A),T(Bre(R)),x(c);return}const{forceRender:I}=X.useContext(xW);return m.jsx(m.Fragment,{children:b.map(R=>{const M=eC(R),F=o&&!a?!1:c===b||u.includes(M),C=()=>{if(g.has(M))g.set(M,!0);else return;let N=!0;g.forEach(O=>{O||(N=!1)}),N&&(I?.(),T(f.current),o&&l?.(),r&&r())};return m.jsx(lrt,{isPresent:F,initial:!h.current||n?void 0:!1,custom:F?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:F?void 0:C,children:R},M)})})},ac=t=>t;let M_e=ac;function SW(t){let e;return()=>(e===void 0&&(e=t()),e)}const b2=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},Zf=t=>t*1e3,Jf=t=>t/1e3,urt={useManualTiming:!1};function hrt(t){let e=new Set,n=new Set,r=!1,i=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){s.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const g=h&&r?e:n;return u&&s.add(c),g.has(c)||g.add(c),c},cancel:c=>{n.delete(c),s.delete(c)},process:c=>{if(o=c,r){i=!0;return}r=!0,[e,n]=[n,e],e.forEach(a),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const tC=["read","resolveKeyframes","update","preRender","render","postRender"],drt=40;function N_e(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=tC.reduce((T,A)=>(T[A]=hrt(s),T),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:f}=o,g=()=>{const T=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,drt),1),i.timestamp=T,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),u.process(i),h.process(i),f.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(g))},v=()=>{n=!0,r=!0,i.isProcessing||t(g)};return{schedule:tC.reduce((T,A)=>{const I=o[A];return T[A]=(R,M=!1,F=!1)=>(n||v(),I.schedule(R,M,F)),T},{}),cancel:T=>{for(let A=0;A<tC.length;A++)o[tC[A]].cancel(T)},state:i,steps:o}}const{schedule:di,cancel:Fg,state:So,steps:a8}=N_e(typeof requestAnimationFrame<"u"?requestAnimationFrame:ac,!0),O_e=X.createContext({strict:!1}),Wre={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},E2={};for(const t in Wre)E2[t]={isEnabled:e=>Wre[t].some(n=>!!e[n])};function frt(t){for(const e in t)E2[e]={...E2[e],...t[e]}}const prt=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tN(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||prt.has(t)}let L_e=t=>!tN(t);function mrt(t){t&&(L_e=e=>e.startsWith("on")?!tN(e):t(e))}try{mrt(require("@emotion/is-prop-valid").default)}catch{}function grt(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(L_e(i)||n===!0&&tN(i)||!e&&!tN(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function yrt(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const BO=X.createContext({});function Kk(t){return typeof t=="string"||Array.isArray(t)}function WO(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const TW=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kW=["initial",...TW];function HO(t){return WO(t.animate)||kW.some(e=>Kk(t[e]))}function D_e(t){return!!(HO(t)||t.variants)}function vrt(t,e){if(HO(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Kk(n)?n:void 0,animate:Kk(r)?r:void 0}}return t.inherit!==!1?e:{}}function _rt(t){const{initial:e,animate:n}=vrt(t,X.useContext(BO));return X.useMemo(()=>({initial:e,animate:n}),[Hre(e),Hre(n)])}function Hre(t){return Array.isArray(t)?t.join(" "):t}const xrt=Symbol.for("motionComponentSymbol");function Sx(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function wrt(t,e,n){return X.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Sx(n)&&(n.current=r))},[e])}const AW=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),brt="framerAppearId",$_e="data-"+AW(brt),{schedule:IW}=N_e(queueMicrotask,!1),j_e=X.createContext({});function Ert(t,e,n,r,i){var s,o;const{visualElement:a}=X.useContext(BO),l=X.useContext(O_e),c=X.useContext(GO),u=X.useContext(bW).reducedMotion,h=X.useRef(null);r=r||l.renderer,!h.current&&r&&(h.current=r(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const f=h.current,g=X.useContext(j_e);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&Srt(h.current,n,i,g);const v=X.useRef(!1);X.useInsertionEffect(()=>{f&&v.current&&f.update(n,c)});const x=n[$_e],b=X.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,x)));return C_e(()=>{f&&(v.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),IW.render(f.render),b.current&&f.animationState&&f.animationState.animateChanges())}),X.useEffect(()=>{f&&(!b.current&&f.animationState&&f.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),b.current=!1))}),f}function Srt(t,e,n,r){const{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:F_e(t.parent)),t.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&Sx(a),visualElement:t,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function F_e(t){if(t)return t.options.allowProjection!==!1?t.projection:F_e(t.parent)}function Trt({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:i}){var s,o;t&&frt(t);function a(c,u){let h;const f={...X.useContext(bW),...c,layoutId:krt(c)},{isStatic:g}=f,v=_rt(c),x=r(c,g);if(!g&&EW){Art();const b=Irt(f);h=b.MeasureLayout,v.visualElement=Ert(i,x,f,e,b.ProjectionNode)}return m.jsxs(BO.Provider,{value:v,children:[h&&v.visualElement?m.jsx(h,{visualElement:v.visualElement,...f}):null,n(i,c,wrt(x,v.visualElement,u),x,g,v.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&o!==void 0?o:""})`}`;const l=X.forwardRef(a);return l[xrt]=i,l}function krt({layoutId:t}){const e=X.useContext(xW).id;return e&&t!==void 0?e+"-"+t:t}function Art(t,e){X.useContext(O_e).strict}function Irt(t){const{drag:e,layout:n}=E2;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const Rrt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function RW(t){return typeof t!="string"||t.includes("-")?!1:!!(Rrt.indexOf(t)>-1||/[A-Z]/u.test(t))}function qre(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function PW(t,e,n,r){if(typeof e=="function"){const[i,s]=qre(r);e=e(n!==void 0?n:t.custom,i,s)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,s]=qre(r);e=e(n!==void 0?n:t.custom,i,s)}return e}const wV=t=>Array.isArray(t),Prt=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Crt=t=>wV(t)?t[t.length-1]||0:t,ca=t=>!!(t&&t.getVelocity);function WM(t){const e=ca(t)?t.get():t;return Prt(e)?e.toValue():e}function Mrt({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,i,s){const o={latestValues:Nrt(r,i,s,t),renderState:e()};return n&&(o.onMount=a=>n({props:r,current:a,...o}),o.onUpdate=a=>n(a)),o}const V_e=t=>(e,n)=>{const r=X.useContext(BO),i=X.useContext(GO),s=()=>Mrt(t,e,r,i);return n?s():wW(s)};function Nrt(t,e,n,r){const i={},s=r(t,{});for(const f in s)i[f]=WM(s[f]);let{initial:o,animate:a}=t;const l=HO(t),c=D_e(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!WO(h)){const f=Array.isArray(h)?h:[h];for(let g=0;g<f.length;g++){const v=PW(t,f[g]);if(v){const{transitionEnd:x,transition:b,...T}=v;for(const A in T){let I=T[A];if(Array.isArray(I)){const R=u?I.length-1:0;I=I[R]}I!==null&&(i[A]=I)}for(const A in x)i[A]=x[A]}}}return i}const sb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],cv=new Set(sb),z_e=t=>e=>typeof e=="string"&&e.startsWith(t),U_e=z_e("--"),Ort=z_e("var(--"),CW=t=>Ort(t)?Lrt.test(t.split("/*")[0].trim()):!1,Lrt=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,G_e=(t,e)=>e&&typeof t=="number"?e.transform(t):t,cp=(t,e,n)=>n>e?e:n<t?t:n,ob={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Yk={...ob,transform:t=>cp(0,1,t)},nC={...ob,default:1},SI=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Tm=SI("deg"),_d=SI("%"),mn=SI("px"),Drt=SI("vh"),$rt=SI("vw"),Kre={..._d,parse:t=>_d.parse(t)/100,transform:t=>_d.transform(t*100)},jrt={borderWidth:mn,borderTopWidth:mn,borderRightWidth:mn,borderBottomWidth:mn,borderLeftWidth:mn,borderRadius:mn,radius:mn,borderTopLeftRadius:mn,borderTopRightRadius:mn,borderBottomRightRadius:mn,borderBottomLeftRadius:mn,width:mn,maxWidth:mn,height:mn,maxHeight:mn,top:mn,right:mn,bottom:mn,left:mn,padding:mn,paddingTop:mn,paddingRight:mn,paddingBottom:mn,paddingLeft:mn,margin:mn,marginTop:mn,marginRight:mn,marginBottom:mn,marginLeft:mn,backgroundPositionX:mn,backgroundPositionY:mn},Frt={rotate:Tm,rotateX:Tm,rotateY:Tm,rotateZ:Tm,scale:nC,scaleX:nC,scaleY:nC,scaleZ:nC,skew:Tm,skewX:Tm,skewY:Tm,distance:mn,translateX:mn,translateY:mn,translateZ:mn,x:mn,y:mn,z:mn,perspective:mn,transformPerspective:mn,opacity:Yk,originX:Kre,originY:Kre,originZ:mn},Yre={...ob,transform:Math.round},MW={...jrt,...Frt,zIndex:Yre,size:mn,fillOpacity:Yk,strokeOpacity:Yk,numOctaves:Yre},Vrt={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zrt=sb.length;function Urt(t,e,n){let r="",i=!0;for(let s=0;s<zrt;s++){const o=sb[s],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=G_e(a,MW[o]);if(!l){i=!1;const u=Vrt[o]||o;r+=`${u}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function NW(t,e,n){const{style:r,vars:i,transformOrigin:s}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(cv.has(l)){o=!0;continue}else if(U_e(l)){i[l]=c;continue}else{const u=G_e(c,MW[l]);l.startsWith("origin")?(a=!0,s[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=Urt(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;r.transformOrigin=`${l} ${c} ${u}`}}const Grt={offset:"stroke-dashoffset",array:"stroke-dasharray"},Brt={offset:"strokeDashoffset",array:"strokeDasharray"};function Wrt(t,e,n=1,r=0,i=!0){t.pathLength=1;const s=i?Grt:Brt;t[s.offset]=mn.transform(-r);const o=mn.transform(e),a=mn.transform(n);t[s.array]=`${o} ${a}`}function Xre(t,e,n){return typeof t=="string"?t:mn.transform(e+n*t)}function Hrt(t,e,n){const r=Xre(e,t.x,t.width),i=Xre(n,t.y,t.height);return`${r} ${i}`}function OW(t,{attrX:e,attrY:n,attrScale:r,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(NW(t,c,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:g,dimensions:v}=t;f.transform&&(v&&(g.transform=f.transform),delete f.transform),v&&(i!==void 0||s!==void 0||g.transform)&&(g.transformOrigin=Hrt(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),r!==void 0&&(f.scale=r),o!==void 0&&Wrt(f,o,a,l,!1)}const LW=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),B_e=()=>({...LW(),attrs:{}}),DW=t=>typeof t=="string"&&t.toLowerCase()==="svg";function W_e(t,{style:e,vars:n},r,i){Object.assign(t.style,e,i&&i.getProjectionStyles(r));for(const s in n)t.style.setProperty(s,n[s])}const H_e=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function q_e(t,e,n,r){W_e(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(H_e.has(i)?i:AW(i),e.attrs[i])}const nN={};function qrt(t){Object.assign(nN,t)}function K_e(t,{layout:e,layoutId:n}){return cv.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!nN[t]||t==="opacity")}function $W(t,e,n){var r;const{style:i}=t,s={};for(const o in i)(ca(i[o])||e.style&&ca(e.style[o])||K_e(o,t)||((r=n?.getValue(o))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[o]=i[o]);return s}function Y_e(t,e,n){const r=$W(t,e,n);for(const i in t)if(ca(t[i])||ca(e[i])){const s=sb.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=t[i]}return r}function Krt(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Zre=["x","y","width","height","cx","cy","r"],Yrt={useVisualState:V_e({scrapeMotionValuesFromProps:Y_e,createRenderState:B_e,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:i})=>{if(!n)return;let s=!!t.drag;if(!s){for(const a in i)if(cv.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<Zre.length;a++){const l=Zre[a];t[l]!==e[l]&&(o=!0)}o&&di.read(()=>{Krt(n,r),di.render(()=>{OW(r,i,DW(n.tagName),t.transformTemplate),q_e(n,r)})})}})},Xrt={useVisualState:V_e({scrapeMotionValuesFromProps:$W,createRenderState:LW})};function X_e(t,e,n){for(const r in e)!ca(e[r])&&!K_e(r,n)&&(t[r]=e[r])}function Zrt({transformTemplate:t},e){return X.useMemo(()=>{const n=LW();return NW(n,e,t),Object.assign({},n.vars,n.style)},[e])}function Jrt(t,e){const n=t.style||{},r={};return X_e(r,n,t),Object.assign(r,Zrt(t,e)),r}function Qrt(t,e){const n={},r=Jrt(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function eit(t,e,n,r){const i=X.useMemo(()=>{const s=B_e();return OW(s,e,DW(r),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};X_e(s,t.style,t),i.style={...s,...i.style}}return i}function tit(t=!1){return(n,r,i,{latestValues:s},o)=>{const l=(RW(n)?eit:Qrt)(r,s,o,n),c=grt(r,typeof n=="string",t),u=n!==X.Fragment?{...c,...l,ref:i}:{},{children:h}=r,f=X.useMemo(()=>ca(h)?h.get():h,[h]);return X.createElement(n,{...u,children:f})}}function nit(t,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...RW(r)?Yrt:Xrt,preloadedFeatures:t,useRender:tit(i),createVisualElement:e,Component:r};return Trt(o)}}function Z_e(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function qO(t,e,n){const r=t.getProps();return PW(r,e,n!==void 0?n:r.custom,t)}const rit=SW(()=>window.ScrollTimeline!==void 0);class iit{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(i=>{if(rit()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class sit extends iit{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function jW(t,e){return t?t[e]||t.default||t:void 0}const bV=2e4;function J_e(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<bV;)e+=n,r=t.next(e);return e>=bV?1/0:e}function FW(t){return typeof t=="function"}function Jre(t,e){t.timeline=e,t.onfinish=null}const VW=t=>Array.isArray(t)&&typeof t[0]=="number",oit={linearEasing:void 0};function ait(t,e){const n=SW(t);return()=>{var r;return(r=oit[e])!==null&&r!==void 0?r:n()}}const rN=ait(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Q_e=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let s=0;s<i;s++)r+=t(b2(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function exe(t){return!!(typeof t=="function"&&rN()||!t||typeof t=="string"&&(t in EV||rN())||VW(t)||Array.isArray(t)&&t.every(exe))}const IS=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,EV={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:IS([0,.65,.55,1]),circOut:IS([.55,0,1,.45]),backIn:IS([.31,.01,.66,-.59]),backOut:IS([.33,1.53,.69,.99])};function txe(t,e){if(t)return typeof t=="function"&&rN()?Q_e(t,e):VW(t)?IS(t):Array.isArray(t)?t.map(n=>txe(n,e)||EV.easeOut):EV[t]}const Fu={x:!1,y:!1};function nxe(){return Fu.x||Fu.y}function lit(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}function rxe(t,e){const n=lit(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function Qre(t){return e=>{e.pointerType==="touch"||nxe()||t(e)}}function cit(t,e,n={}){const[r,i,s]=rxe(t,n),o=Qre(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=Qre(h=>{c(h),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,i)});return r.forEach(a=>{a.addEventListener("pointerenter",o,i)}),s}const ixe=(t,e)=>e?t===e?!0:ixe(t,e.parentElement):!1,zW=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,uit=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function hit(t){return uit.has(t.tagName)||t.tabIndex!==-1}const RS=new WeakSet;function eie(t){return e=>{e.key==="Enter"&&t(e)}}function l8(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const dit=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=eie(()=>{if(RS.has(n))return;l8(n,"down");const i=eie(()=>{l8(n,"up")}),s=()=>l8(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",s,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function tie(t){return zW(t)&&!nxe()}function fit(t,e,n={}){const[r,i,s]=rxe(t,n),o=a=>{const l=a.currentTarget;if(!tie(a)||RS.has(l))return;RS.add(l);const c=e(a),u=(g,v)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),!(!tie(g)||!RS.has(l))&&(RS.delete(l),typeof c=="function"&&c(g,{success:v}))},h=g=>{u(g,n.useGlobalTarget||ixe(l,g.target))},f=g=>{u(g,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",f,i)};return r.forEach(a=>{!hit(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),a.addEventListener("focus",c=>dit(c,i),i)}),s}function pit(t){return t==="x"||t==="y"?Fu[t]?null:(Fu[t]=!0,()=>{Fu[t]=!1}):Fu.x||Fu.y?null:(Fu.x=Fu.y=!0,()=>{Fu.x=Fu.y=!1})}const sxe=new Set(["width","height","top","left","right","bottom",...sb]);let HM;function mit(){HM=void 0}const xd={now:()=>(HM===void 0&&xd.set(So.isProcessing||urt.useManualTiming?So.timestamp:performance.now()),HM),set:t=>{HM=t,queueMicrotask(mit)}};function UW(t,e){t.indexOf(e)===-1&&t.push(e)}function GW(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class BW{constructor(){this.subscriptions=[]}add(e){return UW(this.subscriptions,e),()=>GW(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function oxe(t,e){return e?t*(1e3/e):0}const nie=30,git=t=>!isNaN(parseFloat(t));class yit{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=xd.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=xd.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=git(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new BW);const r=this.events[e].add(n);return e==="change"?()=>{r(),di.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=xd.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>nie)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,nie);return oxe(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Xk(t,e){return new yit(t,e)}function vit(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Xk(n))}function _it(t,e){const n=qO(t,e);let{transitionEnd:r={},transition:i={},...s}=n||{};s={...s,...r};for(const o in s){const a=Crt(s[o]);vit(t,o,a)}}function xit(t){return!!(ca(t)&&t.add)}function SV(t,e){const n=t.getValue("willChange");if(xit(n))return n.add(e)}function axe(t){return t.props[$_e]}const lxe=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,wit=1e-7,bit=12;function Eit(t,e,n,r,i){let s,o,a=0;do o=e+(n-e)/2,s=lxe(o,r,i)-t,s>0?n=o:e=o;while(Math.abs(s)>wit&&++a<bit);return o}function TI(t,e,n,r){if(t===e&&n===r)return ac;const i=s=>Eit(s,0,1,t,n);return s=>s===0||s===1?s:lxe(i(s),e,r)}const cxe=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,uxe=t=>e=>1-t(1-e),hxe=TI(.33,1.53,.69,.99),WW=uxe(hxe),dxe=cxe(WW),fxe=t=>(t*=2)<1?.5*WW(t):.5*(2-Math.pow(2,-10*(t-1))),HW=t=>1-Math.sin(Math.acos(t)),pxe=uxe(HW),mxe=cxe(HW),gxe=t=>/^0[^.\s]+$/u.test(t);function Sit(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||gxe(t):!0}const bT=t=>Math.round(t*1e5)/1e5,qW=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Tit(t){return t==null}const kit=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,KW=(t,e)=>n=>!!(typeof n=="string"&&kit.test(n)&&n.startsWith(t)||e&&!Tit(n)&&Object.prototype.hasOwnProperty.call(n,e)),yxe=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,s,o,a]=r.match(qW);return{[t]:parseFloat(i),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Ait=t=>cp(0,255,t),c8={...ob,transform:t=>Math.round(Ait(t))},Dy={test:KW("rgb","red"),parse:yxe("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+c8.transform(t)+", "+c8.transform(e)+", "+c8.transform(n)+", "+bT(Yk.transform(r))+")"};function Iit(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const TV={test:KW("#"),parse:Iit,transform:Dy.transform},Tx={test:KW("hsl","hue"),parse:yxe("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+_d.transform(bT(e))+", "+_d.transform(bT(n))+", "+bT(Yk.transform(r))+")"},Zo={test:t=>Dy.test(t)||TV.test(t)||Tx.test(t),parse:t=>Dy.test(t)?Dy.parse(t):Tx.test(t)?Tx.parse(t):TV.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Dy.transform(t):Tx.transform(t)},Rit=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Pit(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(qW))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Rit))===null||n===void 0?void 0:n.length)||0)>0}const vxe="number",_xe="color",Cit="var",Mit="var(",rie="${}",Nit=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zk(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let s=0;const a=e.replace(Nit,l=>(Zo.test(l)?(r.color.push(s),i.push(_xe),n.push(Zo.parse(l))):l.startsWith(Mit)?(r.var.push(s),i.push(Cit),n.push(l)):(r.number.push(s),i.push(vxe),n.push(parseFloat(l))),++s,rie)).split(rie);return{values:n,split:a,indexes:r,types:i}}function xxe(t){return Zk(t).values}function wxe(t){const{split:e,types:n}=Zk(t),r=e.length;return i=>{let s="";for(let o=0;o<r;o++)if(s+=e[o],i[o]!==void 0){const a=n[o];a===vxe?s+=bT(i[o]):a===_xe?s+=Zo.transform(i[o]):s+=i[o]}return s}}const Oit=t=>typeof t=="number"?0:t;function Lit(t){const e=xxe(t);return wxe(t)(e.map(Oit))}const Vg={test:Pit,parse:xxe,createTransformer:wxe,getAnimatableNone:Lit},Dit=new Set(["brightness","contrast","saturate","opacity"]);function $it(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(qW)||[];if(!r)return t;const i=n.replace(r,"");let s=Dit.has(e)?1:0;return r!==n&&(s*=100),e+"("+s+i+")"}const jit=/\b([a-z-]*)\(.*?\)/gu,kV={...Vg,getAnimatableNone:t=>{const e=t.match(jit);return e?e.map($it).join(" "):t}},Fit={...MW,color:Zo,backgroundColor:Zo,outlineColor:Zo,fill:Zo,stroke:Zo,borderColor:Zo,borderTopColor:Zo,borderRightColor:Zo,borderBottomColor:Zo,borderLeftColor:Zo,filter:kV,WebkitFilter:kV},YW=t=>Fit[t];function bxe(t,e){let n=YW(t);return n!==kV&&(n=Vg),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Vit=new Set(["auto","none","0"]);function zit(t,e,n){let r=0,i;for(;r<t.length&&!i;){const s=t[r];typeof s=="string"&&!Vit.has(s)&&Zk(s).values.length&&(i=t[r]),r++}if(i&&n)for(const s of e)t[s]=bxe(n,i)}const iie=t=>t===ob||t===mn,sie=(t,e)=>parseFloat(t.split(", ")[e]),oie=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return sie(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?sie(s[1],t):0}},Uit=new Set(["x","y","z"]),Git=sb.filter(t=>!Uit.has(t));function Bit(t){const e=[];return Git.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const S2={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:oie(4,13),y:oie(5,14)};S2.translateX=S2.x;S2.translateY=S2.y;const t1=new Set;let AV=!1,IV=!1;function Exe(){if(IV){const t=Array.from(t1).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=Bit(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([s,o])=>{var a;(a=r.getValue(s))===null||a===void 0||a.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}IV=!1,AV=!1,t1.forEach(t=>t.complete()),t1.clear()}function Sxe(){t1.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(IV=!0)})}function Wit(){Sxe(),Exe()}class XW{constructor(e,n,r,i,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(t1.add(this),AV||(AV=!0,di.read(Sxe),di.resolveKeyframes(Exe))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=i?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(r&&n){const l=r.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),t1.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,t1.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Txe=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Hit=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qit(t){const e=Hit.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function kxe(t,e,n=1){const[r,i]=qit(t);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const o=s.trim();return Txe(o)?parseFloat(o):o}return CW(i)?kxe(i,e,n+1):i}const Axe=t=>e=>e.test(t),Kit={test:t=>t==="auto",parse:t=>t},Ixe=[ob,mn,_d,Tm,$rt,Drt,Kit],aie=t=>Ixe.find(Axe(t));class Rxe extends XW{constructor(e,n,r,i,s){super(e,n,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),CW(c))){const u=kxe(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!sxe.has(r)||e.length!==2)return;const[i,s]=e,o=aie(i),a=aie(s);if(o!==a)if(iie(o)&&iie(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)Sit(e[i])&&r.push(i);r.length&&zit(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=S2[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const s=n.getValue(r);s&&s.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=S2[r](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const lie=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Vg.test(t)||t==="0")&&!t.startsWith("url("));function Yit(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Xit(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=t[t.length-1],o=lie(i,e),a=lie(s,e);return!o||!a?!1:Yit(t)||(n==="spring"||FW(n))&&r}const Zit=t=>t!==null;function KO(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(Zit),s=e&&n!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const Jit=40;class Pxe{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=xd.now(),this.options={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Jit?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Wit(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=xd.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Xit(e,r,i,s))if(o)this.options.duration=0;else{l&&l(KO(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Li=(t,e,n)=>t+(e-t)*n;function u8(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Qit({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,s=0,o=0;if(!e)i=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=u8(l,a,t+1/3),s=u8(l,a,t),o=u8(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}function iN(t,e){return n=>n>0?e:t}const h8=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},est=[TV,Dy,Tx],tst=t=>est.find(e=>e.test(t));function cie(t){const e=tst(t);if(!e)return!1;let n=e.parse(t);return e===Tx&&(n=Qit(n)),n}const uie=(t,e)=>{const n=cie(t),r=cie(e);if(!n||!r)return iN(t,e);const i={...n};return s=>(i.red=h8(n.red,r.red,s),i.green=h8(n.green,r.green,s),i.blue=h8(n.blue,r.blue,s),i.alpha=Li(n.alpha,r.alpha,s),Dy.transform(i))},nst=(t,e)=>n=>e(t(n)),kI=(...t)=>t.reduce(nst),RV=new Set(["none","hidden"]);function rst(t,e){return RV.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function ist(t,e){return n=>Li(t,e,n)}function ZW(t){return typeof t=="number"?ist:typeof t=="string"?CW(t)?iN:Zo.test(t)?uie:ast:Array.isArray(t)?Cxe:typeof t=="object"?Zo.test(t)?uie:sst:iN}function Cxe(t,e){const n=[...t],r=n.length,i=t.map((s,o)=>ZW(s)(s,e[o]));return s=>{for(let o=0;o<r;o++)n[o]=i[o](s);return n}}function sst(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=ZW(t[i])(t[i],e[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}}function ost(t,e){var n;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=t.indexes[o][i[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;r[s]=l,i[o]++}return r}const ast=(t,e)=>{const n=Vg.createTransformer(e),r=Zk(t),i=Zk(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?RV.has(t)&&!i.values.length||RV.has(e)&&!r.values.length?rst(t,e):kI(Cxe(ost(r,i),i.values),n):iN(t,e)};function Mxe(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Li(t,e,n):ZW(t)(t,e)}const lst=5;function Nxe(t,e,n){const r=Math.max(e-lst,0);return oxe(n-t(r),e-r)}const Ki={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},d8=.001;function cst({duration:t=Ki.duration,bounce:e=Ki.bounce,velocity:n=Ki.velocity,mass:r=Ki.mass}){let i,s,o=1-e;o=cp(Ki.minDamping,Ki.maxDamping,o),t=cp(Ki.minDuration,Ki.maxDuration,Jf(t)),o<1?(i=c=>{const u=c*o,h=u*t,f=u-n,g=PV(c,o),v=Math.exp(-h);return d8-f/g*v},s=c=>{const h=c*o*t,f=h*n+n,g=Math.pow(o,2)*Math.pow(c,2)*t,v=Math.exp(-h),x=PV(Math.pow(c,2),o);return(-i(c)+d8>0?-1:1)*((f-g)*v)/x}):(i=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-d8+u*h},s=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=hst(i,s,a);if(t=Zf(t),isNaN(l))return{stiffness:Ki.stiffness,damping:Ki.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const ust=12;function hst(t,e,n){let r=n;for(let i=1;i<ust;i++)r=r-t(r)/e(r);return r}function PV(t,e){return t*Math.sqrt(1-e*e)}const dst=["duration","bounce"],fst=["stiffness","damping","mass"];function hie(t,e){return e.some(n=>t[n]!==void 0)}function pst(t){let e={velocity:Ki.velocity,stiffness:Ki.stiffness,damping:Ki.damping,mass:Ki.mass,isResolvedFromDuration:!1,...t};if(!hie(t,fst)&&hie(t,dst))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,s=2*cp(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:Ki.mass,stiffness:i,damping:s}}else{const n=cst(t);e={...e,...n,mass:Ki.mass},e.isResolvedFromDuration=!0}return e}function Oxe(t=Ki.visualDuration,e=Ki.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:h,velocity:f,isResolvedFromDuration:g}=pst({...n,velocity:-Jf(n.velocity||0)}),v=f||0,x=c/(2*Math.sqrt(l*u)),b=o-s,T=Jf(Math.sqrt(l/u)),A=Math.abs(b)<5;r||(r=A?Ki.restSpeed.granular:Ki.restSpeed.default),i||(i=A?Ki.restDelta.granular:Ki.restDelta.default);let I;if(x<1){const M=PV(T,x);I=F=>{const C=Math.exp(-x*T*F);return o-C*((v+x*T*b)/M*Math.sin(M*F)+b*Math.cos(M*F))}}else if(x===1)I=M=>o-Math.exp(-T*M)*(b+(v+T*b)*M);else{const M=T*Math.sqrt(x*x-1);I=F=>{const C=Math.exp(-x*T*F),N=Math.min(M*F,300);return o-C*((v+x*T*b)*Math.sinh(N)+M*b*Math.cosh(N))/M}}const R={calculatedDuration:g&&h||null,next:M=>{const F=I(M);if(g)a.done=M>=h;else{let C=0;x<1&&(C=M===0?Zf(v):Nxe(I,M,F));const N=Math.abs(C)<=r,O=Math.abs(o-F)<=i;a.done=N&&O}return a.value=a.done?o:F,a},toString:()=>{const M=Math.min(J_e(R),bV),F=Q_e(C=>R.next(M*C).value,M,30);return M+"ms "+F}};return R}function die({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},g=N=>a!==void 0&&N<a||l!==void 0&&N>l,v=N=>a===void 0?l:l===void 0||Math.abs(a-N)<Math.abs(l-N)?a:l;let x=n*e;const b=h+x,T=o===void 0?b:o(b);T!==b&&(x=T-h);const A=N=>-x*Math.exp(-N/r),I=N=>T+A(N),R=N=>{const O=A(N),j=I(N);f.done=Math.abs(O)<=c,f.value=f.done?T:j};let M,F;const C=N=>{g(f.value)&&(M=N,F=Oxe({keyframes:[f.value,v(f.value)],velocity:Nxe(I,N,f.value),damping:i,stiffness:s,restDelta:c,restSpeed:u}))};return C(0),{calculatedDuration:null,next:N=>{let O=!1;return!F&&M===void 0&&(O=!0,R(N),C(N)),M!==void 0&&N>=M?F.next(N-M):(!O&&R(N),f)}}}const mst=TI(.42,0,1,1),gst=TI(0,0,.58,1),Lxe=TI(.42,0,.58,1),yst=t=>Array.isArray(t)&&typeof t[0]!="number",vst={linear:ac,easeIn:mst,easeInOut:Lxe,easeOut:gst,circIn:HW,circInOut:mxe,circOut:pxe,backIn:WW,backInOut:dxe,backOut:hxe,anticipate:fxe},fie=t=>{if(VW(t)){M_e(t.length===4);const[e,n,r,i]=t;return TI(e,n,r,i)}else if(typeof t=="string")return vst[t];return t};function _st(t,e,n){const r=[],i=n||Mxe,s=t.length-1;for(let o=0;o<s;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ac:e;a=kI(l,a)}r.push(a)}return r}function xst(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const s=t.length;if(M_e(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=_st(e,r,i),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=b2(t[h],t[h+1],u);return a[h](f)};return n?u=>c(cp(t[0],t[s-1],u)):c}function wst(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=b2(0,e,r);t.push(Li(n,1,i))}}function bst(t){const e=[0];return wst(e,t.length-1),e}function Est(t,e){return t.map(n=>n*e)}function Sst(t,e){return t.map(()=>e||Lxe).splice(0,t.length-1)}function sN({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=yst(r)?r.map(fie):fie(r),s={done:!1,value:e[0]},o=Est(n&&n.length===e.length?n:bst(e),t),a=xst(o,e,{ease:Array.isArray(i)?i:Sst(e,i)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}const Tst=t=>{const e=({timestamp:n})=>t(n);return{start:()=>di.update(e,!0),stop:()=>Fg(e),now:()=>So.isProcessing?So.timestamp:xd.now()}},kst={decay:die,inertia:die,tween:sN,keyframes:sN,spring:Oxe},Ast=t=>t/100;class JW extends Pxe{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:i,keyframes:s}=this.options,o=i?.KeyframeResolver||XW,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(s,a,n,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=this.options,a=FW(n)?n:kst[n]||sN;let l,c;a!==sN&&typeof e[0]!="number"&&(l=kI(Ast,Mxe(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});s==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=J_e(u));const{calculatedDuration:h}=u,f=h+i,g=f*(r+1)-i;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:f,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:N}=this.options;return{done:!0,value:N[N.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=r;if(this.startTime===null)return s.next(0);const{delay:f,repeat:g,repeatType:v,repeatDelay:x,onUpdate:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-f*(this.speed>=0?1:-1),A=this.speed>=0?T<0:T>u;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let I=this.currentTime,R=s;if(g){const N=Math.min(this.currentTime,u)/h;let O=Math.floor(N),j=N%1;!j&&N>=1&&(j=1),j===1&&O--,O=Math.min(O,g+1),O%2&&(v==="reverse"?(j=1-j,x&&(j-=x/h)):v==="mirror"&&(R=o)),I=cp(0,1,j)*h}const M=A?{done:!1,value:l[0]}:R.next(I);a&&(M.value=a(M.value));let{done:F}=M;!A&&c!==null&&(F=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&F);return C&&i!==void 0&&(M.value=KO(l,this.options,i)),b&&b(M.value),C&&this.finish(),M}get duration(){const{resolved:e}=this;return e?Jf(e.calculatedDuration):0}get time(){return Jf(this.currentTime)}set time(e){e=Zf(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Jf(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Tst,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Ist=new Set(["opacity","clipPath","filter","transform"]);function Rst(t,e,n,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=txe(a,i);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Pst=SW(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),oN=10,Cst=2e4;function Mst(t){return FW(t.type)||t.type==="spring"||!exe(t.ease)}function Nst(t,e){const n=new JW({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const i=[];let s=0;for(;!r.done&&s<Cst;)r=n.sample(s),i.push(r.value),s+=oN;return{times:void 0,keyframes:i,duration:s-oN,ease:"linear"}}const Dxe={anticipate:fxe,backInOut:dxe,circInOut:mxe};function Ost(t){return t in Dxe}class pie extends Pxe{constructor(e){super(e);const{name:n,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new Rxe(s,(o,a)=>this.onKeyframesResolved(o,a),n,r,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:i,ease:s,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&rN()&&Ost(s)&&(s=Dxe[s]),Mst(this.options)){const{onComplete:h,onUpdate:f,motionValue:g,element:v,...x}=this.options,b=Nst(e,x);e=b.keyframes,e.length===1&&(e[1]=e[0]),r=b.duration,i=b.times,s=b.ease,o="keyframes"}const u=Rst(a.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(Jre(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;a.set(KO(e,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Jf(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Jf(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=Zf(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return ac;const{animation:r}=n;Jre(r,e)}return ac}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:i,type:s,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:f,...g}=this.options,v=new JW({...g,keyframes:r,duration:i,type:s,ease:o,times:a,isGenerator:!0}),x=Zf(this.time);c.setWithVelocity(v.sample(x-oN).value,v.sample(x).value,oN)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:i,repeatType:s,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return Pst()&&r&&Ist.has(r)&&!l&&!c&&!i&&s!=="mirror"&&o!==0&&a!=="inertia"}}const Lst={type:"spring",stiffness:500,damping:25,restSpeed:10},Dst=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),$st={type:"keyframes",duration:.8},jst={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Fst=(t,{keyframes:e})=>e.length>2?$st:cv.has(t)?t.startsWith("scale")?Dst(e[1]):Lst:jst;function Vst({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const QW=(t,e,n,r={},i,s)=>o=>{const a=jW(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Zf(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:s?void 0:i};Vst(a)||(u={...u,...Fst(t,u)}),u.duration&&(u.duration=Zf(u.duration)),u.repeatDelay&&(u.repeatDelay=Zf(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!s&&e.get()!==void 0){const f=KO(u.keyframes,a);if(f!==void 0)return di.update(()=>{u.onUpdate(f),u.onComplete()}),new sit([])}return!s&&pie.supports(u)?new pie(u):new JW(u)};function zst({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function $xe(t,e,{delay:n=0,transitionOverride:r,type:i}={}){var s;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;r&&(o=r);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in l){const f=t.getValue(h,(s=t.latestValues[h])!==null&&s!==void 0?s:null),g=l[h];if(g===void 0||u&&zst(u,h))continue;const v={delay:n,...jW(o||{},h)};let x=!1;if(window.MotionHandoffAnimation){const T=axe(t);if(T){const A=window.MotionHandoffAnimation(T,h,di);A!==null&&(v.startTime=A,x=!0)}}SV(t,h),f.start(QW(h,f,g,t.shouldReduceMotion&&sxe.has(h)?{type:!1}:v,t,x));const b=f.animation;b&&c.push(b)}return a&&Promise.all(c).then(()=>{di.update(()=>{a&&_it(t,a)})}),c}function CV(t,e,n={}){var r;const i=qO(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(s=n.transitionOverride);const o=i?()=>Promise.all($xe(t,i,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return Ust(t,e,u+c,h,f,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function Ust(t,e,n=0,r=0,i=1,s){const o=[],a=(t.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>a-c*r;return Array.from(t.variantChildren).sort(Gst).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(CV(c,e,{...s,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Gst(t,e){return t.sortNodePosition(e)}function Bst(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>CV(t,s,n));r=Promise.all(i)}else if(typeof e=="string")r=CV(t,e,n);else{const i=typeof e=="function"?qO(t,e,n.custom):e;r=Promise.all($xe(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const Wst=kW.length;function jxe(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?jxe(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Wst;n++){const r=kW[n],i=t.props[r];(Kk(i)||i===!1)&&(e[r]=i)}return e}const Hst=[...TW].reverse(),qst=TW.length;function Kst(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Bst(t,n,r)))}function Yst(t){let e=Kst(t),n=mie(),r=!0;const i=l=>(c,u)=>{var h;const f=qO(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(f){const{transition:g,transitionEnd:v,...x}=f;c={...c,...x,...v}}return c};function s(l){e=l(t)}function o(l){const{props:c}=t,u=jxe(t.parent)||{},h=[],f=new Set;let g={},v=1/0;for(let b=0;b<qst;b++){const T=Hst[b],A=n[T],I=c[T]!==void 0?c[T]:u[T],R=Kk(I),M=T===l?A.isActive:null;M===!1&&(v=b);let F=I===u[T]&&I!==c[T]&&R;if(F&&r&&t.manuallyAnimateOnMount&&(F=!1),A.protectedKeys={...g},!A.isActive&&M===null||!I&&!A.prevProp||WO(I)||typeof I=="boolean")continue;const C=Xst(A.prevProp,I);let N=C||T===l&&A.isActive&&!F&&R||b>v&&R,O=!1;const j=Array.isArray(I)?I:[I];let V=j.reduce(i(T),{});M===!1&&(V={});const{prevResolvedValues:W={}}=A,U={...W,...V},pe=je=>{N=!0,f.has(je)&&(O=!0,f.delete(je)),A.needsAnimating[je]=!0;const de=t.getValue(je);de&&(de.liveStyle=!1)};for(const je in U){const de=V[je],Oe=W[je];if(g.hasOwnProperty(je))continue;let Ae=!1;wV(de)&&wV(Oe)?Ae=!Z_e(de,Oe):Ae=de!==Oe,Ae?de!=null?pe(je):f.add(je):de!==void 0&&f.has(je)?pe(je):A.protectedKeys[je]=!0}A.prevProp=I,A.prevResolvedValues=V,A.isActive&&(g={...g,...V}),r&&t.blockInitialAnimation&&(N=!1),N&&(!(F&&C)||O)&&h.push(...j.map(je=>({animation:je,options:{type:T}})))}if(f.size){const b={};f.forEach(T=>{const A=t.getBaseTarget(T),I=t.getValue(T);I&&(I.liveStyle=!0),b[T]=A??null}),h.push({animation:b})}let x=!!h.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var g;return(g=f.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const f in n)n[f].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n,reset:()=>{n=mie(),r=!0}}}function Xst(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Z_e(e,t):!1}function L0(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function mie(){return{animate:L0(!0),whileInView:L0(),whileHover:L0(),whileTap:L0(),whileDrag:L0(),whileFocus:L0(),exit:L0()}}class Qg{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Zst extends Qg{constructor(e){super(e),e.animationState||(e.animationState=Yst(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();WO(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Jst=0;class Qst extends Qg{constructor(){super(...arguments),this.id=Jst++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const eot={animation:{Feature:Zst},exit:{Feature:Qst}};function Jk(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function AI(t){return{point:{x:t.pageX,y:t.pageY}}}const tot=t=>e=>zW(e)&&t(e,AI(e));function ET(t,e,n,r){return Jk(t,e,tot(n),r)}const gie=(t,e)=>Math.abs(t-e);function not(t,e){const n=gie(t.x,e.x),r=gie(t.y,e.y);return Math.sqrt(n**2+r**2)}class Fxe{constructor(e,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=p8(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,g=not(h.offset,{x:0,y:0})>=3;if(!f&&!g)return;const{point:v}=h,{timestamp:x}=So;this.history.push({...v,timestamp:x});const{onStart:b,onMove:T}=this.handlers;f||(b&&b(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=f8(f,this.transformPagePoint),di.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:g,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=p8(h.type==="pointercancel"?this.lastMoveEventInfo:f8(f,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,b),v&&v(h,b)},!zW(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const o=AI(e),a=f8(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=So;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,p8(a,this.history)),this.removeListeners=kI(ET(this.contextWindow,"pointermove",this.handlePointerMove),ET(this.contextWindow,"pointerup",this.handlePointerUp),ET(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Fg(this.updatePoint)}}function f8(t,e){return e?{point:e(t.point)}:t}function yie(t,e){return{x:t.x-e.x,y:t.y-e.y}}function p8({point:t},e){return{point:t,delta:yie(t,Vxe(e)),offset:yie(t,rot(e)),velocity:iot(e,.1)}}function rot(t){return t[0]}function Vxe(t){return t[t.length-1]}function iot(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=Vxe(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>Zf(e)));)n--;if(!r)return{x:0,y:0};const s=Jf(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const zxe=1e-4,sot=1-zxe,oot=1+zxe,Uxe=.01,aot=0-Uxe,lot=0+Uxe;function dc(t){return t.max-t.min}function cot(t,e,n){return Math.abs(t-e)<=n}function vie(t,e,n,r=.5){t.origin=r,t.originPoint=Li(e.min,e.max,t.origin),t.scale=dc(n)/dc(e),t.translate=Li(n.min,n.max,t.origin)-t.originPoint,(t.scale>=sot&&t.scale<=oot||isNaN(t.scale))&&(t.scale=1),(t.translate>=aot&&t.translate<=lot||isNaN(t.translate))&&(t.translate=0)}function ST(t,e,n,r){vie(t.x,e.x,n.x,r?r.originX:void 0),vie(t.y,e.y,n.y,r?r.originY:void 0)}function _ie(t,e,n){t.min=n.min+e.min,t.max=t.min+dc(e)}function uot(t,e,n){_ie(t.x,e.x,n.x),_ie(t.y,e.y,n.y)}function xie(t,e,n){t.min=e.min-n.min,t.max=t.min+dc(e)}function TT(t,e,n){xie(t.x,e.x,n.x),xie(t.y,e.y,n.y)}function hot(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Li(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Li(n,t,r.max):Math.min(t,n)),t}function wie(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function dot(t,{top:e,left:n,bottom:r,right:i}){return{x:wie(t.x,n,i),y:wie(t.y,e,r)}}function bie(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function fot(t,e){return{x:bie(t.x,e.x),y:bie(t.y,e.y)}}function pot(t,e){let n=.5;const r=dc(t),i=dc(e);return i>r?n=b2(e.min,e.max-r,t.min):r>i&&(n=b2(t.min,t.max-i,e.min)),cp(0,1,n)}function mot(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const MV=.35;function got(t=MV){return t===!1?t=0:t===!0&&(t=MV),{x:Eie(t,"left","right"),y:Eie(t,"top","bottom")}}function Eie(t,e,n){return{min:Sie(t,e),max:Sie(t,n)}}function Sie(t,e){return typeof t=="number"?t:t[e]||0}const Tie=()=>({translate:0,scale:1,origin:0,originPoint:0}),kx=()=>({x:Tie(),y:Tie()}),kie=()=>({min:0,max:0}),ss=()=>({x:kie(),y:kie()});function Oc(t){return[t("x"),t("y")]}function Gxe({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function yot({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function vot(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function m8(t){return t===void 0||t===1}function NV({scale:t,scaleX:e,scaleY:n}){return!m8(t)||!m8(e)||!m8(n)}function ay(t){return NV(t)||Bxe(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Bxe(t){return Aie(t.x)||Aie(t.y)}function Aie(t){return t&&t!=="0%"}function aN(t,e,n){const r=t-n,i=e*r;return n+i}function Iie(t,e,n,r,i){return i!==void 0&&(t=aN(t,i,r)),aN(t,n,r)+e}function OV(t,e=0,n=1,r,i){t.min=Iie(t.min,e,n,r,i),t.max=Iie(t.max,e,n,r,i)}function Wxe(t,{x:e,y:n}){OV(t.x,e.translate,e.scale,e.originPoint),OV(t.y,n.translate,n.scale,n.originPoint)}const Rie=.999999999999,Pie=1.0000000000001;function _ot(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=n[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Ix(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Wxe(t,o)),r&&ay(s.latestValues)&&Ix(t,s.latestValues))}e.x<Pie&&e.x>Rie&&(e.x=1),e.y<Pie&&e.y>Rie&&(e.y=1)}function Ax(t,e){t.min=t.min+e,t.max=t.max+e}function Cie(t,e,n,r,i=.5){const s=Li(t.min,t.max,i);OV(t,e,n,s,r)}function Ix(t,e){Cie(t.x,e.x,e.scaleX,e.scale,e.originX),Cie(t.y,e.y,e.scaleY,e.scale,e.originY)}function Hxe(t,e){return Gxe(vot(t.getBoundingClientRect(),e))}function xot(t,e,n){const r=Hxe(t,n),{scroll:i}=e;return i&&(Ax(r.x,i.offset.x),Ax(r.y,i.offset.y)),r}const qxe=({current:t})=>t?t.ownerDocument.defaultView:null,wot=new WeakMap;class bot{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ss(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(AI(u).point)},s=(u,h)=>{const{drag:f,dragPropagation:g,onDragStart:v}=this.getProps();if(f&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=pit(f),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Oc(b=>{let T=this.getAxisMotionValue(b).get()||0;if(_d.test(T)){const{projection:A}=this.visualElement;if(A&&A.layout){const I=A.layout.layoutBox[b];I&&(T=dc(I)*(parseFloat(T)/100))}}this.originPoint[b]=T}),v&&di.postRender(()=>v(u,h)),SV(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:f,dragDirectionLock:g,onDirectionLock:v,onDrag:x}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:b}=h;if(g&&this.currentDirection===null){this.currentDirection=Eot(b),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",h.point,b),this.updateAxis("y",h.point,b),this.visualElement.render(),x&&x(u,h)},a=(u,h)=>this.stop(u,h),l=()=>Oc(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Fxe(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:qxe(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&di.postRender(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!rC(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=hot(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;n&&Sx(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=dot(i.layoutBox,n):this.constraints=!1,this.elastic=got(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Oc(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=mot(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Sx(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=xot(r,i.root,this.visualElement.getTransformPagePoint());let o=fot(i.layout.layoutBox,s);if(n){const a=n(yot(o));this.hasMutatedConstraints=!!a,a&&(o=Gxe(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Oc(u=>{if(!rC(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const f=i?200:1e6,g=i?40:1e7,v={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(u,v)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return SV(this.visualElement,e),r.start(QW(e,r,0,n,this.visualElement,!1))}stopAnimation(){Oc(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Oc(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Oc(n=>{const{drag:r}=this.getProps();if(!rC(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];s.set(e[n]-Li(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Sx(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Oc(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=pot({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Oc(o=>{if(!rC(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Li(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;wot.set(this.visualElement,this);const e=this.visualElement.current,n=ET(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Sx(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),di.read(r);const o=Jk(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Oc(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())}));return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=MV,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function rC(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Eot(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Sot extends Qg{constructor(e){super(e),this.removeGroupControls=ac,this.removeListeners=ac,this.controls=new bot(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ac}unmount(){this.removeGroupControls(),this.removeListeners()}}const Mie=t=>(e,n)=>{t&&di.postRender(()=>t(e,n))};class Tot extends Qg{constructor(){super(...arguments),this.removePointerDownListener=ac}onPointerDown(e){this.session=new Fxe(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:qxe(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Mie(e),onStart:Mie(n),onMove:r,onEnd:(s,o)=>{delete this.session,i&&di.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=ET(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const qM={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Nie(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const DE={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(mn.test(t))t=parseFloat(t);else return t;const n=Nie(t,e.target.x),r=Nie(t,e.target.y);return`${n}% ${r}%`}},kot={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=Vg.parse(t);if(i.length>5)return r;const s=Vg.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=Li(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),s(i)}};class Aot extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;qrt(Iot),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),qM.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,o=r.projection;return o&&(o.isPresent=s,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||di.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),IW.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Kxe(t){const[e,n]=P_e(),r=X.useContext(xW);return m.jsx(Aot,{...t,layoutGroup:r,switchLayoutGroup:X.useContext(j_e),isPresent:e,safeToRemove:n})}const Iot={borderRadius:{...DE,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:DE,borderTopRightRadius:DE,borderBottomLeftRadius:DE,borderBottomRightRadius:DE,boxShadow:kot};function Rot(t,e,n){const r=ca(t)?t:Xk(t);return r.start(QW("",r,e,n)),r.animation}function Pot(t){return t instanceof SVGElement&&t.tagName!=="svg"}const Cot=(t,e)=>t.depth-e.depth;class Mot{constructor(){this.children=[],this.isDirty=!1}add(e){UW(this.children,e),this.isDirty=!0}remove(e){GW(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Cot),this.isDirty=!1,this.children.forEach(e)}}function Not(t,e){const n=xd.now(),r=({timestamp:i})=>{const s=i-n;s>=e&&(Fg(r),t(s-e))};return di.read(r,!0),()=>Fg(r)}const Yxe=["TopLeft","TopRight","BottomLeft","BottomRight"],Oot=Yxe.length,Oie=t=>typeof t=="string"?parseFloat(t):t,Lie=t=>typeof t=="number"||mn.test(t);function Lot(t,e,n,r,i,s){i?(t.opacity=Li(0,n.opacity!==void 0?n.opacity:1,Dot(r)),t.opacityExit=Li(e.opacity!==void 0?e.opacity:1,0,$ot(r))):s&&(t.opacity=Li(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<Oot;o++){const a=`border${Yxe[o]}Radius`;let l=Die(e,a),c=Die(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Lie(l)===Lie(c)?(t[a]=Math.max(Li(Oie(l),Oie(c),r),0),(_d.test(c)||_d.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Li(e.rotate||0,n.rotate||0,r))}function Die(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Dot=Xxe(0,.5,pxe),$ot=Xxe(.5,.95,ac);function Xxe(t,e,n){return r=>r<t?0:r>e?1:n(b2(t,e,r))}function $ie(t,e){t.min=e.min,t.max=e.max}function kc(t,e){$ie(t.x,e.x),$ie(t.y,e.y)}function jie(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Fie(t,e,n,r,i){return t-=e,t=aN(t,1/n,r),i!==void 0&&(t=aN(t,1/i,r)),t}function jot(t,e=0,n=1,r=.5,i,s=t,o=t){if(_d.test(e)&&(e=parseFloat(e),e=Li(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Li(s.min,s.max,r);t===s&&(a-=e),t.min=Fie(t.min,e,n,a,i),t.max=Fie(t.max,e,n,a,i)}function Vie(t,e,[n,r,i],s,o){jot(t,e[n],e[r],e[i],e.scale,s,o)}const Fot=["x","scaleX","originX"],Vot=["y","scaleY","originY"];function zie(t,e,n,r){Vie(t.x,e,Fot,n?n.x:void 0,r?r.x:void 0),Vie(t.y,e,Vot,n?n.y:void 0,r?r.y:void 0)}function Uie(t){return t.translate===0&&t.scale===1}function Zxe(t){return Uie(t.x)&&Uie(t.y)}function Gie(t,e){return t.min===e.min&&t.max===e.max}function zot(t,e){return Gie(t.x,e.x)&&Gie(t.y,e.y)}function Bie(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Jxe(t,e){return Bie(t.x,e.x)&&Bie(t.y,e.y)}function Wie(t){return dc(t.x)/dc(t.y)}function Hie(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Uot{constructor(){this.members=[]}add(e){UW(this.members,e),e.scheduleRender()}remove(e){if(GW(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Got(t,e,n){let r="";const i=t.x.translate/e.x,s=t.y.translate/e.y,o=n?.z||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:f,skewX:g,skewY:v}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),g&&(r+=`skewX(${g}deg) `),v&&(r+=`skewY(${v}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const ly={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},PS=typeof window<"u"&&window.MotionDebug!==void 0,g8=["","X","Y","Z"],Bot={visibility:"hidden"},qie=1e3;let Wot=0;function y8(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function Qxe(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=axe(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",di,!(i||s))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&Qxe(r)}function ewe({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},a=e?.()){this.id=Wot++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,PS&&(ly.totalNodes=ly.resolvedTargetDeltas=ly.recalculatedProjection=0),this.nodes.forEach(Kot),this.nodes.forEach(Qot),this.nodes.forEach(eat),this.nodes.forEach(Yot),PS&&window.MotionDebug.record(ly)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Mot)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new BW),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Pot(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Not(f,250),qM.hasAnimatedSinceResize&&(qM.hasAnimatedSinceResize=!1,this.nodes.forEach(Yie))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:g,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||sat,{onLayoutAnimationStart:b,onLayoutAnimationComplete:T}=u.getProps(),A=!this.targetLayout||!Jxe(this.targetLayout,v)||g,I=!f&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||f&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,I);const R={...jW(x,"layout"),onPlay:b,onComplete:T};(u.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else f||Yie(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Fg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(tat),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Qxe(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Kie);return}this.isUpdating||this.nodes.forEach(Zot),this.isUpdating=!1,this.nodes.forEach(Jot),this.nodes.forEach(Hot),this.nodes.forEach(qot),this.clearAllSnapshots();const a=xd.now();So.delta=cp(0,1e3/60,a-So.timestamp),So.timestamp=a,So.isProcessing=!0,a8.update.process(So),a8.preRender.process(So),a8.render.process(So),So.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,IW.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Xot),this.sharedNodes.forEach(nat)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,di.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){di.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ss(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!Zxe(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||ay(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),oat(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return ss();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(aat))){const{scroll:u}=this.root;u&&(Ax(l.x,u.offset.x),Ax(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=ss();if(kc(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&kc(l,o),Ax(l.x,h.offset.x),Ax(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=ss();kc(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ix(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),ay(u.latestValues)&&Ix(l,u.latestValues)}return ay(this.latestValues)&&Ix(l,this.latestValues),l}removeTransform(o){const a=ss();kc(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!ay(c.latestValues))continue;NV(c.latestValues)&&c.updateSnapshot();const u=ss(),h=c.measurePageBox();kc(u,h),zie(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return ay(this.latestValues)&&zie(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==So.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=So.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),TT(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),kc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ss(),this.targetWithTransforms=ss()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),uot(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):kc(this.target,this.layout.layoutBox),Wxe(this.target,this.targetDelta)):kc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),TT(this.relativeTargetOrigin,this.target,g.target),kc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}PS&&ly.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||NV(this.parent.latestValues)||Bxe(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===So.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;kc(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,g=this.treeScale.y;_ot(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ss());const{target:v}=a;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(jie(this.prevProjectionDelta.x,this.projectionDelta.x),jie(this.prevProjectionDelta.y,this.projectionDelta.y)),ST(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==g||!Hie(this.projectionDelta.x,this.prevProjectionDelta.x)||!Hie(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),PS&&ly.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=kx(),this.projectionDelta=kx(),this.projectionDeltaWithTransform=kx()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=kx();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=ss(),g=l?l.source:void 0,v=this.layout?this.layout.source:void 0,x=g!==v,b=this.getStack(),T=!b||b.members.length<=1,A=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(iat));this.animationProgress=0;let I;this.mixTargetDelta=R=>{const M=R/1e3;Xie(h.x,o.x,M),Xie(h.y,o.y,M),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(TT(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),rat(this.relativeTarget,this.relativeTargetOrigin,f,M),I&&zot(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=ss()),kc(I,this.relativeTarget)),x&&(this.animationValues=u,Lot(u,c,this.latestValues,M,A,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Fg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=di.update(()=>{qM.hasAnimatedSinceResize=!0,this.currentAnimation=Rot(0,qie,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(qie),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&twe(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||ss();const h=dc(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const f=dc(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+f}kc(a,l),Ix(a,u),ST(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Uot),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&y8("z",o,c,this.animationValues);for(let u=0;u<g8.length;u++)y8(`rotate${g8[u]}`,o,c,this.animationValues),y8(`skew${g8[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Bot;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=WM(o?.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=WM(o?.pointerEvents)||""),this.hasProjected&&!ay(this.latestValues)&&(x.transform=u?u({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=Got(this.projectionDeltaWithTransform,this.treeScale,f),u&&(c.transform=u(f,c.transform));const{x:g,y:v}=this.projectionDelta;c.transformOrigin=`${g.origin*100}% ${v.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=f.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:c.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in nN){if(f[x]===void 0)continue;const{correct:b,applyTo:T}=nN[x],A=c.transform==="none"?f[x]:b(f[x],h);if(T){const I=T.length;for(let R=0;R<I;R++)c[T[R]]=A}else c[x]=A}return this.options.layoutId&&(c.pointerEvents=h===this?WM(o?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Kie),this.root.sharedNodes.clear()}}}function Hot(t){t.updateLayout()}function qot(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Oc(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],g=dc(f);f.min=r[h].min,f.max=f.min+g}):twe(s,n.layoutBox,r)&&Oc(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],g=dc(r[h]);f.max=f.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+g)});const a=kx();ST(a,r,n.layoutBox);const l=kx();o?ST(l,t.applyTransform(i,!0),n.measuredBox):ST(l,r,n.layoutBox);const c=!Zxe(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:g}=h;if(f&&g){const v=ss();TT(v,n.layoutBox,f.layoutBox);const x=ss();TT(x,r,g.layoutBox),Jxe(v,x)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=v,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Kot(t){PS&&ly.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Yot(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Xot(t){t.clearSnapshot()}function Kie(t){t.clearMeasurements()}function Zot(t){t.isLayoutDirty=!1}function Jot(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Yie(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Qot(t){t.resolveTargetDelta()}function eat(t){t.calcProjection()}function tat(t){t.resetSkewAndRotation()}function nat(t){t.removeLeadSnapshot()}function Xie(t,e,n){t.translate=Li(e.translate,0,n),t.scale=Li(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Zie(t,e,n,r){t.min=Li(e.min,n.min,r),t.max=Li(e.max,n.max,r)}function rat(t,e,n,r){Zie(t.x,e.x,n.x,r),Zie(t.y,e.y,n.y,r)}function iat(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const sat={duration:.45,ease:[.4,0,.1,1]},Jie=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Qie=Jie("applewebkit/")&&!Jie("chrome/")?Math.round:ac;function ese(t){t.min=Qie(t.min),t.max=Qie(t.max)}function oat(t){ese(t.x),ese(t.y)}function twe(t,e,n){return t==="position"||t==="preserve-aspect"&&!cot(Wie(e),Wie(n),.2)}function aat(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const lat=ewe({attachResizeListener:(t,e)=>Jk(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),v8={current:void 0},nwe=ewe({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!v8.current){const t=new lat({});t.mount(window),t.setOptions({layoutScroll:!0}),v8.current=t}return v8.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),cat={pan:{Feature:Tot},drag:{Feature:Sot,ProjectionNode:nwe,MeasureLayout:Kxe}};function tse(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,s=r[i];s&&di.postRender(()=>s(e,AI(e)))}class uat extends Qg{mount(){const{current:e}=this.node;e&&(this.unmount=cit(e,n=>(tse(this.node,n,"Start"),r=>tse(this.node,r,"End"))))}unmount(){}}class hat extends Qg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=kI(Jk(this.node.current,"focus",()=>this.onFocus()),Jk(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function nse(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),s=r[i];s&&di.postRender(()=>s(e,AI(e)))}class dat extends Qg{mount(){const{current:e}=this.node;e&&(this.unmount=fit(e,n=>(nse(this.node,n,"Start"),(r,{success:i})=>nse(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const LV=new WeakMap,_8=new WeakMap,fat=t=>{const e=LV.get(t.target);e&&e(t)},pat=t=>{t.forEach(fat)};function mat({root:t,...e}){const n=t||document;_8.has(n)||_8.set(n,{});const r=_8.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(pat,{root:t,...e})),r[i]}function gat(t,e,n){const r=mat(e);return LV.set(t,n),r.observe(t),()=>{LV.delete(t),r.unobserve(t)}}const yat={some:0,all:1};class vat extends Qg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:yat[i]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=c?u:h;f&&f(l)};return gat(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(_at(e,n))&&this.startObserver()}unmount(){}}function _at({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const xat={inView:{Feature:vat},tap:{Feature:dat},focus:{Feature:hat},hover:{Feature:uat}},wat={layout:{ProjectionNode:nwe,MeasureLayout:Kxe}},DV={current:null},rwe={current:!1};function bat(){if(rwe.current=!0,!!EW)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>DV.current=t.matches;t.addListener(e),e()}else DV.current=!1}const Eat=[...Ixe,Zo,Vg],Sat=t=>Eat.find(Axe(t)),rse=new WeakMap;function Tat(t,e,n){for(const r in e){const i=e[r],s=n[r];if(ca(i))t.addValue(r,i);else if(ca(s))t.addValue(r,Xk(i,{owner:t}));else if(s!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,Xk(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const ise=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class kat{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=XW,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=xd.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,di.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=HO(n),this.isVariantNode=D_e(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const g in f){const v=f[g];l[g]!==void 0&&ca(v)&&v.set(l[g],!1)}}mount(e){this.current=e,rse.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),rwe.current||bat(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:DV.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){rse.delete(this.current),this.projection&&this.projection.unmount(),Fg(this.notifyUpdate),Fg(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=cv.has(e),i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&di.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),s(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in E2){const n=E2[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ss()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<ise.length;r++){const i=ise[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=e[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=Tat(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Xk(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Txe(i)||gxe(i))?i=parseFloat(i):!Sat(i)&&Vg.test(n)&&(i=bxe(e,n)),this.setBaseTarget(e,ca(i)?i.get():i)),ca(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const o=PW(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(i=o[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ca(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new BW),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class iwe extends kat{constructor(){super(...arguments),this.KeyframeResolver=Rxe}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ca(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Aat(t){return window.getComputedStyle(t)}class Iat extends iwe{constructor(){super(...arguments),this.type="html",this.renderInstance=W_e}readValueFromInstance(e,n){if(cv.has(n)){const r=YW(n);return r&&r.default||0}else{const r=Aat(e),i=(U_e(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Hxe(e,n)}build(e,n,r){NW(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return $W(e,n,r)}}class Rat extends iwe{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ss}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(cv.has(n)){const r=YW(n);return r&&r.default||0}return n=H_e.has(n)?n:AW(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return Y_e(e,n,r)}build(e,n,r){OW(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,i){q_e(e,n,r,i)}mount(e){this.isSVGTag=DW(e.tagName),super.mount(e)}}const Pat=(t,e)=>RW(t)?new Rat(e):new Iat(e,{allowProjection:t!==X.Fragment}),Cat=nit({...eot,...xat,...cat,...wat},Pat),Mt=yrt(Cat);const Mat=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nat=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),sse=t=>{const e=Nat(t);return e.charAt(0).toUpperCase()+e.slice(1)},swe=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),Oat=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Lat={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Dat=X.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>X.createElement("svg",{ref:l,...Lat,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:swe("lucide",i),...!s&&!Oat(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>X.createElement(c,u)),...Array.isArray(s)?s:[s]]));const lt=(t,e)=>{const n=X.forwardRef(({className:r,...i},s)=>X.createElement(Dat,{ref:s,iconNode:e,className:swe(`lucide-${Mat(sse(t))}`,`lucide-${t}`,r),...i}));return n.displayName=sse(t),n};const $at=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],jat=lt("archive-restore",$at);const Fat=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],owe=lt("archive",Fat);const Vat=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],zat=lt("ban",Vat);const Uat=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Gat=lt("book-open",Uat);const Bat=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],awe=lt("bug",Bat);const Wat=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],eH=lt("calendar",Wat);const Hat=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],YO=lt("camera",Hat);const qat=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],lwe=lt("chart-column",qat);const Kat=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],up=lt("check",Kat);const Yat=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ab=lt("chevron-down",Yat);const Xat=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],cwe=lt("chevron-left",Xat);const Zat=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lb=lt("chevron-right",Zat);const Jat=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],XO=lt("chevron-up",Jat);const Qat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],uwe=lt("circle-alert",Qat);const elt=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],tlt=lt("circle-check-big",elt);const nlt=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],lN=lt("clock",nlt);const rlt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],ilt=lt("cloud-fog",rlt);const slt=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],olt=lt("cloud-lightning",slt);const alt=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],llt=lt("cloud-off",alt);const clt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],tH=lt("cloud-rain",clt);const ult=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],hlt=lt("cloud-snow",ult);const dlt=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],hp=lt("cloud",dlt);const flt=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],plt=lt("code",flt);const mlt=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],glt=lt("compass",mlt);const ylt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],cN=lt("crosshair",ylt);const vlt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Qk=lt("download",vlt);const _lt=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],xlt=lt("droplets",_lt);const wlt=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],vg=lt("external-link",wlt);const blt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],uN=lt("eye-off",blt);const Elt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],hN=lt("eye",Elt);const Slt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],nH=lt("file-text",Slt);const Tlt=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],klt=lt("flame",Tlt);const Alt=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],ose=lt("flower-2",Alt);const Ilt=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Rlt=lt("folder-open",Ilt);const Plt=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Clt=lt("folder-plus",Plt);const Mlt=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Nlt=lt("folder",Mlt);const Olt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Llt=lt("funnel",Olt);const Dlt=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],$lt=lt("gauge",Dlt);const jlt=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Flt=lt("gem",jlt);const Vlt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],zlt=lt("globe",Vlt);const Ult=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],hwe=lt("grid-3x3",Ult);const Glt=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],dwe=lt("grip-horizontal",Glt);const Blt=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Wlt=lt("image-plus",Blt);const Hlt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],rH=lt("info",Hlt);const qlt=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],fwe=lt("landmark",qlt);const Klt=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],nu=lt("layers",Klt);const Ylt=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],pwe=lt("list",Ylt);const Xlt=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ZO=lt("loader-circle",Xlt);const Zlt=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Jlt=lt("locate-fixed",Zlt);const Qlt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$V=lt("lock",Qlt);const ect=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],iH=lt("log-out",ect);const tct=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],fc=lt("map-pin",tct);const nct=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],JO=lt("map",nct);const rct=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],ict=lt("menu",rct);const sct=[["path",{d:"M5 12h14",key:"1ays0h"}]],mwe=lt("minus",sct);const oct=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],T2=lt("mountain",oct);const act=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],lct=lt("mouse-pointer",act);const cct=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],cb=lt("navigation",cct);const uct=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],gwe=lt("pause",uct);const hct=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ase=lt("pen-line",hct);const dct=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],fct=lt("pen",dct);const pct=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],k2=lt("pencil",pct);const mct=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],ywe=lt("person-standing",mct);const gct=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],vwe=lt("play",gct);const yct=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],uu=lt("plus",yct);const vct=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],_we=lt("refresh-cw",vct);const _ct=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],xct=lt("rotate-ccw",_ct);const wct=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],bct=lt("rotate-cw",wct);const Ect=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],dN=lt("route",Ect);const Sct=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],eA=lt("ruler",Sct);const Tct=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],xwe=lt("save",Tct);const kct=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Act=lt("scale",kct);const Ict=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fN=lt("search",Ict);const Rct=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jV=lt("settings",Rct);const Pct=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Cct=lt("settings-2",Pct);const Mct=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Nct=lt("share-2",Mct);const Oct=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Lct=lt("shield",Oct);const Dct=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],$ct=lt("sliders-horizontal",Dct);const jct=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],Fct=lt("sliders-vertical",jct);const Vct=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],zct=lt("smartphone",Vct);const Uct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Gct=lt("square",Uct);const Bct=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Wct=lt("sun",Bct);const Hct=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],qct=lt("tag",Hct);const Kct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Yct=lt("target",Kct);const Xct=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Zct=lt("timer",Xct);const Jct=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wp=lt("trash-2",Jct);const Qct=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],eut=lt("tree-palm",Qct);const tut=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],nut=lt("trending-down",tut);const rut=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],iut=lt("trending-up",rut);const sut=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],sH=lt("type",sut);const out=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],II=lt("upload",out);const aut=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],oH=lt("user",aut);const lut=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],cut=lt("volume-2",lut);const uut=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],hut=lt("waves",uut);const dut=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],fut=lt("wifi-off",dut);const put=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],lse=lt("wind",put);const mut=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fi=lt("x",mut);const gut=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],yut=lt("zoom-in",gut);function vut(){const{tracking:t,startTracking:e,stopTracking:n,updatePosition:r,setWatchId:i}=bs(),s=X.useCallback(a=>{r(a)},[r]),o=X.useCallback(a=>{console.error("GPS error:",a),alert(`GPS fout: ${a.message}`),n()},[n]);return X.useEffect(()=>{if(!t)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),n();return}const a=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(a),()=>{navigator.geolocation.clearWatch(a)}},[t,s,o,i,n]),{tracking:t,start:e,stop:n,toggle:()=>t?n():e()}}async function _ut(){const t=DeviceOrientationEvent;if(typeof t.requestPermission=="function")try{return await t.requestPermission()==="granted"}catch{return!1}return!0}function xut(){const{tracking:t,start:e,stop:n}=vut(),r=bs(a=>a.navigationMode),i=bs(a=>a.setNavigationMode),s=t&&r==="headingUp",o=async()=>{t?r==="free"?i("headingUp"):n():(await _ut(),e(),i("free"))};return m.jsx(Mt.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${s?"bg-gradient-to-br from-green-400 to-green-600 text-white shadow-lg shadow-green-500/30":t?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:o,whileHover:{scale:1.05},whileTap:{scale:.95},animate:t?{scale:[1,1.02,1]}:{},transition:t?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":s?"Rijmodus actief (kaart draait mee)":t?"GPS actief - klik voor rijmodus":"GPS starten",title:s?"Rijmodus actief - klik om GPS te stoppen":t?"GPS actief - klik voor rijmodus":"GPS starten",children:s?m.jsx(cb,{size:22,strokeWidth:2}):m.jsx(Jlt,{size:22,strokeWidth:2})})}const wut="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`),cse=new zn({image:new ja({radius:7,fill:new Nr({color:"#4285F4"}),stroke:new Sr({color:"white",width:2.5})})});function but(){const t=$i(v=>v.map),e=bs(v=>v.position),n=bs(v=>v.accuracy),r=bs(v=>v.tracking),i=bs(v=>v.smoothHeading),s=bs(v=>v.navigationMode),o=Nn(v=>v.showAccuracyCircle),a=bs(v=>v.firstFix),l=bs(v=>v.resetFirstFix),c=bs(v=>v.config.centerOnUser),u=X.useRef(null),h=X.useRef(null),f=X.useRef(null),g=X.useMemo(()=>v=>new zn({image:new kA({src:wut,scale:.9,rotation:v,rotateWithView:!0,anchor:[.5,.5]})}),[]);return X.useEffect(()=>{if(!t||!e)return;const v=Pi([e.lng,e.lat]);return u.current=new xi({geometry:new Vs(v)}),u.current.setStyle(r?g(0):cse),h.current=new xi({geometry:new Vs(v)}),f.current=new gp({source:new Od({features:[h.current,u.current]}),zIndex:1e3}),t.addLayer(f.current),()=>{f.current&&t&&t.removeLayer(f.current)}},[t,!!e,g]),X.useEffect(()=>{if(u.current)if(r){const v=i!==null?i*Math.PI/180:0;u.current.setStyle(g(v))}else u.current.setStyle(cse)},[r,g,i]),X.useEffect(()=>{if(!t||!e||!u.current||!h.current)return;const v=Pi([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(v),h.current.getGeometry()?.setCoordinates(v),r&&o&&n){const x=t.getView().getResolution()||1,b=Math.min(n/x,80);h.current.setStyle(new zn({image:new ja({radius:b,fill:new Nr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new zn({}));if(a&&r){t.getView().setCenter(v),t.getView().setZoom(17),l();return}r&&c&&!a&&t.getView().animate({center:v,duration:150})},[t,r,e,n,a,l,c,o]),X.useEffect(()=>{if(!u.current||!r)return;const v=i!==null?i*Math.PI/180:0;u.current.setStyle(g(v))},[i,g,r]),X.useEffect(()=>{if(!(!t||!r)&&s==="headingUp"&&i!==null){const v=-(i*Math.PI)/180,x=t.getView(),b=x.getRotation();let T=v-b;for(;T>Math.PI;)T-=2*Math.PI;for(;T<-Math.PI;)T+=2*Math.PI;Math.abs(T)>.01&&x.animate({rotation:b+T,duration:200})}},[t,r,s,i]),X.useEffect(()=>{if(t&&s==="free"){const v=t.getView(),x=v.getRotation();Math.abs(x)>.01&&v.animate({rotation:0,duration:300})}},[t,s]),null}function Eut(){const t=ri(n=>n.themesPanelOpen),e=ri(n=>n.toggleThemesPanel);return m.jsx(Mt.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${t?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":t?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:m.jsx(JO,{size:22,strokeWidth:2})})}function Sut(){return m.jsx(Eut,{})}const iC=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Nm=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],Uc="default-vondsten",FV={id:Uc,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},Tut=t=>t.some(n=>n.id===Uc)?t:[{...FV,createdAt:new Date().toISOString()},...t],Co=ho()(dh((t,e)=>({layers:[{...FV}],colorIndex:0,addLayer:(n,r=Nm)=>{const i=crypto.randomUUID(),s=iC[e().colorIndex%iC.length];return t(o=>({layers:[...o.layers,{id:i,name:n,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:o.colorIndex+1})),i},removeLayer:n=>{t(r=>({layers:r.layers.filter(i=>i.id!==n)}))},updateLayer:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,...r}:s)}))},toggleVisibility:n=>{t(r=>({layers:r.layers.map(i=>i.id===n?{...i,visible:!i.visible}:i)}))},toggleArchived:n=>{t(r=>({layers:r.layers.map(i=>i.id===n?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(n,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:[...o.points,i]}:o)}))},removePoint:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,points:s.points.filter(o=>o.id!==r)}:s)}))},updatePoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,...i}:a)}:o)}))},setPointStatus:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,status:i}:a)}:o)}))},addCategory:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,categories:s.categories.filter(o=>o!==r)}:s)}))},addPhotoToPoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,photos:[...a.photos||[],i]}:a)}:o)}))},removePhotoFromPoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,photos:(a.photos||[]).filter(l=>l.id!==i)}:a)}:o)}))},updatePhotoInPoint:(n,r,i,s)=>{t(o=>({layers:o.layers.map(a=>a.id===n?{...a,points:a.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:a)}))},exportLayerAsGeoJSON:n=>{const r=e().layers.find(l=>l.id===n);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},importLayerFromGeoJSON:n=>{try{const r=JSON.parse(n);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,o=i.categories||Nm,a=i.color||iC[e().colorIndex%iC.length],l=(r.features||[]).filter(u=>u.geometry?.type==="Point").map(u=>({id:u.properties?.id||crypto.randomUUID(),name:u.properties?.name||"Naamloos",category:u.properties?.category||"Overig",notes:u.properties?.notes||"",url:u.properties?.url,status:u.properties?.status||"todo",sourceLayer:u.properties?.sourceLayer,sourceId:u.properties?.sourceId,photos:u.properties?.photos,coordinates:u.geometry.coordinates,createdAt:u.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return t(u=>({layers:[...u.layers,{id:c,name:s,color:a,categories:o,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:u.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:n=>e().layers.find(r=>r.id===n),getActiveLayerCount:()=>e().layers.filter(n=>!n.archived).length,getArchivedLayerCount:()=>e().layers.filter(n=>n.archived).length,clearAll:()=>{t(n=>({layers:n.layers.map(r=>r.id===Uc?{...r,points:[]}:r).filter(r=>r.id===Uc),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,onRehydrateStorage:()=>t=>{t&&(t.layers.some(n=>n.id===Uc)||(t.layers=[{...FV,createdAt:new Date().toISOString()},...t.layers]))},migrate:(t,e)=>{const n=t;return e<2?{...n,layers:Tut(n.layers||[])}:e<3?{...n,layers:(n.layers||[]).map(r=>r.id===Uc?{...r,name:"Mijn vondsten"}:r)}:n}}));function Ns({title:t,children:e,defaultExpanded:n=!0,layerNames:r}){const[i,s]=X.useState(n),o=io(b=>b.visible),a=io(b=>b.setLayerVisibility),l=cG(b=>b.isLayerUnlocked),c=b=>{const T=Sy[b],A=T?.tier??"free",I=T?.regions??["nl"];return l(b,A,I)},u=r?.filter(b=>c(b))||[],h=u.filter(b=>o[b]).length,f=u.length,g=f>0&&h===f,v=h>0&&h<f,x=b=>{if(b.stopPropagation(),!r||u.length===0)return;const T=!g;u.forEach(A=>{a(A,T)})};return m.jsxs("div",{className:"mb-0.5",children:[m.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[m.jsxs("button",{onClick:b=>{b.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[m.jsx(Mt.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:m.jsx(lb,{size:14})}),i?m.jsx(Rlt,{size:16,className:"text-blue-500"}):m.jsx(Nlt,{size:16,className:"text-blue-500"}),m.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:t}),h>0&&m.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:h})]}),r&&r.length>0&&m.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:g?"#3b82f6":v?"#93c5fd":"white",border:g?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(g||v)&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),m.jsx(rr,{initial:!1,children:i&&m.jsx(Mt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function xt({name:t,type:e,hasOverlay:n,displayName:r}){const i=io(R=>R.visible[t]),s=io(R=>R.visible["Labels Overlay"]),o=io(R=>R.loadingState[t]),a=io(R=>R.toggleLayer),l=io(R=>R.setLayerVisibility),c=cG(R=>R.isLayerUnlocked),u=o==="loading",h=o==="error",f=Sy[t],g=f?.tier??"free",v=f?.regions??["nl"],b=!c(t,g,v),T=R=>{R.stopPropagation(),!(u||b)&&(e==="overlay"?a(t):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(F=>{l(F,F===t)}))},A=R=>{R.stopPropagation(),l("Labels Overlay",!s)},I=i??!1;return m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs("button",{onClick:T,disabled:u||b,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${b?"opacity-50 cursor-not-allowed bg-gray-50":u?"opacity-70 cursor-wait bg-transparent":I?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:b?"Premium laag - upgrade om te ontgrendelen":void 0,children:[m.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":b?"text-gray-400":"text-gray-600"}`,children:[r||t,h&&m.jsx(uwe,{size:12,className:"text-red-500"}),b&&m.jsx($V,{size:12,className:"text-amber-500"})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:b?"#e5e7eb":u?"#93c5fd":I?"#3b82f6":"white",border:b?"2px solid #d1d5db":u?"2px solid #93c5fd":I?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:b?m.jsx($V,{size:10,strokeWidth:3,className:"text-gray-400"}):u?m.jsx(ZO,{size:10,strokeWidth:3,className:"animate-spin"}):I?m.jsx(up,{size:12,strokeWidth:3}):null})]}),n&&I&&m.jsx("button",{onClick:A,className:`p-1 rounded transition-colors border-0 outline-none ${s?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s?"Labels verbergen":"Labels tonen",children:m.jsx(qct,{size:12})})]})}const kut=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function wwe({layer:t,compact:e=!1}){const{toggleVisibility:n,removeLayer:r,updateLayer:i,setColor:s}=KA(),[o,a]=X.useState(!1),[l,c]=X.useState(!1),[u,h]=X.useState(t.name),[f,g]=X.useState(!1),v=X.useRef(null),x=X.useRef(null),b=t.features.features.length,T=[...new Set(t.features.features.map(C=>C.geometry?.type).filter(Boolean))];X.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),X.useEffect(()=>{const C=N=>{x.current&&!x.current.contains(N.target)&&g(!1)};if(f)return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[f]);const A=()=>{o?r(t.id):(a(!0),setTimeout(()=>a(!1),3e3))},I=()=>{const C=u.trim();C&&C!==t.name&&i(t.id,{name:C}),c(!1)},R=()=>{h(t.name),c(!1)},M=C=>{C.key==="Enter"?I():C.key==="Escape"&&R()},F=C=>{s(t.id,C),g(!1)};return e?m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[m.jsx("button",{onClick:()=>n(t.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:t.visible?t.color:"white",border:`2px solid ${t.color}`},title:t.visible?"Verbergen":"Tonen",children:t.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>n(t.id),children:t.name}),m.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:b})]}):m.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[m.jsxs("div",{className:"relative",ref:x,children:[m.jsx("button",{onClick:()=>g(!f),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:t.color},title:"Kleur wijzigen"}),f&&m.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:kut.map(C=>m.jsx("button",{onClick:()=>F(C),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${C===t.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:C},title:C},C))})]}),m.jsx("div",{className:"flex-1 min-w-0",children:l?m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("input",{ref:v,type:"text",value:u,onChange:C=>h(C.target.value),onKeyDown:M,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),m.jsx("button",{onClick:I,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:m.jsx(up,{size:14})}),m.jsx("button",{onClick:R,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:m.jsx(fi,{size:14})})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-sm text-gray-700 truncate",children:t.name}),m.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:m.jsx(k2,{size:12})})]}),m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[m.jsxs("span",{children:[b," ",b===1?"feature":"features"]}),T.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"mx-0.5",children:""}),m.jsx("span",{children:T.join(", ")})]})]})]})})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>n(t.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:t.visible?t.color:"white",border:`2px solid ${t.visible?t.color:"#9ca3af"}`},title:t.visible?"Verbergen":"Tonen",children:t.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("button",{onClick:A,className:`p-1 rounded transition-colors border-0 outline-none ${o?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:o?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(wp,{size:14})})]})]})}const pN="commercial",Aut={commercial:["Archeologische lagen","Archeologische verwachtingen","Erfgoed & Monumenten","WOII & Militair","Hillshade & LiDAR","Terrein & Bodem","Percelen","Recreatie"],personal:["Steentijd & Prehistorie","Paleokaarten","Archeologische lagen","Archeologische verwachtingen","Erfgoed & Monumenten","WOII & Militair","Hillshade & LiDAR","Terrein & Bodem","Percelen","Provinciale Thema's","Fossielen, Mineralen & Goud","Recreatie"]},Iut={commercial:["Specials (3D)"],personal:["Specials (3D)"]};function $l(t){return Aut[pN].includes(t)}function Rut(t){return Iut[pN].includes(t)}const Put=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],Cut=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function Mut(){const{themesPanelOpen:t,toggleThemesPanel:e,toggleSettingsPanel:n}=ri(),{layers:r,toggleVisibility:i}=Co(),s=KA(v=>v.layers),o=X.useRef(null),a=Nn(v=>v.layerPanelFontScale),l=Nn(v=>v.setLayerPanelFontScale),c=Nn(v=>v.showFontSliders),u=Nn(v=>v.showCustomPointLayers),h=13*a/100,[f,g]=X.useState(!1);return X.useEffect(()=>{if(!t)return;const v=b=>{o.current&&!o.current.contains(b.target)&&e()},x=setTimeout(()=>{document.addEventListener("click",v)},100);return()=>{clearTimeout(x),document.removeEventListener("click",v)}},[t,e]),m.jsx(rr,{children:t&&m.jsxs(Mt.div,{ref:o,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(nu,{size:14,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[c&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:a,onInput:v=>{l(parseInt(v.target.value))},onChange:v=>l(parseInt(v.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),m.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:m.jsx(fi,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),m.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[u&&r.filter(v=>!v.archived).length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:m.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(v=>!v.archived).map(v=>m.jsxs("button",{onClick:x=>{x.stopPropagation(),i(v.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${v.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[m.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[v.name,m.jsxs("span",{className:"text-xs text-gray-400",children:["(",v.points.length,")"]})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:v.visible?"#f97316":"white",border:v.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:v.visible&&m.jsx(up,{size:12,strokeWidth:3})})]},v.id))]}),s.length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[m.jsx(II,{size:12,className:"text-cyan-600"}),m.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(v=>m.jsx(wwe,{layer:v,compact:!0},v.id)),m.jsx("button",{onClick:()=>{e(),n()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),m.jsxs("div",{className:"space-y-0",children:[m.jsx(xt,{name:"CartoDB (licht)",type:"base"}),m.jsx(xt,{name:"OpenStreetMap",type:"base"}),m.jsx(xt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),m.jsx(xt,{name:"TMK 1850",type:"base",hasOverlay:!0}),m.jsx(xt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),$l("Steentijd & Prehistorie")&&m.jsxs(Ns,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","FAMKE IJzertijd"],children:[m.jsx(xt,{name:"Hunebedden",type:"overlay"}),m.jsx(xt,{name:"Grafheuvels",type:"overlay"}),m.jsx(xt,{name:"Terpen",type:"overlay"}),m.jsx(xt,{name:"FAMKE Steentijd",type:"overlay"}),m.jsx(xt,{name:"FAMKE IJzertijd",type:"overlay"})]}),$l("Paleokaarten")&&m.jsxs(Ns,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[m.jsx(xt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),$l("Archeologische lagen")&&m.jsxs(Ns,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(xt,{name:"AMK Monumenten",type:"overlay"}),m.jsxs(Ns,{title:"Per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[m.jsx(xt,{name:"AMK Romeins",type:"overlay"}),m.jsx(xt,{name:"AMK Steentijd",type:"overlay"}),m.jsx(xt,{name:"AMK Vroege ME",type:"overlay"}),m.jsx(xt,{name:"AMK Late ME",type:"overlay"}),m.jsx(xt,{name:"AMK Overig",type:"overlay"})]}),m.jsx(xt,{name:"Archeo Onderzoeken",type:"overlay"}),m.jsxs(Ns,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(xt,{name:"Romeinse wegen (regio)",type:"overlay"}),m.jsx(xt,{name:"Romeinse wegen (Wereld)",type:"overlay"}),m.jsxs(Ns,{title:"Romeinse Forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(xt,{name:"Romeinse Forten",type:"overlay"}),m.jsx(xt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]})]}),$l("Archeologische verwachtingen")&&m.jsxs(Ns,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["Kansenkaart","IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[m.jsx(xt,{name:"Kansenkaart",type:"overlay"}),m.jsx(xt,{name:"IKAW",type:"overlay"}),m.jsx(xt,{name:"UIKAV Punten",type:"overlay"}),m.jsx(xt,{name:"UIKAV Vlakken",type:"overlay"}),m.jsx(xt,{name:"UIKAV Expert",type:"overlay"}),m.jsx(xt,{name:"UIKAV Buffer",type:"overlay"}),m.jsx(xt,{name:"UIKAV Indeling",type:"overlay"})]}),$l("Erfgoed & Monumenten")&&m.jsxs(Ns,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[m.jsx(xt,{name:"Rijksmonumenten",type:"overlay"}),m.jsx(xt,{name:"Werelderfgoed",type:"overlay"}),m.jsx(xt,{name:"Religieus Erfgoed",type:"overlay"}),m.jsx(xt,{name:"Kastelen",type:"overlay"}),m.jsx(xt,{name:"Runes",type:"overlay"})]}),$l("WOII & Militair")&&m.jsxs(Ns,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[m.jsx(xt,{name:"WWII Bunkers",type:"overlay"}),m.jsx(xt,{name:"Slagvelden",type:"overlay"}),m.jsx(xt,{name:"Militaire Vliegvelden",type:"overlay"}),m.jsx(xt,{name:"Verdedigingslinies",type:"overlay"}),m.jsx(xt,{name:"Militaire Objecten",type:"overlay"}),m.jsx(xt,{name:"Inundatiegebieden",type:"overlay"})]}),$l("Hillshade & LiDAR")&&m.jsxs(Ns,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Hillshade Kleur","AHN 0.5m"],children:[m.jsx(xt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),m.jsx(xt,{name:"AHN4 Hillshade NL",type:"overlay"}),m.jsx(xt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),m.jsx(xt,{name:"AHN4 Hillshade Kleur",type:"overlay"}),m.jsx(xt,{name:"AHN 0.5m",type:"overlay"})]}),$l("Terrein & Bodem")&&m.jsxs(Ns,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[m.jsx(xt,{name:"Veengebieden",type:"overlay"}),m.jsx(xt,{name:"Geomorfologie",type:"overlay"}),m.jsx(xt,{name:"Bodemkaart",type:"overlay"}),m.jsx(xt,{name:"Essen",type:"overlay"})]}),$l("Percelen")&&m.jsxs(Ns,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[m.jsx(xt,{name:"Gewaspercelen",type:"overlay"}),m.jsx(xt,{name:"Kadastrale Grenzen",type:"overlay"})]}),$l("Provinciale Thema's")&&m.jsxs(Ns,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[m.jsxs(Ns,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[m.jsx(xt,{name:"Scheepswrakken",type:"overlay"}),m.jsx(xt,{name:"Woonheuvels ZH",type:"overlay"}),m.jsx(xt,{name:"Windmolens",type:"overlay"}),m.jsx(xt,{name:"Erfgoedlijnen",type:"overlay"}),m.jsx(xt,{name:"Oude Kernen",type:"overlay"})]}),m.jsxs(Ns,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[m.jsx(xt,{name:"Relictenkaart Punten",type:"overlay"}),m.jsx(xt,{name:"Relictenkaart Lijnen",type:"overlay"}),m.jsx(xt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),m.jsx(Ns,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:m.jsx(xt,{name:"Verdronken Dorpen",type:"overlay"})})]}),$l("Fossielen, Mineralen & Goud")&&m.jsxs(Ns,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[m.jsx(xt,{name:"Fossiel Hotspots",type:"overlay"}),m.jsx(xt,{name:"Mineralen Hotspots",type:"overlay"}),m.jsx(xt,{name:"Goudrivieren",type:"overlay"}),m.jsx(xt,{name:"Fossielen Nederland",type:"overlay"}),m.jsx(xt,{name:"Fossielen Belgi",type:"overlay"}),m.jsx(xt,{name:"Fossielen Duitsland",type:"overlay"}),m.jsx(xt,{name:"Fossielen Frankrijk",type:"overlay"})]}),$l("Recreatie")&&pN==="commercial"&&m.jsxs(Ns,{title:"Recreatie",defaultExpanded:!1,layerNames:["Parken","Speeltuinen","Strandjes"],children:[m.jsx(xt,{name:"Parken",type:"overlay"}),m.jsx(xt,{name:"Speeltuinen",type:"overlay"}),m.jsx(xt,{name:"Strandjes",type:"overlay",displayName:"Recreatie (strand)"})]}),$l("Recreatie")&&pN==="personal"&&m.jsxs(Ns,{title:"Recreatie",defaultExpanded:!1,layerNames:["Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[m.jsx(xt,{name:"Ruiterpaden",type:"overlay"}),m.jsx(xt,{name:"Laarzenpaden",type:"overlay"}),m.jsx(xt,{name:"Parken",type:"overlay"}),m.jsx(xt,{name:"Speeltuinen",type:"overlay"}),m.jsx(xt,{name:"Musea",type:"overlay"}),m.jsx(xt,{name:"Strandjes",type:"overlay"}),m.jsx(xt,{name:"Kringloopwinkels",type:"overlay"})]}),Rut("Specials (3D)")&&m.jsxs("div",{className:"mb-2",children:[m.jsxs("button",{onClick:v=>{v.stopPropagation(),g(!f)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[f?m.jsx(ab,{size:14,className:"text-purple-500"}):m.jsx(lb,{size:14,className:"text-purple-500"}),m.jsx(zlt,{size:12,className:"text-purple-500"}),m.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Specials (3D)"}),m.jsx(vg,{size:10,className:"text-purple-400 ml-auto"})]}),f&&m.jsxs("div",{className:"mt-1",onClick:v=>v.stopPropagation(),children:[Put.map(v=>m.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-gray-700",children:v.name}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:v.desc})]}),m.jsx(vg,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},v.name)),m.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),Cut.map(v=>m.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-gray-700 font-medium",children:v.name}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:v.desc})]}),m.jsx(vg,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},v.name))]})]})]})]})]})})}function Nut(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var z1=1,U1=2,ow=3,Out=4,VV=5,use=6378137,Lut=6356752314e-3,hse=.0066943799901413165,kT=484813681109536e-20,st=Math.PI/2,Dut=.16666666666666666,$ut=.04722222222222222,jut=.022156084656084655,wt=1e-10,Hi=.017453292519943295,yl=57.29577951308232,Pr=Math.PI/4,tA=Math.PI*2,ls=3.14159265359,Al={};Al.greenwich=0;Al.lisbon=-9.131906111111;Al.paris=2.337229166667;Al.bogota=-74.080916666667;Al.madrid=-3.687938888889;Al.rome=12.452333333333;Al.bern=7.439583333333;Al.jakarta=106.807719444444;Al.ferro=-17.666666666667;Al.brussels=4.367975;Al.stockholm=18.058277777778;Al.athens=23.7163375;Al.oslo=10.722916666667;const Fut={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var dse=/[\s_\-\/\(\)]/g;function zg(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(dse,""),i=-1,s,o;++i<n.length;)if(s=n[i],o=s.toLowerCase().replace(dse,""),o===r)return t[s]}function zV(t){var e={},n=t.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var c=l.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),r,i,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*Hi},lat_1:function(a){e.lat1=a*Hi},lat_2:function(a){e.lat2=a*Hi},lat_ts:function(a){e.lat_ts=a*Hi},lon_0:function(a){e.long0=a*Hi},lon_1:function(a){e.long1=a*Hi},lon_2:function(a){e.long2=a*Hi},alpha:function(a){e.alpha=parseFloat(a)*Hi},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*Hi},lonc:function(a){e.longc=a*Hi},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var l=zg(Fut,a);l&&(e.to_meter=l.to_meter)},from_greenwich:function(a){e.from_greenwich=a*Hi},pm:function(a){var l=zg(Al,a);e.from_greenwich=(l||parseFloat(a))*Hi},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in n)i=n[r],r in o?(s=o[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=t,e}class bwe{static getId(e){const n=e.find(r=>Array.isArray(r)&&r[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(e,n="unit"){if(!e||e.length<3)return{type:n,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:n,name:r,conversion_factor:i,id:o}}static convertAxis(e){const n=e[1]||"Unknown";let r;const i=n.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(a);return{name:n,direction:r,unit:l,order:o}}static extractAxes(e){return e.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,r)=>(n.order||0)-(r.order||0))}static convert(e,n={}){switch(e[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=e[1],n.base_crs=e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")):null,n.conversion=e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")):null;const r=e.find(f=>Array.isArray(f)&&f[0]==="CS");r&&(n.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT");if(i){const f=this.convertUnit(i);n.coordinate_system.unit=f}n.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=e[1];const s=e.find(f=>Array.isArray(f)&&(f[0]==="DATUM"||f[0]==="ENSEMBLE"));if(s){const f=this.convert(s);s[0]==="ENSEMBLE"?n.datum_ensemble=f:n.datum=f;const g=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");g&&g[1]!=="Greenwich"&&(f.prime_meridian={name:g[1],longitude:parseFloat(g[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},n.id=this.getId(e);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=e[1],n.ellipsoid=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=e[1],n.members=e.filter(f=>Array.isArray(f)&&f[0]==="MEMBER").map(f=>({type:"DatumEnsembleMember",name:f[1],id:this.getId(f)}));const o=e.find(f=>Array.isArray(f)&&f[0]==="ENSEMBLEACCURACY");o&&(n.accuracy=parseFloat(o[1]));const a=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID");a&&(n.ellipsoid=this.convert(a)),n.id=this.getId(e);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=e[1],n.semi_major_axis=parseFloat(e[2]),n.inverse_flattening=parseFloat(e[3]),e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT")&&this.convert(e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT"),n);break;case"CONVERSION":n.type="Conversion",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&f[0]==="PARAMETER").map(f=>this.convert(f));break;case"METHOD":n.type="Method",n.name=e[1],n.id=this.getId(e);break;case"PARAMETER":n.type="Parameter",n.name=e[1],n.value=parseFloat(e[2]),n.unit=this.convertUnit(e.find(f=>Array.isArray(f)&&(f[0]==="LENGTHUNIT"||f[0]==="ANGLEUNIT"||f[0]==="SCALEUNIT"))),n.id=this.getId(e);break;case"BOUNDCRS":n.type="BoundCRS";const l=e.find(f=>Array.isArray(f)&&f[0]==="SOURCECRS");if(l){const f=l.find(g=>Array.isArray(g));n.source_crs=f?this.convert(f):null}const c=e.find(f=>Array.isArray(f)&&f[0]==="TARGETCRS");if(c){const f=c.find(g=>Array.isArray(g));n.target_crs=f?this.convert(f):null}const u=e.find(f=>Array.isArray(f)&&f[0]==="ABRIDGEDTRANSFORMATION");u?n.transformation=this.convert(u):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&(f[0]==="PARAMETER"||f[0]==="PARAMETERFILE")).map(f=>{if(f[0]==="PARAMETER")return this.convert(f);if(f[0]==="PARAMETERFILE")return{name:f[1],value:f[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){const f=n.parameters[6];f.name==="Scale difference"&&(f.value=Math.round((f.value-1)*1e12)/1e6)}n.id=this.getId(e);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const h=this.convertUnit(e,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(f=>{f.unit||(f.unit=h)}),h.conversion_factor&&h.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:h});break;default:n.keyword=e[0];break}return n}}class Vut extends bwe{static convert(e,n={}){return super.convert(e,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}}class zut extends bwe{static convert(e,n={}){super.convert(e,n);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(n.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),o=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),a=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");n.usage={},s&&(n.usage.scope=s[1]),o&&(n.usage.area=o[1]),a&&(n.usage.bbox=a.slice(1))}return n}}function Uut(t){return t.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(t.find(e=>Array.isArray(e)&&e[0]==="CS")||t[0]==="BOUNDCRS"||t[0]==="PROJCRS"||t[0]==="GEOGCRS","2015")}function Gut(t){return(Uut(t)==="2019"?zut:Vut).convert(t)}function But(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var nA=1,Ewe=2,Swe=3,mN=4,Twe=5,aH=-1,Wut=/\s/,Hut=/[A-Za-z]/,qut=/[A-Za-z84_]/,QO=/[,\]]/,kwe=/[\d\.E\-\+]/;function bp(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=nA}bp.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==mN)for(;Wut.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case nA:return this.neutral(t);case Ewe:return this.keyword(t);case mN:return this.quoted(t);case Twe:return this.afterquote(t);case Swe:return this.number(t);case aH:return}};bp.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=mN;return}if(QO.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};bp.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=nA;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=nA,this.currentObject=this.stack.pop(),this.currentObject||(this.state=aH);return}};bp.prototype.number=function(t){if(kwe.test(t)){this.word+=t;return}if(QO.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};bp.prototype.quoted=function(t){if(t==='"'){this.state=Twe;return}this.word+=t};bp.prototype.keyword=function(t){if(qut.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=nA;return}if(QO.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};bp.prototype.neutral=function(t){if(Hut.test(t)){this.word=t,this.state=Ewe;return}if(t==='"'){this.word="",this.state=mN;return}if(kwe.test(t)){this.word=t,this.state=Swe;return}if(QO.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};bp.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===aH)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Kut(t){var e=new bp(t);return e.output()}function x8(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce(function(s,o){return Rx(o,s),s},r);e&&(t[e]=i)}function Rx(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},Rx(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&Rx(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&Rx(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],x8(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],x8(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Rx(t,e[n]);return x8(e,n,t)}}var Yut=.017453292519943295;function Vu(t){return t*Yut}function Awe(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");!t.long0&&t.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(t.lat0=Vu(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1):!t.lat_ts&&t.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(t.lat_ts=t.lat0,t.lat0=Vu(t.lat0>0?90:-90),delete t.lat1)}function fse(t){let e={units:null,to_meter:void 0};return typeof t=="string"?(e.units=t.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function pse(t){return typeof t=="object"?t.value*t.unit.conversion_factor:t}function mse(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=pse(t.ellipsoid.semi_major_axis),t.ellipsoid.inverse_flattening!==void 0?e.rf=t.ellipsoid.inverse_flattening:t.ellipsoid.semi_major_axis!==void 0&&t.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-pse(t.ellipsoid.semi_minor_axis))))}function gN(t,e={}){return!t||typeof t!="object"?t:t.type==="BoundCRS"?(gN(t.source_crs,e),t.transformation&&(t.transformation.method&&t.transformation.method.name==="NTv2"?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(n=>n.value)),e):(Object.keys(t).forEach(n=>{const r=t[n];if(r!==null)switch(n){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,mse(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,mse(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=fse(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=fse(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),o=i.value;i.unit&&i.unit.conversion_factor?e[s]=o*i.unit.conversion_factor:i.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":gN(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),Awe(e),e)}var Xut=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Zut(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function Iwe(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var i=e[n];Xut.indexOf(i)!==-1&&Jut(t[i]),typeof t[i]=="object"&&Iwe(t[i])}}function Jut(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,i=t.AXIS.length;r<i;++r){var s=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?n+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?n+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?n+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;t.type==="GEOGCS"&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=Vu(t.rectified_grid_angle));function a(u){var h=t.to_meter||1;return u*h}var l=function(u){return Zut(t,u)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Vu],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Vu],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Vu],["lat0","latitude_of_origin",Vu],["lat0","standard_parallel_1",Vu],["lat1","standard_parallel_1",Vu],["lat2","standard_parallel_2",Vu],["azimuth","Azimuth"],["alpha","azimuth",Vu],["srsCode","name"]];c.forEach(l),Awe(t)}function yN(t){if(typeof t=="object")return gN(t);const e=But(t);var n=Kut(t);if(e==="WKT2"){const s=Gut(n);return gN(s)}var r=n[0],i={};return Rx(n,i),Iwe(i),i[r]}function Eo(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?Eo[t]=zV(arguments[1]):Eo[t]=yN(arguments[1]):n&&typeof n=="object"&&!("projName"in n)?Eo[t]=yN(arguments[1]):(Eo[t]=n,n||delete Eo[t])}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){return Array.isArray(r)?Eo.apply(e,r):Eo(r)});if(typeof t=="string"){if(t in Eo)return Eo[t]}else"EPSG"in t?Eo["EPSG:"+t.EPSG]=t:"ESRI"in t?Eo["ESRI:"+t.ESRI]=t:"IAU2000"in t?Eo["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Nut(Eo);function Qut(t){return typeof t=="string"}function eht(t){return t in Eo}function tht(t){return t.indexOf("+")!==0&&t.indexOf("[")!==-1||typeof t=="object"&&!("srsCode"in t)}var nht=["3857","900913","3785","102113"];function rht(t){var e=zg(t,"authority");if(e){var n=zg(e,"epsg");return n&&nht.indexOf(n)>-1}}function iht(t){var e=zg(t,"extension");if(e)return zg(e,"proj4")}function sht(t){return t[0]==="+"}function oht(t){if(Qut(t)){if(eht(t))return Eo[t];if(tht(t)){var e=yN(t);if(rht(e))return Eo["EPSG:3857"];var n=iht(e);return n?zV(n):e}if(sht(t))return zV(t)}else return"projName"in t?t:yN(t)}function gse(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Pd(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function RI(t){return t<0?-1:1}function It(t,e){return e||Math.abs(t)<=ls?t:t-RI(t)*tA}function ih(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(st-e))/r}function rA(t,e){for(var n=.5*t,r,i,s=st-2*Math.atan(e),o=0;o<=15;o++)if(r=t*Math.sin(s),i=st-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function aht(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Pd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function lht(t){var e=t.x,n=t.y;if(n*yl>90&&n*yl<-90&&e*yl>180&&e*yl<-180)return null;var r,i;if(Math.abs(Math.abs(n)-st)<=wt)return null;if(this.sphere)r=this.x0+this.a*this.k0*It(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Pr+.5*n));else{var s=Math.sin(n),o=ih(this.e,n,s);r=this.x0+this.a*this.k0*It(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=r,t.y=i,t}function cht(t){var e=t.x-this.x0,n=t.y-this.y0,r,i;if(this.sphere)i=st-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var s=Math.exp(-n/(this.a*this.k0));if(i=rA(this.e,s),i===-9999)return null}return r=It(this.long0+e/(this.a*this.k0),this.over),t.x=r,t.y=i,t}var uht=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const hht={init:aht,forward:lht,inverse:cht,names:uht};function dht(){}function yse(t){return t}var Rwe=["longlat","identity"];const fht={init:dht,forward:yse,inverse:yse,names:Rwe};var pht=[hht,fht],cy={},Px=[];function Pwe(t,e){var n=Px.length;return t.names?(Px[n]=t,t.names.forEach(function(r){cy[r.toLowerCase()]=n}),this):(console.log(e),!0)}function Cwe(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function mht(t){if(!t)return!1;var e=t.toLowerCase();if(typeof cy[e]<"u"&&Px[cy[e]]||(e=Cwe(e),e in cy&&Px[cy[e]]))return Px[cy[e]]}function ght(){pht.forEach(Pwe)}const yht={start:ght,add:Pwe,get:mht};var Mwe={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const vht=Mwe.WGS84;function _ht(t,e,n,r){var i=t*t,s=e*e,o=(i-s)/i,a=0;r?(t*=1-o*(Dut+o*($ut+o*jut)),i=t*t,o=0):a=Math.sqrt(o);var l=(i-s)/s;return{es:o,e:a,ep2:l}}function xht(t,e,n,r,i){if(!t){var s=zg(Mwe,r);s||(s=vht),t=s.a,e=s.b,n=s.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<wt)&&(i=!0,e=t),{a:t,b:e,rf:n,sphere:i}}var KM={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var wht in KM){var w8=KM[wht];w8.datumName&&(KM[w8.datumName]=w8)}function bht(t,e,n,r,i,s,o){var a={};return t===void 0||t==="none"?a.datum_type=VV:a.datum_type=Out,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=z1),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=U1,a.datum_params[3]*=kT,a.datum_params[4]*=kT,a.datum_params[5]*=kT,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=ow,a.grids=o),a.a=n,a.b=r,a.es=i,a.ep2=s,a}var lH={};function Eht(t,e,n){return e instanceof ArrayBuffer?Sht(t,e,n):{ready:Tht(t,e)}}function Sht(t,e,n){var r=!0;n!==void 0&&n.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Iht(i),o=Rht(i,s),a=Pht(i,o,s,r),l={header:o,subgrids:a};return lH[t]=l,l}async function Tht(t,e){for(var n=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),o=await s.readRasters(),a=o,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(vse),u=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(vse),h=c[0]+(l[0]-1)*u[0],f=c[3]-(l[1]-1)*u[1],g=a[0],v=a[1],x=[];for(let A=l[1]-1;A>=0;A--)for(let I=l[0]-1;I>=0;I--){var b=A*l[0]+I;x.push([-ng(v[b]),ng(g[b])])}n.push({del:u,lim:l,ll:[-h,f],cvs:x})}var T={header:{nSubgrids:r},subgrids:n};return lH[t]=T,T}function kht(t){if(t===void 0)return null;var e=t.split(",");return e.map(Aht)}function Aht(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:lH[t]||null,isNull:!1}}function vse(t){return t*Math.PI/180}function ng(t){return t/3600*Math.PI/180}function Iht(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function Rht(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:UV(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function UV(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Pht(t,e,n,r){for(var i=176,s=[],o=0;o<e.nSubgrids;o++){var a=Mht(t,i,n),l=Nht(t,i,a,n,r),c=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),u=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[ng(a.lowerLongitude),ng(a.lowerLatitude)],del:[ng(a.longitudeInterval),ng(a.latitudeInterval)],lim:[c,u],count:a.gridNodeCount,cvs:Cht(l)});var h=16;r===!1&&(h=8),i+=176+a.gridNodeCount*h}return s}function Cht(t){return t.map(function(e){return[ng(e.longitudeShift),ng(e.latitudeShift)]})}function Mht(t,e,n){return{name:UV(t,e+8,e+16).trim(),parent:UV(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Nht(t,e,n,r,i){var s=e+176,o=16;i===!1&&(o=8);for(var a=[],l=0;l<n.gridNodeCount;l++){var c={latitudeShift:t.getFloat32(s+l*o,r),longitudeShift:t.getFloat32(s+l*o+4,r)};i!==!1&&(c.latitudeAccuracy=t.getFloat32(s+l*o+8,r),c.longitudeAccuracy=t.getFloat32(s+l*o+12,r)),a.push(c)}return a}function ru(t,e){if(!(this instanceof ru))return new ru(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var n=oht(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=ru.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var i=zg(KM,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var s=xht(n.a,n.b,n.rf,n.ellps,n.sphere),o=_ht(s.a,s.b,s.rf,n.R_A),a=kht(n.nadgrids),l=n.datum||bht(n.datumCode,n.datum_params,s.a,s.b,o.es,o.ep2,a);gse(this,n),gse(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}ru.projections=yht;ru.projections.start();function Oht(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===z1?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===U1?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function Nwe(t,e,n){var r=t.x,i=t.y,s=t.z?t.z:0,o,a,l,c;if(i<-st&&i>-1.001*st)i=-st;else if(i>st&&i<1.001*st)i=st;else{if(i<-st)return{x:-1/0,y:-1/0,z:t.z};if(i>st)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),a=Math.sin(i),c=Math.cos(i),l=a*a,o=n/Math.sqrt(1-e*l),{x:(o+s)*c*Math.cos(r),y:(o+s)*c*Math.sin(r),z:(o*(1-e)+s)*a}}function Owe(t,e,n,r){var i=1e-12,s=i*i,o=30,a,l,c,u,h,f,g,v,x,b,T,A,I,R=t.x,M=t.y,F=t.z?t.z:0,C,N,O;if(a=Math.sqrt(R*R+M*M),l=Math.sqrt(R*R+M*M+F*F),a/n<i){if(C=0,l/n<i)return N=st,O=-r,{x:t.x,y:t.y,z:t.z}}else C=Math.atan2(M,R);c=F/l,u=a/l,h=1/Math.sqrt(1-e*(2-e)*u*u),v=u*(1-e)*h,x=c*h,I=0;do I++,g=n/Math.sqrt(1-e*x*x),O=a*v+F*x-g*(1-e*x*x),f=e*g/(g+O),h=1/Math.sqrt(1-f*(2-f)*u*u),b=u*(1-f)*h,T=c*h,A=T*v-b*x,v=b,x=T;while(A*A>s&&I<o);return N=Math.atan(T/Math.abs(b)),{x:C,y:N,z:O}}function Lht(t,e,n){if(e===z1)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===U1){var r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+a*t.z)+r,y:c*(l*t.x+t.y-o*t.z)+i,z:c*(-a*t.x+o*t.y+t.z)+s}}}function Dht(t,e,n){if(e===z1)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===U1){var r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=(t.x-r)/c,h=(t.y-i)/c,f=(t.z-s)/c;return{x:u+l*h-a*f,y:-l*u+h+o*f,z:a*u-o*h+f}}}function sC(t){return t===z1||t===U1}function $ht(t,e,n){if(Oht(t,e)||t.datum_type===VV||e.datum_type===VV)return n;var r=t.a,i=t.es;if(t.datum_type===ow){var s=_se(t,!1,n);if(s!==0)return;r=use,i=hse}var o=e.a,a=e.b,l=e.es;if(e.datum_type===ow&&(o=use,a=Lut,l=hse),i===l&&r===o&&!sC(t.datum_type)&&!sC(e.datum_type))return n;if(n=Nwe(n,i,r),sC(t.datum_type)&&(n=Lht(n,t.datum_type,t.datum_params)),sC(e.datum_type)&&(n=Dht(n,e.datum_type,e.datum_params)),n=Owe(n,l,o,a),e.datum_type===ow){var c=_se(e,!0,n);if(c!==0)return}return n}function _se(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<t.grids.length;o++){var a=t.grids[o];if(s.push(a.name),a.isNull){i=r;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var l=a.grid.subgrids,c=0,u=l.length;c<u;c++){var h=l[c],f=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,g=h.ll[0]-f,v=h.ll[1]-f,x=h.ll[0]+(h.lim[0]-1)*h.del[0]+f,b=h.ll[1]+(h.lim[1]-1)*h.del[1]+f;if(!(v>r.y||g>r.x||b<r.y||x<r.x)&&(i=jht(r,e,h),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*yl+" "+r.y*yl+" tried: '"+s+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function jht(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var i={x:t.x,y:t.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=It(i.x-Math.PI)+Math.PI;var s=xse(i,n);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var o=9,a=1e-12,l,c;do{if(c=xse(s,n),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(o--&&Math.abs(l.x)>a&&Math.abs(l.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=It(s.x+n.ll[0]),r.y=s.y+n.ll[1]}else isNaN(s.x)||(r.x=t.x+s.x,r.y=t.y+s.y);return r}function xse(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},s={x:Number.NaN,y:Number.NaN},o;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;o=r.y*e.lim[0]+r.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var l={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var c={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var u={x:e.cvs[o][0],y:e.cvs[o][1]},h=i.x*i.y,f=i.x*(1-i.y),g=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=g*a.x+f*l.x+v*u.x+h*c.x,s.y=g*a.y+f*l.y+v*u.y+h*c.y,s}function wse(t,e,n){var r=n.x,i=n.y,s=n.z||0,o,a,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&n.z===void 0))switch(l===0?(o=r,"ew".indexOf(t.axis[l])!==-1?a="x":a="y"):l===1?(o=i,"ns".indexOf(t.axis[l])!==-1?a="y":a="x"):(o=s,a="z"),t.axis[l]){case"e":c[a]=o;break;case"w":c[a]=-o;break;case"n":c[a]=o;break;case"s":c[a]=-o;break;case"u":n[a]!==void 0&&(c.z=o);break;case"d":n[a]!==void 0&&(c.z=-o);break;default:return null}return c}function Lwe(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Fht(t){bse(t.x),bse(t.y)}function bse(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Vht(t,e){return(t.datum.datum_type===z1||t.datum.datum_type===U1||t.datum.datum_type===ow)&&e.datumCode!=="WGS84"||(e.datum.datum_type===z1||e.datum.datum_type===U1||e.datum.datum_type===ow)&&t.datumCode!=="WGS84"}function vN(t,e,n,r){var i;Array.isArray(n)?n=Lwe(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var s=n.z!==void 0;if(Fht(n),t.datum&&e.datum&&Vht(t,e)&&(i=new ru("WGS84"),n=vN(t,i,n,r),t=i),r&&t.axis!=="enu"&&(n=wse(t,!1,n)),t.projName==="longlat")n={x:n.x*Hi,y:n.y*Hi,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=$ht(t.datum,e.datum,n),!!n)return n=n,e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*yl,y:n.y*yl,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?wse(e,!0,n):(n&&!s&&delete n.z,n)}var Ese=ru("WGS84");function b8(t,e,n,r){var i,s,o;return Array.isArray(n)?(i=vN(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(s=vN(t,e,n,r),o=Object.keys(n),o.length===2||o.forEach(function(a){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=n[a]}),s)}function oC(t){return t instanceof ru?t:typeof t=="object"&&"oProj"in t?t.oProj:ru(t)}function zht(t,e,n){var r,i,s=!1,o;return typeof e>"u"?(i=oC(t),r=Ese,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,i=oC(t),r=Ese,s=!0),r||(r=oC(t)),i||(i=oC(e)),n?b8(r,i,n):(o={forward:function(a,l){return b8(r,i,a,l)},inverse:function(a,l){return b8(i,r,a,l)}},s&&(o.oProj=i),o)}var Sse=6,Dwe="AJSAJS",$we="AFAFAF",Cx=65,Za=73,Lc=79,CS=86,MS=90;const Uht={forward:jwe,inverse:Ght,toPoint:Fwe};function jwe(t,e){return e=e||5,Hht(Bht({lat:t[1],lon:t[0]}),e)}function Ght(t){var e=cH(zwe(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function Fwe(t){var e=cH(zwe(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function E8(t){return t*(Math.PI/180)}function Tse(t){return 180*(t/Math.PI)}function Bht(t){var e=t.lat,n=t.lon,r=6378137,i=.00669438,s=.9996,o,a,l,c,u,h,f,g=E8(e),v=E8(n),x,b;b=Math.floor((n+180)/6)+1,n===180&&(b=60),e>=56&&e<64&&n>=3&&n<12&&(b=32),e>=72&&e<84&&(n>=0&&n<9?b=31:n>=9&&n<21?b=33:n>=21&&n<33?b=35:n>=33&&n<42&&(b=37)),o=(b-1)*6-180+3,x=E8(o),a=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(g)*Math.sin(g)),c=Math.tan(g)*Math.tan(g),u=a*Math.cos(g)*Math.cos(g),h=Math.cos(g)*(v-x),f=r*((1-i/4-3*i*i/64-5*i*i*i/256)*g-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*g)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*g)-35*i*i*i/3072*Math.sin(6*g));var T=s*l*(h+(1-c+u)*h*h*h/6+(5-18*c+c*c+72*u-58*a)*h*h*h*h*h/120)+5e5,A=s*(f+l*Math.tan(g)*(h*h/2+(5-c+9*u+4*u*u)*h*h*h*h/24+(61-58*c+c*c+600*u-330*a)*h*h*h*h*h*h/720));return e<0&&(A+=1e7),{northing:Math.round(A),easting:Math.round(T),zoneNumber:b,zoneLetter:Wht(e)}}function cH(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var s=.9996,o=6378137,a=.00669438,l,c=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),u,h,f,g,v,x,b,T,A,I=n-5e5,R=e;r<"N"&&(R-=1e7),b=(i-1)*6-180+3,l=a/(1-a),x=R/s,T=x/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),A=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),u=o/Math.sqrt(1-a*Math.sin(A)*Math.sin(A)),h=Math.tan(A)*Math.tan(A),f=l*Math.cos(A)*Math.cos(A),g=o*(1-a)/Math.pow(1-a*Math.sin(A)*Math.sin(A),1.5),v=I/(u*s);var M=A-u*Math.tan(A)/g*(v*v/2-(5+3*h+10*f-4*f*f-9*l)*v*v*v*v/24+(61+90*h+298*f+45*h*h-252*l-3*f*f)*v*v*v*v*v*v/720);M=Tse(M);var F=(v-(1+2*h+f)*v*v*v/6+(5-2*f+28*h-3*f*f+8*l+24*h*h)*v*v*v*v*v/120)/Math.cos(A);F=b+Tse(F);var C;if(t.accuracy){var N=cH({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});C={top:N.lat,right:N.lon,bottom:M,left:F}}else C={lat:M,lon:F};return C}function Wht(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Hht(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+qht(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function qht(t,e,n){var r=Vwe(n),i=Math.floor(t/1e5),s=Math.floor(e/1e5)%20;return Kht(i,s,r)}function Vwe(t){var e=t%Sse;return e===0&&(e=Sse),e}function Kht(t,e,n){var r=n-1,i=Dwe.charCodeAt(r),s=$we.charCodeAt(r),o=i+t-1,a=s+e,l=!1;o>MS&&(o=o-MS+Cx-1,l=!0),(o===Za||i<Za&&o>Za||(o>Za||i<Za)&&l)&&o++,(o===Lc||i<Lc&&o>Lc||(o>Lc||i<Lc)&&l)&&(o++,o===Za&&o++),o>MS&&(o=o-MS+Cx-1),a>CS?(a=a-CS+Cx-1,l=!0):l=!1,(a===Za||s<Za&&a>Za||(a>Za||s<Za)&&l)&&a++,(a===Lc||s<Lc&&a>Lc||(a>Lc||s<Lc)&&l)&&(a++,a===Za&&a++),a>CS&&(a=a-CS+Cx-1);var c=String.fromCharCode(o)+String.fromCharCode(a);return c}function zwe(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",i,s=0;!/[A-Z]/.test(i=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=i,s++}var o=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(s,s+=2);for(var l=Vwe(o),c=Yht(n.charAt(0),l),u=Xht(n.charAt(1),l);u<Zht(a);)u+=2e6;var h=e-s;if(h%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var f=h/2,g=0,v=0,x,b,T,A,I;return f>0&&(x=1e5/Math.pow(10,f),b=t.substring(s,s+f),g=parseFloat(b)*x,T=t.substring(s+f),v=parseFloat(T)*x),A=g+c,I=v+u,{easting:A,northing:I,zoneLetter:a,zoneNumber:o,accuracy:x}}function Yht(t,e){for(var n=Dwe.charCodeAt(e-1),r=1e5,i=!1;n!==t.charCodeAt(0);){if(n++,n===Za&&n++,n===Lc&&n++,n>MS){if(i)throw"Bad character: "+t;n=Cx,i=!0}r+=1e5}return r}function Xht(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=$we.charCodeAt(e-1),r=0,i=!1;n!==t.charCodeAt(0);){if(n++,n===Za&&n++,n===Lc&&n++,n>CS){if(i)throw"Bad character: "+t;n=Cx,i=!0}r+=1e5}return r}function Zht(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function A2(t,e,n){if(!(this instanceof A2))return new A2(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}A2.fromMGRS=function(t){return new A2(Fwe(t))};A2.prototype.toMGRS=function(t){return jwe([this.x,this.y],t)};var Jht=1,Qht=.25,kse=.046875,Ase=.01953125,Ise=.01068115234375,edt=.75,tdt=.46875,ndt=.013020833333333334,rdt=.007120768229166667,idt=.3645833333333333,sdt=.005696614583333333,odt=.3076171875;function uH(t){var e=[];e[0]=Jht-t*(Qht+t*(kse+t*(Ase+t*Ise))),e[1]=t*(edt-t*(kse+t*(Ase+t*Ise)));var n=t*t;return e[2]=n*(tdt-t*(ndt+t*rdt)),n*=t,e[3]=n*(idt-t*sdt),e[4]=n*t*odt,e}function ub(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var adt=20;function hH(t,e,n){for(var r=1/(1-e),i=t,s=adt;s;--s){var o=Math.sin(i),a=1-e*o*o;if(a=(ub(i,o,Math.cos(i),n)-t)*(a*Math.sqrt(a))*r,i-=a,Math.abs(a)<wt)return i}return i}function ldt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=uH(this.es),this.ml0=ub(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function cdt(t){var e=t.x,n=t.y,r=It(e-this.long0,this.over),i,s,o,a=Math.sin(n),l=Math.cos(n);if(this.es){var u=l*r,h=Math.pow(u,2),f=this.ep2*Math.pow(l,2),g=Math.pow(f,2),v=Math.abs(l)>wt?Math.tan(n):0,x=Math.pow(v,2),b=Math.pow(x,2);i=1-this.es*Math.pow(a,2),u=u/Math.sqrt(i);var T=ub(n,a,l,this.en);s=this.a*(this.k0*u*(1+h/6*(1-x+f+h/20*(5-18*x+b+14*f-58*x*f+h/42*(61+179*b-b*x-479*x)))))+this.x0,o=this.a*(this.k0*(T-this.ml0+a*r*u/2*(1+h/12*(5-x+9*f+4*g+h/30*(61+b-58*x+270*f-330*x*f+h/56*(1385+543*b-b*x-3111*x))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<wt)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,o=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(o),c>=1){if(c-1>wt)return 93;o=0}else o=Math.acos(o);n<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return t.x=s,t.y=o,t}function udt(t){var e,n,r,i,s=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,n=hH(e,this.es,this.en),Math.abs(n)<st){var h=Math.sin(n),f=Math.cos(n),g=Math.abs(f)>wt?Math.tan(n):0,v=this.ep2*Math.pow(f,2),x=Math.pow(v,2),b=Math.pow(g,2),T=Math.pow(b,2);e=1-this.es*Math.pow(h,2);var A=s*Math.sqrt(e)/this.k0,I=Math.pow(A,2);e=e*g,r=n-e*I/(1-this.es)*.5*(1-I/12*(5+3*b-9*v*b+v-4*x-I/30*(61+90*b-252*v*b+45*T+46*v-I/56*(1385+3633*b+4095*T+1574*T*b)))),i=It(this.long0+A*(1-I/6*(1+2*b+v-I/20*(5+28*b+24*T+8*v*b+6*v-I/42*(61+662*b+1320*T+720*T*b))))/f,this.over)}else r=st*RI(o),i=0;else{var a=Math.exp(s/this.k0),l=.5*(a-1/a),c=this.lat0+o/this.k0,u=Math.cos(c);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(l,2))),r=Math.asin(e),o<0&&(r=-r),l===0&&u===0?i=0:i=It(Math.atan2(l,u)+this.long0,this.over)}return t.x=i,t.y=r,t}var hdt=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const YM={init:ldt,forward:cdt,inverse:udt,names:hdt};function Uwe(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function fl(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function ddt(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function fdt(t){var e=Math.abs(t);return e=ddt(e*(1+e/(fl(1,e)+1))),t<0?-e:e}function dH(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,i=t[r],s=0,o;--r>=0;)o=-s+n*i+t[r],s=i,i=o;return e+o*Math.sin(2*e)}function pdt(t,e){for(var n=2*Math.cos(e),r=t.length-1,i=t[r],s=0,o;--r>=0;)o=-s+n*i+t[r],s=i,i=o;return Math.sin(e)*o}function mdt(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function Gwe(t,e,n){for(var r=Math.sin(e),i=Math.cos(e),s=Uwe(n),o=mdt(n),a=2*i*o,l=-2*r*s,c=t.length-1,u=t[c],h=0,f=0,g=0,v,x;--c>=0;)v=f,x=h,f=u,h=g,u=-v+a*f-l*h+t[c],g=-x+l*f+a*h;return a=r*o,l=i*s,[a*u-l*g,a*g+l*u]}function gdt(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(YM.init.apply(this),this.forward=YM.forward,this.inverse=YM.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=dH(this.cbg,this.lat0);this.Zb=-this.Qn*(r+pdt(this.gtu,2*r))}function ydt(t){var e=It(t.x-this.long0,this.over),n=t.y;n=dH(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),s=Math.sin(e),o=Math.cos(e);n=Math.atan2(r,o*i),e=Math.atan2(s*i,fl(r,i*o)),e=fdt(Math.tan(e));var a=Gwe(this.gtu,2*n,2*e);n=n+a[0],e=e+a[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*n+this.Zb)+this.y0):(l=1/0,c=1/0),t.x=l,t.y=c,t}function vdt(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=Gwe(this.utg,2*n,2*e);n=n+s[0],e=e+s[1],e=Math.atan(Uwe(e));var o=Math.sin(n),a=Math.cos(n),l=Math.sin(e),c=Math.cos(e);n=Math.atan2(o*c,fl(l,c*a)),e=Math.atan2(l,c*a),r=It(e+this.long0,this.over),i=dH(this.cgb,n)}else r=1/0,i=1/0;return t.x=r,t.y=i,t}var _dt=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const XM={init:gdt,forward:ydt,inverse:vdt,names:_dt};function xdt(t,e){if(t===void 0){if(t=Math.floor((It(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var wdt="etmerc";function bdt(){var t=xdt(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Hi,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,XM.init.apply(this),this.forward=XM.forward,this.inverse=XM.inverse}var Edt=["Universal Transverse Mercator System","utm"];const Sdt={init:bdt,names:Edt,dependsOn:wdt};function fH(t,e){return Math.pow((1-t)/(1+t),e)}var Tdt=20;function kdt(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Pr)/(Math.pow(Math.tan(.5*this.lat0+Pr),this.C)*fH(this.e*t,this.ratexp))}function Adt(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Pr),this.C)*fH(this.e*Math.sin(n),this.ratexp))-st,t.x=this.C*e,t}function Idt(t){for(var e=1e-14,n=t.x/this.C,r=t.y,i=Math.pow(Math.tan(.5*r+Pr)/this.K,1/this.C),s=Tdt;s>0&&(r=2*Math.atan(i*fH(this.e*Math.sin(t.y),-.5*this.e))-st,!(Math.abs(r-t.y)<e));--s)t.y=r;return s?(t.x=n,t.y=r,t):null}const pH={init:kdt,forward:Adt,inverse:Idt};function Rdt(){pH.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Pdt(t){var e,n,r,i;return t.x=It(t.x-this.long0,this.over),pH.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Cdt(t){var e,n,r,i,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=fl(t.x,t.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),n=Math.cos(o),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/s),r=Math.atan2(t.x*e,s*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,pH.inverse.apply(this,[t]),t.x=It(t.x+this.long0,this.over),t}var Mdt=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Ndt={init:Rdt,forward:Pdt,inverse:Cdt,names:Mdt};function mH(t,e,n){return e*=n,Math.tan(.5*(st+t))*Math.pow((1-e)/(1+e),.5*n)}function Odt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&(this.k0=.5*(1+RI(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=wt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&Math.abs(Math.cos(this.lat_ts))>wt&&(this.k0=.5*this.cons*Pd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ih(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Pd(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(mH(this.lat0,this.sinlat0,this.e))-st,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Ldt(t){var e=t.x,n=t.y,r=Math.sin(n),i=Math.cos(n),s,o,a,l,c,u,h=It(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=wt&&Math.abs(n+this.lat0)<=wt?(t.x=NaN,t.y=NaN,t):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(h)),t.x=this.a*s*i*Math.sin(h)+this.x0,t.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(h))+this.y0,t):(o=2*Math.atan(mH(n,r,this.e))-st,l=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=wt?(c=ih(this.e,n*this.con,this.con*r),u=2*this.a*this.k0*c/this.cons,t.x=this.x0+u*Math.sin(e-this.long0),t.y=this.y0-this.con*u*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<wt?(s=2*this.a*this.k0/(1+l*Math.cos(h)),t.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*l*Math.cos(h))),t.y=s*(this.cosX0*a-this.sinX0*l*Math.cos(h))+this.y0),t.x=s*l*Math.sin(h)+this.x0,t))}function Ddt(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,s,o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,n=this.lat0,o<=wt?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<wt?this.lat0>0?e=It(this.long0+Math.atan2(t.x,-1*t.y),this.over):e=It(this.long0+Math.atan2(t.x,t.y),this.over):e=It(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a)),this.over),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=wt){if(o<=wt)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=o*this.cons/(2*this.a*this.k0),n=this.con*rA(this.e,r),e=this.con*It(this.con*this.long0+Math.atan2(t.x,-1*t.y),this.over)}else i=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=wt?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/o),e=It(this.long0+Math.atan2(t.x*Math.sin(i),o*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)),this.over)),n=-1*rA(this.e,Math.tan(.5*(st+s)));return t.x=e,t.y=n,t}var $dt=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const jdt={init:Odt,forward:Ldt,inverse:Ddt,names:$dt,ssfn_:mH};function Fdt(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),o=this.e=Math.sqrt(s);this.R=this.k0*n*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),c=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*l+this.alpha*o/2*c}function Vdt(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t}function zdt(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+o/this.alpha,l=0,c=s,u=-1e3,h=0;Math.abs(c-u)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),u=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=c,t}var Udt=["somerc"];const Gdt={init:Fdt,forward:Vdt,inverse:zdt,names:Udt};var lx=1e-7;function Bdt(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.projName=="object"?Object.keys(t.projName)[0]:t.projName;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1||e.indexOf(Cwe(n))!==-1}function Wdt(){var t,e,n,r,i,s,o,a,l,c,u=0,h,f=0,g=0,v=0,x=0,b=0,T=0;this.no_off=Bdt(this),this.no_rot="no_rot"in this;var A=!1;"alpha"in this&&(A=!0);var I=!1;if("rectified_grid_angle"in this&&(I=!0),A&&(T=this.alpha),I&&(u=this.rectified_grid_angle),A||I)f=this.longc;else if(g=this.long1,x=this.lat1,v=this.long2,b=this.lat2,Math.abs(x-b)<=lx||(t=Math.abs(x))<=lx||Math.abs(t-st)<=lx||Math.abs(Math.abs(this.lat0)-st)<=lx||Math.abs(Math.abs(b)-st)<=lx)throw new Error;var R=1-this.es;e=Math.sqrt(R),Math.abs(this.lat0)>wt?(a=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*a*a,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/R),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(ih(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),A||I?(A?(h=Math.asin(Math.sin(T)/r),I||(u=T)):(h=u,T=Math.asin(r*Math.sin(h))),this.lam0=f-Math.asin(.5*(i-1/i)*Math.tan(h))/this.B):(s=Math.pow(ih(this.e,x,Math.sin(x)),this.B),o=Math.pow(ih(this.e,b,Math.sin(b)),this.B),i=this.E/s,l=(o-s)/(o+s),c=this.E*this.E,c=(c-o*s)/(c+o*s),t=g-v,t<-Math.PI?v-=tA:t>Math.PI&&(v+=tA),this.lam0=It(.5*(g+v)-Math.atan(c*Math.tan(.5*this.B*(g-v))/l)/this.B,this.over),h=Math.atan(2*Math.sin(this.B*It(g-this.lam0,this.over))/(i-1/i)),u=T=Math.asin(r*Math.sin(h))),this.singam=Math.sin(h),this.cosgam=Math.cos(h),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*h,this.v_pole_n=this.ArB*Math.log(Math.tan(Pr-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Pr+i))}function Hdt(t){var e={},n,r,i,s,o,a,l,c;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-st)>wt){if(o=this.E/Math.pow(ih(this.e,t.y,Math.sin(t.y)),this.B),a=1/o,n=.5*(o-a),r=.5*(o+a),s=Math.sin(this.B*t.x),i=(n*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<wt)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),a=Math.cos(this.B*t.x),Math.abs(a)<lx?l=this.A*t.x:l=this.ArB*Math.atan2(n*this.cosgam+s*this.singam,a)}else c=t.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*t.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function qdt(t){var e,n,r,i,s,o,a,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),s=.5*(r+1/r),o=Math.sin(this.BrA*e),a=(o*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(a)-1)<wt)l.x=0,l.y=a<0?-st:st;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=rA(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Kdt=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Ydt={init:Wdt,forward:Hdt,inverse:qdt,names:Kdt};function Xdt(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<wt)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Pd(this.e,e,n),i=ih(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Pd(this.e,s,o),l=ih(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-st)<wt?0:ih(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>wt?this.ns=Math.log(r/a)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Zdt(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=wt&&(n=RI(n)*(st-2*wt));var r=Math.abs(Math.abs(n)-st),i,s;if(r>wt)i=ih(this.e,n,Math.sin(n)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;s=0}var o=this.ns*It(e-this.long0,this.over);return t.x=this.k0*(s*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,t}function Jdt(t){var e,n,r,i,s,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),n=1):(e=-Math.sqrt(o*o+a*a),n=-1);var l=0;if(e!==0&&(l=Math.atan2(n*o,n*a)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),i=rA(this.e,r),i===-9999)return null}else i=-st;return s=It(l/this.ns+this.long0,this.over),t.x=s,t.y=i,t}var Qdt=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const eft={init:Xdt,forward:Zdt,inverse:Jdt,names:Qdt};function tft(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function nft(t){var e,n,r,i,s,o,a,l=t.x,c=t.y,u=It(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-u*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),s=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t}function rft(t){var e,n,r,i,s,o,a,l,c=t.x;t.x=t.y,t.y=c,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e,l=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(l=1),a=t.y,u+=1;while(l===0&&u<15);return u>=15?null:t}var ift=["Krovak","krovak"];const sft={init:tft,forward:nft,inverse:rft,names:ift};function Na(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function PI(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function CI(t){return .375*t*(1+.25*t*(1+.46875*t))}function MI(t){return .05859375*t*t*(1+.75*t)}function NI(t){return t*t*t*(35/3072)}function gH(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function e0(t){return Math.abs(t)<st?t:t-RI(t)*Math.PI}function _N(t,e,n,r,i){var s,o;s=t/e;for(var a=0;a<15;a++)if(o=(t-(e*s-n*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*n*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function oft(){this.sphere||(this.e0=PI(this.es),this.e1=CI(this.es),this.e2=MI(this.es),this.e3=NI(this.es),this.ml0=this.a*Na(this.e0,this.e1,this.e2,this.e3,this.lat0))}function aft(t){var e,n,r=t.x,i=t.y;if(r=It(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),o=Math.cos(i),a=gH(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),u=c*c,h=this.es*o*o/(1-this.es),f=this.a*Na(this.e0,this.e1,this.e2,this.e3,i);e=a*c*(1-u*l*(1/6-(8-l+8*h)*u/120)),n=f-this.ml0+a*s/o*u*(.5+(5-l+6*h)*u/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function lft(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i;if(this.sphere){var s=n+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+n,a=_N(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-st)<=wt)return t.x=this.long0,t.y=st,n<0&&(t.y*=-1),t;var l=gH(this.a,this.e,Math.sin(a)),c=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),h=e*this.a/l,f=h*h;r=a-l*Math.tan(a)/c*h*h*(.5-(1+3*u)*h*h/24),i=h*(1-f*(u/3+(1+3*u)*u*f/15))/Math.cos(a)}return t.x=It(i+this.long0,this.over),t.y=e0(r),t}var cft=["Cassini","Cassini_Soldner","cass"];const uft={init:oft,forward:aft,inverse:lft,names:cft};function _g(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var GV=1,BV=2,WV=3,ZM=4;function hft(){var t=Math.abs(this.lat0);if(Math.abs(t-st)<wt?this.mode=this.lat0<0?GV:BV:Math.abs(t)<wt?this.mode=WV:this.mode=ZM,this.es>0){var e;switch(this.qp=_g(this.e,1),this.mmf=.5/(1-this.es),this.apa=xft(this.es),this.mode){case BV:this.dd=1;break;case GV:this.dd=1;break;case WV:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case ZM:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=_g(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===ZM&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function dft(t){var e,n,r,i,s,o,a,l,c,u,h=t.x,f=t.y;if(h=It(h-this.long0,this.over),this.sphere){if(s=Math.sin(f),u=Math.cos(f),r=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+u*r:1+this.sinph0*s+this.cosph0*u*r,n<=wt)return null;n=Math.sqrt(2/n),e=n*u*Math.sin(h),n*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*u*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(f+this.lat0)<wt)return null;n=Pr-f*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(h),n*=r}}else{switch(a=0,l=0,c=0,r=Math.cos(h),i=Math.sin(h),s=Math.sin(f),o=_g(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=st+f,o=this.qp-o;break;case this.S_POLE:c=f-st,o=this.qp+o;break}if(Math.abs(c)<wt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?n=this.ymf*c*(this.cosb1*a-this.sinb1*l*r):n=(c=Math.sqrt(2/(1+l*r)))*a*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(c=Math.sqrt(o))*i,n=r*(this.mode===this.S_POLE?c:-c)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function fft(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i,s,o,a,l,c;if(this.sphere){var u=0,h,f=0;if(h=Math.sqrt(e*e+n*n),i=h*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(i),u=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(h)<=wt?0:Math.asin(n*f/h),e*=f,n=u*h;break;case this.OBLIQ:i=Math.abs(h)<=wt?this.lat0:Math.asin(u*this.sinph0+n*f*this.cosph0/h),e*=f*this.cosph0,n=(u-Math.sin(i)*this.sinph0)*h;break;case this.N_POLE:n=-n,i=st-i;break;case this.S_POLE:i-=st;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,l=Math.sqrt(e*e+n*n),l<wt)return t.x=this.long0,t.y=this.lat0,t;o=2*Math.asin(.5*l/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(c=s*this.sinb1+n*o*this.cosb1/l,a=this.qp*c,n=l*this.cosb1*s-n*this.sinb1*o):(c=n*o/l,a=this.qp*c,n=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),a=e*e+n*n,!a)return t.x=this.long0,t.y=this.lat0,t;c=1-a/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,n),i=wft(Math.asin(c),this.apa)}return t.x=It(this.long0+r,this.over),t.y=i,t}var pft=.3333333333333333,mft=.17222222222222222,gft=.10257936507936508,yft=.06388888888888888,vft=.0664021164021164,_ft=.016415012942191543;function xft(t){var e,n=[];return n[0]=t*pft,e=t*t,n[0]+=e*mft,n[1]=e*yft,e*=t,n[0]+=e*gft,n[1]+=e*vft,n[2]=e*_ft,n}function wft(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var bft=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Eft={init:hft,forward:dft,inverse:fft,names:bft,S_POLE:GV,N_POLE:BV,EQUIT:WV,OBLIQ:ZM};function Ug(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function Sft(){Math.abs(this.lat1+this.lat2)<wt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Pd(this.e3,this.sin_po,this.cos_po),this.qs1=_g(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Pd(this.e3,this.sin_po,this.cos_po),this.qs2=_g(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=_g(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>wt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Tft(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=_g(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*It(e-this.long0,this.over),o=i*Math.sin(s)+this.x0,a=this.rh-i*Math.cos(s)+this.y0;return t.x=o,t.y=a,t}function kft(t){var e,n,r,i,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,o=this.phi1z(this.e3,n)),s=It(i/this.ns0+this.long0,this.over),t.x=s,t.y=o,t}function Aft(t,e){var n,r,i,s,o,a=Ug(.5*e);if(t<wt)return a;for(var l=t*t,c=1;c<=25;c++)if(n=Math.sin(a),r=Math.cos(a),i=t*n,s=1-i*i,o=.5*s*s/r*(e/(1-l)-n/s+.5/t*Math.log((1-i)/(1+i))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var Ift=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const Rft={init:Sft,forward:Tft,inverse:kft,names:Ift,phi1z:Aft};function Pft(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Cft(t){var e,n,r,i,s,o,a,l,c=t.x,u=t.y;return r=It(c-this.long0,this.over),e=Math.sin(u),n=Math.cos(u),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,s=1,o>0||Math.abs(o)<=wt?(a=this.x0+this.a*s*n*Math.sin(r)/o,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*n*i)/o):(a=this.x0+this.infinity_dist*n*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=l,t}function Mft(t){var e,n,r,i,s,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),o=Ug(r*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),s=It(this.long0+s,this.over)):(o=this.phic0,s=0),t.x=s,t.y=o,t}var Nft=["gnom"];const Oft={init:Pft,forward:Cft,inverse:Mft,names:Nft};function Lft(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*st:st;for(var r=Math.asin(.5*e),i,s,o,a,l=0;l<30;l++)if(s=Math.sin(r),o=Math.cos(r),a=t*s,i=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-s/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function Dft(){this.sphere||(this.k0=Pd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function $ft(t){var e=t.x,n=t.y,r,i,s=It(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var o=_g(this.e,Math.sin(n));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*o*.5/this.k0}return t.x=r,t.y=i,t}function jft(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=It(this.long0+t.x/this.a/Math.cos(this.lat_ts),this.over),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=Lft(this.e,2*t.y*this.k0/this.a),e=It(this.long0+t.x/(this.a*this.k0),this.over)),t.x=e,t.y=n,t}var Fft=["cea"];const Vft={init:Dft,forward:$ft,inverse:jft,names:Fft};function zft(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Uft(t){var e=t.x,n=t.y,r=It(e-this.long0,this.over),i=e0(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t}function Gft(t){var e=t.x,n=t.y;return t.x=It(this.long0+(e-this.x0)/(this.a*this.rc),this.over),t.y=e0(this.lat0+(n-this.y0)/this.a),t}var Bft=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Wft={init:zft,forward:Uft,inverse:Gft,names:Bft};var Rse=20;function Hft(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=PI(this.es),this.e1=CI(this.es),this.e2=MI(this.es),this.e3=NI(this.es),this.ml0=this.a*Na(this.e0,this.e1,this.e2,this.e3,this.lat0)}function qft(t){var e=t.x,n=t.y,r,i,s,o=It(e-this.long0,this.over);if(s=o*Math.sin(n),this.sphere)Math.abs(n)<=wt?(r=this.a*o,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(n),i=this.a*(e0(n-this.lat0)+(1-Math.cos(s))/Math.tan(n)));else if(Math.abs(n)<=wt)r=this.a*o,i=-1*this.ml0;else{var a=gH(this.a,this.e,Math.sin(n))/Math.tan(n);r=a*Math.sin(s),i=this.a*Na(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+a*(1-Math.cos(s))}return t.x=r+this.x0,t.y=i+this.y0,t}function Kft(t){var e,n,r,i,s,o,a,l,c;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=wt)e=It(r/this.a+this.long0,this.over),n=0;else{o=this.lat0+i/this.a,a=r*r/this.a/this.a+o*o,l=o;var u;for(s=Rse;s;--s)if(u=Math.tan(l),c=-1*(o*(l*u+1)-l-.5*(l*l+a)*u)/((l-o)/u-1),l+=c,Math.abs(c)<=wt){n=l;break}e=It(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(n),this.over)}else if(Math.abs(i+this.ml0)<=wt)n=0,e=It(this.long0+r/this.a,this.over);else{o=(this.ml0+i)/this.a,a=r*r/this.a/this.a+o*o,l=o;var h,f,g,v,x;for(s=Rse;s;--s)if(x=this.e*Math.sin(l),h=Math.sqrt(1-x*x)*Math.tan(l),f=this.a*Na(this.e0,this.e1,this.e2,this.e3,l),g=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=f/this.a,c=(o*(h*v+1)-v-.5*h*(v*v+a))/(this.es*Math.sin(2*l)*(v*v+a-2*o*v)/(4*h)+(o-v)*(h*g-2/Math.sin(2*l))-g),l-=c,Math.abs(c)<=wt){n=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=It(this.long0+Math.asin(r*h/this.a)/Math.sin(n),this.over)}return t.x=e,t.y=n,t}var Yft=["Polyconic","American_Polyconic","poly"];const Xft={init:Hft,forward:qft,inverse:Kft,names:Yft};function Zft(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Jft(t){var e,n=t.x,r=t.y,i=r-this.lat0,s=n-this.long0,o=i/kT*1e-5,a=s,l=1,c=0;for(e=1;e<=10;e++)l=l*o,c=c+this.A[e]*l;var u=c,h=a,f=1,g=0,v,x,b=0,T=0;for(e=1;e<=6;e++)v=f*u-g*h,x=g*u+f*h,f=v,g=x,b=b+this.B_re[e]*f-this.B_im[e]*g,T=T+this.B_im[e]*f+this.B_re[e]*g;return t.x=T*this.a+this.x0,t.y=b*this.a+this.y0,t}function Qft(t){var e,n=t.x,r=t.y,i=n-this.x0,s=r-this.y0,o=s/this.a,a=i/this.a,l=1,c=0,u,h,f=0,g=0;for(e=1;e<=6;e++)u=l*o-c*a,h=c*o+l*a,l=u,c=h,f=f+this.C_re[e]*l-this.C_im[e]*c,g=g+this.C_im[e]*l+this.C_re[e]*c;for(var v=0;v<this.iterations;v++){var x=f,b=g,T,A,I=o,R=a;for(e=2;e<=6;e++)T=x*f-b*g,A=b*f+x*g,x=T,b=A,I=I+(e-1)*(this.B_re[e]*x-this.B_im[e]*b),R=R+(e-1)*(this.B_im[e]*x+this.B_re[e]*b);x=1,b=0;var M=this.B_re[1],F=this.B_im[1];for(e=2;e<=6;e++)T=x*f-b*g,A=b*f+x*g,x=T,b=A,M=M+e*(this.B_re[e]*x-this.B_im[e]*b),F=F+e*(this.B_im[e]*x+this.B_re[e]*b);var C=M*M+F*F;f=(I*M+R*F)/C,g=(R*M-I*F)/C}var N=f,O=g,j=1,V=0;for(e=1;e<=9;e++)j=j*N,V=V+this.D[e]*j;var W=this.lat0+V*kT*1e5,U=this.long0+O;return t.x=U,t.y=W,t}var ept=["New_Zealand_Map_Grid","nzmg"];const tpt={init:Zft,forward:Jft,inverse:Qft,names:ept};function npt(){}function rpt(t){var e=t.x,n=t.y,r=It(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=s,t}function ipt(t){t.x-=this.x0,t.y-=this.y0;var e=It(this.long0+t.x/this.a,this.over),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var spt=["Miller_Cylindrical","mill"];const opt={init:npt,forward:rpt,inverse:ipt,names:spt};var apt=20;function lpt(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=uH(this.es)}function cpt(t){var e,n,r=t.x,i=t.y;if(r=It(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),o=apt;o;--o){var a=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<wt)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);n=this.a*ub(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t}function upt(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Ug((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Ug(Math.sin(e)/this.n)),r=It(r+this.long0,this.over),e=e0(e)):(e=hH(t.y/this.a,this.es,this.en),i=Math.abs(e),i<st?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=It(n,this.over)):i-wt<st&&(r=this.long0)),t.x=r,t.y=e,t}var hpt=["Sinusoidal","sinu"];const dpt={init:lpt,forward:cpt,inverse:upt,names:hpt};function fpt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function ppt(t){for(var e=t.x,n=t.y,r=It(e-this.long0,this.over),i=n,s=Math.PI*Math.sin(n);;){var o=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=o,Math.abs(o)<wt)break}i/=2,Math.PI/2-Math.abs(n)<wt&&(r=0);var a=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=a,t.y=l,t}function mpt(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=It(this.long0+t.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t}var gpt=["Mollweide","moll"];const ypt={init:fpt,forward:ppt,inverse:mpt,names:gpt};function vpt(){Math.abs(this.lat1+this.lat2)<wt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=PI(this.es),this.e1=CI(this.es),this.e2=MI(this.es),this.e3=NI(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Pd(this.e,this.sin_phi,this.cos_phi),this.ml1=Na(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<wt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Pd(this.e,this.sin_phi,this.cos_phi),this.ml2=Na(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Na(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function _pt(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=Na(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var s=this.ns*It(e-this.long0,this.over),o=this.x0+r*Math.sin(s),a=this.y0+this.rh-r*Math.cos(s);return t.x=o,t.y=a,t}function xpt(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,i;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;if(n!==0&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=It(this.long0+s/this.ns,this.over),r=e0(this.g-n/this.a),t.x=i,t.y=r,t;var o=this.g-n/this.a;return r=_N(o,this.e0,this.e1,this.e2,this.e3),i=It(this.long0+s/this.ns,this.over),t.x=i,t.y=r,t}var wpt=["Equidistant_Conic","eqdc"];const bpt={init:vpt,forward:_pt,inverse:xpt,names:wpt};function Ept(){this.R=this.a}function Spt(t){var e=t.x,n=t.y,r=It(e-this.long0,this.over),i,s;Math.abs(n)<=wt&&(i=this.x0+this.R*r,s=this.y0);var o=Ug(2*Math.abs(n/Math.PI));(Math.abs(r)<=wt||Math.abs(Math.abs(n)-st)<=wt)&&(i=this.x0,n>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/r-r/Math.PI),l=a*a,c=Math.sin(o),u=Math.cos(o),h=u/(c+u-1),f=h*h,g=h*(2/c-1),v=g*g,x=Math.PI*this.R*(a*(h-v)+Math.sqrt(l*(h-v)*(h-v)-(v+l)*(f-v)))/(v+l);r<0&&(x=-x),i=this.x0+x;var b=l+h;return x=Math.PI*this.R*(g*b-a*Math.sqrt((v+l)*(l+1)-b*b))/(v+l),n>=0?s=this.y0+x:s=this.y0-x,t.x=i,t.y=s,t}function Tpt(t){var e,n,r,i,s,o,a,l,c,u,h,f,g;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,r=t.x/h,i=t.y/h,s=r*r+i*i,o=-Math.abs(i)*(1+s),a=o-2*i*i+r*r,l=-2*o+1+2*i*i+s*s,g=i*i/l+(2*a*a*a/l/l/l-9*o*a/l/l)/27,c=(o-a*a/3/l)/l,u=2*Math.sqrt(-c/3),h=3*g/c/u,Math.abs(h)>1&&(h>=0?h=1:h=-1),f=Math.acos(h)/3,t.y>=0?n=(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:n=-(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,Math.abs(r)<wt?e=this.long0:e=It(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),t.x=e,t.y=n,t}var kpt=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Apt={init:Ept,forward:Spt,inverse:Tpt,names:kpt};function Ipt(t,e,n,r,i,s){const o=r-e,a=Math.atan((1-s)*Math.tan(t)),l=Math.atan((1-s)*Math.tan(n)),c=Math.sin(a),u=Math.cos(a),h=Math.sin(l),f=Math.cos(l);let g=o,v,x=100,b,T,A,I,R,M,F,C,N,O,j,V,W,U;do{if(b=Math.sin(g),T=Math.cos(g),A=Math.sqrt(f*b*(f*b)+(u*h-c*f*T)*(u*h-c*f*T)),A===0)return{azi1:0,s12:0};I=c*h+u*f*T,R=Math.atan2(A,I),M=u*f*b/A,F=1-M*M,C=F!==0?I-2*c*h/F:0,N=s/16*F*(4+s*(4-3*F)),v=g,g=o+(1-N)*s*M*(R+N*A*(C+N*I*(-1+2*C*C)))}while(Math.abs(g-v)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(O=F*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),j=1+O/16384*(4096+O*(-768+O*(320-175*O))),V=O/1024*(256+O*(-128+O*(74-47*O))),W=V*A*(C+V/4*(I*(-1+2*C*C)-V/6*C*(-3+4*A*A)*(-3+4*C*C))),U=i*(1-s)*j*(R-W),{azi1:Math.atan2(f*b,u*h-c*f*T),s12:U})}function Rpt(t,e,n,r,i,s){const o=Math.atan((1-s)*Math.tan(t)),a=Math.sin(o),l=Math.cos(o),c=Math.sin(n),u=Math.cos(n),h=Math.atan2(a,l*u),f=l*c,g=1-f*f,v=g*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),b=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*x),A,I=100,R,M,F,C;do R=Math.cos(2*h+T),M=Math.sin(T),F=Math.cos(T),C=b*M*(R+b/4*(F*(-1+2*R*R)-b/6*R*(-3+4*M*M)*(-3+4*R*R))),A=T,T=r/(i*(1-s)*x)+C;while(Math.abs(T-A)>1e-12&&--I>0);if(I===0)return{lat2:NaN,lon2:NaN};const N=a*M-l*F*u,O=Math.atan2(a*F+l*M*u,(1-s)*Math.sqrt(f*f+N*N)),j=Math.atan2(M*c,l*F-a*M*u),V=s/16*g*(4+s*(4-3*g)),W=j-(1-V)*s*f*(T+V*M*(R+V*F*(-1+2*R*R))),U=e+W;return{lat2:O,lon2:U}}function Ppt(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Cpt(t){var e=t.x,n=t.y,r=Math.sin(t.y),i=Math.cos(t.y),s=It(e-this.long0,this.over),o,a,l,c,u,h,f,g,v,x,b;return this.sphere?Math.abs(this.sin_p12-1)<=wt?(t.x=this.x0+this.a*(st-n)*Math.sin(s),t.y=this.y0-this.a*(st-n)*Math.cos(s),t):Math.abs(this.sin_p12+1)<=wt?(t.x=this.x0+this.a*(st+n)*Math.sin(s),t.y=this.y0+this.a*(st+n)*Math.cos(s),t):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),f=Math.acos(v),g=f?f/Math.sin(f):1,t.x=this.x0+this.a*g*i*Math.sin(s),t.y=this.y0+this.a*g*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),t):(o=PI(this.es),a=CI(this.es),l=MI(this.es),c=NI(this.es),Math.abs(this.sin_p12-1)<=wt?(u=this.a*Na(o,a,l,c,st),h=this.a*Na(o,a,l,c,n),t.x=this.x0+(u-h)*Math.sin(s),t.y=this.y0-(u-h)*Math.cos(s),t):Math.abs(this.sin_p12+1)<=wt?(u=this.a*Na(o,a,l,c,st),h=this.a*Na(o,a,l,c,n),t.x=this.x0+(u+h)*Math.sin(s),t.y=this.y0+(u+h)*Math.cos(s),t):Math.abs(e)<wt&&Math.abs(n-this.lat0)<wt?(t.x=t.y=0,t):(x=Ipt(this.lat0,this.long0,n,e,this.a,this.f),b=x.azi1,t.x=x.s12*Math.sin(b),t.y=x.s12*Math.cos(b),t))}function Mpt(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,s,o,a,l,c,u,h,f,g,v,x,b;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*st*this.a?void 0:(n=e/this.a,r=Math.sin(n),i=Math.cos(n),s=this.long0,Math.abs(e)<=wt?o=this.lat0:(o=Ug(i*this.sin_p12+t.y*r*this.cos_p12/e),a=Math.abs(this.lat0)-st,Math.abs(a)<=wt?this.lat0>=0?s=It(this.long0+Math.atan2(t.x,-t.y),this.over):s=It(this.long0-Math.atan2(-t.x,t.y),this.over):s=It(this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r),this.over)),t.x=s,t.y=o,t)):(l=PI(this.es),c=CI(this.es),u=MI(this.es),h=NI(this.es),Math.abs(this.sin_p12-1)<=wt?(f=this.a*Na(l,c,u,h,st),e=Math.sqrt(t.x*t.x+t.y*t.y),g=f-e,o=_N(g/this.a,l,c,u,h),s=It(this.long0+Math.atan2(t.x,-1*t.y),this.over),t.x=s,t.y=o,t):Math.abs(this.sin_p12+1)<=wt?(f=this.a*Na(l,c,u,h,st),e=Math.sqrt(t.x*t.x+t.y*t.y),g=e-f,o=_N(g/this.a,l,c,u,h),s=It(this.long0+Math.atan2(t.x,t.y),this.over),t.x=s,t.y=o,t):(v=Math.atan2(t.x,t.y),x=Math.sqrt(t.x*t.x+t.y*t.y),b=Rpt(this.lat0,this.long0,v,x,this.a,this.f),t.x=b.lon2,t.y=b.lat2,t))}var Npt=["Azimuthal_Equidistant","aeqd"];const Opt={init:Ppt,forward:Cpt,inverse:Mpt,names:Npt};function Lpt(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Dpt(t){var e,n,r,i,s,o,a,l,c=t.x,u=t.y;return r=It(c-this.long0,this.over),e=Math.sin(u),n=Math.cos(u),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,s=1,(o>0||Math.abs(o)<=wt)&&(a=this.a*s*n*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=l,t}function $pt(t){var e,n,r,i,s,o,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Ug(e/this.a),r=Math.sin(n),i=Math.cos(n),o=this.long0,Math.abs(e)<=wt?(a=this.lat0,t.x=o,t.y=a,t):(a=Ug(i*this.sin_p14+t.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-st,Math.abs(s)<=wt?(this.lat0>=0?o=It(this.long0+Math.atan2(t.x,-t.y),this.over):o=It(this.long0-Math.atan2(-t.x,t.y),this.over),t.x=o,t.y=a,t):(o=It(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r),this.over),t.x=o,t.y=a,t))}var jpt=["ortho"];const Fpt={init:Lpt,forward:Dpt,inverse:$pt,names:jpt};var Ci={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Cr={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Vpt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=st-Pr/2?this.face=Ci.TOP:this.lat0<=-(st-Pr/2)?this.face=Ci.BOTTOM:Math.abs(this.long0)<=Pr?this.face=Ci.FRONT:Math.abs(this.long0)<=st+Pr?this.face=this.long0>0?Ci.RIGHT:Ci.LEFT:this.face=Ci.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function zpt(t){var e={x:0,y:0},n,r,i,s,o,a,l={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===Ci.TOP)s=st-n,r>=Pr&&r<=st+Pr?(l.value=Cr.AREA_0,i=r-st):r>st+Pr||r<=-(st+Pr)?(l.value=Cr.AREA_1,i=r>0?r-ls:r+ls):r>-(st+Pr)&&r<=-Pr?(l.value=Cr.AREA_2,i=r+st):(l.value=Cr.AREA_3,i=r);else if(this.face===Ci.BOTTOM)s=st+n,r>=Pr&&r<=st+Pr?(l.value=Cr.AREA_0,i=-r+st):r<Pr&&r>=-Pr?(l.value=Cr.AREA_1,i=-r):r<-Pr&&r>=-(st+Pr)?(l.value=Cr.AREA_2,i=-r-st):(l.value=Cr.AREA_3,i=r>0?-r+ls:-r-ls);else{var c,u,h,f,g,v,x;this.face===Ci.RIGHT?r=aw(r,+st):this.face===Ci.BACK?r=aw(r,+ls):this.face===Ci.LEFT&&(r=aw(r,-st)),f=Math.sin(n),g=Math.cos(n),v=Math.sin(r),x=Math.cos(r),c=g*x,u=g*v,h=f,this.face===Ci.FRONT?(s=Math.acos(c),i=aC(s,h,u,l)):this.face===Ci.RIGHT?(s=Math.acos(u),i=aC(s,h,-c,l)):this.face===Ci.BACK?(s=Math.acos(-c),i=aC(s,h,-u,l)):this.face===Ci.LEFT?(s=Math.acos(-u),i=aC(s,h,c,l)):(s=i=0,l.value=Cr.AREA_0)}return a=Math.atan(12/ls*(i+Math.acos(Math.sin(i)*Math.cos(Pr))-st)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Cr.AREA_1?a+=st:l.value===Cr.AREA_2?a+=ls:l.value===Cr.AREA_3&&(a+=1.5*ls),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function Upt(t){var e={lam:0,phi:0},n,r,i,s,o,a,l,c,u,h={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?h.value=Cr.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(h.value=Cr.AREA_1,n-=st):t.x<0&&-t.x>=Math.abs(t.y)?(h.value=Cr.AREA_2,n=n<0?n+ls:n-ls):(h.value=Cr.AREA_3,n+=st),u=ls/12*Math.tan(n),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),i=Math.cos(n),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),l<-1?l=-1:l>1&&(l=1),this.face===Ci.TOP)c=Math.acos(l),e.phi=st-c,h.value===Cr.AREA_0?e.lam=a+st:h.value===Cr.AREA_1?e.lam=a<0?a+ls:a-ls:h.value===Cr.AREA_2?e.lam=a-st:e.lam=a;else if(this.face===Ci.BOTTOM)c=Math.acos(l),e.phi=c-st,h.value===Cr.AREA_0?e.lam=-a+st:h.value===Cr.AREA_1?e.lam=-a:h.value===Cr.AREA_2?e.lam=-a-st:e.lam=a<0?-a-ls:-a+ls;else{var f,g,v;f=l,u=f*f,u>=1?v=0:v=Math.sqrt(1-u)*Math.sin(a),u+=v*v,u>=1?g=0:g=Math.sqrt(1-u),h.value===Cr.AREA_1?(u=g,g=-v,v=u):h.value===Cr.AREA_2?(g=-g,v=-v):h.value===Cr.AREA_3&&(u=g,g=v,v=-u),this.face===Ci.RIGHT?(u=f,f=-g,g=u):this.face===Ci.BACK?(f=-f,g=-g):this.face===Ci.LEFT&&(u=f,f=g,g=-u),e.phi=Math.acos(-v)-st,e.lam=Math.atan2(g,f),this.face===Ci.RIGHT?e.lam=aw(e.lam,-st):this.face===Ci.BACK?e.lam=aw(e.lam,-ls):this.face===Ci.LEFT&&(e.lam=aw(e.lam,+st))}if(this.es!==0){var x,b,T;x=e.phi<0?1:0,b=Math.tan(e.phi),T=this.b/Math.sqrt(b*b+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function aC(t,e,n,r){var i;return t<wt?(r.value=Cr.AREA_0,i=0):(i=Math.atan2(e,n),Math.abs(i)<=Pr?r.value=Cr.AREA_0:i>Pr&&i<=st+Pr?(r.value=Cr.AREA_1,i-=st):i>st+Pr||i<=-(st+Pr)?(r.value=Cr.AREA_2,i=i>=0?i-ls:i+ls):(r.value=Cr.AREA_3,i+=st)),i}function aw(t,e){var n=t+e;return n<-ls?n+=tA:n>+ls&&(n-=tA),n}var Gpt=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Bpt={init:Vpt,forward:zpt,inverse:Upt,names:Gpt};var HV=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],NS=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Bwe=.8487,Wwe=1.3523,Hwe=yl/5,Wpt=1/Hwe,Mx=18,xN=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},Hpt=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function qpt(t,e,n,r){for(var i=e;r;--r){var s=t(i);if(i-=s,Math.abs(s)<n)break}return i}function Kpt(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Ypt(t){var e=It(t.x-this.long0,this.over),n=Math.abs(t.y),r=Math.floor(n*Hwe);r<0?r=0:r>=Mx&&(r=Mx-1),n=yl*(n-Wpt*r);var i={x:xN(HV[r],n)*e,y:xN(NS[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*Bwe+this.x0,i.y=i.y*this.a*Wwe+this.y0,i}function Xpt(t){var e={x:(t.x-this.x0)/(this.a*Bwe),y:Math.abs(t.y-this.y0)/(this.a*Wwe)};if(e.y>=1)e.x/=HV[Mx][0],e.y=t.y<0?-st:st;else{var n=Math.floor(e.y*Mx);for(n<0?n=0:n>=Mx&&(n=Mx-1);;)if(NS[n][0]>e.y)--n;else if(NS[n+1][0]<=e.y)++n;else break;var r=NS[n],i=5*(e.y-r[0])/(NS[n+1][0]-r[0]);i=qpt(function(s){return(xN(r,s)-e.y)/Hpt(r,s)},i,wt,100),e.x/=xN(HV[n],i),e.y=(5*n+i)*Hi,t.y<0&&(e.y=-e.y)}return e.x=It(e.x+this.long0,this.over),e}var Zpt=["Robinson","robin"];const Jpt={init:Kpt,forward:Ypt,inverse:Xpt,names:Zpt};function Qpt(){this.name="geocent"}function emt(t){var e=Nwe(t,this.es,this.a);return e}function tmt(t){var e=Owe(t,this.es,this.a,this.b);return e}var nmt=["Geocentric","geocentric","geocent","Geocent"];const rmt={init:Qpt,forward:emt,inverse:tmt,names:nmt};var na={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},$E={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function imt(){if(Object.keys($E).forEach((function(n){if(typeof this[n]>"u")this[n]=$E[n].def;else{if($E[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);$E[n].num&&(this[n]=parseFloat(this[n]))}$E[n].degrees&&(this[n]=this[n]*Hi)}).bind(this)),Math.abs(Math.abs(this.lat0)-st)<wt?this.mode=this.lat0<0?na.S_POLE:na.N_POLE:Math.abs(this.lat0)<wt?this.mode=na.EQUIT:(this.mode=na.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function smt(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i,s;switch(this.mode){case na.OBLIQ:s=this.sinph0*e+this.cosph0*n*r;break;case na.EQUIT:s=n*r;break;case na.S_POLE:s=-e;break;case na.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*n*Math.sin(t.x),this.mode){case na.OBLIQ:s*=this.cosph0*e-this.sinph0*n*r;break;case na.EQUIT:s*=e;break;case na.N_POLE:s*=-(n*r);break;case na.S_POLE:s*=n*r;break}var o,a;return o=s*this.cg+i*this.sg,a=1/(o*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*a,s=o*a,t.x=i*this.a,t.y=s*this.a,t}function omt(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,i;i=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*i,r=this.pn1*t.y*this.cw*i,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var s=fl(t.x,t.y);if(Math.abs(s)<wt)e.x=0,e.y=t.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case na.OBLIQ:e.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/s),t.y=(o-this.sinph0*Math.sin(e.y))*s,t.x*=a*this.cosph0;break;case na.EQUIT:e.y=Math.asin(t.y*a/s),t.y=o*s,t.x*=a;break;case na.N_POLE:e.y=Math.asin(o),t.y=-t.y;break;case na.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var amt=["Tilted_Perspective","tpers"];const lmt={init:imt,forward:smt,inverse:omt,names:amt};function cmt(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function umt(t){var e=t.x,n=t.y,r,i,s,o;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var a=this.radius_p/fl(this.radius_p*Math.cos(n),Math.sin(n));if(i=a*Math.cos(e)*Math.cos(n),s=a*Math.sin(e)*Math.cos(n),o=a*Math.sin(n),(this.radius_g-i)*i-s*s-o*o*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/fl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(s/r),t.y=this.radius_g_1*Math.atan(o/fl(s,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(e)*r,s=Math.sin(e)*r,o=Math.sin(n),r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/fl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(s/r),t.y=this.radius_g_1*Math.atan(o/fl(s,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function hmt(t){var e=-1,n=0,r=0,i,s,o,a;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*fl(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*fl(1,n));var l=r/this.radius_p;if(i=n*n+l*l+e*e,s=2*this.radius_g*e,o=s*s-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-s-Math.sqrt(o))/(2*i),e=this.radius_g+a*e,n*=a,r*=a,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+e*e,s=2*this.radius_g*e,o=s*s-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-s-Math.sqrt(o))/(2*i),e=this.radius_g+a*e,n*=a,r*=a,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var dmt=["Geostationary Satellite View","Geostationary_Satellite","geos"];const fmt={init:cmt,forward:umt,inverse:hmt,names:dmt};var AT=1.340264,IT=-.081106,RT=893e-6,PT=.003796,wN=Math.sqrt(3)/2;function pmt(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function mmt(t){var e=It(t.x-this.long0,this.over),n=t.y,r=Math.asin(wN*Math.sin(n)),i=r*r,s=i*i*i;return t.x=e*Math.cos(r)/(wN*(AT+3*IT*i+s*(7*RT+9*PT*i))),t.y=r*(AT+IT*i+s*(RT+PT*i)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function gmt(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,i,s,o,a,l,c;for(c=0;c<n&&(i=r*r,s=i*i*i,o=r*(AT+IT*i+s*(RT+PT*i))-t.y,a=AT+3*IT*i+s*(7*RT+9*PT*i),r-=l=o/a,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,t.x=wN*t.x*(AT+3*IT*i+s*(7*RT+9*PT*i))/Math.cos(r),t.y=Math.asin(Math.sin(r)/wN),t.x=It(t.x+this.long0,this.over),t}var ymt=["eqearth","Equal Earth","Equal_Earth"];const vmt={init:pmt,forward:mmt,inverse:gmt,names:ymt};var iA=1e-10;function _mt(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<iA)throw new Error;this.es?(this.en=uH(this.es),this.m1=ub(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=wmt,this.forward=xmt):(Math.abs(this.phi1)+iA>=st?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Emt,this.forward=bmt)}function xmt(t){var e=It(t.x-(this.long0||0),this.over),n=t.y,r,i,s;return r=this.am1+this.m1-ub(n,i=Math.sin(n),s=Math.cos(n),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),t.x=r*Math.sin(i),t.y=this.am1-r*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function wmt(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,i;if(n=fl(t.x,t.y=this.am1-t.y),i=hH(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(i))<st)e=Math.sin(i),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-st)<=iA)r=0;else throw new Error;return t.x=It(r+(this.long0||0),this.over),t.y=e0(i),t}function bmt(t){var e=It(t.x-(this.long0||0),this.over),n=t.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>iA?(t.x=i*Math.sin(r=e*Math.cos(n)/i),t.y=this.cphi1-i*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Emt(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=fl(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>st)throw new Error;return Math.abs(Math.abs(n)-st)<=iA?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=It(e+(this.long0||0),this.over),t.y=e0(n),t}var Smt=["bonne","Bonne (Werner lat_1=90)"];const Tmt={init:_mt,names:Smt},Pse={OBLIQUE:{forward:Pmt,inverse:Mmt},TRANSVERSE:{forward:Cmt,inverse:Nmt}},bN={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function kmt(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=Rwe.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const t=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=ru(t);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let n;const r=Object.keys(bN),i=a=>{if(typeof this[a]>"u")return;const l=parseFloat(this[a])*Hi;if(isNaN(l))throw new Error("Invalid value for "+a+": "+this[a]);return l};for(let a=0;a<r.length;a++){const l=r[a],c=bN[l],u=Object.entries(c);if(u.some(([f])=>typeof this[f]<"u")){n=c;for(let f=0;f<u.length;f++){const[g,v]=u[f],x=i(g);if(typeof x>"u")throw new Error("Missing parameter: "+g+".");this[v]=x}break}}if(!n)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=Rmt(this,n);this.lamp=s,Math.abs(o)>wt?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=Pse.OBLIQUE):this.projectionType=Pse.TRANSVERSE}function Amt(t){return this.projectionType.forward(this,t)}function Imt(t){return this.projectionType.inverse(this,t)}function Rmt(t,e){let n,r;if(e===bN.ROTATE){let i=t.oLongC,s=t.oLatC,o=t.oAlpha;if(Math.abs(Math.abs(s)-st)<=wt)throw new Error("Invalid value for o_lat_c: "+t.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),n=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===bN.NEW_POLE)r=t.oLongP,n=t.oLatP;else{let i=t.oLong1,s=t.oLat1,o=t.oLong2,a=t.oLat2,l=Math.abs(s);if(Math.abs(s)>st-wt)throw new Error("Invalid value for o_lat_1: "+t.o_lat_1+" should be < 90");if(Math.abs(a)>st-wt)throw new Error("Invalid value for o_lat_2: "+t.o_lat_2+" should be < 90");if(Math.abs(s-a)<wt)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<wt)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(i)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(i)),n=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:n}}function Pmt(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(n),s=Math.sin(r),o=Math.cos(r);e.x=It(Math.atan2(o*Math.sin(n),t.sphip*o*i+t.cphip*s)+t.lamp),e.y=Math.asin(t.sphip*s-t.cphip*o*i);const a=t.obliqueProjection.forward(e);return t.isIdentity&&(a.x*=yl,a.y*=yl),a}function Cmt(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(r),s=Math.cos(n);e.x=It(Math.atan2(i*Math.sin(n),Math.sin(r))+t.lamp),e.y=Math.asin(-1*i*s);const o=t.obliqueProjection.forward(e);return t.isIdentity&&(o.x*=yl,o.y*=yl),o}function Mmt(t,e){t.isIdentity&&(e.x*=Hi,e.y*=Hi);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){r-=t.lamp;const s=Math.cos(r),o=Math.sin(i),a=Math.cos(i);e.x=Math.atan2(a*Math.sin(r),t.sphip*a*s-t.cphip*o),e.y=Math.asin(t.sphip*o+t.cphip*a*s)}return e.x=It(e.x+t.long0),e}function Nmt(t,e){t.isIdentity&&(e.x*=Hi,e.y*=Hi);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=t.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=It(e.x+t.long0),e}var Omt=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Lmt={init:kmt,forward:Amt,inverse:Imt,names:Omt};function Dmt(t){t.Proj.projections.add(YM),t.Proj.projections.add(XM),t.Proj.projections.add(Sdt),t.Proj.projections.add(Ndt),t.Proj.projections.add(jdt),t.Proj.projections.add(Gdt),t.Proj.projections.add(Ydt),t.Proj.projections.add(eft),t.Proj.projections.add(sft),t.Proj.projections.add(uft),t.Proj.projections.add(Eft),t.Proj.projections.add(Rft),t.Proj.projections.add(Oft),t.Proj.projections.add(Vft),t.Proj.projections.add(Wft),t.Proj.projections.add(Xft),t.Proj.projections.add(tpt),t.Proj.projections.add(opt),t.Proj.projections.add(dpt),t.Proj.projections.add(ypt),t.Proj.projections.add(bpt),t.Proj.projections.add(Apt),t.Proj.projections.add(Opt),t.Proj.projections.add(Fpt),t.Proj.projections.add(Bpt),t.Proj.projections.add(Jpt),t.Proj.projections.add(rmt),t.Proj.projections.add(lmt),t.Proj.projections.add(fmt),t.Proj.projections.add(vmt),t.Proj.projections.add(Tmt),t.Proj.projections.add(Lmt)}const sr=Object.assign(zht,{defaultDatum:"WGS84",Proj:ru,WGS84:new ru("WGS84"),Point:A2,toPoint:Lwe,defs:Eo,nadgrid:Eht,transform:vN,mgrs:Uht,version:"__VERSION__"});Dmt(sr);class qwe{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=xi,this.supportedMediaTypes=null}getReadOptions(e,n){if(n){let r=n.dataProjection?Yr(n.dataProjection):this.readProjection(e);n.extent&&r&&r.getUnits()==="tile-pixels"&&(r=Yr(r),r.setWorldExtent(n.extent)),n={dataProjection:r,featureProjection:n.featureProjection}}return this.adaptOptions(n)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return xn()}readFeature(e,n){return xn()}readFeatures(e,n){return xn()}readGeometry(e,n){return xn()}readProjection(e){return xn()}writeFeature(e,n){return xn()}writeFeatures(e,n){return xn()}writeGeometry(e,n){return xn()}}function fh(t,e,n){const r=n?Yr(n.featureProjection):null,i=n?Yr(n.dataProjection):null;let s=t;if(r&&i&&!Uy(r,i)){e&&(s=t.clone());const o=e?r:i,a=e?i:r;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(WT(o,a))}if(e&&n&&n.decimals!==void 0){const o=Math.pow(10,n.decimals),a=function(l){for(let c=0,u=l.length;c<u;++c)l[c]=Math.round(l[c]*o)/o;return l};s===t&&(s=t.clone()),s.applyTransform(a)}return s}const $mt={Point:Vs,LineString:ro,Polygon:ou,MultiPoint:X1,MultiLineString:np,MultiPolygon:p1};function jmt(t,e,n){return Array.isArray(e[0])?(Cae(t,0,e,n)||(t=t.slice(),sj(t,0,e,n)),t):(Rz(t,0,e,n)||(t=t.slice(),d3(t,0,e,n)),t)}function Kwe(t,e){const n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(s=>Kwe({...t,geometry:s})).flat();const r=n.type==="MultiPolygon"?"Polygon":n.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=n.layout.length;return fh(new hl(r,r==="Polygon"?jmt(n.flatCoordinates,n.ends,i):n.flatCoordinates,n.ends?.flat(),i,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function yH(t,e){if(!t)return null;if(Array.isArray(t)){const r=t.map(i=>yH(i,e));return new eh(r)}const n=$mt[t.type];return fh(new n(t.flatCoordinates,t.layout||"XY",t.ends),!1,e)}class Fmt extends qwe{constructor(){super()}getType(){return"json"}readFeature(e,n){return this.readFeatureFromObject(lC(e),this.getReadOptions(e,n))}readFeatures(e,n){return this.readFeaturesFromObject(lC(e),this.getReadOptions(e,n))}readFeatureFromObject(e,n){return xn()}readFeaturesFromObject(e,n){return xn()}readGeometry(e,n){return this.readGeometryFromObject(lC(e),this.getReadOptions(e,n))}readGeometryFromObject(e,n){return xn()}readProjection(e){return this.readProjectionFromObject(lC(e))}readProjectionFromObject(e){return xn()}writeFeature(e,n){return JSON.stringify(this.writeFeatureObject(e,n))}writeFeatureObject(e,n){return xn()}writeFeatures(e,n){return JSON.stringify(this.writeFeaturesObject(e,n))}writeFeaturesObject(e,n){return xn()}writeGeometry(e,n){return JSON.stringify(this.writeGeometryObject(e,n))}writeGeometryObject(e,n){return xn()}}function lC(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class eL extends Fmt{constructor(e){e=e||{},super(),this.dataProjection=Yr(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Yr(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,n){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=vH(r.geometry);if(this.featureClass===hl)return Kwe({geometry:i,id:r.id,properties:r.properties},n);const s=new xi;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(yH(i,n)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,n){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],n);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,n)];return i.flat()}readGeometryFromObject(e,n){return Vmt(e,n)}readProjectionFromObject(e){const n=e.crs;let r;if(n)if(n.type=="name")r=Yr(n.properties.name);else if(n.type==="EPSG")r=Yr("EPSG:"+n.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,n){n=this.adaptOptions(n);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),o=e.getGeometry();return o&&(r.geometry=qV(o,n),delete s[e.getGeometryName()]),c1(s)||(r.properties=s),r}writeFeaturesObject(e,n){n=this.adaptOptions(n);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],n));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,n){return qV(e,this.adaptOptions(n))}}function vH(t,e){if(!t)return null;let n;switch(t.type){case"Point":{n=Umt(t);break}case"LineString":{n=Gmt(t);break}case"Polygon":{n=qmt(t);break}case"MultiPoint":{n=Wmt(t);break}case"MultiLineString":{n=Bmt(t);break}case"MultiPolygon":{n=Hmt(t);break}case"GeometryCollection":{n=zmt(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function Vmt(t,e){const n=vH(t);return yH(n,e)}function zmt(t,e){return t.geometries.map(function(r){return vH(r)})}function Umt(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:Y1(e.length)}}function Gmt(t){const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:Y1(e[0]?.length||2)}}function Bmt(t){const e=t.coordinates,n=e[0]?.[0]?.length||2,r=[],i=EA(r,0,e,n);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Y1(n)}}function Wmt(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Y1(e[0]?.length||2)}}function Hmt(t){const e=t.coordinates,n=[],r=e[0]?.[0]?.[0].length||2,i=aae(n,0,e,r);return{type:"MultiPolygon",flatCoordinates:n,ends:i,layout:Y1(r)}}function qmt(t){const e=t.coordinates,n=[],r=e[0]?.[0]?.length,i=EA(n,0,e,r);return{type:"Polygon",flatCoordinates:n,ends:i,layout:Y1(r)}}function qV(t,e){t=fh(t,!0,e);const n=t.getType();let r;switch(n){case"Point":{r=Qmt(t);break}case"LineString":{r=Ymt(t);break}case"Polygon":{r=egt(t,e);break}case"MultiPoint":{r=Zmt(t);break}case"MultiLineString":{r=Xmt(t);break}case"MultiPolygon":{r=Jmt(t,e);break}case"GeometryCollection":{r=Kmt(t,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+n)}return r}function Kmt(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(r){return qV(r,e)})}}function Ymt(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function Xmt(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Zmt(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Jmt(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}function Qmt(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function egt(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}const EN="http://www.w3.org/2001/XMLSchema-instance";function uv(t,e){return hb().createElementNS(t,e)}function ph(t,e){return Ywe(t,e,[]).join("")}function Ywe(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)n.push(t.nodeValue);else{let r;for(r=t.firstChild;r;r=r.nextSibling)Ywe(r,e,n)}return n}function zf(t){return"documentElement"in t}function Uf(t){return new DOMParser().parseFromString(t,"application/xml")}function Cse(t,e){return(function(n,r){const i=t.call(e??this,n,r);if(i!==void 0){const s=r[r.length-1];Rr(s,i)}})}function qu(t,e){return(function(n,r){const i=t.call(e??this,n,r);i!==void 0&&r[r.length-1].push(i)})}function _H(t,e){return(function(n,r){const i=t.call(this,n,r);i!==void 0&&(r[r.length-1]=i)})}function Qe(t,e,n){return(function(r,i){const s=t.call(this,r,i);if(s!==void 0){const o=i[i.length-1],a=e!==void 0?e:r.localName;o[a]=s}})}function pt(t,e){return(function(n,r,i){t.call(this,n,r,i),i[i.length-1].node.appendChild(n)})}function Xwe(t,e){let n,r;return function(i,s,o){if(n===void 0){n={};const a={};a[i.localName]=t,n[i.namespaceURI]=a,r=mh(i.localName)}Zwe(n,r,s,o)}}function mh(t,e){return(function(n,r,i){const o=r[r.length-1].node;let a=t;a===void 0&&(a=i);const l=o.namespaceURI;return uv(l,a)})}const pa=mh();function El(t,e){const n=e.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=t[e[i]];return r}function At(t,e,n){n=n!==void 0?n:{};let r,i;for(r=0,i=t.length;r<i;++r)n[t[r]]=e;return n}function t0(t,e,n,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=t[i.namespaceURI];if(s!==void 0){const o=s[i.localName];o!==void 0&&o.call(r,i,n)}}}function tr(t,e,n,r,i){return r.push(t),t0(e,n,r,i),r.pop()}function Zwe(t,e,n,r,i,s){const o=(i!==void 0?i:n).length;let a,l;for(let c=0;c<o;++c)a=n[c],a!==void 0&&(l=e.call(s,a,r,i!==void 0?i[c]:void 0),l!==void 0&&t[l.namespaceURI][l.localName].call(s,l,a,r))}function ei(t,e,n,r,i,s,o){return i.push(t),Zwe(e,n,r,i,s,o),i.pop()}let S8;function tgt(){return S8===void 0&&typeof XMLSerializer<"u"&&(S8=new XMLSerializer),S8}let T8;function hb(){return T8===void 0&&typeof document<"u"&&(T8=document.implementation.createDocument("","",null)),T8}class Jwe extends qwe{constructor(){super(),this.xmlSerializer_=tgt()}getType(){return"xml"}readFeature(e,n){if(!e)return null;if(typeof e=="string"){const r=Uf(e);return this.readFeatureFromDocument(r,n)}return zf(e)?this.readFeatureFromDocument(e,n):this.readFeatureFromNode(e,n)}readFeatureFromDocument(e,n){const r=this.readFeaturesFromDocument(e,n);return r.length>0?r[0]:null}readFeatureFromNode(e,n){return null}readFeatures(e,n){if(!e)return[];if(typeof e=="string"){const r=Uf(e);return this.readFeaturesFromDocument(r,n)}return zf(e)?this.readFeaturesFromDocument(e,n):this.readFeaturesFromNode(e,n)}readFeaturesFromDocument(e,n){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Rr(r,this.readFeaturesFromNode(i,n));return r}readFeaturesFromNode(e,n){return xn()}readGeometry(e,n){if(!e)return null;if(typeof e=="string"){const r=Uf(e);return this.readGeometryFromDocument(r,n)}return zf(e)?this.readGeometryFromDocument(e,n):this.readGeometryFromNode(e,n)}readGeometryFromDocument(e,n){return null}readGeometryFromNode(e,n){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const n=Uf(e);return this.readProjectionFromDocument(n)}return zf(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,n){const r=this.writeFeatureNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,n){return null}writeFeatures(e,n){const r=this.writeFeaturesNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,n){return null}writeGeometry(e,n){const r=this.writeGeometryNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,n){return null}}function Gg(t){const e=ph(t,!1);return ngt(e)}function ngt(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return e[1]!==void 0||!1}function tL(t){const e=ph(t,!1),n=Date.parse(e);return isNaN(n)?void 0:n/1e3}function gr(t){const e=ph(t,!1);return rgt(e)}function rgt(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function sA(t){const e=ph(t,!1);return igt(e)}function igt(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Vn(t){return ph(t,!1).trim()}function I2(t,e){br(t,e?"1":"0")}function sgt(t,e){t.appendChild(hb().createCDATASection(e))}function ogt(t,e){const n=new Date(e*1e3),r=n.getUTCFullYear()+"-"+eE(n.getUTCMonth()+1,2)+"-"+eE(n.getUTCDate(),2)+"T"+eE(n.getUTCHours(),2)+":"+eE(n.getUTCMinutes(),2)+":"+eE(n.getUTCSeconds(),2)+"Z";t.appendChild(hb().createTextNode(r))}function ll(t,e){const n=e.toPrecision();t.appendChild(hb().createTextNode(n))}function SN(t,e){const n=e.toString();t.appendChild(hb().createTextNode(n))}const agt=/^\s/,lgt=/\s$/,cgt=/(\n|\t|\r|<|&| {2})/;function br(t,e){typeof e=="string"&&(agt.test(e)||lgt.test(e)||cgt.test(e))?e.split("]]>").forEach((n,r,i)=>{r<i.length-1&&(n+="]]"),r>0&&(n=">"+n),sgt(t,n)}):t.appendChild(hb().createTextNode(e))}const ui=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],ugt="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",hgt={rte:Qwe,trk:e2e,wpt:t2e},dgt=At(ui,{rte:qu(Qwe),trk:qu(e2e),wpt:qu(t2e)}),fgt=At(ui,{text:Qe(Vn,"linkText"),type:Qe(Vn,"linkType")}),pgt=At(ui,{name:Qe(Vn),email:zgt,link:OI}),mgt=At(ui,{name:Qe(Vn),desc:Qe(Vn),author:Qe(jgt),copyright:Qe(Fgt),link:OI,time:Qe(tL),keywords:Qe(Vn),bounds:Vgt,extensions:nL}),ggt=At(ui,{year:Qe(sA),license:Qe(Vn)}),ygt=At(ui,{rte:pt(Wgt),trk:pt(Hgt),wpt:pt(Kgt)});class vgt extends Jwe{constructor(e){super(),e=e||{},this.dataProjection=Yr("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Uf(e)):zf(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(n);if(r)return r}return null}readMetadataFromNode(e){if(!ui.includes(e.namespaceURI))return null;for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(ui.includes(n.namespaceURI)&&n.localName==="metadata")return tr({},mgt,n,[]);return null}readFeatureFromNode(e,n){if(!ui.includes(e.namespaceURI))return null;const r=hgt[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,n)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,n){if(!ui.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=tr([],dgt,e,[this.getReadOptions(e,n)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=uv("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",EN),r.setAttributeNS(EN,"xsi:schemaLocation",ugt),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),ei({node:r},ygt,$gt,e,[n]),r}}const _gt=At(ui,{name:Qe(Vn),cmt:Qe(Vn),desc:Qe(Vn),src:Qe(Vn),link:OI,number:Qe(sA),extensions:nL,type:Qe(Vn),rtept:Ugt}),xgt=At(ui,{ele:Qe(gr),time:Qe(tL)}),wgt=At(ui,{name:Qe(Vn),cmt:Qe(Vn),desc:Qe(Vn),src:Qe(Vn),link:OI,number:Qe(sA),type:Qe(Vn),extensions:nL,trkseg:Bgt}),bgt=At(ui,{trkpt:Ggt}),Egt=At(ui,{ele:Qe(gr),time:Qe(tL)}),Sgt=At(ui,{ele:Qe(gr),time:Qe(tL),magvar:Qe(gr),geoidheight:Qe(gr),name:Qe(Vn),cmt:Qe(Vn),desc:Qe(Vn),src:Qe(Vn),link:OI,sym:Qe(Vn),type:Qe(Vn),fix:Qe(Vn),sat:Qe(sA),hdop:Qe(gr),vdop:Qe(gr),pdop:Qe(gr),ageofdgpsdata:Qe(gr),dgpsid:Qe(sA),extensions:nL}),Tgt=["text","type"],kgt=At(ui,{text:pt(br),type:pt(br)}),Agt=At(ui,["name","cmt","desc","src","link","number","type","rtept"]),Igt=At(ui,{name:pt(br),cmt:pt(br),desc:pt(br),src:pt(br),link:pt(bH),number:pt(SN),type:pt(br),rtept:Xwe(pt(EH))}),Rgt=At(ui,["ele","time"]),Pgt=At(ui,["name","cmt","desc","src","link","number","type","trkseg"]),Cgt=At(ui,{name:pt(br),cmt:pt(br),desc:pt(br),src:pt(br),link:pt(bH),number:pt(SN),type:pt(br),trkseg:Xwe(pt(qgt))}),Mgt=mh("trkpt"),Ngt=At(ui,{trkpt:pt(EH)}),Ogt=At(ui,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Lgt=At(ui,{ele:pt(ll),time:pt(ogt),magvar:pt(ll),geoidheight:pt(ll),name:pt(br),cmt:pt(br),desc:pt(br),src:pt(br),link:pt(bH),sym:pt(br),type:pt(br),fix:pt(br),sat:pt(SN),hdop:pt(ll),vdop:pt(ll),pdop:pt(ll),ageofdgpsdata:pt(ll),dgpsid:pt(SN)}),Dgt={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function $gt(t,e,n){const r=t.getGeometry();if(r){const i=Dgt[r.getType()];if(i){const s=e[e.length-1].node;return uv(s.namespaceURI,i)}}}function xH(t,e,n,r){return t.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in r?(t.push(r.ele),delete r.ele,e.hasZ=!0):t.push(0),"time"in r?(t.push(r.time),delete r.time,e.hasM=!0):t.push(0),t}function wH(t,e,n){let r="XY",i=2;if(t.hasZ&&t.hasM?(r="XYZM",i=4):t.hasZ?(r="XYZ",i=3):t.hasM&&(r="XYM",i=3),i!==4){for(let s=0,o=e.length/4;s<o;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],t.hasZ&&(e[s*i+2]=e[s*4+2]),t.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,n)for(let s=0,o=n.length;s<o;s++)n[s]=n[s]/4*i}return r}function jgt(t,e){const n=tr({},pgt,t,e);if(n)return n}function Fgt(t,e){const n=tr({},ggt,t,e);if(n){const r=t.getAttribute("author");return r!==null&&(n.author=r),n}}function Vgt(t,e){const n=e[e.length-1],r=t.getAttribute("minlat"),i=t.getAttribute("minlon"),s=t.getAttribute("maxlat"),o=t.getAttribute("maxlon");i!==null&&r!==null&&o!==null&&s!==null&&(n.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(o),parseFloat(s)]])}function zgt(t,e){const n=e[e.length-1],r=t.getAttribute("id"),i=t.getAttribute("domain");r!==null&&i!==null&&(n.email=`${r}@${i}`)}function OI(t,e){const n=e[e.length-1],r=t.getAttribute("href");r!==null&&(n.link=r),t0(fgt,t,e)}function nL(t,e){const n=e[e.length-1];n.extensionsNode_=t}function Ugt(t,e){const n=tr({},xgt,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;xH(i,s,t,n)}}function Ggt(t,e){const n=tr({},Egt,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;xH(i,s,t,n)}}function Bgt(t,e){const n=e[e.length-1];t0(bgt,t,e);const r=n.flatCoordinates;n.ends.push(r.length)}function Qwe(t,e){const n=e[0],r=tr({flatCoordinates:[],layoutOptions:{}},_gt,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const o=wH(s,i),a=new ro(i,o);fh(a,!1,n);const l=new xi(a);return l.setProperties(r,!0),l}function e2e(t,e){const n=e[0],r=tr({flatCoordinates:[],ends:[],layoutOptions:{}},wgt,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const o=r.layoutOptions;delete r.layoutOptions;const a=wH(o,i,s),l=new np(i,a,s);fh(l,!1,n);const c=new xi(l);return c.setProperties(r,!0),c}function t2e(t,e){const n=e[0],r=tr({},Sgt,t,e);if(!r)return;const i={},s=xH([],i,t,r),o=wH(i,s),a=new Vs(s,o);fh(a,!1,n);const l=new xi(a);return l.setProperties(r,!0),l}function bH(t,e,n){t.setAttribute("href",e);const i=n[n.length-1].properties,s=[i.linkText,i.linkType];ei({node:t},kgt,pa,s,n,Tgt)}function EH(t,e,n){const r=n[n.length-1],s=r.node.namespaceURI,o=r.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(o.time=e[3]);case"XYZ":e[2]!==0&&(o.ele=e[2]);break;case"XYM":e[2]!==0&&(o.time=e[2]);break}const l=t.nodeName=="rtept"?Rgt[s]:Ogt[s],c=El(o,l);ei({node:t,properties:o},Lgt,pa,c,n,l)}function Wgt(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="LineString"){const u=fh(o,!0,r);s.geometryLayout=u.getLayout(),i.rtept=u.getCoordinates()}const a=n[n.length-1].node,l=Agt[a.namespaceURI],c=El(i,l);ei(s,Igt,pa,c,n,l)}function Hgt(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="MultiLineString"){const u=fh(o,!0,r);i.trkseg=u.getLineStrings()}const a=n[n.length-1].node,l=Pgt[a.namespaceURI],c=El(i,l);ei(s,Cgt,pa,c,n,l)}function qgt(t,e,n){const r={node:t};r.geometryLayout=e.getLayout(),r.properties={},ei(r,Ngt,Mgt,e.getCoordinates(),n)}function Kgt(t,e,n){const r=n[0],i=n[n.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const o=fh(s,!0,r);i.geometryLayout=o.getLayout(),EH(t,o.getCoordinates(),n)}}const Ep=["http://www.google.com/kml/ext/2.2"],Xt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Ygt="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",Mse={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Xgt=At(Xt,{ExtendedData:g2e,Region:y2e,MultiGeometry:Qe(f2e,"geometry"),LineString:Qe(h2e,"geometry"),LinearRing:Qe(d2e,"geometry"),Point:Qe(p2e,"geometry"),Polygon:Qe(m2e,"geometry"),Style:Qe(kH),StyleMap:N0t,address:Qe(Vn),description:Qe(Vn),name:Qe(Vn),open:Qe(Gg),phoneNumber:Qe(Vn),styleUrl:Qe(o2e),visibility:Qe(Gg)},At(Ep,{MultiTrack:Qe(x0t,"geometry"),Track:Qe(u2e,"geometry")})),Zgt=At(Xt,{ExtendedData:g2e,Region:y2e,Link:W0t,address:Qe(Vn),description:Qe(Vn),name:Qe(Vn),open:Qe(Gg),phoneNumber:Qe(Vn),visibility:Qe(Gg)}),Jgt=At(Xt,{href:Qe(s2e)}),Qgt=At(Xt,{Altitude:Qe(gr),Longitude:Qe(gr),Latitude:Qe(gr),Tilt:Qe(gr),AltitudeMode:Qe(Vn),Heading:Qe(gr),Roll:Qe(gr)}),n2e=At(Xt,{LatLonAltBox:j0t,Lod:V0t}),e0t=At(Xt,["Document","Placemark"]),t0t=At(Xt,{Document:pt(Q0t),Placemark:pt(x2e)});let lw,JM=null,KV,CT,MT,NT,TN,YV=null,SH,XV=null,ZV,$y=null,Nse=null,JV=null;function kN(t){return 32/Math.min(t[0],t[1])}function n0t(){lw=[255,255,255,1],JM=new Nr({color:lw}),KV=[20,2],CT="pixels",MT="pixels",NT=[64,64],TN="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",YV=new kA({anchor:KV,anchorOrigin:"bottom-left",anchorXUnits:CT,anchorYUnits:MT,crossOrigin:"anonymous",rotation:0,scale:kN(NT),size:NT,src:TN}),SH="NO_IMAGE",XV=new Sr({color:lw,width:1}),ZV=new Sr({color:[51,51,51,1],width:2}),$y=new th({font:"bold 16px Helvetica",fill:JM,stroke:ZV,scale:.8}),Nse=new zn({fill:JM,image:YV,text:$y,stroke:XV,zIndex:0}),JV=[Nse]}let cC;function r0t(t){return t}class i0t extends Jwe{constructor(e){super(),e=e||{},JV||n0t(),this.dataProjection=Yr("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:JV,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:r0t,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,n){const r=At(Xt,{Document:Cse(this.readDocumentOrFolder_,this),Folder:Cse(this.readDocumentOrFolder_,this),Placemark:qu(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=tr([],r,e,n,this);if(i)return i}readPlacemark_(e,n){const r=tr({geometry:null},Xgt,e,n,this);if(!r)return;const i=new xi,s=e.getAttribute("id");s!==null&&i.setId(s);const o=n[0],a=r.geometry;if(a&&fh(a,!1,o),i.setGeometry(a),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,u=o0t(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(u)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,n){const r=e.getAttribute("id");if(r!==null){const i=kH.call(this,e,n);if(i){let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,n){const r=e.getAttribute("id");if(r===null)return;const i=l2e.call(this,e,n);if(!i)return;let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,n){if(!Xt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return r||null}readFeaturesFromNode(e,n){if(!Xt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,n)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const o=this.readFeaturesFromNode(s,n);o&&Rr(r,o)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const n=Uf(e);return this.readNameFromDocument(n)}return zf(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(n);if(r)return r}}readNameFromNode(e){for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(Xt.includes(n.namespaceURI)&&n.localName=="name")return Vn(n);for(let n=e.firstElementChild;n;n=n.nextElementSibling){const r=n.localName;if(Xt.includes(n.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(n);if(i)return i}}}readNetworkLinks(e){const n=[];if(typeof e=="string"){const r=Uf(e);Rr(n,this.readNetworkLinksFromDocument(r))}else zf(e)?Rr(n,this.readNetworkLinksFromDocument(e)):Rr(n,this.readNetworkLinksFromNode(e));return n}readNetworkLinksFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Rr(n,this.readNetworkLinksFromNode(r));return n}readNetworkLinksFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=tr({},Zgt,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Rr(n,this.readNetworkLinksFromNode(r))}return n}readRegion(e){const n=[];if(typeof e=="string"){const r=Uf(e);Rr(n,this.readRegionFromDocument(r))}else zf(e)?Rr(n,this.readRegionFromDocument(e)):Rr(n,this.readRegionFromNode(e));return n}readRegionFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Rr(n,this.readRegionFromNode(r));return n}readRegionFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName=="Region"){const i=tr({},n2e,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Rr(n,this.readRegionFromNode(r))}return n}readCamera(e){const n=[];if(typeof e=="string"){const r=Uf(e);Rr(n,this.readCameraFromDocument(r))}else zf(e)?Rr(n,this.readCameraFromDocument(e)):Rr(n,this.readCameraFromNode(e));return n}readCameraFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Rr(n,this.readCameraFromNode(r));return n}readCameraFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=tr({},Qgt,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Rr(n,this.readCameraFromNode(r))}return n}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=uv(Xt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Ep[0]),r.setAttributeNS(i,"xmlns:xsi",EN),r.setAttributeNS(EN,"xsi:schemaLocation",Ygt);const s={node:r},o={};e.length>1?o.Document=e:e.length==1&&(o.Placemark=e[0]);const a=e0t[r.namespaceURI],l=El(o,a);return ei(s,t0t,pa,l,[n],a,this),r}}function s0t(t,e){const n=[0,0];let r="start";const i=t.getImage();if(i){const a=i.getSize();if(a&&a.length==2){const l=i.getScaleArray(),c=i.getAnchor();n[0]=l[0]*(a[0]-c[0]),n[1]=l[1]*(a[1]/2-c[1]),r="left"}}let s=t.getText();return s?(s=s.clone(),s.setFont(s.getFont()||$y.getFont()),s.setScale(s.getScale()||$y.getScale()),s.setFill(s.getFill()||$y.getFill()),s.setStroke(s.getStroke()||ZV)):s=$y.clone(),s.setText(e),s.setOffsetX(n[0]),s.setOffsetY(n[1]),s.setTextAlign(r),new zn({image:i,text:s})}function o0t(t,e,n,r,i){return(function(s,o){let a=i,l="",c=[];if(a){const h=s.getGeometry();if(h)if(h instanceof eh)c=h.getGeometriesArrayRecursive().filter(function(f){const g=f.getType();return g==="Point"||g==="MultiPoint"}),a=c.length>0;else{const f=h.getType();a=f==="Point"||f==="MultiPoint"}}a&&(l=s.get("name"),a=a&&!!l,a&&/&[^&]+;/.test(l)&&(cC||(cC=document.createElement("textarea")),cC.innerHTML=l,l=cC.value));let u=n;if(t?u=t:e&&(u=r2e(e,n,r)),a){const h=s0t(u[0],l);if(c.length>0){h.setGeometry(new eh(c));const f=new zn({geometry:u[0].getGeometry(),image:null,fill:u[0].getFill(),stroke:u[0].getStroke(),text:null});return[h,f].concat(u.slice(1))}return h}return u})}function r2e(t,e,n){return Array.isArray(t)?t:typeof t=="string"?r2e(n[t],e,n):e}function rL(t){const e=ph(t,!1),n=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(n){const r=n[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function i2e(t){let e=ph(t,!1);const n=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),o=parseFloat(i[2]),a=i[3]?parseFloat(i[3]):0;n.push(s,o,a),e=e.substr(i[0].length)}if(e==="")return n}function s2e(t){const e=ph(t,!1).trim();let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function o2e(t){const e=ph(t,!1).trim().replace(/^(?!.*#)/,"#");let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function a0t(t){const e=t.getAttribute("xunits"),n=t.getAttribute("yunits");let r;return e!=="insetPixels"?n!=="insetPixels"?r="bottom-left":r="top-left":n!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(t.getAttribute("x")),xunits:Mse[e],y:parseFloat(t.getAttribute("y")),yunits:Mse[n],origin:r}}function a2e(t){return gr(t)}const l0t=At(Xt,{Pair:M0t});function l2e(t,e){return tr(void 0,l0t,t,e,this)}const c0t=At(Xt,{Icon:Qe(E0t),color:Qe(rL),heading:Qe(gr),hotSpot:Qe(a0t),scale:Qe(a2e)});function u0t(t,e){const n=tr({},c0t,t,e);if(!n)return;const r=e[e.length-1],i="Icon"in n?n.Icon:{},s=!("Icon"in n)||Object.keys(i).length>0;let o;const a=i.href;a?o=a:s&&(o=TN);let l,c,u,h="bottom-left";const f=n.hotSpot;f?(l=[f.x,f.y],c=f.xunits,u=f.yunits,h=f.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(o)&&(o.includes("pushpin")?(l=KV,c=CT,u=MT):o.includes("arrow-reverse")?(l=[54,42],c=CT,u=MT):o.includes("paddle")&&(l=[32,1],c=CT,u=MT));let g;const v=i.x,x=i.y;v!==void 0&&x!==void 0&&(g=[v,x]);let b;const T=i.w,A=i.h;T!==void 0&&A!==void 0&&(b=[T,A]);let I;const R=n.heading;R!==void 0&&(I=Wf(R));const M=n.scale,F=n.color;if(s){o==TN&&(b=NT);const C=new kA({anchor:l,anchorOrigin:h,anchorXUnits:c,anchorYUnits:u,crossOrigin:this.crossOrigin_,offset:g,offsetOrigin:"bottom-left",rotation:I,scale:M,size:b,src:this.iconUrlFunction_(o),color:F}),N=C.getScaleArray()[0],O=C.getSize();if(O===null){const j=C.getImageState();if(j===Vt.IDLE||j===Vt.LOADING){const V=function(){const W=C.getImageState();if(!(W===Vt.IDLE||W===Vt.LOADING)){const U=C.getSize();if(U&&U.length==2){const pe=kN(U);C.setScale(N*pe)}C.unlistenImageChange(V)}};C.listenImageChange(V),j===Vt.IDLE&&C.load()}}else if(O.length==2){const j=kN(O);C.setScale(N*j)}r.imageStyle=C}else r.imageStyle=SH}const h0t=At(Xt,{color:Qe(rL),scale:Qe(a2e)});function d0t(t,e){const n=tr({},h0t,t,e);if(!n)return;const r=e[e.length-1],i=new th({fill:new Nr({color:"color"in n?n.color:lw}),scale:n.scale});r.textStyle=i}const f0t=At(Xt,{color:Qe(rL),width:Qe(gr)});function p0t(t,e){const n=tr({},f0t,t,e);if(!n)return;const r=e[e.length-1],i=new Sr({color:"color"in n?n.color:lw,width:"width"in n?n.width:1});r.strokeStyle=i}const m0t=At(Xt,{color:Qe(rL),fill:Qe(Gg),outline:Qe(Gg)});function g0t(t,e){const n=tr({},m0t,t,e);if(!n)return;const r=e[e.length-1],i=new Nr({color:"color"in n?n.color:lw});r.fillStyle=i;const s=n.fill;s!==void 0&&(r.fill=s);const o=n.outline;o!==void 0&&(r.outline=o)}const y0t=At(Xt,{coordinates:_H(i2e)});function c2e(t,e){return tr(null,y0t,t,e)}function v0t(t,e){const r=e[e.length-1].coordinates,i=ph(t,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(o){const a=parseFloat(o[1]),l=parseFloat(o[2]),c=parseFloat(o[3]);r.push([a,l,c])}else r.push([])}const _0t=At(Ep,{Track:qu(u2e)});function x0t(t,e){const n=tr([],_0t,t,e);if(n)return new np(n)}const w0t=At(Xt,{when:H0t},At(Ep,{coord:v0t}));function u2e(t,e){const n=tr({coordinates:[],whens:[]},w0t,t,e);if(!n)return;const r=[],i=n.coordinates,s=n.whens;for(let o=0,a=Math.min(i.length,s.length);o<a;++o)i[o].length==3&&r.push(i[o][0],i[o][1],i[o][2],s[o]);return new ro(r,"XYZM")}const b0t=At(Xt,{href:Qe(s2e)},At(Ep,{x:Qe(gr),y:Qe(gr),w:Qe(gr),h:Qe(gr)}));function E0t(t,e){const n=tr({},b0t,t,e);return n||null}const S0t=At(Xt,{coordinates:_H(i2e)});function TH(t,e){return tr(null,S0t,t,e)}const iL=At(Xt,{extrude:Qe(Gg),tessellate:Qe(Gg),altitudeMode:Qe(Vn)});function h2e(t,e){const n=tr({},iL,t,e),r=TH(t,e);if(r){const i=new ro(r,"XYZ");return i.setProperties(n,!0),i}}function d2e(t,e){const n=tr({},iL,t,e),r=TH(t,e);if(r){const i=new ou(r,"XYZ",[r.length]);return i.setProperties(n,!0),i}}const T0t=At(Xt,{LineString:qu(h2e),LinearRing:qu(d2e),MultiGeometry:qu(f2e),Point:qu(p2e),Polygon:qu(m2e)});function f2e(t,e){const n=tr([],T0t,t,e);if(!n)return null;if(n.length===0)return new eh(n);let r,i=!0;const s=n[0].getType();let o;for(let a=1,l=n.length;a<l;++a)if(o=n[a],o.getType()!=s){i=!1;break}if(i){let a,l;if(s=="Point"){const c=n[0];a=c.getLayout(),l=c.getFlatCoordinates();for(let u=1,h=n.length;u<h;++u)o=n[u],Rr(l,o.getFlatCoordinates());r=new X1(l,a),k8(r,n)}else if(s=="LineString")r=new np(n),k8(r,n);else if(s=="Polygon")r=new p1(n),k8(r,n);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new eh(n);else throw new Error("Unknown geometry type found")}else r=new eh(n);return r}function p2e(t,e){const n=tr({},iL,t,e),r=TH(t,e);if(r){const i=new Vs(r,"XYZ");return i.setProperties(n,!0),i}}const k0t=At(Xt,{innerBoundaryIs:U0t,outerBoundaryIs:B0t});function m2e(t,e){const n=tr({},iL,t,e),r=tr([null],k0t,t,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let a=1,l=r.length;a<l;++a)Rr(i,r[a]),s.push(i.length);const o=new ou(i,"XYZ",s);return o.setProperties(n,!0),o}}const A0t=At(Xt,{IconStyle:u0t,LabelStyle:d0t,LineStyle:p0t,PolyStyle:g0t});function kH(t,e){const n=tr({},A0t,t,e,this);if(!n)return null;let r="fillStyle"in n?n.fillStyle:JM;const i=n.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in n?n.imageStyle!=SH&&(s=n.imageStyle):s=YV;const o="textStyle"in n?n.textStyle:$y,a="strokeStyle"in n?n.strokeStyle:XV,l=n.outline;return l!==void 0&&!l?[new zn({geometry:function(c){const u=c.getGeometry(),h=u.getType();if(h==="GeometryCollection"){const f=u;return new eh(f.getGeometriesArrayRecursive().filter(function(g){const v=g.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(h!=="Polygon"&&h!=="MultiPolygon")return u},fill:r,image:s,stroke:a,text:o,zIndex:void 0}),new zn({geometry:function(c){const u=c.getGeometry(),h=u.getType();if(h==="GeometryCollection"){const f=u;return new eh(f.getGeometriesArrayRecursive().filter(function(g){const v=g.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(h==="Polygon"||h==="MultiPolygon")return u},fill:r,stroke:null,zIndex:void 0})]:[new zn({fill:r,image:s,stroke:a,text:o,zIndex:void 0})]}function k8(t,e){const n=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let o,a,l;o=!1,a=!1,l=!1;for(let c=0;c<n;++c){const u=e[c];r[c]=u.get("extrude"),i[c]=u.get("tessellate"),s[c]=u.get("altitudeMode"),o=o||r[c]!==void 0,a=a||i[c]!==void 0,l=l||s[c]}o&&t.set("extrude",r),a&&t.set("tessellate",i),l&&t.set("altitudeMode",s)}const I0t=At(Xt,{displayName:Qe(Vn),value:Qe(Vn)});function R0t(t,e){const n=t.getAttribute("name");t0(I0t,t,e);const r=e[e.length-1];n&&r.displayName?r[n]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:n!==null?r[n]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const P0t=At(Xt,{Data:R0t,SchemaData:L0t});function g2e(t,e){t0(P0t,t,e)}function y2e(t,e){t0(n2e,t,e)}const C0t=At(Xt,{Style:Qe(kH),key:Qe(Vn),styleUrl:Qe(o2e)});function M0t(t,e){const n=tr({},C0t,t,e,this);if(!n)return;const r=n.key;if(r&&r=="normal"){const i=n.styleUrl;i&&(e[e.length-1]=i);const s=n.Style;s&&(e[e.length-1]=s)}}function N0t(t,e){const n=l2e.call(this,t,e);if(!n)return;const r=e[e.length-1];if(Array.isArray(n))r.Style=n;else if(typeof n=="string")r.styleUrl=n;else throw new Error("`styleMapValue` has an unknown type")}const O0t=At(Xt,{SimpleData:D0t});function L0t(t,e){t0(O0t,t,e)}function D0t(t,e){const n=t.getAttribute("name");if(n!==null){const r=Vn(t),i=e[e.length-1];i[n]=r}}const $0t=At(Xt,{altitudeMode:Qe(Vn),minAltitude:Qe(gr),maxAltitude:Qe(gr),north:Qe(gr),south:Qe(gr),east:Qe(gr),west:Qe(gr)});function j0t(t,e){const n=tr({},$0t,t,e);if(!n)return;const r=e[e.length-1],i=[parseFloat(n.west),parseFloat(n.south),parseFloat(n.east),parseFloat(n.north)];r.extent=i,r.altitudeMode=n.altitudeMode,r.minAltitude=parseFloat(n.minAltitude),r.maxAltitude=parseFloat(n.maxAltitude)}const F0t=At(Xt,{minLodPixels:Qe(gr),maxLodPixels:Qe(gr),minFadeExtent:Qe(gr),maxFadeExtent:Qe(gr)});function V0t(t,e){const n=tr({},F0t,t,e);if(!n)return;const r=e[e.length-1];r.minLodPixels=parseFloat(n.minLodPixels),r.maxLodPixels=parseFloat(n.maxLodPixels),r.minFadeExtent=parseFloat(n.minFadeExtent),r.maxFadeExtent=parseFloat(n.maxFadeExtent)}const z0t=At(Xt,{LinearRing:qu(c2e)});function U0t(t,e){const n=tr([],z0t,t,e);n.length>0&&e[e.length-1].push(...n)}const G0t=At(Xt,{LinearRing:_H(c2e)});function B0t(t,e){const n=tr(void 0,G0t,t,e);if(n){const r=e[e.length-1];r[0]=n}}function W0t(t,e){t0(Jgt,t,e)}function H0t(t,e){const r=e[e.length-1].whens,i=ph(t,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function sL(t,e){const n=su(e),i=[(n.length==4?n[3]:1)*255,n[2],n[1],n[0]];for(let s=0;s<4;++s){const o=Math.floor(i[s]).toString(16);i[s]=o.length==1?"0"+o:o}br(t,i.join(""))}function q0t(t,e,n){const r=n[n.length-1],i=r.layout,s=r.stride;let o;if(i=="XY"||i=="XYM")o=2;else if(i=="XYZ"||i=="XYZM")o=3;else throw new Error("Invalid geometry layout");const a=e.length;let l="";if(a>0){l+=e[0];for(let c=1;c<o;++c)l+=","+e[c];for(let c=s;c<a;c+=s){l+=" "+e[c];for(let u=1;u<o;++u)l+=","+e[c+u]}}br(t,l)}const QM=At(Xt,{Data:pt(K0t),value:pt(X0t),displayName:pt(Y0t)});function K0t(t,e,n){t.setAttribute("name",e.name);const r={node:t},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&ei(r,QM,pa,[i.displayName],n,["displayName"]),i!==null&&i.value&&ei(r,QM,pa,[i.value],n,["value"])):ei(r,QM,pa,[i],n,["value"])}function Y0t(t,e){br(t,e)}function X0t(t,e){br(t,e)}const Z0t=At(Xt,{Placemark:pt(x2e)}),J0t=function(t,e,n){const r=e[e.length-1].node;return uv(r.namespaceURI,"Placemark")};function Q0t(t,e,n){ei({node:t},Z0t,J0t,e,n,void 0,this)}const eyt=mh("Data");function tyt(t,e,n){const r={node:t},i=e.names,s=e.values,o=i.length;for(let a=0;a<o;a++)ei(r,QM,eyt,[{name:i[a],value:s[a]}],n)}const Ose=At(Xt,["href"],At(Ep,["x","y","w","h"])),Lse=At(Xt,{href:pt(br)},At(Ep,{x:pt(ll),y:pt(ll),w:pt(ll),h:pt(ll)})),nyt=function(t,e,n){return uv(Ep[0],"gx:"+n)};function ryt(t,e,n){const r={node:t},i=n[n.length-1].node;let s=Ose[i.namespaceURI],o=El(e,s);ei(r,Lse,pa,o,n,s),s=Ose[Ep[0]],o=El(e,s),ei(r,Lse,nyt,o,n,s)}const iyt=At(Xt,["scale","heading","Icon","color","hotSpot"]),syt=At(Xt,{Icon:pt(ryt),color:pt(sL),heading:pt(ll),hotSpot:pt(Myt),scale:pt(b2e)});function oyt(t,e,n){const r={node:t},i={},s=e.getSrc(),o=e.getSize(),a=e.getImageSize(),l={href:s};if(o){l.w=o[0],l.h=o[1];const b=e.getAnchor(),T=e.getOrigin();if(T&&a&&T[0]!==0&&T[1]!==o[1]&&(l.x=T[0],l.y=a[1]-(T[1]+o[1])),b&&(b[0]!==o[0]/2||b[1]!==o[1]/2)){const A={x:b[0],xunits:"pixels",y:o[1]-b[1],yunits:"pixels"};i.hotSpot=A}}i.Icon=l;let c=e.getScaleArray()[0],u=o;if(u===null&&(u=NT),u.length==2){const b=kN(u);c=c/b}c!==1&&(i.scale=c);const h=e.getRotation();h!==0&&(i.heading=h);const f=e.getColor();f&&(i.color=f);const g=n[n.length-1].node,v=iyt[g.namespaceURI],x=El(i,v);ei(r,syt,pa,x,n,v)}const ayt=At(Xt,["color","scale"]),lyt=At(Xt,{color:pt(sL),scale:pt(b2e)});function cyt(t,e,n){const r={node:t},i={},s=e.getFill();s&&(i.color=s.getColor());const o=e.getScale();o&&o!==1&&(i.scale=o);const a=n[n.length-1].node,l=ayt[a.namespaceURI],c=El(i,l);ei(r,lyt,pa,c,n,l)}const uyt=At(Xt,["color","width"]),hyt=At(Xt,{color:pt(sL),width:pt(ll)});function dyt(t,e,n){const r={node:t},i={color:e.getColor(),width:Number(e.getWidth())||1},s=n[n.length-1].node,o=uyt[s.namespaceURI],a=El(i,o);ei(r,hyt,pa,a,n,o)}const fyt={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},v2e=function(t,e,n){if(t){const r=e[e.length-1].node;return uv(r.namespaceURI,fyt[t.getType()])}},pyt=mh("Point"),myt=mh("LineString"),gyt=mh("LinearRing"),yyt=mh("Polygon"),vyt=At(Xt,{LineString:pt(cw),Point:pt(cw),Polygon:pt(w2e),GeometryCollection:pt(_2e)});function _2e(t,e,n){const r={node:t},i=e.getType();let s=[],o;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(a){const l=a.getType();if(l==="MultiPoint")s=s.concat(a.getPoints());else if(l==="MultiLineString")s=s.concat(a.getLineStrings());else if(l==="MultiPolygon")s=s.concat(a.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(a);else throw new Error("Unknown geometry type")}),o=v2e;else if(i==="MultiPoint")s=e.getPoints(),o=pyt;else if(i==="MultiLineString")s=e.getLineStrings(),o=myt;else if(i==="MultiPolygon")s=e.getPolygons(),o=yyt;else throw new Error("Unknown geometry type");ei(r,vyt,o,s,n)}const _yt=At(Xt,{LinearRing:pt(cw)});function Dse(t,e,n){ei({node:t},_yt,gyt,[e],n)}const A8=At(Xt,{ExtendedData:pt(tyt),MultiGeometry:pt(_2e),LineString:pt(cw),LinearRing:pt(cw),Point:pt(cw),Polygon:pt(w2e),Style:pt(Cyt),address:pt(br),description:pt(br),name:pt(br),open:pt(I2),phoneNumber:pt(br),styleUrl:pt(br),visibility:pt(I2)}),xyt=At(Xt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),wyt=mh("ExtendedData");function x2e(t,e,n){const r={node:t};e.getId()&&t.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const o=Object.keys(i||{}).sort().filter(function(g){return!s[g]}),a=e.getStyleFunction();if(a){const g=a(e,0);if(g){const v=Array.isArray(g)?g:[g];let x=v;if(e.getGeometry()&&(x=v.filter(function(b){const T=b.getGeometryFunction()(e);if(T){const A=T.getType();return A==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(I){const R=I.getType();return R==="Point"||R==="MultiPoint"}).length:A==="Point"||A==="MultiPoint"}})),this.writeStyles_){let b=v,T=v;e.getGeometry()&&(b=v.filter(function(A){const I=A.getGeometryFunction()(e);if(I){const R=I.getType();return R==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(M){const F=M.getType();return F==="LineString"||F==="MultiLineString"}).length:R==="LineString"||R==="MultiLineString"}}),T=v.filter(function(A){const I=A.getGeometryFunction()(e);if(I){const R=I.getType();return R==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(M){const F=M.getType();return F==="Polygon"||F==="MultiPolygon"}).length:R==="Polygon"||R==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:b,polyStyles:T}}if(x.length&&i.name===void 0){const b=x[0].getText();b&&(i.name=b.getText())}}}const l=n[n.length-1].node,c=xyt[l.namespaceURI],u=El(i,c);if(ei(r,A8,pa,u,n,c),o.length>0){const g=El(i,o);ei(r,A8,wyt,[{names:o,values:g}],n)}const h=n[0];let f=e.getGeometry();f&&(f=fh(f,!0,h)),ei(r,A8,v2e,[f],n)}const byt=At(Xt,["extrude","tessellate","altitudeMode","coordinates"]),Eyt=At(Xt,{extrude:pt(I2),tessellate:pt(I2),altitudeMode:pt(br),coordinates:pt(q0t)});function cw(t,e,n){const r=e.getFlatCoordinates(),i={node:t};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const o=n[n.length-1].node,a=byt[o.namespaceURI],l=El(s,a);ei(i,Eyt,pa,l,n,a)}const Syt=At(Xt,["color","fill","outline"]),$se=At(Xt,{outerBoundaryIs:pt(Dse),innerBoundaryIs:pt(Dse)}),Tyt=mh("innerBoundaryIs"),kyt=mh("outerBoundaryIs");function w2e(t,e,n){const r=e.getLinearRings(),i=r.shift(),s={node:t};ei(s,$se,Tyt,r,n),ei(s,$se,kyt,[i],n)}const Ayt=At(Xt,{color:pt(sL),fill:pt(I2),outline:pt(I2)});function Iyt(t,e,n){const r={node:t},i=e.getFill(),s=e.getStroke(),o={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},a=n[n.length-1].node,l=Syt[a.namespaceURI],c=El(o,l);ei(r,Ayt,pa,c,n,l)}function b2e(t,e){ll(t,Math.round(e*1e6)/1e6)}const Ryt=At(Xt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Pyt=At(Xt,{IconStyle:pt(oyt),LabelStyle:pt(cyt),LineStyle:pt(dyt),PolyStyle:pt(Iyt)});function Cyt(t,e,n){const r={node:t},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=n[n.length-1].node,o=Ryt[s.namespaceURI],a=El(i,o);ei(r,Pyt,pa,a,n,o)}function Myt(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)}function E2e(t){const e=Object.keys(t.defs),n=e.length;let r,i;for(r=0;r<n;++r){const s=e[r];if(!xC(s)){const o=t.defs(s);let a=o.units;!a&&o.projName==="longlat"&&(a="degrees"),o3(new YN({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a}))}}for(r=0;r<n;++r){const s=e[r],o=xC(s);for(i=0;i<n;++i){const a=e[i],l=xC(a);if(!wC(s,a))if(t.defs[s]===t.defs[a])X8([o,l]);else{const c=t(s,a);vTe(o,l,PY(o,l,c.forward),PY(l,o,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");sr.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");E2e(sr);let jy=null,OT=null,cx=null;function QV(t){jy&&(t.removeLayer(jy),jy=null),OT&&(t.removeLayer(OT),OT=null),cx=null}async function Nyt(t,e){try{const n=Zn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${n[0].toFixed(5)}, ${n[1].toFixed(5)}`);const r=sr("EPSG:4326","EPSG:28992",n);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;QV(t);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,o=Date.now(),a=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${o}`;console.log(" WFS URL:",a);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),u=await fetch(a,{signal:l.signal});if(clearTimeout(c),!u.ok)return console.error("WFS request failed:",u.status),!1;const h=await u.json();if(console.log(" WFS RESPONSE:",JSON.stringify(h).substring(0,500)),!h.features||h.features.length===0)return console.log("No parcel found at location"),!1;const f=h.features[0];console.log(" PARCEL ID:",f.id||f.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(f.bbox||"geen bbox"));const v=new eL().readFeature(f,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=v.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const b=f.properties||{};console.log(` Parcel: ${b.category||"unknown"} - ${b.gewasnaam||b.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(O=>O.toFixed(0)).join(", ")}`);const T=x.getExtent(),A=T[2]-T[0],I=T[3]-T[1],R=Math.max(A,I)*.05,M=[T[0]-R,T[1]-R,T[2]+R,T[3]+R],F=Math.max(A,I)*.3,C=[T[0]-F,T[1]-F,T[2]+F,T[3]+F];cx=x,jy=new sRe({source:new MRe({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:M,zIndex:998}),jy.on("prerender",O=>{if(!cx)return;const j=O.context;if(!j)return;const V=O.frameState;if(!V)return;j.save(),j.beginPath(),(cx.getType()==="Polygon"?cx.getCoordinates()[0]:cx.getCoordinates()[0][0]).forEach((U,pe)=>{const Ne=t.getPixelFromCoordinate(U);if(!Ne)return;const Se=V.pixelRatio,je=Ne[0]*Se,de=Ne[1]*Se;pe===0?j.moveTo(je,de):j.lineTo(je,de)}),j.closePath(),j.clip()}),jy.on("postrender",O=>{const j=O.context;j&&j.restore()}),t.addLayer(jy);const N=new Od({features:[v]});return OT=new gp({source:N,style:new zn({fill:new Nr({color:"rgba(0, 0, 0, 0)"}),stroke:new Sr({color:"#dc2626",width:3})}),zIndex:999}),t.addLayer(OT),console.log(" Parcel height map displayed"),!0}catch(n){return console.error("Failed to show parcel height map:",n),!1}}var AN={};AN.version="0.18.5";var S2e=1252,Oyt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],T2e=function(t){Oyt.indexOf(t)!=-1&&(S2e=t)};function Lyt(){T2e(1252)}var oA=function(t){T2e(t)};function Dyt(){oA(1200),Lyt()}var uC=function(e){return String.fromCharCode(e)},jse=function(e){return String.fromCharCode(e)},IN,rg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function aA(t){for(var e="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,c=0;c<t.length;)n=t.charCodeAt(c++),s=n>>2,r=t.charCodeAt(c++),o=(n&3)<<4|r>>4,i=t.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),e+=rg.charAt(s)+rg.charAt(o)+rg.charAt(a)+rg.charAt(l);return e}function dp(t){var e="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=rg.indexOf(t.charAt(c++)),o=rg.indexOf(t.charAt(c++)),n=s<<2|o>>4,e+=String.fromCharCode(n),a=rg.indexOf(t.charAt(c++)),r=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=rg.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var wr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Sp=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function G1(t){return wr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Fse(t){return wr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ku=function(e){return wr?Sp(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function oL(t){if(typeof ArrayBuffer>"u")return Ku(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function LI(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function $yt(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Ro=wr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Sp(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),i=0;for(e=0,n=0;e<t.length;n+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function jyt(t){for(var e=[],n=0,r=t.length+250,i=G1(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(e.push(i.slice(0,n)),n=0,i=G1(65535),r=65530)}return e.push(i.slice(0,n)),Ro(e)}var LT=/\u0000/g,hC=/[\u0001-\u0006]/g;function uw(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function Qu(t,e){var n=""+t;return n.length>=e?n:Xi("0",e-n.length)+n}function AH(t,e){var n=""+t;return n.length>=e?n:Xi(" ",e-n.length)+n}function RN(t,e){var n=""+t;return n.length>=e?n:n+Xi(" ",e-n.length)}function Fyt(t,e){var n=""+Math.round(t);return n.length>=e?n:Xi("0",e-n.length)+n}function Vyt(t,e){var n=""+t;return n.length>=e?n:Xi("0",e-n.length)+n}var Vse=Math.pow(2,32);function S_(t,e){if(t>Vse||t<-Vse)return Fyt(t,e);var n=Math.round(t);return Vyt(n,e)}function PN(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var zse=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],I8=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zyt(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var es={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Use={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Uyt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function CN(t,e,n){for(var r=t<0?-1:1,i=t*r,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!n)return[0,r*a,u];var f=Math.floor(r*a/u);return[f,r*a-f*u,u]}function dC(t,e,n){if(t>2958465||t<0)return null;var r=t|0,i=Math.floor(86400*(t-r)),s=0,o=[],a={D:r,T:i,u:86400*(t-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=Yyt(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var k2e=new Date(1899,11,31,0,0,0),Gyt=k2e.getTime(),Byt=new Date(1900,2,1,0,0,0);function A2e(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=Byt&&(n+=1440*60*1e3),(n-(Gyt+(t.getTimezoneOffset()-k2e.getTimezoneOffset())*6e4))/(1440*60*1e3)}function IH(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wyt(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Hyt(t){var e=t<0?12:11,n=IH(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function qyt(t){var e=IH(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Kyt(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=Hyt(t):e===10?n=t.toFixed(10).substr(0,12):n=qyt(t),IH(Wyt(n.toUpperCase()))}function ez(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Kyt(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Bg(14,A2e(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Yyt(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function Xyt(t,e,n,r){var i="",s=0,o=0,a=n.y,l,c=0;switch(t){case 98:a=n.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=n.m,c=e.length;break;case 3:return I8[n.m-1][1];case 5:return I8[n.m-1][0];default:return I8[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=n.d,c=e.length;break;case 3:return zse[n.q][0];default:return zse[n.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(n.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=n.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=n.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?Qu(n.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=Qu(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Qu(l,c):"";return u}function ig(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var I2e=/%/g;function Zyt(t,e,n){var r=e.replace(I2e,""),i=e.length-r.length;return Qf(t,r,n*Math.pow(10,2*i))+Xi("%",i)}function Jyt(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Qf(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function R2e(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+R2e(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var P2e=/# (\?+)( ?)\/( ?)(\d+)/;function Qyt(t,e,n){var r=parseInt(t[4],10),i=Math.round(e*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?Xi(" ",t[1].length+1+t[4].length):AH(o,t[1].length)+t[2]+"/"+t[3]+Qu(a,t[4].length))}function e1t(t,e,n){return n+(e===0?"":""+e)+Xi(" ",t[1].length+2+t[4].length)}var C2e=/^#*0*\.([0#]+)/,M2e=/\).*[0#]/,N2e=/\(###\) ###\\?-####/;function Ta(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function Gse(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function Bse(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function t1t(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function n1t(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Nc(t,e,n){if(t.charCodeAt(0)===40&&!e.match(M2e)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Nc("n",r,n):"("+Nc("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return Jyt(t,e,n);if(e.indexOf("%")!==-1)return Zyt(t,e,n);if(e.indexOf("E")!==-1)return R2e(e,n);if(e.charCodeAt(0)===36)return"$"+Nc(t,e.substr(e.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+S_(l,e.length);if(e.match(/^[#?]+$/))return i=S_(n,0),i==="0"&&(i=""),i.length>e.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(P2e))return Qyt(s,l,c);if(e.match(/^#+0+$/))return c+S_(l,e.length-e.indexOf("0"));if(s=e.match(C2e))return i=Gse(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Ta(s[1])).replace(/\.$/,"."+Ta(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Xi("0",Ta(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Gse(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ig(S_(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Nc(t,e,-n):ig(""+(Math.floor(n)+t1t(n,s[1].length)))+"."+Qu(Bse(n,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Nc(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=uw(Nc(t,e.replace(/[\\-]/g,""),n)),o=0,uw(uw(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(e.match(N2e))return i=Nc(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=CN(l,Math.pow(10,o)-1,!1),i=""+c,u=Qf("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=RN(a[2],o),u.length<s[4].length&&(u=Ta(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=CN(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?AH(a[1],o)+s[2]+"/"+s[3]+RN(a[2],o):Xi(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=S_(n,0),e.length<=i.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ta(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=Bse(n,s[1].length),n<0?"-"+Nc(t,e,-n):ig(n1t(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Qu(0,3-v.length):"")+v})+"."+Qu(o,s[1].length);switch(e){case"###,##0.00":return Nc(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=ig(S_(l,0));return g!=="0"?c+g:"";case"###,###.00":return Nc(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Nc(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function r1t(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Qf(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function i1t(t,e,n){var r=e.replace(I2e,""),i=e.length-r.length;return Qf(t,r,n*Math.pow(10,2*i))+Xi("%",i)}function O2e(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+O2e(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bh(t,e,n){if(t.charCodeAt(0)===40&&!e.match(M2e)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bh("n",r,n):"("+Bh("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return r1t(t,e,n);if(e.indexOf("%")!==-1)return i1t(t,e,n);if(e.indexOf("E")!==-1)return O2e(e,n);if(e.charCodeAt(0)===36)return"$"+Bh(t,e.substr(e.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+Qu(l,e.length);if(e.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>e.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(P2e))return e1t(s,l,c);if(e.match(/^#+0+$/))return c+Qu(l,e.length-e.indexOf("0"));if(s=e.match(C2e))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Ta(s[1])).replace(/\.$/,"."+Ta(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Xi("0",Ta(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ig(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bh(t,e,-n):ig(""+n)+"."+Xi("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Bh(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=uw(Bh(t,e.replace(/[\\-]/g,""),n)),o=0,uw(uw(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(e.match(N2e))return i=Bh(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=CN(l,Math.pow(10,o)-1,!1),i=""+c,u=Qf("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=RN(a[2],o),u.length<s[4].length&&(u=Ta(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=CN(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?AH(a[1],o)+s[2]+"/"+s[3]+RN(a[2],o):Xi(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+n,e.length<=i.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ta(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bh(t,e,-n):ig(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Qu(0,3-v.length):"")+v})+"."+Qu(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=ig(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return Bh(t,e.slice(0,e.lastIndexOf(".")),n)+Ta(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qf(t,e,n){return(n|0)===n?Bh(t,e,n):Nc(t,e,n)}function s1t(t){for(var e=[],n=!1,r=0,i=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(i,r-i),i=r+1}if(e[e.length]=t.substr(i),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var L2e=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function D2e(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":PN(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(L2e))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function o1t(t,e,n,r){for(var i=[],s="",o=0,a="",l="t",c,u,h,f="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!PN(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=t.charAt(++o),v=g==="("||g===")"?g:"t";i[i.length]={t:v,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=dC(e,n,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=dC(e,n),c==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var x={t:a,v:a};if(c==null&&(c=dC(e,n)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",o+=5,f="h"):(x.t="t",++o),c==null&&x.t==="T")return"";i[i.length]=x,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(L2e)){if(c==null&&(c=dC(e,n),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",D2e(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var b=0,T=0,A;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",b<1&&(b=1);break;case"s":(A=i[o].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var I="",R;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Xyt(i[o].t.charCodeAt(0),i[o].v,c,T),i[o].t="t";break;case"n":case"?":for(R=o+1;i[R]!=null&&((a=i[R].t)==="?"||a==="D"||(a===" "||a==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[o].v+=i[R].v,i[R]={v:"",t:";"},++R;I+=i[o].v,o=R-1;break;case"G":i[o].t="t",i[o].v=ez(e,n);break}var M="",F,C;if(I.length>0){I.charCodeAt(0)==40?(F=e<0&&I.charCodeAt(0)===45?-e:e,C=Qf("n",I,F)):(F=e<0&&r>1?-e:e,C=Qf("n",I,F),F<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),R=C.length-1;var N=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){N=o;break}var O=i.length;if(N===i.length&&C.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(R>=i[o].v.length-1?(R-=i[o].v.length,i[o].v=C.substr(R+1,i[o].v.length)):R<0?i[o].v="":(i[o].v=C.substr(0,R+1),R=-1),i[o].t="t",O=o);R>=0&&O<i.length&&(i[O].v=C.substr(0,R+1)+i[O].v)}else if(N!==i.length&&C.indexOf("E")===-1){for(R=C.indexOf(".")-1,o=N;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===N?i[o].v.indexOf(".")-1:i[o].v.length-1,M=i[o].v.substr(u+1);u>=0;--u)R>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(M=C.charAt(R--)+M);i[o].v=M,i[o].t="t",O=o}for(R>=0&&O<i.length&&(i[O].v=C.substr(0,R+1)+i[O].v),R=C.indexOf(".")+1,o=N;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==N)){for(u=i[o].v.indexOf(".")>-1&&o===N?i[o].v.indexOf(".")+1:0,M=i[o].v.substr(0,u);u<i[o].v.length;++u)R<C.length&&(M+=C.charAt(R++));i[o].v=M,i[o].t="t",O=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(F=r>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Qf(i[o].t,i[o].v,F),i[o].t="t");var j="";for(o=0;o!==i.length;++o)i[o]!=null&&(j+=i[o].v);return j}var Wse=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hse(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function a1t(t,e){var n=s1t(t),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Wse),a=n[1].match(Wse);return Hse(e,o)?[r,n[0]]:Hse(e,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function Bg(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:es)[t],r==null&&(r=n.table&&n.table[Use[t]]||es[Use[t]]),r==null&&(r=Uyt[t]||"General");break}if(PN(r,0))return ez(e,n);e instanceof Date&&(e=A2e(e,n.date1904));var i=a1t(r,e);if(PN(i[1]))return ez(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return o1t(i[1],e,n,i[0])}function $2e(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(es[n]==null){e<0&&(e=n);continue}if(es[n]==t){e=n;break}}e<0&&(e=391)}return es[e]=t,e}function aL(t){for(var e=0;e!=392;++e)t[e]!==void 0&&$2e(t[e],e)}function lL(){es=zyt()}var j2e=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function l1t(t){var e=typeof t=="number"?es[t]:t;return e=e.replace(j2e,"(\\d+)"),new RegExp("^"+e+"$")}function c1t(t,e,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(j2e)||[]).forEach(function(h,f){var g=parseInt(n[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&s==-1?u:c+"T"+u}var u1t=(function(){var t={};t.version="1.2.0";function e(){for(var C=0,N=new Array(256),O=0;O!=256;++O)C=O,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,N[O]=C;return typeof Int32Array<"u"?new Int32Array(N):N}var n=e();function r(C){var N=0,O=0,j=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)V[j]=C[j];for(j=0;j!=256;++j)for(O=C[j],N=256+j;N<4096;N+=256)O=V[N]=O>>>8^C[O&255];var W=[];for(j=1;j!=16;++j)W[j-1]=typeof Int32Array<"u"?V.subarray(j*256,j*256+256):V.slice(j*256,j*256+256);return W}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],f=i[7],g=i[8],v=i[9],x=i[10],b=i[11],T=i[12],A=i[13],I=i[14];function R(C,N){for(var O=N^-1,j=0,V=C.length;j<V;)O=O>>>8^n[(O^C.charCodeAt(j++))&255];return~O}function M(C,N){for(var O=N^-1,j=C.length-15,V=0;V<j;)O=I[C[V++]^O&255]^A[C[V++]^O>>8&255]^T[C[V++]^O>>16&255]^b[C[V++]^O>>>24]^x[C[V++]]^v[C[V++]]^g[C[V++]]^f[C[V++]]^h[C[V++]]^u[C[V++]]^c[C[V++]]^l[C[V++]]^a[C[V++]]^o[C[V++]]^s[C[V++]]^n[C[V++]];for(j+=15;V<j;)O=O>>>8^n[(O^C[V++])&255];return~O}function F(C,N){for(var O=N^-1,j=0,V=C.length,W=0,U=0;j<V;)W=C.charCodeAt(j++),W<128?O=O>>>8^n[(O^W)&255]:W<2048?(O=O>>>8^n[(O^(192|W>>6&31))&255],O=O>>>8^n[(O^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,U=C.charCodeAt(j++)&1023,O=O>>>8^n[(O^(240|W>>8&7))&255],O=O>>>8^n[(O^(128|W>>2&63))&255],O=O>>>8^n[(O^(128|U>>6&15|(W&3)<<4))&255],O=O>>>8^n[(O^(128|U&63))&255]):(O=O>>>8^n[(O^(224|W>>12&15))&255],O=O>>>8^n[(O^(128|W>>6&63))&255],O=O>>>8^n[(O^(128|W&63))&255]);return~O}return t.table=n,t.bstr=R,t.buf=M,t.str=F,t})(),qr=(function(){var e={};e.version="1.2.1";function n(q,re){for(var J=q.split("/"),te=re.split("/"),se=0,oe=0,Ce=Math.min(J.length,te.length);se<Ce;++se){if(oe=J[se].length-te[se].length)return oe;if(J[se]!=te[se])return J[se]<te[se]?-1:1}return J.length-te.length}function r(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:r(q.slice(0,-1));var re=q.lastIndexOf("/");return re===-1?q:q.slice(0,re+1)}function i(q){if(q.charAt(q.length-1)=="/")return i(q.slice(0,-1));var re=q.lastIndexOf("/");return re===-1?q:q.slice(re+1)}function s(q,re){typeof re=="string"&&(re=new Date(re));var J=re.getHours();J=J<<6|re.getMinutes(),J=J<<5|re.getSeconds()>>>1,q.write_shift(2,J);var te=re.getFullYear()-1980;te=te<<4|re.getMonth()+1,te=te<<5|re.getDate(),q.write_shift(2,te)}function o(q){var re=q.read_shift(2)&65535,J=q.read_shift(2)&65535,te=new Date,se=J&31;J>>>=5;var oe=J&15;J>>>=4,te.setMilliseconds(0),te.setFullYear(J+1980),te.setMonth(oe-1),te.setDate(se);var Ce=re&31;re>>>=5;var Be=re&63;return re>>>=6,te.setHours(re),te.setMinutes(Be),te.setSeconds(Ce<<1),te}function a(q){Kl(q,0);for(var re={},J=0;q.l<=q.length-4;){var te=q.read_shift(2),se=q.read_shift(2),oe=q.l+se,Ce={};switch(te){case 21589:J=q.read_shift(1),J&1&&(Ce.mtime=q.read_shift(4)),se>5&&(J&2&&(Ce.atime=q.read_shift(4)),J&4&&(Ce.ctime=q.read_shift(4))),Ce.mtime&&(Ce.mt=new Date(Ce.mtime*1e3));break}q.l=oe,re[te]=Ce}return re}var l;function c(){return l||(l={})}function u(q,re){if(q[0]==80&&q[1]==75)return rn(q,re);if((q[0]|32)==109&&(q[1]|32)==105)return Je(q,re);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var J=3,te=512,se=0,oe=0,Ce=0,Be=0,Pe=0,Le=[],De=q.slice(0,512);Kl(De,0);var at=h(De);switch(J=at[0],J){case 3:te=512;break;case 4:te=4096;break;case 0:if(at[1]==0)return rn(q,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}te!==512&&(De=q.slice(0,te),Kl(De,28));var gt=q.slice(0,te);f(De,J);var Rt=De.read_shift(4,"i");if(J===3&&Rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Rt);De.l+=4,Ce=De.read_shift(4,"i"),De.l+=4,De.chk("00100000","Mini Stream Cutoff Size: "),Be=De.read_shift(4,"i"),se=De.read_shift(4,"i"),Pe=De.read_shift(4,"i"),oe=De.read_shift(4,"i");for(var ct=-1,ut=0;ut<109&&(ct=De.read_shift(4,"i"),!(ct<0));++ut)Le[ut]=ct;var wn=g(q,te);b(Pe,oe,wn,te,Le);var Ar=A(wn,Ce,Le,te);Ar[Ce].name="!Directory",se>0&&Be!==U&&(Ar[Be].name="!MiniFAT"),Ar[Le[0]].name="!FAT",Ar.fat_addrs=Le,Ar.ssz=te;var Lr={},mi=[],pu=[],mc=[];I(Ce,Ar,wn,mi,se,Lr,pu,Be),v(pu,mc,mi),mi.shift();var Il={FileIndex:pu,FullPaths:mc};return re&&re.raw&&(Il.raw={header:gt,sectors:wn}),Il}function h(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(pe,"Header Signature: "),q.l+=16;var re=q.read_shift(2,"u");return[q.read_shift(2,"u"),re]}function f(q,re){var J=9;switch(q.l+=2,J=q.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function g(q,re){for(var J=Math.ceil(q.length/re)-1,te=[],se=1;se<J;++se)te[se-1]=q.slice(se*re,(se+1)*re);return te[J-1]=q.slice(J*re),te}function v(q,re,J){for(var te=0,se=0,oe=0,Ce=0,Be=0,Pe=J.length,Le=[],De=[];te<Pe;++te)Le[te]=De[te]=te,re[te]=J[te];for(;Be<De.length;++Be)te=De[Be],se=q[te].L,oe=q[te].R,Ce=q[te].C,Le[te]===te&&(se!==-1&&Le[se]!==se&&(Le[te]=Le[se]),oe!==-1&&Le[oe]!==oe&&(Le[te]=Le[oe])),Ce!==-1&&(Le[Ce]=te),se!==-1&&te!=Le[te]&&(Le[se]=Le[te],De.lastIndexOf(se)<Be&&De.push(se)),oe!==-1&&te!=Le[te]&&(Le[oe]=Le[te],De.lastIndexOf(oe)<Be&&De.push(oe));for(te=1;te<Pe;++te)Le[te]===te&&(oe!==-1&&Le[oe]!==oe?Le[te]=Le[oe]:se!==-1&&Le[se]!==se&&(Le[te]=Le[se]));for(te=1;te<Pe;++te)if(q[te].type!==0){if(Be=te,Be!=Le[Be])do Be=Le[Be],re[te]=re[Be]+"/"+re[te];while(Be!==0&&Le[Be]!==-1&&Be!=Le[Be]);Le[te]=-1}for(re[0]+="/",te=1;te<Pe;++te)q[te].type!==2&&(re[te]+="/")}function x(q,re,J){for(var te=q.start,se=q.size,oe=[],Ce=te;J&&se>0&&Ce>=0;)oe.push(re.slice(Ce*W,Ce*W+W)),se-=W,Ce=_y(J,Ce*4);return oe.length===0?Ge(0):Ro(oe).slice(0,q.size)}function b(q,re,J,te,se){var oe=U;if(q===U){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Ce=J[q],Be=(te>>>2)-1;if(!Ce)return;for(var Pe=0;Pe<Be&&(oe=_y(Ce,Pe*4))!==U;++Pe)se.push(oe);b(_y(Ce,te-4),re-1,J,te,se)}}function T(q,re,J,te,se){var oe=[],Ce=[];se||(se=[]);var Be=te-1,Pe=0,Le=0;for(Pe=re;Pe>=0;){se[Pe]=!0,oe[oe.length]=Pe,Ce.push(q[Pe]);var De=J[Math.floor(Pe*4/te)];if(Le=Pe*4&Be,te<4+Le)throw new Error("FAT boundary crossed: "+Pe+" 4 "+te);if(!q[De])break;Pe=_y(q[De],Le)}return{nodes:oe,data:eoe([Ce])}}function A(q,re,J,te){var se=q.length,oe=[],Ce=[],Be=[],Pe=[],Le=te-1,De=0,at=0,gt=0,Rt=0;for(De=0;De<se;++De)if(Be=[],gt=De+re,gt>=se&&(gt-=se),!Ce[gt]){Pe=[];var ct=[];for(at=gt;at>=0;){ct[at]=!0,Ce[at]=!0,Be[Be.length]=at,Pe.push(q[at]);var ut=J[Math.floor(at*4/te)];if(Rt=at*4&Le,te<4+Rt)throw new Error("FAT boundary crossed: "+at+" 4 "+te);if(!q[ut]||(at=_y(q[ut],Rt),ct[at]))break}oe[gt]={nodes:Be,data:eoe([Pe])}}return oe}function I(q,re,J,te,se,oe,Ce,Be){for(var Pe=0,Le=te.length?2:0,De=re[q].data,at=0,gt=0,Rt;at<De.length;at+=128){var ct=De.slice(at,at+128);Kl(ct,64),gt=ct.read_shift(2),Rt=NH(ct,0,gt-Le),te.push(Rt);var ut={name:Rt,type:ct.read_shift(1),color:ct.read_shift(1),L:ct.read_shift(4,"i"),R:ct.read_shift(4,"i"),C:ct.read_shift(4,"i"),clsid:ct.read_shift(16),state:ct.read_shift(4,"i"),start:0,size:0},wn=ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2);wn!==0&&(ut.ct=R(ct,ct.l-8));var Ar=ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2)+ct.read_shift(2);Ar!==0&&(ut.mt=R(ct,ct.l-8)),ut.start=ct.read_shift(4,"i"),ut.size=ct.read_shift(4,"i"),ut.size<0&&ut.start<0&&(ut.size=ut.type=0,ut.start=U,ut.name=""),ut.type===5?(Pe=ut.start,se>0&&Pe!==U&&(re[Pe].name="!StreamData")):ut.size>=4096?(ut.storage="fat",re[ut.start]===void 0&&(re[ut.start]=T(J,ut.start,re.fat_addrs,re.ssz)),re[ut.start].name=ut.name,ut.content=re[ut.start].data.slice(0,ut.size)):(ut.storage="minifat",ut.size<0?ut.size=0:Pe!==U&&ut.start!==U&&re[Pe]&&(ut.content=x(ut,re[Pe].data,(re[Be]||{}).data))),ut.content&&Kl(ut.content,0),oe[Rt]=ut,Ce.push(ut)}}function R(q,re){return new Date((Ql(q,re+4)/1e7*Math.pow(2,32)+Ql(q,re)/1e7-11644473600)*1e3)}function M(q,re){return c(),u(l.readFileSync(q),re)}function F(q,re){var J=re&&re.type;switch(J||wr&&Buffer.isBuffer(q)&&(J="buffer"),J||"base64"){case"file":return M(q,re);case"base64":return u(Ku(dp(q)),re);case"binary":return u(Ku(q),re)}return u(q,re)}function C(q,re){var J=re||{},te=J.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=te+"/",q.FileIndex[0]={name:te,type:5}),J.CLSID&&(q.FileIndex[0].clsid=J.CLSID),N(q)}function N(q){var re="Sh33tJ5";if(!qr.find(q,"/"+re)){var J=Ge(4);J[0]=55,J[1]=J[3]=50,J[2]=54,q.FileIndex.push({name:re,type:2,content:J,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+re),O(q)}}function O(q,re){C(q);for(var J=!1,te=!1,se=q.FullPaths.length-1;se>=0;--se){var oe=q.FileIndex[se];switch(oe.type){case 0:te?J=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(oe.R*oe.L*oe.C)&&(J=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!re)){var Ce=new Date(1987,1,19),Be=0,Pe=Object.create?Object.create(null):{},Le=[];for(se=0;se<q.FullPaths.length;++se)Pe[q.FullPaths[se]]=!0,q.FileIndex[se].type!==0&&Le.push([q.FullPaths[se],q.FileIndex[se]]);for(se=0;se<Le.length;++se){var De=r(Le[se][0]);te=Pe[De],te||(Le.push([De,{name:i(De).replace("/",""),type:1,clsid:Se,ct:Ce,mt:Ce,content:null}]),Pe[De]=!0)}for(Le.sort(function(Rt,ct){return n(Rt[0],ct[0])}),q.FullPaths=[],q.FileIndex=[],se=0;se<Le.length;++se)q.FullPaths[se]=Le[se][0],q.FileIndex[se]=Le[se][1];for(se=0;se<Le.length;++se){var at=q.FileIndex[se],gt=q.FullPaths[se];if(at.name=i(gt).replace("/",""),at.L=at.R=at.C=-(at.color=1),at.size=at.content?at.content.length:0,at.start=0,at.clsid=at.clsid||Se,se===0)at.C=Le.length>1?1:-1,at.size=0,at.type=5;else if(gt.slice(-1)=="/"){for(Be=se+1;Be<Le.length&&r(q.FullPaths[Be])!=gt;++Be);for(at.C=Be>=Le.length?-1:Be,Be=se+1;Be<Le.length&&r(q.FullPaths[Be])!=r(gt);++Be);at.R=Be>=Le.length?-1:Be,at.type=1}else r(q.FullPaths[se+1]||"")==r(gt)&&(at.R=se+1),at.type=2}}}function j(q,re){var J=re||{};if(J.fileType=="mad")return Ue(q,J);switch(O(q),J.fileType){case"zip":return Et(q,J)}var te=(function(Rt){for(var ct=0,ut=0,wn=0;wn<Rt.FileIndex.length;++wn){var Ar=Rt.FileIndex[wn];if(Ar.content){var Lr=Ar.content.length;Lr>0&&(Lr<4096?ct+=Lr+63>>6:ut+=Lr+511>>9)}}for(var mi=Rt.FullPaths.length+3>>2,pu=ct+7>>3,mc=ct+127>>7,Il=pu+ut+mi+mc,ns=Il+127>>7,Tp=ns<=109?0:Math.ceil((ns-109)/127);Il+ns+Tp+127>>7>ns;)Tp=++ns<=109?0:Math.ceil((ns-109)/127);var ki=[1,Tp,ns,mc,mi,ut,ct,0];return Rt.FileIndex[0].size=ct<<6,ki[7]=(Rt.FileIndex[0].start=ki[0]+ki[1]+ki[2]+ki[3]+ki[4]+ki[5])+(ki[6]+7>>3),ki})(q),se=Ge(te[7]<<9),oe=0,Ce=0;{for(oe=0;oe<8;++oe)se.write_shift(1,Ne[oe]);for(oe=0;oe<8;++oe)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),oe=0;oe<3;++oe)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,te[2]),se.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:U),se.write_shift(4,te[3]),se.write_shift(-4,te[1]?te[0]-1:U),se.write_shift(4,te[1]),oe=0;oe<109;++oe)se.write_shift(-4,oe<te[2]?te[1]+oe:-1)}if(te[1])for(Ce=0;Ce<te[1];++Ce){for(;oe<236+Ce*127;++oe)se.write_shift(-4,oe<te[2]?te[1]+oe:-1);se.write_shift(-4,Ce===te[1]-1?U:Ce+1)}var Be=function(Rt){for(Ce+=Rt;oe<Ce-1;++oe)se.write_shift(-4,oe+1);Rt&&(++oe,se.write_shift(-4,U))};for(Ce=oe=0,Ce+=te[1];oe<Ce;++oe)se.write_shift(-4,je.DIFSECT);for(Ce+=te[2];oe<Ce;++oe)se.write_shift(-4,je.FATSECT);Be(te[3]),Be(te[4]);for(var Pe=0,Le=0,De=q.FileIndex[0];Pe<q.FileIndex.length;++Pe)De=q.FileIndex[Pe],De.content&&(Le=De.content.length,!(Le<4096)&&(De.start=Ce,Be(Le+511>>9)));for(Be(te[6]+7>>3);se.l&511;)se.write_shift(-4,je.ENDOFCHAIN);for(Ce=oe=0,Pe=0;Pe<q.FileIndex.length;++Pe)De=q.FileIndex[Pe],De.content&&(Le=De.content.length,!(!Le||Le>=4096)&&(De.start=Ce,Be(Le+63>>6)));for(;se.l&511;)se.write_shift(-4,je.ENDOFCHAIN);for(oe=0;oe<te[4]<<2;++oe){var at=q.FullPaths[oe];if(!at||at.length===0){for(Pe=0;Pe<17;++Pe)se.write_shift(4,0);for(Pe=0;Pe<3;++Pe)se.write_shift(4,-1);for(Pe=0;Pe<12;++Pe)se.write_shift(4,0);continue}De=q.FileIndex[oe],oe===0&&(De.start=De.size?De.start-1:U);var gt=oe===0&&J.root||De.name;if(Le=2*(gt.length+1),se.write_shift(64,gt,"utf16le"),se.write_shift(2,Le),se.write_shift(1,De.type),se.write_shift(1,De.color),se.write_shift(-4,De.L),se.write_shift(-4,De.R),se.write_shift(-4,De.C),De.clsid)se.write_shift(16,De.clsid,"hex");else for(Pe=0;Pe<4;++Pe)se.write_shift(4,0);se.write_shift(4,De.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,De.start),se.write_shift(4,De.size),se.write_shift(4,0)}for(oe=1;oe<q.FileIndex.length;++oe)if(De=q.FileIndex[oe],De.size>=4096)if(se.l=De.start+1<<9,wr&&Buffer.isBuffer(De.content))De.content.copy(se,se.l,0,De.size),se.l+=De.size+511&-512;else{for(Pe=0;Pe<De.size;++Pe)se.write_shift(1,De.content[Pe]);for(;Pe&511;++Pe)se.write_shift(1,0)}for(oe=1;oe<q.FileIndex.length;++oe)if(De=q.FileIndex[oe],De.size>0&&De.size<4096)if(wr&&Buffer.isBuffer(De.content))De.content.copy(se,se.l,0,De.size),se.l+=De.size+63&-64;else{for(Pe=0;Pe<De.size;++Pe)se.write_shift(1,De.content[Pe]);for(;Pe&63;++Pe)se.write_shift(1,0)}if(wr)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function V(q,re){var J=q.FullPaths.map(function(Pe){return Pe.toUpperCase()}),te=J.map(function(Pe){var Le=Pe.split("/");return Le[Le.length-(Pe.slice(-1)=="/"?2:1)]}),se=!1;re.charCodeAt(0)===47?(se=!0,re=J[0].slice(0,-1)+re):se=re.indexOf("/")!==-1;var oe=re.toUpperCase(),Ce=se===!0?J.indexOf(oe):te.indexOf(oe);if(Ce!==-1)return q.FileIndex[Ce];var Be=!oe.match(hC);for(oe=oe.replace(LT,""),Be&&(oe=oe.replace(hC,"!")),Ce=0;Ce<J.length;++Ce)if((Be?J[Ce].replace(hC,"!"):J[Ce]).replace(LT,"")==oe||(Be?te[Ce].replace(hC,"!"):te[Ce]).replace(LT,"")==oe)return q.FileIndex[Ce];return null}var W=64,U=-2,pe="d0cf11e0a1b11ae1",Ne=[208,207,17,224,161,177,26,225],Se="00000000000000000000000000000000",je={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(q,re,J){c();var te=j(q,J);l.writeFileSync(re,te)}function Oe(q){for(var re=new Array(q.length),J=0;J<q.length;++J)re[J]=String.fromCharCode(q[J]);return re.join("")}function Ae(q,re){var J=j(q,re);switch(re&&re.type||"buffer"){case"file":return c(),l.writeFileSync(re.filename,J),J;case"binary":return typeof J=="string"?J:Oe(J);case"base64":return aA(typeof J=="string"?J:Oe(J));case"buffer":if(wr)return Buffer.isBuffer(J)?J:Sp(J);case"array":return typeof J=="string"?Ku(J):J}return J}var Q;function B(q){try{var re=q.InflateRaw,J=new re;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)Q=q;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function ne(q,re){if(!Q)return Ie(q,re);var J=Q.InflateRaw,te=new J,se=te._processChunk(q.slice(q.l),te._finishFlushFlag);return q.l+=te.bytesRead,se}function ie(q){return Q?Q.deflateRawSync(q):On(q)}var le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ve=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],qe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ke(q){var re=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(re>>16|re>>8|re)&255}for(var Te=typeof Uint8Array<"u",we=Te?new Uint8Array(256):[],Dt=0;Dt<256;++Dt)we[Dt]=Ke(Dt);function Ye(q,re){var J=we[q&255];return re<=8?J>>>8-re:(J=J<<8|we[q>>8&255],re<=16?J>>>16-re:(J=J<<8|we[q>>16&255],J>>>24-re))}function sn(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=6?0:q[te+1]<<8))>>>J&3}function $t(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=5?0:q[te+1]<<8))>>>J&7}function fn(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=4?0:q[te+1]<<8))>>>J&15}function yn(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=3?0:q[te+1]<<8))>>>J&31}function dt(q,re){var J=re&7,te=re>>>3;return(q[te]|(J<=1?0:q[te+1]<<8))>>>J&127}function lr(q,re,J){var te=re&7,se=re>>>3,oe=(1<<J)-1,Ce=q[se]>>>te;return J<8-te||(Ce|=q[se+1]<<8-te,J<16-te)||(Ce|=q[se+2]<<16-te,J<24-te)||(Ce|=q[se+3]<<24-te),Ce&oe}function $n(q,re,J){var te=re&7,se=re>>>3;return te<=5?q[se]|=(J&7)<<te:(q[se]|=J<<te&255,q[se+1]=(J&7)>>8-te),re+3}function Un(q,re,J){var te=re&7,se=re>>>3;return J=(J&1)<<te,q[se]|=J,re+1}function Xr(q,re,J){var te=re&7,se=re>>>3;return J<<=te,q[se]|=J&255,J>>>=8,q[se+1]=J,re+8}function po(q,re,J){var te=re&7,se=re>>>3;return J<<=te,q[se]|=J&255,J>>>=8,q[se+1]=J&255,q[se+2]=J>>>8,re+16}function kr(q,re){var J=q.length,te=2*J>re?2*J:re+5,se=0;if(J>=re)return q;if(wr){var oe=Fse(te);if(q.copy)q.copy(oe);else for(;se<q.length;++se)oe[se]=q[se];return oe}else if(Te){var Ce=new Uint8Array(te);if(Ce.set)Ce.set(q);else for(;se<J;++se)Ce[se]=q[se];return Ce}return q.length=te,q}function Si(q){for(var re=new Array(q),J=0;J<q;++J)re[J]=0;return re}function Rs(q,re,J){var te=1,se=0,oe=0,Ce=0,Be=0,Pe=q.length,Le=Te?new Uint16Array(32):Si(32);for(oe=0;oe<32;++oe)Le[oe]=0;for(oe=Pe;oe<J;++oe)q[oe]=0;Pe=q.length;var De=Te?new Uint16Array(Pe):Si(Pe);for(oe=0;oe<Pe;++oe)Le[se=q[oe]]++,te<se&&(te=se),De[oe]=0;for(Le[0]=0,oe=1;oe<=te;++oe)Le[oe+16]=Be=Be+Le[oe-1]<<1;for(oe=0;oe<Pe;++oe)Be=q[oe],Be!=0&&(De[oe]=Le[Be+16]++);var at=0;for(oe=0;oe<Pe;++oe)if(at=q[oe],at!=0)for(Be=Ye(De[oe],te)>>te-at,Ce=(1<<te+4-at)-1;Ce>=0;--Ce)re[Be|Ce<<at]=at&15|oe<<4;return te}var bt=Te?new Uint16Array(512):Si(512),Yn=Te?new Uint16Array(32):Si(32);if(!Te){for(var cr=0;cr<512;++cr)bt[cr]=0;for(cr=0;cr<32;++cr)Yn[cr]=0}(function(){for(var q=[],re=0;re<32;re++)q.push(5);Rs(q,Yn,32);var J=[];for(re=0;re<=143;re++)J.push(8);for(;re<=255;re++)J.push(9);for(;re<=279;re++)J.push(7);for(;re<=287;re++)J.push(8);Rs(J,bt,288)})();var Ft=(function(){for(var re=Te?new Uint8Array(32768):[],J=0,te=0;J<qe.length-1;++J)for(;te<qe[J+1];++te)re[te]=J;for(;te<32768;++te)re[te]=29;var se=Te?new Uint8Array(259):[];for(J=0,te=0;J<ve.length-1;++J)for(;te<ve[J+1];++te)se[te]=J;function oe(Be,Pe){for(var Le=0;Le<Be.length;){var De=Math.min(65535,Be.length-Le),at=Le+De==Be.length;for(Pe.write_shift(1,+at),Pe.write_shift(2,De),Pe.write_shift(2,~De&65535);De-- >0;)Pe[Pe.l++]=Be[Le++]}return Pe.l}function Ce(Be,Pe){for(var Le=0,De=0,at=Te?new Uint16Array(32768):[];De<Be.length;){var gt=Math.min(65535,Be.length-De);if(gt<10){for(Le=$n(Pe,Le,+(De+gt==Be.length)),Le&7&&(Le+=8-(Le&7)),Pe.l=Le/8|0,Pe.write_shift(2,gt),Pe.write_shift(2,~gt&65535);gt-- >0;)Pe[Pe.l++]=Be[De++];Le=Pe.l*8;continue}Le=$n(Pe,Le,+(De+gt==Be.length)+2);for(var Rt=0;gt-- >0;){var ct=Be[De];Rt=(Rt<<5^ct)&32767;var ut=-1,wn=0;if((ut=at[Rt])&&(ut|=De&-32768,ut>De&&(ut-=32768),ut<De))for(;Be[ut+wn]==Be[De+wn]&&wn<250;)++wn;if(wn>2){ct=se[wn],ct<=22?Le=Xr(Pe,Le,we[ct+1]>>1)-1:(Xr(Pe,Le,3),Le+=5,Xr(Pe,Le,we[ct-23]>>5),Le+=3);var Ar=ct<8?0:ct-4>>2;Ar>0&&(po(Pe,Le,wn-ve[ct]),Le+=Ar),ct=re[De-ut],Le=Xr(Pe,Le,we[ct]>>3),Le-=3;var Lr=ct<4?0:ct-2>>1;Lr>0&&(po(Pe,Le,De-ut-qe[ct]),Le+=Lr);for(var mi=0;mi<wn;++mi)at[Rt]=De&32767,Rt=(Rt<<5^Be[De])&32767,++De;gt-=wn-1}else ct<=143?ct=ct+48:Le=Un(Pe,Le,1),Le=Xr(Pe,Le,we[ct]),at[Rt]=De&32767,++De}Le=Xr(Pe,Le,0)-1}return Pe.l=(Le+7)/8|0,Pe.l}return function(Pe,Le){return Pe.length<8?oe(Pe,Le):Ce(Pe,Le)}})();function On(q){var re=Ge(50+Math.floor(q.length*1.1)),J=Ft(q,re);return re.slice(0,J)}var Qt=Te?new Uint16Array(32768):Si(32768),Oo=Te?new Uint16Array(32768):Si(32768),Fi=Te?new Uint16Array(128):Si(128),Ps=1,Pn=1;function Ti(q,re){var J=yn(q,re)+257;re+=5;var te=yn(q,re)+1;re+=5;var se=fn(q,re)+4;re+=4;for(var oe=0,Ce=Te?new Uint8Array(19):Si(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Pe=1,Le=Te?new Uint8Array(8):Si(8),De=Te?new Uint8Array(8):Si(8),at=Ce.length,gt=0;gt<se;++gt)Ce[le[gt]]=oe=$t(q,re),Pe<oe&&(Pe=oe),Le[oe]++,re+=3;var Rt=0;for(Le[0]=0,gt=1;gt<=Pe;++gt)De[gt]=Rt=Rt+Le[gt-1]<<1;for(gt=0;gt<at;++gt)(Rt=Ce[gt])!=0&&(Be[gt]=De[Rt]++);var ct=0;for(gt=0;gt<at;++gt)if(ct=Ce[gt],ct!=0){Rt=we[Be[gt]]>>8-ct;for(var ut=(1<<7-ct)-1;ut>=0;--ut)Fi[Rt|ut<<ct]=ct&7|gt<<3}var wn=[];for(Pe=1;wn.length<J+te;)switch(Rt=Fi[dt(q,re)],re+=Rt&7,Rt>>>=3){case 16:for(oe=3+sn(q,re),re+=2,Rt=wn[wn.length-1];oe-- >0;)wn.push(Rt);break;case 17:for(oe=3+$t(q,re),re+=3;oe-- >0;)wn.push(0);break;case 18:for(oe=11+dt(q,re),re+=7;oe-- >0;)wn.push(0);break;default:wn.push(Rt),Pe<Rt&&(Pe=Rt);break}var Ar=wn.slice(0,J),Lr=wn.slice(J);for(gt=J;gt<286;++gt)Ar[gt]=0;for(gt=te;gt<30;++gt)Lr[gt]=0;return Ps=Rs(Ar,Qt,286),Pn=Rs(Lr,Oo,30),re}function He(q,re){if(q[0]==3&&!(q[1]&3))return[G1(re),2];for(var J=0,te=0,se=Fse(re||1<<18),oe=0,Ce=se.length>>>0,Be=0,Pe=0;(te&1)==0;){if(te=$t(q,J),J+=3,te>>>1)te>>1==1?(Be=9,Pe=5):(J=Ti(q,J),Be=Ps,Pe=Pn);else{J&7&&(J+=8-(J&7));var Le=q[J>>>3]|q[(J>>>3)+1]<<8;if(J+=32,Le>0)for(!re&&Ce<oe+Le&&(se=kr(se,oe+Le),Ce=se.length);Le-- >0;)se[oe++]=q[J>>>3],J+=8;continue}for(;;){!re&&Ce<oe+32767&&(se=kr(se,oe+32767),Ce=se.length);var De=lr(q,J,Be),at=te>>>1==1?bt[De]:Qt[De];if(J+=at&15,at>>>=4,(at>>>8&255)===0)se[oe++]=at;else{if(at==256)break;at-=257;var gt=at<8?0:at-4>>2;gt>5&&(gt=0);var Rt=oe+ve[at];gt>0&&(Rt+=lr(q,J,gt),J+=gt),De=lr(q,J,Pe),at=te>>>1==1?Yn[De]:Oo[De],J+=at&15,at>>>=4;var ct=at<4?0:at-2>>1,ut=qe[at];for(ct>0&&(ut+=lr(q,J,ct),J+=ct),!re&&Ce<Rt&&(se=kr(se,Rt+100),Ce=se.length);oe<Rt;)se[oe]=se[oe-ut],++oe}}}return re?[se,J+7>>>3]:[se.slice(0,oe),J+7>>>3]}function Ie(q,re){var J=q.slice(q.l||0),te=He(J,re);return q.l+=te[1],te[0]}function Re(q,re){if(q)typeof console<"u"&&console.error(re);else throw new Error(re)}function rn(q,re){var J=q;Kl(J,0);var te=[],se=[],oe={FileIndex:te,FullPaths:se};C(oe,{root:re.root});for(var Ce=J.length-4;(J[Ce]!=80||J[Ce+1]!=75||J[Ce+2]!=5||J[Ce+3]!=6)&&Ce>=0;)--Ce;J.l=Ce+4,J.l+=4;var Be=J.read_shift(2);J.l+=6;var Pe=J.read_shift(4);for(J.l=Pe,Ce=0;Ce<Be;++Ce){J.l+=20;var Le=J.read_shift(4),De=J.read_shift(4),at=J.read_shift(2),gt=J.read_shift(2),Rt=J.read_shift(2);J.l+=8;var ct=J.read_shift(4),ut=a(J.slice(J.l+at,J.l+at+gt));J.l+=at+gt+Rt;var wn=J.l;J.l=ct+4,z(J,Le,De,oe,ut),J.l=wn}return oe}function z(q,re,J,te,se){q.l+=2;var oe=q.read_shift(2),Ce=q.read_shift(2),Be=o(q);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var Pe=q.read_shift(4),Le=q.read_shift(4),De=q.read_shift(4),at=q.read_shift(2),gt=q.read_shift(2),Rt="",ct=0;ct<at;++ct)Rt+=String.fromCharCode(q[q.l++]);if(gt){var ut=a(q.slice(q.l,q.l+gt));(ut[21589]||{}).mt&&(Be=ut[21589].mt),((se||{})[21589]||{}).mt&&(Be=se[21589].mt)}q.l+=gt;var wn=q.slice(q.l,q.l+Le);switch(Ce){case 8:wn=ne(q,De);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ce)}var Ar=!1;oe&8&&(Pe=q.read_shift(4),Pe==134695760&&(Pe=q.read_shift(4),Ar=!0),Le=q.read_shift(4),De=q.read_shift(4)),Le!=re&&Re(Ar,"Bad compressed size: "+re+" != "+Le),De!=J&&Re(Ar,"Bad uncompressed size: "+J+" != "+De),et(te,Rt,wn,{unsafe:!0,mt:Be})}function Et(q,re){var J=re||{},te=[],se=[],oe=Ge(1),Ce=J.compression?8:0,Be=0,Pe=0,Le=0,De=0,at=0,gt=q.FullPaths[0],Rt=gt,ct=q.FileIndex[0],ut=[],wn=0;for(Pe=1;Pe<q.FullPaths.length;++Pe)if(Rt=q.FullPaths[Pe].slice(gt.length),ct=q.FileIndex[Pe],!(!ct.size||!ct.content||Rt=="Sh33tJ5")){var Ar=De,Lr=Ge(Rt.length);for(Le=0;Le<Rt.length;++Le)Lr.write_shift(1,Rt.charCodeAt(Le)&127);Lr=Lr.slice(0,Lr.l),ut[at]=u1t.buf(ct.content,0);var mi=ct.content;Ce==8&&(mi=ie(mi)),oe=Ge(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,Be),oe.write_shift(2,Ce),ct.mt?s(oe,ct.mt):oe.write_shift(4,0),oe.write_shift(-4,ut[at]),oe.write_shift(4,mi.length),oe.write_shift(4,ct.content.length),oe.write_shift(2,Lr.length),oe.write_shift(2,0),De+=oe.length,te.push(oe),De+=Lr.length,te.push(Lr),De+=mi.length,te.push(mi),oe=Ge(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,Be),oe.write_shift(2,Ce),oe.write_shift(4,0),oe.write_shift(-4,ut[at]),oe.write_shift(4,mi.length),oe.write_shift(4,ct.content.length),oe.write_shift(2,Lr.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,Ar),wn+=oe.l,se.push(oe),wn+=Lr.length,se.push(Lr),++at}return oe=Ge(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,at),oe.write_shift(2,at),oe.write_shift(4,wn),oe.write_shift(4,De),oe.write_shift(2,0),Ro([Ro(te),Ro(se),oe])}var Y={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(q,re){if(q.ctype)return q.ctype;var J=q.name||"",te=J.match(/\.([^\.]+)$/);return te&&Y[te[1]]||re&&(te=(J=re).match(/[\.\\]([^\.\\])+$/),te&&Y[te[1]])?Y[te[1]]:"application/octet-stream"}function ze(q){for(var re=aA(q),J=[],te=0;te<re.length;te+=76)J.push(re.slice(te,te+76));return J.join(`\r
`)+`\r
`}function ee(q){var re=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Le){var De=Le.charCodeAt(0).toString(16).toUpperCase();return"="+(De.length==1?"0"+De:De)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],te=re.split(`\r
`),se=0;se<te.length;++se){var oe=te[se];if(oe.length==0){J.push("");continue}for(var Ce=0;Ce<oe.length;){var Be=76,Pe=oe.slice(Ce,Ce+Be);Pe.charAt(Be-1)=="="?Be--:Pe.charAt(Be-2)=="="?Be-=2:Pe.charAt(Be-3)=="="&&(Be-=3),Pe=oe.slice(Ce,Ce+Be),Ce+=Be,Ce<oe.length&&(Pe+="="),J.push(Pe)}}return J.join(`\r
`)}function ge(q){for(var re=[],J=0;J<q.length;++J){for(var te=q[J];J<=q.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+q[++J];re.push(te)}for(var se=0;se<re.length;++se)re[se]=re[se].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return Ku(re.join(`\r
`))}function $e(q,re,J){for(var te="",se="",oe="",Ce,Be=0;Be<10;++Be){var Pe=re[Be];if(!Pe||Pe.match(/^\s*$/))break;var Le=Pe.match(/^(.*?):\s*([^\s].*)$/);if(Le)switch(Le[1].toLowerCase()){case"content-location":te=Le[2].trim();break;case"content-type":oe=Le[2].trim();break;case"content-transfer-encoding":se=Le[2].trim();break}}switch(++Be,se.toLowerCase()){case"base64":Ce=Ku(dp(re.slice(Be).join("")));break;case"quoted-printable":Ce=ge(re.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var De=et(q,te.slice(J.length),Ce,{unsafe:!0});oe&&(De.ctype=oe)}function Je(q,re){if(Oe(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=re&&re.root||"",te=(wr&&Buffer.isBuffer(q)?q.toString("binary"):Oe(q)).split(`\r
`),se=0,oe="";for(se=0;se<te.length;++se)if(oe=te[se],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),J||(J=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),oe.slice(0,J.length)!=J););var Ce=(te[1]||"").match(/boundary="(.*?)"/);if(!Ce)throw new Error("MAD cannot find boundary");var Be="--"+(Ce[1]||""),Pe=[],Le=[],De={FileIndex:Pe,FullPaths:Le};C(De);var at,gt=0;for(se=0;se<te.length;++se){var Rt=te[se];Rt!==Be&&Rt!==Be+"--"||(gt++&&$e(De,te.slice(at,se),J),at=se)}return De}function Ue(q,re){var J=re||{},te=J.boundary||"SheetJS";te="------="+te;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],oe=q.FullPaths[0],Ce=oe,Be=q.FileIndex[0],Pe=1;Pe<q.FullPaths.length;++Pe)if(Ce=q.FullPaths[Pe].slice(oe.length),Be=q.FileIndex[Pe],!(!Be.size||!Be.content||Ce=="Sh33tJ5")){Ce=Ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wn){return"_x"+wn.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wn){return"_u"+wn.charCodeAt(0).toString(16)+"_"});for(var Le=Be.content,De=wr&&Buffer.isBuffer(Le)?Le.toString("binary"):Oe(Le),at=0,gt=Math.min(1024,De.length),Rt=0,ct=0;ct<=gt;++ct)(Rt=De.charCodeAt(ct))>=32&&Rt<128&&++at;var ut=at>=gt*4/5;se.push(te),se.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+Ce),se.push("Content-Transfer-Encoding: "+(ut?"quoted-printable":"base64")),se.push("Content-Type: "+ae(Be,Ce)),se.push(""),se.push(ut?ee(De):ze(De))}return se.push(te+`--\r
`),se.join(`\r
`)}function nt(q){var re={};return C(re,q),re}function et(q,re,J,te){var se=te&&te.unsafe;se||C(q);var oe=!se&&qr.find(q,re);if(!oe){var Ce=q.FullPaths[0];re.slice(0,Ce.length)==Ce?Ce=re:(Ce.slice(-1)!="/"&&(Ce+="/"),Ce=(Ce+re).replace("//","/")),oe={name:i(re),type:2},q.FileIndex.push(oe),q.FullPaths.push(Ce),se||qr.utils.cfb_gc(q)}return oe.content=J,oe.size=J?J.length:0,te&&(te.CLSID&&(oe.clsid=te.CLSID),te.mt&&(oe.mt=te.mt),te.ct&&(oe.ct=te.ct)),oe}function Ct(q,re){C(q);var J=qr.find(q,re);if(J){for(var te=0;te<q.FileIndex.length;++te)if(q.FileIndex[te]==J)return q.FileIndex.splice(te,1),q.FullPaths.splice(te,1),!0}return!1}function zt(q,re,J){C(q);var te=qr.find(q,re);if(te){for(var se=0;se<q.FileIndex.length;++se)if(q.FileIndex[se]==te)return q.FileIndex[se].name=i(J),q.FullPaths[se]=J,!0}return!1}function gn(q){O(q,!0)}return e.find=V,e.read=F,e.parse=u,e.write=Ae,e.writeFile=de,e.utils={cfb_new:nt,cfb_add:et,cfb_del:Ct,cfb_mov:zt,cfb_gc:gn,ReadShift:$T,CheckField:nbe,prep_blob:Kl,bconcat:Ro,use_zlib:B,_deflateRaw:On,_inflateRaw:Ie,consts:je},e})();function h1t(t){return typeof t=="string"?oL(t):Array.isArray(t)?$yt(t):t}function DI(t,e,n){if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=oL(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?cA(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var i=new Blob([h1t(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=LI(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function No(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function qse(t,e){for(var n=[],r=No(t),i=0;i!==r.length;++i)n[t[r[i]][e]]==null&&(n[t[r[i]][e]]=r[i]);return n}function RH(t){for(var e=[],n=No(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function cL(t){for(var e=[],n=No(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function d1t(t){for(var e=[],n=No(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var MN=new Date(1899,11,30,0,0,0);function Sl(t,e){var n=t.getTime(),r=MN.getTime()+(t.getTimezoneOffset()-MN.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var F2e=new Date,f1t=MN.getTime()+(F2e.getTimezoneOffset()-MN.getTimezoneOffset())*6e4,Kse=F2e.getTimezoneOffset();function V2e(t){var e=new Date;return e.setTime(t*24*60*60*1e3+f1t),e.getTimezoneOffset()!==Kse&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Kse)*6e4),e}var Yse=new Date("2017-02-19T19:06:09.000Z"),z2e=isNaN(Yse.getFullYear())?new Date("2/19/17"):Yse,p1t=z2e.getFullYear()==2017;function Da(t,e){var n=new Date(t);if(p1t)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(z2e.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function uL(t,e){if(wr&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=t.length;++i)r.push(String.fromCharCode(t[i]));return r.join("")}function Tl(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Tl(t[n]));return e}function Xi(t,e){for(var n="";n.length<e;)n+=t;return n}function ep(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(e=Number(r)))?e/n:e}var m1t=["january","february","march","april","may","june","july","august","september","october","november","december"];function lA(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return n;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&m1t.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}function Fn(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return wr?r=Sp(n):r=jyt(n),qr.utils.cfb_add(t,e,r)}qr.utils.cfb_add(t,e,n)}else t.file(e,n)}function PH(){return qr.utils.cfb_new()}var Is=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,g1t={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},CH=RH(g1t),MH=/[&<>'"]/g,y1t=/[\u0000-\u0008\u000b-\u001f]/g;function Ur(t){var e=t+"";return e.replace(MH,function(n){return CH[n]}).replace(y1t,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Xse(t){return Ur(t).replace(/ /g,"_x0020_")}var U2e=/[\u0000-\u001f]/g;function v1t(t){var e=t+"";return e.replace(MH,function(n){return CH[n]}).replace(/\n/g,"<br/>").replace(U2e,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function _1t(t){var e=t+"";return e.replace(MH,function(n){return CH[n]}).replace(U2e,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function x1t(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function w1t(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function R8(t){for(var e="",n=0,r=0,i=0,s=0,o=0,a=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(i=t.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function Zse(t){var e=G1(2*t.length),n,r,i=1,s=0,o=0,a;for(r=0;r<t.length;r+=i)i=1,(a=t.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(t.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=n%256,e[s++]=n>>>8;return e.slice(0,s).toString("ucs2")}function Jse(t){return Sp(t,"binary").toString("utf8")}var fC="foo bar baz",DT=wr&&(Jse(fC)==R8(fC)&&Jse||Zse(fC)==R8(fC)&&Zse)||R8,cA=wr?function(t){return Sp(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,i=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},b1t=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)r=r.replace(t[i][0],t[i][1]);return r}})(),G2e=/(^\s|\s$|\n)/;function Po(t,e){return"<"+t+(e.match(G2e)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function uA(t){return No(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function yt(t,e,n){return"<"+t+(n!=null?uA(n):"")+(e!=null?(e.match(G2e)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function tz(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function E1t(t,e){switch(typeof t){case"string":var n=yt("vt:lpwstr",Ur(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return yt((t|0)==t?"vt:i4":"vt:r8",Ur(String(t)));case"boolean":return yt("vt:bool",t?"true":"false")}if(t instanceof Date)return yt("vt:filetime",tz(t));throw new Error("Unable to serialize "+t)}var so={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},db=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Jl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function S1t(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function T1t(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=r?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[n+a]=s&255;t[n+6]=(i&15)<<4|s&15,t[n+7]=i>>4|r}var Qse=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var i=0,s=t[0][r].length;i<s;i+=n)e.push.apply(e,t[0][r].slice(i,i+n));return e},eoe=wr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Sp(e)})):Qse(t)}:Qse,toe=function(t,e,n){for(var r=[],i=e;i<n;i+=2)r.push(String.fromCharCode(OS(t,i)));return r.join("").replace(LT,"")},NH=wr?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(LT,""):toe(t,e,n)}:toe,noe=function(t,e,n){for(var r=[],i=e;i<e+n;++i)r.push(("0"+t[i].toString(16)).slice(-2));return r.join("")},B2e=wr?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):noe(t,e,n)}:noe,roe=function(t,e,n){for(var r=[],i=e;i<n;i++)r.push(String.fromCharCode(ux(t,i)));return r.join("")},$I=wr?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):roe(e,n,r)}:roe,W2e=function(t,e){var n=Ql(t,e);return n>0?$I(t,e+4,e+4+n-1):""},H2e=W2e,q2e=function(t,e){var n=Ql(t,e);return n>0?$I(t,e+4,e+4+n-1):""},K2e=q2e,Y2e=function(t,e){var n=2*Ql(t,e);return n>0?$I(t,e+4,e+4+n-1):""},X2e=Y2e,Z2e=function(e,n){var r=Ql(e,n);return r>0?NH(e,n+4,n+4+r):""},J2e=Z2e,Q2e=function(t,e){var n=Ql(t,e);return n>0?$I(t,e+4,e+4+n):""},ebe=Q2e,tbe=function(t,e){return S1t(t,e)},NN=tbe,OH=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wr&&(H2e=function(e,n){if(!Buffer.isBuffer(e))return W2e(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},K2e=function(e,n){if(!Buffer.isBuffer(e))return q2e(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},X2e=function(e,n){if(!Buffer.isBuffer(e))return Y2e(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},J2e=function(e,n){if(!Buffer.isBuffer(e))return Z2e(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},ebe=function(e,n){if(!Buffer.isBuffer(e))return Q2e(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},NN=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):tbe(e,n)},OH=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ux=function(t,e){return t[e]},OS=function(t,e){return t[e+1]*256+t[e]},k1t=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Ql=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_y=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},A1t=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function $T(t,e){var n="",r,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,wr&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)n+=String.fromCharCode(OS(this,c)),c+=2;t*=2;break;case"utf8":n=$I(this,this.l,this.l+t);break;case"utf16le":t*=2,n=NH(this,this.l,this.l+t);break;case"wstr":return $T.call(this,t,"dbcs");case"lpstr-ansi":n=H2e(this,this.l),t=4+Ql(this,this.l);break;case"lpstr-cp":n=K2e(this,this.l),t=4+Ql(this,this.l);break;case"lpwstr":n=X2e(this,this.l),t=4+2*Ql(this,this.l);break;case"lpp4":t=4+Ql(this,this.l),n=J2e(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ql(this,this.l),n=ebe(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(o=ux(this,this.l+t++))!==0;)s.push(uC(o));n=s.join("");break;case"_wstr":for(t=0,n="";(o=OS(this,this.l+t))!==0;)s.push(uC(o)),t+=2;t+=2,n=s.join("");break;case"dbcs-cont":for(n="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ux(this,c),this.l=c+1,a=$T.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(uC(OS(this,c))),c+=2}n=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ux(this,c),this.l=c+1,a=$T.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(uC(ux(this,c))),c+=1}n=s.join("");break;default:switch(t){case 1:return r=ux(this,this.l),this.l++,r;case 2:return r=(e==="i"?k1t:OS)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?_y:A1t)(this,this.l),this.l+=4,r):(i=Ql(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=NN(this,this.l):i=NN([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:n=B2e(this,this.l,t);break}}return this.l+=t,n}var I1t=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},R1t=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},P1t=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function C1t(t,e,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=e.length;++i)P1t(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(n==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,I1t(this,e,this.l);break;case 8:if(r=8,n==="f"){T1t(this,e,this.l);break}case 16:break;case-4:r=4,R1t(this,e,this.l);break}return this.l+=r,this}function nbe(t,e){var n=B2e(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Kl(t,e){t.l=e,t.read_shift=$T,t.chk=nbe,t.write_shift=C1t}function Cd(t,e){t.l+=e}function Ge(t){var e=G1(t);return Kl(e,0),e}function xl(){var t=[],e=wr?256:2048,n=function(c){var u=Ge(c);return Kl(u,0),u},r=n(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=n(Math.max(c+1,e)))},o=function(){return i(),Ro(t)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function tt(t,e,n,r){var i=+e,s;if(!isNaN(i)){r||(r=Sbt[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&OH(n)&&t.push(n)}}function jT(t,e,n){var r=Tl(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ioe(t,e,n){var r=Tl(t);return r.s=jT(r.s,e.s,n),r.e=jT(r.e,e.s,n),r}function FT(t,e){if(t.cRel&&t.c<0)for(t=Tl(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Tl(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=Br(t);return!t.cRel&&t.cRel!=null&&(n=O1t(n)),!t.rRel&&t.rRel!=null&&(n=M1t(n)),n}function P8(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ma(t.s.c)+":"+(t.e.cRel?"":"$")+ma(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mo(t.s.r)+":"+(t.e.rRel?"":"$")+Mo(t.e.r):FT(t.s,e.biff)+":"+FT(t.e,e.biff)}function LH(t){return parseInt(N1t(t),10)-1}function Mo(t){return""+(t+1)}function M1t(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function N1t(t){return t.replace(/\$(\d+)$/,"$1")}function DH(t){for(var e=L1t(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function ma(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function O1t(t){return t.replace(/^([A-Z])/,"$$$1")}function L1t(t){return t.replace(/^\$([A-Z])/,"$1")}function D1t(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ao(t){for(var e=0,n=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:e-1}}function Br(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function pc(t){var e=t.indexOf(":");return e==-1?{s:ao(t),e:ao(t)}:{s:ao(t.slice(0,e)),e:ao(t.slice(e+1))}}function ks(t,e){return typeof e>"u"||typeof e=="number"?ks(t.s,t.e):(typeof t!="string"&&(t=Br(t)),typeof e!="string"&&(e=Br(e)),t==e?t:t+":"+e)}function pi(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=t.length;for(n=0;r<s&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.s.c=--n,n=0;r<s&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(e.s.r=--n,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=s&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.e.c=--n,n=0;r!=s&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return e.e.r=--n,e}function soe(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Bg(t.z,n?Sl(e):e)}catch{}try{return t.w=Bg((t.XF||{}).numFmtId||(n?14:0),n?Sl(e):e)}catch{return""+e}}function fp(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?jI[t.v]||t.v:e==null?soe(t,t.v):soe(t,e))}function hv(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function rbe(t,e,n){var r=n||{},i=t?Array.isArray(t):r.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?ao(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=pi(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var g={v:e[h][f]},v=o+h,x=a+f;if(c.s.r>v&&(c.s.r=v),c.s.c>x&&(c.s.c=x),c.e.r<v&&(c.e.r=v),c.e.c<x&&(c.e.c=x),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))g=e[h][f];else if(Array.isArray(g.v)&&(g.f=e[h][f][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||es[14],r.cellDates?(g.t="d",g.w=Bg(g.z,Sl(g.v))):(g.t="n",g.v=Sl(g.v),g.w=Bg(g.z,g.v))):g.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(g.z=s[v][x].z),s[v][x]=g;else{var b=Br({c:x,r:v});s[b]&&s[b].z&&(g.z=s[b].z),s[b]=g}}}return c.s.c<1e7&&(s["!ref"]=ks(c)),s}function fb(t,e){return rbe(null,t,e)}function $1t(t){return t.read_shift(4,"i")}function sh(t,e){return e||(e=Ge(4)),e.write_shift(4,t),e}function ga(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function lo(t,e){var n=!1;return e==null&&(n=!0,e=Ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function j1t(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function F1t(t,e){return e||(e=Ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function $H(t,e){var n=t.l,r=t.read_shift(1),i=ga(t),s=[],o={t:i,h:i};if((r&1)!==0){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(j1t(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=n+e,o}function V1t(t,e){var n=!1;return e==null&&(n=!0,e=Ge(15+4*t.t.length)),e.write_shift(1,0),lo(t.t,e),n?e.slice(0,e.l):e}var z1t=$H;function U1t(t,e){var n=!1;return e==null&&(n=!0,e=Ge(23+4*t.t.length)),e.write_shift(1,1),lo(t.t,e),e.write_shift(4,1),F1t({},e),n?e.slice(0,e.l):e}function fu(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function dv(t,e){return e==null&&(e=Ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function fv(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function pv(t,e){return e==null&&(e=Ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var G1t=ga,ibe=lo;function jH(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function ON(t,e){var n=!1;return e==null&&(n=!0,e=Ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var B1t=ga,nz=jH,FH=ON;function sbe(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var i=r===0?NN([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_y(e,0)>>2;return n?i/100:i}function obe(t,e){e==null&&(e=Ge(4));var n=0,r=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?i:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function abe(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function W1t(t,e){return e||(e=Ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var mv=abe,pb=W1t;function mb(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function B1(t,e){return(e||Ge(8)).write_shift(8,t,"f")}function H1t(t){var e={},n=t.read_shift(1),r=n>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=tvt[i];c&&(e.rgb=goe(c));break;case 2:e.rgb=goe([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function LN(t,e){if(e||(e=Ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function q1t(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function K1t(t,e){e||(e=Ge(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}var lbe=2,Bl=3,pC=11,DN=19,mC=64,Y1t=65,X1t=71,Z1t=4108,J1t=4126,ko=80,ooe={1:{n:"CodePage",t:lbe},2:{n:"Category",t:ko},3:{n:"PresentationFormat",t:ko},4:{n:"ByteCount",t:Bl},5:{n:"LineCount",t:Bl},6:{n:"ParagraphCount",t:Bl},7:{n:"SlideCount",t:Bl},8:{n:"NoteCount",t:Bl},9:{n:"HiddenCount",t:Bl},10:{n:"MultimediaClipCount",t:Bl},11:{n:"ScaleCrop",t:pC},12:{n:"HeadingPairs",t:Z1t},13:{n:"TitlesOfParts",t:J1t},14:{n:"Manager",t:ko},15:{n:"Company",t:ko},16:{n:"LinksUpToDate",t:pC},17:{n:"CharacterCount",t:Bl},19:{n:"SharedDoc",t:pC},22:{n:"HyperlinksChanged",t:pC},23:{n:"AppVersion",t:Bl,p:"version"},24:{n:"DigSig",t:Y1t},26:{n:"ContentType",t:ko},27:{n:"ContentStatus",t:ko},28:{n:"Language",t:ko},29:{n:"Version",t:ko},255:{},2147483648:{n:"Locale",t:DN},2147483651:{n:"Behavior",t:DN},1919054434:{}},aoe={1:{n:"CodePage",t:lbe},2:{n:"Title",t:ko},3:{n:"Subject",t:ko},4:{n:"Author",t:ko},5:{n:"Keywords",t:ko},6:{n:"Comments",t:ko},7:{n:"Template",t:ko},8:{n:"LastAuthor",t:ko},9:{n:"RevNumber",t:ko},10:{n:"EditTime",t:mC},11:{n:"LastPrinted",t:mC},12:{n:"CreatedDate",t:mC},13:{n:"ModifiedDate",t:mC},14:{n:"PageCount",t:Bl},15:{n:"WordCount",t:Bl},16:{n:"CharCount",t:Bl},17:{n:"Thumbnail",t:X1t},18:{n:"Application",t:ko},19:{n:"DocSecurity",t:Bl},255:{},2147483648:{n:"Locale",t:DN},2147483651:{n:"Behavior",t:DN},1919054434:{}};function Q1t(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var evt=Q1t([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),tvt=Tl(evt),jI={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},nvt={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},gC={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cbe(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ube(t,e){var n=d1t(nvt),r=[],i;r[r.length]=Is,r[r.length]=yt("Types",null,{xmlns:so.CT,"xmlns:xsd":so.xsd,"xmlns:xsi":so.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return yt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],r[r.length]=yt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:gC[l][e.bookType]||gC[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(c){r[r.length]=yt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:gC[l][e.bookType]||gC[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(c){r[r.length]=yt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var mr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hbe(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function hw(t){var e=[Is,yt("Relationships",null,{xmlns:so.RELS})];return No(t["!id"]).forEach(function(n){e[e.length]=yt("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Fr(t,e,n,r,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=n,[mr.HLINK,mr.XPATH,mr.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function rvt(t){var e=[Is];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function loe(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function ivt(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function svt(t){var e=[Is];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(loe(t[n][0],t[n][1])),e.push(ivt("",t[n][0]));return e.push(loe("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function dbe(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+AN.version+"</meta:generator></office:meta></office:document-meta>"}var n1=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function C8(t,e,n,r,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ur(e),r[r.length]=n?yt(t,e,n):Po(t,e))}function fbe(t,e){var n=e||{},r=[Is,yt("cp:coreProperties",null,{"xmlns:cp":so.CORE_PROPS,"xmlns:dc":so.dc,"xmlns:dcterms":so.dcterms,"xmlns:dcmitype":so.dcmitype,"xmlns:xsi":so.xsi})],i={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&C8("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:tz(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),t.ModifiedDate!=null&&C8("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:tz(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=n1.length;++s){var o=n1[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&C8(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var dw=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],pbe=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function mbe(t){var e=[],n=yt;return t||(t={}),t.Application="SheetJS",e[e.length]=Is,e[e.length]=yt("Properties",null,{xmlns:so.EXT_PROPS,"xmlns:vt":so.vt}),dw.forEach(function(r){if(t[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Ur(String(t[r[1]]));break;case"bool":i=t[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=n(r[0],i))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Ur(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function gbe(t){var e=[Is,yt("Properties",null,{xmlns:so.CUST_PROPS,"xmlns:vt":so.vt})];if(!t)return e.join("");var n=1;return No(t).forEach(function(i){++n,e[e.length]=yt("property",E1t(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ur(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var coe={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function ovt(t,e){var n=[];return No(coe).map(function(r){for(var i=0;i<n1.length;++i)if(n1[i][1]==r)return n1[i];for(i=0;i<dw.length;++i)if(dw[i][1]==r)return dw[i];throw r}).forEach(function(r){if(t[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Po(coe[r[1]]||r[1],i))}}),yt("DocumentProperties",n.join(""),{xmlns:Jl.o})}function avt(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return t&&No(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<n1.length;++o)if(s==n1[o][1])return;for(o=0;o<dw.length;++o)if(s==dw[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(yt(Xse(s),a,{"dt:dt":l}))}}),e&&No(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(yt(Xse(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+Jl.o+'">'+i.join("")+"</"+r+">"}function lvt(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=Ge(8);return o.write_shift(4,r),o.write_shift(4,i),o}function uoe(t,e){var n=Ge(4),r=Ge(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=Ge(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=lvt(e);break;case 31:case 80:for(r=Ge(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Ro([n,r])}var ybe=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function cvt(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function hoe(t,e,n){var r=Ge(8),i=[],s=[],o=8,a=0,l=Ge(8),c=Ge(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!e){c=Ge(8),c.write_shift(4,0),i.unshift(c);var u=[Ge(4)];for(u[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=Ge(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Ro(u),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(ybe.indexOf(t[a][0])>-1||pbe.indexOf(t[a][0])>-1)&&t[a][1]!=null){var f=t[a][1],g=0;if(e){g=+e[t[a][0]];var v=n[g];if(v.p=="version"&&typeof f=="string"){var x=f.split(".");f=(+x[0]<<16)+(+x[1]||0)}l=uoe(v.t,f)}else{var b=cvt(f);b==-1&&(b=31,f=String(f)),l=uoe(b,f)}s.push(l),c=Ge(8),c.write_shift(4,e?g:2+a),i.push(c),o+=8+l.length}var T=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,T),T+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),Ro([r].concat(i).concat(s))}function doe(t,e,n,r,i,s){var o=Ge(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,qr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=hoe(t,n,r);if(a.push(l),i){var c=hoe(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Ro(a)}function uvt(t,e){e||(e=Ge(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function hvt(t,e){return t.read_shift(e)===1}function ka(t,e){return e||(e=Ge(2)),e.write_shift(2,+!!t),e}function vbe(t){return t.read_shift(2,"u")}function Fc(t,e){return e||(e=Ge(2)),e.write_shift(2,t),e}function _be(t,e,n){return n||(n=Ge(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function xbe(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?t.read_shift(r,i):"";return o}function dvt(t){var e=t.t||"",n=Ge(3);n.write_shift(2,e.length),n.write_shift(1,1);var r=Ge(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[n,r];return Ro(i)}function fvt(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function pvt(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):fvt(t,r,n)}function mvt(t,e,n){if(n.biff>5)return pvt(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function wbe(t,e,n){return n||(n=Ge(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function foe(t,e){e||(e=Ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function gvt(t){var e=Ge(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)e.write_shift(4,o[n]);if(s==28)r=r.slice(1),foe(r,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)e.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)e.write_shift(2,a.charCodeAt(n));e.write_shift(2,0),s&8&&foe(i>-1?r.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)e.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)e.write_shift(1,r.charCodeAt(n+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function W1(t,e,n,r){return r||(r=Ge(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function yvt(t,e,n){var r=n.biff>8?4:2,i=t.read_shift(r),s=t.read_shift(r,"i"),o=t.read_shift(r,"i");return[i,s,o]}function vvt(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:n}}}function bbe(t,e){return e||(e=Ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function VH(t,e,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ge(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function _vt(t,e){var n=!e||e.biff==8,r=Ge(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function xvt(t,e){var n=!e||e.biff>=8?2:1,r=Ge(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function wvt(t,e){var n=Ge(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],i=0;i<t.length;++i)r[i]=dvt(t[i]);var s=Ro([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function bvt(){var t=Ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Evt(t){var e=Ge(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Svt(t,e){var n=t.name||"Arial",r=e&&e.biff==5,i=r?15+n.length:16+2*n.length,s=Ge(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function Tvt(t,e,n,r){var i=Ge(10);return W1(t,e,r,i),i.write_shift(4,n),i}function kvt(t,e,n,r,i){var s=!i||i.biff==8,o=Ge(8+ +s+(1+s)*n.length);return W1(t,e,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function Avt(t,e,n,r){var i=n&&n.biff==5;r||(r=Ge(i?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Ivt(t,e){var n=e.biff==8||!e.biff?4:2,r=Ge(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function poe(t,e,n,r){var i=n&&n.biff==5;r||(r=Ge(i?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Rvt(t){var e=Ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Pvt(t,e,n,r,i,s){var o=Ge(8);return W1(t,e,r,o),_be(n,s,o),o}function Cvt(t,e,n,r){var i=Ge(14);return W1(t,e,r,i),B1(n,i),i}function Mvt(t,e,n){if(n.biff<8)return Nvt(t,e,n);for(var r=[],i=t.l+e,s=t.read_shift(n.biff>8?4:2);s--!==0;)r.push(yvt(t,n.biff>8?12:6,n));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return r}function Nvt(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=xbe(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function Ovt(t){var e=Ge(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)bbe(t[n],e);return e}function Lvt(t){var e=Ge(24),n=ao(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Ro([e,gvt(t[1])])}function Dvt(t){var e=t[1].Tooltip,n=Ge(10+2*(e.length+1));n.write_shift(2,2048);var r=ao(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<e.length;++i)n.write_shift(2,e.charCodeAt(i));return n.write_shift(2,0),n}function $vt(t){return t||(t=Ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function jvt(t,e,n){if(!n.cellStyles)return Cd(t,e);var r=n&&n.biff>=12?4:2,i=t.read_shift(r),s=t.read_shift(r),o=t.read_shift(r),a=t.read_shift(r),l=t.read_shift(2);r==2&&(t.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}function Fvt(t,e){var n=Ge(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function Vvt(t){for(var e=Ge(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}function zvt(t,e,n){var r=Ge(15);return VI(r,t,e),r.write_shift(8,n,"f"),r}function Uvt(t,e,n){var r=Ge(9);return VI(r,t,e),r.write_shift(2,n),r}var Gvt=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=RH({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var c=[],u=G1(1);switch(l.type){case"base64":u=Ku(dp(a));break;case"binary":u=Ku(a);break;case"buffer":case"array":u=a;break}Kl(u,0);var h=u.read_shift(1),f=!!(h&136),g=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,f=!0;break;case 49:g=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,b=521;h==2&&(x=u.read_shift(2)),u.l+=3,h!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(b=u.read_shift(2));var T=u.read_shift(2),A=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(A=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var I=[],R={},M=Math.min(u.length,h==2?521:b-10-(g?264:0)),F=v?32:11;u.l<M&&u[u.l]!=13;)switch(R={},R.name=IN.utils.decode(A,u.slice(u.l,u.l+F)).replace(/[\u0000\r\n].*$/g,""),u.l+=F,R.type=String.fromCharCode(u.read_shift(1)),h!=2&&!v&&(R.offset=u.read_shift(4)),R.len=u.read_shift(1),h==2&&(R.offset=u.read_shift(2)),R.dec=u.read_shift(1),R.name.length&&I.push(R),h!=2&&(u.l+=v?13:14),R.type){case"B":(!g||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var C=0,N=0;for(c[0]=[],N=0;N!=I.length;++N)c[0][N]=I[N].name;for(;x-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,c[++C]=[],N=0,N=0;N!=I.length;++N){var O=u.slice(u.l,u.l+I[N].len);u.l+=I[N].len,Kl(O,0);var j=IN.utils.decode(A,O);switch(I[N].type){case"C":j.trim().length&&(c[C][N]=j.replace(/\s+$/,""));break;case"D":j.length===8?c[C][N]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):c[C][N]=j;break;case"F":c[C][N]=parseFloat(j.trim());break;case"+":case"I":c[C][N]=v?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":c[C][N]=!0;break;case"N":case"F":c[C][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[C][N]="##MEMO##"+(v?parseInt(j.trim(),10):O.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(c[C][N]=+j||0);break;case"@":c[C][N]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":c[C][N]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":c[C][N]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][N]=-O.read_shift(-8,"f");break;case"B":if(g&&I[N].len==8){c[C][N]=O.read_shift(8,"f");break}case"G":case"P":O.l+=I[N].len;break;case"0":if(I[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[N].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=I,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=fb(n(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return hv(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&oA(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=xl(),h=zN(a,{header:1,raw:!0,cellDates:!0}),f=h[0],g=h.slice(1),v=a["!cols"]||[],x=0,b=0,T=0,A=1;for(x=0;x<f.length;++x){if(((v[x]||{}).DBF||{}).name){f[x]=v[x].DBF.name,++T;continue}if(f[x]!=null){if(++T,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(b=0;b<1024;++b)if(f.indexOf(f[x]+"_"+b)==-1){f[x]+="_"+b;break}}}}var I=pi(a["!ref"]),R=[],M=[],F=[];for(x=0;x<=I.e.c-I.s.c;++x){var C="",N="",O=0,j=[];for(b=0;b<g.length;++b)g[b][x]!=null&&j.push(g[b][x]);if(j.length==0||f[x]==null){R[x]="?";continue}for(b=0;b<j.length;++b){switch(typeof j[b]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=j[b]instanceof Date?"D":"C";break;default:N="C"}O=Math.max(O,String(j[b]).length),C=C&&C!=N?"C":N}O>250&&(O=250),N=((v[x]||{}).DBF||{}).type,N=="C"&&v[x].DBF.len>O&&(O=v[x].DBF.len),C=="B"&&N=="N"&&(C="N",F[x]=v[x].DBF.dec,O=v[x].DBF.len),M[x]=C=="C"||N=="N"?O:s[C]||0,A+=M[x],R[x]=C}var V=u.next(32);for(V.write_shift(4,318902576),V.write_shift(4,g.length),V.write_shift(2,296+32*T),V.write_shift(2,A),x=0;x<4;++x)V.write_shift(4,0);for(V.write_shift(4,0|(+e[S2e]||3)<<8),x=0,b=0;x<f.length;++x)if(f[x]!=null){var W=u.next(32),U=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,U,"sbcs"),W.write_shift(1,R[x]=="?"?"C":R[x],"sbcs"),W.write_shift(4,b),W.write_shift(1,M[x]||s[R[x]]||0),W.write_shift(1,F[x]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),b+=M[x]||s[R[x]]||0}var pe=u.next(264);for(pe.write_shift(4,13),x=0;x<65;++x)pe.write_shift(4,0);for(x=0;x<g.length;++x){var Ne=u.next(A);for(Ne.write_shift(1,0),b=0;b<f.length;++b)if(f[b]!=null)switch(R[b]){case"L":Ne.write_shift(1,g[x][b]==null?63:g[x][b]?84:70);break;case"B":Ne.write_shift(8,g[x][b]||0,"f");break;case"N":var Se="0";for(typeof g[x][b]=="number"&&(Se=g[x][b].toFixed(F[b]||0)),T=0;T<M[b]-Se.length;++T)Ne.write_shift(1,32);Ne.write_shift(1,Se,"sbcs");break;case"D":g[x][b]?(Ne.write_shift(4,("0000"+g[x][b].getFullYear()).slice(-4),"sbcs"),Ne.write_shift(2,("00"+(g[x][b].getMonth()+1)).slice(-2),"sbcs"),Ne.write_shift(2,("00"+g[x][b].getDate()).slice(-2),"sbcs")):Ne.write_shift(8,"00000000","sbcs");break;case"C":var je=String(g[x][b]!=null?g[x][b]:"").slice(0,M[b]);for(Ne.write_shift(1,je,"sbcs"),T=0;T<M[b]-je.length;++T)Ne.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}})(),Bvt=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+No(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(f,g){var v=t[g];return typeof v=="number"?jse(v):v},r=function(f,g,v){var x=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?f:jse(x)};t["|"]=254;function i(f,g){switch(g.type){case"base64":return s(dp(f),g);case"binary":return s(f,g);case"buffer":return s(wr&&Buffer.isBuffer(f)?f.toString("binary"):LI(f),g);case"array":return s(uL(f),g)}throw new Error("Unrecognized type "+g.type)}function s(f,g){var v=f.split(/[\n\r]+/),x=-1,b=-1,T=0,A=0,I=[],R=[],M=null,F={},C=[],N=[],O=[],j=0,V;for(+g.codepage>=0&&oA(+g.codepage);T!==v.length;++T){j=0;var W=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),U=W.replace(/;;/g,"\0").split(";").map(function(le){return le.replace(/\u0000/g,";")}),pe=U[0],Ne;if(W.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&R.push(W.slice(3).replace(/;;/g,";"));break;case"C":var Se=!1,je=!1,de=!1,Oe=!1,Ae=-1,Q=-1;for(A=1;A<U.length;++A)switch(U[A].charAt(0)){case"A":break;case"X":b=parseInt(U[A].slice(1))-1,je=!0;break;case"Y":for(x=parseInt(U[A].slice(1))-1,je||(b=0),V=I.length;V<=x;++V)I[V]=[];break;case"K":Ne=U[A].slice(1),Ne.charAt(0)==='"'?Ne=Ne.slice(1,Ne.length-1):Ne==="TRUE"?Ne=!0:Ne==="FALSE"?Ne=!1:isNaN(ep(Ne))?isNaN(lA(Ne).getDate())||(Ne=Da(Ne)):(Ne=ep(Ne),M!==null&&D2e(M)&&(Ne=V2e(Ne))),Se=!0;break;case"E":Oe=!0;var B=U_t(U[A].slice(1),{r:x,c:b});I[x][b]=[I[x][b],B];break;case"S":de=!0,I[x][b]=[I[x][b],"S5S"];break;case"G":break;case"R":Ae=parseInt(U[A].slice(1))-1;break;case"C":Q=parseInt(U[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+W)}if(Se&&(I[x][b]&&I[x][b].length==2?I[x][b][0]=Ne:I[x][b]=Ne,M=null),de){if(Oe)throw new Error("SYLK shared formula cannot have own formula");var ne=Ae>-1&&I[Ae][Q];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");I[x][b][1]=G_t(ne[1],{r:x-Ae,c:b-Q})}break;case"F":var ie=0;for(A=1;A<U.length;++A)switch(U[A].charAt(0)){case"X":b=parseInt(U[A].slice(1))-1,++ie;break;case"Y":for(x=parseInt(U[A].slice(1))-1,V=I.length;V<=x;++V)I[V]=[];break;case"M":j=parseInt(U[A].slice(1))/20;break;case"F":break;case"G":break;case"P":M=R[parseInt(U[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=U[A].slice(1).split(" "),V=parseInt(O[0],10);V<=parseInt(O[1],10);++V)j=parseInt(O[2],10),N[V-1]=j===0?{hidden:!0}:{wch:j},zH(N[V-1]);break;case"C":b=parseInt(U[A].slice(1))-1,N[b]||(N[b]={});break;case"R":x=parseInt(U[A].slice(1))-1,C[x]||(C[x]={}),j>0?(C[x].hpt=j,C[x].hpx=Abe(j)):j===0&&(C[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+W)}ie<1&&(M=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+W)}}return C.length>0&&(F["!rows"]=C),N.length>0&&(F["!cols"]=N),g&&g.sheetRows&&(I=I.slice(0,g.sheetRows)),[I,F]}function o(f,g){var v=i(f,g),x=v[0],b=v[1],T=fb(x,g);return No(b).forEach(function(A){T[A]=b[A]}),T}function a(f,g){return hv(o(f,g),g)}function l(f,g,v,x){var b="C;Y"+(v+1)+";X"+(x+1)+";K";switch(f.t){case"n":b+=f.v||0,f.f&&!f.F&&(b+=";E"+GH(f.f,{r:v,c:x}));break;case"b":b+=f.v?"TRUE":"FALSE";break;case"e":b+=f.w||f.v;break;case"d":b+='"'+(f.w||f.v)+'"';break;case"s":b+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function c(f,g){g.forEach(function(v,x){var b="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?b+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=$N(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=jN(v.wpx)),typeof v.wch=="number"&&(b+=Math.round(v.wch))),b.charAt(b.length-1)!=" "&&f.push(b)})}function u(f,g){g.forEach(function(v,x){var b="F;";v.hidden?b+="M0;":v.hpt?b+="M"+20*v.hpt+";":v.hpx&&(b+="M"+20*FN(v.hpx)+";"),b.length>2&&f.push(b+"R"+(x+1))})}function h(f,g){var v=["ID;PWXL;N;E"],x=[],b=pi(f["!ref"]),T,A=Array.isArray(f),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&c(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var R=b.s.r;R<=b.e.r;++R)for(var M=b.s.c;M<=b.e.c;++M){var F=Br({r:R,c:M});T=A?(f[R]||[])[M]:f[F],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,f,R,M))}return v.join(I)+I+x.join(I)+I+"E"+I}return{to_workbook:a,to_sheet:o,from_sheet:h}})(),Wvt=(function(){function t(s,o){switch(o.type){case"base64":return e(dp(s),o);case"binary":return e(s,o);case"buffer":return e(wr&&Buffer.isBuffer(s)?s.toString("binary"):LI(s),o);case"array":return e(uL(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var f=a[u].trim().split(","),g=f[0],v=f[1];++u;for(var x=a[u]||"";(x.match(/["]/g)||[]).length&1&&u<a.length-1;)x+=`
`+a[++u];switch(x=x.trim(),+g){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(ep(v))?isNaN(lA(v).getDate())?h[l][c]=v:h[l][c]=Da(v):h[l][c]=ep(v),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function n(s,o){return fb(t(s,o),o)}function r(s,o){return hv(n(s,o),o)}var i=(function(){var s=function(l,c,u,h,f){l.push(c),l.push(u+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=pi(l["!ref"]),h,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){o(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var x=Br({r:g,c:v});if(h=f?(l[g]||[])[v]:l[x],!h){o(c,1,0,"");continue}switch(h.t){case"n":var b=h.w;!b&&h.v!=null&&(b=h.v),b==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,b,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Bg(h.z||es[14],Sl(Da(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}})();return{to_workbook:r,to_sheet:n,from_sheet:i}})(),Ebe=(function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,f){for(var g=h.split(`
`),v=-1,x=-1,b=0,T=[];b!==g.length;++b){var A=g[b].trim().split(":");if(A[0]==="cell"){var I=ao(A[1]);if(T.length<=I.r)for(v=T.length;v<=I.r;++v)T[v]||(T[v]=[]);switch(v=I.r,x=I.c,A[2]){case"t":T[v][x]=t(A[3]);break;case"v":T[v][x]=+A[3];break;case"vtf":var R=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[v][x]=!!+A[4];break;default:T[v][x]=+A[4];break}A[2]=="vtf"&&(T[v][x]=[T[v][x],R])}}}return f&&f.sheetRows&&(T=T.slice(0,f.sheetRows)),T}function r(h,f){return fb(n(h,f),f)}function i(h,f){return hv(r(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],g=[],v,x="",b=pc(h["!ref"]),T=Array.isArray(h),A=b.s.r;A<=b.e.r;++A)for(var I=b.s.c;I<=b.e.c;++I)if(x=Br({r:A,c:I}),v=T?(h[A]||[])[I]:h[x],!(!v||v.v==null||v.t==="z")){switch(g=["cell",x,"t"],v.t){case"s":case"str":g.push(e(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=e(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var R=Sl(Da(v.v));g[2]="vtc",g[3]="nd",g[4]=""+R,g[5]=v.w||Bg(v.z||es[14],R);break;case"e":continue}f.push(g.join(":"))}return f.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}})(),Hvt=(function(){function t(u,h,f,g,v){v.raw?h[f][g]=u:u===""||(u==="TRUE"?h[f][g]=!0:u==="FALSE"?h[f][g]=!1:isNaN(ep(u))?isNaN(lA(u).getDate())?h[f][g]=u:h[f][g]=Da(u):h[f][g]=ep(u))}function e(u,h){var f=h||{},g=[];if(!u||u.length===0)return g;for(var v=u.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var b=10,T=0,A=0;A<=x;++A)T=v[A].indexOf(" "),T==-1?T=v[A].length:T++,b=Math.max(b,T);for(A=0;A<=x;++A){g[A]=[];var I=0;for(t(v[A].slice(0,b).trim(),g,A,I,f),I=1;I<=(v[A].length-b)/10+1;++I)t(v[A].slice(b+(I-1)*10,b+I*10).trim(),g,A,I,f)}return f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var h={},f=!1,g=0,v=0;g<u.length;++g)(v=u.charCodeAt(g))==34?f=!f:!f&&v in n&&(h[v]=(h[v]||0)+1);v=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&v.push([h[g],g]);if(!v.length){h=r;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&v.push([h[g],g])}return v.sort(function(x,b){return x[0]-b[0]||r[x[1]]-r[b[1]]}),n[v.pop()[1]]||44}function s(u,h){var f=h||{},g="",v=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(g=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(g=u.charAt(4),u=u.slice(6)):g=i(u.slice(0,1024)):f&&f.FS?g=f.FS:g=i(u.slice(0,1024));var b=0,T=0,A=0,I=0,R=0,M=g.charCodeAt(0),F=!1,C=0,N=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var O=f.dateNF!=null?l1t(f.dateNF):null;function j(){var V=u.slice(I,R),W={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)W.t="z";else if(f.raw)W.t="s",W.v=V;else if(V.trim().length===0)W.t="s",W.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(W.t="s",W.v=V.slice(2,-1).replace(/""/g,'"')):B_t(V)?(W.t="n",W.f=V.slice(1)):(W.t="s",W.v=V);else if(V=="TRUE")W.t="b",W.v=!0;else if(V=="FALSE")W.t="b",W.v=!1;else if(!isNaN(A=ep(V)))W.t="n",f.cellText!==!1&&(W.w=V),W.v=A;else if(!isNaN(lA(V).getDate())||O&&V.match(O)){W.z=f.dateNF||es[14];var U=0;O&&V.match(O)&&(V=c1t(V,f.dateNF,V.match(O)||[]),U=1),f.cellDates?(W.t="d",W.v=Da(V,U)):(W.t="n",W.v=Sl(Da(V,U))),f.cellText!==!1&&(W.w=Bg(W.z,W.v instanceof Date?Sl(W.v):W.v)),f.cellNF||delete W.z}else W.t="s",W.v=V;if(W.t=="z"||(f.dense?(v[b]||(v[b]=[]),v[b][T]=W):v[Br({c:T,r:b})]=W),I=R+1,N=u.charCodeAt(I),x.e.c<T&&(x.e.c=T),x.e.r<b&&(x.e.r=b),C==M)++T;else if(T=0,++b,f.sheetRows&&f.sheetRows<=b)return!0}e:for(;R<u.length;++R)switch(C=u.charCodeAt(R)){case 34:N===34&&(F=!F);break;case M:case 10:case 13:if(!F&&j())break e;break}return R-I>0&&j(),v["!ref"]=ks(x),v}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):fb(e(u,h),h)}function a(u,h){var f="",g=h.type=="string"?[0,0,0,0]:iEt(u,h);switch(h.type){case"base64":f=dp(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof IN<"u"||(f=wr&&Buffer.isBuffer(u)?u.toString("binary"):LI(u));break;case"array":f=uL(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?f=DT(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=DT(f):h.type=="binary"&&typeof IN<"u",f.slice(0,19)=="socialcalc:version:"?Ebe.to_sheet(h.type=="string"?f:DT(f),h):o(f,h)}function l(u,h){return hv(a(u,h),h)}function c(u){for(var h=[],f=pi(u["!ref"]),g,v=Array.isArray(u),x=f.s.r;x<=f.e.r;++x){for(var b=[],T=f.s.c;T<=f.e.c;++T){var A=Br({r:x,c:T});if(g=v?(u[x]||[])[T]:u[A],!g||g.v==null){b.push("          ");continue}for(var I=(g.w||(fp(g),g.w)||"").slice(0,10);I.length<10;)I+=" ";b.push(I+(T===0?" ":""))}h.push(b.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}})(),moe=(function(){function t(B,ne,ie){if(B){Kl(B,B.l||0);for(var le=ie.Enum||Ae;B.l<B.length;){var ve=B.read_shift(2),qe=le[ve]||le[65535],Ke=B.read_shift(2),Te=B.l+Ke,we=qe.f&&qe.f(B,Ke,ie);if(B.l=Te,ne(we,qe,ve))return}}}function e(B,ne){switch(ne.type){case"base64":return n(Ku(dp(B)),ne);case"binary":return n(Ku(B),ne);case"buffer":case"array":return n(B,ne)}throw"Unsupported type "+ne.type}function n(B,ne){if(!B)return B;var ie=ne||{},le=ie.dense?[]:{},ve="Sheet1",qe="",Ke=0,Te={},we=[],Dt=[],Ye={s:{r:0,c:0},e:{r:0,c:0}},sn=ie.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)ie.Enum=Ae,t(B,function(dt,lr,$n){switch($n){case 0:ie.vers=dt,dt>=4096&&(ie.qpro=!0);break;case 6:Ye=dt;break;case 204:dt&&(qe=dt);break;case 222:qe=dt;break;case 15:case 51:ie.qpro||(dt[1].v=dt[1].v.slice(1));case 13:case 14:case 16:$n==14&&(dt[2]&112)==112&&(dt[2]&15)>1&&(dt[2]&15)<15&&(dt[1].z=ie.dateNF||es[14],ie.cellDates&&(dt[1].t="d",dt[1].v=V2e(dt[1].v))),ie.qpro&&dt[3]>Ke&&(le["!ref"]=ks(Ye),Te[ve]=le,we.push(ve),le=ie.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},Ke=dt[3],ve=qe||"Sheet"+(Ke+1),qe="");var Un=ie.dense?(le[dt[0].r]||[])[dt[0].c]:le[Br(dt[0])];if(Un){Un.t=dt[1].t,Un.v=dt[1].v,dt[1].z!=null&&(Un.z=dt[1].z),dt[1].f!=null&&(Un.f=dt[1].f);break}ie.dense?(le[dt[0].r]||(le[dt[0].r]=[]),le[dt[0].r][dt[0].c]=dt[1]):le[Br(dt[0])]=dt[1];break}},ie);else if(B[2]==26||B[2]==14)ie.Enum=Q,B[2]==14&&(ie.qpro=!0,B.l=0),t(B,function(dt,lr,$n){switch($n){case 204:ve=dt;break;case 22:dt[1].v=dt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(dt[3]>Ke&&(le["!ref"]=ks(Ye),Te[ve]=le,we.push(ve),le=ie.dense?[]:{},Ye={s:{r:0,c:0},e:{r:0,c:0}},Ke=dt[3],ve="Sheet"+(Ke+1)),sn>0&&dt[0].r>=sn)break;ie.dense?(le[dt[0].r]||(le[dt[0].r]=[]),le[dt[0].r][dt[0].c]=dt[1]):le[Br(dt[0])]=dt[1],Ye.e.c<dt[0].c&&(Ye.e.c=dt[0].c),Ye.e.r<dt[0].r&&(Ye.e.r=dt[0].r);break;case 27:dt[14e3]&&(Dt[dt[14e3][0]]=dt[14e3][1]);break;case 1537:Dt[dt[0]]=dt[1],dt[0]==Ke&&(ve=dt[1]);break}},ie);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(le["!ref"]=ks(Ye),Te[qe||ve]=le,we.push(qe||ve),!Dt.length)return{SheetNames:we,Sheets:Te};for(var $t={},fn=[],yn=0;yn<Dt.length;++yn)Te[we[yn]]?(fn.push(Dt[yn]||we[yn]),$t[Dt[yn]]=Te[Dt[yn]]||Te[we[yn]]):(fn.push(Dt[yn]),$t[Dt[yn]]={"!ref":"A1"});return{SheetNames:fn,Sheets:$t}}function r(B,ne){var ie=ne||{};if(+ie.codepage>=0&&oA(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK1 to JS string");var le=xl(),ve=pi(B["!ref"]),qe=Array.isArray(B),Ke=[];vt(le,0,s(1030)),vt(le,6,l(ve));for(var Te=Math.min(ve.e.r,8191),we=ve.s.r;we<=Te;++we)for(var Dt=Mo(we),Ye=ve.s.c;Ye<=ve.e.c;++Ye){we===ve.s.r&&(Ke[Ye]=ma(Ye));var sn=Ke[Ye]+Dt,$t=qe?(B[we]||[])[Ye]:B[sn];if(!(!$t||$t.t=="z"))if($t.t=="n")($t.v|0)==$t.v&&$t.v>=-32768&&$t.v<=32767?vt(le,13,g(we,Ye,$t.v)):vt(le,14,x(we,Ye,$t.v));else{var fn=fp($t);vt(le,15,h(we,Ye,fn.slice(0,239)))}}return vt(le,1),le.end()}function i(B,ne){var ie=ne||{};if(+ie.codepage>=0&&oA(+ie.codepage),ie.type=="string")throw new Error("Cannot write WK3 to JS string");var le=xl();vt(le,0,o(B));for(var ve=0,qe=0;ve<B.SheetNames.length;++ve)(B.Sheets[B.SheetNames[ve]]||{})["!ref"]&&vt(le,27,Oe(B.SheetNames[ve],qe++));var Ke=0;for(ve=0;ve<B.SheetNames.length;++ve){var Te=B.Sheets[B.SheetNames[ve]];if(!(!Te||!Te["!ref"])){for(var we=pi(Te["!ref"]),Dt=Array.isArray(Te),Ye=[],sn=Math.min(we.e.r,8191),$t=we.s.r;$t<=sn;++$t)for(var fn=Mo($t),yn=we.s.c;yn<=we.e.c;++yn){$t===we.s.r&&(Ye[yn]=ma(yn));var dt=Ye[yn]+fn,lr=Dt?(Te[$t]||[])[yn]:Te[dt];if(!(!lr||lr.t=="z"))if(lr.t=="n")vt(le,23,j($t,yn,Ke,lr.v));else{var $n=fp(lr);vt(le,22,C($t,yn,Ke,$n.slice(0,239)))}}++Ke}}return vt(le,1),le.end()}function s(B){var ne=Ge(2);return ne.write_shift(2,B),ne}function o(B){var ne=Ge(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var ie=0,le=0,ve=0,qe=0;qe<B.SheetNames.length;++qe){var Ke=B.SheetNames[qe],Te=B.Sheets[Ke];if(!(!Te||!Te["!ref"])){++ve;var we=pc(Te["!ref"]);ie<we.e.r&&(ie=we.e.r),le<we.e.c&&(le=we.e.c)}}return ie>8191&&(ie=8191),ne.write_shift(2,ie),ne.write_shift(1,ve),ne.write_shift(1,le),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function a(B,ne,ie){var le={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&ie.qpro?(le.s.c=B.read_shift(1),B.l++,le.s.r=B.read_shift(2),le.e.c=B.read_shift(1),B.l++,le.e.r=B.read_shift(2),le):(le.s.c=B.read_shift(2),le.s.r=B.read_shift(2),ne==12&&ie.qpro&&(B.l+=2),le.e.c=B.read_shift(2),le.e.r=B.read_shift(2),ne==12&&ie.qpro&&(B.l+=2),le.s.c==65535&&(le.s.c=le.e.c=le.s.r=le.e.r=0),le)}function l(B){var ne=Ge(8);return ne.write_shift(2,B.s.c),ne.write_shift(2,B.s.r),ne.write_shift(2,B.e.c),ne.write_shift(2,B.e.r),ne}function c(B,ne,ie){var le=[{c:0,r:0},{t:"n",v:0},0,0];return ie.qpro&&ie.vers!=20768?(le[0].c=B.read_shift(1),le[3]=B.read_shift(1),le[0].r=B.read_shift(2),B.l+=2):(le[2]=B.read_shift(1),le[0].c=B.read_shift(2),le[0].r=B.read_shift(2)),le}function u(B,ne,ie){var le=B.l+ne,ve=c(B,ne,ie);if(ve[1].t="s",ie.vers==20768){B.l++;var qe=B.read_shift(1);return ve[1].v=B.read_shift(qe,"utf8"),ve}return ie.qpro&&B.l++,ve[1].v=B.read_shift(le-B.l,"cstr"),ve}function h(B,ne,ie){var le=Ge(7+ie.length);le.write_shift(1,255),le.write_shift(2,ne),le.write_shift(2,B),le.write_shift(1,39);for(var ve=0;ve<le.length;++ve){var qe=ie.charCodeAt(ve);le.write_shift(1,qe>=128?95:qe)}return le.write_shift(1,0),le}function f(B,ne,ie){var le=c(B,ne,ie);return le[1].v=B.read_shift(2,"i"),le}function g(B,ne,ie){var le=Ge(7);return le.write_shift(1,255),le.write_shift(2,ne),le.write_shift(2,B),le.write_shift(2,ie,"i"),le}function v(B,ne,ie){var le=c(B,ne,ie);return le[1].v=B.read_shift(8,"f"),le}function x(B,ne,ie){var le=Ge(13);return le.write_shift(1,255),le.write_shift(2,ne),le.write_shift(2,B),le.write_shift(8,ie,"f"),le}function b(B,ne,ie){var le=B.l+ne,ve=c(B,ne,ie);if(ve[1].v=B.read_shift(8,"f"),ie.qpro)B.l=le;else{var qe=B.read_shift(2);R(B.slice(B.l,B.l+qe),ve),B.l+=qe}return ve}function T(B,ne,ie){var le=ne&32768;return ne&=-32769,ne=(le?B:0)+(ne>=8192?ne-16384:ne),(le?"":"$")+(ie?ma(ne):Mo(ne))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(B,ne){Kl(B,0);for(var ie=[],le=0,ve="",qe="",Ke="",Te="";B.l<B.length;){var we=B[B.l++];switch(we){case 0:ie.push(B.read_shift(8,"f"));break;case 1:qe=T(ne[0].c,B.read_shift(2),!0),ve=T(ne[0].r,B.read_shift(2),!1),ie.push(qe+ve);break;case 2:{var Dt=T(ne[0].c,B.read_shift(2),!0),Ye=T(ne[0].r,B.read_shift(2),!1);qe=T(ne[0].c,B.read_shift(2),!0),ve=T(ne[0].r,B.read_shift(2),!1),ie.push(Dt+Ye+":"+qe+ve)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:ie.push("("+ie.pop()+")");break;case 5:ie.push(B.read_shift(2));break;case 6:{for(var sn="";we=B[B.l++];)sn+=String.fromCharCode(we);ie.push('"'+sn.replace(/"/g,'""')+'"')}break;case 8:ie.push("-"+ie.pop());break;case 23:ie.push("+"+ie.pop());break;case 22:ie.push("NOT("+ie.pop()+")");break;case 20:case 21:Te=ie.pop(),Ke=ie.pop(),ie.push(["AND","OR"][we-20]+"("+Ke+","+Te+")");break;default:if(we<32&&I[we])Te=ie.pop(),Ke=ie.pop(),ie.push(Ke+I[we]+Te);else if(A[we]){if(le=A[we][1],le==69&&(le=B[B.l++]),le>ie.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+ie.join("|")+"|");return}var $t=ie.slice(-le);ie.length-=le,ie.push(A[we][0]+"("+$t.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}ie.length==1?ne[1].f=""+ie[0]:console.error("WK1 bad formula parse |"+ie.join("|")+"|")}function M(B){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=B.read_shift(2),ne[3]=B[B.l++],ne[0].c=B[B.l++],ne}function F(B,ne){var ie=M(B);return ie[1].t="s",ie[1].v=B.read_shift(ne-4,"cstr"),ie}function C(B,ne,ie,le){var ve=Ge(6+le.length);ve.write_shift(2,B),ve.write_shift(1,ie),ve.write_shift(1,ne),ve.write_shift(1,39);for(var qe=0;qe<le.length;++qe){var Ke=le.charCodeAt(qe);ve.write_shift(1,Ke>=128?95:Ke)}return ve.write_shift(1,0),ve}function N(B,ne){var ie=M(B);ie[1].v=B.read_shift(2);var le=ie[1].v>>1;if(ie[1].v&1)switch(le&7){case 0:le=(le>>3)*5e3;break;case 1:le=(le>>3)*500;break;case 2:le=(le>>3)/20;break;case 3:le=(le>>3)/200;break;case 4:le=(le>>3)/2e3;break;case 5:le=(le>>3)/2e4;break;case 6:le=(le>>3)/16;break;case 7:le=(le>>3)/64;break}return ie[1].v=le,ie}function O(B,ne){var ie=M(B),le=B.read_shift(4),ve=B.read_shift(4),qe=B.read_shift(2);if(qe==65535)return le===0&&ve===3221225472?(ie[1].t="e",ie[1].v=15):le===0&&ve===3489660928?(ie[1].t="e",ie[1].v=42):ie[1].v=0,ie;var Ke=qe&32768;return qe=(qe&32767)-16446,ie[1].v=(1-Ke*2)*(ve*Math.pow(2,qe+32)+le*Math.pow(2,qe)),ie}function j(B,ne,ie,le){var ve=Ge(14);if(ve.write_shift(2,B),ve.write_shift(1,ie),ve.write_shift(1,ne),le==0)return ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(2,65535),ve;var qe=0,Ke=0,Te=0,we=0;return le<0&&(qe=1,le=-le),Ke=Math.log2(le)|0,le/=Math.pow(2,Ke-31),we=le>>>0,(we&2147483648)==0&&(le/=2,++Ke,we=le>>>0),le-=we,we|=2147483648,we>>>=0,le*=Math.pow(2,32),Te=le>>>0,ve.write_shift(4,Te),ve.write_shift(4,we),Ke+=16383+(qe?32768:0),ve.write_shift(2,Ke),ve}function V(B,ne){var ie=O(B);return B.l+=ne-14,ie}function W(B,ne){var ie=M(B),le=B.read_shift(4);return ie[1].v=le>>6,ie}function U(B,ne){var ie=M(B),le=B.read_shift(8,"f");return ie[1].v=le,ie}function pe(B,ne){var ie=U(B);return B.l+=ne-10,ie}function Ne(B,ne){return B[B.l+ne-1]==0?B.read_shift(ne,"cstr"):""}function Se(B,ne){var ie=B[B.l++];ie>ne-1&&(ie=ne-1);for(var le="";le.length<ie;)le+=String.fromCharCode(B[B.l++]);return le}function je(B,ne,ie){if(!(!ie.qpro||ne<21)){var le=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ve=B.read_shift(ne-21,"cstr");return[le,ve]}}function de(B,ne){for(var ie={},le=B.l+ne;B.l<le;){var ve=B.read_shift(2);if(ve==14e3){for(ie[ve]=[0,""],ie[ve][0]=B.read_shift(2);B[B.l];)ie[ve][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return ie}function Oe(B,ne){var ie=Ge(5+B.length);ie.write_shift(2,14e3),ie.write_shift(2,ne);for(var le=0;le<B.length;++le){var ve=B.charCodeAt(le);ie[ie.l++]=ve>127?95:ve}return ie[ie.l++]=0,ie}var Ae={0:{n:"BOF",f:vbe},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ne},222:{n:"SHEETNAMELP",f:Se},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:je},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),qvt=/^\s|\s$|[\t\n\r]/;function Sbe(t,e){if(!e.bookSST)return"";var n=[Is];n[n.length]=yt("sst",null,{xmlns:db[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var i=t[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(qvt)&&(s+=' xml:space="preserve"'),s+=">"+Ur(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function Kvt(t){return[t.read_shift(4),t.read_shift(4)]}function Yvt(t,e){return e||(e=Ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Xvt=V1t;function Zvt(t){var e=xl();tt(e,159,Yvt(t));for(var n=0;n<t.length;++n)tt(e,19,Xvt(t[n]));return tt(e,160),e.end()}function Jvt(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function Tbe(t){var e=0,n,r=Jvt(t),i=r.length+1,s,o,a,l,c;for(n=G1(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=(e&16384)===0?0:1,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var Qvt=(function(){function t(i,s){switch(s.type){case"base64":return e(dp(i),s);case"binary":return e(i,s);case"buffer":return e(wr&&Buffer.isBuffer(i)?i.toString("binary"):LI(i),s);case"array":return e(uL(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,g=0,v,x=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var b=u.slice(g,f.lastIndex-v[0].length);if(b[0]==" "&&(b=b.slice(1)),++x,b.length){var T={v:b,t:"s"};Array.isArray(a)?a[h][x]=T:a[Br({r:h,c:x})]=T}break}g=f.lastIndex}x>c.e.c&&(c.e.c=x)}),a["!ref"]=ks(c),a}function n(i,s){return hv(t(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=pi(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=Br({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(fp(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}})();function goe(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}var e_t=6,tp=e_t;function $N(t){return Math.floor((t+Math.round(128/tp)/256)*tp)}function jN(t){return Math.floor((t-5)/tp*100+.5)/100}function rz(t){return Math.round((t*tp+5)/tp*256)/256}function zH(t){t.width?(t.wpx=$N(t.width),t.wch=jN(t.wpx),t.MDW=tp):t.wpx?(t.wch=jN(t.wpx),t.width=rz(t.wch),t.MDW=tp):typeof t.wch=="number"&&(t.width=rz(t.wch),t.wpx=$N(t.width),t.MDW=tp),t.customWidth&&delete t.customWidth}var t_t=96,kbe=t_t;function FN(t){return t*96/kbe}function Abe(t){return t*kbe/96}function n_t(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=yt("numFmt",null,{numFmtId:r,formatCode:Ur(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=yt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function r_t(t){var e=[];return e[e.length]=yt("cellXfs",null),t.forEach(function(n){e[e.length]=yt("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=yt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Ibe(t,e){var n=[Is,yt("styleSheet",null,{xmlns:db[0],"xmlns:vt":so.vt})],r;return t.SSF&&(r=n_t(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=r_t(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function i_t(t,e){var n=t.read_shift(2),r=ga(t);return[n,r]}function s_t(t,e,n){n||(n=Ge(6+4*e.length)),n.write_shift(2,t),lo(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function o_t(t,e,n){var r={};r.sz=t.read_shift(2)/20;var i=q1t(t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=t.read_shift(2);switch(s===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(r.underline=o);var a=t.read_shift(1);a>0&&(r.family=a);var l=t.read_shift(1);switch(l>0&&(r.charset=l),t.l++,r.color=H1t(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ga(t),r}function a_t(t,e){e||(e=Ge(153)),e.write_shift(2,t.sz*20),K1t(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),LN(t.color,e);var r=0;return r=2,e.write_shift(1,r),lo(t.name,e),e.length>e.l?e.slice(0,e.l):e}var l_t=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],M8,c_t=Cd;function yoe(t,e){e||(e=Ge(84)),M8||(M8=RH(l_t));var n=M8[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(LN({auto:1},e),LN({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function u_t(t,e){var n=t.l+e,r=t.read_shift(2),i=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:i}}function Rbe(t,e,n){n||(n=Ge(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function jE(t,e){return e||(e=Ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var h_t=Cd;function d_t(t,e){return e||(e=Ge(51)),e.write_shift(1,0),jE(null,e),jE(null,e),jE(null,e),jE(null,e),jE(null,e),e.length>e.l?e.slice(0,e.l):e}function f_t(t,e){return e||(e=Ge(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ON(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function p_t(t,e,n){var r=Ge(2052);return r.write_shift(4,t),ON(e,r),ON(n,r),r.length>r.l?r.slice(0,r.l):r}function m_t(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++n}),n!=0&&(tt(t,615,sh(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&tt(t,44,s_t(i,e[i]))}),tt(t,616))}}function g_t(t){var e=1;tt(t,611,sh(e)),tt(t,43,a_t({sz:12,color:{theme:1},name:"Calibri",family:2})),tt(t,612)}function y_t(t){var e=2;tt(t,603,sh(e)),tt(t,45,yoe({patternType:"none"})),tt(t,45,yoe({patternType:"gray125"})),tt(t,604)}function v_t(t){var e=1;tt(t,613,sh(e)),tt(t,46,d_t()),tt(t,614)}function __t(t){var e=1;tt(t,626,sh(e)),tt(t,47,Rbe({numFmtId:0},65535)),tt(t,627)}function x_t(t,e){tt(t,617,sh(e.length)),e.forEach(function(n){tt(t,47,Rbe(n,0))}),tt(t,618)}function w_t(t){var e=1;tt(t,619,sh(e)),tt(t,48,f_t({xfId:0,name:"Normal"})),tt(t,620)}function b_t(t){var e=0;tt(t,505,sh(e)),tt(t,506)}function E_t(t){var e=0;tt(t,508,p_t(e,"TableStyleMedium9","PivotStyleMedium4")),tt(t,509)}function S_t(t,e){var n=xl();return tt(n,278),m_t(n,t.SSF),g_t(n),y_t(n),v_t(n),__t(n),x_t(n,e.cellXfs),w_t(n),b_t(n),E_t(n),tt(n,279),n.end()}function Pbe(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[Is];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function T_t(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ga(t)}}function k_t(t){var e=Ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),lo(t.name,e),e.slice(0,e.l)}function A_t(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function I_t(t){var e=Ge(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function R_t(t,e){var n=Ge(8+2*e.length);return n.write_shift(4,t),lo(e,n),n.slice(0,n.l)}function P_t(t){return t.l+=4,t.read_shift(4)!=0}function C_t(t,e){var n=Ge(8);return n.write_shift(4,t),n.write_shift(4,1),n}function M_t(){var t=xl();return tt(t,332),tt(t,334,sh(1)),tt(t,335,k_t({name:"XLDAPR",version:12e4,flags:3496657072})),tt(t,336),tt(t,339,R_t(1,"XLDAPR")),tt(t,52),tt(t,35,sh(514)),tt(t,4096,sh(0)),tt(t,4097,Fc(1)),tt(t,36),tt(t,53),tt(t,340),tt(t,337,C_t(1)),tt(t,51,I_t([[1,0]])),tt(t,338),tt(t,333),t.end()}function Cbe(){var t=[Is];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function N_t(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=Br(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Nx=1024;function Mbe(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[yt("xml",null,{"xmlns:v":Jl.v,"xmlns:o":Jl.o,"xmlns:x":Jl.x,"xmlns:mv":Jl.mv}).replace(/\/>/,">"),yt("o:shapelayout",yt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),yt("v:shapetype",[yt("v:stroke",null,{joinstyle:"miter"}),yt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Nx<t*1e3;)Nx+=1e3;return e.forEach(function(s){var o=ao(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?yt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=yt("v:fill",l,a),u={on:"t",obscured:"t"};++Nx,i=i.concat(["<v:shape"+uA({id:"_x0000_s"+Nx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,yt("v:shadow",null,u),yt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Po("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Po("x:AutoFill","False"),Po("x:Row",String(o.r)),Po("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Nbe(t){var e=[Is,yt("comments",null,{xmlns:db[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(i){var s=Ur(i.a);n.indexOf(s)==-1&&(n.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(Ur(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Po("t",Ur(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(Po("t",Ur(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function O_t(t,e,n){var r=[Is,yt("ThreadedComments",null,{xmlns:so.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),r.push(yt("threadedComment",Po("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function L_t(t){var e=[Is,yt("personList",null,{xmlns:so.TCMNT,"xmlns:x":db[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(yt("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function D_t(t){var e={};e.iauthor=t.read_shift(4);var n=mv(t);return e.rfx=n.s,e.ref=Br(n.s),t.l+=16,e}function $_t(t,e){return e==null&&(e=Ge(36)),e.write_shift(4,t[1].iauthor),pb(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var j_t=ga;function F_t(t){return lo(t.slice(0,54))}function V_t(t){var e=xl(),n=[];return tt(e,628),tt(e,630),t.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),tt(e,632,F_t(i.a)))})}),tt(e,631),tt(e,633),t.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:ao(r[0]),e:ao(r[0])};tt(e,635,$_t([s,i])),i.t&&i.t.length>0&&tt(e,637,U1t(i)),tt(e,636),delete i.iauthor})}),tt(e,634),tt(e,629),e.end()}function z_t(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&qr.utils.cfb_add(t,i,e.FileIndex[r].content)}})}var Obe=["xlsb","xlsm","xlam","biff8","xla"],U_t=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+ma(u)+(l?"":"$")+Mo(c)}return function(i,s){return e=s,i.replace(t,n)}})(),UH=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,GH=(function(){return function(e,n){return e.replace(UH,function(r,i,s,o,a,l){var c=DH(o)-(s?0:n.c),u=LH(l)-(a?0:n.r),h=u==0?"":a?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}})();function G_t(t,e){return t.replace(UH,function(n,r,i,s,o,a){return r+(i=="$"?i+s:ma(DH(s)+e.c))+(o=="$"?o+a:Mo(LH(a)+e.r))})}function B_t(t){return t.length!=1}function ps(t){t.l+=1}function Wg(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function Lbe(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Dbe(t);n.biff==12&&(r=4)}var i=t.read_shift(r),s=t.read_shift(r),o=Wg(t),a=Wg(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Dbe(t){var e=Wg(t),n=Wg(t),r=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function W_t(t,e,n){if(n.biff<8)return Dbe(t);var r=t.read_shift(n.biff==12?4:2),i=t.read_shift(n.biff==12?4:2),s=Wg(t),o=Wg(t);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function $be(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return H_t(t);var r=t.read_shift(n&&n.biff==12?4:2),i=Wg(t);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function H_t(t){var e=Wg(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function q_t(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function K_t(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return Y_t(t);var i=t.read_shift(r>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function Y_t(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:i,rRel:r}}function X_t(t,e,n){var r=(t[t.l++]&96)>>5,i=Lbe(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function Z_t(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Lbe(t,s,n);return[r,i,o]}function J_t(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function Q_t(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[r,i]}function ext(t,e,n){var r=(t[t.l++]&96)>>5,i=W_t(t,e-1,n);return[r,i]}function txt(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function voe(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function nxt(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(t.read_shift(n&&n.biff==2?1:2));return i}function rxt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function ixt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function sxt(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function oxt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function jbe(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function axt(t){return t.read_shift(2),jbe(t)}function lxt(t){return t.read_shift(2),jbe(t)}function cxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=$be(t,0,n);return[r,i]}function uxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=K_t(t,0,n);return[r,i]}function hxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var s=$be(t,0,n);return[r,i,s]}function dxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(n&&n.biff<=3?1:2);return[dwt[i],zbe[i],r]}function fxt(t,e,n){var r=t[t.l++],i=t.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:pxt(t);return[i,(s[0]===0?zbe:hwt)[s[1]]]}function pxt(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function mxt(t,e,n){t.l+=n&&n.biff==2?3:4}function gxt(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function yxt(t){return t.l++,jI[t.read_shift(1)]}function vxt(t){return t.l++,t.read_shift(2)}function _xt(t){return t.l++,t.read_shift(1)!==0}function xxt(t){return t.l++,mb(t)}function wxt(t,e,n){return t.l++,xbe(t,e-1,n)}function bxt(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=hvt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=jI[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=mb(t);break;case 2:n[1]=mvt(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Ext(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?mv:vvt)(t));return i}function Sxt(t,e,n){var r=0,i=0;n.biff==12?(r=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=bxt(t,n.biff);return o}function Txt(t,e,n){var r=t.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=t.read_shift(i);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,s]}function kxt(t,e,n){if(n.biff==5)return Axt(t);var r=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[r,i,s]}function Axt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function Ixt(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function Rxt(t,e,n){var r=t.read_shift(1)>>>5&3,i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function Pxt(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function Cxt(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[r,i]}var Mxt=Cd,Nxt=Cd,Oxt=Cd;function FI(t,e,n){return t.l+=2,[q_t(t)]}function BH(t){return t.l+=6,[]}var Lxt=FI,Dxt=BH,$xt=BH,jxt=FI;function Fbe(t){return t.l+=2,[vbe(t),t.read_shift(2)&1]}var Fxt=FI,Vxt=Fbe,zxt=BH,Uxt=FI,Gxt=FI,Bxt=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Wxt(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=Bxt[n>>2&31];return{ixti:e,coltype:n&3,rt:o,idx:r,c:i,C:s}}function Hxt(t){return t.l+=2,[t.read_shift(4)]}function qxt(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function Kxt(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function Yxt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function Xxt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function Zxt(t){return t.l+=4,[0,0]}var _oe={1:{n:"PtgExp",f:gxt},2:{n:"PtgTbl",f:Oxt},3:{n:"PtgAdd",f:ps},4:{n:"PtgSub",f:ps},5:{n:"PtgMul",f:ps},6:{n:"PtgDiv",f:ps},7:{n:"PtgPower",f:ps},8:{n:"PtgConcat",f:ps},9:{n:"PtgLt",f:ps},10:{n:"PtgLe",f:ps},11:{n:"PtgEq",f:ps},12:{n:"PtgGe",f:ps},13:{n:"PtgGt",f:ps},14:{n:"PtgNe",f:ps},15:{n:"PtgIsect",f:ps},16:{n:"PtgUnion",f:ps},17:{n:"PtgRange",f:ps},18:{n:"PtgUplus",f:ps},19:{n:"PtgUminus",f:ps},20:{n:"PtgPercent",f:ps},21:{n:"PtgParen",f:ps},22:{n:"PtgMissArg",f:ps},23:{n:"PtgStr",f:wxt},26:{n:"PtgSheet",f:qxt},27:{n:"PtgEndSheet",f:Kxt},28:{n:"PtgErr",f:yxt},29:{n:"PtgBool",f:_xt},30:{n:"PtgInt",f:vxt},31:{n:"PtgNum",f:xxt},32:{n:"PtgArray",f:txt},33:{n:"PtgFunc",f:dxt},34:{n:"PtgFuncVar",f:fxt},35:{n:"PtgName",f:Txt},36:{n:"PtgRef",f:cxt},37:{n:"PtgArea",f:X_t},38:{n:"PtgMemArea",f:Ixt},39:{n:"PtgMemErr",f:Mxt},40:{n:"PtgMemNoMem",f:Nxt},41:{n:"PtgMemFunc",f:Rxt},42:{n:"PtgRefErr",f:Pxt},43:{n:"PtgAreaErr",f:J_t},44:{n:"PtgRefN",f:uxt},45:{n:"PtgAreaN",f:ext},46:{n:"PtgMemAreaN",f:Yxt},47:{n:"PtgMemNoMemN",f:Xxt},57:{n:"PtgNameX",f:kxt},58:{n:"PtgRef3d",f:hxt},59:{n:"PtgArea3d",f:Z_t},60:{n:"PtgRefErr3d",f:Cxt},61:{n:"PtgAreaErr3d",f:Q_t},255:{}},Jxt={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Qxt={1:{n:"PtgElfLel",f:Fbe},2:{n:"PtgElfRw",f:Uxt},3:{n:"PtgElfCol",f:Lxt},6:{n:"PtgElfRwV",f:Gxt},7:{n:"PtgElfColV",f:jxt},10:{n:"PtgElfRadical",f:Fxt},11:{n:"PtgElfRadicalS",f:zxt},13:{n:"PtgElfColS",f:Dxt},15:{n:"PtgElfColSV",f:$xt},16:{n:"PtgElfRadicalLel",f:Vxt},25:{n:"PtgList",f:Wxt},29:{n:"PtgSxName",f:Hxt},255:{}},ewt={0:{n:"PtgAttrNoop",f:Zxt},1:{n:"PtgAttrSemi",f:oxt},2:{n:"PtgAttrIf",f:ixt},4:{n:"PtgAttrChoose",f:nxt},8:{n:"PtgAttrGoto",f:rxt},16:{n:"PtgAttrSum",f:mxt},32:{n:"PtgAttrBaxcel",f:voe},33:{n:"PtgAttrBaxcel",f:voe},64:{n:"PtgAttrSpace",f:axt},65:{n:"PtgAttrSpaceSemi",f:lxt},128:{n:"PtgAttrIfError",f:sxt},255:{}};function twt(t,e,n,r){if(r.biff<8)return Cd(t,e);for(var i=t.l+e,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=Sxt(t,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=Ext(t,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=t.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return e=i-t.l,e!==0&&s.push(Cd(t,e)),s}function nwt(t,e,n){for(var r=t.l+e,i,s,o=[];r!=t.l;)e=r-t.l,s=t[t.l],i=_oe[s]||_oe[Jxt[s]],(s===24||s===25)&&(i=(s===24?Qxt:ewt)[t[t.l+1]]),!i||!i.f?Cd(t,e):o.push([i.n,i.f(t,e,n)]);return o}function rwt(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var iwt={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function swt(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Vbe(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(t[r[0]][0]){case 357:return i=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[r[0]][0][3]?(i=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function xoe(t,e,n){var r=Vbe(t,e,n);return r=="#REF"?r:swt(r,n)}function R2(t,e,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,h=0,f=0,g,v="";if(!t[0]||!t[0][0])return"";for(var x=-1,b="",T=0,A=t[0].length;T<A;++T){var I=t[0][T];switch(I[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),x>=0){switch(t[0][x][1][0]){case 0:b=Xi(" ",t[0][x][1][1]);break;case 1:b=Xi("\r",t[0][x][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+b,x=-1}a.push(c+iwt[I[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=jT(I[1][1],o,i),a.push(FT(u,s));break;case"PtgRefN":u=n?jT(I[1][1],n,i):I[1][1],a.push(FT(u,s));break;case"PtgRef3d":h=I[1][1],u=jT(I[1][2],o,i),v=xoe(r,h,i),a.push(v+"!"+FT(u,s));break;case"PtgFunc":case"PtgFuncVar":var R=I[1][0],M=I[1][1];R||(R=0),R&=127;var F=R==0?[]:a.slice(-R);a.length-=R,M==="User"&&(M=F.shift()),a.push(M+"("+F.join(",")+")");break;case"PtgBool":a.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(I[1]);break;case"PtgNum":a.push(String(I[1]));break;case"PtgStr":a.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(I[1]);break;case"PtgAreaN":g=ioe(I[1][1],n?{s:n}:o,i),a.push(P8(g,i));break;case"PtgArea":g=ioe(I[1][1],o,i),a.push(P8(g,i));break;case"PtgArea3d":h=I[1][1],g=I[1][2],v=xoe(r,h,i),a.push(v+"!"+P8(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=I[1][2];var C=(r.names||[])[f-1]||(r[0]||[])[f],N=C?C.Name:"SH33TJSNAME"+String(f);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),a.push(N);break;case"PtgNameX":var O=I[1][1];f=I[1][2];var j;if(i.biff<=5)O<0&&(O=-O),r[O]&&(j=r[O][f]);else{var V="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][f]&&r[O][f].itab>0&&(V=r.SheetNames[r[O][f].itab-1]+"!"):V=r.SheetNames[f-1]+"!"),r[O]&&r[O][f])V+=r[O][f].Name;else if(r[0]&&r[0][f])V+=r[0][f].Name;else{var W=(Vbe(r,O,i)||"").split(";;");W[f-1]?V=W[f-1]:V+="SH33TJSERRX"}a.push(V);break}j||(j={Name:"SH33TJSERRY"}),a.push(j.Name);break;case"PtgParen":var U="(",pe=")";if(x>=0){switch(b="",t[0][x][1][0]){case 2:U=Xi(" ",t[0][x][1][1])+U;break;case 3:U=Xi("\r",t[0][x][1][1])+U;break;case 4:pe=Xi(" ",t[0][x][1][1])+pe;break;case 5:pe=Xi("\r",t[0][x][1][1])+pe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}a.push(U+a.pop()+pe);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:I[1][1],r:I[1][0]};var Ne={c:n.c,r:n.r};if(r.sharedf[Br(u)]){var Se=r.sharedf[Br(u)];a.push(R2(Se,o,Ne,r,i))}else{var je=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(R2(c[1],o,Ne,r,i)),je=!0;break}je||a.push(I[1])}break;case"PtgArray":a.push("{"+rwt(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&de.indexOf(t[0][T][0])==-1){I=t[0][x];var Oe=!0;switch(I[1][0]){case 4:Oe=!1;case 0:b=Xi(" ",I[1][1]);break;case 5:Oe=!1;case 1:b=Xi("\r",I[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}a.push((Oe?b:"")+a.pop()+(Oe?"":b)),x=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function owt(t){if(t==null){var e=Ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return B1(t);return B1(0)}function awt(t,e,n,r,i){var s=W1(e,n,i),o=owt(t.v),a=Ge(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=Ge(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=Ro([s,o,a,c]);return h}function hL(t,e,n){var r=t.read_shift(4),i=nwt(t,r,n),s=t.read_shift(4),o=s>0?twt(t,s,i,n):null;return[i,o]}var lwt=hL,dL=hL,cwt=hL,uwt=hL,hwt={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zbe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dwt={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fwt(t){var e="of:="+t.replace(UH,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function pwt(t){return t.replace(/\./,"!")}var VT=typeof Map<"u";function WH(t,e,n){var r=0,i=t.length;if(n){if(VT?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var s=VT?n.get(e):n[e];r<s.length;++r)if(t[s[r]].t===e)return t.Count++,s[r]}}else for(;r<i;++r)if(t[r].t===e)return t.Count++,r;return t[i]={t:e},t.Count++,t.Unique++,n&&(VT?(n.has(e)||n.set(e,[]),n.get(e).push(i)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(i))),i}function fL(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(tp=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=jN(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=rz(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function Ube(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function n0(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){$2e(e.z,i),n.ssf[i]=e.z,n.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===r)return i;return t[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function mwt(t,e,n){if(t&&t["!ref"]){var r=pi(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function gwt(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+ks(t[n])+'"/>';return e+"</mergeCells>"}function ywt(t,e,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[n];try{e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=cA(Ur(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),a=(a||"")+yt("outlinePr",null,c)}!s&&!a||(i[i.length]=yt("sheetPr",a,o))}var vwt=["objects","scenarios","selectLockedCells","selectUnlockedCells"],_wt=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xwt(t){var e={sheet:1};return vwt.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),_wt.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=Tbe(t.password).toString(16).toUpperCase()),yt("sheetProtection",null,e)}function wwt(t){return Ube(t),yt("pageMargins",null,t)}function bwt(t,e){for(var n=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(n[n.length]=yt("col",null,fL(i,r)));return n[n.length]="</cols>",n.join("")}function Ewt(t,e,n,r){var i=typeof t.ref=="string"?t.ref:ks(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=pc(i);o.s.r==o.e.r&&(o.e.r=pc(e["!ref"]).e.r,i=ks(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),yt("autoFilter",null,{ref:i})}function Swt(t,e,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),yt("sheetViews",yt("sheetView",null,i),{})}function Twt(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=jI[t.v];break;case"d":r&&r.cellDates?i=Da(t.v,-1).toISOString():(t=Tl(t),t.t="n",i=""+(t.v=Sl(Da(t.v)))),typeof t.z>"u"&&(t.z=es[14]);break;default:i=t.v;break}var a=Po("v",Ur(i)),l={r:e},c=n0(r.cellXfs,t,r);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Po("v",""+WH(r.Strings,t.v,r.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=yt("f",Ur(t.f),u)+(t.v!=null?a:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(l.cm=1),yt("c",a,l)}function kwt(t,e,n,r){var i=[],s=[],o=pi(t["!ref"]),a="",l,c="",u=[],h=0,f=0,g=t["!rows"],v=Array.isArray(t),x={r:c},b,T=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=ma(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=Mo(h),f=o.s.c;f<=o.e.c;++f){l=u[f]+c;var A=v?(t[h]||[])[f]:t[l];A!==void 0&&(a=Twt(A,l,t,e))!=null&&s.push(a)}(s.length>0||g&&g[h])&&(x={r:c},g&&g[h]&&(b=g[h],b.hidden&&(x.hidden=1),T=-1,b.hpx?T=FN(b.hpx):b.hpt&&(T=b.hpt),T>-1&&(x.ht=T,x.customHeight=1),b.level&&(x.outlineLevel=b.level)),i[i.length]=yt("row",s.join(""),x))}if(g)for(;h<g.length;++h)g&&g[h]&&(x={r:h+1},b=g[h],b.hidden&&(x.hidden=1),T=-1,b.hpx?T=FN(b.hpx):b.hpt&&(T=b.hpt),T>-1&&(x.ht=T,x.customHeight=1),b.level&&(x.outlineLevel=b.level),i[i.length]=yt("row","",x));return i.join("")}function Gbe(t,e,n,r){var i=[Is,yt("worksheet",null,{xmlns:db[0],"xmlns:r":so.r})],s=n.SheetNames[t],o=0,a="",l=n.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=pi(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=ks(u)}r||(r={}),l["!comments"]=[];var h=[];ywt(l,n,t,e,i),i[i.length]=yt("dimension",null,{ref:c}),i[i.length]=Swt(l,e,t,n),e.sheetFormat&&(i[i.length]=yt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=bwt(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=kwt(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=xwt(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Ewt(l["!autofilter"],l,n,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=gwt(l["!merges"]));var f=-1,g,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Fr(r,-1,Ur(x[1].Target).replace(/#.*$/,""),mr.HLINK),g["r:id"]="rId"+v),(f=x[1].Target.indexOf("#"))>-1&&(g.location=Ur(x[1].Target.slice(f+1))),x[1].Tooltip&&(g.tooltip=Ur(x[1].Tooltip)),i[i.length]=yt("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=wwt(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Po("ignoredErrors",yt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(v=Fr(r,-1,"../drawings/drawing"+(t+1)+".xml",mr.DRAW),i[i.length]=yt("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=h),l["!comments"].length>0&&(v=Fr(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",mr.VML),i[i.length]=yt("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Awt(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function Iwt(t,e,n){var r=Ge(145),i=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var s=320;i.hpx?s=FN(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,f=-1,g=u<<10;g<u+1<<10;++g){c.c=g;var v=Array.isArray(n)?(n[c.r]||[])[c.c]:n[Br(c)];v&&(h<0&&(h=g),f=g)}h<0||(++a,r.write_shift(4,h),r.write_shift(4,f))}var x=r.l;return r.l=l,r.write_shift(4,a),r.l=x,r.length>r.l?r.slice(0,r.l):r}function Rwt(t,e,n,r){var i=Iwt(r,n,e);(i.length>17||(e["!rows"]||[])[r])&&tt(t,0,i)}var Pwt=mv,Cwt=pb;function Mwt(){}function Nwt(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=G1t(t),n}function Owt(t,e,n){n==null&&(n=Ge(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return LN({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),ibe(t,n),n.slice(0,n.l)}function Lwt(t){var e=fu(t);return[e]}function Dwt(t,e,n){return n==null&&(n=Ge(8)),dv(e,n)}function $wt(t){var e=fv(t);return[e]}function jwt(t,e,n){return n==null&&(n=Ge(4)),pv(e,n)}function Fwt(t){var e=fu(t),n=t.read_shift(1);return[e,n,"b"]}function Vwt(t,e,n){return n==null&&(n=Ge(9)),dv(e,n),n.write_shift(1,t.v?1:0),n}function zwt(t){var e=fv(t),n=t.read_shift(1);return[e,n,"b"]}function Uwt(t,e,n){return n==null&&(n=Ge(5)),pv(e,n),n.write_shift(1,t.v?1:0),n}function Gwt(t){var e=fu(t),n=t.read_shift(1);return[e,n,"e"]}function Bwt(t,e,n){return n==null&&(n=Ge(9)),dv(e,n),n.write_shift(1,t.v),n}function Wwt(t){var e=fv(t),n=t.read_shift(1);return[e,n,"e"]}function Hwt(t,e,n){return n==null&&(n=Ge(8)),pv(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function qwt(t){var e=fu(t),n=t.read_shift(4);return[e,n,"s"]}function Kwt(t,e,n){return n==null&&(n=Ge(12)),dv(e,n),n.write_shift(4,e.v),n}function Ywt(t){var e=fv(t),n=t.read_shift(4);return[e,n,"s"]}function Xwt(t,e,n){return n==null&&(n=Ge(8)),pv(e,n),n.write_shift(4,e.v),n}function Zwt(t){var e=fu(t),n=mb(t);return[e,n,"n"]}function Jwt(t,e,n){return n==null&&(n=Ge(16)),dv(e,n),B1(t.v,n),n}function Qwt(t){var e=fv(t),n=mb(t);return[e,n,"n"]}function e2t(t,e,n){return n==null&&(n=Ge(12)),pv(e,n),B1(t.v,n),n}function t2t(t){var e=fu(t),n=sbe(t);return[e,n,"n"]}function n2t(t,e,n){return n==null&&(n=Ge(12)),dv(e,n),obe(t.v,n),n}function r2t(t){var e=fv(t),n=sbe(t);return[e,n,"n"]}function i2t(t,e,n){return n==null&&(n=Ge(8)),pv(e,n),obe(t.v,n),n}function s2t(t){var e=fu(t),n=$H(t);return[e,n,"is"]}function o2t(t){var e=fu(t),n=ga(t);return[e,n,"str"]}function a2t(t,e,n){return n==null&&(n=Ge(12+4*t.v.length)),dv(e,n),lo(t.v,n),n.length>n.l?n.slice(0,n.l):n}function l2t(t){var e=fv(t),n=ga(t);return[e,n,"str"]}function c2t(t,e,n){return n==null&&(n=Ge(8+4*t.v.length)),pv(e,n),lo(t.v,n),n.length>n.l?n.slice(0,n.l):n}function u2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(n.cellFormula){t.l+=2;var a=dL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}function h2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(n.cellFormula){t.l+=2;var a=dL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}function d2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=mb(t),o=[i,s,"n"];if(n.cellFormula){t.l+=2;var a=dL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}function f2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=ga(t),o=[i,s,"str"];if(n.cellFormula){t.l+=2;var a=dL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}var p2t=mv,m2t=pb;function g2t(t,e){return e==null&&(e=Ge(4)),e.write_shift(4,t),e}function y2t(t,e){var n=t.l+e,r=mv(t),i=jH(t),s=ga(t),o=ga(t),a=ga(t);t.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function v2t(t,e){var n=Ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));pb({s:ao(t[0]),e:ao(t[0])},n),FH("rId"+e,n);var r=t[1].Target.indexOf("#"),i=r==-1?"":t[1].Target.slice(r+1);return lo(i||"",n),lo(t[1].Tooltip||"",n),lo("",n),n.slice(0,n.l)}function _2t(){}function x2t(t,e,n){var r=t.l+e,i=abe(t),s=t.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=lwt(t,r-t.l,n);o[1]=a}else t.l=r;return o}function w2t(t,e,n){var r=t.l+e,i=mv(t),s=[i];if(n.cellFormula){var o=uwt(t,r-t.l,n);s[1]=o,t.l=r}else t.l=r;return s}function b2t(t,e,n){n==null&&(n=Ge(18));var r=fL(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),n.write_shift(2,i),n}var Bbe=["left","right","top","bottom","header","footer"];function E2t(t){var e={};return Bbe.forEach(function(n){e[n]=mb(t)}),e}function S2t(t,e){return e==null&&(e=Ge(48)),Ube(t),Bbe.forEach(function(n){B1(t[n],e)}),e}function T2t(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function k2t(t,e,n){n==null&&(n=Ge(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function A2t(t){var e=Ge(24);return e.write_shift(4,4),e.write_shift(4,1),pb(t,e),e}function I2t(t,e){return e==null&&(e=Ge(66)),e.write_shift(2,t.password?Tbe(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function R2t(){}function P2t(){}function C2t(t,e,n,r,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Tl(e),e.z=e.z||es[14],e.v=Sl(Da(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:n,c:r};switch(l.s=n0(i.cellXfs,e,i),e.l&&s["!links"].push([Br(l),e.l]),e.c&&s["!comments"].push([Br(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=WH(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?tt(t,18,Xwt(e,l)):tt(t,7,Kwt(e,l))):(l.t="str",o?tt(t,17,c2t(e,l)):tt(t,6,a2t(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?tt(t,13,i2t(e,l)):tt(t,2,n2t(e,l)):o?tt(t,16,e2t(e,l)):tt(t,5,Jwt(e,l)),!0;case"b":return l.t="b",o?tt(t,15,Uwt(e,l)):tt(t,4,Vwt(e,l)),!0;case"e":return l.t="e",o?tt(t,14,Hwt(e,l)):tt(t,3,Bwt(e,l)),!0}return o?tt(t,12,jwt(e,l)):tt(t,1,Dwt(e,l)),!0}function M2t(t,e,n,r){var i=pi(e["!ref"]||"A1"),s,o="",a=[];tt(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Mo(u),Rwt(t,e,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(a[f]=ma(f)),s=a[f]+o;var g=l?(e[u]||[])[f]:e[s];if(!g){h=!1;continue}h=C2t(t,g,u,f,r,e,h)}}tt(t,146)}function N2t(t,e){!e||!e["!merges"]||(tt(t,177,g2t(e["!merges"].length)),e["!merges"].forEach(function(n){tt(t,176,m2t(n))}),tt(t,178))}function O2t(t,e){!e||!e["!cols"]||(tt(t,390),e["!cols"].forEach(function(n,r){n&&tt(t,60,b2t(r,n))}),tt(t,391))}function L2t(t,e){!e||!e["!ref"]||(tt(t,648),tt(t,649,A2t(pi(e["!ref"]))),tt(t,650))}function D2t(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var i=Fr(n,-1,r[1].Target.replace(/#.*$/,""),mr.HLINK);tt(t,494,v2t(r,i))}}),delete e["!links"]}function $2t(t,e,n,r){if(e["!comments"].length>0){var i=Fr(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",mr.VML);tt(t,551,FH("rId"+i)),e["!legacy"]=i}}function j2t(t,e,n,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ks(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=pc(s);a.s.r==a.e.r&&(a.e.r=pc(e["!ref"]).e.r,s=ks(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),tt(t,161,pb(pi(s))),tt(t,162)}}function F2t(t,e,n){tt(t,133),tt(t,137,k2t(e,n)),tt(t,138),tt(t,134)}function V2t(t,e){e["!protect"]&&tt(t,535,I2t(e["!protect"]))}function z2t(t,e,n,r){var i=xl(),s=n.SheetNames[t],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[t].CodeName||a)}catch{}var l=pi(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],tt(i,129),(n.vbaraw||o["!outline"])&&tt(i,147,Owt(a,o["!outline"])),tt(i,148,Cwt(l)),F2t(i,o,n.Workbook),O2t(i,o),M2t(i,o,t,e),V2t(i,o),j2t(i,o,n,t),N2t(i,o),D2t(i,o,r),o["!margins"]&&tt(i,476,S2t(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&L2t(i,o),$2t(i,o,t,r),tt(i,130),i.end()}function U2t(t,e){t.l+=10;var n=ga(t);return{name:n}}var G2t=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function B2t(t){return!t.Workbook||!t.Workbook.WBProps?"false":w1t(t.Workbook.WBProps.date1904)?"true":"false"}var W2t="][*?/\\".split("");function Wbe(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return W2t.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function H2t(t,e,n){t.forEach(function(r,i){Wbe(r);for(var s=0;s<i;++s)if(r==t[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=e&&e[i]&&e[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function q2t(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];H2t(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)mwt(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}function Hbe(t){var e=[Is];e[e.length]=yt("workbook",null,{xmlns:db[0],"xmlns:r":so.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(G2t.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=yt("workbookPr",null,r);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:Ur(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=yt("sheet",null,o)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=yt("definedName",Ur(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function K2t(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=nz(t),n.name=ga(t),n}function Y2t(t,e){return e||(e=Ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),FH(t.strRelID,e),lo(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function X2t(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var i=e>8?ga(t):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function Z2t(t,e){e||(e=Ge(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),ibe(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function J2t(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=B1t(t),o=cwt(t,0,n),a=jH(t);t.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function Q2t(t,e){tt(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};tt(t,156,Y2t(i))}tt(t,144)}function ebt(t,e){e||(e=Ge(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return lo("SheetJS",e),lo(AN.version,e),lo(AN.version,e),lo("7262",e),e.length>e.l?e.slice(0,e.l):e}function tbt(t,e){e||(e=Ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function nbt(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(tt(t,135),tt(t,158,tbt(i)),tt(t,136))}}function rbt(t,e){var n=xl();return tt(n,131),tt(n,128,ebt()),tt(n,153,Z2t(t.Workbook&&t.Workbook.WBProps||null)),nbt(n,t),Q2t(n,t),tt(n,132),n.end()}function ibt(t,e,n){return(e.slice(-4)===".bin"?rbt:Hbe)(t)}function sbt(t,e,n,r,i){return(e.slice(-4)===".bin"?z2t:Gbe)(t,n,r,i)}function obt(t,e,n){return(e.slice(-4)===".bin"?S_t:Ibe)(t,n)}function abt(t,e,n){return(e.slice(-4)===".bin"?Zvt:Sbe)(t,n)}function lbt(t,e,n){return(e.slice(-4)===".bin"?V_t:Nbe)(t)}function cbt(t){return(t.slice(-4)===".bin"?M_t:Cbe)()}function ubt(t,e){var n=[];return t.Props&&n.push(ovt(t.Props,e)),t.Custprops&&n.push(avt(t.Props,t.Custprops)),n.join("")}function hbt(){return""}function dbt(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(yt("NumberFormat",null,{"ss:Format":Ur(es[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(yt("Style",s.join(""),o))}),yt("Styles",n.join(""))}function qbe(t){return yt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+GH(t.Ref,{r:0,c:0})})}function fbt(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(qbe(i)))}return yt("Names",n.join(""))}function pbt(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(qbe(a)))}return s.join("")}function mbt(t,e,n,r){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(yt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(yt("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(yt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(yt("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Po("ProtectContents","True")),t["!protect"].objects&&i.push(Po("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Po("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Po("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Po("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":yt("WorksheetOptions",i.join(""),{xmlns:Jl.x})}function gbt(t){return t.map(function(e){var n=x1t(e.t||""),r=yt("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return yt("Comment",r,{"ss:Author":e.a})}).join("")}function ybt(t,e,n,r,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+Ur(GH(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=ao(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=Ur(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=Ur(t.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=jI[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||es[14]);break;case"s":h="String",f=_1t(t.v||"");break}var g=n0(r.cellXfs,t,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var v=t.v!=null?f:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(t.c||[]).length>0&&(x+=gbt(t.c)),yt("Cell",x,a)}function vbt(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Abe(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function _bt(t,e,n,r){if(!t["!ref"])return"";var i=pi(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(b,T){zH(b);var A=!!b.width,I=fL(T,b),R={"ss:Index":T+1};A&&(R["ss:Width"]=$N(I.width)),b.hidden&&(R["ss:Hidden"]="1"),a.push(yt("Column",null,R))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[vbt(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(f=!0);break}if(!f){var g={r:c,c:h},v=Br(g),x=l?(t[c]||[])[h]:t[v];u.push(ybt(x,v,t,e,n,r,g))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function xbt(t,e,n){var r=[],i=n.SheetNames[t],s=n.Sheets[i],o=s?pbt(s,e,t,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?_bt(s,e,t,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(mbt(s,e,t,n)),r.join("")}function wbt(t,e){e||(e={}),t.SSF||(t.SSF=Tl(es)),t.SSF&&(lL(),aL(t.SSF),e.revssf=cL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],n0(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(ubt(t,e)),n.push(hbt()),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(yt("Worksheet",xbt(r,e,t),{"ss:Name":Ur(t.SheetNames[r])}));return n[2]=dbt(t,e),n[3]=fbt(t),Is+yt("Workbook",n.join(""),{xmlns:Jl.ss,"xmlns:o":Jl.o,"xmlns:x":Jl.x,"xmlns:ss":Jl.ss,"xmlns:dt":Jl.dt,"xmlns:html":Jl.html})}var N8={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bbt(t,e){var n=[],r=[],i=[],s=0,o,a=qse(ooe,"n"),l=qse(aoe,"n");if(t.Props)for(o=No(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=No(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],t.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)ybe.indexOf(i[s][0])>-1||pbe.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&qr.utils.cfb_add(e,"/SummaryInformation",doe(r,N8.SI,l,aoe)),(n.length||c.length)&&qr.utils.cfb_add(e,"/DocumentSummaryInformation",doe(n,N8.DSI,a,ooe,c.length?c:null,N8.UDI))}function Ebt(t,e){var n=e||{},r=qr.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return qr.utils.cfb_add(r,i,Kbe(t,n)),n.biff==8&&(t.Props||t.Custprops)&&bbt(t,r),n.biff==8&&t.vbaraw&&z_t(r,qr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var Sbt={0:{f:Awt},1:{f:Lwt},2:{f:t2t},3:{f:Gwt},4:{f:Fwt},5:{f:Zwt},6:{f:o2t},7:{f:qwt},8:{f:f2t},9:{f:d2t},10:{f:u2t},11:{f:h2t},12:{f:$wt},13:{f:r2t},14:{f:Wwt},15:{f:zwt},16:{f:Qwt},17:{f:l2t},18:{f:Ywt},19:{f:$H},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:J2t},40:{},42:{},43:{f:o_t},44:{f:i_t},45:{f:c_t},46:{f:h_t},47:{f:u_t},48:{},49:{f:$1t},50:{},51:{f:A_t},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jvt},62:{f:s2t},63:{f:N_t},64:{f:R2t},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cd,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:T2t},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Nwt},148:{f:Pwt,p:16},151:{f:_2t},152:{},153:{f:X2t},154:{},155:{},156:{f:K2t},157:{},158:{},159:{T:1,f:Kvt},160:{T:-1},161:{T:1,f:mv},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:p2t},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:T_t},336:{T:-1},337:{f:P_t,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nz},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Mvt},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:x2t},427:{f:w2t},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:E2t},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Mwt},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:y2t},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nz},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:j_t},633:{T:1},634:{T:-1},635:{T:1,f:D_t},636:{T:-1},637:{f:z1t},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:U2t},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:P2t},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function vt(t,e,n,r){var i=e;if(!isNaN(i)){var s=r||(n||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&OH(n)&&t.push(n)}}function Tbt(t,e,n,r){var i=(n||[]).length||0;if(i<=8224)return vt(t,e,n,i);var s=e;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c}}}function VI(t,e,n){return t||(t=Ge(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function kbt(t,e,n,r){var i=Ge(9);return VI(i,t,e),_be(n,r||"b",i),i}function Abt(t,e,n){var r=Ge(8+2*n.length);return VI(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function Ibt(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Sl(Da(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?vt(t,2,Uvt(n,r,i)):vt(t,3,zvt(n,r,i));return;case"b":case"e":vt(t,5,kbt(n,r,e.v,e.t));return;case"s":case"str":vt(t,4,Abt(n,r,(e.v||"").slice(0,255)));return}vt(t,1,VI(null,n,r))}function Rbt(t,e,n,r){var i=Array.isArray(e),s=pi(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=ks(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Mo(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=ma(u)),o=l[u]+a;var h=i?(e[c]||[])[u]:e[o];h&&Ibt(t,h,c,u)}}}function Pbt(t,e){for(var n=e||{},r=xl(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return vt(r,n.biff==4?1033:n.biff==3?521:9,VH(t,16,n)),Rbt(r,t.Sheets[t.SheetNames[i]],i,n),vt(r,10),r.end()}function Cbt(t,e,n){vt(t,49,Svt({sz:12,name:"Arial"},n))}function Mbt(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&vt(t,1054,Avt(i,e[i],n))})}function Nbt(t,e){var n=Ge(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),vt(t,2151,n),n=Ge(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),bbe(pi(e["!ref"]||"A1"),n),n.write_shift(4,4),vt(t,2152,n)}function Obt(t,e){for(var n=0;n<16;++n)vt(t,224,poe({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){vt(t,224,poe(r,0,e))})}function Lbt(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];vt(t,440,Lvt(r)),r[1].Tooltip&&vt(t,2048,Dvt(r))}delete e["!links"]}function Dbt(t,e){if(e){var n=0;e.forEach(function(r,i){++n<=256&&r&&vt(t,125,Fvt(fL(i,r),i))})}}function $bt(t,e,n,r,i){var s=16+n0(i.cellXfs,e,i);if(e.v==null&&!e.bf){vt(t,513,W1(n,r,s));return}if(e.bf)vt(t,6,awt(e,n,r,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Sl(Da(e.v)):e.v;vt(t,515,Cvt(n,r,o,s));break;case"b":case"e":vt(t,517,Pvt(n,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=WH(i.Strings,e.v,i.revStrings);vt(t,253,Tvt(n,r,a,s))}else vt(t,516,kvt(n,r,(e.v||"").slice(0,255),s,i));break;default:vt(t,513,W1(n,r,s))}}function jbt(t,e,n){var r=xl(),i=n.SheetNames[t],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,u,h="",f=[],g=pi(s["!ref"]||"A1"),v=c?65536:16384;if(g.e.c>255||g.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}vt(r,2057,VH(n,16,e)),vt(r,13,Fc(1)),vt(r,12,Fc(100)),vt(r,15,ka(!0)),vt(r,17,ka(!1)),vt(r,16,B1(.001)),vt(r,95,ka(!0)),vt(r,42,ka(!1)),vt(r,43,ka(!1)),vt(r,130,Fc(1)),vt(r,128,Rvt()),vt(r,131,ka(!1)),vt(r,132,ka(!1)),c&&Dbt(r,s["!cols"]),vt(r,512,Ivt(g,e)),c&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){h=Mo(x);for(var b=g.s.c;b<=g.e.c;++b){x===g.s.r&&(f[b]=ma(b)),u=f[b]+h;var T=l?(s[x]||[])[b]:s[u];T&&($bt(r,T,x,b,e),c&&T.l&&s["!links"].push([u,T.l]))}}var A=a.CodeName||a.name||i;return c&&vt(r,574,Evt((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&vt(r,229,Ovt(s["!merges"])),c&&Lbt(r,s),vt(r,442,wbe(A)),c&&Nbt(r,s),vt(r,10),r.end()}function Fbt(t,e,n){var r=xl(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(vt(r,2057,VH(t,5,n)),n.bookType=="xla"&&vt(r,135),vt(r,225,a?Fc(1200):null),vt(r,193,uvt(2)),l&&vt(r,191),l&&vt(r,192),vt(r,226),vt(r,92,_vt("SheetJS",n)),vt(r,66,Fc(a?1200:1252)),a&&vt(r,353,Fc(0)),a&&vt(r,448),vt(r,317,Vvt(t.SheetNames.length)),a&&t.vbaraw&&vt(r,211),a&&t.vbaraw){var c=o.CodeName||"ThisWorkbook";vt(r,442,wbe(c))}vt(r,156,Fc(17)),vt(r,25,ka(!1)),vt(r,18,ka(!1)),vt(r,19,Fc(0)),a&&vt(r,431,ka(!1)),a&&vt(r,444,Fc(0)),vt(r,61,bvt()),vt(r,64,ka(!1)),vt(r,141,Fc(0)),vt(r,34,ka(B2t(t)=="true")),vt(r,14,ka(!0)),a&&vt(r,439,ka(!1)),vt(r,218,Fc(0)),Cbt(r,t,n),Mbt(r,t.SSF,n),Obt(r,n),a&&vt(r,352,ka(!1));var u=r.end(),h=xl();a&&vt(h,140,$vt()),a&&n.Strings&&Tbt(h,252,wvt(n.Strings)),vt(h,10);var f=h.end(),g=xl(),v=0,x=0;for(x=0;x<t.SheetNames.length;++x)v+=(a?12:11)+(a?2:1)*t.SheetNames[x].length;var b=u.length+v+f.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};vt(g,133,xvt({pos:b,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},n)),b+=e[x].length}var A=g.end();if(v!=A.length)throw new Error("BS8 "+v+" != "+A.length);var I=[];return u.length&&I.push(u),A.length&&I.push(A),f.length&&I.push(f),Ro(I)}function Vbt(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=Tl(es)),t&&t.SSF&&(lL(),aL(t.SSF),n.revssf=cL(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,HH(n),n.cellXfs=[],n0(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)r[r.length]=jbt(i,n,t);return r.unshift(Fbt(t,r,n)),Ro(r)}function Kbe(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var i=pc(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Vbt(t,e);case 4:case 3:case 2:return Pbt(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function zbt(t,e,n,r){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>o)&&!(i[c].e.r<n||i[c].e.c<o)){if(i[c].s.r<n||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=Br({r:n,c:o}),h=r.dense?(t[n]||[])[o]:t[u],f=h&&h.v!=null&&(h.h||v1t(h.w||(fp(h),h.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),g.id=(r.id||"sjs")+"-"+u,s.push(yt("td",f,g))}}var v="<tr>";return v+s.join("")+"</tr>"}var Ubt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Gbt="</body></html>";function Bbt(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Ybe(t,e){var n=e||{},r=n.header!=null?n.header:Ubt,i=n.footer!=null?n.footer:Gbt,s=[r],o=pc(t["!ref"]);n.dense=Array.isArray(t),s.push(Bbt(t,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push(zbt(t,o,a,n));return s.push("</table>"+i),s.join("")}function Xbe(t,e,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?ao(r.origin):r.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=pc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],f=0,g=t["!rows"]||(t["!rows"]=[]),v=0,x=0,b=0,T=0,A=0,I=0;for(t["!cols"]||(t["!cols"]=[]);v<a.length&&x<l;++v){var R=a[v];if(woe(R)){if(r.display)continue;g[x]={hidden:!0}}var M=R.children;for(b=T=0;b<M.length;++b){var F=M[b];if(!(r.display&&woe(F))){var C=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):b1t(F.innerHTML),N=F.getAttribute("data-z")||F.getAttribute("z");for(f=0;f<h.length;++f){var O=h[f];O.s.c==T+s&&O.s.r<x+i&&x+i<=O.e.r&&(T=O.e.c+1-s,f=-1)}I=+F.getAttribute("colspan")||1,((A=+F.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(A||1)-1,c:T+s+(I||1)-1}});var j={t:"s",v:C},V=F.getAttribute("data-t")||F.getAttribute("t")||"";C!=null&&(C.length==0?j.t=V||"z":r.raw||C.trim().length==0||V=="s"||(C==="TRUE"?j={t:"b",v:!0}:C==="FALSE"?j={t:"b",v:!1}:isNaN(ep(C))?isNaN(lA(C).getDate())||(j={t:"d",v:Da(C)},r.cellDates||(j={t:"n",v:Sl(j.v)}),j.z=r.dateNF||es[14]):j={t:"n",v:ep(C)})),j.z===void 0&&N!=null&&(j.z=N);var W="",U=F.getElementsByTagName("A");if(U&&U.length)for(var pe=0;pe<U.length&&!(U[pe].hasAttribute("href")&&(W=U[pe].getAttribute("href"),W.charAt(0)!="#"));++pe);W&&W.charAt(0)!="#"&&(j.l={Target:W}),r.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=j):t[Br({c:T+s,r:x+i})]=j,c.e.c<T+s&&(c.e.c=T+s),T+=I}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=ks(c),x>=l&&(t["!fullref"]=ks((c.e.r=a.length-v+x-1+i,c))),t}function Zbe(t,e){var n=e||{},r=n.dense?[]:{};return Xbe(r,t,e)}function Wbt(t,e){return hv(Zbe(t,e),e)}function woe(t){var e="",n=Hbt(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Hbt(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var qbt=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+uA({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Is+e}})(),boe=(function(){var t=function(s){return Ur(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Ur(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=pc(s["!ref"]||"A1"),f=s["!merges"]||[],g=0,v=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",b=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=b[c]?' table:style-name="ro'+b[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=b[c]?' table:style-name="ro'+b[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var T=!1,A={},I="";for(g=0;g!=f.length;++g)if(!(f[g].s.c>u)&&!(f[g].s.r>c)&&!(f[g].e.c<u)&&!(f[g].e.r<c)){(f[g].s.c!=u||f[g].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=f[g].e.c-f[g].s.c+1,A["table:number-rows-spanned"]=f[g].e.r-f[g].s.r+1;break}if(T){l.push(n);continue}var R=Br({r:c,c:u}),M=v?(s[c]||[])[u]:s[R];if(M&&M.f&&(A["table:formula"]=Ur(fwt(M.f)),M.F&&M.F.slice(0,R.length)==R)){var F=pc(M.F);A["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,A["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!M){l.push(e);continue}switch(M.t){case"b":I=M.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=M.v?"true":"false";break;case"n":I=M.w||String(M.v||0),A["office:value-type"]="float",A["office:value"]=M.v||0;break;case"s":case"str":I=M.v==null?"":M.v,A["office:value-type"]="string";break;case"d":I=M.w||Da(M.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Da(M.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var C=t(I);if(M.l&&M.l.Target){var N=M.l.Target;N=N.charAt(0)=="#"?"#"+pwt(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),C=yt("text:a",C,{"xlink:href":N.replace(/&/g,"&amp;")})}l.push("          "+yt("table:table-cell",yt("text:p",C,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;zH(h),h.ods=a;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Is],c=uA({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=uA({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(dbe().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(r(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function Jbe(t,e){if(e.bookType=="fods")return boe(t,e);var n=PH(),r="",i=[],s=[];return r="mimetype",Fn(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Fn(n,r,boe(t,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Fn(n,r,qbt(t,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Fn(n,r,Is+dbe()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Fn(n,r,svt(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Fn(n,r,rvt(i)),n}function VN(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Kbt(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ku(cA(t))}function Ybt(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function Hg(t){var e=t.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(i){n.set(i,r),r+=i.length}),n}function Xbt(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=n>=0?0:128}function hA(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function jr(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function fw(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function Os(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],i=hA(t,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];t[n[0]++]>=128;);a=t.slice(l,n[0])}break;case 5:o=4,a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=hA(t,n),a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function xo(t){var e=[];return t.forEach(function(n,r){n.forEach(function(i){i.data&&(e.push(jr(r*8+i.type)),i.type==2&&e.push(jr(i.data.length)),e.push(i.data))})}),Hg(e)}function Mu(t){for(var e,n=[],r=[0];r[0]<t.length;){var i=hA(t,r),s=Os(t.slice(r[0],r[0]+i));r[0]+=i;var o={id:fw(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Os(a.data),c=fw(l[3][0].data);o.messages.push({meta:l,data:t.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=fw(s[3][0].data)>>>0>0),n.push(o)}return n}function T_(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:jr(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:jr(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:jr(o.data.length)}],r[2].push({data:xo(o.meta),type:2})});var s=xo(r);e.push(jr(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),Hg(e)}function Zbt(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=hA(e,n),i=[];n[0]<e.length;){var s=e[n[0]]&3;if(s==0){var o=e[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[n[0]],a>1&&(o|=e[n[0]+1]<<8),a>2&&(o|=e[n[0]+2]<<16),a>3&&(o|=e[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(e.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[n[0]]>>2&7)+4,l=(e[n[0]++]&224)<<3,l|=e[n[0]++]):(c=(e[n[0]++]>>2)+1,s==2?(l=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(l=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),i=[Hg(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Hg(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Nu(t){for(var e=[],n=0;n<t.length;){var r=t[n++],i=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(Zbt(r,t.slice(n,n+i))),n+=i}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Hg(e)}function k_(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),i=new Uint8Array(4);e.push(i);var s=jr(r),o=s.length;e.push(s),r<=60?(o++,e.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return Hg(e)}function O8(t,e){var n=new Uint8Array(32),r=VN(n),i=12,s=0;switch(n[0]=5,t.t){case"n":n[1]=2,Xbt(n,i,t.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,s,!0),n.slice(0,i)}function L8(t,e){var n=new Uint8Array(32),r=VN(n),i=12,s=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,s,!0),n.slice(0,i)}function hm(t){var e=Os(t);return hA(e[1][0].data)}function Jbt(t,e,n){var r,i,s,o;if(!((r=t[6])!=null&&r[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&fw(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=VN(t[7][0].data),u=0,h=[],f=VN(t[4][0].data),g=0,v=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),f.setUint16(x*2,65535);continue}c.setUint16(x*2,u,!0),f.setUint16(x*2,g,!0);var b,T;switch(typeof e[x]){case"string":b=O8({t:"s",v:e[x]},n),T=L8({t:"s",v:e[x]},n);break;case"number":b=O8({t:"n",v:e[x]},n),T=L8({t:"n",v:e[x]},n);break;case"boolean":b=O8({t:"b",v:e[x]},n),T=L8({t:"b",v:e[x]},n);break;default:throw new Error("Unsupported value "+e[x])}h.push(b),u+=b.length,v.push(T),g+=T.length,++l}for(t[2][0].data=jr(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),f.setUint16(x*2,65535,!0);return t[6][0].data=Hg(h),t[3][0].data=Hg(v),l}function Qbt(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=pc(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ks(r)));var s=zN(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(ne){return ne.forEach(function(ie){typeof ie=="string"&&o.push(ie)})});var a={},l=[],c=qr.read(e.numbers,{type:"base64"});c.FileIndex.map(function(ne,ie){return[ne,c.FullPaths[ie]]}).forEach(function(ne){var ie=ne[0],le=ne[1];if(ie.type==2&&ie.name.match(/\.iwa/)){var ve=ie.content,qe=Nu(ve),Ke=Mu(qe);Ke.forEach(function(Te){l.push(Te.id),a[Te.id]={deps:[],location:le,type:fw(Te.messages[0].meta[1][0].data)}})}}),l.sort(function(ne,ie){return ne-ie});var u=l.filter(function(ne){return ne>1}).map(function(ne){return[ne,jr(ne)]});c.FileIndex.map(function(ne,ie){return[ne,c.FullPaths[ie]]}).forEach(function(ne){var ie=ne[0];if(ne[1],!!ie.name.match(/\.iwa/)){var le=Mu(Nu(ie.content));le.forEach(function(ve){ve.messages.forEach(function(qe){u.forEach(function(Ke){ve.messages.some(function(Te){return fw(Te.meta[1][0].data)!=11006&&Ybt(Te.data,Ke[1])})&&a[Ke[0]].deps.push(ve.id)})})})}});for(var h=qr.find(c,a[1].location),f=Mu(Nu(h.content)),g,v=0;v<f.length;++v){var x=f[v];x.id==1&&(g=x)}var b=hm(Os(g.messages[0].data)[1][0].data);for(h=qr.find(c,a[b].location),f=Mu(Nu(h.content)),v=0;v<f.length;++v)x=f[v],x.id==b&&(g=x);for(b=hm(Os(g.messages[0].data)[2][0].data),h=qr.find(c,a[b].location),f=Mu(Nu(h.content)),v=0;v<f.length;++v)x=f[v],x.id==b&&(g=x);for(b=hm(Os(g.messages[0].data)[2][0].data),h=qr.find(c,a[b].location),f=Mu(Nu(h.content)),v=0;v<f.length;++v)x=f[v],x.id==b&&(g=x);var T=Os(g.messages[0].data);{T[6][0].data=jr(r.e.r+1),T[7][0].data=jr(r.e.c+1);var A=hm(T[46][0].data),I=qr.find(c,a[A].location),R=Mu(Nu(I.content));{for(var M=0;M<R.length&&R[M].id!=A;++M);if(R[M].id!=A)throw"Bad ColumnRowUIDMapArchive";var F=Os(R[M].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var C=0;C<=r.e.c;++C){var N=[];N[1]=N[2]=[{type:0,data:jr(C+420690)}],F[1].push({type:2,data:xo(N)}),F[2].push({type:0,data:jr(C)}),F[3].push({type:0,data:jr(C)})}F[4]=[],F[5]=[],F[6]=[];for(var O=0;O<=r.e.r;++O)N=[],N[1]=N[2]=[{type:0,data:jr(O+726270)}],F[4].push({type:2,data:xo(N)}),F[5].push({type:0,data:jr(O)}),F[6].push({type:0,data:jr(O)});R[M].messages[0].data=xo(F)}I.content=k_(T_(R)),I.size=I.content.length,delete T[46];var j=Os(T[4][0].data);{j[7][0].data=jr(r.e.r+1);var V=Os(j[1][0].data),W=hm(V[2][0].data);I=qr.find(c,a[W].location),R=Mu(Nu(I.content));{if(R[0].id!=W)throw"Bad HeaderStorageBucket";var U=Os(R[0].messages[0].data);for(O=0;O<s.length;++O){var pe=Os(U[2][0].data);pe[1][0].data=jr(O),pe[4][0].data=jr(s[O].length),U[2][O]={type:U[2][0].type,data:xo(pe)}}R[0].messages[0].data=xo(U)}I.content=k_(T_(R)),I.size=I.content.length;var Ne=hm(j[2][0].data);I=qr.find(c,a[Ne].location),R=Mu(Nu(I.content));{if(R[0].id!=Ne)throw"Bad HeaderStorageBucket";for(U=Os(R[0].messages[0].data),C=0;C<=r.e.c;++C)pe=Os(U[2][0].data),pe[1][0].data=jr(C),pe[4][0].data=jr(r.e.r+1),U[2][C]={type:U[2][0].type,data:xo(pe)};R[0].messages[0].data=xo(U)}I.content=k_(T_(R)),I.size=I.content.length;var Se=hm(j[4][0].data);(function(){for(var ne=qr.find(c,a[Se].location),ie=Mu(Nu(ne.content)),le,ve=0;ve<ie.length;++ve){var qe=ie[ve];qe.id==Se&&(le=qe)}var Ke=Os(le.messages[0].data);{Ke[3]=[];var Te=[];o.forEach(function(Ye,sn){Te[1]=[{type:0,data:jr(sn)}],Te[2]=[{type:0,data:jr(1)}],Te[3]=[{type:2,data:Kbt(Ye)}],Ke[3].push({type:2,data:xo(Te)})})}le.messages[0].data=xo(Ke);var we=T_(ie),Dt=k_(we);ne.content=Dt,ne.size=ne.content.length})();var je=Os(j[3][0].data);{var de=je[1][0];delete je[2];var Oe=Os(de.data);{var Ae=hm(Oe[2][0].data);(function(){for(var ne=qr.find(c,a[Ae].location),ie=Mu(Nu(ne.content)),le,ve=0;ve<ie.length;++ve){var qe=ie[ve];qe.id==Ae&&(le=qe)}var Ke=Os(le.messages[0].data);{delete Ke[6],delete je[7];var Te=new Uint8Array(Ke[5][0].data);Ke[5]=[];for(var we=0,Dt=0;Dt<=r.e.r;++Dt){var Ye=Os(Te);we+=Jbt(Ye,s[Dt],o),Ye[1][0].data=jr(Dt),Ke[5].push({data:xo(Ye),type:2})}Ke[1]=[{type:0,data:jr(r.e.c+1)}],Ke[2]=[{type:0,data:jr(r.e.r+1)}],Ke[3]=[{type:0,data:jr(we)}],Ke[4]=[{type:0,data:jr(r.e.r+1)}]}le.messages[0].data=xo(Ke);var sn=T_(ie),$t=k_(sn);ne.content=$t,ne.size=ne.content.length})()}de.data=xo(Oe)}j[3][0].data=xo(je)}T[4][0].data=xo(j)}g.messages[0].data=xo(T);var Q=T_(f),B=k_(Q);return h.content=B,h.size=h.content.length,c}function eEt(t){return function(n){for(var r=0;r!=t.length;++r){var i=t[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function HH(t){eEt([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function tEt(t,e){return e.bookType=="ods"?Jbe(t,e):e.bookType=="numbers"?Qbt(t,e):e.bookType=="xlsb"?nEt(t,e):rEt(t,e)}function nEt(t,e){Nx=1024,t&&!t.SSF&&(t.SSF=Tl(es)),t&&t.SSF&&(lL(),aL(t.SSF),e.revssf=cL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,VT?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=Obe.indexOf(e.bookType)>-1,i=cbe();HH(e=e||{});var s=PH(),o="",a=0;if(e.cellXfs=[],n0(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Fn(s,o,fbe(t.Props,e)),i.coreprops.push(o),Fr(e.rels,2,o,mr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Fn(s,o,mbe(t.Props)),i.extprops.push(o),Fr(e.rels,3,o,mr.EXT_PROPS),t.Custprops!==t.Props&&No(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Fn(s,o,gbe(t.Custprops)),i.custprops.push(o),Fr(e.rels,4,o,mr.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var u={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Fn(s,o,sbt(a-1,o,e,t,u)),i.sheets.push(o),Fr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,mr.WS[0])}if(h){var g=h["!comments"],v=!1,x="";g&&g.length>0&&(x="xl/comments"+a+"."+n,Fn(s,x,lbt(g,x)),i.comments.push(x),Fr(u,-1,"../comments"+a+"."+n,mr.CMNT),v=!0),h["!legacy"]&&v&&Fn(s,"xl/drawings/vmlDrawing"+a+".vml",Mbe(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Fn(s,hbe(o),hw(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+n,Fn(s,o,abt(e.Strings,o,e)),i.strs.push(o),Fr(e.wbrels,-1,"sharedStrings."+n,mr.SST)),o="xl/workbook."+n,Fn(s,o,ibt(t,o)),i.workbooks.push(o),Fr(e.rels,1,o,mr.WB),o="xl/theme/theme1.xml",Fn(s,o,Pbe(t.Themes,e)),i.themes.push(o),Fr(e.wbrels,-1,"theme/theme1.xml",mr.THEME),o="xl/styles."+n,Fn(s,o,obt(t,o,e)),i.styles.push(o),Fr(e.wbrels,-1,"styles."+n,mr.STY),t.vbaraw&&r&&(o="xl/vbaProject.bin",Fn(s,o,t.vbaraw),i.vba.push(o),Fr(e.wbrels,-1,"vbaProject.bin",mr.VBA)),o="xl/metadata."+n,Fn(s,o,cbt(o)),i.metadata.push(o),Fr(e.wbrels,-1,"metadata."+n,mr.XLMETA),Fn(s,"[Content_Types].xml",ube(i,e)),Fn(s,"_rels/.rels",hw(e.rels)),Fn(s,"xl/_rels/workbook."+n+".rels",hw(e.wbrels)),delete e.revssf,delete e.ssf,s}function rEt(t,e){Nx=1024,t&&!t.SSF&&(t.SSF=Tl(es)),t&&t.SSF&&(lL(),aL(t.SSF),e.revssf=cL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,VT?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=Obe.indexOf(e.bookType)>-1,i=cbe();HH(e=e||{});var s=PH(),o="",a=0;if(e.cellXfs=[],n0(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Fn(s,o,fbe(t.Props,e)),i.coreprops.push(o),Fr(e.rels,2,o,mr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Fn(s,o,mbe(t.Props)),i.extprops.push(o),Fr(e.rels,3,o,mr.EXT_PROPS),t.Custprops!==t.Props&&No(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Fn(s,o,gbe(t.Custprops)),i.custprops.push(o),Fr(e.rels,4,o,mr.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},f=t.Sheets[t.SheetNames[a-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Fn(s,o,Gbe(a-1,e,t,h)),i.sheets.push(o),Fr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,mr.WS[0])}if(f){var v=f["!comments"],x=!1,b="";if(v&&v.length>0){var T=!1;v.forEach(function(A){A[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(b="xl/threadedComments/threadedComment"+a+"."+n,Fn(s,b,O_t(v,u,e)),i.threadedcomments.push(b),Fr(h,-1,"../threadedComments/threadedComment"+a+"."+n,mr.TCMNT)),b="xl/comments"+a+"."+n,Fn(s,b,Nbe(v)),i.comments.push(b),Fr(h,-1,"../comments"+a+"."+n,mr.CMNT),x=!0}f["!legacy"]&&x&&Fn(s,"xl/drawings/vmlDrawing"+a+".vml",Mbe(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Fn(s,hbe(o),hw(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+n,Fn(s,o,Sbe(e.Strings,e)),i.strs.push(o),Fr(e.wbrels,-1,"sharedStrings."+n,mr.SST)),o="xl/workbook."+n,Fn(s,o,Hbe(t)),i.workbooks.push(o),Fr(e.rels,1,o,mr.WB),o="xl/theme/theme1.xml",Fn(s,o,Pbe(t.Themes,e)),i.themes.push(o),Fr(e.wbrels,-1,"theme/theme1.xml",mr.THEME),o="xl/styles."+n,Fn(s,o,Ibe(t,e)),i.styles.push(o),Fr(e.wbrels,-1,"styles."+n,mr.STY),t.vbaraw&&r&&(o="xl/vbaProject.bin",Fn(s,o,t.vbaraw),i.vba.push(o),Fr(e.wbrels,-1,"vbaProject.bin",mr.VBA)),o="xl/metadata."+n,Fn(s,o,Cbe()),i.metadata.push(o),Fr(e.wbrels,-1,"metadata."+n,mr.XLMETA),u.length>1&&(o="xl/persons/person.xml",Fn(s,o,L_t(u)),i.people.push(o),Fr(e.wbrels,-1,"persons/person.xml",mr.PEOPLE)),Fn(s,"[Content_Types].xml",ube(i,e)),Fn(s,"_rels/.rels",hw(e.rels)),Fn(s,"xl/_rels/workbook."+n+".rels",hw(e.wbrels)),delete e.revssf,delete e.ssf,s}function iEt(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=dp(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Qbe(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return DI(e.file,qr.write(t,{type:wr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return qr.write(t,e)}function sEt(t,e){var n=Tl(e||{}),r=tEt(t,n);return oEt(r,n)}function oEt(t,e){var n={},r=wr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?qr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(oL(i))}return e.password&&typeof encrypt_agile<"u"?Qbe(encrypt_agile(i,e.password),e):e.type==="file"?DI(e.file,i):e.type=="string"?DT(i):i}function aEt(t,e){var n=e||{},r=Ebt(t,n);return Qbe(r,n)}function Wh(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return aA(cA(r));case"binary":return cA(r);case"string":return t;case"file":return DI(e.file,r,"utf8");case"buffer":return wr?Sp(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Wh(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function lEt(t,e){switch(e.type){case"base64":return aA(t);case"binary":return t;case"string":return t;case"file":return DI(e.file,t,"binary");case"buffer":return wr?Sp(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function yC(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?aA(n):e.type=="string"?DT(n):n;case"file":return DI(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function eEe(t,e){Dyt(),q2t(t);var n=Tl(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=eEe(t,n);return n.type="array",oL(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=t.SheetNames.indexOf(n.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Wh(wbt(t,n),n);case"slk":case"sylk":return Wh(Bvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"htm":case"html":return Wh(Ybe(t.Sheets[t.SheetNames[i]],n),n);case"txt":return lEt(tEe(t.Sheets[t.SheetNames[i]],n),n);case"csv":return Wh(qH(t.Sheets[t.SheetNames[i]],n),n,"\uFEFF");case"dif":return Wh(Wvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"dbf":return yC(Gvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"prn":return Wh(Hvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"rtf":return Wh(Qvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"eth":return Wh(Ebe.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"fods":return Wh(Jbe(t,n),n);case"wk1":return yC(moe.sheet_to_wk1(t.Sheets[t.SheetNames[i]],n),n);case"wk3":return yC(moe.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),yC(Kbe(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),aEt(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return sEt(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function cEt(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function uEt(t,e,n){var r={};return r.type="file",r.file=e,cEt(r),eEe(t,r)}function hEt(t,e,n,r,i,s,o,a){var l=Mo(n),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch{f.__rowNum__=n}else f.__rowNum__=n;if(!o||t[n])for(var g=e.s.c;g<=e.e.c;++g){var v=o?t[n][g]:t[r[g]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[g]!=null&&(f[s[g]]=c);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[g]!=null){if(x==null)if(v.t=="e"&&x===null)f[s[g]]=null;else if(c!==void 0)f[s[g]]=c;else if(u&&x===null)f[s[g]]=null;else continue;else f[s[g]]=u&&(v.t!=="n"||v.t==="n"&&a.rawNumbers!==!1)?x:fp(v,x,a);x!=null&&(h=!1)}}return{row:f,isempty:h}}function zN(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=pi(u);break;case"number":l=pi(t["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var h=Mo(l.s.r),f=[],g=[],v=0,x=0,b=Array.isArray(t),T=l.s.r,A=0,I={};b&&!t[T]&&(t[T]=[]);var R=c.skipHidden&&t["!cols"]||[],M=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(R[A]||{}).hidden)switch(f[A]=ma(A),n=b?t[T][A]:t[f[A]+h],r){case 1:s[A]=A-l.s.c;break;case 2:s[A]=f[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=fp(n,null,c),x=I[o]||0,!x)I[o]=1;else{do a=o+"_"+x++;while(I[a]);I[o]=x,I[a]=1}s[A]=a}for(T=l.s.r+i;T<=l.e.r;++T)if(!(M[T]||{}).hidden){var F=hEt(t,l,T,f,r,s,b,c);(F.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(g[v++]=F.row)}return g.length=v,g}var Eoe=/"/g;function dEt(t,e,n,r,i,s,o,a){for(var l=!0,c=[],u="",h=Mo(n),f=e.s.c;f<=e.e.c;++f)if(r[f]){var g=a.dense?(t[n]||[])[f]:t[r[f]+h];if(g==null)u="";else if(g.v!=null){l=!1,u=""+(a.rawNumbers&&g.t=="n"?g.v:fp(g,null,a));for(var v=0,x=0;v!==u.length;++v)if((x=u.charCodeAt(v))===i||x===s||x===34||a.forceQuotes){u='"'+u.replace(Eoe,'""')+'"';break}u=="ID"&&(u='"ID"')}else g.f!=null&&!g.F?(l=!1,u="="+g.f,u.indexOf(",")>=0&&(u='"'+u.replace(Eoe,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function qH(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var i=pi(t["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];r.dense=Array.isArray(t);for(var f=r.skipHidden&&t["!cols"]||[],g=r.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(f[v]||{}).hidden||(h[v]=ma(v));for(var x=0,b=i.s.r;b<=i.e.r;++b)(g[b]||{}).hidden||(u=dEt(t,i,b,h,o,l,s,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&n.push((x++?a:"")+u)));return delete r.dense,n.join("")}function tEe(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=qH(t,e);return n}function fEt(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var i=pi(t["!ref"]),s="",o=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=ma(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Mo(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,n=c?(t[u]||[])[a]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=e+"="+r}return l}function nEe(t,e,n){var r=n||{},i=+!r.skipHeader,s=t||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?ao(r.origin):r.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=pi(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var f=r.header||[],g=0;e.forEach(function(x,b){No(x).forEach(function(T){(g=f.indexOf(T))==-1&&(f[g=f.length]=T);var A=x[T],I="z",R="",M=Br({c:a+g,r:o+b+i});c=dA(s,M),A&&typeof A=="object"&&!(A instanceof Date)?s[M]=A:(typeof A=="number"?I="n":typeof A=="boolean"?I="b":typeof A=="string"?I="s":A instanceof Date?(I="d",r.cellDates||(I="n",A=Sl(A)),R=r.dateNF||es[14]):A===null&&r.nullError&&(I="e",A=0),c?(c.t=I,c.v=A,delete c.w,delete c.R,R&&(c.z=R)):s[M]=c={t:I,v:A},R&&(c.z=R))})}),u.e.c=Math.max(u.e.c,a+f.length-1);var v=Mo(o);if(i)for(g=0;g<f.length;++g)s[ma(g+a)+v]={t:"s",v:f[g]};return s["!ref"]=ks(u),s}function pEt(t,e){return nEe(null,t,e)}function dA(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=ao(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?dA(t,Br(e)):dA(t,Br({r:e,c:n||0}))}function mEt(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gEt(){return{SheetNames:[],Sheets:{}}}function yEt(t,e,n,r){var i=1;if(!n)for(;i<=65535&&t.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&t.SheetNames.indexOf(n=o+i)!=-1;++i);}if(Wbe(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function vEt(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=mEt(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function _Et(t,e){return t.z=e,t}function rEe(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function xEt(t,e,n){return rEe(t,"#"+e,n)}function wEt(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function bEt(t,e,n,r){for(var i=typeof e!="string"?e:pi(e),s=typeof e=="string"?e:ks(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=dA(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return t}var D8={encode_col:ma,encode_row:Mo,encode_cell:Br,encode_range:ks,decode_col:DH,decode_row:LH,split_cell:D1t,decode_cell:ao,decode_range:pc,format_cell:fp,sheet_add_aoa:rbe,sheet_add_json:nEe,sheet_add_dom:Xbe,aoa_to_sheet:fb,json_to_sheet:pEt,table_to_sheet:Zbe,table_to_book:Wbt,sheet_to_csv:qH,sheet_to_txt:tEe,sheet_to_json:zN,sheet_to_html:Ybe,sheet_to_formulae:fEt,sheet_to_row_object_array:zN,sheet_get_cell:dA,book_new:gEt,book_append_sheet:yEt,book_set_sheet_visibility:vEt,cell_set_number_format:_Et,cell_set_hyperlink:rEe,cell_set_internal_link:xEt,cell_add_comment:wEt,sheet_set_array_formula:bEt,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const wd=ho()(dh((t,e)=>({vondsten:[],addVondst:n=>t(r=>({vondsten:[...r.vondsten,{...n,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:n=>t(r=>({vondsten:r.vondsten.filter(i=>i.id!==n)})),updateVondst:(n,r)=>t(i=>({vondsten:i.vondsten.map(s=>s.id===n?{...s,...r}:s)})),clearAll:()=>t({vondsten:[]}),exportAsGeoJSON:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:n.map(a=>({type:"Feature",geometry:{type:"Point",coordinates:[a.location.lng,a.location.lat]},properties:{id:a.id,objectType:a.objectType,material:a.material,period:a.period,depth:a.depth,notes:a.notes,timestamp:a.timestamp,photoUrl:a.photoUrl,condition:a.condition,weight:a.weight,length:a.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)},exportAsCSV:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=n.map(c=>{const u=new Date(c.timestamp).toLocaleDateString("nl-NL"),h=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${u},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${h},${c.photoUrl||""}`}).join(`
`),s=r+i,o=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(o),l=document.createElement("a");l.href=a,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},exportAsExcel:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=n.map(a=>({ID:a.id,Latitude:a.location.lat,Longitude:a.location.lng,Datum:new Date(a.timestamp).toLocaleDateString("nl-NL"),Type:a.objectType,Materiaal:a.material,Periode:a.period,"Diepte (cm)":a.depth||"",Conditie:a.condition||"","Gewicht (g)":a.weight||"","Lengte (mm)":a.length||"",Notities:a.notes||"","Foto URL":a.photoUrl||""})),i=D8.json_to_sheet(r),s=D8.book_new();D8.book_append_sheet(s,i,"Vondsten");const o=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=o,uEt(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=n.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},exportAsKML:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${n.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),u=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${u}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}}),{name:"detectorapp-local-vondsten"})),EEt={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},SEt={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},TEt={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};sr.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function Soe(t){if(!t)return t;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let n=t;return Object.entries(e).forEach(([r,i])=>{n=n.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),n=n.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),n}async function kEt(t){try{const e=Zn(t),n=sr("EPSG:4326","EPSG:28992",e);if(n[0]<7e3||n[0]>3e5||n[1]<289e3||n[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${n[0]-r},${n[1]-r},${n[0]+r},${n[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,a=await(await fetch(s)).json();if(a.features&&a.features.length>0){const l=a.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const u=typeof c=="number"?c:parseFloat(c);if(!isNaN(u))return u}}}catch(e){console.warn("AHN height query failed:",e)}return null}const AEt={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},IEt={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function Toe(t,e){const n=[],r=t.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?n.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&n.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?n.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?n.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?n.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&n.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?n.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?n.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&n.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?n.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&n.push("Zeekleiafzetting"),n}function REt(){const t=$i(bt=>bt.map),e=wd(bt=>bt.removeVondst),n=wd(bt=>bt.updateVondst),r=wd(bt=>bt.vondsten),{layers:i,addPoint:s,addLayer:o}=Co(),[a,l]=X.useState([]),[c,u]=X.useState(0),[h,f]=X.useState(!1),[g,v]=X.useState(null),[x,b]=X.useState(!1),[T,A]=X.useState(!1),[I,R]=X.useState(null),[M,F]=X.useState(null),[C,N]=X.useState(null),[O,j]=X.useState(null),[V,W]=X.useState(!1),[U,pe]=X.useState(null),[Ne,Se]=X.useState(null),[je,de]=X.useState(null),[Oe,Ae]=X.useState(!1),[Q,B]=X.useState(""),[ne,ie]=X.useState([]),le=ne[c]||null,[ve,qe]=X.useState(()=>{const bt=localStorage.getItem("popupTextScale");return bt?parseInt(bt):100}),[Ke,Te]=X.useState("half"),we=bt=>{qe(bt),localStorage.setItem("popupTextScale",bt.toString())},Dt=a[c]||"",Ye=a.length>1,sn=bt=>{const Yn=bt.match(/<strong[^>]*>(.*?)<\/strong>/);if(Yn){const cr=Yn[1].replace(/<[^>]+>/g,""),Ft=bt.replace(Yn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:cr,contentWithoutTitle:Ft}}return{title:"",contentWithoutTitle:bt}},$t=bt=>bt.replace(/class="([^"]*)"/g,(cr,Ft)=>{if(Ft.includes("text-xs")){const On=Ft.replace(/\btext-xs\b/g,"").trim();return On?`style="font-size:0.857em" class="${On}"`:'style="font-size:0.857em"'}if(Ft.includes("text-sm")){const On=Ft.replace(/\btext-sm\b/g,"").trim();return On?`class="${On}"`:""}return cr}).replace(/class=""/g,""),{title:fn,contentWithoutTitle:yn}=sn(Dt),dt=$t(yn),lr=Dt.includes("Landbouwperceel"),$n=Dt.includes("data-vondst-id="),Un=()=>{u(bt=>(bt-1+a.length)%a.length)},Xr=()=>{u(bt=>(bt+1)%a.length)},po=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",g),!t||!g||T){console.log(" STOP - map:",!!t,"coord:",g,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${g[0]}, ${g[1]}]`),A(!0);try{await Nyt(t,g)&&b(!0)}catch(bt){console.error("Failed to load height map:",bt)}finally{A(!1)}},kr=()=>{t&&(QV(t),b(!1))};X.useEffect(()=>{if(!t)return;const bt=Ft=>{let On='<strong class="text-purple-800">AMK Monument</strong>';if(Ft.toponiem&&(On+=`<br/><span class="text-sm font-semibold">${Ft.toponiem}</span>`),Ft.kwaliteitswaarde&&(On+=`<br/><span class="text-sm text-purple-700">${Ft.kwaliteitswaarde}</span>`),Ft.omschrijving&&(On+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Ft.omschrijving}</span>`),Ft.txt_label){const Qt=Ft.txt_label.split(", ").slice(0,3).join(", ");On+=`<br/><span class="text-xs text-gray-500 italic">${Qt}${Ft.txt_label.split(", ").length>3?"...":""}</span>`}return On},Yn=async(Ft,On)=>{const Qt=[],Oo=t.getLayers().getArray().filter(Fi=>Fi instanceof Am&&Fi.getVisible()?Fi.getSource()instanceof VRe:!1);for(const Fi of Oo){const Ps=Fi.getSource();if(!Ps)continue;const Pn=Fi.get("title")||"";if(Pn.startsWith("Paleokaart"))continue;if(Pn==="Archeo Landschappen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ze=ae.landschapsnaam||ae.naam||"Archeologisch Landschap",ee=ae.omschrijving||"";let ge=`<strong class="text-green-800">${ze}</strong>`;ee&&(ge+=`<br/><span class="text-sm text-gray-600">${ee}</span>`),ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',ge+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Qt.push(ge)}}catch(He){console.warn("Archeo Landschappen WMS query failed:",He)}continue}if(Pn==="Essen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ze='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(ae.naam||ae.Naam||ae.NAME)&&(ze+=`<br/><span class="text-sm font-semibold text-amber-700">${ae.naam||ae.Naam||ae.NAME}</span>`),(ae.type||ae.Type||ae.TYPE)&&(ze+=`<br/><span class="text-xs text-gray-600">${ae.type||ae.Type||ae.TYPE}</span>`),(ae.omschrijving||ae.Omschrijving)&&(ze+=`<br/><span class="text-xs text-gray-500">${ae.omschrijving||ae.Omschrijving}</span>`),ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',ze+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ze+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',ze+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ze+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Qt.push(ze)}}catch(He){console.warn("Essen WMS query failed:",He)}continue}if(Pn==="FAMKE Steentijd"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${Ie[0]},${Ie[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,z=await(await fetch(Re)).json();if(z.features&&z.features.length>0){const Et=z.features[0].attributes;let Y='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';Y+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ae=Et.BESCHR||"";ae&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',Y+=`<div class="text-sm text-amber-700 mt-1 font-medium">${ae}</div>`);const ze=Et.BESCHRTOELICHTING||"";ze&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${ze}</div>`);const ee=Et.BESCHRLINK||"";ee&&(Y+=`<div class="mt-3"><a href="${ee}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',Qt.push(Y)}}catch(He){console.warn("FAMKE Steentijd query failed:",He)}continue}if(Pn==="FAMKE IJzertijd"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${Ie[0]},${Ie[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,z=await(await fetch(Re)).json();if(z.features&&z.features.length>0){const Et=z.features[0].attributes;let Y='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';Y+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const ae=Et.BESCHR||"";ae&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',Y+=`<div class="text-sm text-orange-700 mt-1 font-medium">${ae}</div>`);const ze=Et.BESCHRTOELICHTING||"";ze&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${ze}</div>`);const ee=Et.BESCHRLINK||"";ee&&(Y+=`<div class="mt-3"><a href="${ee}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',Qt.push(Y)}}catch(He){console.warn("FAMKE IJzertijd query failed:",He)}continue}if(Pn==="Archeo Onderzoeken"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}&FEATURE_COUNT=20`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0)for(const ae of Y.features){const ze=ae.properties,ee=ze.type_onderzoek||"",ge=ze.projectnaam||ze.project_naam||ze.naam||"",$e=ge&&ge!=="-"&&ge.trim()!==""&&!/^\d+$/.test(ge.trim())?ge:"",Je=ze.gemeente||"",Ue=ze.uitvoerder||"",nt=ze.onderzoeksmeldingnummer||"",et=ze.adres||ze.straat||"";let Ct="Archeologisch Onderzoek";$e?Ct=$e:Je&&et?Ct=`${Je} - ${et}`:Je&&(Ct=`Onderzoek ${Je}`);let zt=`<strong class="text-blue-800">${Ct}</strong>`;if(ee&&(zt+=`<br/><span class="text-sm font-semibold text-blue-700">${ee}</span>`),Je&&!Ct.includes(Je)&&(zt+=`<br/><span class="text-sm text-gray-700">${Je}</span>`),et&&!Ct.includes(et)&&(zt+=`<br/><span class="text-sm text-gray-600">${et}</span>`),nt&&(zt+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${nt}</span>`),Ue&&(zt+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Ue}</span>`),ze.startdatum||ze.einddatum){const re=[ze.startdatum,ze.einddatum].filter(Boolean).join(" - ");zt+=`<br/><span class="text-xs text-gray-600">Periode: ${re}</span>`}const gn=[];ze.periode_paleolithicum&&gn.push("Paleolithicum"),ze.periode_mesolithicum&&gn.push("Mesolithicum"),ze.periode_neolithicum&&gn.push("Neolithicum"),ze.periode_bronstijd&&gn.push("Bronstijd"),ze.periode_ijzertijd&&gn.push("IJzertijd"),ze.periode_romeins&&gn.push("Romeins"),ze.periode_middeleeuwen&&gn.push("Middeleeuwen"),ze.periode_nieuwe_tijd&&gn.push("Nieuwe tijd"),gn.length>0&&(zt+=`<br/><span class="text-sm text-purple-700">Datering: ${gn.join(", ")}</span>`),zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ee.toLowerCase().includes("opgraving")?zt+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':ee.toLowerCase().includes("bureauonderzoek")?zt+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':ee.toLowerCase().includes("booronderzoek")?zt+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':ee.toLowerCase().includes("proefsleuven")?zt+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':ee.toLowerCase().includes("begeleiding")?zt+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':ee.toLowerCase().includes("inventariserend")||ee.toLowerCase().includes("karterend")?zt+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':zt+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',zt+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let q="";if($e?q=$e:Ue&&Je?q=`${Ue} ${Je}`:Je&&(q=Je),q){const re=q.length>35?q.substring(0,35)+"...":q;zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(q)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${re}" in DANS</a></div>`,zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(q+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}nt&&(zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${nt} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),Qt.push(zt)}}catch(He){console.warn("Archeo Onderzoeken WMS query failed:",He)}continue}if(Pn==="IKAW"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=500,z=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ze=Math.round(ae.PALETTE_INDEX||ae.palette_index||0),ee=IEt[ze]||`Trefkans onbekend (${ze})`;let ge='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';ge+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ge+=`<div class="text-sm text-orange-700 mt-1">${ee}</div>`;const Je={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[ze];Je&&(ge+=`<div class="text-sm ${Je.kleur} mt-1">${Je.tekst}</div>`,ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ge+=`<div class="text-sm text-gray-700 mt-1">${Je.vondsten}</div>`),ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Qt.push(ge)}}catch(He){console.warn("IKAW WMS query failed:",He)}continue}if(Pn==="Inundatiegebieden"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ze='<strong class="text-blue-800">Inundatiegebied</strong>';(ae["linie-naam"]||ae.linie_naam)&&(ze+=`<br/><span class="text-sm font-semibold text-blue-700">${ae["linie-naam"]||ae.linie_naam}</span>`),ae.naam&&(ze+=`<br/><span class="text-sm text-gray-700">${ae.naam}</span>`),ae.periode&&(ze+=`<br/><span class="text-xs text-gray-500">${ae.periode}</span>`),ae.lin_period&&(ze+=`<br/><span class="text-xs text-gray-400">${ae.lin_period}</span>`),Qt.push(ze)}}catch(He){console.warn("Inundatiegebieden WMS query failed:",He)}continue}if(Pn==="Militaire Objecten"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ze=ae.obj_soort||"",ee=ae.obj_naam||"",ge=ae.lin_period||"",$e=ae["linie-naam"]||ae.linie_naam||"";let Je=ze||"Militair Object",Ue="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",nt="";const et=ze.toLowerCase();et.includes("fort")?(Ue="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",nt="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):et.includes("schans")?(Ue="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",nt="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):et.includes("batterij")||et.includes("battery")?(Ue="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",nt="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):et.includes("bunker")||et.includes("kazemat")?(Ue="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",nt="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):et.includes("sluis")||et.includes("inlaatwerk")?(Ue="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",nt="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):et.includes("toren")||et.includes("wachttoren")?(Ue="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",nt="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):et.includes("kazerne")&&(Ue="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",nt="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let Ct=`<strong class="text-stone-800">${Je}</strong>`;ee&&(Ct+=`<br/><span class="text-sm font-semibold text-stone-700">${ee}</span>`),$e&&(Ct+=`<br/><span class="text-sm text-blue-600">${$e}</span>`),ge&&(Ct+=`<br/><span class="text-xs text-gray-500">${ge}</span>`),Ct+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Ct+=`<div class="text-sm text-gray-700 mt-1">${Ue}</div>`,nt&&(Ct+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ct+=`<div class="text-sm text-gray-700 mt-1">${nt}</div>`),Ct+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Ct+='<div class="text-sm text-gray-700 mt-1">',Ct+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',Ct+="</div>",Qt.push(Ct)}}catch(He){console.warn("Militaire Objecten WMS query failed:",He)}continue}if(Pn==="Verdedigingslinies"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ze='<strong class="text-amber-800">Verdedigingslinie</strong>';const ee={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},ge=ae.naam||ae.lin_naam||"";if(ge){ze+=`<br/><span class="text-sm font-semibold text-amber-700">${ge}</span>`;const $e=Object.entries(ee).find(([Je])=>ge.toLowerCase().includes(Je.toLowerCase())||Je.toLowerCase().includes(ge.toLowerCase()));$e&&(ze+=`<br/><span class="text-sm text-gray-700">${$e[1]}</span>`)}ae.lin_period&&(ze+=`<br/><span class="text-xs text-purple-600">${ae.lin_period}</span>`),ae.status&&(ze+=`<br/><span class="text-xs text-gray-400">${ae.status}</span>`),Qt.push(ze)}}catch(He){console.warn("Verdedigingslinies WMS query failed:",He)}continue}if(Pn==="Rijksmonumenten"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,z=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ze='<strong class="text-red-800">Rijksmonument</strong>';(ae.cbsNaam||ae.cbs_naam)&&(ze+=`<br/><span class="text-sm font-semibold">${ae.cbsNaam||ae.cbs_naam}</span>`),ae.hoofdcategorie&&(ze+=`<br/><span class="text-sm text-red-700">${ae.hoofdcategorie}</span>`),ae.subcategorie&&(ze+=`<br/><span class="text-xs text-gray-600">${ae.subcategorie}</span>`),ae.rijksmonumentnummer&&(ze+=`<br/><span class="text-xs text-gray-500">Nr: ${ae.rijksmonumentnummer}</span>`),(ae.bouwjaar||ae.oorspronkelijkebouwjaar)&&(ze+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${ae.bouwjaar||ae.oorspronkelijkebouwjaar}</span>`),ze+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ae.rijksmonumentnummer&&(ze+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${ae.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),ze+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Qt.push(ze)}}catch(He){console.warn("Rijksmonumenten WMS query failed:",He)}continue}if(Pn==="Werelderfgoed"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=500,z=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ze='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(ae.siteName||ae.naam)&&(ze+=`<br/><span class="text-sm font-semibold text-cyan-700">${ae.siteName||ae.naam}</span>`),ae.siteDesignation&&(ze+=`<br/><span class="text-xs text-gray-600">${ae.siteDesignation}</span>`),Qt.push(ze)}}catch(He){console.warn("Werelderfgoed WMS query failed:",He)}continue}if(Pn==="Terpen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${Ie[0]},${Ie[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,z=await(await fetch(Re)).json();if(z.features&&z.features.length>0){const Et=z.features[0].attributes,Y=Et.SOORT||"Terp",ae=Et.SHAPE_Area?Math.round(Et.SHAPE_Area):null;let ze="",ee="",ge=!1;try{const Ct=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-100},${Ie[1]-100},${Ie[0]+100},${Ie[1]+100}`}`,gn=await(await fetch(Ct)).json();if(gn.features&&gn.features.length>0){const q=gn.features[0].properties;ze=q.siteName||q.naam||"",ee=q.inspireId||q.monumentnummer||"",ge=!0}}catch{}let $e="";ze?($e=`<strong class="text-orange-800">${ze}</strong>`,$e+=`<br/><span class="text-sm text-orange-600 font-medium">${Y}</span>`):$e=`<strong class="text-orange-800">${Y}</strong>`,$e+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const Ue={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[Y.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if($e+=`<div class="mt-2 text-sm text-gray-700">${Ue.uitleg}</div>`,$e+=`<br/><span class="text-sm text-gray-600">Periode: ${Ue.periode}</span>`,ae&&ae>100){const nt=(ae/1e4).toFixed(1);$e+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${nt} hectare</span>`}if(ge&&($e+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',$e+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",ee&&($e+=`<br/>Monumentnummer: ${ee}`),$e+="</div>"),$e+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',$e+="<strong>Detectietip:</strong> ",Y.toLowerCase().includes("afgegraven")?$e+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":$e+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",$e+="</div>",$e+='<div class="mt-3 space-y-1">',$e+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',$e+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',$e+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',ze){const nt=encodeURIComponent(ze+" terp friesland");$e+=`<a href="https://www.google.com/search?q=${nt}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${ze}</a>`}$e+="</div>",Qt.push($e)}}catch(He){console.warn("Terpen query failed:",He)}continue}if(Pn==="Religieus Erfgoed"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,z=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ze=ae.naam||ae.NAAM||ae.name||ae.NAME||"Onbekend",ee=ae.denominatie||ae.DENOMINATIE||ae.religie||"",ge=ae.type||ae.TYPE||ae.functie||"",$e=ae.bouwjaar||ae.BOUWJAAR||ae.jaar||"",Je=ae.gemeente||ae.GEMEENTE||ae.plaats||"";let Ue=`<strong class="text-purple-800">${ze}</strong>`;const nt=ge.toLowerCase();let et="Een religieus gebouw of heilige plek.",Ct="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";nt.includes("kerk")||nt.includes("church")?(et="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",Ct="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):nt.includes("kapel")||nt.includes("chapel")?(et="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",Ct="Devotionalia, munten, kruisjes, rozenkransen"):nt.includes("synagoge")?(et="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",Ct="Munten, knopen, kleine religieuze voorwerpen"):nt.includes("klooster")||nt.includes("monastery")?(et="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",Ct="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):nt.includes("toren")||nt.includes("tower")?(et="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",Ct="Munten, knopen, bouwmateriaal"):(nt.includes("begraafplaats")||nt.includes("cemetery"))&&(et="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",Ct="Detecteren hier niet toegestaan"),ee&&(Ue+=`<br/><span class="text-sm text-purple-600">${ee}</span>`),ge&&(Ue+=`<br/><span class="text-sm text-gray-600">${ge}</span>`),$e&&(Ue+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${$e}</span>`),Je&&(Ue+=`<br/><span class="text-xs text-gray-400">${Je}</span>`),Ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Ue+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`,Ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ue+=`<div class="text-sm text-gray-700 mt-1">${Ct}</div>`,Ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',nt.includes("begraafplaats")?Ue+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':Ue+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Qt.push(Ue)}}catch(He){console.warn("Religieus Erfgoed WMS query failed:",He)}continue}if(Pn==="Gewaspercelen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,rn=`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`,z=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${rn}`,Et=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${rn}`,[Y,ae]=await Promise.all([fetch(z),fetch(Et).catch(()=>null)]),ze=await Y.json();if(ze.features&&ze.features.length>0){const ee=ze.features[0].properties;let ge='<strong class="text-green-800">Landbouwperceel</strong>';if((ee.gewas||ee.gewasnaam)&&(ge+=`<br/><span class="text-sm font-semibold text-green-700">${ee.gewas||ee.gewasnaam}</span>`),(ee.categorie||ee.category)&&(ge+=`<br/><span class="text-xs text-gray-600">${ee.categorie||ee.category}</span>`),ee.oppervlakte&&(ge+=`<br/><span class="text-xs text-gray-500">${ee.oppervlakte} ha</span>`),ae)try{const $e=await ae.json();if($e.features&&$e.features.length>0){const Je=$e.features[0].properties,Ue=Je.first_soilname||Je.soilname||Je.bodemtype,nt=Je.first_soilcode||Je.soilcode||Je.maparea_soilcode;if(Ue){ge+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${Ue}</span>`;const et=Toe(Ue,nt);et.length>0&&(ge+=`<br/><span class="text-xs text-gray-500 italic">${et.join("  ")}</span>`)}}}catch{}Qt.push(ge)}}catch(He){console.warn("BRP Gewaspercelen WMS query failed:",He)}continue}if(Pn==="Kadastrale Grenzen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=20,z=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ze=ae.kadastraleGemeenteWaarde||ae.kadastrale_gemeente_waarde||ae.kadastraleGemeente||AEt[String(ae.kadastraleGemeenteCode)]||ae.kadastraleGemeenteCode,ee=ae.sectie||ae.Sectie||"",ge=ae.perceelnummer||ae.perceelNummer||ae.Perceelnummer||"",$e=ae.kadastraleGrootteWaarde||ae.kadastrale_grootte_waarde||ae.kadastraleGrootte||ae.oppervlakte,Je=ae.AKRKadastraleGemeenteCodeWaarde||ae.akrKadastraleGemeenteCodeWaarde||"",Ue=[ze,ee,ge].filter(Boolean).join(" "),nt=Je&&ee&&ge?`${Je}-${ee}-${ge}`:"";let et='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(Ue&&(et+=`<br/><span class="text-sm text-indigo-700">${Ue}</span>`),nt&&(et+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${nt}</span>`),$e){const Ct=typeof $e=="number"?$e:parseFloat($e);isNaN(Ct)||(et+=`<br/><span class="text-xs text-gray-600">${Ct.toLocaleString("nl-NL")} m</span>`)}et+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Qt.push(et)}}catch(He){console.warn("Kadastrale Grenzen WMS query failed:",He)}continue}if(Pn==="Scheepswrakken"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-cyan-800">${ae.naam||ae.NAAM||"Scheepswrak"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",ee+="In de bodem kunnen nog resten van het schip en de lading liggen.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-cyan-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.datering||ae.DATERING)&&(ee+=`<br/><span class="text-sm text-gray-600">Periode: ${ae.datering||ae.DATERING}</span>`),(ae.bron||ae.BRON)&&(ee+=`<br/><span class="text-xs text-gray-500">Bron: ${ae.bron||ae.BRON}</span>`),ee+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',ee+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Qt.push(ee)}}catch(He){console.warn("Scheepswrakken WMS query failed:",He)}continue}if(Pn==="Woonheuvels ZH"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-orange-800">${ae.naam||ae.NAAM||"Woonheuvel"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",ee+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-orange-700">Type: ${ae.type||ae.TYPE}</span>`),ee+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',ee+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Qt.push(ee)}}catch(He){console.warn("Woonheuvels WMS query failed:",He)}continue}if(Pn==="Romeinse Forten"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-red-800">${ae.naam||ae.NAAM||"Romeins Fort"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",ee+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-red-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.periode||ae.PERIODE)&&(ee+=`<br/><span class="text-sm text-gray-600">Periode: ${ae.periode||ae.PERIODE}</span>`),ee+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',ee+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',Qt.push(ee)}}catch(He){console.warn("Romeinse Forten WMS query failed:",He)}continue}if(Pn==="Windmolens"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-amber-800">${ae.naam||ae.NAAM||"Windmolen"}</strong>`;if(ee+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",ee+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",ee+="</div>",ae.type||ae.TYPE||ae.functie||ae.FUNCTIE){const ge=ae.functie||ae.FUNCTIE||ae.type||ae.TYPE;ee+=`<br/><span class="text-sm text-amber-700">Functie: ${ge}</span>`}(ae.bouwjaar||ae.BOUWJAAR)&&(ee+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${ae.bouwjaar||ae.BOUWJAAR}</span>`),ee+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',ee+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',Qt.push(ee)}}catch(He){console.warn("Windmolens WMS query failed:",He)}continue}if(Pn==="Erfgoedlijnen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-purple-800">${ae.naam||ae.NAAM||ae.erfgoedlijn||"Erfgoedlijn"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",ee+="Langs deze lijnen vind je vaak bijzondere plekken.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-purple-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.omschrijving||ae.OMSCHRIJVING)&&(ee+=`<br/><span class="text-sm text-gray-600">${ae.omschrijving||ae.OMSCHRIJVING}</span>`),ee+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',ee+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',Qt.push(ee)}}catch(He){console.warn("Erfgoedlijnen WMS query failed:",He)}continue}if(Pn==="Oude Kernen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-stone-800">${ae.naam||ae.NAAM||"Historische Kern"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",ee+="De grond bevat vaak veel sporen van het verleden.",ee+="</div>",(ae.type||ae.TYPE)&&(ee+=`<br/><span class="text-sm text-stone-700">Type: ${ae.type||ae.TYPE}</span>`),(ae.periode||ae.PERIODE)&&(ee+=`<br/><span class="text-sm text-gray-600">Periode: ${ae.periode||ae.PERIODE}</span>`),ee+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',ee+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Qt.push(ee)}}catch(He){console.warn("Oude Kernen WMS query failed:",He)}continue}if(Pn==="Relictenkaart Punten"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ze={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},ee=ae.type?.replace(/[0-9]/g,"")||"",ge=ze[ee]||{naam:ae.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let $e=`<strong class="text-emerald-800">${ge.naam}</strong>`;$e+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',ae.streek&&($e+=`<br/><span class="text-sm text-gray-600">Streek: ${ae.streek}</span>`),$e+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',$e+=`<div class="text-sm text-gray-700 mt-1">${ge.uitleg}</div>`,$e+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',Qt.push($e)}}catch(He){console.warn("Relictenkaart Punten WMS query failed:",He)}continue}if(Pn==="Relictenkaart Lijnen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=50,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ee={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[ae.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let ge=`<strong class="text-teal-800">${ee.naam}</strong>`;ge+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ge+=`<div class="text-sm text-gray-700 mt-1">${ee.uitleg}</div>`,ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',ge+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',Qt.push(ge)}}catch(He){console.warn("Relictenkaart Lijnen WMS query failed:",He)}continue}if(Pn==="Relictenkaart Vlakken"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=100,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties,ee={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[ae.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let ge=`<strong class="text-lime-800">${ee.naam}</strong>`;if(ge+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',ae.st_area_shape_){const $e=(ae.st_area_shape_/1e4).toFixed(1);ge+=`<br/><span class="text-sm text-gray-600">${$e} hectare</span>`}ge+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ge+=`<div class="text-sm text-gray-700 mt-1">${ee.uitleg}</div>`,Qt.push(ge)}}catch(He){console.warn("Relictenkaart Vlakken WMS query failed:",He)}continue}if(Pn==="Verdronken Dorpen"){try{const He=Zn(Ft),Ie=sr("EPSG:4326","EPSG:28992",He),Re=200,z=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ie[0]-Re},${Ie[1]-Re},${Ie[0]+Re},${Ie[1]+Re}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const ae=Y.features[0].properties;let ee=`<strong class="text-blue-800">${ae.naam||ae.NAAM||"Verdronken dorp"}</strong>`;ee+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',ee+='<div class="mt-2 text-sm text-gray-700">',ee+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",ee+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",ee+="</div>",(ae.verdronken||ae.VERDRONKEN||ae.jaar||ae.JAAR)&&(ee+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${ae.verdronken||ae.VERDRONKEN||ae.jaar||ae.JAAR}</span>`),(ae.gemeente||ae.GEMEENTE)&&(ee+=`<br/><span class="text-sm text-gray-600">Gemeente: ${ae.gemeente||ae.GEMEENTE}</span>`),(ae.bron||ae.BRON)&&(ee+=`<br/><span class="text-xs text-gray-500">Bron: ${ae.bron||ae.BRON}</span>`),ee+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',ee+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",ee+="</div>",ee+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',Qt.push(ee)}}catch(He){console.warn("Verdronken Dorpen WMS query failed:",He)}continue}const Ti=Ps.getFeatureInfoUrl(Ft,On,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Ti)try{const Ie=await(await fetch(Ti)).json();if(Ie.features&&Ie.features.length>0){const Re=Ie.features[0].properties;if(Pn==="AHN 0.5m"){let Y='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const ae=Re.value_list??Re.GRAY_INDEX??Re.value??Re.gray_index??Re.dtm_05m??Re.DTM_05M??Re.hoogte??Re.HOOGTE??Re.elevation??Re.ELEVATION;if(ae!=null&&!isNaN(Number(ae))){const ze=typeof ae=="number"?ae.toFixed(2):Number(ae).toFixed(2);Y+=`<br/><span class="text-sm text-blue-700">Hoogte: ${ze} m NAP</span>`,Qt.push(Y)}else{let ze=!1;const ee=["geometry","id","fid","gml_id","bbox"];for(const[ge,$e]of Object.entries(Re))!ee.includes(ge.toLowerCase())&&$e!==null&&$e!==""&&(Y+=`<br/><span class="text-xs text-gray-600">${ge}: ${$e}</span>`,ze=!0);ze&&Qt.push(Y)}continue}if(Pn==="Geomorfologie"){let Y='<strong class="text-green-800">Geomorfologie</strong>',ae=!1;const ze=Re.landform_subgroup_description,ee=Re.relief_klasse,ge=Re.relief_subklasse,$e=Re.genese_description,Je=Re.active_process;if(ze&&(Y+=`<br/><span class="text-sm text-green-700">${ze}</span>`,ae=!0),ee){const Ue=ge&&ge!==ee?`${ee} (${ge})`:ee;Y+=`<br/><span class="text-xs text-gray-600">Relief: ${Ue}</span>`,ae=!0}if($e&&(Y+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${$e}</span>`,ae=!0),Je&&Je!=="onbekend"&&(Y+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Je}</span>`,ae=!0),!ae){const Ue=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[nt,et]of Object.entries(Re))!Ue.includes(nt.toLowerCase())&&et!==null&&et!==""&&!nt.includes("validfrom")&&!nt.includes("validto")&&(Y+=`<br/><span class="text-xs text-gray-600">${nt}: ${et}</span>`)}Y+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Qt.push(Y);continue}let rn=`<strong>${Pn}</strong>`;const z=Re.first_soilname||Re.soilname,Et=Re.soilcode||Re.first_soilcode;if(z&&(rn+=`<br/><span class="text-sm text-amber-700">${z}</span>`,Pn==="Bodemkaart")){const Y=Toe(z,Et);Y.length>0&&(rn+=`<br/><span class="text-xs text-gray-500 italic">${Y.join("  ")}</span>`)}if(Re.soilslope&&Re.soilslope!=="Niet opgenomen"&&(rn+=`<br/><span class="text-xs text-gray-500">Helling: ${Re.soilslope}</span>`),!z){const Y=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[ae,ze]of Object.entries(Re))!Y.includes(ae)&&ze&&ze!=="Niet opgenomen"&&(rn+=`<br/><span class="text-xs text-gray-600">${ae}: ${ze}</span>`)}Qt.push(rn)}}catch(He){console.warn("WMS GetFeatureInfo failed:",He)}}return Qt},cr=async Ft=>{const On=[],Qt=[],Oo=Ie=>{if(!Ie)return;const Re=Ie.getType(),z=Ie.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:Re,coordinates:z}},Fi=kEt(Ft.coordinate),Ps=[];t.forEachFeatureAtPixel(Ft.pixel,Ie=>{Ps.push(Ie)});for(const Ie of Ps){const Re=Ie.getProperties(),{geometry:rn,...z}=Re;if(z.vondst){const ee=z.vondst,ge=`<strong>${ee.objectType}</strong>
            <div data-vondst-id="${ee.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${ee.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${ee.period}</span>
            ${ee.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${ee.depth} cm</span>`:""}
            ${ee.condition&&ee.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${ee.condition}</span>`:""}
            ${ee.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${ee.weight} gram</span>`:""}
            ${ee.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${ee.notes}</span>`:""}
            ${ee.photoUrl?`<br/><a href="${ee.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(ee.timestamp).toLocaleDateString("nl-NL")}</span>`;On.push(ge),Qt.push(null),R(ee.id);continue}if(z.layerType==="customPoint"&&z.customPoint){const ee=z.customPoint,ge=z.customLayerName||"Mijn Laag",$e=z.customLayerColor||"#f97316";let Je="";if(ee.popupContent?(Je=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${$e}"></span>
              <span class="text-xs font-medium" style="color: ${$e}">${ge}</span>
            </div>`,Je+=ee.popupContent):(Je=`<strong>${ee.name}</strong>`,Je+=`<br/><span class="text-xs text-gray-500">${ge}</span>`,ee.category&&ee.category!=="Overig"&&(Je+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${ee.category}</span>`)),ee.photos&&ee.photos.length>0){Je+='<div class="flex flex-wrap gap-1 my-2">';for(const Ue of ee.photos.slice(0,3)){const nt=Ue.thumbnailUrl||Ue.thumbnailBase64;nt&&(Je+=`<img src="${nt}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}ee.photos.length>3&&(Je+=`<span class="text-xs text-gray-400 self-end">+${ee.photos.length-3} meer</span>`),Je+="</div>"}ee.notes&&!ee.popupContent&&(Je+=`<br/><span class="text-sm text-gray-600 mt-1">${ee.notes}</span>`),ee.url&&(Je+=`<br/><a href="${ee.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Je+=`<br/><span class="text-xs text-gray-400">${new Date(ee.createdAt).toLocaleDateString("nl-NL")}</span>`,On.push(Je),Qt.push(null);continue}if(z.layerType==="importedLayer"){const ee=z.layerName||"Gemporteerde laag",ge=z.layerColor||"#8b5cf6",$e=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Je=z.name||z.Name||z.naam||z.title||z.NAAM||z.NAME||z.label||z.description||"Feature";let Ue=`<strong style="color: ${ge}">${Je}</strong>`;Ue+=`<br/><span class="text-xs text-gray-500">${ee}</span>`;const nt=Object.entries(z).filter(([et])=>!$e.includes(et)&&et!=="name"&&et!=="Name");if(nt.length>0){Ue+='<div class="mt-2 space-y-1">';for(const[et,Ct]of nt)if(Ct!=null&&Ct!==""){const zt=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,q=>q.toUpperCase());let gn=String(Ct);gn.length>200&&(gn=gn.substring(0,200)+"..."),gn.startsWith("http://")||gn.startsWith("https://")?Ue+=`<div class="text-sm"><span class="text-gray-500">${zt}:</span> <a href="${gn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Ue+=`<div class="text-sm"><span class="text-gray-500">${zt}:</span> <span class="text-gray-700">${gn}</span></div>`}Ue+="</div>"}On.push(Ue),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Ue});continue}if(z.kwaliteitswaarde&&z.kwaliteitswaarde.includes("archeologische waarde")){const ee=bt(z);On.push(ee),Qt.push({geometry:Oo(rn),properties:z,popupHtml:ee});continue}if(z.layerType==="romeinsFort"||z.layerType==="romeinsFortLijn"){const ee=z.Name||z.name||"";z.description;const ge=EEt[ee]||null,$e=ge||SEt;let Je=`<strong class="text-red-800">${ge?$e.naam:ee||"Romeins Fort"}</strong>`;if(Je+=`<br/><span class="text-sm text-red-700">${TEt[$e.type]||$e.type}</span>`,Je+=`<br/><span class="text-sm text-gray-500">${$e.periode}</span>`,z.layerType==="romeinsFortLijn"&&(Je+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),Je+=`<br/><span class="text-xs text-gray-600 mt-1 block">${$e.beschrijving}</span>`,ge?.bronnen&&ge.bronnen.length>0){const Ue=ge.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];Je+=`<br/><a href="${ge.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${Ue}</a>`}On.push(Je),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Je});continue}let Et=z.name||z.Name||z.naam||z.title||z.NAAM||z.NAME||z.label||z.route_name||z.road_name;Et||(z.leisure==="playground"?Et="Speeltuin":z.leisure==="park"?Et="Park":z.leisure==="swimming_area"||z.sport==="swimming"?Et="Zwemplek":z.tourism==="museum"?Et="Museum":z.amenity==="cafe"||z.amenity==="restaurant"?Et=z.amenity==="cafe"?"Caf":"Restaurant":z.historic==="castle"?Et="Kasteel":Et="Info"),(z.bunker_type||z.name&&(z.name.toLowerCase().includes("bunker")||z.name.toLowerCase().includes("kazemat")||z.name.toLowerCase().includes("schuilplaats")))&&(Et="Bunker"),z.historic==="battlefield"&&(Et="Historisch slagveld");let Y=`<strong>${Et}</strong>`,ae=!1;if(z.category&&(Y+=`<br/><span class="text-sm text-gray-600">Categorie: ${z.category}</span>`),z.from_to&&z.from_to!==Et&&(Y+=`<br/><span class="text-sm text-gray-600">${z.from_to}</span>`),z.route&&z.route!==Et&&(Y+=`<br/><span class="text-sm text-gray-600">${z.route}</span>`),z.TOPONIEM&&(Y+=`<br/><span class="text-sm font-semibold text-gray-800">${z.TOPONIEM}</span>`,z.PLAATS&&(Y+=`<br/><span class="text-xs text-gray-500">${z.PLAATS}</span>`)),(z.AARD_VINDP||z.Aard_vindp)&&(Y+=`<br/><span class="text-sm text-gray-700">Aard: ${z.AARD_VINDP||z.Aard_vindp}</span>`),z.BEGIN_PER&&z.EIND_PER&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${z.BEGIN_PER} - ${z.EIND_PER}</span>`),(z.AARD_OPM||z.Aard_opmer)&&(Y+=`<br/><span class="text-xs text-gray-600 italic">${z.AARD_OPM||z.Aard_opmer}</span>`),z.Gemeente&&(Y+=`<br/><span class="text-sm text-gray-600">Gemeente: ${z.Gemeente}</span>`),z.Bron&&(Y+=`<br/><span class="text-xs text-gray-500">Bron: ${z.Bron}</span>`),z.Bron_besch&&(Y+=`<br/><span class="text-xs text-gray-500">${z.Bron_besch}</span>`),z.Dat_st_z&&z.Dat_ei_z&&(Y+=`<br/><span class="text-sm text-purple-700">Datering: ${z.Dat_st_z} - ${z.Dat_ei_z}</span>`),z.Begin&&z.Einde&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${z.Begin} - ${z.Einde}</span>`),z.Uiterwaard&&(Y+=`<br/><span class="text-sm font-semibold">${z.Uiterwaard}</span>`),z.rivier&&(Y+=`<br/><span class="text-sm text-blue-600">Rivier: ${z.rivier}</span>`),z.Beschrijvi&&(Y+=`<br/><span class="text-sm text-gray-700">${z.Beschrijvi}</span>`),z.leisure==="park"){ae=!0,Y=`<strong class="text-green-800">${z.name||"Park"}</strong>`,Y+='<br/><span class="text-sm text-gray-800">Park</span>',z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),z.area&&(Y+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${z.area}</span>`);const ge=[];if(z.dog==="yes"&&ge.push("Honden toegestaan"),z.lit==="yes"&&ge.push("Verlicht"),z.bench==="yes"&&ge.push("Bankjes"),ge.length>0&&(Y+=`<br/><span class="text-sm text-gray-600">${ge.join("  ")}</span>`),z.operator&&(Y+=`<br/><span class="text-xs text-gray-500">Beheer: ${z.operator}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',Y+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',z.website){const $e=z.website.replace(/^https?:\/\//,"").split("/")[0];Y+=`<div class="mt-2"><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${$e}</a></div>`}}else z.leisure==="playground"&&(ae=!0,Y=`<strong class="text-orange-800">${z.name||"Speeltuin"}</strong>`,Y+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`));if(z.tourism==="museum"||z.museum){ae=!0;const ee=z.name||"Museum",ge=z.museum||z["museum:type"]||"",Je=ge&&ge!=="yes"?{art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[ge.toLowerCase()]||ge:"Museum";if(Y=`<strong class="text-purple-800">${ee}</strong>`,Y+=`<br/><span class="text-sm text-purple-600">${Je}</span>`,z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),z.fee){const Ue=z.fee==="yes"?"Toegangsprijs":z.fee==="no"?"Gratis toegang":z.fee;Y+=`<div class="mt-2"><span class="text-sm text-gray-600">${Ue}</span></div>`}if(z.opening_hours){const Ue=Soe(String(z.opening_hours));Y+=`<div class="mt-2"><span class="text-xs text-green-600">Open: ${Ue}</span></div>`}if(z.website||z.url){const Ue=z.website||z.url;Y+=`<div class="mt-1"><a href="${Ue}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${ee}</a></div>`}if(z.wikipedia){const Ue=z.wikipedia.split(":")[0]||"nl",nt=z.wikipedia.split(":")[1]||z.wikipedia;Y+=`<div class="text-sm"><a href="https://${Ue}.wikipedia.org/wiki/${encodeURIComponent(nt)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Meer info op Wikipedia</a></div>`}if(z["addr:street"]||z["addr:housenumber"]||z["addr:city"]){if(Y+='<div class="mt-2 text-xs text-gray-400">',z["addr:street"]||z["addr:housenumber"]){const Ue=[z["addr:street"],z["addr:housenumber"]].filter(Boolean).join(" ");Ue&&(Y+=`${Ue}<br/>`)}z["addr:city"]&&(Y+=`${z["addr:postcode"]||""} ${z["addr:city"]}`),Y+="</div>"}}if(z.leisure==="swimming_area"||z.sport==="swimming"||z.natural==="beach"){ae=!0,Y=`<strong class="text-cyan-800">${z.name||"Zwemplek"}</strong>`;const ge=z.natural==="beach"?"Strand":z.leisure==="swimming_area"?"Zwemplek":"Zwemwater";Y+=`<br/><span class="text-sm text-gray-800">${ge}</span>`,z.water&&(Y+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[z.water]||z.water}</span>`),z.supervised==="yes"&&(Y+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),z.changing_rooms==="yes"&&(Y+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',Y+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(z.osm_id&&z.address!==void 0&&(Y+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',z.address&&(Y+=`<br/><span class="text-xs text-gray-500">${z.address}</span>`),z.phone&&(Y+=`<br/><span class="text-xs text-gray-600">${z.phone}</span>`)),z.site_type==="tumulus"){ae=!0;const ee=Ie.getGeometry()?.getCoordinates();let ge="",$e="";if(ee){const Je=Zn(ee),Ue=Je[0],nt=Je[1];Ue>5.5&&Ue<6.3&&nt>52&&nt<52.5?(ge="Veluwe",$e="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ue>6.2&&Ue<7.1&&nt>52.6&&nt<53.3?(ge="Drenthe",$e="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ue>4.5&&Ue<6&&nt>51.3&&nt<51.9?(ge="Noord-Brabant",$e="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ue>5.5&&Ue<6.3&&nt>50.7&&nt<51.6?(ge="Limburg",$e="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ue>5&&Ue<5.6&&nt>52&&nt<52.4&&(ge="Utrechtse Heuvelrug",$e="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}Y+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ge&&(Y+=`<br/><span class="text-sm text-gray-500">${ge}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',$e&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',z.wikidata?(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${z.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',Y+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(z.historic==="castle"||z.castle_type){ae=!0;const ee={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ge=z.castle_type?ee[z.castle_type]:null,$e=ge?.label||"Kasteel";if(Y+=`<br/><span class="text-sm text-purple-700">${$e}</span>`,z.start_date&&(Y+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${z.start_date}</span>`),z.heritage&&(Y+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ge?Y+=`<div class="text-sm text-gray-700 mt-1">${ge.uitleg}</div>`:Y+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ge?Y+=`<div class="text-sm text-gray-700 mt-1">${ge.vondsten}</div>`:Y+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',z.wikipedia||z.website){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',z.wikipedia){const Je=z.wikipedia.startsWith("http")?z.wikipedia:`https://nl.wikipedia.org/wiki/${z.wikipedia.replace(/^nl:/,"")}`;Y+=`<div class="text-sm text-gray-700 mt-1"><a href="${Je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}z.website&&(Y+=`<div class="text-sm text-gray-700 mt-1"><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(z.historic==="ruins"){const ee=z.ruins_type||"";let ge="Rune",$e="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Je="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(ee.toLowerCase().includes("church")||ee.toLowerCase().includes("kerk")?(ge="Kerkrune",$e="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Je="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):ee.toLowerCase().includes("castle")||ee.toLowerCase().includes("kasteel")?(ge="Kasteelrune",$e="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Je="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):ee.toLowerCase().includes("mill")||ee.toLowerCase().includes("molen")?(ge="Molenrune",$e="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Je="Gereedschap, munten, huishoudelijke voorwerpen"):ee.toLowerCase().includes("fort")&&(ge="Fortrune",$e="De overblijfselen van een militair fort of verdedigingswerk.",Je="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),Y+=`<br/><span class="text-sm text-amber-700">${ge}</span>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${$e}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${Je}</div>`,z.description&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`),z.wikipedia){const Ue=z.wikipedia.startsWith("http")?z.wikipedia:`https://${z.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${z.wikipedia.replace(/^[a-z]{2}:/,"")}`;Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ue}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(z.bunker_type||z.name&&(z.name.toLowerCase().includes("bunker")||z.name.toLowerCase().includes("kazemat")||z.name.toLowerCase().includes("schuilplaats"))){ae=!0;const ee={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ge=z.name||"",$e=z.bunker_type?ee[z.bunker_type]||z.bunker_type:"";ge&&ge!=="Bunker"&&(Y+=`<br/><span class="text-sm font-semibold text-gray-700">${ge}</span>`),$e&&$e!==ge&&(Y+=`<br/><span class="text-xs text-gray-500">${$e}</span>`);const Je=Ie.getGeometry()?.getCoordinates();let Ue="",nt="",et="";if(Je){const Ct=Zn(Je),zt=Ct[0],gn=Ct[1],q=zt<4.8||zt<5.2&&gn>51.8&&gn<53.5,re=zt>4.2&&zt<4.4&&gn>52&&gn<52.15,J=zt>4.5&&zt<4.7&&gn>52.4&&gn<52.5,te=zt>4&&zt<4.2&&gn>51.95&&gn<52.05,se=zt<4.2&&gn<51.6,oe=zt>5.2&&zt<5.8&&gn>51.9&&gn<52.3;re?(Ue="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",nt="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):J?(Ue="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",nt="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):te?(Ue="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",nt="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):se?(Ue="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",nt="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):q?(Ue="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):oe?(Ue="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",nt="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(Ue="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else Ue="Een bunker uit de Tweede Wereldoorlog.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${Ue}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',Y+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">',Y+=`<a href="${nt}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,z.website?Y+=`<br/><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:Y+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',Y+="</div>"}if(z.historic==="battlefield"){ae=!0;const ee=z.name||"Onbekend slagveld",$e={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[ee];if(ee!=="Onbekend slagveld"&&ee!=="Historisch slagveld"&&(Y+=`<br/><span class="text-sm font-semibold text-red-700">${ee}</span>`),$e)Y+=`<br/><span class="text-xs text-gray-500">${$e.periode}</span>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${$e.samenvatting}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${$e.uitkomst}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${$e.watZieJe}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">',Y+=`<a href="${$e.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,ee.includes("Arnhem")&&(Y+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),ee.includes("Overloon")&&(Y+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),Y+="</div>";else if(z.date&&(Y+=`<br/><span class="text-xs text-gray-500">${z.date}</span>`),z.description?(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`):(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),z.wikipedia){const Je=z.wikipedia.startsWith("http")?z.wikipedia:`https://nl.wikipedia.org/wiki/${z.wikipedia.replace("nl:","")}`;Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1"><a href="${Je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(z.bron==="Paleobiology Database"){const ee=Ue=>{const nt={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,Ct]of Object.entries(nt))if(Ue.toLowerCase().includes(et.toLowerCase()))return Ct;return""},ge=Ue=>{const nt={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,Ct]of Object.entries(nt))if(Ue.toLowerCase().includes(et.toLowerCase()))return Ct;return""},$e=Ue=>{const nt={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=Ue;for(const[Ct,zt]of Object.entries(nt))et=et.replace(new RegExp(Ct,"gi"),zt);return et},Je=Ue=>{const nt={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=Ue;for(const[Ct,zt]of Object.entries(nt))et=et.replace(new RegExp(Ct,"gi"),zt);return et};if(z.vindplaats&&(Y+=`<br/><span class="text-xs text-gray-600">${z.vindplaats}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',z.taxonomie&&z.taxonomie!=="Onbekend"){const Ue=ee(z.taxonomie);Ue?(Y+=`<div class="text-sm text-gray-700 mt-1">${Ue}</div>`,Y+=`<div class="text-xs text-gray-500 italic">(${z.taxonomie})</div>`):Y+=`<div class="text-sm text-gray-700 mt-1">${z.taxonomie}</div>`}if(z.aantal_fossielen){const Ue=parseInt(z.aantal_fossielen),nt=Ue>100?"Veel fossielen gevonden op deze locatie.":Ue>10?"Meerdere fossielen gevonden op deze locatie.":`${z.aantal_fossielen} fossiel${Ue>1?"en":""} gevonden op deze locatie.`;Y+=`<div class="text-sm text-gray-600 mt-1">${nt}</div>`}if(z.periode&&z.periode!=="Onbekend"){Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ue=ge(z.periode);Y+=`<div class="text-sm text-gray-700 mt-1">${z.periode}</div>`,Ue&&(Y+=`<div class="text-sm text-gray-600">${Ue}</div>`),z.ouderdom&&z.ouderdom!=="Onbekend"&&(Y+=`<div class="text-sm text-gray-600">Ouderdom: ${z.ouderdom}</div>`)}(z.gesteente||z.formatie||z.milieu)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',z.gesteente&&(Y+=`<div class="text-sm text-gray-700 mt-1">${$e(z.gesteente)}</div>`),z.formatie&&(Y+=`<div class="text-sm text-gray-600">Formatie: ${z.formatie}</div>`,z.lid&&(Y+=`<div class="text-sm text-gray-600 ml-3">Lid: ${z.lid}</div>`)),z.milieu&&(Y+=`<div class="text-sm text-gray-600">Leefomgeving: ${Je(z.milieu)}</div>`))}if(z.layerType==="fossielHotspot"){const ee=[];if(z.type&&ee.push(z.type),z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(z.finds||z.period)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',z.finds&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.finds}</div>`),z.period&&(Y+=`<div class="text-sm text-gray-600 mt-1">Periode: ${z.period}</div>`),z.geology&&(Y+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${z.geology}</div>`)),z.access||z.tips){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',z.access){const $e=z.access.toLowerCase().includes("verboden")||z.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";Y+=`<div class="text-sm ${$e} mt-1">${z.access}</div>`}z.tips&&(Y+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="mineralenHotspot"){const ee=[];if(z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),z.minerals&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.minerals}</div>`,z.geology&&(Y+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${z.geology}</div>`)),z.access||z.tips){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',z.access){const $e=z.access.toLowerCase().includes("verboden")||z.access.toLowerCase().includes("niet toegankelijk")||z.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";Y+=`<div class="text-sm ${$e} mt-1">${z.access}</div>`}z.tips&&(Y+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="goudrivier"){const ee=[];if(z.river&&ee.push(z.river),z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),(z.goldType||z.origin)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',z.goldType&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.goldType}</div>`),z.origin&&(Y+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${z.origin}</div>`)),z.legal||z.tips){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',z.legal){const $e=z.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";Y+=`<div class="text-sm ${$e} mt-1">${z.legal}</div>`}z.tips&&(Y+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="wandelroute"){const ee=[];if(z.region&&ee.push(z.region),z.country){const ge={NL:"Nederland",BE:"Belgi"};ee.push(ge[z.country]||z.country)}if(ee.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${ee.join("  ")}</span>`),z.distance||z.duration){const ge=z.distance?`${z.distance} km`:"",$e=z.duration?`${z.duration}`:"",Je=[ge,$e].filter(Boolean).join("  ");Je&&(Y+=`<br/><span class="text-sm text-green-700 font-medium">${Je}</span>`)}(z.description||z.highlights)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',z.description&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`),z.highlights&&(Y+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${z.highlights}</div>`)),z.startAddress&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.startAddress}</div>`),z.url&&(Y+=`<div class="mt-3"><a href="${z.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(z.layerType==="hunebed"){z.period&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${z.period}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',z.description&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`);const ee=[];if(z.stones){const ge=z.stones.toLowerCase(),$e=ge.match(/(\d+)\s*dekst[^\s,]*/i),Je=ge.match(/(\d+)\s*draagst[^\s,]*/i),Ue=ge.match(/(\d+)\s*sluitst[^\s,]*/i),nt=ge.match(/(\d+)\s*poortst[^\s,]*/i),et=ge.match(/(\d+)\s*gangdekst[^\s,]*/i),Ct=ge.match(/(\d+)\s*gangzijst[^\s,]*/i);$e&&ee.push(`${$e[1]} deksteen${parseInt($e[1])>1?"en":""} (de grote steen${parseInt($e[1])>1?"en":""} bovenop)`),Je&&ee.push(`${Je[1]} draagstenen (de stenen die de dekstenen dragen)`),Ue&&ee.push(`${Ue[1]} sluitsteen${parseInt(Ue[1])>1?"en":""} (afsluiting aan de korte zijden)`),nt&&ee.push(`${nt[1]} poortsteen${parseInt(nt[1])>1?"en":""} (bij de ingang)`),et&&ee.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),Ct&&ee.push(`${Ct[1]} gangzijstenen (langs de toegangsgang)`)}if(z.length&&ee.push(`Een grafkamer van ${z.length} lang`),z.width&&ee.push(`${z.width}`),ee.length>0&&(Y+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',Y+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',ee.forEach(ge=>{Y+=`<li>${ge}</li>`}),Y+="</ul>"),z.notable){const ge=z.notable.toLowerCase();let $e="Wat is hier bijzonder?";ge.includes("grootste")?$e="Waarom is dit het grootste hunebed?":ge.includes("klein")||ge.includes("kindhunebed")?$e="Waarom is dit hunebed zo klein?":ge.includes("cluster")||ge.includes("naast elkaar")?$e="Waarom liggen hier meerdere hunebedden?":(ge.includes("enige")||ge.includes("westelijk")||ge.includes("noordelijk"))&&($e="Wat maakt deze locatie bijzonder?"),Y+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${$e}</span></div>`,Y+=`<div class="text-sm text-gray-700 mt-1">${z.notable}</div>`}Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',z.finds&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.finds}</div>`),z.museum&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.museum}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',z.access?Y+=`<div class="text-sm text-gray-700 mt-1">${z.access}</div>`:Y+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',z.wikipedia&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${z.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((z.inventarisnummer||z.locatie_naam)&&(z.locatie_naam&&(Y+=`<br/><span class="text-sm font-semibold">${z.locatie_naam}</span>`),z.inventarisnummer&&(Y+=`<br/><span class="text-xs text-gray-500">CAI: ${z.inventarisnummer}</span>`),z.datering_tekst&&(Y+=`<br/><span class="text-sm text-purple-700">${z.datering_tekst}</span>`)),(z.veensoort||z.dikte)&&(z.veensoort&&(Y+=`<br/><span class="text-sm text-amber-700">${z.veensoort}</span>`),z.dikte&&(Y+=`<br/><span class="text-xs text-gray-600">Dikte: ${z.dikte}</span>`)),z.nature&&z.debut){Y+=`<br/><span class="text-sm text-purple-700">${z.nature}</span>`;const ee=z.debut===z.fin?z.debut:`${z.debut} - ${z.fin}`;ee&&(Y+=`<br/><span class="text-sm text-gray-700">Periode: ${ee}</span>`),z.structure&&(Y+=`<br/><span class="text-xs text-gray-600">${z.structure}</span>`),z.commune&&(Y+=`<br/><span class="text-xs text-gray-500">${z.commune}</span>`),z.decouvert&&(Y+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${z.decouvert}</span>`),z.numero&&(Y+=`<br/><span class="text-xs text-gray-400">${z.numero}</span>`)}if((z.NATURE_OPE||z.CODE_OPERA)&&(z.TITRE&&(Y+=`<br/><span class="text-sm font-semibold">${z.TITRE}</span>`),z.NATURE_OPE&&(Y+=`<br/><span class="text-sm text-amber-700">${z.NATURE_OPE}</span>`),z.AUTEUR&&(Y+=`<br/><span class="text-xs text-gray-600">Auteur: ${z.AUTEUR}</span>`),z.DATE&&(Y+=`<br/><span class="text-xs text-gray-500">Datum: ${z.DATE}</span>`),z.COMMUNE&&(Y+=`<br/><span class="text-xs text-gray-500">${z.COMMUNE}</span>`)),z.type_protection&&(z.n_site||z.t_site)){const ee=z.type_protection==="Classe"?"text-red-700":"text-amber-700";Y+=`<br/><span class="text-sm ${ee}">${z.type_protection}</span>`,z.n_site&&(Y+=`<br/><span class="text-sm font-semibold">${z.n_site}</span>`),z.t_site&&(Y+=`<br/><span class="text-xs text-gray-600">${z.t_site}</span>`),z.c_site&&(Y+=`<br/><span class="text-xs text-gray-500">Code: ${z.c_site}</span>`),z.d_creation&&(Y+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${z.d_creation}</span>`)}if(z.type_protection&&z.cod_diren){const ee=z.type_protection==="Classe"?"text-red-700":"text-amber-700";if(Y+=`<br/><span class="text-sm ${ee}">${z.type_protection}</span>`,z.proced&&(Y+=`<br/><span class="text-xs text-gray-600">${z.proced}</span>`),z.d_proced&&(Y+=`<br/><span class="text-xs text-gray-500">Date: ${z.d_proced}</span>`),z.comment){const ge=String(z.comment).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${ge}${String(z.comment).length>150?"...":""}</span>`}}if(z.type_protection&&z.nomsite){const ee=z.type_protection==="Classe"?"text-red-700":"text-amber-700";if(Y+=`<br/><span class="text-sm ${ee}">${z.type_protection}</span>`,z.caractere&&(Y+=`<br/><span class="text-xs text-gray-600">${z.caractere}</span>`),z.datedecis&&(Y+=`<br/><span class="text-xs text-gray-500">Date: ${z.datedecis}</span>`),z.descriptio){const ge=String(z.descriptio).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${ge}${String(z.descriptio).length>150?"...":""}</span>`}}if(z.secteur&&z.style){if(Y+=`<br/><span class="text-sm text-gray-700">${z.secteur}</span>`,z["sous-secteur"]&&(Y+=`<br/><span class="text-xs text-gray-600">${z["sous-secteur"]}</span>`),z.description){const ee=String(z.description).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${ee}${String(z.description).length>150?"...":""}</span>`}z.url&&(Y+=`<br/><a href="${z.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(z.nature_operation||z.synthese){z.nature_operation&&(Y+=`<br/><span class="text-sm text-red-700">${z.nature_operation}</span>`),z.responsable_operation&&(Y+=`<br/><span class="text-xs text-gray-600">Responsable: ${z.responsable_operation}</span>`),z.date_operation&&(Y+=`<br/><span class="text-xs text-gray-500">Datum: ${z.date_operation}</span>`);const ee=[];if(z.prehistoire==="Oui"&&ee.push("Prehistorie"),z.protohistoire==="Oui"&&ee.push("Protohistorie"),z.antiquite==="Oui"&&ee.push("Romeins"),z.moyen_age==="Oui"&&ee.push("Middeleeuwen"),z.temps_modernes==="Oui"&&ee.push("Moderne tijd"),ee.length>0&&(Y+=`<br/><span class="text-sm text-purple-700">${ee.join(", ")}</span>`),z.adresse&&(Y+=`<br/><span class="text-xs text-gray-500">${z.adresse}</span>`),z.synthese){const ge=String(z.synthese).slice(0,200);Y+=`<br/><span class="text-xs text-gray-600 italic">${ge}${String(z.synthese).length>200?"...":""}</span>`}}if(z.operator&&(Y+=`<br/><span class="text-sm text-gray-600">${z.operator}</span>`),!ae){if(z.opening_hours){const ee=Soe(String(z.opening_hours));Y+=`<br/><span class="text-xs text-green-600">Open: ${ee}</span>`}z.website&&(Y+=`<br/><a href="${z.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`)}if(z.addr_street){const ee=[z.addr_street,z.addr_housenumber,z.addr_postcode].filter(Boolean).join(" ");Y+=`<br/><span class="text-xs text-gray-500">${ee}</span>`}const ze=z.description||z.omschrijving||z.descr||z.info;ze&&ze!==Et&&(Y+=`<br/><span class="text-sm text-gray-600">${ze}</span>`),On.push(Y),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Y})}const Pn=t.getView().getResolution()||1,Ti=await Yn(Ft.coordinate,Pn);On.push(...Ti);for(const Ie of Ti)Qt.push(null);const He=await Fi;if(On.length===0&&He!==null){const Ie=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${He.toFixed(2)} m NAP</span>
          </div>`;On.push(Ie),Qt.push(null)}if(On.length>0&&He!==null&&(On[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${He.toFixed(2)} m NAP</span>
        </div>`),On.length>0){l(On),ie(Qt),u(0),console.log(` KLIK OPGESLAGEN: [${Ft.coordinate[0].toFixed(0)}, ${Ft.coordinate[1].toFixed(0)}]`),v(Ft.coordinate),b(!1),W(!1),Ae(!1),B(""),pe(null);const Ie=Zn(Ft.coordinate);Se(Ie),N(`https://www.google.com/maps/dir/?api=1&destination=${Ie[1]},${Ie[0]}`),j(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${Ie[1]},${Ie[0]}`),f(!0)}};return t.on("click",cr),()=>{t.un("click",cr)}},[t]);const Si=()=>{f(!1),Te("half"),t&&x&&(QV(t),b(!1))},Rs=(bt,Yn)=>{const cr=Yn.velocity.y,Ft=Yn.offset.y;Ke==="half"?Ft<-50||cr<-500?Te("full"):(Ft>100||cr>500)&&Si():(Ft>50||cr>300)&&Te("half")};return m.jsx(rr,{children:h&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Si}),m.jsxs(Mt.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*ve/100}px`,height:Ke==="full"?"90vh":"auto",maxHeight:Ke==="full"?"90vh":"35vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:Rs,children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white cursor-grab active:cursor-grabbing rounded-t-xl select-none",onClick:()=>Te(Ke==="half"?"full":"half"),children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[Ye&&m.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[m.jsx("button",{onClick:bt=>{bt.stopPropagation(),Un()},className:"p-1 text-white/80 hover:text-white transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:m.jsx(cwe,{size:18})}),m.jsxs("span",{className:"text-white/80 font-medium min-w-[32px] text-center",style:{fontSize:"0.75em"},children:[c+1,"/",a.length]}),m.jsx("button",{onClick:bt=>{bt.stopPropagation(),Xr()},className:"p-1 text-white/80 hover:text-white transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:m.jsx(lb,{size:18})})]}),m.jsx("span",{className:"font-medium text-white truncate",style:{fontSize:"0.9em"},children:fn||"Info"})]}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[Ne&&m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:bt=>{bt.stopPropagation(),W(!V)},className:`p-1 transition-colors flex-shrink-0 border-0 outline-none bg-transparent rounded hover:bg-white/20 ${U?"text-green-300":"text-white/80 hover:text-white"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:U?m.jsx(up,{size:16}):m.jsx(uu,{size:16})}),V&&m.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[m.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),m.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(bt=>!bt.archived).map(bt=>m.jsxs("button",{onClick:()=>{const Yn=le;s(bt.id,{name:fn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ne[0],Ne[1]],sourceLayer:fn,geometry:Yn?.geometry,sourceProperties:Yn?.properties,popupContent:Yn?.popupHtml}),W(!1),pe(bt.name),setTimeout(()=>pe(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:bt.color}}),m.jsx("span",{className:"truncate",children:bt.name})]},bt.id))}),m.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:Oe?m.jsxs("div",{className:"px-2 py-1",children:[m.jsx("input",{type:"text",value:Q,onChange:bt=>B(bt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:bt=>{if(bt.key==="Enter"&&Q.trim()){const Yn=o(Q.trim()),cr=le;s(Yn,{name:fn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ne[0],Ne[1]],sourceLayer:fn,geometry:cr?.geometry,sourceProperties:cr?.properties,popupContent:cr?.popupHtml}),W(!1),Ae(!1),B(""),pe(Q.trim()),setTimeout(()=>pe(null),2e3)}else bt.key==="Escape"&&(Ae(!1),B(""))}}),m.jsxs("div",{className:"flex gap-1 mt-1",children:[m.jsx("button",{onClick:()=>{if(Q.trim()){const bt=o(Q.trim()),Yn=le;s(bt,{name:fn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[Ne[0],Ne[1]],sourceLayer:fn,geometry:Yn?.geometry,sourceProperties:Yn?.properties,popupContent:Yn?.popupHtml}),W(!1),Ae(!1),B(""),pe(Q.trim()),setTimeout(()=>pe(null),2e3)}},disabled:!Q.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),m.jsx("button",{onClick:()=>{Ae(!1),B("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):m.jsxs("button",{onClick:()=>Ae(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),O&&m.jsx("a",{href:O,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:m.jsx(ywe,{size:18})}),C&&m.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",onClick:bt=>bt.stopPropagation(),className:"p-1 text-white/80 hover:text-white transition-colors flex-shrink-0 rounded hover:bg-white/20",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:m.jsx(vg,{size:16})}),m.jsx(dwe,{size:18,className:"text-white/60 mx-1"}),m.jsx("button",{onClick:bt=>{bt.stopPropagation(),Si()},className:"p-1 text-white/80 hover:text-white transition-colors flex-shrink-0 border-0 outline-none bg-transparent rounded hover:bg-white/20","aria-label":"Sluiten",children:m.jsx(fi,{size:16})})]})]}),m.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Ke==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:dt}}),m.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[m.jsx(sH,{size:14,className:"text-gray-400 flex-shrink-0"}),m.jsx("input",{type:"range",min:"80",max:"150",value:ve,onChange:bt=>we(parseInt(bt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[ve,"%"]})]}),$n&&I&&!M&&m.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[m.jsxs("button",{onClick:()=>{const bt=r.find(Yn=>Yn.id===I);bt&&F(bt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(k2,{size:16}),m.jsx("span",{children:"Bewerken"})]}),m.jsxs("button",{onClick:()=>{e(I),f(!1),R(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(wp,{size:16}),m.jsx("span",{children:"Verwijderen"})]})]}),M&&m.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[m.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),m.jsx("input",{type:"text",value:M.objectType,onChange:bt=>F({...M,objectType:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),m.jsx("input",{type:"text",value:M.material,onChange:bt=>F({...M,material:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),m.jsx("input",{type:"text",value:M.period,onChange:bt=>F({...M,period:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),m.jsx("textarea",{value:M.notes,onChange:bt=>F({...M,notes:bt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:()=>F(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),m.jsx("button",{onClick:()=>{n(M.id,{objectType:M.objectType,material:M.material,period:M.period,notes:M.notes}),F(null),f(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),lr&&g&&m.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?m.jsxs("button",{onClick:kr,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(T2,{size:16}),m.jsx("span",{children:"Hoogtekaart verbergen"})]}):m.jsx("button",{onClick:po,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?m.jsxs(m.Fragment,{children:[m.jsx(ZO,{size:16,className:"animate-spin"}),m.jsx("span",{children:"Laden..."})]}):m.jsxs(m.Fragment,{children:[m.jsx(T2,{size:16}),m.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const koe=1e-4;function PEt(t,e){return t.points.some(n=>{const r=Math.abs(n.coordinates[0]-e[0]),i=Math.abs(n.coordinates[1]-e[1]);return r<koe&&i<koe})}function CEt(){const t=$i(j=>j.map),e=ri(j=>j.openVondstForm),{openAddPointModal:n,openCreateLayerModal:r,openLayerManagerModal:i}=ri(),s=Co(j=>j.layers),[o,a]=X.useState(null),[l,c]=X.useState(!1),[u,h]=X.useState(!1),[f,g]=X.useState(!1),v=X.useRef(null),x=X.useRef(null);X.useEffect(()=>{if(!t){console.log(" LongPressMenu: map not ready");return}const j=t.getViewport();if(!j){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",j);const V=600,W=15,U=Ae=>{if(console.log(" Touch start, touches:",Ae.touches.length),Ae.touches.length!==1)return;const Q=Ae.touches[0];x.current={x:Q.clientX,y:Q.clientY},console.log(" Starting long press timer at:",x.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const B=window.__olMap;if(!B){console.log(" Map not available (global)");return}const ne=j.getBoundingClientRect(),ie=[x.current.x-ne.left,x.current.y-ne.top],le=B.getCoordinateFromPixel(ie);if(le){const ve=Zn(le);Ae.preventDefault(),a({pixel:[x.current.x,x.current.y],coordinate:ve}),c(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",ve)}},V)},pe=Ae=>{if(!v.current||!x.current)return;const Q=Ae.touches[0],B=Q.clientX-x.current.x,ne=Q.clientY-x.current.y,ie=Math.sqrt(B*B+ne*ne);ie>W&&(console.log(" Touch moved too much, cancelling. Distance:",ie),clearTimeout(v.current),v.current=null)},Ne=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),x.current=null},Se=Ae=>{l&&Ae.preventDefault()},je=Ae=>{Ae.button===0&&(console.log(" Mouse down"),x.current={x:Ae.clientX,y:Ae.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const Q=window.__olMap;if(console.log(" __olMap:",Q),console.log(" __olMap constructor:",Q?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof Q?.getCoordinateAtPixel),!Q){console.log(" Map not available (global)");return}const B=j.getBoundingClientRect(),ne=[x.current.x-B.left,x.current.y-B.top];console.log(" Pixel:",ne);const ie=Q.getCoordinateFromPixel(ne);if(console.log(" Coordinate:",ie),ie){const le=Zn(ie);a({pixel:[x.current.x,x.current.y],coordinate:le}),c(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",le)}},V))},de=Ae=>{if(!v.current||!x.current)return;const Q=Ae.clientX-x.current.x,B=Ae.clientY-x.current.y;Math.sqrt(Q*Q+B*B)>W&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},Oe=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),x.current=null};return j.addEventListener("touchstart",U,{passive:!1}),j.addEventListener("touchmove",pe,{passive:!0}),j.addEventListener("touchend",Ne),j.addEventListener("touchcancel",Ne),j.addEventListener("contextmenu",Se),j.addEventListener("mousedown",je),j.addEventListener("mousemove",de),j.addEventListener("mouseup",Oe),j.addEventListener("mouseleave",Oe),()=>{j.removeEventListener("touchstart",U),j.removeEventListener("touchmove",pe),j.removeEventListener("touchend",Ne),j.removeEventListener("touchcancel",Ne),j.removeEventListener("contextmenu",Se),j.removeEventListener("mousedown",je),j.removeEventListener("mousemove",de),j.removeEventListener("mouseup",Oe),j.removeEventListener("mouseleave",Oe),v.current&&clearTimeout(v.current)}},[t,l]);const b=()=>{u&&(c(!1),a(null),h(!1),g(!1))},T=()=>{c(!1),a(null),h(!1),g(!1)},A=j=>{if(!o)return;const[V,W]=o.coordinate;n(j,{lat:W,lng:V}),T()},I=()=>{r(),T()},R=()=>{if(!o)return;const[j,V]=o.coordinate;e({lat:V,lng:j}),c(!1),a(null),h(!1)},M=()=>{if(!o)return;const[j,V]=o.coordinate,W=`https://www.google.com/maps?q=${V},${j}`;window.open(W,"_blank"),c(!1),a(null),h(!1)},F=()=>{if(!o)return;const[j,V]=o.coordinate,W=`https://www.google.com/maps?layer=c&cbll=${V},${j}`;window.open(W,"_blank"),T()},C=()=>{if(!o)return;const j=document.createElement("input");j.type="file",j.accept="image/*",j.capture="environment",j.onchange=async V=>{const W=V.target.files?.[0];if(!W)return;const[U,pe]=o.coordinate;e({lat:pe,lng:U},W)},j.click(),T()},N=()=>{i(),T()},O=j=>{const[V,W]=j;return`${W.toFixed(5)}N, ${V.toFixed(5)}E`};return m.jsx(rr,{children:l&&o&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),m.jsxs(Mt.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(o.pixel[0],window.innerWidth-220),top:(()=>{const j=f?480:380;return window.innerHeight-o.pixel[1]<j&&o.pixel[1]>j?o.pixel[1]-j+40:Math.min(o.pixel[1],window.innerHeight-j)})()},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[m.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[m.jsx(fc,{size:16}),m.jsx("span",{className:"text-xs font-mono",children:O(o.coordinate)})]})}),m.jsxs("div",{className:"bg-white",children:[m.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(cN,{size:20,className:"text-orange-500"}),m.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),m.jsxs("button",{onClick:C,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(YO,{size:20,className:"text-green-500"}),m.jsx("span",{className:"font-medium",children:"Foto maken"})]}),m.jsxs("div",{className:"relative",children:[m.jsxs("button",{onClick:()=>g(!f),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(nu,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),m.jsx(lb,{size:16,className:`text-gray-400 transition-transform ${f?"rotate-90":""}`})]}),m.jsx(rr,{children:f&&m.jsx(Mt.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Maak eerst een laag aan"})]}):m.jsxs(m.Fragment,{children:[s.map(j=>{const V=o?PEt(j,o.coordinate):!1;return m.jsxs("button",{onClick:()=>!V&&A(j.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${V?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:V?"Al toegevoegd aan deze laag":void 0,disabled:V,children:[V&&m.jsx(up,{size:14,className:"text-green-500 flex-shrink-0"}),m.jsx("span",{className:"truncate",children:j.name}),m.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:V?"al toegevoegd":`(${j.points.length})`})]},j.id)}),m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),m.jsxs("button",{onClick:N,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(Cct,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),m.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(vg,{size:20,className:"text-blue-600"}),m.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),m.jsxs("button",{onClick:F,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(ywe,{size:20,className:"text-yellow-600"}),m.jsx("span",{className:"font-medium",children:"Street View"})]})]}),m.jsx("div",{className:"bg-white",children:m.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[m.jsx(fi,{size:18}),m.jsx("span",{children:"Annuleren"})]})})]})]})})}const MEt={Compass:glt,TreePalm:eut,Mountain:T2,Waves:hut,Search:fN,Target:Yct,Layers:nu,Grid:hwe},NEt={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},OEt={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},Aoe=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],LEt=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],DEt=[5.2913,52.1326],$Et=8;function jEt(){const t=io(Se=>Se.setLayerVisibility),e=bs(Se=>Se.stopTracking),n=$i(Se=>Se.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=ri(),{presets:o,applyPreset:a,updatePreset:l,createPreset:c,saveAsDefaults:u,resetToDefaults:h,resetToBuiltIn:f}=nF(),g=nF(Se=>Se.customDefaults),v=io(Se=>Se.visible),x=Nn(Se=>Se.presetPanelFontScale),b=Nn(Se=>Se.setPresetPanelFontScale),T=Nn(Se=>Se.showFontSliders),A=12*x/100,[I,R]=X.useState(null),[M,F]=X.useState(!1),[C,N]=X.useState(""),O=()=>{s(),Aoe.forEach(Se=>t(Se,!1)),LEt.forEach(Se=>{t(Se,Se==="CartoDB (licht)")}),e(),n&&n.getView().animate({center:Pi(DEt),zoom:$Et,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},j=Se=>{a(Se),s()},V=(Se,je)=>{Se.stopPropagation();const de=Object.entries(v).filter(([Oe,Ae])=>Ae&&Aoe.includes(Oe)).map(([Oe])=>Oe);l(je,{layers:de}),R(je),setTimeout(()=>R(null),2e3),console.log(" Lagen opgeslagen naar preset")},W=()=>{C.trim()&&(c(C.trim(),"Layers"),N(""),F(!1))},U=()=>{u()},pe=()=>{g?confirm("Presets terugzetten naar je opgeslagen standaard?")&&h():confirm("Presets terugzetten naar originele standaard?")&&h()},Ne=()=>{confirm(`Alle presets resetten naar originele instellingen?
Dit verwijdert ook je opgeslagen standaard.`)&&f()};return m.jsxs(m.Fragment,{children:[m.jsx(Mt.button,{onClick:O,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:m.jsx(xct,{size:20,className:"text-gray-600"})}),m.jsx(Mt.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?m.jsx(XO,{size:20,className:"text-blue-600"}):m.jsx(nu,{size:20,className:"text-blue-600"})}),m.jsx(rr,{children:r&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),m.jsxs(Mt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${A}px`},children:[m.jsx("span",{className:"font-medium text-white",children:"Presets"}),T&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:x,onInput:Se=>{b(parseInt(Se.target.value))},onChange:Se=>b(parseInt(Se.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${x}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),m.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:o.map(Se=>{const je=MEt[Se.icon]||nu,de=NEt[Se.icon]||"text-blue-600",Oe=OEt[Se.icon]||"hover:bg-blue-50",Ae=I===Se.id;return m.jsxs("button",{onClick:()=>j(Se.id),className:`w-full h-8 flex items-center gap-2 px-2 ${Oe} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${Ae?"bg-green-50":""}`,style:{fontSize:`${A}px`},children:[m.jsx(je,{size:14,className:`${de} flex-shrink-0`}),m.jsx("span",{className:"text-gray-700 truncate flex-1",children:Se.name}),Ae?m.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:m.jsx(up,{size:14,className:"text-green-500"})}):m.jsx("span",{onClick:Q=>V(Q,Se.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:m.jsx(xwe,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},Se.id)})}),m.jsx("div",{className:"border-t border-gray-200 p-2 space-y-1",children:M?m.jsxs("div",{className:"flex gap-1",children:[m.jsx("input",{type:"text",value:C,onChange:Se=>N(Se.target.value),onKeyDown:Se=>{Se.key==="Enter"&&W(),Se.key==="Escape"&&F(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${A}px`}}),m.jsx("button",{onClick:W,disabled:!C.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:m.jsx(up,{size:14})})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex gap-1",children:[m.jsxs("button",{onClick:()=>F(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${A}px`},children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe preset"})]}),m.jsx("button",{onClick:U,className:"p-1.5 text-green-500 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Huidige presets opslaan als standaard",children:m.jsx(Qk,{size:14})})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsxs("button",{onClick:pe,className:"flex-1 flex items-center justify-center gap-1 px-2 py-1 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded transition-colors border-0 outline-none",title:g?"Terugzetten naar je opgeslagen standaard":"Terugzetten naar originele standaard",children:[m.jsx(bct,{size:12}),m.jsx("span",{children:g?"Herstel mijn standaard":"Herstel standaard"})]}),g&&m.jsx("button",{onClick:Ne,className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Reset naar originele instellingen",children:m.jsx(_we,{size:12})})]})]})})]})]})})]})}function FEt(){const t=$i(o=>o.map),[e,n]=X.useState(0),[r,i]=X.useState(!1);X.useEffect(()=>{if(!t)return;const o=t.getView(),a=()=>{const l=o.getRotation(),c=l*180/Math.PI;n(c),i(Math.abs(l)>.087)};return a(),o.on("change:rotation",a),()=>{o.un("change:rotation",a)}},[t]);const s=()=>{t&&t.getView().animate({rotation:0,duration:300})};return m.jsx(rr,{children:r&&m.jsx(Mt.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:m.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[m.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),m.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),m.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const VEt=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],zEt={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function UEt(){const[t,e]=X.useState(!1),[n,r]=X.useState(!1),i=io(u=>u.visible),s=io(u=>u.opacity),o=io(u=>u.setLayerOpacity),a=VEt.filter(u=>i[u.name]);if(a.length===0)return null;const l=n?a:a.slice(0,3),c=a.length>3;return m.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[m.jsxs(Mt.button,{onClick:()=>e(!t),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:t?"Sluit opacity sliders":"Open opacity sliders",children:[m.jsx($ct,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&m.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),m.jsxs(Mt.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),m.jsx("div",{className:"space-y-3",children:l.map(u=>{const h=s[u.name]??u.default;return m.jsxs("div",{children:[m.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:u.name,children:u.name}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"range",min:"0",max:"100",value:h*100,onChange:f=>o(u.name,parseInt(f.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${zEt[u.color]}`}),m.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(h*100),"%"]})]})]},u.name)})}),c&&m.jsx("button",{onClick:()=>r(!n),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:n?m.jsxs(m.Fragment,{children:[m.jsx(XO,{size:14}),"Minder tonen"]}):m.jsxs(m.Fragment,{children:[m.jsx(ab,{size:14}),a.length-3," meer..."]})})]})]})})]})}function GEt(){const t=$i(M=>M.map),e=Nn(M=>M.showWeatherButton),[n,r]=X.useState(!1),[i,s]=X.useState(""),[o,a]=X.useState([]),[l,c]=X.useState(!1),[u,h]=X.useState(!1),f=X.useRef(null),g=X.useRef(null),v=X.useRef();X.useEffect(()=>{n&&f.current&&f.current.focus()},[n]),X.useEffect(()=>{if(!n)return;const M=F=>{g.current&&!g.current.contains(F.target)&&x()};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[n]),X.useEffect(()=>{if(!n)return;const M=F=>{F.key==="Escape"&&x()};return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[n]),X.useEffect(()=>{if(v.current&&clearTimeout(v.current),i.length<2){a([]);return}return v.current=window.setTimeout(async()=>{h(!0);try{const F=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();F.response?.docs&&a(F.response.docs)}catch(M){console.error("Search error:",M),a([])}finally{h(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[i]);const x=()=>{r(!1),s(""),a([]),c(!1)},b=async M=>{try{const C=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(M)}`)).json();if(C.response?.docs?.[0]?.centroide_ll){const O=C.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(O)return{lng:parseFloat(O[1]),lat:parseFloat(O[2])}}}catch(F){console.error("Lookup error:",F)}return null},T=async M=>{if(!t)return;const F=await b(M.id);F&&t.getView().animate({center:Pi([F.lng,F.lat]),zoom:16,duration:1e3}),x()},A=async(M,F)=>{F.stopPropagation();const C=await b(M.id);if(C){const N=`https://www.google.com/maps?q=${C.lat},${C.lng}`;window.open(N,"_blank")}x()},I={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(!n)return m.jsx(Mt.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:I,onClick:()=>r(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:m.jsx(fN,{size:22,className:"text-gray-600"})});const R=e?"220px":"52px";return m.jsxs("div",{ref:g,className:"fixed right-14 z-[850]",style:{...I,left:R},children:[m.jsxs(Mt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[m.jsx(fN,{size:18,className:"search-icon"}),m.jsx("input",{ref:f,type:"text",value:i,onChange:M=>{s(M.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),m.jsx("button",{onClick:x,className:"search-clear",title:"Sluiten",children:m.jsx(fi,{size:18})})]}),m.jsx(rr,{children:l&&o.length>0&&m.jsx(Mt.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:o.map(M=>m.jsxs("li",{className:"search-result-item",children:[m.jsx("div",{className:"search-result-content",onClick:()=>T(M),children:m.jsx("span",{className:"search-result-text",children:M.weergavenaam})}),m.jsx("button",{className:"search-navigate-btn",onClick:F=>A(M,F),title:"Open in Google Maps",children:m.jsx(vg,{size:20})})]},M.id))})}),l&&u&&m.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function BEt(){const t=$i(o=>o.map),[e,n]=X.useState(!1);X.useEffect(()=>{if(!t)return;const o=t.getView(),a=()=>{const l=o.getRotation();n(Math.abs(l)>.087)};return a(),o.on("change:rotation",a),()=>{o.un("change:rotation",a)}},[t]);const r=()=>{if(!t)return;const o=t.getView(),a=o.getZoom();a!==void 0&&o.animate({zoom:a+1,duration:200})},i=()=>{if(!t)return;const o=t.getView(),a=o.getZoom();a!==void 0&&o.animate({zoom:a-1,duration:200})},s=e?"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 112px)":"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)";return m.jsxs(Mt.div,{className:"fixed right-2 z-[800] flex flex-col gap-1",style:{top:s},animate:{top:s},transition:{duration:.2},children:[m.jsx(Mt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:r,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:m.jsx(uu,{size:18,className:"text-gray-600"})}),m.jsx(Mt.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:i,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:m.jsx(mwe,{size:18,className:"text-gray-600"})})]})}const WEt="detector2024",iz="detectorapp-auth";function HEt({children:t}){const[e,n]=X.useState(!1),[r,i]=X.useState(""),[s,o]=X.useState(!1),[a,l]=X.useState(""),[c,u]=X.useState(!0);X.useEffect(()=>{localStorage.getItem(iz)==="authenticated"&&n(!0),u(!1)},[]);const h=f=>{f.preventDefault(),l(""),r===WEt?(localStorage.setItem(iz,"authenticated"),n(!0)):(l("Onjuist wachtwoord"),i(""))};return c?m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:m.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?m.jsx(m.Fragment,{children:t}):m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:m.jsxs(Mt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx($V,{size:32,className:"text-blue-600"})}),m.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),m.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),m.jsxs("form",{onSubmit:h,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{type:s?"text":"password",value:r,onChange:f=>i(f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),m.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?m.jsx(uN,{size:20}):m.jsx(hN,{size:20})})]})]}),a&&m.jsx(Mt.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:a}),m.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),m.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function qEt(){localStorage.removeItem(iz),window.location.reload()}function KEt({isOpen:t,onClose:e}){const n=wd(l=>l.vondsten),r={total:n.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:n.slice(-5).reverse()};let i=0,s=0;n.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const o=l=>Object.entries(l).sort((c,u)=>u[1]-c[1]),a=l=>Math.max(...Object.values(l),1);return m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(lwe,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(fi,{size:18})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:n.length===0?m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(fc,{size:48,className:"mx-auto mb-3 opacity-30"}),m.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),m.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[m.jsx($8,{icon:m.jsx(fc,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),m.jsx($8,{icon:m.jsx(eA,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),m.jsx($8,{icon:m.jsx(Act,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),m.jsx(vC,{title:"Per Type",data:o(r.byType),max:a(r.byType),color:"bg-orange-500"}),m.jsx(vC,{title:"Per Periode",data:o(r.byPeriod),max:a(r.byPeriod),color:"bg-amber-500"}),m.jsx(vC,{title:"Per Materiaal",data:o(r.byMaterial),max:a(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&m.jsx(vC,{title:"Per Conditie",data:o(r.byCondition),max:a(r.byCondition),color:"bg-green-500"}),m.jsxs("div",{children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[m.jsx(eH,{size:14}),"Recente Vondsten"]}),m.jsx("div",{className:"space-y-2",children:r.recent.map(l=>m.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),m.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),m.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),m.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function $8({icon:t,value:e,label:n,color:r}){return m.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[m.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:t}),m.jsx("div",{className:"text-xl font-bold",children:e}),m.jsx("div",{className:"text-xs opacity-70",children:n})]})}function vC({title:t,data:e,max:n,color:r}){return e.length===0?null:m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:t}),m.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),m.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:m.jsx(Mt.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/n*100}%`},transition:{duration:.5,ease:"easeOut"}})}),m.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function YEt(t){const{type:e,coordinates:n}=t,r=a=>Pi(a),i=a=>a.map(r),s=a=>a.map(i),o=a=>a.map(s);switch(e){case"Point":return new Vs(r(n));case"LineString":return new ro(i(n));case"Polygon":return new ou(s(n));case"MultiPoint":return new X1(i(n));case"MultiLineString":return new np(s(n));case"MultiPolygon":return new p1(o(n));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function XEt(t,e,n){const r=t.color,i=10,s=5,o=14;let a=i;if(n>50?a=s:n>10?a=Math.max(s,i-(n-10)/10):n<2&&(a=o),e==="Point"||e==="MultiPoint")return new zn({image:new ja({radius:a,fill:new Nr({color:r}),stroke:new Sr({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new zn({stroke:new Sr({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=ZEt(r,.3);return new zn({fill:new Nr({color:l}),stroke:new Sr({color:r,width:2})})}return new zn({image:new ja({radius:a,fill:new Nr({color:r}),stroke:new Sr({color:"#ffffff",width:2})})})}function ZEt(t,e){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(n){const r=parseInt(n[1],16),i=parseInt(n[2],16),s=parseInt(n[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return t}function JEt(){const t=$i(r=>r.map),e=KA(r=>r.layers),n=X.useRef(new Map);return X.useEffect(()=>{if(!t)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new Od;i.features.features.forEach((a,l)=>{if(!a.geometry)return;const c=YEt(a.geometry);if(!c)return;const u=new xi({geometry:c,...a.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});u.setStyle((h,f)=>XEt(i,a.geometry.type,f)),s.addFeature(u)});const o=n.current.get(i.id);if(o)o.setSource(s),o.setVisible(i.visible),o.setOpacity(i.opacity);else{const a=new gp({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});t.addLayer(a),n.current.set(i.id,a)}}),n.current.forEach((i,s)=>{r.has(s)||(t.removeLayer(i),n.current.delete(s))})},[t,e]),X.useEffect(()=>()=>{t&&(n.current.forEach(r=>{t.removeLayer(r)}),n.current.clear())},[t]),null}sr.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");E2e(sr);function QEt(t){if(!t||t.length<2)return"unknown";const[e,n]=t;return e>=7e3&&e<=3e5&&n>=289e3&&n<=629e3?"RD":Math.abs(e)<=180&&Math.abs(n)<=90?"WGS84":"unknown"}function eSt(t){const[e,n]=t;return sr("EPSG:28992","EPSG:4326",[e,n])}function iEe(t,e){return typeof t[0]=="number"?e(t):t.map(n=>iEe(n,e))}function tSt(t){const e=t.coordinates;return!e||Array.isArray(e)&&e.length===0?null:t.type==="Point"?e:t.type==="LineString"||t.type==="MultiPoint"?e[0]:t.type==="Polygon"||t.type==="MultiLineString"?e[0]?.[0]:t.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function nSt(t){const e=[],n=[];try{const r=await t.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,u)=>({type:"Feature",geometry:c,properties:{id:u}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&n.push("Geen features gevonden in bestand");let o="unknown",a=!1;if(s.length>0&&s[0].geometry){const c=tSt(s[0].geometry);c&&(o=QEt(c))}o==="RD"&&(n.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),a=!0,s=s.map(c=>{if(!c.geometry)return c;const u=iEe(c.geometry.coordinates,eSt);return{...c,geometry:{...c.geometry,coordinates:u}}}),o="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:n,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:o,transformed:a}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function rSt(t){const e=[],n=[];try{const r=await t.text(),s=new i0t({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&n.push("Geen features gevonden in KML bestand");const l=new eL().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((u,h)=>{const f={...u.properties},g=f.name||f.Name||`Feature ${h+1}`,v=f.description||f.Description||"";return{type:"Feature",geometry:u.geometry,properties:{...f,name:g,description:v}}}),c=[...new Set(l.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:n,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function iSt(t){const e=[],n=[];try{const r=await t.text(),s=new vgt().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&n.push("Geen features gevonden in GPX bestand");const l=new eL().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((u,h)=>{const f={...u.properties},g=f.name||f.Name||`Waypoint ${h+1}`,v=f.desc||f.description||"",x=f.time||null,b=f.ele||null;return{type:"Feature",geometry:u.geometry,properties:{...f,name:g,description:v,time:x,elevation:b}}}),c=[...new Set(l.filter(u=>u.geometry).map(u=>u.geometry.type))];return c.includes("LineString")&&n.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:n,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function KH(t){switch(t.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function sSt(){return".geojson,.json,.kml,.gpx"}function YH(){return"GeoJSON, KML (Google My Maps), GPX"}async function oSt(t){switch(KH(t.name)){case"geojson":return nSt(t);case"kml":return rSt(t);case"gpx":return iSt(t);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${t.name}. Ondersteunde formaten: ${YH()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function aSt(t){return t.size>10485760?{valid:!1,error:`Bestand te groot (${(t.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:KH(t.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${YH()}`}:t.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function lSt({isOpen:t,onClose:e}){const n=KA(N=>N.addLayer),r=X.useRef(null),[i,s]=X.useState("idle"),[o,a]=X.useState(null),[l,c]=X.useState(null),[u,h]=X.useState(""),[f,g]=X.useState(null),[v,x]=X.useState(!1),b=X.useCallback(()=>{s("idle"),a(null),c(null),h(""),g(null),r.current&&(r.current.value="")},[]),T=X.useCallback(()=>{b(),e()},[b,e]),A=X.useCallback(async N=>{const O=aSt(N);if(!O.valid){g(O.error||"Ongeldig bestand"),s("error");return}a(N),s("parsing"),g(null);const j=N.name.replace(/\.[^/.]+$/,"");h(j);try{const V=await oSt(N);if(!V.success){g(V.errors.join(`
`)),s("error");return}if(V.features.features.length===0){g("Geen features gevonden in het bestand"),s("error");return}c(V),s("preview")}catch(V){g(V instanceof Error?V.message:"Onbekende fout bij parsen"),s("error")}},[]),I=X.useCallback(N=>{const O=N.target.files?.[0];O&&A(O)},[A]),R=X.useCallback(N=>{N.preventDefault(),x(!0)},[]),M=X.useCallback(N=>{N.preventDefault(),x(!1)},[]),F=X.useCallback(N=>{N.preventDefault(),x(!1);const O=N.dataTransfer.files?.[0];O&&A(O)},[A]),C=X.useCallback(()=>{if(!l||!u.trim())return;const N=o?KH(o.name):"geojson";n({name:u.trim(),type:N==="unsupported"?"geojson":N,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:o?.name||"unknown"}),T()},[l,u,o,n,T]);return m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(II,{size:18}),m.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),m.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(fi,{size:18})})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:R,onDragLeave:M,onDrop:F,children:[m.jsx(nH,{size:40,className:"mx-auto text-gray-400 mb-3"}),m.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),m.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),m.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),m.jsx("input",{ref:r,type:"file",accept:sSt(),onChange:I,className:"hidden"})]}),m.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[m.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),m.jsx("p",{children:YH()})]})]}),i==="parsing"&&m.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[m.jsx(ZO,{size:40,className:"text-purple-500 animate-spin mb-4"}),m.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),m.jsx("p",{className:"text-gray-400 text-sm",children:o?.name})]}),i==="error"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[m.jsx(uwe,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),m.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:f})]})]}),m.jsx("button",{onClick:b,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[m.jsx(tlt,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),m.jsx("p",{className:"text-sm text-green-600",children:o?.name})]})]}),l.warnings.length>0&&m.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[m.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),m.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((N,O)=>m.jsx("li",{children:N},O))})]}),m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Features:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Types:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),m.jsx("input",{type:"text",value:u,onChange:N=>h(N.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[m.jsx("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),m.jsx("button",{onClick:C,disabled:!u.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function cSt(){const{user:t,loading:e,error:n,signInWithGoogle:r,logout:i,initAuth:s}=B5();return X.useEffect(()=>{s()},[s]),e?m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[m.jsx(hp,{size:16,className:"animate-pulse"}),m.jsx("span",{className:"text-sm",children:"Laden..."})]}):t?m.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[t.photoURL?m.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:m.jsx(oH,{size:16,className:"text-green-600"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:t.displayName||t.email}),m.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[m.jsx(hp,{size:12}),"Cloud sync actief"]})]}),m.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(iH,{size:16})})]}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[m.jsx(llt,{size:16}),m.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),m.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),m.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),n&&m.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:n})]})}const uSt="https://forms.gle/R5LCk11Bzu5XrkBj8";function hSt(){const{settingsPanelOpen:t,toggleSettingsPanel:e,vondstDashboardOpen:n,toggleVondstDashboard:r,openLayerManagerModal:i}=ri(),s=Nn(),{presets:o,createPreset:a,deletePreset:l,updatePreset:c}=nF(),u=wd(ne=>ne.vondsten),h=KA(ne=>ne.layers),{layers:f,updateLayer:g}=Co(),{devMode:v,setDevMode:x,tier:b}=cG(),[T,A]=X.useState(""),[I,R]=X.useState(!1),[M,F]=X.useState(!1),[C,N]=X.useState(null),[O,j]=X.useState(""),[V,W]=X.useState(null),[U,pe]=X.useState(""),[Ne,Se]=X.useState("algemeen"),je=14*s.fontScale/100,de=()=>{T.trim()&&(a(T.trim(),"Layers"),A(""),R(!1))},Oe=(ne,ie)=>{N(ne),j(ie)},Ae=ne=>{O.trim()&&(c(ne,{name:O.trim()}),console.log(` Preset hernoemd naar "${O.trim()}"`)),N(null),j("")},Q=()=>{N(null),j("")},B=[{id:"algemeen",label:"Algemeen",icon:m.jsx(Fct,{size:14})},{id:"lagen",label:"Lagen",icon:m.jsx(nu,{size:14})},{id:"vondsten",label:"Vondsten",icon:m.jsx(fc,{size:14})}];return m.jsxs(m.Fragment,{children:[m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${je}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(jV,{size:18,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:ne=>{s.setFontScale(parseInt(ne.target.value))},onChange:ne=>s.setFontScale(parseInt(ne.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:m.jsx(fi,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:B.map(ne=>m.jsxs("button",{onClick:()=>Se(ne.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${Ne===ne.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[ne.icon,ne.label]},ne.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${je}px`},children:[Ne==="algemeen"&&m.jsxs(m.Fragment,{children:[m.jsx(Lh,{title:"Account",icon:m.jsx(oH,{size:16}),children:m.jsx(cSt,{})}),m.jsxs(Lh,{title:"Kaart",icon:m.jsx(JO,{size:16}),children:[m.jsx(dSt,{label:"Standaard achtergrond",children:m.jsxs("select",{value:s.defaultBackground,onChange:ne=>s.setDefaultBackground(ne.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),m.jsx("option",{value:"OpenStreetMap",children:"OSM"}),m.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),m.jsx(D0,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),m.jsxs(Lh,{title:"GPS",icon:m.jsx(cb,{size:16}),children:[m.jsx(D0,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),m.jsx(D0,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),m.jsxs(Lh,{title:"Feedback",icon:m.jsx(zct,{size:16}),children:[m.jsx(D0,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),m.jsx(D0,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&m.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[m.jsx(cut,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),m.jsxs(Lh,{title:"Weer",icon:m.jsx(hp,{size:16}),children:[m.jsx(D0,{label:"Weerwidget tonen",checked:s.showWeatherButton,onChange:s.setShowWeatherButton}),m.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Actueel weer, voorspelling en buienradar"})]}),m.jsxs(Lh,{title:"Development",icon:m.jsx(plt,{size:16}),children:[m.jsx(D0,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:x}),m.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",m.jsx("span",{className:"font-medium text-blue-600",children:b}),v&&m.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),Ne==="lagen"&&m.jsxs(m.Fragment,{children:[m.jsx(Lh,{title:"Mijn lagen",icon:m.jsx(nu,{size:16}),isOwn:!0,children:m.jsxs("div",{className:"space-y-1",children:[f.filter(ne=>!ne.archived).length===0?m.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):f.filter(ne=>!ne.archived).map(ne=>m.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:V===ne.id?m.jsx("input",{type:"text",value:U,onChange:ie=>pe(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"?(U.trim()&&g(ne.id,{name:U.trim()}),W(null)):ie.key==="Escape"&&W(null)},onBlur:()=>{U.trim()&&g(ne.id,{name:U.trim()}),W(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:ne.name}),m.jsxs("span",{className:"text-xs text-gray-400",children:[ne.points.length," punten"]}),m.jsx("button",{onClick:()=>{W(ne.id),pe(ne.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:m.jsx(k2,{size:12})})]})},ne.id)),m.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(jV,{size:14}),m.jsx("span",{children:"Lagen beheren"})]})]})}),m.jsx(Lh,{title:"Lagen importeren",icon:m.jsx(II,{size:16}),children:m.jsxs("div",{className:"space-y-1",children:[h.length>0&&m.jsxs(m.Fragment,{children:[h.map(ne=>m.jsx(wwe,{layer:ne},ne.id)),m.jsx("div",{className:"border-t border-gray-100 my-2"})]}),m.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe laag importeren"})]}),m.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),m.jsx(Lh,{title:"Presets",icon:m.jsx(nu,{size:16}),children:m.jsxs("div",{className:"space-y-2",children:[o.map(ne=>m.jsx("div",{className:"flex items-center justify-between py-1",children:C===ne.id?m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("input",{type:"text",value:O,onChange:ie=>j(ie.target.value),onKeyDown:ie=>{ie.key==="Enter"&&Ae(ne.id),ie.key==="Escape"&&Q()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),m.jsx("button",{onClick:()=>Ae(ne.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),m.jsx("button",{onClick:Q,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[ne.name,ne.isBuiltIn&&m.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),m.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",ne.layers.length," lagen)"]})]}),!ne.isBuiltIn&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>Oe(ne.id,ne.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(k2,{size:14})}),m.jsx("button",{onClick:()=>l(ne.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(wp,{size:14})})]})]})},ne.id)),I?m.jsxs("div",{className:"flex gap-2 mt-2",children:[m.jsx("input",{type:"text",value:T,onChange:ne=>A(ne.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:ne=>ne.key==="Enter"&&de(),autoFocus:!0}),m.jsx("button",{onClick:de,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),m.jsx("button",{onClick:()=>R(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):m.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),Ne==="vondsten"&&m.jsx(m.Fragment,{children:m.jsxs(Lh,{title:"Vondsten",icon:m.jsx(fc,{size:16}),isOwn:!0,children:[m.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),m.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(lwe,{size:14}),m.jsxs("span",{children:["Dashboard (",u.length," vondsten)"]})]}),m.jsx(fSt,{})]})})]}),m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${je}px`},children:[m.jsxs("a",{href:uSt,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(awe,{size:16}),m.jsx("span",{children:"Meld een bug"})]}),m.jsxs("button",{onClick:qEt,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(iH,{size:16}),m.jsx("span",{children:"Uitloggen"})]}),m.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),m.jsx(KEt,{isOpen:n,onClose:r}),m.jsx(lSt,{isOpen:M,onClose:()=>F(!1)})]})}function Lh({title:t,icon:e,children:n,isOwn:r}){return m.jsxs("section",{children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[m.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),m.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:t})]}),m.jsx("div",{className:"space-y-2",children:n})]})}function dSt({label:t,children:e}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:t}),e]})}function D0({label:t,checked:e,onChange:n}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:t}),m.jsx("button",{onClick:()=>n(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function fSt(){const[t,e]=X.useState(!1),{vondsten:n,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:o,exportAsKML:a}=wd(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:o,desc:"GPS apparaten"},{label:"KML",action:a,desc:"Google Earth"}],c=u=>{u(),e(!1)};return n.length===0?m.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[m.jsx(Qk,{size:14}),m.jsx("span",{children:"Geen vondsten om te exporteren"})]}):m.jsxs("div",{className:"relative mt-2",children:[m.jsxs("button",{onClick:()=>e(!t),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Qk,{size:14}),m.jsxs("span",{children:["Exporteer vondsten (",n.length,")"]})]}),m.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),t&&m.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((u,h)=>m.jsxs("button",{onClick:()=>c(u.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[m.jsx("span",{className:"text-gray-700",children:u.label}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:u.desc})]},h))})]})}const UN="2.32.19";function pSt({size:t=18}){return m.jsxs("svg",{viewBox:"0 0 24 24",width:t,height:t,children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function mSt(){const[t,e]=X.useState(!1),{user:n,loading:r,signInWithGoogle:i,logout:s}=B5(),{toggleInfoPanel:o,toggleSettingsPanel:a,toggleMonumentSearch:l}=ri(),c=Nn(U=>U.menuFontScale),u=Nn(U=>U.setMenuFontScale),h=Nn(U=>U.showFontSliders),f=Nn(U=>U.setShowFontSliders),g=Nn(U=>U.showVondstButton),v=Nn(U=>U.setShowVondstButton),x=Nn(U=>U.showRouteRecordButton),b=Nn(U=>U.setShowRouteRecordButton),T=Nn(U=>U.showCustomPointLayers),A=Nn(U=>U.setShowCustomPointLayers),I=Nn(U=>U.showWeatherButton),R=Nn(U=>U.setShowWeatherButton),M={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},F=()=>e(!1),C=()=>{F(),o()},N=()=>{F(),a()},O=()=>{F(),l()},j=()=>{F(),i()},V=()=>{F(),s()},W=13*c/100;return m.jsxs(m.Fragment,{children:[m.jsx(Mt.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${t?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:M,onClick:()=>e(!t),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:t?m.jsx(fi,{size:22,className:"text-white"}):m.jsx(ict,{size:22,className:"text-gray-600"})}),m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:F}),m.jsxs(Mt.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${W}px`},children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[m.jsx("span",{className:"font-medium text-white",style:{fontSize:`${W}px`},children:"Menu"}),h&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:c,onInput:U=>u(parseInt(U.target.value)),onChange:U=>u(parseInt(U.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${c}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?m.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:m.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):n?m.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?m.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:m.jsx(oH,{size:16,className:"text-white"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:n.displayName||"Gebruiker"}),m.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),m.jsx("button",{onClick:V,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(iH,{size:16})})]})}):m.jsxs("button",{onClick:j,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[m.jsx(pSt,{size:18}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),m.jsxs("div",{className:"py-1",children:[m.jsxs("button",{onClick:C,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[m.jsx(rH,{size:18,className:"text-blue-500"}),m.jsx("span",{children:"Info & handleiding"})]}),m.jsxs("button",{onClick:O,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-purple-50",style:{fontSize:"0.95em"},children:[m.jsx(fwe,{size:18,className:"text-purple-500"}),m.jsx("span",{children:"Zoek in monumenten"})]})]}),m.jsxs("div",{className:"py-1 border-t border-gray-100",children:[m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(fc,{size:18,className:"text-orange-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Vondst knop"})]}),m.jsx("button",{onClick:()=>v(!g),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${g?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${g?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(dN,{size:18,className:"text-green-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Route knop"})]}),m.jsx("button",{onClick:()=>b(!x),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${x?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${x?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(hp,{size:18,className:"text-cyan-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Weerwidget"})]}),m.jsx("button",{onClick:()=>R(!I),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${I?"bg-gradient-to-r from-cyan-500 to-cyan-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${I?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(nu,{size:18,className:"text-amber-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Mijn lagen"})]}),m.jsx("button",{onClick:()=>A(!T),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${T?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${T?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(sH,{size:18,className:"text-purple-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Tekstgrootte"})]}),m.jsx("button",{onClick:()=>f(!h),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${h?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${h?"left-[22px]":"left-0.5"}`})})]})]}),m.jsx("div",{className:"mt-auto border-t border-gray-100",children:m.jsxs("button",{onClick:N,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[m.jsx(jV,{size:18,className:"text-gray-500"}),m.jsx("span",{children:"Instellingen"})]})}),m.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",UN]})]})]})})]})}const gSt="https://forms.gle/R5LCk11Bzu5XrkBj8";function ySt(){const{infoPanelOpen:t,toggleInfoPanel:e}=ri(),[n,r]=X.useState("info"),i=[{id:"info",label:"Info",icon:m.jsx(rH,{size:14})},{id:"functies",label:"Functies",icon:m.jsx(nH,{size:14})},{id:"handleiding",label:"Handleiding",icon:m.jsx(Gat,{size:14})}];return m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[m.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",UN]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:m.jsx(fi,{size:18,className:"text-white",strokeWidth:2.5})})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>m.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${n===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[n==="info"&&m.jsx(vSt,{}),n==="functies"&&m.jsx(_St,{}),n==="handleiding"&&m.jsx(xSt,{}),m.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[m.jsxs("a",{href:gSt,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[m.jsx(awe,{size:14}),m.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),m.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",UN," - Gratis en zonder tracking"]})]})]})]})]})})}function vSt(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),m.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),m.jsxs("ul",{className:"space-y-2 text-gray-600",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Mindat.org"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Paleontica / Fossielen data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Map5.nl / Kadaster"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciale data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),m.jsx("p",{children:m.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),m.jsx("li",{children:"Je vondsten registraties"}),m.jsx("li",{children:"Je preset-instellingen"})]}),m.jsx("p",{children:m.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),m.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),m.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),m.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),m.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),m.jsx("p",{children:m.jsx("strong",{children:"Beschikbaar zonder login:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),m.jsx("li",{children:"GPS tracking en navigatie"}),m.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),m.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),m.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),m.jsx("li",{children:"Lagen importeren"}),m.jsx("li",{children:"Alle presets en instellingen"})]}),m.jsx("p",{children:m.jsx("strong",{children:"Alleen met login:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Synchronisatie tussen apparaten"}),m.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function _St(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(JO,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Flt,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Clt,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(hp,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(cb,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),m.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),m.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),m.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),m.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),m.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(fc,{size:16,className:"text-orange-600"}),"Vondsten"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),m.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),m.jsx("li",{children:"Foto's toevoegen (link of upload)"}),m.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),m.jsx("li",{children:"Dashboard met statistieken"}),m.jsx("li",{children:"Cloud sync met Google account"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(nu,{size:16,className:"text-purple-600"}),"Presets"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(lct,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),m.jsx("li",{children:"Oppervlakte in m en hectare"}),m.jsx("li",{children:"Gewas en bouwplan met uitleg"}),m.jsx("li",{children:"Bodemtype met beschrijving"}),m.jsx("li",{children:"AHN hoogte in meters NAP"}),m.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),m.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Lct,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function xSt(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),m.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[m.jsxs("li",{children:["Tik op de ",m.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),m.jsxs("li",{children:["Kies een ",m.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),m.jsxs("li",{children:["Of open ",m.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),m.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsx("p",{children:"Rechtsboven vind je het menu met:"}),m.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"})," Tik op de ",m.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),m.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),m.jsxs("li",{children:["Combineer ",m.jsx("strong",{children:"AMK"})," met ",m.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),m.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),m.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),m.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(vg,{size:16,className:"text-blue-600"}),"Handige links"]}),m.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("li",{children:[m.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function sEe(t,e,n,r){const s=(r-e)*Math.PI/180,o=(n-t)*Math.PI/180,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}function j8(t){let e=0;for(let n=1;n<t.length;n++)e+=sEe(t[n-1].coordinates[0],t[n-1].coordinates[1],t[n].coordinates[0],t[n].coordinates[1]);return e}const wl=ho()(dh((t,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{t({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:n}=e();n==="recording"&&t({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:n,pauseStartTime:r,totalPausedTime:i}=e();if(n!=="paused"||!r)return;const s=Date.now()-r;t({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:n=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:o,pauseStartTime:a}=e();if(r==="idle"||!s||i.length<2)return t({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=o;a&&(c+=l-a);const u=l-s-c,h=j8(i),f={id:crypto.randomUUID(),name:n||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:h,totalDuration:u,pausedDuration:c,createdAt:new Date().toISOString()};return t(g=>{const v=new Set(g.visibleRouteIds);return v.add(f.id),{state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[f,...g.savedRoutes],visibleRouteIds:v}}),f},cancelRecording:()=>{t({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(n,r,i)=>{const{state:s,currentPoints:o}=e();if(s!=="recording")return;if(o.length>0){const l=o[o.length-1];if(sEe(l.coordinates[0],l.coordinates[1],n,r)<2)return}const a={coordinates:[n,r],timestamp:Date.now(),accuracy:i};t({currentPoints:[...o,a]})},deleteRoute:n=>{t(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==n)}))},renameRoute:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,name:r}:s)}))},clearAllRoutes:()=>{t({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.has(n)?i.delete(n):i.add(n),{visibleRouteIds:i}})},showRoute:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.add(n),{visibleRouteIds:i}})},hideRoute:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.delete(n),{visibleRouteIds:i}})},showAllRoutes:()=>{t(n=>({visibleRouteIds:new Set(n.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{t({visibleRouteIds:new Set})},toggleHeatmap:()=>{t(n=>({heatmapEnabled:!n.heatmapEnabled}))},setHeatmapEnabled:n=>{t({heatmapEnabled:n})},toggleGrid:()=>{t(n=>({gridEnabled:!n.gridEnabled}))},setGridEnabled:n=>{t({gridEnabled:n})},setGridCenter:n=>{t({gridCenter:n})},setGridSize:n=>{t({gridSize:n})},setGridCount:n=>{t({gridCount:n})},setGridColor:n=>{t({gridColor:n})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(n=>{t({gridCenter:[n.coords.longitude,n.coords.latitude],gridEnabled:!0})},n=>{console.error("Could not get location:",n)})},setAutoPauseEnabled:n=>{t({autoPauseEnabled:n})},setAutoPauseSeconds:n=>{t({autoPauseSeconds:n})},importRouteFromGPX:(n,r)=>{try{const s=new DOMParser().parseFromString(n,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const a=s.querySelectorAll("trkpt");if(a.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((a.length>0?a:s.querySelectorAll("wpt")).forEach(b=>{const T=parseFloat(b.getAttribute("lat")||"0"),A=parseFloat(b.getAttribute("lon")||"0"),I=b.querySelector("time"),R=I?new Date(I.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(A)&&l.push({coordinates:[A,T],timestamp:isNaN(R)?Date.now():R})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const u=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,h=j8(l),f=l[0].timestamp,g=l[l.length-1].timestamp,v=g-f,x={id:crypto.randomUUID(),name:u,points:l,startTime:f,endTime:g,totalDistance:h,totalDuration:v>0?v:0,pausedDuration:0,createdAt:new Date().toISOString()};return t(b=>{const T=new Set(b.visibleRouteIds);return T.add(x.id),{savedRoutes:[x,...b.savedRoutes],visibleRouteIds:T}}),{success:!0,routeId:x.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,notes:r}:s)}))},addPhotoToRoute:(n,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};t(s=>({savedRoutes:s.savedRoutes.map(o=>o.id===n?{...o,photos:[...o.photos||[],i]}:o)}))},removePhotoFromRoute:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,photos:(s.photos||[]).filter(o=>o.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:n}=e();return j8(n)},getCurrentDuration:()=>{const{state:n,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const o=Date.now();let a=i;return n==="paused"&&s&&(a+=o-s),o-r-a},getAverageSpeed:()=>{const n=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:n/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:t=>({savedRoutes:t.savedRoutes,visibleRouteIds:Array.from(t.visibleRouteIds),heatmapEnabled:t.heatmapEnabled,gridEnabled:t.gridEnabled,gridCenter:t.gridCenter,gridSize:t.gridSize,gridCount:t.gridCount,gridColor:t.gridColor,autoPauseEnabled:t.autoPauseEnabled,autoPauseSeconds:t.autoPauseSeconds}),merge:(t,e)=>({...e,...t,visibleRouteIds:new Set(t?.visibleRouteIds||[])})}));function oEe(t){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${t.name}</name>
    <time>${new Date(t.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${t.name}</name>
    <trkseg>
${t.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,n=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`${t.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let sg=null,zT=null;function aEe(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;sg=window.speechSynthesis;const t=()=>{const e=sg?.getVoices()||[];zT=e.find(n=>n.lang.startsWith("nl")||n.name.toLowerCase().includes("dutch")||n.name.toLowerCase().includes("nederland"))||null,!zT&&e.length>0&&(zT=e[0])};return t(),sg&&(sg.onvoiceschanged=t),!0}function wSt(t,e){if(!sg&&!aEe()||!sg)return;sg.cancel();const n=new SpeechSynthesisUtterance(t);zT&&(n.voice=zT),n.lang="nl-NL",n.rate=e?.rate,n.pitch=e?.pitch??1,n.volume=e?.volume??1,sg.speak(n)}function bSt(t){const e=[];e.push(`${t.type} toegevoegd`),t.material&&t.material!=="Onbekend"&&e.push(`Materiaal: ${t.material}`),t.period&&t.period!=="Onbekend"&&e.push(`Periode: ${t.period}`),t.layerName&&t.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${t.layerName}`);const n=e.join(". ");wSt(n,{rate:1.1})}aEe();const ESt="detectorapp-photos",SSt=1,GN="photos",TSt=1024,kSt=200,ASt=.8,ISt=.7;function RSt(){return new Promise((t,e)=>{const n=indexedDB.open(ESt,SSt);n.onerror=()=>e(n.error),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(GN)||i.createObjectStore(GN,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1})}})}async function Ioe(t,e,n){return new Promise((r,i)=>{const s=new Image,o=URL.createObjectURL(t);s.onload=()=>{URL.revokeObjectURL(o);let{width:a,height:l}=s;(a>e||l>e)&&(a>l?(l=Math.round(l*e/a),a=e):(a=Math.round(a*e/l),l=e));const c=document.createElement("canvas");c.width=a,c.height=l;const u=c.getContext("2d");if(!u){i(new Error("Could not get canvas context"));return}u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.drawImage(s,0,0,a,l),c.toBlob(h=>{h?r({blob:h,width:a,height:l}):i(new Error("Could not create blob"))},"image/jpeg",n)},s.onerror=()=>{URL.revokeObjectURL(o),i(new Error("Could not load image"))},s.src=o})}async function PSt(t,e){const{blob:n,width:r,height:i}=await Ioe(e,TSt,ASt),{blob:s}=await Ioe(e,kSt,ISt),o={id:t,fullImage:n,thumbnail:s,originalName:e.name,mimeType:"image/jpeg",width:r,height:i,size:n.size,createdAt:new Date().toISOString()},a=await RSt();return new Promise((l,c)=>{const u=a.transaction(GN,"readwrite"),f=u.objectStore(GN).put(o);f.onsuccess=()=>l(o),f.onerror=()=>c(f.error),u.oncomplete=()=>a.close()})}function F8({label:t,value:e,onChange:n,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[o,a]=X.useState(!1),[l,c]=X.useState(!1),[u,h]=X.useState(""),f=e&&!r.includes(e),g=()=>{c(!0),h(f?e:""),a(!1)},v=()=>{u.trim()&&n(u.trim()),c(!1)};return l?m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[t,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:u,onChange:x=>h(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),v()),x.key==="Escape"&&c(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):m.jsxs("div",{className:"relative",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[t,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsxs("button",{type:"button",onClick:()=>a(!o),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[m.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",f&&m.jsx(ase,{size:12,className:"inline ml-1 text-orange-500"})]}),m.jsx(ab,{size:16,className:`text-gray-400 transition-transform ${o?"rotate-180":""}`})]}),o&&m.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[m.jsxs("button",{type:"button",onClick:g,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[m.jsx(ase,{size:12}),"Eigen invoer..."]}),m.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>m.jsx("button",{type:"button",onClick:()=>{n(x),a(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function lEe({onClose:t,initialLocation:e}){const n=bs(Ye=>Ye.position),r=$i(Ye=>Ye.map),i=ri(Ye=>Ye.vondstFormPhoto),s=Co(Ye=>Ye.layers),o=Co(Ye=>Ye.addPoint);Co(Ye=>Ye.addPhotoToPoint);const a=Nn(Ye=>Ye.voiceFeedbackEnabled),l=wl(Ye=>Ye.state),c=wl(Ye=>Ye.startTime);wl(Ye=>Ye.savedRoutes);const u=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,h=l==="recording"||l==="paused",f=u(),[g,v]=X.useState(""),[x,b]=X.useState(""),[T,A]=X.useState(""),[I,R]=X.useState(""),[M,F]=X.useState(!1),[C,N]=X.useState(void 0),[O,j]=X.useState(void 0),[V,W]=X.useState(Uc),[U,pe]=X.useState(i),[Ne,Se]=X.useState(null);X.useEffect(()=>{if(U){const Ye=URL.createObjectURL(U);return Se(Ye),()=>URL.revokeObjectURL(Ye)}else Se(null)},[U]);const[je,de]=X.useState(e?"map-pick":n?"gps":"map-center"),[Oe,Ae]=X.useState(e||null),[Q,B]=X.useState(!1),ne=()=>{if(je==="gps"&&n)return{lat:n.lat,lng:n.lng};if(je==="map-pick"&&Oe)return Oe;if(r){const Ye=r.getView().getCenter();if(Ye){const[sn,$t]=Zn(Ye);return{lat:$t,lng:sn}}}return null},ie=ne();X.useEffect(()=>{if(!Q||!r)return;const Ye=sn=>{const[$t,fn]=Zn(sn.coordinate);Ae({lat:fn,lng:$t}),de("map-pick"),B(!1)};return r.on("click",Ye),()=>r.un("click",Ye)},[Q,r]);const le=()=>B(!0),ve=()=>{n&&(de("gps"),Ae(null))},qe=()=>{const Ye=document.createElement("input");Ye.type="file",Ye.accept="image/*",Ye.capture="environment",Ye.onchange=sn=>{const $t=sn.target.files?.[0];$t&&pe($t)},Ye.click()},Ke=()=>pe(null),Te=async Ye=>{Ye.preventDefault();const sn=ne();if(!sn){alert("Geen locatie beschikbaar");return}if(!x){alert("Vul een naam/type in");return}F(!0);try{let $t=g||"";if(V===Uc){const dt=[];T&&dt.push(`Materiaal: ${T}`),I&&dt.push(`Periode: ${I}`),C&&dt.push(`Gewicht: ${C}g`),O&&dt.push(`Lengte: ${O}mm`),dt.length>0&&($t=dt.join(" | ")+(g?` | ${g}`:""))}let fn;if(U){const dt=crypto.randomUUID();try{const lr=await PSt(dt,U),$n=await we(lr.thumbnail);fn={id:dt,thumbnailBase64:$n,createdAt:lr.createdAt}}catch(lr){console.error("Failed to save photo:",lr)}}o(V,{coordinates:[sn.lng,sn.lat],name:x,category:V===Uc?x:"Overig",notes:$t||"",...fn?{photos:[fn]}:{},...h&&c?{routeId:`recording-${c}`,routeName:f||void 0}:{}});const yn=s.find(dt=>dt.id===V)?.name||"Vondsten";a&&bSt({type:x,material:T||void 0,period:I||void 0,layerName:yn}),alert(`Toegevoegd aan ${yn}! ${fn?" (met foto)":""}`),t()}catch($t){alert("Fout bij opslaan: "+$t.message)}finally{F(!1)}},we=Ye=>new Promise((sn,$t)=>{const fn=new FileReader;fn.onloadend=()=>sn(fn.result),fn.onerror=$t,fn.readAsDataURL(Ye)}),Dt=X.useMemo(()=>s.map(Ye=>({id:Ye.id,name:Ye.name,color:Ye.color})),[s]);return Q?m.jsx(Mt.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:m.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(cN,{size:24,className:"animate-pulse"}),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),m.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),m.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):m.jsx(Mt.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:m.jsxs(Mt.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[m.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[m.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),m.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(fi,{size:20})})]}),m.jsxs("form",{onSubmit:Te,className:"flex-1 overflow-y-auto",children:[m.jsxs("div",{className:"p-5 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),Ne?m.jsxs("div",{className:"relative",children:[m.jsx("img",{src:Ne,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),m.jsx("button",{type:"button",onClick:Ke,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:m.jsx(wp,{size:16})})]}):m.jsxs("button",{type:"button",onClick:qe,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[m.jsx(YO,{size:32}),m.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),ie&&m.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[m.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[ie.lat.toFixed(6),"N, ",ie.lng.toFixed(6),"E"]}),m.jsx("div",{className:"text-xs text-orange-600 mt-1",children:je==="gps"?" GPS locatie":je==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!ie&&m.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:m.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),m.jsxs("div",{className:"flex gap-2",children:[n&&je!=="gps"&&m.jsxs("button",{type:"button",onClick:ve,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[m.jsx(cb,{size:16}),"GPS"]}),m.jsxs("button",{type:"button",onClick:le,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[m.jsx(cN,{size:16}),"Kies op kaart"]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:Dt.map(Ye=>m.jsx("button",{type:"button",onClick:()=>W(Ye.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${V===Ye.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:Ye.name},Ye.id))})]}),V===Uc&&m.jsx(F8,{label:"Type vondst",value:x,onChange:b,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),V!==Uc&&m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:x,onChange:Ye=>b(Ye.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),V===Uc&&m.jsxs(m.Fragment,{children:[m.jsx(F8,{label:"Materiaal",value:T,onChange:A,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),m.jsx(F8,{label:"Periode",value:I,onChange:R,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),m.jsx("input",{type:"number",value:C??"",onChange:Ye=>N(Ye.target.value?parseFloat(Ye.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),m.jsx("input",{type:"number",value:O??"",onChange:Ye=>j(Ye.target.value?parseFloat(Ye.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),m.jsx("textarea",{value:g,onChange:Ye=>v(Ye.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),m.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:m.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),m.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[m.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),m.jsx("button",{type:"submit",disabled:M||!ie||Q||!x,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:M?"Opslaan...":"Opslaan"})]})]})]})})}function CSt(){const{user:t,setUser:e,setLoading:n}=B5();return X.useEffect(()=>{const s=yce(Iy,o=>{e(o),n(!1)});return()=>s()},[e,n]),{user:t,loginAnonymous:async()=>{try{await o3e(Iy)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await vce(Iy)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!t}}function MSt(){const{isAuthenticated:t,loginAnonymous:e}=CSt(),n=Nn(c=>c.vondstenLocalOnly),r=Nn(c=>c.showVondstButton),i=ri(c=>c.vondstFormOpen),s=ri(c=>c.vondstFormLocation),o=ri(c=>c.openVondstForm),a=ri(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(n){o();return}if(!t){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}o()};return m.jsxs(m.Fragment,{children:[m.jsx(Mt.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:m.jsx(fc,{size:22,strokeWidth:2})}),m.jsx(rr,{children:i&&m.jsx(lEe,{onClose:a,initialLocation:s||void 0})})]})}function NSt(){const t=Nn(we=>we.showRouteRecordButton),e=Nn(we=>we.showVondstButton),n=ri(we=>we.toggleRouteDashboard),{state:r,startRecording:i,pauseRecording:s,resumeRecording:o,stopRecording:a,cancelRecording:l,addPoint:c,getCurrentDistance:u,getCurrentDuration:h,getAverageSpeed:f,currentPoints:g,savedRoutes:v,autoPauseEnabled:x,autoPauseSeconds:b}=wl(),[T,A]=X.useState(!1),[I,R]=X.useState(""),[M,F]=X.useState(!1),[C,N]=X.useState(!1),O=X.useRef(null),j=X.useRef(null),V=X.useRef(null),W=we=>{const Dt=Math.floor(we/1e3),Ye=Math.floor(Dt/3600),sn=Math.floor(Dt%3600/60),$t=Dt%60;return Ye>0?`${Ye}:${sn.toString().padStart(2,"0")}:${$t.toString().padStart(2,"0")}`:`${sn}:${$t.toString().padStart(2,"0")}`},U=we=>we<1e3?`${Math.round(we)} m`:`${(we/1e3).toFixed(2)} km`,pe=we=>`${we.toFixed(1)} km/h`,Ne=(we,Dt,Ye,sn)=>{const fn=(sn-Dt)*Math.PI/180,yn=(Ye-we)*Math.PI/180,dt=Math.sin(fn/2)*Math.sin(fn/2)+Math.cos(Dt*Math.PI/180)*Math.cos(sn*Math.PI/180)*Math.sin(yn/2)*Math.sin(yn/2);return 6371e3*(2*Math.atan2(Math.sqrt(dt),Math.sqrt(1-dt)))};if(X.useEffect(()=>(r==="recording"?(N(!1),"geolocation"in navigator&&O.current===null&&(O.current=navigator.geolocation.watchPosition(we=>{const Dt=we.coords.longitude,Ye=we.coords.latitude,sn=Date.now();c(Dt,Ye,we.coords.accuracy),x&&j.current?Ne(j.current.lon,j.current.lat,Dt,Ye)>3?(j.current={lon:Dt,lat:Ye,time:sn},V.current&&(clearTimeout(V.current),V.current=null)):sn-j.current.time>=b*1e3&&(s(),N(!0),j.current=null):j.current={lon:Dt,lat:Ye,time:sn}},we=>{console.error("GPS error:",we)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(O.current!==null&&(navigator.geolocation.clearWatch(O.current),O.current=null),V.current&&(clearTimeout(V.current),V.current=null)),()=>{O.current!==null&&(navigator.geolocation.clearWatch(O.current),O.current=null),V.current&&(clearTimeout(V.current),V.current=null)}),[r,c,x,b,s]),!t)return null;const Se=e?"right-[114px]":"right-[60px]",je=e?"right-[168px]":"right-[114px]",de=()=>{i(),F(!0)},Oe=()=>{s()},Ae=()=>{o()},Q=()=>{R(`Route ${new Date().toLocaleDateString("nl-NL")}`),A(!0)},B=()=>{const we=a(I);A(!1),F(!1),R(""),we&&confirm(`Route "${we.name}" opgeslagen! (${U(we.totalDistance)})

Direct exporteren als GPX?`)&&oEe(we)},ne=()=>{g.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(l(),A(!1),F(!1))},ie=u(),le=h(),ve=f(),qe=we=>{switch(we){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-green-500 hover:bg-green-600"}},Ke=we=>{switch(we){case"recording":return m.jsx(gwe,{size:22,strokeWidth:2});case"paused":return m.jsx(vwe,{size:22,strokeWidth:2});default:return m.jsx(dN,{size:22,strokeWidth:2})}},Te=()=>{switch(r){case"idle":de();break;case"recording":Oe();break;case"paused":Ae();break}};return m.jsxs(m.Fragment,{children:[m.jsxs(Mt.button,{className:`fixed bottom-2 ${Se} z-[1000] w-11 h-11 ${qe(r)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Te,title:r==="idle"?"Route opnemen":r==="recording"?"Pauzeren":"Hervatten",children:[Ke(r),r==="recording"&&m.jsx(Mt.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),m.jsx(rr,{children:r==="idle"&&v.length>0&&m.jsxs(Mt.button,{className:`fixed bottom-2 ${je} z-[1000] w-11 h-11 bg-green-400 hover:bg-green-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,title:`Mijn routes (${v.length})`,children:[m.jsx(pwe,{size:18,strokeWidth:2}),m.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-green-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:v.length})]})}),m.jsx(rr,{children:(r==="recording"||r==="paused")&&m.jsx(Mt.button,{className:`fixed bottom-2 ${je} z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Q,title:"Stoppen en opslaan",children:m.jsx(Gct,{size:18,strokeWidth:2,fill:"currentColor"})})}),m.jsx(rr,{children:M&&r!=="idle"&&m.jsxs(Mt.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:r==="recording"?" Opname":C?" Auto-pauze":" Gepauzeerd"}),m.jsx("button",{onClick:()=>F(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:m.jsx(fi,{size:14})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(eA,{size:16,className:"text-green-500"}),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:U(ie)})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(lN,{size:16,className:"text-blue-500"}),m.jsx(OSt,{duration:le,recordingState:r,formatTime:W})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx($lt,{size:16,className:"text-green-500"}),m.jsx("span",{className:"text-sm text-gray-600",children:pe(ve)})]}),m.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[g.length," punten opgenomen"]})]})]})}),m.jsx(rr,{children:T&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>A(!1)}),m.jsxs(Mt.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Afstand:"}),m.jsx("span",{className:"font-medium",children:U(ie)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Duur:"}),m.jsx("span",{className:"font-medium",children:W(le)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),m.jsx("span",{className:"font-medium",children:pe(ve)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Punten:"}),m.jsx("span",{className:"font-medium",children:g.length})]})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),m.jsx("input",{type:"text",value:I,onChange:we=>R(we.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:ne,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),m.jsxs("button",{onClick:B,disabled:g.length<2,className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[m.jsx(xwe,{size:16}),"Opslaan"]})]}),g.length<2&&m.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function OSt({duration:t,recordingState:e,formatTime:n}){const[r,i]=X.useState(t);return X.useEffect(()=>{if(e!=="recording"){i(t);return}const s=setInterval(()=>{i(o=>o+1e3)},1e3);return()=>clearInterval(s)},[e,t]),X.useEffect(()=>{i(t)},[t]),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:n(r)})}function LSt(){const t=$i(s=>s.map),{currentPoints:e,state:n}=wl(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!t)return;const s=new Od;i.current=s;const o=new gp({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=o,t.addLayer(o),()=>{r.current&&t&&t.removeLayer(r.current)}},[t]),X.useEffect(()=>{if(!i.current||(i.current.clear(),n==="idle"||e.length===0))return;const s=e.map(o=>Pi(o.coordinates));if(s.length>=2){const o=new xi({geometry:new ro(s)});o.setStyle(new zn({stroke:new Sr({color:n==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(o)}if(s.length>=1){const o=new xi({geometry:new Vs(s[0])});o.setStyle(new zn({image:new ja({radius:8,fill:new Nr({color:"rgba(34, 197, 94, 1)"}),stroke:new Sr({color:"white",width:2})})})),i.current.addFeature(o)}if(s.length>=1){const o=new xi({geometry:new Vs(s[s.length-1])});o.setStyle(new zn({image:new ja({radius:6,fill:new Nr({color:n==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Sr({color:"white",width:2})})})),i.current.addFeature(o)}},[e,n]),null}const Roe=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function DSt(){const t=$i(s=>s.map),{savedRoutes:e,visibleRouteIds:n}=wl(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!t)return;const s=new Od;i.current=s;const o=new gp({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=o,t.addLayer(o),()=>{r.current&&t&&t.removeLayer(r.current)}},[t]),X.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(o=>n.has(o.id)).forEach((o,a)=>{const l=Roe[a%Roe.length],c=o.points.map(x=>Pi(x.coordinates));if(c.length<2)return;const u=new xi({geometry:new ro(c),routeId:o.id,routeName:o.name});u.setStyle(new zn({stroke:new Sr({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(u);const h=new xi({geometry:new Vs(c[0]),routeId:o.id,type:"start"});h.setStyle(new zn({image:new ja({radius:8,fill:new Nr({color:"#22c55e"}),stroke:new Sr({color:"white",width:2})}),text:new th({text:"S",font:"bold 10px sans-serif",fill:new Nr({color:"white"}),offsetY:1})})),i.current.addFeature(h);const f=new xi({geometry:new Vs(c[c.length-1]),routeId:o.id,type:"end"});f.setStyle(new zn({image:new ja({radius:8,fill:new Nr({color:"#ef4444"}),stroke:new Sr({color:"white",width:2})}),text:new th({text:"E",font:"bold 10px sans-serif",fill:new Nr({color:"white"}),offsetY:1})})),i.current.addFeature(f);const g=Math.floor(c.length/2),v=new xi({geometry:new Vs(c[g]),routeId:o.id,type:"label"});v.setStyle(new zn({text:new th({text:o.name,font:"12px sans-serif",fill:new Nr({color:"#1f2937"}),stroke:new Sr({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(v)})},[e,n]),null}function $St(){const t=$i(o=>o.map),{savedRoutes:e,visibleRouteIds:n,heatmapEnabled:r}=wl(),i=X.useRef(null),s=X.useRef(null);return X.useEffect(()=>{if(!t)return;const o=new Od;s.current=o;const a=new tRe({source:o,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=a,t.addLayer(a),()=>{t&&i.current&&t.removeLayer(i.current)}},[t]),X.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const o=e.filter(l=>n.has(l.id)),a=[];for(const l of o)for(const c of l.points){const u=new xi({geometry:new Vs(Pi(c.coordinates))});a.push(u)}s.current.addFeatures(a),i.current.setVisible(a.length>0)},[e,n,r]),null}function jSt(t,e,n,r){const i=[],s=e/111e3,o=e/(111e3*Math.cos(t[1]*Math.PI/180)),a=Math.floor(n/2),l=t[0]-a*o,c=t[0]+a*o,u=t[1]-a*s,h=t[1]+a*s;for(let x=-a;x<=a;x++){const b=t[0]+x*o,T=[Pi([b,u]),Pi([b,h])],A=new xi({geometry:new ro(T),type:"grid-line"});A.setStyle(new zn({stroke:new Sr({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(A)}for(let x=-a;x<=a;x++){const b=t[1]+x*s,T=[Pi([l,b]),Pi([c,b])],A=new xi({geometry:new ro(T),type:"grid-line"});A.setStyle(new zn({stroke:new Sr({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(A)}const f="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let x=-a;x<a;x++)for(let b=-a;b<a;b++){const T=t[0]+(b+.5)*o,A=t[1]+(x+.5)*s,I=x+a,R=b+a;if(I>=0&&I<f.length){const M=`${f[I]}${R+1}`,F=new xi({geometry:new ro([Pi([T,A]),Pi([T,A])]),type:"grid-label"});F.setStyle(new zn({text:new th({text:M,font:"12px sans-serif",fill:new Nr({color:r}),stroke:new Sr({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(F)}}const g=new xi({geometry:new ro([Pi([t[0]-o*.2,t[1]]),Pi([t[0]+o*.2,t[1]])]),type:"grid-center"});g.setStyle(new zn({stroke:new Sr({color:"#ef4444",width:3})})),i.push(g);const v=new xi({geometry:new ro([Pi([t[0],t[1]-s*.2]),Pi([t[0],t[1]+s*.2])]),type:"grid-center"});return v.setStyle(new zn({stroke:new Sr({color:"#ef4444",width:3})})),i.push(v),i}function FSt(){const t=$i(l=>l.map),{gridEnabled:e,gridCenter:n,gridSize:r,gridCount:i,gridColor:s}=wl(),o=X.useRef(null),a=X.useRef(null);return X.useEffect(()=>{if(!t)return;const l=new Od;a.current=l;const c=new gp({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return o.current=c,t.addLayer(c),()=>{o.current&&t&&t.removeLayer(o.current)}},[t]),X.useEffect(()=>{if(!a.current||!o.current)return;if(a.current.clear(),!e||!n){o.current.setVisible(!1);return}const l=jSt(n,r,i,s);a.current.addFeatures(l),o.current.setVisible(!0)},[e,n,r,i,s]),null}function VSt(t){const e=[];let n=0;return t.points.forEach((r,i)=>{if(i>0){const a=t.points[i-1],l=6371e3,c=(r.coordinates[1]-a.coordinates[1])*Math.PI/180,u=(r.coordinates[0]-a.coordinates[0])*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(a.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2),f=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));n+=l*f}const s=5,o=Math.sin(n/50)*2+Math.sin(n/120)*1.5+Math.sin(n/30+r.coordinates[0]*1e3)*.5;e.push({distance:n,elevation:Math.max(0,s+o)})}),e}function zSt({route:t,onClose:e}){const n=X.useRef(null),[r,i]=X.useState([]),[s,o]=X.useState({min:0,max:0,gain:0,loss:0});X.useEffect(()=>{const l=VSt(t);if(i(l),l.length>0){const c=l.map(v=>v.elevation),u=Math.min(...c),h=Math.max(...c);let f=0,g=0;for(let v=1;v<l.length;v++){const x=l[v].elevation-l[v-1].elevation;x>0?f+=x:g+=Math.abs(x)}o({min:u,max:h,gain:f,loss:g})}},[t]),X.useEffect(()=>{const l=n.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const u=l.width,h=l.height,f={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,u,h);const g=Math.max(...r.map(M=>M.distance)),v=Math.min(...r.map(M=>M.elevation))-1,x=Math.max(...r.map(M=>M.elevation))+1,b=M=>f.left+M/g*(u-f.left-f.right),T=M=>h-f.bottom-(M-v)/(x-v)*(h-f.top-f.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const A=5;for(let M=0;M<=A;M++){const F=v+(x-v)*(M/A),C=T(F);c.beginPath(),c.moveTo(f.left,C),c.lineTo(u-f.right,C),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${F.toFixed(1)}m`,f.left-5,C+3)}const I=5;for(let M=0;M<=I;M++){const F=g/I*M,C=b(F);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(F<1e3?`${Math.round(F)}m`:`${(F/1e3).toFixed(1)}km`,C,h-10)}c.beginPath(),c.moveTo(b(r[0].distance),h-f.bottom),r.forEach(M=>{c.lineTo(b(M.distance),T(M.elevation))}),c.lineTo(b(r[r.length-1].distance),h-f.bottom),c.closePath();const R=c.createLinearGradient(0,f.top,0,h-f.bottom);R.addColorStop(0,"rgba(139, 92, 246, 0.3)"),R.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=R,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((M,F)=>{const C=b(M.distance),N=T(M.elevation);F===0?c.moveTo(C,N):c.lineTo(C,N)}),c.stroke()},[r]);const a=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return m.jsxs(Mt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(T2,{size:20}),m.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:m.jsx(fi,{size:18})})]}),m.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[m.jsx("h3",{className:"font-medium text-gray-800 truncate",children:t.name}),m.jsx("p",{className:"text-xs text-gray-500",children:a(t.totalDistance)})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:m.jsx(mwe,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:m.jsx(T2,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:m.jsx(iut,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:m.jsx(nut,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),m.jsx("div",{className:"flex-1 p-3",children:m.jsx("canvas",{ref:n,width:350,height:200,className:"w-full h-full"})}),m.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:m.jsxs("p",{className:"text-xs text-yellow-700",children:[m.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const USt=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(2)} km`,GSt=t=>{const e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60);return n>0?`${n}u ${r}m`:`${r} min`},Poe=t=>new Date(t).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function BSt({route:t,onClose:e}){const{updateRouteNotes:n,addPhotoToRoute:r,removePhotoFromRoute:i}=wl(),[s,o]=X.useState(t.notes||""),[a,l]=X.useState("info"),c=X.useRef(null),u=()=>{n(t.id,s)},h=async v=>{const x=v.target.files?.[0];if(!x)return;const b=URL.createObjectURL(x);r(t.id,{url:b,caption:x.name}),c.current&&(c.current.value="")},f=v=>{confirm("Foto verwijderen?")&&i(t.id,v)},g=wl(v=>v.savedRoutes.find(x=>x.id===t.id))||t;return m.jsxs(Mt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[m.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),m.jsxs(Mt.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("h3",{className:"font-medium truncate",children:g.name}),m.jsx("p",{className:"text-xs text-purple-200",children:Poe(g.createdAt)})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:m.jsx(fi,{size:18})})]}),m.jsxs("div",{className:"flex border-b border-gray-200",children:[m.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[m.jsx(fc,{size:16,className:"inline mr-1"}),"Info"]}),m.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[m.jsx(YO,{size:16,className:"inline mr-1"}),"Foto's (",g.photos?.length||0,")"]}),m.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[m.jsx(nH,{size:16,className:"inline mr-1"}),"Notities"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a==="info"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[m.jsx(eA,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),m.jsx("p",{className:"text-lg font-semibold",children:USt(g.totalDistance)})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[m.jsx(lN,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),m.jsx("p",{className:"text-lg font-semibold",children:GSt(g.totalDuration)})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[m.jsx(fc,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),m.jsxs("p",{className:"text-lg font-semibold",children:[g.points.length," GPS punten"]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[m.jsx(eH,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),m.jsx("p",{className:"text-sm",children:Poe(g.createdAt)})]})]}),a==="photos"&&m.jsxs("div",{className:"space-y-4",children:[m.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:h,className:"hidden"}),m.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[m.jsx(uu,{size:24}),m.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),g.photos&&g.photos.length>0?m.jsx("div",{className:"grid grid-cols-2 gap-2",children:g.photos.map(v=>m.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[m.jsx("img",{src:v.url,alt:v.caption||"Route foto",className:"w-full h-full object-cover"}),m.jsx("button",{onClick:()=>f(v.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:m.jsx(wp,{size:12})}),v.caption&&m.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:v.caption})]},v.id))}):m.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),a==="notes"&&m.jsxs("div",{className:"space-y-4",children:[m.jsx("textarea",{value:s,onChange:v=>o(v.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),m.jsx("button",{onClick:u,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function WSt({route:t,size:e=80}){const n=X.useRef(null);return X.useEffect(()=>{const r=n.current;if(!r||t.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=t.points.map(R=>R.coordinates[0]),o=t.points.map(R=>R.coordinates[1]),a=Math.min(...s),l=Math.max(...s),c=Math.min(...o),u=Math.max(...o),h=8,f=e-h*2,g=e-h*2,v=R=>l===a?e/2:h+(R-a)/(l-a)*f,x=R=>u===c?e/2:h+g-(R-c)/(u-c)*g;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),t.points.forEach((R,M)=>{const F=v(R.coordinates[0]),C=x(R.coordinates[1]);M===0?i.moveTo(F,C):i.lineTo(F,C)}),i.stroke();const b=v(t.points[0].coordinates[0]),T=x(t.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(b,T,4,0,Math.PI*2),i.fill();const A=v(t.points[t.points.length-1].coordinates[0]),I=x(t.points[t.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(A,I,4,0,Math.PI*2),i.fill()},[t,e]),t.points.length<2?m.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:m.jsx(fc,{size:20})}):m.jsx("canvas",{ref:n,width:e,height:e,className:"rounded"})}const V8=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(2)} km`,z8=t=>{const e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60);return n>0?`${n}u ${r}m`:`${r} min`},Coe=t=>new Date(t).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function HSt({isOpen:t,onClose:e,onViewRoute:n}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:o,visibleRouteIds:a,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:u,heatmapEnabled:h,toggleHeatmap:f,gridEnabled:g,toggleGrid:v,centerGridOnCurrentLocation:x,gridSize:b,setGridSize:T,autoPauseEnabled:A,setAutoPauseEnabled:I,autoPauseSeconds:R,setAutoPauseSeconds:M,importRouteFromGPX:F}=wl(),[C,N]=X.useState(null),[O,j]=X.useState(""),[V,W]=X.useState(!1),[U,pe]=X.useState(!1),[Ne,Se]=X.useState(null),[je,de]=X.useState(null),Oe=X.useRef(null),Ae=async Te=>{const we=` ${Te.name}

 Afstand: ${V8(Te.totalDistance)}
 Duur: ${z8(Te.totalDuration)}
 ${Te.points.length} GPS punten
 ${Coe(Te.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:Te.name,text:we});return}catch(Dt){Dt.name!=="AbortError"&&console.error("Share failed:",Dt)}try{await navigator.clipboard.writeText(we),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",we)}},Q=async Te=>{const we=Te.target.files?.[0];if(we){try{const Dt=await we.text(),Ye=F(Dt,we.name.replace(".gpx",""));Ye.success?alert(`Route gemporteerd: ${we.name}`):alert(`Import mislukt: ${Ye.error}`)}catch{alert("Fout bij lezen van bestand")}Oe.current&&(Oe.current.value="")}},B=Te=>{N(Te.id),j(Te.name)},ne=Te=>{O.trim()&&s(Te,O.trim()),N(null),j("")},ie=Te=>{confirm(`Weet je zeker dat je "${Te.name}" wilt verwijderen?`)&&i(Te.id)},le=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&o()},ve=Te=>{l(Te);const we=r.find(Dt=>Dt.id===Te);we&&n&&n(we)},qe=r.reduce((Te,we)=>Te+we.totalDistance,0),Ke=r.reduce((Te,we)=>Te+we.totalDuration,0);return m.jsxs(m.Fragment,{children:[m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(dN,{size:20}),m.jsx("span",{className:"font-medium",children:"Mijn Routes"}),m.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:m.jsx(fi,{size:18})})]}),r.length>0&&m.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[m.jsxs("div",{className:"flex gap-4",children:[m.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[m.jsx(eA,{size:14}),m.jsxs("span",{children:["Totaal: ",V8(qe)]})]}),m.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[m.jsx(lN,{size:14}),m.jsx("span",{children:z8(Ke)})]})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:()=>pe(!U),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${A?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:A?"Auto-pauze uit":"Auto-pauze aan",children:m.jsx(Zct,{size:14})}),m.jsx("button",{onClick:()=>W(!V),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Grid verbergen":"Grid tonen",children:m.jsx(hwe,{size:14})}),m.jsx("button",{onClick:f,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${h?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:h?"Heatmap verbergen":"Heatmap tonen",children:m.jsx(klt,{size:14})}),m.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:m.jsx(hN,{size:14})}),m.jsx("button",{onClick:u,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:m.jsx(uN,{size:14})})]})]}),m.jsx(rr,{children:V&&m.jsx(Mt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:m.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),m.jsx("button",{onClick:v,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${g?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:g?"Aan":"Uit"})]}),m.jsx("div",{className:"flex items-center gap-2",children:m.jsxs("button",{onClick:x,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[m.jsx(cN,{size:14}),"Centreer op mijn locatie"]})}),m.jsxs("div",{className:"space-y-1",children:[m.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",b,"m"]}),m.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:b,onChange:Te=>T(Number(Te.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),m.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[m.jsx("span",{children:"5m"}),m.jsx("span",{children:"50m"})]})]}),m.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),m.jsx(rr,{children:U&&m.jsx(Mt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:m.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),m.jsx("button",{onClick:()=>I(!A),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${A?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:A?"Aan":"Uit"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",R<60?`${R}s`:`${Math.floor(R/60)}m ${R%60}s`]}),m.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:R,onChange:Te=>M(Number(Te.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),m.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[m.jsx("span",{children:"30s"}),m.jsx("span",{children:"5min"})]})]}),m.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",R<60?`${R} seconden`:`${Math.floor(R/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),m.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?m.jsxs("div",{className:"text-center py-12 text-gray-500",children:[m.jsx(dN,{size:48,className:"mx-auto mb-3 text-gray-300"}),m.jsx("p",{className:"font-medium",children:"Nog geen routes"}),m.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(Te=>m.jsxs(Mt.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[m.jsx(WSt,{route:Te,size:70}),m.jsxs("div",{className:"flex-1 min-w-0",children:[C===Te.id?m.jsx("input",{type:"text",value:O,onChange:we=>j(we.target.value),onKeyDown:we=>{we.key==="Enter"&&ne(Te.id),we.key==="Escape"&&N(null)},onBlur:()=>ne(Te.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):m.jsx("h3",{className:"font-medium text-gray-800 truncate",children:Te.name}),m.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(eH,{size:12}),Coe(Te.createdAt)]})}),m.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(eA,{size:12}),V8(Te.totalDistance)]}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(lN,{size:12}),z8(Te.totalDuration)]}),m.jsxs("span",{children:[Te.points.length," punten"]})]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>ve(Te.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${a.has(Te.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:a.has(Te.id)?"Verbergen op kaart":"Tonen op kaart",children:a.has(Te.id)?m.jsx(hN,{size:16}):m.jsx(uN,{size:16})}),m.jsx("button",{onClick:()=>B(Te),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(k2,{size:16})}),m.jsx("button",{onClick:()=>de(Te),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:m.jsx(rH,{size:16})}),m.jsx("button",{onClick:()=>Se(Te),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:m.jsx(T2,{size:16})}),m.jsx("button",{onClick:()=>Ae(Te),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:m.jsx(Nct,{size:16})}),m.jsx("button",{onClick:()=>oEe(Te),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:m.jsx(Qk,{size:16})}),m.jsx("button",{onClick:()=>ie(Te),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(wp,{size:16})})]})]},Te.id))}),m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[m.jsx("input",{ref:Oe,type:"file",accept:".gpx",onChange:Q,className:"hidden"}),m.jsxs("button",{onClick:()=>Oe.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[m.jsx(II,{size:16}),"GPX bestand importeren"]}),r.length>0&&m.jsx("button",{onClick:le,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),m.jsx(rr,{children:Ne&&m.jsx(zSt,{route:Ne,onClose:()=>Se(null)})}),m.jsx(rr,{children:je&&m.jsx(BSt,{route:je,onClose:()=>de(null)})})]})}const U8={lat:52.1326,lon:5.2913};function cEe({code:t,size:e=18}){return t===0?m.jsx(Wct,{size:e,className:"text-yellow-500"}):t>=1&&t<=3?m.jsx(hp,{size:e,className:"text-gray-400"}):t===45||t===48?m.jsx(ilt,{size:e,className:"text-gray-400"}):t>=51&&t<=67||t>=80&&t<=82?m.jsx(tH,{size:e,className:"text-blue-500"}):t>=71&&t<=77||t>=85&&t<=86?m.jsx(hlt,{size:e,className:"text-cyan-500"}):t>=95?m.jsx(olt,{size:e,className:"text-purple-500"}):m.jsx(hp,{size:e,className:"text-gray-400"})}function qSt({degrees:t,size:e=14}){return m.jsx("div",{style:{transform:`rotate(${t+180}deg)`},className:"inline-flex",children:m.jsx(cb,{size:e,className:"text-blue-500"})})}function KSt({data:t}){if(!t||t.length===0)return null;const e=Math.max(...t.map(r=>r.precipitation),.5),n=t.some(r=>r.precipitation>0);return m.jsxs("div",{className:"space-y-1",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{style:{fontSize:"0.83em"},className:"text-gray-500",children:"Neerslag 2 uur"}),!n&&m.jsx("span",{style:{fontSize:"0.83em"},className:"text-green-600 font-medium",children:"Droog"})]}),m.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-lg overflow-hidden",children:[m.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:t.map((r,i)=>{const s=r.precipitation/e*100,o=r.precipitation>2?"bg-blue-600":r.precipitation>.5?"bg-blue-500":r.precipitation>0?"bg-blue-400":"bg-transparent";return m.jsx("div",{className:"flex-1 mx-px",children:m.jsx("div",{className:`w-full rounded-t transition-all ${o}`,style:{height:`${Math.max(s,r.precipitation>0?8:0)}%`}})},i)})}),m.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-gray-400",style:{fontSize:"0.67em"},children:[m.jsx("span",{children:"Nu"}),m.jsx("span",{children:"+1u"}),m.jsx("span",{children:"+2u"})]})]})]})}function YSt({pollen:t}){const e=[{name:"Gras",value:t.grass},{name:"Berk",value:t.birch},{name:"Els",value:t.alder},{name:"Bijvoet",value:t.mugwort}].filter(i=>i.value>0).sort((i,s)=>s.value-i.value);if(e.length===0)return m.jsxs("div",{className:"flex items-center gap-1.5 text-green-600",style:{fontSize:"0.83em"},children:[m.jsx(ose,{size:12}),m.jsx("span",{children:"Lage pollenconcentratie"})]});const n=e[0],r=n.value>=4?"text-red-500":n.value>=3?"text-orange-500":n.value>=2?"text-amber-500":"text-green-600";return m.jsxs("div",{className:`flex items-center gap-1.5 ${r}`,style:{fontSize:"0.83em"},children:[m.jsx(ose,{size:12}),m.jsxs("span",{children:[n.name,": ",n.value>=4?"Zeer hoog":n.value>=3?"Hoog":n.value>=2?"Matig":"Laag"]})]})}function XSt({hourly:t}){const e=t.slice(0,6);return e.length===0?null:m.jsxs("div",{className:"space-y-1",children:[m.jsx("div",{className:"text-gray-500",style:{fontSize:"0.83em"},children:"Komende uren"}),m.jsx("div",{className:"flex gap-1",children:e.map((n,r)=>{const i=new Date(n.time),s=r===0;return m.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg flex-1 ${s?"bg-blue-100":"bg-gray-50"}`,children:[m.jsx("span",{className:"text-gray-500",style:{fontSize:"0.75em"},children:s?"Nu":`${i.getHours()}u`}),m.jsx(cEe,{code:n.weatherCode,size:14}),m.jsxs("span",{className:"font-medium",style:{fontSize:"0.83em"},children:[Math.round(n.temperature),""]})]},n.time)})})]})}function ZSt(){const t=Nn(x=>x.showWeatherButton),e=Nn(x=>x.showFontSliders),n=Nn(x=>x.weatherFontScale),r=Nn(x=>x.setWeatherFontScale),i=bs(),s=KS(),[o,a]=X.useState(!1),l=12*n/100,c=KS(x=>x.showBuienradar),u=KS(x=>x.setShowBuienradar);if(X.useEffect(()=>{c&&a(!1)},[c]),X.useEffect(()=>{if(!t)return;const x=i.position||U8;(!s.weatherData||Date.now()-s.weatherData.lastUpdated>600*1e3)&&s.fetchWeather(x.lat,x.lon)},[t,i.position?.lat]),X.useEffect(()=>{if(!t)return;const x=setInterval(()=>{const b=i.position||U8;s.fetchWeather(b.lat,b.lon)},600*1e3);return()=>clearInterval(x)},[t,i.position?.lat]),!t)return null;const h=s.weatherData?.current,f=s.weatherData?.hourly||[],g=s.weatherData?.precipitation15min||[],v=s.weatherData?.pollen;return m.jsxs(m.Fragment,{children:[o&&m.jsx("div",{className:"fixed inset-0 z-[1099]",onClick:()=>a(!1)}),m.jsx(Mt.div,{className:"fixed left-2 z-[1100] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))",width:o?"200px":"auto",maxWidth:"200px"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},layout:!0,children:s.isLoading&&!h?m.jsxs("div",{className:"p-3 flex items-center gap-2",style:{fontSize:`${l}px`},children:[m.jsx(_we,{size:16,className:"animate-spin text-blue-500"}),m.jsx("span",{className:"text-gray-500",style:{fontSize:"1.17em"},children:"Laden..."})]}):h?m.jsxs("div",{className:"p-2.5",style:{fontSize:`${l}px`},children:[m.jsxs("button",{onClick:()=>a(!o),className:"w-full border-0 outline-none bg-transparent p-0",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(cEe,{code:h.weatherCode,size:24}),m.jsx("div",{className:"flex flex-col leading-tight",children:m.jsxs("span",{className:"font-bold text-gray-800",style:{fontSize:"1.5em"},children:[Math.round(h.temperature),""]})})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(lse,{size:14,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-600",style:{fontSize:"1.17em"},children:Math.round(h.windSpeed)}),m.jsx(qSt,{degrees:h.windDirection,size:12})]}),m.jsx("div",{className:"ml-auto",children:o?m.jsx(XO,{size:16,className:"text-gray-400"}):m.jsx(ab,{size:16,className:"text-gray-400"})})]}),m.jsxs("div",{className:"text-gray-500 text-left mt-1",style:{fontSize:"0.92em"},children:[qLe[h.weatherCode]||"Onbekend",m.jsxs("span",{className:"text-gray-400 ml-1",children:[" ",Math.round(h.apparentTemperature),""]})]})]}),m.jsx(rr,{children:o&&m.jsx(Mt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:m.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-200/50 space-y-3",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[m.jsx(xlt,{size:12,className:"text-blue-500"}),m.jsx("span",{children:"Vocht"})]}),m.jsxs("div",{className:"font-bold text-blue-600",style:{fontSize:"1.17em"},children:[h.humidity,"%"]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[m.jsx(lse,{size:12,className:"text-gray-500"}),m.jsx("span",{children:"Windstoten"})]}),m.jsxs("div",{className:"font-bold text-gray-600",style:{fontSize:"1.17em"},children:[Math.round(h.windGusts)," km/u"]})]}),m.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[m.jsx(cb,{size:12,className:"text-cyan-500"}),m.jsx("span",{children:"Wind"})]}),m.jsx("div",{className:"font-bold text-cyan-600",style:{fontSize:"1.17em"},children:KLe(h.windDirection)})]}),m.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-gray-500",style:{fontSize:"0.83em"},children:[m.jsx(hp,{size:12,className:"text-purple-500"}),m.jsx("span",{children:"Bewolking"})]}),m.jsxs("div",{className:"font-bold text-purple-600",style:{fontSize:"1.17em"},children:[h.cloudCover,"%"]})]})]}),m.jsxs("button",{onClick:()=>u(!c),className:`w-full flex items-center gap-2 p-2 rounded-lg transition-colors border-0 cursor-pointer ${c?"bg-blue-500 hover:bg-blue-600":"bg-blue-50 hover:bg-blue-100"}`,children:[m.jsx(tH,{size:16,className:c?"text-white":"text-blue-500"}),m.jsx("span",{className:`font-medium ${c?"text-white":"text-blue-700"}`,style:{fontSize:"1.17em"},children:"Buienradar"}),m.jsx("span",{className:`ml-auto ${c?"text-blue-100":"text-blue-500"}`,style:{fontSize:"1em"},children:c?"Aan":"Uit"})]}),g.length>0&&m.jsx(KSt,{data:g}),f.length>0&&m.jsx(XSt,{hourly:f}),v&&m.jsx(YSt,{pollen:v}),m.jsxs("div",{className:"text-gray-400 text-center pt-1",style:{fontSize:"0.75em"},children:["Bijgewerkt: ",new Date(s.weatherData.lastUpdated).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]}),e&&m.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200/50",children:[m.jsx(sH,{size:12,className:"text-gray-400"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:n,onChange:x=>r(parseInt(x.target.value)),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),m.jsxs("span",{className:"text-gray-400 w-8",style:{fontSize:"0.83em"},children:[n,"%"]})]})]})})})]}):m.jsxs("button",{onClick:()=>{const x=i.position||U8;s.fetchWeather(x.lat,x.lon)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",style:{fontSize:`${l}px`},children:[m.jsx(hp,{size:18,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-500",style:{fontSize:"1.17em"},children:"Weer laden"})]})})]})}function JSt({isVisible:t,onClose:e}){const n=$i(M=>M.map),r=X.useRef(null),i=X.useRef(null),[s,o]=X.useState([]),[a,l]=X.useState(0),[c,u]=X.useState(!0),[h,f]=X.useState(!0),[g,v]=X.useState("normal"),[x,b]=X.useState(70),T=g==="slow"?800:g==="normal"?500:250,A=X.useCallback(async()=>{f(!0);try{const F=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json(),C=[];F.radar?.past&&F.radar.past.forEach(O=>{C.push({path:O.path,time:O.time*1e3})}),F.radar?.nowcast&&F.radar.nowcast.forEach(O=>{C.push({path:O.path,time:O.time*1e3})}),o(C);const N=F.radar?.past?.length?F.radar.past.length-1:0;l(N)}catch(M){console.error("Failed to fetch radar data:",M)}finally{f(!1)}},[]);X.useEffect(()=>{if(t){A();const M=setInterval(A,300*1e3);return()=>clearInterval(M)}},[t,A]),X.useEffect(()=>{if(!n||!t||s.length===0)return;const M=s[a];if(!M)return;const F=`https://tilecache.rainviewer.com${M.path}/256/{z}/{x}/{y}/2/1_1.png`;if(r.current){const C=r.current.getSource();C&&(C.setUrl(F),C.refresh())}else{const C=new hy({url:F,crossOrigin:"anonymous"}),N=new Am({source:C,opacity:x/100,zIndex:1500,properties:{name:"rain-radar-layer",title:"Buienradar"}});r.current=N,n.addLayer(N)}return()=>{}},[n,t,s,a]),X.useEffect(()=>{r.current&&r.current.setOpacity(x/100)},[x]),X.useEffect(()=>{!t&&r.current&&n&&(n.removeLayer(r.current),r.current=null)},[t,n]),X.useEffect(()=>()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null),i.current&&clearInterval(i.current)},[n]),X.useEffect(()=>{if(!c||s.length===0||!t){i.current&&(clearInterval(i.current),i.current=null);return}return i.current=setInterval(()=>{l(M=>(M+1)%s.length)},T),()=>{i.current&&(clearInterval(i.current),i.current=null)}},[c,s.length,T,t]);const I=X.useCallback(()=>{if(s.length===0||!s[a])return"--:--";const M=s[a].time,F=Date.now(),C=Math.round((M-F)/6e4),O=new Date(M).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return Math.abs(C)<3?`${O} (nu)`:C<0?`${O} (${C}m)`:`${O} (+${C}m)`},[s,a]),R=M=>{u(!1),l(F=>M==="prev"?F>0?F-1:s.length-1:(F+1)%s.length)};return t?m.jsx(rr,{children:m.jsxs(Mt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 left-2 right-2 z-[1600] bg-white/95 backdrop-blur-sm rounded-xl shadow-xl border border-gray-200",style:{maxWidth:"400px",margin:"0 auto"},children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-gray-100",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(tH,{size:14,className:"text-blue-500"}),m.jsx("span",{className:"text-xs font-medium text-gray-700",children:h?"Laden...":I()})]}),m.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(fi,{size:14,className:"text-gray-500"})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[m.jsxs("div",{className:"flex items-center gap-0.5",children:[m.jsx("button",{onClick:()=>R("prev"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(cwe,{size:14,className:"text-gray-600"})}),m.jsx("button",{onClick:()=>u(!c),className:`p-1.5 rounded transition-colors border-0 outline-none ${c?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:c?m.jsx(gwe,{size:14}):m.jsx(vwe,{size:14})}),m.jsx("button",{onClick:()=>R("next"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(lb,{size:14,className:"text-gray-600"})})]}),m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-gray-400 w-6",children:"-2u"}),m.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:a,onChange:M=>{u(!1),l(parseInt(M.target.value))},className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsx("span",{className:"text-[9px] text-gray-400 w-8 text-right",children:"+30m"})]}),m.jsx("div",{className:"flex items-center gap-0.5 bg-gray-100 rounded p-0.5",children:["slow","normal","fast"].map(M=>m.jsxs("button",{onClick:()=>v(M),className:`px-1.5 py-0.5 text-[9px] rounded transition-colors border-0 outline-none ${g===M?"bg-white text-blue-600 shadow-sm":"text-gray-500 bg-transparent"}`,children:[M==="slow"?"":M==="normal"?"1":"2",""]},M))})]}),m.jsxs("div",{className:"px-3 py-1.5 flex items-center gap-2 border-t border-gray-100",children:[m.jsx("span",{className:"text-[10px] text-gray-500 w-14",children:"Dekking"}),m.jsx("input",{type:"range",min:"10",max:"100",value:x,onChange:M=>b(parseInt(M.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsxs("span",{className:"text-[10px] text-gray-500 w-8 text-right",children:[x,"%"]})]}),m.jsxs("div",{className:"px-3 pb-1.5 flex items-center justify-center gap-1.5",children:[m.jsx("span",{className:"text-[8px] text-gray-400",children:"Licht"}),m.jsxs("div",{className:"flex h-1.5 rounded overflow-hidden",children:[m.jsx("div",{className:"w-3",style:{backgroundColor:"#88D0F3"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#32B8A4"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#F4E61F"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#F09D1C"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#E12E18"}})]}),m.jsx("span",{className:"text-[8px] text-gray-400",children:"Zwaar"})]})]})}):null}const Moe={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},QSt={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function eTt(){const t=$i(i=>i.map),e=wd(i=>i.vondsten),n=Nn(i=>i.showLocalVondsten),r=X.useRef(null);return X.useEffect(()=>{if(!t)return;const i=new Od;return e.forEach(s=>{const o=new xi({geometry:new Vs(Pi([s.location.lng,s.location.lat])),vondst:s}),a=Moe[s.objectType]||Moe.Anders,l=QSt[s.objectType]||"?";o.setStyle((c,u)=>{let v=12;u>50?v=6:u>10?v=Math.max(6,12-(u-10)/10):u<2&&(v=14);const x=Math.max(8,Math.min(12,v-2));return new zn({image:new ja({radius:v,fill:new Nr({color:a}),stroke:new Sr({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new th({text:l,font:`bold ${x}px sans-serif`,fill:new Nr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(o)}),r.current?r.current.setSource(i):(r.current=new gp({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(n),t.addLayer(r.current)),()=>{r.current&&t&&(t.removeLayer(r.current),r.current=null)}},[t,e]),X.useEffect(()=>{r.current&&r.current.setVisible(n)},[n]),null}const tTt={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function nTt(t){const{type:e,coordinates:n}=t,r=s=>typeof s[0]=="number"?Pi(s):s.map(r),i=r(n);switch(e){case"Point":return new Vs(i);case"LineString":return new ro(i);case"Polygon":return new ou(i);case"MultiPoint":return new X1(i);case"MultiLineString":return new np(i);case"MultiPolygon":return new p1(i);default:return new Vs(Pi(n))}}function rTt(){const t=$i(i=>i.map),e=Co(i=>i.layers),n=Nn(i=>i.showCustomPointLayers),r=X.useRef(new Map);return X.useEffect(()=>{if(!t)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,o)=>{i.has(o)||(t.removeLayer(s),r.current.delete(o))}),e.forEach(s=>{const o=new Od;s.points.forEach(l=>{let c;const u=l.geometry&&l.geometry.type!=="Point";l.geometry?c=nTt(l.geometry):c=new Vs(Pi(l.coordinates));const h=new xi({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),f=tTt[l.category]||l.category.charAt(0).toUpperCase();if(u){const g=l.geometry.type;h.setStyle(()=>g==="Polygon"||g==="MultiPolygon"?new zn({fill:new Nr({color:s.color+"40"}),stroke:new Sr({color:s.color,width:2})}):g==="LineString"||g==="MultiLineString"?new zn({stroke:new Sr({color:s.color,width:3})}):new zn({image:new ja({radius:8,fill:new Nr({color:s.color}),stroke:new Sr({color:"#ffffff",width:2})})}))}else h.setStyle((g,v)=>{let A=12;v>50?A=6:v>10?A=Math.max(6,12-(v-10)/10):v<2&&(A=14);const I=Math.max(8,Math.min(12,A-2));return new zn({image:new ja({radius:A,fill:new Nr({color:s.color}),stroke:new Sr({color:"#ffffff",width:A>8?2:1})}),text:A>=8?new th({text:f,font:`bold ${I}px sans-serif`,fill:new Nr({color:"#ffffff"}),offsetY:1}):void 0})});o.addFeature(h)});const a=r.current.get(s.id);if(a)a.setSource(o),a.setVisible(n&&s.visible);else{const l=new gp({source:o,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:n&&s.visible});t.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{t&&t.removeLayer(s)}),r.current.clear()}},[t,e,n]),null}function iTt(){const{createLayerModalOpen:t,closeCreateLayerModal:e}=ri(),{addLayer:n}=Co(),r=Nn(),[i,s]=X.useState(""),[o,a]=X.useState([...Nm]),[l,c]=X.useState(""),u=14*r.fontScale/100,h=()=>{const b=l.trim();b&&!o.includes(b)&&(a([...o,b]),c(""))},f=b=>{a(o.filter(T=>T!==b))},g=b=>{o.includes(b)?a(o.filter(T=>T!==b)):a([...o,b])},v=()=>{i.trim()&&(n(i.trim(),o),s(""),a([...Nm]),c(""),e())},x=()=>{s(""),a([...Nm]),c(""),e()};return m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(nu,{size:18}),m.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:b=>r.setFontScale(parseInt(b.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(fi,{size:18})})]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${u}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),m.jsx("input",{type:"text",value:i,onChange:b=>s(b.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:Nm.map(b=>m.jsx("button",{onClick:()=>g(b),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${o.includes(b)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:b},b))})]}),o.filter(b=>!Nm.includes(b)).length>0&&m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:o.filter(b=>!Nm.includes(b)).map(b=>m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{onClick:()=>g(b),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:b}),m.jsx("button",{onClick:()=>f(b),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:m.jsx(wp,{size:12})})]},b))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:b=>b.key==="Enter"&&h()}),m.jsx("button",{onClick:h,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:m.jsx(uu,{size:20})})]})]})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${u}px`},children:[m.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const uEe=200,sTt=.7;async function oTt(t,e=uEe){return new Promise((n,r)=>{const i=new Image,s=document.createElement("canvas"),o=s.getContext("2d");i.onload=()=>{let a=i.width,l=i.height;a>l?a>e&&(l=Math.round(l*e/a),a=e):l>e&&(a=Math.round(a*e/l),l=e),s.width=a,s.height=l,o?.drawImage(i,0,0,a,l),s.toBlob(c=>{c?n(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",sTt)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(t)})}function aTt(t){return new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):n(new Error("Failed to convert blob to base64"))},r.onerror=()=>n(new Error("Failed to read blob")),r.readAsDataURL(t)})}async function lTt(t){const e=await oTt(t,uEe),n=await aTt(e);return{thumbnailBlob:e,thumbnailBase64:n}}function cTt(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const G8=5;function uTt({photos:t,onAddPhoto:e,onRemovePhoto:n,disabled:r}){const i=X.useRef(null),s=X.useRef(null),o=async l=>{const c=l.target.files;if(!c||c.length===0)return;const u=G8-t.length,h=Array.from(c).slice(0,u);for(const f of h)try{const{thumbnailBase64:g}=await lTt(f),v={id:cTt(),thumbnailBase64:g,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(g){console.error("Failed to process image:",g)}l.target.value=""},a=t.length<G8;return m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",t.length,"/",G8,")"]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.map(l=>m.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[m.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&m.jsx("button",{type:"button",onClick:()=>n(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:m.jsx(fi,{size:12,className:"text-white"})}),l.pendingUpload&&m.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),a&&!r&&m.jsxs(m.Fragment,{children:[m.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[m.jsx(YO,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),m.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[m.jsx(Wlt,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),m.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),m.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}function hTt(){const{addPointModalOpen:t,addPointModalLayerId:e,addPointModalLocation:n,closeAddPointModal:r}=ri(),{addPoint:i,getLayer:s}=Co(),o=Nn(),[a,l]=X.useState(""),[c,u]=X.useState(""),[h,f]=X.useState(""),[g,v]=X.useState([]),x=e?s(e):null,b=14*o.fontScale/100,T=()=>{!a.trim()||!e||!n||(i(e,{name:a.trim(),category:"Overig",notes:c.trim(),url:h.trim()||void 0,coordinates:[n.lng,n.lat],photos:g.length>0?g:void 0}),l(""),u(""),f(""),v([]),r())},A=()=>{l(""),u(""),f(""),v([]),r()};return x?m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:A}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(fc,{size:18}),m.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:I=>o.setFontScale(parseInt(I.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:A,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(fi,{size:18})})]})]}),m.jsx("div",{className:"px-4 py-1.5",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),m.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${b}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),m.jsx("input",{type:"text",value:a,onChange:I=>l(I.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsx(uTt,{photos:g,onAddPhoto:I=>v([...g,I]),onRemovePhoto:I=>v(g.filter(R=>R.id!==I))}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),m.jsx("textarea",{value:c,onChange:I=>u(I.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),m.jsx("input",{type:"url",value:h,onChange:I=>f(I.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),m.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${b}px`},children:[m.jsx("button",{onClick:A,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:T,disabled:!a.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function dTt(){const{layerManagerModalOpen:t,closeLayerManagerModal:e,openCreateLayerModal:n,openLayerDashboard:r}=ri(),{layers:i,removeLayer:s,toggleVisibility:o,toggleArchived:a,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=Co(),u=Nn(),h=14*u.fontScale/100,[f,g]=X.useState(null),[v,x]=X.useState(null),[b,T]=X.useState(null),[A,I]=X.useState(!1),R=i.filter(U=>!U.archived),M=i.filter(U=>U.archived),F=A?M:R,C=U=>{v===U?(s(U),x(null)):(x(U),setTimeout(()=>x(null),3e3))},N=U=>{l(U)},O=async U=>{const pe=U.target.files?.[0];if(pe){try{const Ne=await pe.text(),Se=c(Ne);Se.success||(T(Se.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}U.target.value=""}},j=()=>{g(null),x(null),T(null),I(!1),e()},V=U=>{r(U)},W=()=>{j(),n()};return m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:j}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(nu,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:u.fontScale,onChange:U=>u.setFontScale(parseInt(U.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${u.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:j,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(fi,{size:18})})]})]}),m.jsxs("div",{className:"flex border-b border-gray-100",children:[m.jsxs("button",{onClick:()=>I(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${A?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",R.length,")"]}),m.jsxs("button",{onClick:()=>I(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${A?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[m.jsx(owe,{size:14}),"Archief (",M.length,")"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${h}px`},children:[F.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:A?m.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),m.jsxs("button",{onClick:W,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[m.jsx(uu,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):m.jsx("div",{className:"divide-y divide-gray-100",children:F.map(U=>m.jsx(pTt,{layer:U,isExpanded:f===U.id,onToggleExpand:()=>g(f===U.id?null:U.id),onToggleVisibility:()=>o(U.id),onToggleArchived:()=>a(U.id),onOpenDashboard:()=>V(U.id),onExport:()=>N(U.id),onDelete:()=>C(U.id),confirmDelete:v===U.id,onRename:pe=>Co.getState().updateLayer(U.id,{name:pe}),onChangeColor:pe=>Co.getState().updateLayer(U.id,{color:pe})},U.id))}),b&&m.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:b})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[m.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[m.jsx(II,{size:16}),m.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),m.jsx("input",{type:"file",accept:".geojson,.json",onChange:O,className:"hidden"})]}),m.jsxs("button",{onClick:W,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[m.jsx(uu,{size:16}),m.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const fTt=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function pTt({layer:t,isExpanded:e,onToggleExpand:n,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:o,onDelete:a,confirmDelete:l,onRename:c,onChangeColor:u}){const[h,f]=X.useState(!1),[g,v]=X.useState(t.name),[x,b]=X.useState(!1),T=X.useRef(null);X.useEffect(()=>{h&&T.current&&(T.current.focus(),T.current.select())},[h]);const A=()=>{v(t.name),f(!0)},I=()=>{const N=g.trim();N&&N!==t.name&&c(N),f(!1)},R=()=>{v(t.name),f(!1)},M=N=>{N.key==="Enter"?I():N.key==="Escape"&&R()},F=t.points.filter(N=>N.status==="completed").length,C=t.points.length;return m.jsxs("div",{className:"bg-white",children:[m.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[m.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?m.jsx(ab,{size:16}):m.jsx(lb,{size:16})}),m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>b(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:t.color},title:"Kleur wijzigen"}),x&&m.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:fTt.map(N=>m.jsx("button",{onClick:()=>{u(N),b(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${N===t.color?"border-gray-800":"border-white"}`,style:{backgroundColor:N}},N))})]}),h?m.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[m.jsx("input",{ref:T,type:"text",value:g,onChange:N=>v(N.target.value),onKeyDown:M,onBlur:I,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),m.jsx("button",{onClick:I,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:m.jsx(up,{size:16})})]}):m.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:t.name}),m.jsx("div",{className:"text-xs text-gray-500",children:C>0?m.jsxs("span",{className:F===C?"text-green-600":"",children:[F,"/",C," voltooid"]}):"Geen punten"})]}),!h&&m.jsx("button",{onClick:A,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:m.jsx(k2,{size:16})}),m.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:m.jsx(pwe,{size:18})}),!t.archived&&m.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${t.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:t.visible?"Verbergen":"Tonen",children:t.visible?m.jsx(hN,{size:18}):m.jsx(uN,{size:18})}),m.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${t.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:t.archived?"Herstellen":"Archiveren",children:t.archived?m.jsx(jat,{size:18}):m.jsx(owe,{size:18})}),m.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:m.jsx(Qk,{size:18})}),m.jsx("button",{onClick:a,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(wp,{size:18})})]}),m.jsx(rr,{children:e&&m.jsx(Mt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:m.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[t.categories.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1",children:t.categories.map(N=>m.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:N},N))}),t.points.length>0&&m.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[t.points.slice(0,5).map(N=>m.jsx("div",{className:"flex items-center gap-2",children:m.jsx("span",{className:`font-medium ${N.status==="completed"?"text-green-600 line-through":N.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:N.name})},N.id)),t.points.length>5&&m.jsxs("div",{className:"text-gray-400",children:["...en ",t.points.length-5," meer"]})]}),m.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(t.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function mTt(){const{layerDashboardOpen:t,layerDashboardLayerId:e,closeLayerDashboard:n}=ri(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:o}=Co(),a=Nn(),[l,c]=X.useState("all"),[u,h]=X.useState(null),[f,g]=X.useState(""),[v,x]=X.useState(null),b=e?r(e):null,T=14*a.fontScale/100;if(!b)return null;const A=b.points.filter(V=>l==="all"?!0:V.status===l),I=b.points.length,R=b.points.filter(V=>V.status==="completed").length,M=b.points.filter(V=>V.status==="todo").length,F=b.points.filter(V=>V.status==="skipped").length,C=(V,W)=>{i(b.id,V,W)},N=V=>{s(b.id,V,{notes:f}),h(null),g("")},O=V=>{v===V?(o(b.id,V),x(null)):(x(V),setTimeout(()=>x(null),3e3))},j=()=>{h(null),x(null),n()};return m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:j}),m.jsxs(Mt.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:b.color}}),m.jsx("span",{className:"font-medium truncate",children:b.name})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:V=>a.setFontScale(parseInt(V.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:j,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(fi,{size:18})})]})]}),m.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[m.jsxs("span",{className:"text-orange-800 font-medium",children:[R,"/",I," voltooid"]}),m.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[m.jsxs("span",{className:"text-orange-600",children:[M," te doen"]}),F>0&&m.jsxs("span",{className:"text-gray-500",children:[F," overgeslagen"]})]})]}),m.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(V=>m.jsxs("button",{onClick:()=>c(V),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===V?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[V==="all"&&"Alles",V==="todo"&&"Te doen",V==="completed"&&"Voltooid",V==="skipped"&&"Overgeslagen"]},V))}),m.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:A.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:m.jsx("p",{children:"Geen punten gevonden"})}):m.jsx("div",{className:"divide-y divide-gray-100",children:A.map(V=>m.jsx("div",{className:"p-3",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[m.jsx("button",{onClick:()=>C(V.id,V.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${V.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:V.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:m.jsx(up,{size:14,className:V.status==="completed"?"text-green-600":"text-gray-400"})}),m.jsx("button",{onClick:()=>C(V.id,V.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${V.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:V.status==="skipped"?"Markeer als te doen":"Overslaan",children:m.jsx(zat,{size:14,className:V.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),V.photos&&V.photos.length>0&&m.jsxs("div",{className:"relative flex-shrink-0",children:[m.jsx("img",{src:V.photos[0].thumbnailUrl||V.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),V.photos.length>1&&m.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",V.photos.length-1]})]}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:`font-medium truncate ${V.status==="completed"?"text-green-700 line-through":V.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:V.name}),V.sourceLayer&&m.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",V.sourceLayer]})]}),u===V.id?m.jsxs("div",{className:"mt-2",children:[m.jsx("textarea",{value:f,onChange:W=>g(W.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),m.jsxs("div",{className:"flex gap-2 mt-1",children:[m.jsx("button",{onClick:()=>N(V.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),m.jsx("button",{onClick:()=>{h(null),g("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):V.notes?m.jsx("p",{className:"text-sm text-gray-600 mt-1",children:V.notes}):null,V.url&&m.jsxs("a",{href:V.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[m.jsx(vg,{size:12}),"Link"]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>{h(V.id),g(V.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:m.jsx(fct,{size:14})}),m.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${V.coordinates[1]},${V.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:m.jsx(fc,{size:14})}),m.jsx("button",{onClick:()=>O(V.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===V.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===V.id?"Klik nogmaals":"Verwijderen",children:m.jsx(wp,{size:14})})]})]})},V.id))})})]})]})})}function gTt(){const[t,e]=X.useState(navigator.onLine),[n,r]=X.useState(!1);return X.useEffect(()=>{const i=()=>{e(!0),r(!1)},s=()=>{e(!1),r(!1)};return window.addEventListener("online",i),window.addEventListener("offline",s),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",s)}},[]),t||n?null:m.jsx(rr,{children:m.jsx(Mt.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"fixed top-0 left-0 right-0 z-[2000] bg-amber-500 text-white px-4 py-2 shadow-lg",children:m.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(fut,{size:18}),m.jsx("span",{className:"text-sm font-medium",children:"Offline modus - Kaart werkt met gecachede data"})]}),m.jsx("button",{onClick:()=>r(!0),className:"p-1 hover:bg-white/20 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(fi,{size:16})})]})})})}function yTt(t){return t}function vTt(t){if(t==null)return yTt;var e,n,r=t.scale[0],i=t.scale[1],s=t.translate[0],o=t.translate[1];return function(a,l){l||(e=n=0);var c=2,u=a.length,h=new Array(u);for(h[0]=(e+=a[0])*r+s,h[1]=(n+=a[1])*i+o;c<u;)h[c]=a[c],++c;return h}}function _Tt(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}function xTt(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return Noe(t,n)})}:Noe(t,e)}function Noe(t,e){var n=e.id,r=e.bbox,i=e.properties==null?{}:e.properties,s=wTt(t,e);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function wTt(t,e){var n=vTt(t.transform),r=t.arcs;function i(u,h){h.length&&h.pop();for(var f=r[u<0?~u:u],g=0,v=f.length;g<v;++g)h.push(n(f[g],g));u<0&&_Tt(h,v)}function s(u){return n(u)}function o(u){for(var h=[],f=0,g=u.length;f<g;++f)i(u[f],h);return h.length<2&&h.push(h[0]),h}function a(u){for(var h=o(u);h.length<4;)h.push(h[0]);return h}function l(u){return u.map(a)}function c(u){var h=u.type,f;switch(h){case"GeometryCollection":return{type:h,geometries:u.geometries.map(c)};case"Point":f=s(u.coordinates);break;case"MultiPoint":f=u.coordinates.map(s);break;case"LineString":f=o(u.arcs);break;case"MultiLineString":f=u.arcs.map(o);break;case"Polygon":f=l(u.arcs);break;case"MultiPolygon":f=u.arcs.map(l);break;default:return null}return{type:h,coordinates:f}}return c(e)}async function vOt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.statusText}`);const n=await e.json();return console.log(` Loaded GeoJSON from ${t}`),n}catch(e){throw console.error(`Error loading GeoJSON from ${t}:`,e),e}}async function bTt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.statusText}`);const n=await e.json(),r=Object.keys(n.objects)[0],i=xTt(n,n.objects[r]);return console.log(` Loaded and converted TopoJSON from ${t}`),i}catch(e){throw console.error(`Error loading TopoJSON from ${t}:`,e),e}}function ETt(t){return new eL({featureProjection:"EPSG:3857"}).readFeatures(t)}const XH={all:{name:"Alle provincies",bounds:[3.37,50.75,7.21,53.47]},groningen:{name:"Groningen",bounds:[6.2,53.1,7.21,53.47]},friesland:{name:"Friesland",bounds:[5.05,52.85,6.25,53.45]},drenthe:{name:"Drenthe",bounds:[6.1,52.65,7.1,53.15]},overijssel:{name:"Overijssel",bounds:[5.85,52.15,6.9,52.7]},flevoland:{name:"Flevoland",bounds:[5.15,52.25,6,52.65]},gelderland:{name:"Gelderland",bounds:[5,51.75,6.4,52.45]},utrecht:{name:"Utrecht",bounds:[4.85,51.9,5.65,52.25]},"noord-holland":{name:"Noord-Holland",bounds:[4.5,52.2,5.25,52.95]},"zuid-holland":{name:"Zuid-Holland",bounds:[3.85,51.8,4.9,52.35]},zeeland:{name:"Zeeland",bounds:[3.37,51.2,4.3,51.75]},"noord-brabant":{name:"Noord-Brabant",bounds:[4.35,51.25,6,51.85]},limburg:{name:"Limburg",bounds:[5.55,50.75,6.25,51.8]}};function STt(t,e,n){if(n==="all")return!0;const r=XH[n];if(!r)return!0;const[i,s,o,a]=r.bounds;return t>=i&&t<=o&&e>=s&&e<=a}let _C=null;async function ZH(){if(_C)return _C;const t=await bTt("/detectorapp-nl/data/amk_monumenten_full.topojson");return _C=ETt(t),_C}function TTt(t,e,n=50){const r=t.toLowerCase(),i=e.toLowerCase(),s=r.indexOf(i);if(s===-1)return t.substring(0,100)+"...";const o=Math.max(0,s-n),a=Math.min(t.length,s+e.length+n);let l="";return o>0&&(l+="..."),l+=t.substring(o,a),a<t.length&&(l+="..."),l}async function kTt(t,e=50,n="all"){if(!t||t.length<2)return[];const r=await ZH(),i=[],o=t.toLowerCase().split(/\s+/).filter(a=>a.length>=2);for(const a of r){const l=(a.get("omschrijving")||"").toLowerCase(),c=(a.get("toponiem")||"").toLowerCase(),u=(a.get("txt_label")||"").toLowerCase();if(o.every(f=>l.includes(f)||c.includes(f)||u.includes(f))){const f=a.getGeometry();if(!f)continue;const g=f.getExtent(),v=oh(g),[x,b]=N2(v,"EPSG:3857","EPSG:4326");if(!STt(x,b,n))continue;const T=a.get("omschrijving")||"";if(i.push({id:a.get("ID")||a.get("monumentnummer"),monumentnummer:a.get("monumentnummer"),toponiem:a.get("toponiem")||"Onbekend",kwaliteitswaarde:a.get("kwaliteitswaarde")||"",periode:a.get("txt_label")||"",omschrijving:T,matchedText:TTt(T,o[0]),coordinates:[x,b],extent:g}),i.length>=e)break}}return i.sort((a,l)=>{const c={"zeer hoge archeologische waarde":3,"hoge archeologische waarde":2,"archeologische waarde":1};return(c[l.kwaliteitswaarde]||0)-(c[a.kwaliteitswaarde]||0)}),i}async function ATt(t){return(await ZH()).find(n=>n.get("monumentnummer")===t)||null}async function ITt(t){const e=await ZH(),n=new Set(t);return e.filter(r=>n.has(r.get("monumentnummer")))}const RTt={"zeer hoge archeologische waarde":"bg-purple-600","hoge archeologische waarde":"bg-purple-500","archeologische waarde":"bg-purple-400"},PTt={"zeer hoge archeologische waarde":"Zeer hoog","hoge archeologische waarde":"Hoog","archeologische waarde":"Waarde"};let Ox=null;function hEe(t){return Ox||(Ox=new gp({source:new Od,style:new zn({fill:new Nr({color:"rgba(147, 51, 234, 0.5)"}),stroke:new Sr({color:"#9333ea",width:3})}),zIndex:9999}),t.addLayer(Ox)),Ox}function CTt(){Ox&&Ox.getSource()?.clear()}async function MTt(t,e){const n=await ATt(e);if(!n)return;const i=hEe(t).getSource();i?.clear();const s=n.clone();i?.addFeature(s)}function NTt({isOpen:t,onClose:e}){const n=$i(Q=>Q.map),r=Nn(),[i,s]=X.useState(""),[o,a]=X.useState("all"),[l,c]=X.useState([]),[u,h]=X.useState(!1),[f,g]=X.useState(!1),[v,x]=X.useState(null),[b,T]=X.useState(null),[A,I]=X.useState(50),[R,M]=X.useState(!1),[F,C]=X.useState(!1),[N,O]=X.useState(!1),j=X.useRef(null),V=X.useRef(),W=X.useRef(null),U=13*r.fontScale/100;X.useEffect(()=>{t&&j.current&&setTimeout(()=>j.current?.focus(),100)},[t]),X.useEffect(()=>{if(!t)return;const Q=ne=>{W.current&&!W.current.contains(ne.target)&&e()},B=setTimeout(()=>{document.addEventListener("mousedown",Q)},100);return()=>{clearTimeout(B),document.removeEventListener("mousedown",Q)}},[t,e]),X.useEffect(()=>{t||M(!1)},[t]),X.useEffect(()=>{if(V.current&&clearTimeout(V.current),i.length<2){c([]),g(!1);return}return V.current=window.setTimeout(async()=>{h(!0),g(!0);try{const Q=await kTt(i,A,o);c(Q)}catch(Q){console.error("Monument search error:",Q),c([])}finally{h(!1)}},400),()=>{V.current&&clearTimeout(V.current)}},[i,o,A]);const pe=async Q=>{if(!n)return;const B=n.getView();if(v===Q.id){const ne=nd(Q.extent,50);B.fit(ne,{duration:500,maxZoom:18})}else{const ne=nd(Q.extent,200);B.fit(ne,{duration:500,maxZoom:16}),await MTt(n,Q.monumentnummer),x(Q.id),T(Q.id)}},Ne=(Q,B)=>{if(B.stopPropagation(),!n)return;const ne=n.getView(),ie=nd(Q.extent,20);ne.fit(ie,{duration:500,maxZoom:18})},Se=(Q,B)=>{B.stopPropagation(),T(b===Q?null:Q)},je=async()=>{if(!(!n||l.length===0)){O(!0);try{const Q=l.map(Ke=>Ke.monumentnummer),B=await ITt(Q);if(B.length===0)return;const ie=hEe(n).getSource();ie?.clear();let le=$a();B.forEach(Ke=>{const Te=Ke.clone();ie?.addFeature(Te);const we=Te.getGeometry();we&&(le=lz(le,we.getExtent()))});const ve=n.getView(),qe=nd(le,500);ve.fit(qe,{duration:500,maxZoom:14}),C(!0),x(null),console.log(` ${B.length} monumenten getoond op kaart`)}catch(Q){console.error("Error showing all monuments:",Q)}finally{O(!1)}}},de=()=>{e()},Oe=()=>{CTt(),s(""),a("all"),c([]),g(!1),x(null),T(null),I(50),C(!1),e()},Ae=Q=>{if(!i||i.length<2)return Q;const B=i.toLowerCase().split(/\s+/).filter(ie=>ie.length>=2);let ne=Q;return B.forEach(ie=>{const le=ie.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ve=new RegExp(`(${le})`,"gi");ne=ne.replace(ve,'<mark class="bg-yellow-200 px-0.5">$1</mark>')}),ne};return t?m.jsx(rr,{children:m.jsxs(Mt.div,{ref:W,initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-[1701] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{height:R?"85vh":"38vh"},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white cursor-pointer select-none",onClick:()=>M(!R),children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(fwe,{size:16}),m.jsx("span",{className:"font-medium text-sm",children:"Zoek monumenten"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(dwe,{size:20,className:"opacity-70"}),m.jsx("button",{onClick:Q=>{Q.stopPropagation(),de()},className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-2",children:m.jsx(fi,{size:16})})]})]}),m.jsx("div",{className:"p-2 border-b border-gray-100 space-y-2",children:m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("div",{className:"relative flex-1",children:[m.jsx(fN,{size:16,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),m.jsx("input",{ref:j,type:"text",value:i,onChange:Q=>{s(Q.target.value),x(null),T(null),C(!1)},placeholder:"bouwvoor, scherven...",className:"w-full pl-8 pr-8 py-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm"}),i&&m.jsx("button",{onClick:()=>{s(""),x(null),T(null),C(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:m.jsx(fi,{size:14})})]}),m.jsx("select",{value:o,onChange:Q=>{a(Q.target.value),x(null),T(null),C(!1)},className:"py-1.5 px-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm text-gray-700 w-28",children:Object.entries(XH).map(([Q,{name:B}])=>m.jsx("option",{value:Q,children:B},Q))})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${U}px`},children:[u&&m.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Zoeken..."}),!u&&f&&l.length===0&&m.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Geen resultaten"}),!u&&l.length>0&&m.jsxs("div",{className:"divide-y divide-gray-100",children:[m.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-xs text-gray-500 flex justify-between items-center gap-2",children:[m.jsxs("span",{children:[l.length,l.length>=A?"+":""," gevonden"]}),m.jsxs("div",{className:"flex items-center gap-2",children:[l.length>=A&&m.jsx("button",{onClick:()=>I(A+50),className:"text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent",children:"Meer laden"}),m.jsxs("button",{onClick:je,disabled:N,className:`flex items-center gap-1 px-2 py-1 rounded text-white border-0 outline-none transition-colors ${F?"bg-green-500 hover:bg-green-600":"bg-purple-500 hover:bg-purple-600"} ${N?"opacity-50 cursor-wait":""}`,children:[N?m.jsx(ZO,{size:12,className:"animate-spin"}):m.jsx(JO,{size:12}),m.jsx("span",{children:F?"Getoond":"Toon alle"})]})]})]}),l.map(Q=>m.jsxs("div",{className:`transition-colors ${v===Q.id?"bg-purple-50":"bg-transparent"}`,children:[m.jsx("button",{onClick:()=>pe(Q),className:"w-full text-left px-3 py-2 hover:bg-purple-50 transition-colors border-0 outline-none bg-transparent",children:m.jsxs("div",{className:"flex items-start justify-between gap-2",children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"font-medium text-gray-800 text-sm",children:Q.toponiem}),m.jsx("p",{className:"text-xs text-purple-600 mt-0.5",children:Q.periode})]}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[m.jsx("span",{className:`px-1.5 py-0.5 rounded text-white text-[9px] ${RTt[Q.kwaliteitswaarde]||"bg-gray-500"}`,children:PTt[Q.kwaliteitswaarde]||"AMK"}),v===Q.id&&m.jsx("button",{onClick:B=>Ne(Q,B),className:"p-1 bg-purple-500 hover:bg-purple-600 text-white rounded transition-colors border-0 outline-none",title:"Zoom in",children:m.jsx(yut,{size:12})})]})]})}),v===Q.id&&m.jsxs("div",{className:"px-3 pb-2",children:[m.jsxs("button",{onClick:B=>Se(Q.id,B),className:"flex items-center gap-1 text-xs text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent mb-1",children:[b===Q.id?m.jsx(XO,{size:14}):m.jsx(ab,{size:14}),b===Q.id?"Minder":"Omschrijving"]}),b===Q.id&&m.jsx("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 max-h-32 overflow-y-auto whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:Ae(Q.omschrijving)}})]})]},Q.id))]}),!u&&!f&&m.jsx("div",{className:"p-3 text-xs text-gray-500",children:"Zoek op trefwoorden in 13.000+ AMK monumenten"})]}),(v||i)&&m.jsx("div",{className:"p-2 border-t border-gray-100",children:m.jsx("button",{onClick:Oe,className:"w-full py-2 text-sm text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:"Wis zoekopdracht en highlight"})})]})}):null}const OTt=ho((t,e)=>({keyword:"",province:"all",isActive:!1,totalCount:0,filteredCount:0,setKeyword:n=>t({keyword:n}),setProvince:n=>t({province:n}),setActive:n=>t({isActive:n}),toggleActive:()=>t(n=>({isActive:!n.isActive})),clearFilter:()=>t({keyword:"",province:"all",isActive:!1}),updateCounts:(n,r)=>t({totalCount:n,filteredCount:r})}));function _Ot(t,e,n,r,i,s,o){if(s.length>=2){const l=s.toLowerCase().split(/\s+/).filter(g=>g.length>=2),c=t.toLowerCase(),u=e.toLowerCase(),h=n.toLowerCase();if(!l.every(g=>c.includes(g)||u.includes(g)||h.includes(g)))return!1}if(o!=="all"){const a=XH[o]?.bounds;if(a){const[l,c,u,h]=a;if(r<l||r>u||i<c||i>h)return!1}}return!0}function LTt(){const[t,e]=X.useState(!1),n=X.useRef(null),r=X.useRef(null),{keyword:i,isActive:s,totalCount:o,filteredCount:a,setKeyword:l,setActive:c,clearFilter:u}=OTt(),h=$i(x=>x.map);X.useEffect(()=>{t&&r.current&&setTimeout(()=>r.current?.focus(),100)},[t]),X.useEffect(()=>{if(!t)return;const x=T=>{n.current&&!n.current.contains(T.target)&&e(!1)},b=setTimeout(()=>{document.addEventListener("mousedown",x)},100);return()=>{clearTimeout(b),document.removeEventListener("mousedown",x)}},[t]),X.useEffect(()=>{h&&h.getLayers().forEach(x=>{const b=x.get("title");b&&b.startsWith("AMK")&&x.changed()})},[h,i,s]);const f=()=>{i.length>=2&&c(!s)},g=()=>{u(),r.current&&r.current.focus()},v=i.length>=2;return m.jsxs("div",{ref:n,children:[m.jsx(Mt.button,{onClick:()=>e(!t),className:`fixed bottom-[116px] left-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${s?"bg-purple-500 text-white":"bg-white/80 hover:bg-white/90 text-purple-600"}`,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Monument filter",children:m.jsx(Llt,{size:20})}),m.jsx(rr,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Mt.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),m.jsx(Mt.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[116px] left-[56px] z-[801] bg-white/95 rounded-xl shadow-lg backdrop-blur-sm overflow-hidden",children:m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[m.jsx("input",{ref:r,type:"text",value:i,onChange:x=>l(x.target.value),placeholder:"Zoek...",className:"w-28 px-2 py-1.5 text-sm bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-400"}),m.jsx("button",{onClick:f,disabled:!v,className:`px-2.5 py-1.5 text-sm rounded-lg transition-colors border-0 outline-none ${s?"bg-purple-500 text-white":v?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:s?"Aan":"Uit"}),(v||s)&&m.jsx("button",{onClick:g,className:"p-1 text-gray-400 hover:text-gray-600 rounded transition-colors border-0 outline-none",title:"Wissen",children:m.jsx(fi,{size:16})}),s&&o>0&&m.jsxs("span",{className:"text-xs text-purple-600 font-medium whitespace-nowrap",children:[a,"/",o]})]})})]})})]})}class Ooe{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const n=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/n)}add(e){if(this.buffer.length>0){const n=this.buffer[this.buffer.length-1];let r=e-n;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalize(this.buffer[0]);let e=0,n=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,n+=s}return this.normalize(e/n)}normalize(e){return(e%360+360)%360}clear(){this.buffer=[]}}function DTt(){const t=bs(c=>c.tracking),e=bs(c=>c.headingSource),n=bs(c=>c.rawGPSHeading),r=bs(c=>c.setSmoothedHeading),i=X.useRef(new Ooe(6)),s=X.useRef(new Ooe(10)),o=X.useRef(0),a=X.useRef(null),l=33;X.useEffect(()=>{if(!t||e!=="gps"||n===null||n===a.current)return;a.current=n;const c=performance.now();if(c-o.current<l)return;i.current.add(n);const u=i.current.getSmoothed();u!==null&&(o.current=c,r(u))},[t,e,n,r]),X.useEffect(()=>{if(!t||e!=="compass")return;let c=0;const u=80,h=f=>{const g=performance.now();if(g-c<u||g-o.current<l)return;c=g;let v=null;if(f.webkitCompassHeading!==void 0?v=f.webkitCompassHeading:f.alpha!==null&&(v=(360-f.alpha)%360),v!==null){s.current.add(v);const x=s.current.getSmoothed();x!==null&&(o.current=g,r(x))}};return window.addEventListener("deviceorientationabsolute",h),window.addEventListener("deviceorientation",h),()=>{window.removeEventListener("deviceorientationabsolute",h),window.removeEventListener("deviceorientation",h)}},[t,e,r]),X.useEffect(()=>{t||(i.current.clear(),s.current.clear(),a.current=null)},[t])}function $Tt(){const t=$i(i=>i.map),e=io(i=>i.setLayerOpacity),n=io(i=>i.visible),r=X.useRef(null);X.useEffect(()=>{if(!t)return;const i=()=>{const s=t.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const o=n["AHN 0.5m"],a=n["AHN4 Multi-Hillshade NL"];!o&&!a||(o&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),a&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return t.on("moveend",i),i(),()=>{t.un("moveend",i)}},[t,n,e])}const B8=2e3;function jTt(){const t=B5(x=>x.user),{layers:e,clearAll:n}=Co(),{vondsten:r,clearAll:i}=wd(),{savedRoutes:s}=wl(),o=X.useRef(null),a=X.useRef(!0),l=X.useRef(""),c=X.useRef(""),u=X.useRef(""),h=X.useCallback(async x=>{if(t)try{const b=Ay(Vf,"users",t.uid);await z6(b,{layers:x,layersUpdatedAt:U6()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(b){console.error(" Fout bij synchroniseren lagen:",b)}},[t]),f=X.useCallback(async x=>{if(t)try{const b=Ay(Vf,"users",t.uid);await z6(b,{vondsten:x,vondstenUpdatedAt:U6()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(b){console.error(" Fout bij synchroniseren vondsten:",b)}},[t]),g=X.useCallback(async x=>{if(t)try{const b=Ay(Vf,"users",t.uid);await z6(b,{routes:x,routesUpdatedAt:U6()},{merge:!0}),console.log(" Routes gesynchroniseerd naar cloud")}catch(b){console.error(" Fout bij synchroniseren routes:",b)}},[t]),v=X.useCallback(async()=>{if(t)try{const x=Ay(Vf,"users",t.uid),b=await iLe(x);if(b.exists()){const T=b.data();if(T.layers&&Array.isArray(T.layers)){const A=T.layers,I=Co.getState().layers,R=[...A],M=new Set(A.map(F=>F.id));I.forEach(F=>{M.has(F.id)||R.push(F)}),Co.setState({layers:R}),l.current=JSON.stringify(R),console.log(` ${A.length} lagen geladen uit cloud`)}if(T.vondsten&&Array.isArray(T.vondsten)){const A=T.vondsten,I=wd.getState().vondsten,R=[...A],M=new Set(A.map(F=>F.id));I.forEach(F=>{M.has(F.id)||R.push(F)}),wd.setState({vondsten:R}),c.current=JSON.stringify(R),console.log(` ${A.length} vondsten geladen uit cloud`)}if(T.routes&&Array.isArray(T.routes)){const A=T.routes,I=wl.getState().savedRoutes,R=[...A],M=new Set(A.map(C=>C.id));I.forEach(C=>{M.has(C.id)||R.push(C)});const F=new Set(R.map(C=>C.id));wl.setState({savedRoutes:R,visibleRouteIds:F}),u.current=JSON.stringify(R),console.log(` ${A.length} routes geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await h(e),await f(r),await g(s);a.current=!1}catch(x){console.error(" Fout bij laden uit cloud:",x),a.current=!1}},[t,e,r,s,h,f,g]);return X.useEffect(()=>{t?(a.current=!0,v()):(a.current=!0,l.current="",c.current="")},[t?.uid]),X.useEffect(()=>{if(!t||a.current)return;const x=JSON.stringify(e);if(x!==l.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{l.current=x,h(e)},B8),()=>{o.current&&clearTimeout(o.current)}},[t,e,h]),X.useEffect(()=>{if(!t||a.current)return;const x=JSON.stringify(r);if(x!==c.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{c.current=x,f(r)},B8),()=>{o.current&&clearTimeout(o.current)}},[t,r,f]),X.useEffect(()=>{if(!t||a.current)return;const x=JSON.stringify(s);if(x!==u.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{u.current=x,g(s)},B8),()=>{o.current&&clearTimeout(o.current)}},[t,s,g]),{isLoggedIn:!!t,syncLayersToCloud:h,syncVondstenToCloud:f,syncRoutesToCloud:g}}function FTt(){DTt(),$Tt(),jTt();const t=bs(f=>f.fetchPassivePosition);X.useEffect(()=>{t()},[t]);const n=14*Nn(f=>f.fontScale)/100,r=ri(f=>f.vondstFormOpen),i=ri(f=>f.vondstFormLocation),s=ri(f=>f.closeVondstForm),o=ri(f=>f.routeDashboardOpen),a=ri(f=>f.toggleRouteDashboard),l=ri(f=>f.monumentSearchOpen),c=ri(f=>f.closeMonumentSearch),u=KS(f=>f.showBuienradar),h=KS(f=>f.setShowBuienradar);return m.jsx(HEt,{children:m.jsxs("div",{style:{fontSize:`${n}px`},children:[m.jsx(gTt,{}),m.jsx(srt,{}),m.jsx(but,{}),m.jsx(eTt,{}),m.jsx(JEt,{}),m.jsx(rTt,{}),m.jsx(LSt,{}),m.jsx(DSt,{}),m.jsx($St,{}),m.jsx(FSt,{}),m.jsx(REt,{}),m.jsx(CEt,{}),m.jsx(GEt,{}),m.jsx(xut,{}),m.jsx(MSt,{}),m.jsx(NSt,{}),m.jsx(BEt,{}),m.jsx(Sut,{}),m.jsx(Mut,{}),m.jsx(UEt,{}),m.jsx(mSt,{}),m.jsx(jEt,{}),m.jsx(ySt,{}),m.jsx(FEt,{}),m.jsx(ZSt,{}),m.jsx(JSt,{isVisible:u,onClose:()=>h(!1)}),m.jsx(hSt,{}),m.jsx(iTt,{}),m.jsx(hTt,{}),m.jsx(dTt,{}),m.jsx(mTt,{}),m.jsx(HSt,{isOpen:o,onClose:a}),m.jsx(rr,{children:r&&m.jsx(lEe,{onClose:s,initialLocation:i||void 0})}),m.jsx(NTt,{isOpen:l,onClose:c}),m.jsx(LTt,{})]})})}const VTt="fef02a7628814a519d5f0eeb2d82656e";function zTt(){Qn.apiKey=VTt}zTt();console.log(`%c DetectorApp v${UN}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");RSe.createRoot(document.getElementById("root")).render(m.jsx(FTt,{}));export{Fqe as $,ya as A,Dde as B,Rkt as C,Kr as D,IDe as E,xi as F,eL as G,tRe as H,kA as I,Xe as J,Qn as K,ro as L,it as M,KIt as N,pg as O,Vs as P,zfe as Q,Qi as R,zn as S,Am as T,$r as U,Od as V,SCt as W,Ea as X,Wo as Y,sQ as Z,_,VRe as a,Zh as a$,Iye as a0,DCt as a1,LCt as a2,ACt as a3,Fk as a4,jk as a5,nb as a6,qCt as a7,iqe as a8,uye as a9,ye as aA,JLe as aB,pRt as aC,La as aD,Dn as aE,uI as aF,oI as aG,Or as aH,Kn as aI,pn as aJ,lh as aK,sIt as aL,ts as aM,hkt as aN,ede as aO,kl as aP,fo as aQ,nO as aR,Cg as aS,Ot as aT,Kt as aU,qUe as aV,_l as aW,_B as aX,H2 as aY,eg as aZ,Qm as a_,zCt as aa,UCt as ab,jCt as ac,Tk as ad,QG as ae,aa as af,ZA as ag,aqe as ah,Q3 as ai,p7e as aj,bCt as ak,uh as al,uXe as am,en as an,qt as ao,Yo as ap,Gs as aq,m2 as ar,Bt as as,Ze as at,CB as au,NB as av,z2 as aw,YE as ax,av as ay,Qge as az,gp as b,B1e as b$,Ny as b0,Wl as b1,j1 as b2,rl as b3,qqe as b4,sDe as b5,Gl as b6,Sa as b7,Of as b8,Hr as b9,Id as bA,_0e as bB,x0e as bC,v0e as bD,uMt as bE,Yte as bF,UMt as bG,BVe as bH,Lde as bI,iw as bJ,v2 as bK,Ok as bL,Qr as bM,lu as bN,EG as bO,uc as bP,Tr as bQ,Y2 as bR,da as bS,X2 as bT,gPt as bU,pPt as bV,mPt as bW,Ad as bX,vi as bY,b5t as bZ,x2 as b_,ja as ba,GIt as bb,XIt as bc,YIt as bd,kd as be,Gu as bf,xs as bg,Jt as bh,ore as bi,M0 as bj,N0 as bk,nde as bl,ide as bm,sde as bn,akt as bo,tkt as bp,qkt as bq,c5t as br,x5t as bs,$d as bt,XAt as bu,gg as bv,y0e as bw,PNt as bx,zQe as by,OHe as bz,Sr as c,uo as c$,pde as c0,W8e as c1,qAt as c2,Gfe as c3,fde as c4,GP as c5,uPt as c6,ml as c7,P1e as c8,Oy as c9,tMt as cA,V7e as cB,HCt as cC,hn as cD,sqe as cE,oqe as cF,kIt as cG,RIt as cH,IIt as cI,AIt as cJ,fBe as cK,wje as cL,Eje as cM,bje as cN,Sje as cO,rIt as cP,iIt as cQ,cu as cR,LKe as cS,FB as cT,sO as cU,ZPt as cV,e2 as cW,gqe as cX,$G as cY,PF as cZ,GQ as c_,CVe as ca,xAt as cb,_ve as cc,K5 as cd,MIt as ce,lB as cf,xa as cg,iQ as ch,qPt as ci,qn as cj,tde as ck,YA as cl,Ide as cm,G7e as cn,l6e as co,Fa as cp,Nkt as cq,tT as cr,z_ as cs,rI as ct,tn as cu,SIt as cv,TIt as cw,qIt as cx,CIt as cy,PIt as cz,sr as d,nve as d$,rAt as d0,nAt as d1,lRt as d2,cRt as d3,dCt as d4,uRt as d5,bPt as d6,Qnt as d7,mT as d8,EQe as d9,dV as dA,eet as dB,B6 as dC,gI as dD,o7 as dE,dPt as dF,SMt as dG,BMt as dH,pd as dI,Dfe as dJ,hCt as dK,dn as dL,fa as dM,Hu as dN,ea as dO,ufe as dP,rF as dQ,PQe as dR,Jhe as dS,yi as dT,w9 as dU,pB as dV,Wkt as dW,ha as dX,n4 as dY,Bkt as dZ,uIt as d_,X4t as da,Mn as db,J4t as dc,ib as dd,dB as de,Vfe as df,nI as dg,Jy as dh,$1 as di,f1e as dj,NCt as dk,zKe as dl,v7e as dm,$u as dn,UKe as dp,Va as dq,hc as dr,D_ as ds,Oi as dt,Kfe as du,lM as dv,WC as dw,q8e as dx,Gt as dy,Eve as dz,Nr as e,I1 as e$,Zg as e0,tve as e1,LZe as e2,vUe as e3,JTt as e4,QTt as e5,cve as e6,tb as e7,rJe as e8,oV as e9,zMt as eA,BRt as eB,eu as eC,wkt as eD,nRt as eE,ode as eF,YZe as eG,Bme as eH,tpe as eI,DKe as eJ,FCt as eK,MB as eL,M1 as eM,lqe as eN,WCt as eO,rc as eP,BCt as eQ,rqe as eR,dRt as eS,Bc as eT,cO as eU,$Ze as eV,pCt as eW,Qkt as eX,D6e as eY,lAt as eZ,NDe as e_,ov as ea,hh as eb,pI as ec,Nk as ed,wZe as ee,lve as ef,EZe as eg,sve as eh,ave as ei,HG as ej,qG as ek,oje as el,aje as em,aO as en,lO as eo,Mre as ep,Q5t as eq,Y5t as er,z5t as es,Ji as et,F5t as eu,sOt as ev,oOt as ew,ije as ex,Lee as ey,m8e as ez,_Ot as f,q5t as f$,wG as f0,yBe as f1,h0e as f2,HB as f3,vGe as f4,zZe as f5,PGe as f6,bZe as f7,ove as f8,ZZe as f9,qZe as fA,IZe as fB,RZe as fC,JZe as fD,el as fE,us as fF,tl as fG,W2 as fH,Dg as fI,DIt as fJ,xVe as fK,yF as fL,RG as fM,n2 as fN,vl as fO,r6e as fP,Jfe as fQ,Ufe as fR,EIt as fS,To as fT,xk as fU,zs as fV,JAt as fW,ZAt as fX,i_e as fY,s_e as fZ,U5t as f_,aRt as fa,H5 as fb,q5 as fc,Ode as fd,Jkt as fe,gVe as ff,B7e as fg,CMt as fh,HMt as fi,hI as fj,Xkt as fk,SG as fl,W5 as fm,xUe as fn,FGe as fo,QGe as fp,bXe as fq,U7e as fr,vRt as fs,t2 as ft,GCt as fu,Wme as fv,jGe as fw,EUe as fx,SUe as fy,TUe as fz,oh as g,bRt as g$,Pg as g0,qJ as g1,HIt as g2,X3t as g3,hXe as g4,Xf as g5,KDe as g6,Ak as g7,Di as g8,pge as g9,Ikt as gA,jkt as gB,J5t as gC,e6e as gD,t6e as gE,iF as gF,E$e as gG,lIt as gH,Gee as gI,$$e as gJ,y3t as gK,F1 as gL,$k as gM,ekt as gN,Mkt as gO,as as gP,a3t as gQ,o3t as gR,UAt as gS,ic as gT,bUe as gU,Kh as gV,nl as gW,d3t as gX,BIt as gY,xXe as gZ,SRt as g_,al as ga,ERt as gb,u2 as gc,jRt as gd,_$ as ge,tPt as gf,bO as gg,bB as gh,EB as gi,ePt as gj,cPt as gk,SO as gl,fze as gm,KYe as gn,Yge as go,tW as gp,HZe as gq,vCt as gr,gCt as gs,mI as gt,Ds as gu,yCt as gv,_p as gw,$g as gx,_Ct as gy,Yy as gz,vOt as h,Dkt as h$,hPt as h0,cUe as h1,CRt as h2,PVe as h3,MF as h4,Gi as h5,bNt as h6,qC as h7,f9 as h8,fx as h9,EGe as hA,u0e as hB,nKe as hC,NZe as hD,d0e as hE,oIt as hF,nje as hG,MUe as hH,IGe as hI,CUe as hJ,EO as hK,GC as hL,fkt as hM,GZe as hN,MZe as hO,Vye as hP,TMt as hQ,VB as hR,mXe as hS,pT as hT,Nf as hU,Zl as hV,zBe as hW,aAt as hX,eAt as hY,Wde as hZ,iGe as h_,uO as ha,fPt as hb,iv as hc,FMt as hd,AMt as he,LRt as hf,_Rt as hg,g$ as hh,WVe as hi,rv as hj,q2 as hk,B2 as hl,Fs as hm,XB as hn,Tje as ho,dje as hp,cpe as hq,zze as hr,fRt as hs,Pze as ht,UZe as hu,mIt as hv,zQ as hw,Qfe as hx,epe as hy,hRt as hz,th as i,Zx as i$,iI as i0,$de as i1,Xg as i2,dBe as i3,uBe as i4,lBe as i5,y$ as i6,r0e as i7,DVe as i8,Gx as i9,X4 as iA,o5t as iB,_T as iC,a5t as iD,LM as iE,JNt as iF,J3t as iG,xge as iH,Rk as iI,a9 as iJ,Nze as iK,Ege as iL,iRt as iM,ONt as iN,Kkt as iO,d$e as iP,Pte as iQ,XA as iR,Jnt as iS,R1 as iT,gG as iU,WDe as iV,NRt as iW,tGe as iX,to as iY,wge as iZ,Mze as i_,jDe as ia,Td as ib,tOt as ic,vMt as id,yMt as ie,rKe as ig,ige as ih,dze as ii,jee as ij,L7e as ik,Ik as il,a2 as im,pAt as io,E8e as ip,I8e as iq,C8e as ir,ad as is,Ykt as it,NAt as iu,M7e as iv,HQe as iw,n5t as ix,bve as iy,l5t as iz,Pi as j,nVe as j$,XTt as j0,j1e as j1,xB as j2,H as j3,uje as j4,yd as j5,aXe as j6,QB as j7,NVe as j8,IRt as j9,yB as jA,r9 as jB,gB as jC,ORt as jD,WRt as jE,Hee as jF,Xge as jG,iAt as jH,B0e as jI,VAt as jJ,nOt as jK,Mm as jL,Zze as jM,RPt as jN,SPt as jO,zh as jP,mkt as jQ,gkt as jR,pkt as jS,PDe as jT,nv as jU,yGe as jV,jme as jW,c0e as jX,JIt as jY,tVe as jZ,ZIt as j_,u4 as ja,r_e as jb,ytt as jc,vtt as jd,D5t as je,qtt as jf,$5t as jg,P5t as jh,R5t as ji,Ytt as jj,AS as jk,L5t as jl,eUe as jm,wUe as jn,_Ue as jo,kZe as jp,nJe as jq,iJe as jr,Fze as js,Hge as jt,rje as ju,AZe as jv,rve as jw,xMt as jx,_Mt as jy,qo as jz,QA as k,HDe as k$,Nfe as k0,mNt as k1,pNt as k2,fNt as k3,dNt as k4,yNt as k5,gNt as k6,hNt as k7,uNt as k8,$ye as k9,DPt as kA,qXe as kB,KXe as kC,ive as kD,tRt as kE,HYe as kF,s$e as kG,wAt as kH,uDe as kI,ZNt as kJ,Wje as kK,Jje as kL,sI as kM,gIt as kN,hIt as kO,dIt as kP,Okt as kQ,UDe as kR,GAt as kS,CG as kT,IAt as kU,AAt as kV,xRt as kW,v$e as kX,y$e as kY,zRt as kZ,$Rt as k_,Oze as ka,rQ as kb,cNt as kc,XG as kd,Kje as ke,iVe as kf,hG as kg,ykt as kh,dG as ki,vkt as kj,wI as kk,Xx as kl,WYe as km,h6e as kn,u5t as ko,Dye as kp,r2 as kq,J5 as kr,If as ks,ECt as kt,iO as ku,hB as kv,bkt as kw,qB as kx,kMt as ky,EMt as kz,bTt as l,NPt as l$,vde as l0,bi as l1,YAt as l2,zO as l3,_W as l4,gl as l5,UO as l6,aOt as l7,vd as l8,kAt as l9,KVe as lA,sre as lB,$Ve as lC,LVe as lD,Y4 as lE,age as lF,TNt as lG,ENt as lH,SNt as lI,VQe as lJ,Jet as lK,ott as lL,oDe as lM,Pkt as lN,yde as lO,X5 as lP,$kt as lQ,Dk as lR,pYe as lS,Fge as lT,PRt as lU,U$ as lV,JA as lW,sAt as lX,gF as lY,xO as lZ,OPt as l_,j_ as la,UIt as lb,kge as lc,Tge as ld,sUe as le,sM as lf,rge as lg,qRt as lh,SB as li,V_ as lj,jPt as lk,FPt as ll,VPt as lm,oPt as ln,iPt as lo,QRt as lp,Aze as lq,rPt as lr,rUe as ls,$It as lt,ARt as lu,$Pt as lv,I3t as lw,Xy as lx,w5t as ly,skt as lz,E as m,ZTt as m$,fge as m0,hge as m1,oze as m2,lze as m3,_He as m4,yS as m5,wx as m6,f3t as m7,VCt as m8,F7e as m9,SKe as mA,QXe as mB,xkt as mC,CGe as mD,eKe as mE,bGe as mF,SGe as mG,oNt as mH,sT as mI,TCt as mJ,Jge as mK,Zme as mL,rde as mM,Akt as mN,kde as mO,npe as mP,eQ as mQ,Vde as mR,Vet as mS,mRt as mT,bge as mU,sRt as mV,fB as mW,jde as mX,Ckt as mY,e9 as mZ,Mqe as m_,g3t as ma,p3t as mb,yg as mc,fet as md,met as me,get as mf,Xde as mg,mCt as mh,NG as mi,q_ as mj,BXe as mk,wNt as ml,$8e as mm,Ofe as mn,xqe as mo,IO as mp,gM as mq,Eqe as mr,Xme as ms,h3t as mt,mVe as mu,rOt as mv,eS as mw,kf as mx,Fm as my,vs as mz,Tt as n,P4 as n$,Z0e as n0,s9 as n1,M3t as n2,C3t as n3,qYe as n4,bMt as n5,wMt as n6,_G as n7,VGe as n8,$Ge as n9,z8e as nA,jye as nB,g2 as nC,l3t as nD,c3t as nE,u3t as nF,cB as nG,Zkt as nH,ukt as nI,$1e as nJ,HNt as nK,WNt as nL,iNt as nM,sNt as nN,zkt as nO,A1e as nP,U1e as nQ,_2 as nR,Xh as nS,wB as nT,lge as nU,dI as nV,T1e as nW,bI as nX,R3t as nY,o8 as nZ,FIt as n_,OZe as na,DGe as nb,aKe as nc,FAt as nd,OG as ne,ZG as nf,KAt as ng,f_ as nh,tDe as ni,IF as nj,e5t as nk,Fet as nl,t5t as nm,QNt as nn,xve as no,uW as np,Aa as nq,Lze as nr,AE as ns,QIt as nt,LQe as nu,wCt as nv,m3t as nw,xCt as nx,BNt as ny,LNt as nz,ue as o,wQ as o$,XZe as o0,mze as o1,w4 as o2,aIt as o3,QVe as o4,jIt as o5,Js as o6,Zs as o7,qMt as o8,XMt as o9,Ukt as oA,TQe as oB,OVe as oC,lkt as oD,ikt as oE,ude as oF,nIt as oG,tIt as oH,yRt as oI,Mde as oJ,hYe as oK,XYe as oL,k1e as oM,Pve as oN,_kt as oO,VNt as oP,zNt as oQ,UNt as oR,GNt as oS,ANt as oT,RNt as oU,INt as oV,pet as oW,Mg as oX,OKe as oY,Oye as oZ,Rqe as o_,WMt as oa,f$e as ob,Hkt as oc,hpe as od,BYe as oe,gze as of,yze as og,iM as oh,RRt as oi,rze as oj,ize as ok,Unt as ol,tu as om,OO as on,yZe as oo,bAt as op,D1e as oq,F1e as or,AXe as os,e4t as ot,DXe as ou,t4t as ov,hGe as ow,zIt as ox,cIt as oy,WIt as oz,ETt as p,dge as p$,X8e as p0,NIt as p1,P3t as p2,eIt as p3,QAt as p4,xje as p5,rtt as p6,p$e as p7,itt as p8,Qet as p9,F$e as pA,NNt as pB,MNt as pC,JQe as pD,CNt as pE,aNt as pF,lNt as pG,$Nt as pH,jNt as pI,qNt as pJ,KNt as pK,vNt as pL,YNt as pM,XNt as pN,FQe as pO,GQe as pP,Uve as pQ,s2 as pR,FNt as pS,RQe as pT,Lkt as pU,Dze as pV,LUe as pW,wze as pX,GRt as pY,D3t as pZ,HGe as p_,EPt as pa,rNt as pb,fCt as pc,Uqe as pd,$Ct as pe,ICt as pf,CCt as pg,RCt as ph,MCt as pi,PCt as pj,OCt as pk,v5t as pl,XJ as pm,kCt as pn,IVe as po,TRt as pp,FVe as pq,MRt as pr,ZMt as ps,GXe as pt,Wc as pu,FRt as pv,kNt as pw,$c as px,DNt as py,fIt as pz,or as q,NGe as q$,Uge as q0,pfe as q1,vT as q2,Fkt as q3,WGe as q4,UPt as q5,URt as q6,ABe as q7,ire as q8,QLe as q9,Rve as qA,xNt as qB,_Nt as qC,aet as qD,nNt as qE,nPt as qF,Cf as qG,o9 as qH,HRt as qI,Ma as qJ,iDe as qK,tJe as qL,okt as qM,$Mt as qN,jMt as qO,Vze as qP,nBe as qQ,tBe as qR,zge as qS,bHe as qT,AGe as qU,TGe as qV,kGe as qW,UGe as qX,eBe as qY,TPt as qZ,UYe as q_,rkt as qa,nkt as qb,tUe as qc,yqe as qd,M5t as qe,N5t as qf,kqe as qg,C5t as qh,Vk as qi,Uk as qj,_qe as qk,Ekt as ql,Oqe as qm,Lqe as qn,BB as qo,Wnt as qp,i5t as qq,s5t as qr,rRt as qs,r5t as qt,_5t as qu,g5t as qv,y5t as qw,m5t as qx,p5t as qy,het as qz,E2e as r,yPt as r$,Q3t as r0,iOt as r1,Z3t as r2,jg as r3,X5t as r4,eOt as r5,Z5t as r6,Rze as r7,KRt as r8,ZRt as r9,Vkt as rA,ate as rB,cMt as rC,B3t as rD,NMt as rE,_Ge as rF,yx as rG,sKe as rH,eRt as rI,fMt as rJ,RMt as rK,oRt as rL,uze as rM,iKe as rN,vpe as rO,wpe as rP,IPt as rQ,LMt as rR,APt as rS,kPt as rT,VRt as rU,RB as rV,Gkt as rW,DMt as rX,RGe as rY,tKe as rZ,zGe as r_,aPt as ra,YRt as rb,JRt as rc,lPt as rd,iUe as re,sGe as rf,kRt as rg,yI as rh,vI as ri,_I as rj,RYe as rk,G3t as rl,GMt as rm,PMt as rn,OMt as ro,MMt as rp,Skt as rq,n3t as rr,t3t as rs,dkt as rt,IMt as ru,DRt as rv,VMt as rw,hHe as rx,eZe as ry,Y1e as rz,Xn as s,_Pt as s0,E5t as s1,N2 as t,OTt as u,Mi as v,vn as w,_e as x,tAt as y,hi as z};
//# sourceMappingURL=index-BBCP9iy9.js.map
