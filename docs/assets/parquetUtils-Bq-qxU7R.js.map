{"version":3,"file":"parquetUtils-Bq-qxU7R.js","sources":["../../node_modules/@arcgis/core/layers/support/ParquetEncodingBase.js","../../node_modules/@arcgis/core/layers/support/ParquetEncodingLocation.js","../../node_modules/@arcgis/core/layers/support/ParquetEncodingWkb.js","../../node_modules/@arcgis/core/layers/support/parquetUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as o}from\"tslib\";import{ClonableMixin as r}from\"../../core/Clonable.js\";import{JSONSupport as e}from\"../../core/JSONSupport.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";let p=class extends(r(e)){constructor(o){super(o),this.type=null}};o([s({type:[\"wkb\",\"location\"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],p.prototype,\"type\",void 0),p=o([t(\"esri.layers.support.ParquetEncodingBase\")],p);export{p as ParquetEncodingBase};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{ParquetEncodingBase as r}from\"./ParquetEncodingBase.js\";let i=class extends r{constructor(e){super(e),this.type=\"location\",this.latitudeFieldName=null,this.longitudeFieldName=null}};e([o({type:[\"location\"]})],i.prototype,\"type\",void 0),e([o({type:String,json:{name:\"yField\",write:{isRequired:!0}}})],i.prototype,\"latitudeFieldName\",void 0),e([o({type:String,json:{name:\"xField\",write:{isRequired:!0}}})],i.prototype,\"longitudeFieldName\",void 0),i=e([t(\"esri.layers.support.ParquetEncodingLocation\")],i);export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as r}from\"tslib\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";import{ParquetEncodingBase as t}from\"./ParquetEncodingBase.js\";let s=class extends t{constructor(r){super(r),this.type=\"wkb\",this.primaryFieldName=null}};r([o({type:[\"wkb\"]})],s.prototype,\"type\",void 0),r([o({type:[\"counter-clockwise\"],json:{write:!0}})],s.prototype,\"orientation\",void 0),r([o({type:String,json:{name:\"field\",write:{isRequired:!0}}})],s.prototype,\"primaryFieldName\",void 0),s=r([e(\"esri.layers.support.ParquetEncodingWkb\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import t from\"../../core/Error.js\";import{JSONMap as o}from\"../../core/jsonMap.js\";import n from\"../../geometry/SpatialReference.js\";import i from\"./Field.js\";import{inferLocationInfo as r}from\"./locationUtils.js\";import l from\"./ParquetEncodingLocation.js\";import s from\"./ParquetEncodingWkb.js\";import{createParquetFile as a,readGeoMetadata as u,readEsriMetadata as m}from\"../../libs/parquet/parquet.js\";const c=new o({esriGeometryPoint:\"point\",esriGeometryPolygon:\"polygon\",esriGeometryPolyline:\"polyline\",esriGeometryMultipoint:\"multipoint\"});function p(e){return c.toJSON(e)}function f(e){return c.fromJSON(e)}function d(t,o={}){return y({urls:new e(t)},o)}async function y(e,o={}){if(e.urls.length<1)throw new t(\"parquet:bad-input\",\"At least one url must be specified\",e);if(e.geometryType&&e.spatialReference&&e.encoding&&e.fields)return e;const r=await a(e.urls.getItemAt(0),{getCustomParameters:()=>o.customParameters}),l=u(r),s={...e,file:r};null==s.fields&&(s.fields=r.fields().map(e=>i.fromJSON({name:e.name,alias:e.name,type:e.type}))),null==s.encoding&&(s.encoding=g(l,s.fields));const c=m(r);if(c)switch(c.mode){case\"z\":s.displayOptimization={mode:\"z\"};break;case\"xz\":{const e=c.multiscale;if(!e)throw new t(\"parquet:bad-format\",\"XZ display optimization requires multiscale geometries\");s.displayOptimization={mode:\"xz\",multiscale:e};break}}if(!s.encoding)return s;switch(s.encoding.type){case\"location\":null==s.spatialReference&&(s.spatialReference=n.WGS84),null==s.geometryType&&(s.geometryType=\"point\");break;case\"wkb\":{if(!l)return s;const e=l.primary_column,t=l.columns[e];if(s.geometryType||(s.geometryType=P(t)),s.spatialReference||(s.spatialReference=b(t)),s.fields)for(const o of Object.keys(l.columns))s.fields=s.fields.filter(e=>e.name!==o)}}return s}function g(e,t){if(null!=e){const t=e.primary_column,o=e.columns[t];return new s({primaryFieldName:t,orientation:\"counterclockwise\"===o.orientation?\"counter-clockwise\":null})}const o=r(t.map(e=>e.name));return o.latitudeFieldName&&o.longitudeFieldName?new l({latitudeFieldName:o.latitudeFieldName,longitudeFieldName:o.longitudeFieldName}):null}function w(e){switch(e){case\"Point\":return\"point\";case\"Polygon\":case\"MultiPolygon\":return\"polygon\";case\"LineString\":return\"polyline\";case\"MultiPoint\":return\"multipoint\";default:return null}}function P(e){const{geometry_types:o}=e,n=new Set;for(const t of o){const e=w(t);e&&n.add(e)}if(n.size>1)throw new t(\"parquet:unsupported\",\"Parquet mixed geometry types are not supported\",{geometryTypes:n});return 1===n.size?n.values().next().value:void 0}function b(e){const t=e.crs?.id?.code;return t&&\"number\"==typeof t?new n({wkid:t}):void 0}export{y as completeParquetLayerInfo,f as fromParquetJSONGeometryType,d as getParquetLayerInfo,c as parquetGeometryTypeKebabDict,p as toParquetJSONGeometryType};\n"],"names":["p","r","e","o","s","t","i","c","f","y","a","l","u","g","m","n","P","b","w"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}