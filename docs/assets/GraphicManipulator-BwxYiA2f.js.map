{"version":3,"file":"GraphicManipulator-BwxYiA2f.js","sources":["../../node_modules/@arcgis/core/views/interactive/editGeometry/operations/curveOperationUtils.js","../../node_modules/@arcgis/core/views/interactive/support/utils.js","../../node_modules/@arcgis/core/views/interactive/GraphicManipulator.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{fromValues as r,create as t}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{mul as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{toEllipticArc7 as e}from\"../../../../geometry/support/curves/circularArcUtils.js\";import{isCircularArc as s}from\"../../../../geometry/support/curves/curveUtils.js\";import{transformEllipticArc as i}from\"../../../../geometry/support/curves/ellipticArc7Utils.js\";function m(r,t,o,m,p,u,l,a){const f=t??o.leftVertex.pos,n=s(r)?e(f,r):r,[g,j,v,x,y,h,U]=n.a,b=y??0,A=h??Math.hypot(g[0]-j[0],g[1]-j[1]),M=U??1,V=c(m[0],m[1],p[0],p[1],u[0],u[1],l,a);return i(f,{a:[g,j,v,x,b,A,M]},V)}function c(e,s,i,m,c,p,u,l){const a=r(1,0,0,0,1,0,-e,-s,1),f=u-1,n=r(i*i*f+1,m*i*f,0,i*m*f,m*m*f+1,0,0,0,1),g=l-1,j=r(c*c*g+1,p*c*g,0,c*p*g,p*p*g+1,0,0,0,1),v=r(1,0,0,0,1,0,e,s,1),x=t();return o(x,n,a),o(x,j,x),o(x,v,x),x}export{c as getScaleTransform,m as scaleArc};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{pt2px as o}from\"../../../core/screenUtils.js\";function s(s){let t=0,a=0,e=0;return s?(\"cim\"===s.type&&s.data.symbol&&\"symbolLayers\"in s.data.symbol&&s.data.symbol.symbolLayers&&s.data.symbol.symbolLayers.map(o=>{\"CIMVectorMarker\"===o.type&&o.anchorPoint&&(Math.abs(o.anchorPoint.x)>t&&(t=o.anchorPoint.x),Math.abs(o.anchorPoint.y)>a&&(a=o.anchorPoint.y),null!=o.size&&o.size>e&&(e=o.size))}),t=o(t),a=o(a),e=o(e),{offsetX:t,offsetY:a,size:e}):{offsetX:t,offsetY:a,size:e}}export{s as getSymbolInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as t}from\"tslib\";import e from\"../../core/Accessor.js\";import{EventEmitter as o}from\"../../core/Evented.js\";import{watch as i,sync as s}from\"../../core/reactiveUtils.js\";import{screenPointObjectToArray as r,pt2px as l,createScreenPointArray as n}from\"../../core/screenUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as c}from\"../../core/accessorSupport/decorators/subclass.js\";import{squaredDistance as h}from\"../../core/libs/gl-matrix-2/math/vec2.js\";import{k as p}from\"../../chunks/vec32.js\";import{create as m}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{canProjectWithoutEngine as u,project as y}from\"../../geometry/projectionUtils.js\";import{projectPointToVector as g}from\"../../geometry/projection/projectPointToVector.js\";import{getGraphicEffectiveElevationMode as b}from\"../../support/elevationInfoUtils.js\";import{getDefaultSymbol2D as d}from\"../../symbols/support/defaults.js\";import f from\"../../symbols/support/ElevationInfo.js\";import{getSymbolInfo as _}from\"./support/utils.js\";import{intersectsDrapedGeometry as v}from\"../support/drapedUtils.js\";let S=class extends e{set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set(\"graphic\",t),this.attachSymbolChanged()}get elevationInfo(){const{layer:t}=this.graphic,e=t&&\"elevationInfo\"in t?t.elevationInfo:null,o=b(this.graphic),i=e?e.offset:0;return new f({mode:o,offset:i})}set focusedSymbol(t){t!==this._get(\"focusedSymbol\")&&(this._set(\"focusedSymbol\",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get(\"grabbing\")&&(this._set(\"grabbing\",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get(\"hovering\")&&(this._set(\"hovering\",t),this._updateGraphicSymbol())}set selected(t){t!==this._get(\"selected\")&&(this._set(\"selected\",t),this._updateGraphicSymbol(),this.events.emit(\"select-changed\",{action:t?\"select\":\"deselect\"}))}get _focused(){return this._get(\"hovering\")||this._get(\"grabbing\")}constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new o,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set(\"view\",null)}intersectionDistance(t){const e=this.graphic;if(!1===e.visible)return null;const o=e.geometry;if(null==o)return null;const i=this._get(\"focusedSymbol\"),s=null!=i?i:e.symbol;return\"2d\"===this.view.type?this._intersectDistance2D(this.view,t,o,s):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=i(()=>this.graphic?.symbol,t=>{null!=t&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))},s)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,o,i){if(null==(i=i||d(o)))return null;const s=1;let n=this._circleCollisionCache;if(\"point\"===o.type&&\"cim\"===i.type&&\"CIMPointSymbol\"===i.data.symbol?.type&&i.data.symbol.symbolLayers){const{offsetX:l,offsetY:n,size:a}=_(i),c=r(e,j),p=a/2,m=t.toScreen(o),u=m.x+l,y=m.y+n;return h(c,[u,y])<p*p?s:null}if(\"point\"!==o.type||\"simple-marker\"!==i.type)return v(e,o,t)?s:null;if(null==n||!n.originalPoint.equals(o)){const e=o,s=t.spatialReference;if(u(e.spatialReference,s)){const t=y(e,s);n={originalPoint:e.clone(),mapPoint:t,radiusPx:l(i.size)},this._circleCollisionCache=n}}if(null!=n){const o=r(e,j),a=t.toScreen?.(n.mapPoint);if(!a)return null;const c=n.radiusPx,p=a.x+l(i.xoffset),m=a.y-l(i.yoffset);return h(o,[p,m])<c*c?s:null}return null}_intersectDistance3D(t,e,o){const i=t.toMap(e,{include:[o]});return i&&g(i,C,t.renderSpatialReference)?p(C,t.state.camera.eye):null}};t([a({constructOnly:!0,nonNullable:!0})],S.prototype,\"graphic\",null),t([a()],S.prototype,\"elevationInfo\",null),t([a({constructOnly:!0,nonNullable:!0})],S.prototype,\"view\",void 0),t([a({value:null})],S.prototype,\"focusedSymbol\",null),t([a({constructOnly:!0})],S.prototype,\"layer\",void 0),t([a()],S.prototype,\"interactive\",void 0),t([a()],S.prototype,\"selectable\",void 0),t([a()],S.prototype,\"grabbable\",void 0),t([a({value:!1})],S.prototype,\"grabbing\",null),t([a()],S.prototype,\"dragging\",void 0),t([a()],S.prototype,\"hovering\",null),t([a({value:!1})],S.prototype,\"selected\",null),t([a()],S.prototype,\"cursor\",void 0),S=t([c(\"esri.views.interactive.GraphicManipulator\")],S);const C=m(),j=n();export{S as GraphicManipulator};\n"],"names":["m","r","t","o","p","u","l","a","f","n","s","e","g","j","v","x","y","h","U","b","A","M","V","c","i","S","d","_","C"],"mappings":"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","x_google_ignoreList":[0,1,2]}