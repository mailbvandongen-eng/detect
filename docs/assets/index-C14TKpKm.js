const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/arcgisAHNLayers-DJcJ2p-F.js","assets/ImageryLayer-yumGdcaN.js","assets/MultiOriginJSONSupport-CYuiJalZ.js","assets/GraphicOrigin-CiP-F44_.js","assets/isImageryGraphicOrigin-Ccuhb4eK.js","assets/OperationalLayer-DmYYiLre.js","assets/layerContainerType-CSXZNpHb.js","assets/ElevationInfo-C4XcKNCF.js","assets/lengthUtils-BzOwjCsy.js","assets/datasetUtils-BZ3ziHvD.js","assets/RasterJobHandlerMixin-Cn1PaxsJ.js","assets/ClassBreaksRenderer-IkJODK_d.js","assets/commonProperties-B2UmoQ_C.js","assets/colorRamps-B2Ns9k3D.js","assets/ColorStop-YEzK5v4w.js","assets/visualVariableUtils-BTCGF0Ub.js","assets/jsonUtils-DWOKXYwC.js","assets/defaults3D-Dce00EcX.js","assets/defaults-02w22JSx.js","assets/defaultsJSON-GKolV7NZ.js","assets/RendererLegendOptions-BydLwEvV.js","assets/UniqueValueRenderer-BKzyTBrp.js","assets/diffUtils-BaoNnCtT.js","assets/styleUtils-D4gt0oVh.js","assets/RasterSymbolizer-D199qz3x.js","assets/PixelBlock-C0HXZ9KJ.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/vectorFieldUtils-DTo8WkH8.js","assets/colorUtils-p2Y4Ohj7.js","assets/vec42-DsIZdq-T.js","assets/vec4f64-DPb6J-GU.js","assets/utils-1e8Woilg.js","assets/cimSymbolUtils-BxpeCHMS.js","assets/utils-DQaLv0i_.js","assets/defaultCIMValues-XI-Li77m.js","assets/LRUCache-CcVw-wgh.js","assets/MemCache-uTHO2gRM.js","assets/ClassBreaksDefinition-Bjn2-pvh.js","assets/dataUtils-tNQllN6V.js","assets/FieldsIndex-CZxdGupt.js","assets/UnknownTimeZone-Cl28kLUv.js","assets/imageBitmapUtils-eat4Sc2y.js","assets/rasterFieldUtils-BCljRFqH.js","assets/FeatureSet-C1rDBsoG.js","assets/RasterPresetRendererMixin-CM0TZNwj.js","assets/executeForIds-DbfUm78U.js","assets/query-DaqCArbj.js","assets/pbfQueryUtils-NaVXcXAz.js","assets/pbf-DoCjiAjy.js","assets/memoryEstimations-BTx5LQ-3.js","assets/OptimizedFeature-Bd8m6JDA.js","assets/OptimizedFeatureSet-BR8EEvDc.js","assets/queryZScale-DU0dyxWJ.js","assets/executeQueryJSON-hDJwirgv.js","assets/ArcGISService-BHXELemM.js","assets/BlendLayer-fUBce7Vs.js","assets/jsonUtils-BtBFeKH_.js","assets/parser-8UB7vdwi.js","assets/CustomParametersMixin-DeW3wUNG.js","assets/PortalLayer-CT5hrs2h.js","assets/portalItemUtils-BRQYZ82A.js","assets/RefreshableLayer-Bm-azQA6.js","assets/ScaleRangeLayer-ZiUEDr0v.js","assets/TemporalLayer-VMi3-1h4.js","assets/TimeInfo-C9AtjZLw.js","assets/versionUtils-CRgU8hQb.js","assets/elevationInfoUtils-BMtLmhK3.js","assets/popupUtils-BinggBIk.js","assets/romeinseFortenOL-DfMw7SGA.js","assets/iconStyles-CypsX8em.js","assets/kastelenOL-CiznzFJq.js","assets/ruinesOL-ogBKYImd.js","assets/hunebeddenOL-DjGc7G6f.js","assets/uikavArcheoPuntenOL-D6--_5Nv.js","assets/speeltuinenOL-BhgbP69W.js","assets/museaOL-BHnT_5aG.js","assets/kringloopwinkelsOL-D04e0P9k.js","assets/fossielenOL-gnqP-Z-F.js","assets/fossielUtils-svGsAQz_.js","assets/fossielenBelgieOL-KdjEQ_sS.js","assets/fossielenDuitslandOL-DuPD0caz.js","assets/fossielenFrankrijkOL-B4qYScUE.js","assets/bunkersOL-B23q53-E.js","assets/grafheuvelsOL-CE8781tv.js","assets/slagveldenOL-C_0qaCrM.js","assets/IdentityManager-AGDxIlwi.js","assets/substitute-HLw0FePV.js","assets/ElevationLayer-C6_a7YOj.js","assets/ArcGISCachedService-CAhKw3nO.js","assets/TileInfoTilemapCache-D1g_R0BS.js","assets/TilemapCache-Bdr4RhIE.js","assets/WorkerHandle-wpe9afdo.js","assets/portalLayers-CtvrwNpE.js","assets/associatedFeatureServiceUtils-DKoM4Rmy.js","assets/fetchService-BmkTW9pL.js","assets/loadUtils-DO4se6Rz.js","assets/lazyLayerLoader-CiV252cY.js","assets/arcgisLayers-D892sJnm.js","assets/layersCreator-DuwMtlel.js","assets/styleUtils-B6OeKAwT.js","assets/ElevationQuery-VdhXhyJu.js","assets/GeometryDescriptor-Dw0aVBJd.js","assets/projectOperator-BLojbBpO.js","assets/operatorProject-CeNebl1f.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/projectOperator-TFJA1aai.js","assets/statsWorker-CE_NTb9P.js","assets/utils-oMJfo_n5.js","assets/quantizationUtils-wzVPlZ8w.js","assets/heatmapUtils-ByRgWUMu.js","assets/utils-Ce-CxP8K.js","assets/utils-DF-yBboA.js","assets/geometryEngineWorker-BkMQzpX8.js","assets/geometryEngineJSON-B_JiqPb-.js","assets/geometryEngineBase-BQTefT4Y.js","assets/CSVSourceWorker-DoqYCXnD.js","assets/date-DCujAECq.js","assets/FeatureStore-2qXuVHvF.js","assets/featureConversionUtils-DQm1ZICL.js","assets/BoundsStore-B7ROIoxF.js","assets/PooledRBush-D_FIA_OA.js","assets/timeSupport-DWEcDLqZ.js","assets/queryUtils-BKp8F5Ae.js","assets/optimizedFeatureQueryEngineAdapter-DbaTZeGo.js","assets/QueryEngine-BqnaZy9u.js","assets/WhereClauseCache-DwQoYZKV.js","assets/WhereClause-CUrvLJ66.js","assets/TimeOnly-B-6uhz_V.js","assets/enum-p4zN9VVM.js","assets/QueryEngineCapabilities-DJC_YILC.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-BwTkQ-76.js","assets/NormalizationBinParametersMixin-DHtCX_wt.js","assets/number-_M2F8t4i.js","assets/locationUtils-C6UGCI2L.js","assets/clientSideDefaults-B1hJ_Qg0.js","assets/EdgeProcessingWorker-CH8kmGf6.js","assets/workerHelper-DpTjhC4V.js","assets/InterleavedLayout-Cmp4v2TA.js","assets/BufferView-D916Frh6.js","assets/types-BKo2foNY.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/VertexAttributeLocations-BfZbt_DV.js","assets/edgeProcessing-BRhC6TsV.js","assets/deduplicate-DgcsPCtd.js","assets/Indices-C05WMkqJ.js","assets/Normals-BUWoycvj.js","assets/ElevationSamplerWorker-CYZCpJBA.js","assets/MeshLocalVertexSpace-DOy3YJ3C.js","assets/vertexSpaceConversion-Clhn8qKb.js","assets/spatialReferenceEllipsoidUtils-D8KqW_EK.js","assets/computeTranslationToOriginAndRotation-DicAesSE.js","assets/projectPointToVector-qnBgUJav.js","assets/meshVertexSpaceUtils-Bngk-ZU_.js","assets/vec3-Bor8xQDc.js","assets/vec4-BNFekb26.js","assets/FeatureServiceSnappingSourceWorker-DHy1nXEO.js","assets/symbologySnappingCandidates-BhPs_ZNY.js","assets/GeoJSONSourceWorker-aTkS9puX.js","assets/geojson-BLiRIELS.js","assets/sourceUtils-BazfnqCn.js","assets/MemorySourceWorker-BiiyIMCp.js","assets/objectIdUtils-BmFjqQA3.js","assets/PBFDecoderWorker-DqUUN6he.js","assets/dehydratedFeatures-CMUYHo3x.js","assets/FeaturePipelineWorker-DKcLqKMn.js","assets/AttributeStore-DQAyJaJ0.js","assets/Utils-BUfagF4m.js","assets/BoundingBox-QxIrkPSx.js","assets/UpdateTracking2D-CKSrthKU.js","assets/ArcadeExpression-BbHX5KKj.js","assets/FeatureStoreQueryAdapter-Dl2MMnJX.js","assets/labelPoint-BEISdxNd.js","assets/labelUtils-CMQEjnwJ.js","assets/constants-BBnGEY1d.js","assets/streamLayerUtils-DFlbJ4P1.js","assets/DictionaryScriptEvaluator-RhUvRh91.js","assets/MeshWriterRegistry-Bci32MT0.js","assets/rasterizingUtils-C9qZuGCV.js","assets/CIMSymbolHelper-CmQBujy4.js","assets/BidiEngine-BvER9tXK.js","assets/GeometryUtils-DUtfc4aE.js","assets/Rect-CUzevAry.js","assets/TexturedLineMeshWriter-DL1y8H0n.js","assets/TurboLine-fPxl-erH.js","assets/grouping-ChXF8sp6.js","assets/QueueProcessor-DeAIYwRA.js","assets/FeatureMetadata-B0M-HheT.js","assets/SourceChunkStore-DmADjQ98.js","assets/parquet-BzJs6Oti.js","assets/operatorGeodeticDensify-CYryb9qe.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-B1RaCCg_.js","assets/FeatureIdInfo-2ArvXKvK.js","assets/displayFilterUtils-CUJS2ixQ.js","assets/ogcFeatureUtils-xZCpVLLv.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-89Axvg4z.js","assets/PointCloudWorker-Ddsj3Fe2.js","assets/quat-iq707QP5.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-WCVSSNPR.js","assets/PointCloudUniqueValueRenderer-BLDcJ8IO.js","assets/I3SBinaryReader-CvATl9u_.js","assets/orientedBoundingBox-l8HRJ64p.js","assets/plane-D4wspGMa.js","assets/vectorStacks-D5s0JJZI.js","assets/RasterWorker-EnGGpVKf.js","assets/rasterFunctionHelper-nSBYqWR4.js","assets/clipUtils-BP_CVzLq.js","assets/rasterProjectionHelper-zD6f7-pZ.js","assets/PolynomialTransform-CwPDC4OX.js","assets/SceneLayerSnappingSourceWorker-pRh7CP_i.js","assets/lineSegment-1bzQSPI9.js","assets/sphere-ErSlQ9_4.js","assets/Octree-D1_9mJF1.js","assets/frustum-Dp4n50-z.js","assets/SceneLayerWorker-D2smY9OK.js","assets/projectVectorToVector-B_AWVsry.js","assets/WFSSourceWorker-B5-SS-W7.js","assets/wfsUtils-Bw6WgPGB.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-7yAqIO--.js","assets/constants-BHYAGdRm.js","assets/config-BOD8--da.js","assets/SourceLayerData-DeBXV01b.js","assets/StyleRepository-J0527fuJ.js","assets/earcut-D9gy186-.js","assets/Feature3DPipelineWorker-BpN3NLA0.js","assets/jsonUtils-LFD3qtJv.js","assets/typeUtils-Bwq4eLTb.js","assets/SimpleRenderer-0QwVYXX2.js","assets/HUDMaterial.glsl-Dx24FoQA.js","assets/hydratedFeatures-D6cAT9O4.js","assets/OutputColorHighlightOID.glsl-BcBkorpK.js","assets/triangle-w1KvJvGs.js","assets/renderState-CKc66y4x.js","assets/glsl-B5bJgrnA.js","assets/ShaderBuilder-CgS8wPTb.js","assets/placementUtils-CycHHhjo.js","assets/sdfPrimitives-yE9Bv7Ys.js","assets/Texture-DfwzqCzo.js","assets/videoUtils-Eubp_-J2.js","assets/requestImageUtils-CUe5TawN.js","assets/RealisticTree.glsl-ENqBZRCL.js","assets/DefaultMaterial-Drx74Wc7.js","assets/VertexBuffer-CQ-ZztZa.js","assets/BufferObject-DQgGqim9.js","assets/boundedPlane-ClI1gz9M.js","assets/FlowWorker-BvjtECDI.js","assets/ParquetSourceWorker-DSYsPE4q.js","assets/parquetUtils-CwLHXcvP.js","assets/PanoramicMeshWorker-C-bCIqBr.js","assets/Popup-D5Rm4-mH.js","assets/throttle-BZIhjmGh.js","assets/unitFormatUtils-DEbdmuH2.js","assets/quantityUtils-Dne7a5V1.js","assets/AttachmentInfo-CqfcqNrF.js","assets/labelingInfo-DOCbpPmG.js","assets/featureUtils-CCNCMMfo.js","assets/shared-CRklRMwn.js","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/FeatureLayer-uKl5hEAB.js","assets/FormTemplate-BqFjdwW5.js","assets/editsZScale-DoE1fJiQ.js","assets/APIKeyMixin-CMOMhD42.js","assets/DisplayFilteredLayer-CtY6gkJk.js","assets/scaleUtils-DjEhWhjK.js","assets/EditBusLayer-BcSqVkHx.js","assets/FeatureEffectLayer-DzZnPDEN.js","assets/FeatureEffect-JmdqelRH.js","assets/FeatureFilter-BSfovwRY.js","assets/FeatureLayerBase-u4zzXxzk.js","assets/LayerFloorInfo-CMEQQ66P.js","assets/multiLayerServiceUtils-CQsjP_qV.js","assets/Relationship-CUb5ASri.js","assets/serviceCapabilitiesUtils-Du7w157d.js","assets/infoFor3D-DhzudQro.js","assets/FeatureReductionLayer-CaKKUSaF.js","assets/FeatureReductionSelection-C5L4eGns.js","assets/OrderedLayer-DT0SG8kp.js","assets/OrderByInfo-DYRzKec3.js","assets/TrackableLayer-BTQXsmoz.js","assets/FeatureTemplate-DsROAk4Y.js","assets/FeatureType-uGaMsdOJ.js","assets/fieldProperties-CElwS4yX.js","assets/TitleCreator-v2Tymz0c.js","assets/NetworkElement-B7BIxIjm.js","assets/ReactiveSet-BvdM2fp6.js","assets/symbolUtils-nm8qabAA.js","assets/layerViewUtils-BpVePTj_.js","assets/arcadeUtils-MMI13dR4.js","assets/arcade-BQO4w-e2.js","assets/arcadeEnvironment-CuymneX5.js","assets/Dictionary-CAeiJoxE.js","assets/ImmutableArray-BPVd6ESQ.js","assets/Feature-UeUDScyK.js","assets/aiServices-7vzuR2YL.js","assets/commonProperties-DHiB1uzW.js","assets/unitConversion-BC2AtLQO.js","assets/batchExec-SntlGFeP.js","assets/webStyleSymbolUtils-CyXyxgZg.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/geometryServiceUtils-CGkANAD2.js","assets/project-DLGbrbLl.js","assets/webglDeps-PJGhStvc.js","assets/FramebufferObject-iLNwMBlw.js","assets/ProgramTemplate-CTsBBmvj.js","assets/VertexArrayObject-KszG2g6Q.js","assets/mapViewDeps-BnHV3PZw.js","assets/FeatureCommandQueue-D7LyYbhh.js","assets/GraphShaderModule-YDqTOhjv.js","assets/utils-wP9Qwb7M.js","assets/WGLContainer-WUfY1VUv.js","assets/Container-BVbPCZKM.js","assets/SDFHelper-BE4b_B2B.js","assets/OverrideHelper-5ESu9JH8.js","assets/callExpressionWithFeature-SnXrvzLt.js","assets/GridShader-nZ1gD4X-.js","assets/testSVGPremultipliedAlpha-DGXevCfs.js","assets/SymbolFader-DhgfL1L_.js","assets/RenderingContext-DQOnmT0r.js","assets/CIMResourceManager-D-vwET9C.js","assets/utils-Yu5-oekO.js","assets/utils-DDjZAYSk.js","assets/GraphicsView2D-Dvqly9uI.js","assets/GraphicContainer-B4puoDqh.js","assets/AGraphicContainer-DkpbsM4P.js","assets/TechniqueInstance-CcjpCcgi.js","assets/TileContainer-wtwSpNbD.js","assets/gridUtils-Bm62JynZ.js","assets/geodesicUtils-rDQseeJ6.js","assets/TileLayerView2D-B37lytzY.js","assets/imageUtils-BpKfOA6G.js","assets/BitmapTechnique-CVB73uRO.js","assets/bitmapUtils-BZWesDuz.js","assets/LayerView2D-BvhPGcJ5.js","assets/HighlightGraphicContainer-DQ9QGVxv.js","assets/LayerView-COmv3nlw.js","assets/RefreshableLayerView-BHQ72zKq.js","assets/MapServiceLayerViewHelper-Bza3nQuf.js","assets/floorFilterUtils-DKzVzLpH.js","assets/drapedUtils-BJRR0taU.js","assets/sublayerUtils-BEQnBRaB.js","assets/popupUtils-DX8Zf7Fy.js","assets/highlightOptionsUtils-iksbsKNO.js","assets/FeatureLayerView2D-CeAN_emD.js","assets/timeSupport-DRsswDTh.js","assets/AttributeBinsFeatureSet-DgoRsR7i.js","assets/AttributeBinsQuery-bv9qFkX7.js","assets/constants-SxxbBSOD.js","assets/BaseDynamicLayerView2D-BAS56ta2.js","assets/BitmapContainer-hrjfWUwX.js","assets/ExportStrategy-BBbcrxwH.js","assets/CatalogLayerView2D-Dqm0SBRS.js","assets/CatalogDynamicGroupLayerView2D-BW7eJxi8.js","assets/CatalogFootprintLayerView2D-C_r6zRQ-.js","assets/GeoRSSLayerView2D-BQPWqQjL.js","assets/GraphicsLayerView2D-DBqaJEo1.js","assets/GroupLayerView2D-CeV6_jjV.js","assets/ImageryLayerView2D-DTR0nfff.js","assets/RasterVFDisplayObject-C3Y4RyjX.js","assets/ImageryTileLayerView2D-D9XbNQJb.js","assets/rasterUtils-D3qK5DEC.js","assets/RawBlockCache-BHFhr6B-.js","assets/KMLLayerView2D-CfQaRCk6.js","assets/kmlUtils-Bk5mQCqO.js","assets/KnowledgeGraphLayerView2D-Bcm1sVuk.js","assets/MapImageLayerView2D-DO_ras3X.js","assets/ExportImageParameters-D76efv-2.js","assets/MapNotesLayerView2D-DdCDf72M.js","assets/MediaLayerView2D-DuGu9FIu.js","assets/mediaLayerUtils-CNmrbaiT.js","assets/OverlayContainer-BfuJcrWC.js","assets/OGCFeatureLayerView2D-DLZTA0ao.js","assets/RouteLayerView2D-CBqVRUvK.js","assets/Stop-Q7gdkGsb.js","assets/networkEnums-Hyqd_ulD.js","assets/StreamLayerView2D-jFAcegxv.js","assets/SubtypeGroupLayerView2D-CQeZL96C.js","assets/VectorTileLayerView2D-DtjC_jTv.js","assets/VideoLayerView2D-DT_vFgQl.js","assets/GraphicsLayer-DPLZi0_J.js","assets/videoUtils-BKIw_nbn.js","assets/ControlPoint-AvYCo-6V.js","assets/WMSLayerView2D-BBfXXpXd.js","assets/ExportWMSImageParameters-C-VzpB6f.js","assets/WMTSLayerView2D-BlxpCj-f.js","assets/ElevationProfileAnalysisView2D-ByFMsDzP.js","assets/createUtils-BoCa-YyE.js","assets/distanceOperator-PGPqVp5s.js","assets/Point2D-BtwadikP.js","assets/Distance2DCalculator-CXhBP-8I-B9D7NwXa.js","assets/ProjectionTransformation-CB3u_qrQ.js","assets/Envelope2D-v1krxB11.js","assets/Transformation2D-DPwEgitm.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/apiConverter-DlnUSfFm.js","assets/jsonConverter-BE6Upb5j.js","assets/simplifyOperator-OMyk1ZnM.js","assets/operatorSimplify-DF_jXso4.js","assets/mapCollectionUtils-CZKIK6yP.js","assets/getDefaultUnitForView-B9Lj7UC1.js","assets/SketchViewModel-BifhgNm3.js","assets/hitTestSelectUtils-CzQ59_HC.js","assets/geodeticLengthOperator-D6gFWl0H.js","assets/apng-CwEgiEAO.js","assets/index-D23hXsub.js","assets/index-BBR1BBrk.js","assets/guid-LcV_DAvu.js","assets/useT9n-BVUEs8ti.js","assets/index-D76z7x4l.js","assets/index-Buz8uJGw.js","assets/dom-Y-vhON4T.js","assets/observers-DPFvP4YF.js","assets/ref-C7KZgOwD.js","assets/static-Cp9z6Pr7.js","assets/form-B9AdIrdq.js","assets/interactive-B6N-x-1e.js","assets/label-B80vgJyC.js","assets/useSetFocus-DFX0shb9.js"])))=>i.map(i=>d[i]);
var pSe=Object.getPrototypeOf;var mSe=Reflect.get;var rY=t=>{throw TypeError(t)};var ND=(t,e,n)=>e.has(t)||rY("Cannot "+n);var Ir=(t,e,n)=>(ND(t,e,"read from private field"),n?n.call(t):e.get(t)),bu=(t,e,n)=>e.has(t)?rY("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Eu=(t,e,n,r)=>(ND(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Jb=(t,e,n)=>(ND(t,e,"access private method"),n);var iY=(t,e,n)=>mSe(pSe(t),n,e);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function nz(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var OD={exports:{}},Qb={},LD={exports:{}},Wn={};var sY;function gSe(){if(sY)return Wn;sY=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.iterator;function f(le){return le===null||typeof le!="object"?null:(le=h&&le[h]||le["@@iterator"],typeof le=="function"?le:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,x={};function b(le,W,ne){this.props=le,this.context=W,this.refs=x,this.updater=ne||g}b.prototype.isReactComponent={},b.prototype.setState=function(le,W){if(typeof le!="object"&&typeof le!="function"&&le!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,le,W,"setState")},b.prototype.forceUpdate=function(le){this.updater.enqueueForceUpdate(this,le,"forceUpdate")};function T(){}T.prototype=b.prototype;function A(le,W,ne){this.props=le,this.context=W,this.refs=x,this.updater=ne||g}var I=A.prototype=new T;I.constructor=A,v(I,b.prototype),I.isPureReactComponent=!0;var R=Array.isArray,C=Object.prototype.hasOwnProperty,V={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function N(le,W,ne){var se,ae={},_e=null,Ke=null;if(W!=null)for(se in W.ref!==void 0&&(Ke=W.ref),W.key!==void 0&&(_e=""+W.key),W)C.call(W,se)&&!M.hasOwnProperty(se)&&(ae[se]=W[se]);var Ye=arguments.length-2;if(Ye===1)ae.children=ne;else if(1<Ye){for(var ke=Array(Ye),Te=0;Te<Ye;Te++)ke[Te]=arguments[Te+2];ae.children=ke}if(le&&le.defaultProps)for(se in Ye=le.defaultProps,Ye)ae[se]===void 0&&(ae[se]=Ye[se]);return{$$typeof:t,type:le,key:_e,ref:Ke,props:ae,_owner:V.current}}function O(le,W){return{$$typeof:t,type:le.type,key:W,ref:le.ref,props:le.props,_owner:le._owner}}function F(le){return typeof le=="object"&&le!==null&&le.$$typeof===t}function L(le){var W={"=":"=0",":":"=2"};return"$"+le.replace(/[=:]/g,function(ne){return W[ne]})}var B=/\/+/g;function U(le,W){return typeof le=="object"&&le!==null&&le.key!=null?L(""+le.key):W.toString(36)}function de(le,W,ne,se,ae){var _e=typeof le;(_e==="undefined"||_e==="boolean")&&(le=null);var Ke=!1;if(le===null)Ke=!0;else switch(_e){case"string":case"number":Ke=!0;break;case"object":switch(le.$$typeof){case t:case e:Ke=!0}}if(Ke)return Ke=le,ae=ae(Ke),le=se===""?"."+U(Ke,0):se,R(ae)?(ne="",le!=null&&(ne=le.replace(B,"$&/")+"/"),de(ae,W,ne,"",function(Te){return Te})):ae!=null&&(F(ae)&&(ae=O(ae,ne+(!ae.key||Ke&&Ke.key===ae.key?"":(""+ae.key).replace(B,"$&/")+"/")+le)),W.push(ae)),1;if(Ke=0,se=se===""?".":se+":",R(le))for(var Ye=0;Ye<le.length;Ye++){_e=le[Ye];var ke=se+U(_e,Ye);Ke+=de(_e,W,ne,ke,ae)}else if(ke=f(le),typeof ke=="function")for(le=ke.call(le),Ye=0;!(_e=le.next()).done;)_e=_e.value,ke=se+U(_e,Ye++),Ke+=de(_e,W,ne,ke,ae);else if(_e==="object")throw W=String(le),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(le).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return Ke}function me(le,W,ne){if(le==null)return le;var se=[],ae=0;return de(le,se,"","",function(_e){return W.call(ne,_e,ae++)}),se}function ze(le){if(le._status===-1){var W=le._result;W=W(),W.then(function(ne){(le._status===0||le._status===-1)&&(le._status=1,le._result=ne)},function(ne){(le._status===0||le._status===-1)&&(le._status=2,le._result=ne)}),le._status===-1&&(le._status=0,le._result=W)}if(le._status===1)return le._result.default;throw le._result}var Le={current:null},fe={transition:null},$e={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:fe,ReactCurrentOwner:V};function Ce(){throw Error("act(...) is not supported in production builds of React.")}return Wn.Children={map:me,forEach:function(le,W,ne){me(le,function(){W.apply(this,arguments)},ne)},count:function(le){var W=0;return me(le,function(){W++}),W},toArray:function(le){return me(le,function(W){return W})||[]},only:function(le){if(!F(le))throw Error("React.Children.only expected to receive a single React element child.");return le}},Wn.Component=b,Wn.Fragment=n,Wn.Profiler=i,Wn.PureComponent=A,Wn.StrictMode=r,Wn.Suspense=l,Wn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$e,Wn.act=Ce,Wn.cloneElement=function(le,W,ne){if(le==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+le+".");var se=v({},le.props),ae=le.key,_e=le.ref,Ke=le._owner;if(W!=null){if(W.ref!==void 0&&(_e=W.ref,Ke=V.current),W.key!==void 0&&(ae=""+W.key),le.type&&le.type.defaultProps)var Ye=le.type.defaultProps;for(ke in W)C.call(W,ke)&&!M.hasOwnProperty(ke)&&(se[ke]=W[ke]===void 0&&Ye!==void 0?Ye[ke]:W[ke])}var ke=arguments.length-2;if(ke===1)se.children=ne;else if(1<ke){Ye=Array(ke);for(var Te=0;Te<ke;Te++)Ye[Te]=arguments[Te+2];se.children=Ye}return{$$typeof:t,type:le.type,key:ae,ref:_e,props:se,_owner:Ke}},Wn.createContext=function(le){return le={$$typeof:o,_currentValue:le,_currentValue2:le,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},le.Provider={$$typeof:s,_context:le},le.Consumer=le},Wn.createElement=N,Wn.createFactory=function(le){var W=N.bind(null,le);return W.type=le,W},Wn.createRef=function(){return{current:null}},Wn.forwardRef=function(le){return{$$typeof:a,render:le}},Wn.isValidElement=F,Wn.lazy=function(le){return{$$typeof:u,_payload:{_status:-1,_result:le},_init:ze}},Wn.memo=function(le,W){return{$$typeof:c,type:le,compare:W===void 0?null:W}},Wn.startTransition=function(le){var W=fe.transition;fe.transition={};try{le()}finally{fe.transition=W}},Wn.unstable_act=Ce,Wn.useCallback=function(le,W){return Le.current.useCallback(le,W)},Wn.useContext=function(le){return Le.current.useContext(le)},Wn.useDebugValue=function(){},Wn.useDeferredValue=function(le){return Le.current.useDeferredValue(le)},Wn.useEffect=function(le,W){return Le.current.useEffect(le,W)},Wn.useId=function(){return Le.current.useId()},Wn.useImperativeHandle=function(le,W,ne){return Le.current.useImperativeHandle(le,W,ne)},Wn.useInsertionEffect=function(le,W){return Le.current.useInsertionEffect(le,W)},Wn.useLayoutEffect=function(le,W){return Le.current.useLayoutEffect(le,W)},Wn.useMemo=function(le,W){return Le.current.useMemo(le,W)},Wn.useReducer=function(le,W,ne){return Le.current.useReducer(le,W,ne)},Wn.useRef=function(le){return Le.current.useRef(le)},Wn.useState=function(le){return Le.current.useState(le)},Wn.useSyncExternalStore=function(le,W,ne){return Le.current.useSyncExternalStore(le,W,ne)},Wn.useTransition=function(){return Le.current.useTransition()},Wn.version="18.3.1",Wn}var oY;function mA(){return oY||(oY=1,LD.exports=gSe()),LD.exports}var aY;function ySe(){if(aY)return Qb;aY=1;var t=mA(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var u,h={},f=null,g=null;c!==void 0&&(f=""+c),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(g=l.ref);for(u in l)r.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(a&&a.defaultProps)for(u in l=a.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:e,type:a,key:f,ref:g,props:h,_owner:i.current}}return Qb.Fragment=n,Qb.jsx=o,Qb.jsxs=o,Qb}var lY;function vSe(){return lY||(lY=1,OD.exports=ySe()),OD.exports}var m=vSe(),zR={},DD={exports:{}},Wa={},$D={exports:{}},jD={};var cY;function _Se(){return cY||(cY=1,(function(t){function e(fe,$e){var Ce=fe.length;fe.push($e);e:for(;0<Ce;){var le=Ce-1>>>1,W=fe[le];if(0<i(W,$e))fe[le]=$e,fe[Ce]=W,Ce=le;else break e}}function n(fe){return fe.length===0?null:fe[0]}function r(fe){if(fe.length===0)return null;var $e=fe[0],Ce=fe.pop();if(Ce!==$e){fe[0]=Ce;e:for(var le=0,W=fe.length,ne=W>>>1;le<ne;){var se=2*(le+1)-1,ae=fe[se],_e=se+1,Ke=fe[_e];if(0>i(ae,Ce))_e<W&&0>i(Ke,ae)?(fe[le]=Ke,fe[_e]=Ce,le=_e):(fe[le]=ae,fe[se]=Ce,le=se);else if(_e<W&&0>i(Ke,Ce))fe[le]=Ke,fe[_e]=Ce,le=_e;else break e}}return $e}function i(fe,$e){var Ce=fe.sortIndex-$e.sortIndex;return Ce!==0?Ce:fe.id-$e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,g=!1,v=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(fe){for(var $e=n(c);$e!==null;){if($e.callback===null)r(c);else if($e.startTime<=fe)r(c),$e.sortIndex=$e.expirationTime,e(l,$e);else break;$e=n(c)}}function R(fe){if(x=!1,I(fe),!v)if(n(l)!==null)v=!0,ze(C);else{var $e=n(c);$e!==null&&Le(R,$e.startTime-fe)}}function C(fe,$e){v=!1,x&&(x=!1,T(N),N=-1),g=!0;var Ce=f;try{for(I($e),h=n(l);h!==null&&(!(h.expirationTime>$e)||fe&&!L());){var le=h.callback;if(typeof le=="function"){h.callback=null,f=h.priorityLevel;var W=le(h.expirationTime<=$e);$e=t.unstable_now(),typeof W=="function"?h.callback=W:h===n(l)&&r(l),I($e)}else r(l);h=n(l)}if(h!==null)var ne=!0;else{var se=n(c);se!==null&&Le(R,se.startTime-$e),ne=!1}return ne}finally{h=null,f=Ce,g=!1}}var V=!1,M=null,N=-1,O=5,F=-1;function L(){return!(t.unstable_now()-F<O)}function B(){if(M!==null){var fe=t.unstable_now();F=fe;var $e=!0;try{$e=M(!0,fe)}finally{$e?U():(V=!1,M=null)}}else V=!1}var U;if(typeof A=="function")U=function(){A(B)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,me=de.port2;de.port1.onmessage=B,U=function(){me.postMessage(null)}}else U=function(){b(B,0)};function ze(fe){M=fe,V||(V=!0,U())}function Le(fe,$e){N=b(function(){fe(t.unstable_now())},$e)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(fe){fe.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,ze(C))},t.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<fe?Math.floor(1e3/fe):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(fe){switch(f){case 1:case 2:case 3:var $e=3;break;default:$e=f}var Ce=f;f=$e;try{return fe()}finally{f=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(fe,$e){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Ce=f;f=fe;try{return $e()}finally{f=Ce}},t.unstable_scheduleCallback=function(fe,$e,Ce){var le=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?le+Ce:le):Ce=le,fe){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Ce+W,fe={id:u++,callback:$e,priorityLevel:fe,startTime:Ce,expirationTime:W,sortIndex:-1},Ce>le?(fe.sortIndex=Ce,e(c,fe),n(l)===null&&fe===n(c)&&(x?(T(N),N=-1):x=!0,Le(R,Ce-le))):(fe.sortIndex=W,e(l,fe),v||g||(v=!0,ze(C))),fe},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(fe){var $e=f;return function(){var Ce=f;f=$e;try{return fe.apply(this,arguments)}finally{f=Ce}}}})(jD)),jD}var uY;function xSe(){return uY||(uY=1,$D.exports=_Se()),$D.exports}var hY;function wSe(){if(hY)return Wa;hY=1;var t=mA(),e=xSe();function n(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,w=1;w<arguments.length;w++)p+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(d,p){o(d,p),o(d+"Capture",p)}function o(d,p){for(i[d]=p,d=0;d<p.length;d++)r.add(p[d])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},h={};function f(d){return l.call(h,d)?!0:l.call(u,d)?!1:c.test(d)?h[d]=!0:(u[d]=!0,!1)}function g(d,p,w,k){if(w!==null&&w.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return k?!1:w!==null?!w.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function v(d,p,w,k){if(p===null||typeof p>"u"||g(d,p,w,k))return!0;if(k)return!1;if(w!==null)switch(w.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function x(d,p,w,k,P,D,K){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=k,this.attributeNamespace=P,this.mustUseProperty=w,this.propertyName=d,this.type=p,this.sanitizeURL=D,this.removeEmptyString=K}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){b[d]=new x(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];b[p]=new x(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){b[d]=new x(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){b[d]=new x(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){b[d]=new x(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){b[d]=new x(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){b[d]=new x(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){b[d]=new x(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){b[d]=new x(d,5,!1,d.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function A(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(T,A);b[p]=new x(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(T,A);b[p]=new x(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(T,A);b[p]=new x(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){b[d]=new x(d,1,!1,d.toLowerCase(),null,!1,!1)}),b.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){b[d]=new x(d,1,!1,d.toLowerCase(),null,!0,!0)});function I(d,p,w,k){var P=b.hasOwnProperty(p)?b[p]:null;(P!==null?P.type!==0:k||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(v(p,w,P,k)&&(w=null),k||P===null?f(p)&&(w===null?d.removeAttribute(p):d.setAttribute(p,""+w)):P.mustUseProperty?d[P.propertyName]=w===null?P.type===3?!1:"":w:(p=P.attributeName,k=P.attributeNamespace,w===null?d.removeAttribute(p):(P=P.type,w=P===3||P===4&&w===!0?"":""+w,k?d.setAttributeNS(k,p,w):d.setAttribute(p,w))))}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),V=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),L=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),de=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),ze=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),fe=Symbol.iterator;function $e(d){return d===null||typeof d!="object"?null:(d=fe&&d[fe]||d["@@iterator"],typeof d=="function"?d:null)}var Ce=Object.assign,le;function W(d){if(le===void 0)try{throw Error()}catch(w){var p=w.stack.trim().match(/\n( *(at )?)/);le=p&&p[1]||""}return`
`+le+d}var ne=!1;function se(d,p){if(!d||ne)return"";ne=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(je){var k=je}Reflect.construct(d,[],p)}else{try{p.call()}catch(je){k=je}d.call(p.prototype)}else{try{throw Error()}catch(je){k=je}d()}}catch(je){if(je&&k&&typeof je.stack=="string"){for(var P=je.stack.split(`
`),D=k.stack.split(`
`),K=P.length-1,ce=D.length-1;1<=K&&0<=ce&&P[K]!==D[ce];)ce--;for(;1<=K&&0<=ce;K--,ce--)if(P[K]!==D[ce]){if(K!==1||ce!==1)do if(K--,ce--,0>ce||P[K]!==D[ce]){var he=`
`+P[K].replace(" at new "," at ");return d.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",d.displayName)),he}while(1<=K&&0<=ce);break}}}finally{ne=!1,Error.prepareStackTrace=w}return(d=d?d.displayName||d.name:"")?W(d):""}function ae(d){switch(d.tag){case 5:return W(d.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return d=se(d.type,!1),d;case 11:return d=se(d.type.render,!1),d;case 1:return d=se(d.type,!0),d;default:return""}}function _e(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case M:return"Fragment";case V:return"Portal";case O:return"Profiler";case N:return"StrictMode";case U:return"Suspense";case de:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case L:return(d.displayName||"Context")+".Consumer";case F:return(d._context.displayName||"Context")+".Provider";case B:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case me:return p=d.displayName||null,p!==null?p:_e(d.type)||"Memo";case ze:p=d._payload,d=d._init;try{return _e(d(p))}catch{}}return null}function Ke(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(p);case 8:return p===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Ye(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function ke(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function Te(d){var p=ke(d)?"checked":"value",w=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),k=""+d[p];if(!d.hasOwnProperty(p)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var P=w.get,D=w.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return P.call(this)},set:function(K){k=""+K,D.call(this,K)}}),Object.defineProperty(d,p,{enumerable:w.enumerable}),{getValue:function(){return k},setValue:function(K){k=""+K},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function Dt(d){d._valueTracker||(d._valueTracker=Te(d))}function qe(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var w=p.getValue(),k="";return d&&(k=ke(d)?d.checked?"true":"false":d.value),d=k,d!==w?(p.setValue(d),!0):!1}function sn(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function $t(d,p){var w=p.checked;return Ce({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??d._wrapperState.initialChecked})}function fn(d,p){var w=p.defaultValue==null?"":p.defaultValue,k=p.checked!=null?p.checked:p.defaultChecked;w=Ye(p.value!=null?p.value:w),d._wrapperState={initialChecked:k,initialValue:w,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function yn(d,p){p=p.checked,p!=null&&I(d,"checked",p,!1)}function dt(d,p){yn(d,p);var w=Ye(p.value),k=p.type;if(w!=null)k==="number"?(w===0&&d.value===""||d.value!=w)&&(d.value=""+w):d.value!==""+w&&(d.value=""+w);else if(k==="submit"||k==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?$n(d,p.type,w):p.hasOwnProperty("defaultValue")&&$n(d,p.type,Ye(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function lr(d,p,w){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var k=p.type;if(!(k!=="submit"&&k!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,w||p===d.value||(d.value=p),d.defaultValue=p}w=d.name,w!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,w!==""&&(d.name=w)}function $n(d,p,w){(p!=="number"||sn(d.ownerDocument)!==d)&&(w==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+w&&(d.defaultValue=""+w))}var Un=Array.isArray;function Xr(d,p,w,k){if(d=d.options,p){p={};for(var P=0;P<w.length;P++)p["$"+w[P]]=!0;for(w=0;w<d.length;w++)P=p.hasOwnProperty("$"+d[w].value),d[w].selected!==P&&(d[w].selected=P),P&&k&&(d[w].defaultSelected=!0)}else{for(w=""+Ye(w),p=null,P=0;P<d.length;P++){if(d[P].value===w){d[P].selected=!0,k&&(d[P].defaultSelected=!0);return}p!==null||d[P].disabled||(p=d[P])}p!==null&&(p.selected=!0)}}function fo(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(n(91));return Ce({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function kr(d,p){var w=p.value;if(w==null){if(w=p.children,p=p.defaultValue,w!=null){if(p!=null)throw Error(n(92));if(Un(w)){if(1<w.length)throw Error(n(93));w=w[0]}p=w}p==null&&(p=""),w=p}d._wrapperState={initialValue:Ye(w)}}function Si(d,p){var w=Ye(p.value),k=Ye(p.defaultValue);w!=null&&(w=""+w,w!==d.value&&(d.value=w),p.defaultValue==null&&d.defaultValue!==w&&(d.defaultValue=w)),k!=null&&(d.defaultValue=""+k)}function Rs(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function Mt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yn(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?Mt(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var cr,Ft=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,w,k,P){MSApp.execUnsafeLocalFunction(function(){return d(p,w,k,P)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(cr=cr||document.createElement("div"),cr.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=cr.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function On(d,p){if(p){var w=d.firstChild;if(w&&w===d.lastChild&&w.nodeType===3){w.nodeValue=p;return}}d.textContent=p}var Qt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Oo=["Webkit","ms","Moz","O"];Object.keys(Qt).forEach(function(d){Oo.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),Qt[p]=Qt[d]})});function ji(d,p,w){return p==null||typeof p=="boolean"||p===""?"":w||typeof p!="number"||p===0||Qt.hasOwnProperty(d)&&Qt[d]?(""+p).trim():p+"px"}function Ps(d,p){d=d.style;for(var w in p)if(p.hasOwnProperty(w)){var k=w.indexOf("--")===0,P=ji(w,p[w],k);w==="float"&&(w="cssFloat"),k?d.setProperty(w,P):d[w]=P}}var Pn=Ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ti(d,p){if(p){if(Pn[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(n(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(n(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(n(61))}if(p.style!=null&&typeof p.style!="object")throw Error(n(62))}}function He(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ae=null;function Ie(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var rn=null,z=null,bt=null;function Y(d){if(d=$b(d)){if(typeof rn!="function")throw Error(n(280));var p=d.stateNode;p&&(p=nR(p),rn(d.stateNode,d.type,p))}}function oe(d){z?bt?bt.push(d):bt=[d]:z=d}function Ve(){if(z){var d=z,p=bt;if(bt=z=null,Y(d),p)for(d=0;d<p.length;d++)Y(p[d])}}function Q(d,p){return d(p)}function ye(){}var De=!1;function Je(d,p,w){if(De)return d(p,w);De=!0;try{return Q(d,p,w)}finally{De=!1,(z!==null||bt!==null)&&(ye(),Ve())}}function Ue(d,p){var w=d.stateNode;if(w===null)return null;var k=nR(w);if(k===null)return null;w=k[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(d=d.type,k=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!k;break e;default:d=!1}if(d)return null;if(w&&typeof w!="function")throw Error(n(231,p,typeof w));return w}var nt=!1;if(a)try{var et={};Object.defineProperty(et,"passive",{get:function(){nt=!0}}),window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch{nt=!1}function Pt(d,p,w,k,P,D,K,ce,he){var je=Array.prototype.slice.call(arguments,3);try{p.apply(w,je)}catch(ot){this.onError(ot)}}var zt=!1,gn=null,q=!1,te=null,J={onError:function(d){zt=!0,gn=d}};function ee(d,p,w,k,P,D,K,ce,he){zt=!1,gn=null,Pt.apply(J,arguments)}function re(d,p,w,k,P,D,K,ce,he){if(ee.apply(this,arguments),zt){if(zt){var je=gn;zt=!1,gn=null}else throw Error(n(198));q||(q=!0,te=je)}}function ie(d){var p=d,w=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(w=p.return),d=p.return;while(d)}return p.tag===3?w:null}function Pe(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function Be(d){if(ie(d)!==d)throw Error(n(188))}function Re(d){var p=d.alternate;if(!p){if(p=ie(d),p===null)throw Error(n(188));return p!==d?null:d}for(var w=d,k=p;;){var P=w.return;if(P===null)break;var D=P.alternate;if(D===null){if(k=P.return,k!==null){w=k;continue}break}if(P.child===D.child){for(D=P.child;D;){if(D===w)return Be(P),d;if(D===k)return Be(P),p;D=D.sibling}throw Error(n(188))}if(w.return!==k.return)w=P,k=D;else{for(var K=!1,ce=P.child;ce;){if(ce===w){K=!0,w=P,k=D;break}if(ce===k){K=!0,k=P,w=D;break}ce=ce.sibling}if(!K){for(ce=D.child;ce;){if(ce===w){K=!0,w=D,k=P;break}if(ce===k){K=!0,k=D,w=P;break}ce=ce.sibling}if(!K)throw Error(n(189))}}if(w.alternate!==k)throw Error(n(190))}if(w.tag!==3)throw Error(n(188));return w.stateNode.current===w?d:p}function Ne(d){return d=Re(d),d!==null?Oe(d):null}function Oe(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=Oe(d);if(p!==null)return p;d=d.sibling}return null}var at=e.unstable_scheduleCallback,gt=e.unstable_cancelCallback,It=e.unstable_shouldYield,lt=e.unstable_requestPaint,ct=e.unstable_now,wn=e.unstable_getCurrentPriorityLevel,Ar=e.unstable_ImmediatePriority,Lr=e.unstable_UserBlockingPriority,pi=e.unstable_NormalPriority,pu=e.unstable_LowPriority,mc=e.unstable_IdlePriority,Il=null,ns=null;function Tp(d){if(ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(Il,d,void 0,(d.current.flags&128)===128)}catch{}}var ki=Math.clz32?Math.clz32:r0,gh=Math.log,gc=Math.LN2;function r0(d){return d>>>=0,d===0?32:31-(gh(d)/gc|0)|0}var yh=64,kp=4194304;function yr(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function $d(d,p){var w=d.pendingLanes;if(w===0)return 0;var k=0,P=d.suspendedLanes,D=d.pingedLanes,K=w&268435455;if(K!==0){var ce=K&~P;ce!==0?k=yr(ce):(D&=K,D!==0&&(k=yr(D)))}else K=w&~P,K!==0?k=yr(K):D!==0&&(k=yr(D));if(k===0)return 0;if(p!==0&&p!==k&&(p&P)===0&&(P=k&-k,D=p&-p,P>=D||P===16&&(D&4194240)!==0))return p;if((k&4)!==0&&(k|=w&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=k;0<p;)w=31-ki(p),P=1<<w,k|=d[w],p&=~P;return k}function i0(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s0(d,p){for(var w=d.suspendedLanes,k=d.pingedLanes,P=d.expirationTimes,D=d.pendingLanes;0<D;){var K=31-ki(D),ce=1<<K,he=P[K];he===-1?((ce&w)===0||(ce&k)!==0)&&(P[K]=i0(ce,p)):he<=p&&(d.expiredLanes|=ce),D&=~ce}}function gb(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function yb(){var d=yh;return yh<<=1,(yh&4194240)===0&&(yh=64),d}function vb(d){for(var p=[],w=0;31>w;w++)p.push(d);return p}function o0(d,p,w){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-ki(p),d[p]=w}function hL(d,p){var w=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var k=d.eventTimes;for(d=d.expirationTimes;0<w;){var P=31-ki(w),D=1<<P;p[P]=0,k[P]=-1,d[P]=-1,w&=~D}}function _b(d,p){var w=d.entangledLanes|=p;for(d=d.entanglements;w;){var k=31-ki(w),P=1<<k;P&p|d[k]&p&&(d[k]|=p),w&=~P}}var nr=0;function vh(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var xb,gv,wb,bb,Eb,_h=!1,yv=[],xh=null,wh=null,po=null,a0=new Map,jd=new Map,Rl=[],VI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ap(d,p){switch(d){case"focusin":case"focusout":xh=null;break;case"dragenter":case"dragleave":wh=null;break;case"mouseover":case"mouseout":po=null;break;case"pointerover":case"pointerout":a0.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(p.pointerId)}}function mu(d,p,w,k,P,D){return d===null||d.nativeEvent!==D?(d={blockedOn:p,domEventName:w,eventSystemFlags:k,nativeEvent:D,targetContainers:[P]},p!==null&&(p=$b(p),p!==null&&gv(p)),d):(d.eventSystemFlags|=k,p=d.targetContainers,P!==null&&p.indexOf(P)===-1&&p.push(P),d)}function zI(d,p,w,k,P){switch(p){case"focusin":return xh=mu(xh,d,p,w,k,P),!0;case"dragenter":return wh=mu(wh,d,p,w,k,P),!0;case"mouseover":return po=mu(po,d,p,w,k,P),!0;case"pointerover":var D=P.pointerId;return a0.set(D,mu(a0.get(D)||null,d,p,w,k,P)),!0;case"gotpointercapture":return D=P.pointerId,jd.set(D,mu(jd.get(D)||null,d,p,w,k,P)),!0}return!1}function vv(d){var p=h0(d.target);if(p!==null){var w=ie(p);if(w!==null){if(p=w.tag,p===13){if(p=Pe(w),p!==null){d.blockedOn=p,Eb(d.priority,function(){wb(w)});return}}else if(p===3&&w.stateNode.current.memoizedState.isDehydrated){d.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Zr(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var w=_v(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(w===null){w=d.nativeEvent;var k=new w.constructor(w.type,w);Ae=k,w.target.dispatchEvent(k),Ae=null}else return p=$b(w),p!==null&&gv(p),d.blockedOn=w,!1;p.shift()}return!0}function UI(d,p,w){Zr(d)&&w.delete(p)}function dL(){_h=!1,xh!==null&&Zr(xh)&&(xh=null),wh!==null&&Zr(wh)&&(wh=null),po!==null&&Zr(po)&&(po=null),a0.forEach(UI),jd.forEach(UI)}function Ip(d,p){d.blockedOn===p&&(d.blockedOn=null,_h||(_h=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,dL)))}function Rp(d){function p(P){return Ip(P,d)}if(0<yv.length){Ip(yv[0],d);for(var w=1;w<yv.length;w++){var k=yv[w];k.blockedOn===d&&(k.blockedOn=null)}}for(xh!==null&&Ip(xh,d),wh!==null&&Ip(wh,d),po!==null&&Ip(po,d),a0.forEach(p),jd.forEach(p),w=0;w<Rl.length;w++)k=Rl[w],k.blockedOn===d&&(k.blockedOn=null);for(;0<Rl.length&&(w=Rl[0],w.blockedOn===null);)vv(w),w.blockedOn===null&&Rl.shift()}var Fd=R.ReactCurrentBatchConfig,Vd=!0;function bh(d,p,w,k){var P=nr,D=Fd.transition;Fd.transition=null;try{nr=1,Sb(d,p,w,k)}finally{nr=P,Fd.transition=D}}function GI(d,p,w,k){var P=nr,D=Fd.transition;Fd.transition=null;try{nr=4,Sb(d,p,w,k)}finally{nr=P,Fd.transition=D}}function Sb(d,p,w,k){if(Vd){var P=_v(d,p,w,k);if(P===null)EL(d,p,k,Eh,w),Ap(d,k);else if(zI(P,d,p,w,k))k.stopPropagation();else if(Ap(d,k),p&4&&-1<VI.indexOf(d)){for(;P!==null;){var D=$b(P);if(D!==null&&xb(D),D=_v(d,p,w,k),D===null&&EL(d,p,k,Eh,w),D===P)break;P=D}P!==null&&k.stopPropagation()}else EL(d,p,k,null,w)}}var Eh=null;function _v(d,p,w,k){if(Eh=null,d=Ie(k),d=h0(d),d!==null)if(p=ie(d),p===null)d=null;else if(w=p.tag,w===13){if(d=Pe(p),d!==null)return d;d=null}else if(w===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return Eh=d,null}function xv(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wn()){case Ar:return 1;case Lr:return 4;case pi:case pu:return 16;case mc:return 536870912;default:return 16}default:return 16}}var Pl=null,wv=null,zd=null;function BI(){if(zd)return zd;var d,p=wv,w=p.length,k,P="value"in Pl?Pl.value:Pl.textContent,D=P.length;for(d=0;d<w&&p[d]===P[d];d++);var K=w-d;for(k=1;k<=K&&p[w-k]===P[D-k];k++);return zd=P.slice(d,1<k?1-k:void 0)}function l0(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function Sh(){return!0}function Tb(){return!1}function Lo(d){function p(w,k,P,D,K){this._reactName=w,this._targetInst=P,this.type=k,this.nativeEvent=D,this.target=K,this.currentTarget=null;for(var ce in d)d.hasOwnProperty(ce)&&(w=d[ce],this[ce]=w?w(D):D[ce]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?Sh:Tb,this.isPropagationStopped=Tb,this}return Ce(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=Sh)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=Sh)},persist:function(){},isPersistent:Sh}),p}var Th={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},c0=Lo(Th),Pp=Ce({},Th,{view:0,detail:0}),bv=Lo(Pp),Ev,Sv,Ml,u0=Ce({},Pp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mn,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Ml&&(Ml&&d.type==="mousemove"?(Ev=d.screenX-Ml.screenX,Sv=d.screenY-Ml.screenY):Sv=Ev=0,Ml=d),Ev)},movementY:function(d){return"movementY"in d?d.movementY:Sv}}),kb=Lo(u0),WI=Ce({},u0,{dataTransfer:0}),HI=Lo(WI),Tv=Ce({},Pp,{relatedTarget:0}),mo=Lo(Tv),qI=Ce({},Th,{animationName:0,elapsedTime:0,pseudoElement:0}),KI=Lo(qI),Mp=Ce({},Th,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),S=Lo(Mp),j=Ce({},Th,{data:0}),G=Lo(j),Z={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _t(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=Fe[d])?!!p[d]:!1}function Mn(){return _t}var rs=Ce({},Pp,{key:function(d){if(d.key){var p=Z[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=l0(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Ee[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mn,charCode:function(d){return d.type==="keypress"?l0(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?l0(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Dr=Lo(rs),ds=Ce({},u0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cl=Lo(ds),Ud=Ce({},Pp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mn}),kh=Lo(Ud),Ah=Ce({},Th,{propertyName:0,elapsedTime:0,pseudoElement:0}),kv=Lo(Ah),Ab=Ce({},u0,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),lEe=Lo(Ab),cEe=[9,13,27,32],fL=a&&"CompositionEvent"in window,Ib=null;a&&"documentMode"in document&&(Ib=document.documentMode);var uEe=a&&"TextEvent"in window&&!Ib,YH=a&&(!fL||Ib&&8<Ib&&11>=Ib),XH=" ",ZH=!1;function JH(d,p){switch(d){case"keyup":return cEe.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QH(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Av=!1;function hEe(d,p){switch(d){case"compositionend":return QH(p);case"keypress":return p.which!==32?null:(ZH=!0,XH);case"textInput":return d=p.data,d===XH&&ZH?null:d;default:return null}}function dEe(d,p){if(Av)return d==="compositionend"||!fL&&JH(d,p)?(d=BI(),zd=wv=Pl=null,Av=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return YH&&p.locale!=="ko"?null:p.data;default:return null}}var fEe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eq(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!fEe[d.type]:p==="textarea"}function tq(d,p,w,k){oe(k),p=QI(p,"onChange"),0<p.length&&(w=new c0("onChange","change",null,w,k),d.push({event:w,listeners:p}))}var Rb=null,Pb=null;function pEe(d){_q(d,0)}function YI(d){var p=Cv(d);if(qe(p))return d}function mEe(d,p){if(d==="change")return p}var nq=!1;if(a){var pL;if(a){var mL="oninput"in document;if(!mL){var rq=document.createElement("div");rq.setAttribute("oninput","return;"),mL=typeof rq.oninput=="function"}pL=mL}else pL=!1;nq=pL&&(!document.documentMode||9<document.documentMode)}function iq(){Rb&&(Rb.detachEvent("onpropertychange",sq),Pb=Rb=null)}function sq(d){if(d.propertyName==="value"&&YI(Pb)){var p=[];tq(p,Pb,d,Ie(d)),Je(pEe,p)}}function gEe(d,p,w){d==="focusin"?(iq(),Rb=p,Pb=w,Rb.attachEvent("onpropertychange",sq)):d==="focusout"&&iq()}function yEe(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return YI(Pb)}function vEe(d,p){if(d==="click")return YI(p)}function _Ee(d,p){if(d==="input"||d==="change")return YI(p)}function xEe(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var gu=typeof Object.is=="function"?Object.is:xEe;function Mb(d,p){if(gu(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var w=Object.keys(d),k=Object.keys(p);if(w.length!==k.length)return!1;for(k=0;k<w.length;k++){var P=w[k];if(!l.call(p,P)||!gu(d[P],p[P]))return!1}return!0}function oq(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function aq(d,p){var w=oq(d);d=0;for(var k;w;){if(w.nodeType===3){if(k=d+w.textContent.length,d<=p&&k>=p)return{node:w,offset:p-d};d=k}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=oq(w)}}function lq(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?lq(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function cq(){for(var d=window,p=sn();p instanceof d.HTMLIFrameElement;){try{var w=typeof p.contentWindow.location.href=="string"}catch{w=!1}if(w)d=p.contentWindow;else break;p=sn(d.document)}return p}function gL(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function wEe(d){var p=cq(),w=d.focusedElem,k=d.selectionRange;if(p!==w&&w&&w.ownerDocument&&lq(w.ownerDocument.documentElement,w)){if(k!==null&&gL(w)){if(p=k.start,d=k.end,d===void 0&&(d=p),"selectionStart"in w)w.selectionStart=p,w.selectionEnd=Math.min(d,w.value.length);else if(d=(p=w.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var P=w.textContent.length,D=Math.min(k.start,P);k=k.end===void 0?D:Math.min(k.end,P),!d.extend&&D>k&&(P=k,k=D,D=P),P=aq(w,D);var K=aq(w,k);P&&K&&(d.rangeCount!==1||d.anchorNode!==P.node||d.anchorOffset!==P.offset||d.focusNode!==K.node||d.focusOffset!==K.offset)&&(p=p.createRange(),p.setStart(P.node,P.offset),d.removeAllRanges(),D>k?(d.addRange(p),d.extend(K.node,K.offset)):(p.setEnd(K.node,K.offset),d.addRange(p)))}}for(p=[],d=w;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<p.length;w++)d=p[w],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var bEe=a&&"documentMode"in document&&11>=document.documentMode,Iv=null,yL=null,Cb=null,vL=!1;function uq(d,p,w){var k=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;vL||Iv==null||Iv!==sn(k)||(k=Iv,"selectionStart"in k&&gL(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Cb&&Mb(Cb,k)||(Cb=k,k=QI(yL,"onSelect"),0<k.length&&(p=new c0("onSelect","select",null,p,w),d.push({event:p,listeners:k}),p.target=Iv)))}function XI(d,p){var w={};return w[d.toLowerCase()]=p.toLowerCase(),w["Webkit"+d]="webkit"+p,w["Moz"+d]="moz"+p,w}var Rv={animationend:XI("Animation","AnimationEnd"),animationiteration:XI("Animation","AnimationIteration"),animationstart:XI("Animation","AnimationStart"),transitionend:XI("Transition","TransitionEnd")},_L={},hq={};a&&(hq=document.createElement("div").style,"AnimationEvent"in window||(delete Rv.animationend.animation,delete Rv.animationiteration.animation,delete Rv.animationstart.animation),"TransitionEvent"in window||delete Rv.transitionend.transition);function ZI(d){if(_L[d])return _L[d];if(!Rv[d])return d;var p=Rv[d],w;for(w in p)if(p.hasOwnProperty(w)&&w in hq)return _L[d]=p[w];return d}var dq=ZI("animationend"),fq=ZI("animationiteration"),pq=ZI("animationstart"),mq=ZI("transitionend"),gq=new Map,yq="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cp(d,p){gq.set(d,p),s(p,[d])}for(var xL=0;xL<yq.length;xL++){var wL=yq[xL],EEe=wL.toLowerCase(),SEe=wL[0].toUpperCase()+wL.slice(1);Cp(EEe,"on"+SEe)}Cp(dq,"onAnimationEnd"),Cp(fq,"onAnimationIteration"),Cp(pq,"onAnimationStart"),Cp("dblclick","onDoubleClick"),Cp("focusin","onFocus"),Cp("focusout","onBlur"),Cp(mq,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TEe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nb));function vq(d,p,w){var k=d.type||"unknown-event";d.currentTarget=w,re(k,p,void 0,d),d.currentTarget=null}function _q(d,p){p=(p&4)!==0;for(var w=0;w<d.length;w++){var k=d[w],P=k.event;k=k.listeners;e:{var D=void 0;if(p)for(var K=k.length-1;0<=K;K--){var ce=k[K],he=ce.instance,je=ce.currentTarget;if(ce=ce.listener,he!==D&&P.isPropagationStopped())break e;vq(P,ce,je),D=he}else for(K=0;K<k.length;K++){if(ce=k[K],he=ce.instance,je=ce.currentTarget,ce=ce.listener,he!==D&&P.isPropagationStopped())break e;vq(P,ce,je),D=he}}}if(q)throw d=te,q=!1,te=null,d}function si(d,p){var w=p[RL];w===void 0&&(w=p[RL]=new Set);var k=d+"__bubble";w.has(k)||(xq(p,d,2,!1),w.add(k))}function bL(d,p,w){var k=0;p&&(k|=4),xq(w,d,k,p)}var JI="_reactListening"+Math.random().toString(36).slice(2);function Ob(d){if(!d[JI]){d[JI]=!0,r.forEach(function(w){w!=="selectionchange"&&(TEe.has(w)||bL(w,!1,d),bL(w,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[JI]||(p[JI]=!0,bL("selectionchange",!1,p))}}function xq(d,p,w,k){switch(xv(p)){case 1:var P=bh;break;case 4:P=GI;break;default:P=Sb}w=P.bind(null,p,w,d),P=void 0,!nt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(P=!0),k?P!==void 0?d.addEventListener(p,w,{capture:!0,passive:P}):d.addEventListener(p,w,!0):P!==void 0?d.addEventListener(p,w,{passive:P}):d.addEventListener(p,w,!1)}function EL(d,p,w,k,P){var D=k;if((p&1)===0&&(p&2)===0&&k!==null)e:for(;;){if(k===null)return;var K=k.tag;if(K===3||K===4){var ce=k.stateNode.containerInfo;if(ce===P||ce.nodeType===8&&ce.parentNode===P)break;if(K===4)for(K=k.return;K!==null;){var he=K.tag;if((he===3||he===4)&&(he=K.stateNode.containerInfo,he===P||he.nodeType===8&&he.parentNode===P))return;K=K.return}for(;ce!==null;){if(K=h0(ce),K===null)return;if(he=K.tag,he===5||he===6){k=D=K;continue e}ce=ce.parentNode}}k=k.return}Je(function(){var je=D,ot=Ie(w),ht=[];e:{var rt=gq.get(d);if(rt!==void 0){var Nt=c0,Ut=d;switch(d){case"keypress":if(l0(w)===0)break e;case"keydown":case"keyup":Nt=Dr;break;case"focusin":Ut="focus",Nt=mo;break;case"focusout":Ut="blur",Nt=mo;break;case"beforeblur":case"afterblur":Nt=mo;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Nt=kb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Nt=HI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Nt=kh;break;case dq:case fq:case pq:Nt=KI;break;case mq:Nt=kv;break;case"scroll":Nt=bv;break;case"wheel":Nt=lEe;break;case"copy":case"cut":case"paste":Nt=S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Nt=Cl}var Yt=(p&4)!==0,is=!Yt&&d==="scroll",be=Yt?rt!==null?rt+"Capture":null:rt;Yt=[];for(var ge=je,Me;ge!==null;){Me=ge;var mt=Me.stateNode;if(Me.tag===5&&mt!==null&&(Me=mt,be!==null&&(mt=Ue(ge,be),mt!=null&&Yt.push(Lb(ge,mt,Me)))),is)break;ge=ge.return}0<Yt.length&&(rt=new Nt(rt,Ut,null,w,ot),ht.push({event:rt,listeners:Yt}))}}if((p&7)===0){e:{if(rt=d==="mouseover"||d==="pointerover",Nt=d==="mouseout"||d==="pointerout",rt&&w!==Ae&&(Ut=w.relatedTarget||w.fromElement)&&(h0(Ut)||Ut[Gd]))break e;if((Nt||rt)&&(rt=ot.window===ot?ot:(rt=ot.ownerDocument)?rt.defaultView||rt.parentWindow:window,Nt?(Ut=w.relatedTarget||w.toElement,Nt=je,Ut=Ut?h0(Ut):null,Ut!==null&&(is=ie(Ut),Ut!==is||Ut.tag!==5&&Ut.tag!==6)&&(Ut=null)):(Nt=null,Ut=je),Nt!==Ut)){if(Yt=kb,mt="onMouseLeave",be="onMouseEnter",ge="mouse",(d==="pointerout"||d==="pointerover")&&(Yt=Cl,mt="onPointerLeave",be="onPointerEnter",ge="pointer"),is=Nt==null?rt:Cv(Nt),Me=Ut==null?rt:Cv(Ut),rt=new Yt(mt,ge+"leave",Nt,w,ot),rt.target=is,rt.relatedTarget=Me,mt=null,h0(ot)===je&&(Yt=new Yt(be,ge+"enter",Ut,w,ot),Yt.target=Me,Yt.relatedTarget=is,mt=Yt),is=mt,Nt&&Ut)t:{for(Yt=Nt,be=Ut,ge=0,Me=Yt;Me;Me=Pv(Me))ge++;for(Me=0,mt=be;mt;mt=Pv(mt))Me++;for(;0<ge-Me;)Yt=Pv(Yt),ge--;for(;0<Me-ge;)be=Pv(be),Me--;for(;ge--;){if(Yt===be||be!==null&&Yt===be.alternate)break t;Yt=Pv(Yt),be=Pv(be)}Yt=null}else Yt=null;Nt!==null&&wq(ht,rt,Nt,Yt,!1),Ut!==null&&is!==null&&wq(ht,is,Ut,Yt,!0)}}e:{if(rt=je?Cv(je):window,Nt=rt.nodeName&&rt.nodeName.toLowerCase(),Nt==="select"||Nt==="input"&&rt.type==="file")var Zt=mEe;else if(eq(rt))if(nq)Zt=_Ee;else{Zt=yEe;var cn=gEe}else(Nt=rt.nodeName)&&Nt.toLowerCase()==="input"&&(rt.type==="checkbox"||rt.type==="radio")&&(Zt=vEe);if(Zt&&(Zt=Zt(d,je))){tq(ht,Zt,w,ot);break e}cn&&cn(d,rt,je),d==="focusout"&&(cn=rt._wrapperState)&&cn.controlled&&rt.type==="number"&&$n(rt,"number",rt.value)}switch(cn=je?Cv(je):window,d){case"focusin":(eq(cn)||cn.contentEditable==="true")&&(Iv=cn,yL=je,Cb=null);break;case"focusout":Cb=yL=Iv=null;break;case"mousedown":vL=!0;break;case"contextmenu":case"mouseup":case"dragend":vL=!1,uq(ht,w,ot);break;case"selectionchange":if(bEe)break;case"keydown":case"keyup":uq(ht,w,ot)}var un;if(fL)e:{switch(d){case"compositionstart":var bn="onCompositionStart";break e;case"compositionend":bn="onCompositionEnd";break e;case"compositionupdate":bn="onCompositionUpdate";break e}bn=void 0}else Av?JH(d,w)&&(bn="onCompositionEnd"):d==="keydown"&&w.keyCode===229&&(bn="onCompositionStart");bn&&(YH&&w.locale!=="ko"&&(Av||bn!=="onCompositionStart"?bn==="onCompositionEnd"&&Av&&(un=BI()):(Pl=ot,wv="value"in Pl?Pl.value:Pl.textContent,Av=!0)),cn=QI(je,bn),0<cn.length&&(bn=new G(bn,d,null,w,ot),ht.push({event:bn,listeners:cn}),un?bn.data=un:(un=QH(w),un!==null&&(bn.data=un)))),(un=uEe?hEe(d,w):dEe(d,w))&&(je=QI(je,"onBeforeInput"),0<je.length&&(ot=new G("onBeforeInput","beforeinput",null,w,ot),ht.push({event:ot,listeners:je}),ot.data=un))}_q(ht,p)})}function Lb(d,p,w){return{instance:d,listener:p,currentTarget:w}}function QI(d,p){for(var w=p+"Capture",k=[];d!==null;){var P=d,D=P.stateNode;P.tag===5&&D!==null&&(P=D,D=Ue(d,w),D!=null&&k.unshift(Lb(d,D,P)),D=Ue(d,p),D!=null&&k.push(Lb(d,D,P))),d=d.return}return k}function Pv(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function wq(d,p,w,k,P){for(var D=p._reactName,K=[];w!==null&&w!==k;){var ce=w,he=ce.alternate,je=ce.stateNode;if(he!==null&&he===k)break;ce.tag===5&&je!==null&&(ce=je,P?(he=Ue(w,D),he!=null&&K.unshift(Lb(w,he,ce))):P||(he=Ue(w,D),he!=null&&K.push(Lb(w,he,ce)))),w=w.return}K.length!==0&&d.push({event:p,listeners:K})}var kEe=/\r\n?/g,AEe=/\u0000|\uFFFD/g;function bq(d){return(typeof d=="string"?d:""+d).replace(kEe,`
`).replace(AEe,"")}function eR(d,p,w){if(p=bq(p),bq(d)!==p&&w)throw Error(n(425))}function tR(){}var SL=null,TL=null;function kL(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var AL=typeof setTimeout=="function"?setTimeout:void 0,IEe=typeof clearTimeout=="function"?clearTimeout:void 0,Eq=typeof Promise=="function"?Promise:void 0,REe=typeof queueMicrotask=="function"?queueMicrotask:typeof Eq<"u"?function(d){return Eq.resolve(null).then(d).catch(PEe)}:AL;function PEe(d){setTimeout(function(){throw d})}function IL(d,p){var w=p,k=0;do{var P=w.nextSibling;if(d.removeChild(w),P&&P.nodeType===8)if(w=P.data,w==="/$"){if(k===0){d.removeChild(P),Rp(p);return}k--}else w!=="$"&&w!=="$?"&&w!=="$!"||k++;w=P}while(w);Rp(p)}function Np(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function Sq(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var w=d.data;if(w==="$"||w==="$!"||w==="$?"){if(p===0)return d;p--}else w==="/$"&&p++}d=d.previousSibling}return null}var Mv=Math.random().toString(36).slice(2),Ih="__reactFiber$"+Mv,Db="__reactProps$"+Mv,Gd="__reactContainer$"+Mv,RL="__reactEvents$"+Mv,MEe="__reactListeners$"+Mv,CEe="__reactHandles$"+Mv;function h0(d){var p=d[Ih];if(p)return p;for(var w=d.parentNode;w;){if(p=w[Gd]||w[Ih]){if(w=p.alternate,p.child!==null||w!==null&&w.child!==null)for(d=Sq(d);d!==null;){if(w=d[Ih])return w;d=Sq(d)}return p}d=w,w=d.parentNode}return null}function $b(d){return d=d[Ih]||d[Gd],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Cv(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(n(33))}function nR(d){return d[Db]||null}var PL=[],Nv=-1;function Op(d){return{current:d}}function oi(d){0>Nv||(d.current=PL[Nv],PL[Nv]=null,Nv--)}function ti(d,p){Nv++,PL[Nv]=d.current,d.current=p}var Lp={},Do=Op(Lp),Va=Op(!1),d0=Lp;function Ov(d,p){var w=d.type.contextTypes;if(!w)return Lp;var k=d.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===p)return k.__reactInternalMemoizedMaskedChildContext;var P={},D;for(D in w)P[D]=p[D];return k&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=P),P}function za(d){return d=d.childContextTypes,d!=null}function rR(){oi(Va),oi(Do)}function Tq(d,p,w){if(Do.current!==Lp)throw Error(n(168));ti(Do,p),ti(Va,w)}function kq(d,p,w){var k=d.stateNode;if(p=p.childContextTypes,typeof k.getChildContext!="function")return w;k=k.getChildContext();for(var P in k)if(!(P in p))throw Error(n(108,Ke(d)||"Unknown",P));return Ce({},w,k)}function iR(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Lp,d0=Do.current,ti(Do,d),ti(Va,Va.current),!0}function Aq(d,p,w){var k=d.stateNode;if(!k)throw Error(n(169));w?(d=kq(d,p,d0),k.__reactInternalMemoizedMergedChildContext=d,oi(Va),oi(Do),ti(Do,d)):oi(Va),ti(Va,w)}var Bd=null,sR=!1,ML=!1;function Iq(d){Bd===null?Bd=[d]:Bd.push(d)}function NEe(d){sR=!0,Iq(d)}function Dp(){if(!ML&&Bd!==null){ML=!0;var d=0,p=nr;try{var w=Bd;for(nr=1;d<w.length;d++){var k=w[d];do k=k(!0);while(k!==null)}Bd=null,sR=!1}catch(P){throw Bd!==null&&(Bd=Bd.slice(d+1)),at(Ar,Dp),P}finally{nr=p,ML=!1}}return null}var Lv=[],Dv=0,oR=null,aR=0,yc=[],vc=0,f0=null,Wd=1,Hd="";function p0(d,p){Lv[Dv++]=aR,Lv[Dv++]=oR,oR=d,aR=p}function Rq(d,p,w){yc[vc++]=Wd,yc[vc++]=Hd,yc[vc++]=f0,f0=d;var k=Wd;d=Hd;var P=32-ki(k)-1;k&=~(1<<P),w+=1;var D=32-ki(p)+P;if(30<D){var K=P-P%5;D=(k&(1<<K)-1).toString(32),k>>=K,P-=K,Wd=1<<32-ki(p)+P|w<<P|k,Hd=D+d}else Wd=1<<D|w<<P|k,Hd=d}function CL(d){d.return!==null&&(p0(d,1),Rq(d,1,0))}function NL(d){for(;d===oR;)oR=Lv[--Dv],Lv[Dv]=null,aR=Lv[--Dv],Lv[Dv]=null;for(;d===f0;)f0=yc[--vc],yc[vc]=null,Hd=yc[--vc],yc[vc]=null,Wd=yc[--vc],yc[vc]=null}var Nl=null,Ol=null,mi=!1,yu=null;function Pq(d,p){var w=bc(5,null,null,0);w.elementType="DELETED",w.stateNode=p,w.return=d,p=d.deletions,p===null?(d.deletions=[w],d.flags|=16):p.push(w)}function Mq(d,p){switch(d.tag){case 5:var w=d.type;return p=p.nodeType!==1||w.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Nl=d,Ol=Np(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Nl=d,Ol=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(w=f0!==null?{id:Wd,overflow:Hd}:null,d.memoizedState={dehydrated:p,treeContext:w,retryLane:1073741824},w=bc(18,null,null,0),w.stateNode=p,w.return=d,d.child=w,Nl=d,Ol=null,!0):!1;default:return!1}}function OL(d){return(d.mode&1)!==0&&(d.flags&128)===0}function LL(d){if(mi){var p=Ol;if(p){var w=p;if(!Mq(d,p)){if(OL(d))throw Error(n(418));p=Np(w.nextSibling);var k=Nl;p&&Mq(d,p)?Pq(k,w):(d.flags=d.flags&-4097|2,mi=!1,Nl=d)}}else{if(OL(d))throw Error(n(418));d.flags=d.flags&-4097|2,mi=!1,Nl=d}}}function Cq(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Nl=d}function lR(d){if(d!==Nl)return!1;if(!mi)return Cq(d),mi=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!kL(d.type,d.memoizedProps)),p&&(p=Ol)){if(OL(d))throw Nq(),Error(n(418));for(;p;)Pq(d,p),p=Np(p.nextSibling)}if(Cq(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var w=d.data;if(w==="/$"){if(p===0){Ol=Np(d.nextSibling);break e}p--}else w!=="$"&&w!=="$!"&&w!=="$?"||p++}d=d.nextSibling}Ol=null}}else Ol=Nl?Np(d.stateNode.nextSibling):null;return!0}function Nq(){for(var d=Ol;d;)d=Np(d.nextSibling)}function $v(){Ol=Nl=null,mi=!1}function DL(d){yu===null?yu=[d]:yu.push(d)}var OEe=R.ReactCurrentBatchConfig;function jb(d,p,w){if(d=w.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(n(309));var k=w.stateNode}if(!k)throw Error(n(147,d));var P=k,D=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===D?p.ref:(p=function(K){var ce=P.refs;K===null?delete ce[D]:ce[D]=K},p._stringRef=D,p)}if(typeof d!="string")throw Error(n(284));if(!w._owner)throw Error(n(290,d))}return d}function cR(d,p){throw d=Object.prototype.toString.call(p),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function Oq(d){var p=d._init;return p(d._payload)}function Lq(d){function p(be,ge){if(d){var Me=be.deletions;Me===null?(be.deletions=[ge],be.flags|=16):Me.push(ge)}}function w(be,ge){if(!d)return null;for(;ge!==null;)p(be,ge),ge=ge.sibling;return null}function k(be,ge){for(be=new Map;ge!==null;)ge.key!==null?be.set(ge.key,ge):be.set(ge.index,ge),ge=ge.sibling;return be}function P(be,ge){return be=Bp(be,ge),be.index=0,be.sibling=null,be}function D(be,ge,Me){return be.index=Me,d?(Me=be.alternate,Me!==null?(Me=Me.index,Me<ge?(be.flags|=2,ge):Me):(be.flags|=2,ge)):(be.flags|=1048576,ge)}function K(be){return d&&be.alternate===null&&(be.flags|=2),be}function ce(be,ge,Me,mt){return ge===null||ge.tag!==6?(ge=AD(Me,be.mode,mt),ge.return=be,ge):(ge=P(ge,Me),ge.return=be,ge)}function he(be,ge,Me,mt){var Zt=Me.type;return Zt===M?ot(be,ge,Me.props.children,mt,Me.key):ge!==null&&(ge.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===ze&&Oq(Zt)===ge.type)?(mt=P(ge,Me.props),mt.ref=jb(be,ge,Me),mt.return=be,mt):(mt=NR(Me.type,Me.key,Me.props,null,be.mode,mt),mt.ref=jb(be,ge,Me),mt.return=be,mt)}function je(be,ge,Me,mt){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Me.containerInfo||ge.stateNode.implementation!==Me.implementation?(ge=ID(Me,be.mode,mt),ge.return=be,ge):(ge=P(ge,Me.children||[]),ge.return=be,ge)}function ot(be,ge,Me,mt,Zt){return ge===null||ge.tag!==7?(ge=b0(Me,be.mode,mt,Zt),ge.return=be,ge):(ge=P(ge,Me),ge.return=be,ge)}function ht(be,ge,Me){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=AD(""+ge,be.mode,Me),ge.return=be,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case C:return Me=NR(ge.type,ge.key,ge.props,null,be.mode,Me),Me.ref=jb(be,null,ge),Me.return=be,Me;case V:return ge=ID(ge,be.mode,Me),ge.return=be,ge;case ze:var mt=ge._init;return ht(be,mt(ge._payload),Me)}if(Un(ge)||$e(ge))return ge=b0(ge,be.mode,Me,null),ge.return=be,ge;cR(be,ge)}return null}function rt(be,ge,Me,mt){var Zt=ge!==null?ge.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Zt!==null?null:ce(be,ge,""+Me,mt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case C:return Me.key===Zt?he(be,ge,Me,mt):null;case V:return Me.key===Zt?je(be,ge,Me,mt):null;case ze:return Zt=Me._init,rt(be,ge,Zt(Me._payload),mt)}if(Un(Me)||$e(Me))return Zt!==null?null:ot(be,ge,Me,mt,null);cR(be,Me)}return null}function Nt(be,ge,Me,mt,Zt){if(typeof mt=="string"&&mt!==""||typeof mt=="number")return be=be.get(Me)||null,ce(ge,be,""+mt,Zt);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case C:return be=be.get(mt.key===null?Me:mt.key)||null,he(ge,be,mt,Zt);case V:return be=be.get(mt.key===null?Me:mt.key)||null,je(ge,be,mt,Zt);case ze:var cn=mt._init;return Nt(be,ge,Me,cn(mt._payload),Zt)}if(Un(mt)||$e(mt))return be=be.get(Me)||null,ot(ge,be,mt,Zt,null);cR(ge,mt)}return null}function Ut(be,ge,Me,mt){for(var Zt=null,cn=null,un=ge,bn=ge=0,Ks=null;un!==null&&bn<Me.length;bn++){un.index>bn?(Ks=un,un=null):Ks=un.sibling;var fr=rt(be,un,Me[bn],mt);if(fr===null){un===null&&(un=Ks);break}d&&un&&fr.alternate===null&&p(be,un),ge=D(fr,ge,bn),cn===null?Zt=fr:cn.sibling=fr,cn=fr,un=Ks}if(bn===Me.length)return w(be,un),mi&&p0(be,bn),Zt;if(un===null){for(;bn<Me.length;bn++)un=ht(be,Me[bn],mt),un!==null&&(ge=D(un,ge,bn),cn===null?Zt=un:cn.sibling=un,cn=un);return mi&&p0(be,bn),Zt}for(un=k(be,un);bn<Me.length;bn++)Ks=Nt(un,be,bn,Me[bn],mt),Ks!==null&&(d&&Ks.alternate!==null&&un.delete(Ks.key===null?bn:Ks.key),ge=D(Ks,ge,bn),cn===null?Zt=Ks:cn.sibling=Ks,cn=Ks);return d&&un.forEach(function(Wp){return p(be,Wp)}),mi&&p0(be,bn),Zt}function Yt(be,ge,Me,mt){var Zt=$e(Me);if(typeof Zt!="function")throw Error(n(150));if(Me=Zt.call(Me),Me==null)throw Error(n(151));for(var cn=Zt=null,un=ge,bn=ge=0,Ks=null,fr=Me.next();un!==null&&!fr.done;bn++,fr=Me.next()){un.index>bn?(Ks=un,un=null):Ks=un.sibling;var Wp=rt(be,un,fr.value,mt);if(Wp===null){un===null&&(un=Ks);break}d&&un&&Wp.alternate===null&&p(be,un),ge=D(Wp,ge,bn),cn===null?Zt=Wp:cn.sibling=Wp,cn=Wp,un=Ks}if(fr.done)return w(be,un),mi&&p0(be,bn),Zt;if(un===null){for(;!fr.done;bn++,fr=Me.next())fr=ht(be,fr.value,mt),fr!==null&&(ge=D(fr,ge,bn),cn===null?Zt=fr:cn.sibling=fr,cn=fr);return mi&&p0(be,bn),Zt}for(un=k(be,un);!fr.done;bn++,fr=Me.next())fr=Nt(un,be,bn,fr.value,mt),fr!==null&&(d&&fr.alternate!==null&&un.delete(fr.key===null?bn:fr.key),ge=D(fr,ge,bn),cn===null?Zt=fr:cn.sibling=fr,cn=fr);return d&&un.forEach(function(fSe){return p(be,fSe)}),mi&&p0(be,bn),Zt}function is(be,ge,Me,mt){if(typeof Me=="object"&&Me!==null&&Me.type===M&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case C:e:{for(var Zt=Me.key,cn=ge;cn!==null;){if(cn.key===Zt){if(Zt=Me.type,Zt===M){if(cn.tag===7){w(be,cn.sibling),ge=P(cn,Me.props.children),ge.return=be,be=ge;break e}}else if(cn.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===ze&&Oq(Zt)===cn.type){w(be,cn.sibling),ge=P(cn,Me.props),ge.ref=jb(be,cn,Me),ge.return=be,be=ge;break e}w(be,cn);break}else p(be,cn);cn=cn.sibling}Me.type===M?(ge=b0(Me.props.children,be.mode,mt,Me.key),ge.return=be,be=ge):(mt=NR(Me.type,Me.key,Me.props,null,be.mode,mt),mt.ref=jb(be,ge,Me),mt.return=be,be=mt)}return K(be);case V:e:{for(cn=Me.key;ge!==null;){if(ge.key===cn)if(ge.tag===4&&ge.stateNode.containerInfo===Me.containerInfo&&ge.stateNode.implementation===Me.implementation){w(be,ge.sibling),ge=P(ge,Me.children||[]),ge.return=be,be=ge;break e}else{w(be,ge);break}else p(be,ge);ge=ge.sibling}ge=ID(Me,be.mode,mt),ge.return=be,be=ge}return K(be);case ze:return cn=Me._init,is(be,ge,cn(Me._payload),mt)}if(Un(Me))return Ut(be,ge,Me,mt);if($e(Me))return Yt(be,ge,Me,mt);cR(be,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,ge!==null&&ge.tag===6?(w(be,ge.sibling),ge=P(ge,Me),ge.return=be,be=ge):(w(be,ge),ge=AD(Me,be.mode,mt),ge.return=be,be=ge),K(be)):w(be,ge)}return is}var jv=Lq(!0),Dq=Lq(!1),uR=Op(null),hR=null,Fv=null,$L=null;function jL(){$L=Fv=hR=null}function FL(d){var p=uR.current;oi(uR),d._currentValue=p}function VL(d,p,w){for(;d!==null;){var k=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,k!==null&&(k.childLanes|=p)):k!==null&&(k.childLanes&p)!==p&&(k.childLanes|=p),d===w)break;d=d.return}}function Vv(d,p){hR=d,$L=Fv=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Ua=!0),d.firstContext=null)}function _c(d){var p=d._currentValue;if($L!==d)if(d={context:d,memoizedValue:p,next:null},Fv===null){if(hR===null)throw Error(n(308));Fv=d,hR.dependencies={lanes:0,firstContext:d}}else Fv=Fv.next=d;return p}var m0=null;function zL(d){m0===null?m0=[d]:m0.push(d)}function $q(d,p,w,k){var P=p.interleaved;return P===null?(w.next=w,zL(p)):(w.next=P.next,P.next=w),p.interleaved=w,qd(d,k)}function qd(d,p){d.lanes|=p;var w=d.alternate;for(w!==null&&(w.lanes|=p),w=d,d=d.return;d!==null;)d.childLanes|=p,w=d.alternate,w!==null&&(w.childLanes|=p),w=d,d=d.return;return w.tag===3?w.stateNode:null}var $p=!1;function UL(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jq(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Kd(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function jp(d,p,w){var k=d.updateQueue;if(k===null)return null;if(k=k.shared,(ur&2)!==0){var P=k.pending;return P===null?p.next=p:(p.next=P.next,P.next=p),k.pending=p,qd(d,w)}return P=k.interleaved,P===null?(p.next=p,zL(k)):(p.next=P.next,P.next=p),k.interleaved=p,qd(d,w)}function dR(d,p,w){if(p=p.updateQueue,p!==null&&(p=p.shared,(w&4194240)!==0)){var k=p.lanes;k&=d.pendingLanes,w|=k,p.lanes=w,_b(d,w)}}function Fq(d,p){var w=d.updateQueue,k=d.alternate;if(k!==null&&(k=k.updateQueue,w===k)){var P=null,D=null;if(w=w.firstBaseUpdate,w!==null){do{var K={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};D===null?P=D=K:D=D.next=K,w=w.next}while(w!==null);D===null?P=D=p:D=D.next=p}else P=D=p;w={baseState:k.baseState,firstBaseUpdate:P,lastBaseUpdate:D,shared:k.shared,effects:k.effects},d.updateQueue=w;return}d=w.lastBaseUpdate,d===null?w.firstBaseUpdate=p:d.next=p,w.lastBaseUpdate=p}function fR(d,p,w,k){var P=d.updateQueue;$p=!1;var D=P.firstBaseUpdate,K=P.lastBaseUpdate,ce=P.shared.pending;if(ce!==null){P.shared.pending=null;var he=ce,je=he.next;he.next=null,K===null?D=je:K.next=je,K=he;var ot=d.alternate;ot!==null&&(ot=ot.updateQueue,ce=ot.lastBaseUpdate,ce!==K&&(ce===null?ot.firstBaseUpdate=je:ce.next=je,ot.lastBaseUpdate=he))}if(D!==null){var ht=P.baseState;K=0,ot=je=he=null,ce=D;do{var rt=ce.lane,Nt=ce.eventTime;if((k&rt)===rt){ot!==null&&(ot=ot.next={eventTime:Nt,lane:0,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null});e:{var Ut=d,Yt=ce;switch(rt=p,Nt=w,Yt.tag){case 1:if(Ut=Yt.payload,typeof Ut=="function"){ht=Ut.call(Nt,ht,rt);break e}ht=Ut;break e;case 3:Ut.flags=Ut.flags&-65537|128;case 0:if(Ut=Yt.payload,rt=typeof Ut=="function"?Ut.call(Nt,ht,rt):Ut,rt==null)break e;ht=Ce({},ht,rt);break e;case 2:$p=!0}}ce.callback!==null&&ce.lane!==0&&(d.flags|=64,rt=P.effects,rt===null?P.effects=[ce]:rt.push(ce))}else Nt={eventTime:Nt,lane:rt,tag:ce.tag,payload:ce.payload,callback:ce.callback,next:null},ot===null?(je=ot=Nt,he=ht):ot=ot.next=Nt,K|=rt;if(ce=ce.next,ce===null){if(ce=P.shared.pending,ce===null)break;rt=ce,ce=rt.next,rt.next=null,P.lastBaseUpdate=rt,P.shared.pending=null}}while(!0);if(ot===null&&(he=ht),P.baseState=he,P.firstBaseUpdate=je,P.lastBaseUpdate=ot,p=P.shared.interleaved,p!==null){P=p;do K|=P.lane,P=P.next;while(P!==p)}else D===null&&(P.shared.lanes=0);v0|=K,d.lanes=K,d.memoizedState=ht}}function Vq(d,p,w){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var k=d[p],P=k.callback;if(P!==null){if(k.callback=null,k=w,typeof P!="function")throw Error(n(191,P));P.call(k)}}}var Fb={},Rh=Op(Fb),Vb=Op(Fb),zb=Op(Fb);function g0(d){if(d===Fb)throw Error(n(174));return d}function GL(d,p){switch(ti(zb,p),ti(Vb,d),ti(Rh,Fb),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:Yn(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=Yn(p,d)}oi(Rh),ti(Rh,p)}function zv(){oi(Rh),oi(Vb),oi(zb)}function zq(d){g0(zb.current);var p=g0(Rh.current),w=Yn(p,d.type);p!==w&&(ti(Vb,d),ti(Rh,w))}function BL(d){Vb.current===d&&(oi(Rh),oi(Vb))}var Ai=Op(0);function pR(d){for(var p=d;p!==null;){if(p.tag===13){var w=p.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var WL=[];function HL(){for(var d=0;d<WL.length;d++)WL[d]._workInProgressVersionPrimary=null;WL.length=0}var mR=R.ReactCurrentDispatcher,qL=R.ReactCurrentBatchConfig,y0=0,Ii=null,Ms=null,Hs=null,gR=!1,Ub=!1,Gb=0,LEe=0;function $o(){throw Error(n(321))}function KL(d,p){if(p===null)return!1;for(var w=0;w<p.length&&w<d.length;w++)if(!gu(d[w],p[w]))return!1;return!0}function YL(d,p,w,k,P,D){if(y0=D,Ii=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,mR.current=d===null||d.memoizedState===null?FEe:VEe,d=w(k,P),Ub){D=0;do{if(Ub=!1,Gb=0,25<=D)throw Error(n(301));D+=1,Hs=Ms=null,p.updateQueue=null,mR.current=zEe,d=w(k,P)}while(Ub)}if(mR.current=_R,p=Ms!==null&&Ms.next!==null,y0=0,Hs=Ms=Ii=null,gR=!1,p)throw Error(n(300));return d}function XL(){var d=Gb!==0;return Gb=0,d}function Ph(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hs===null?Ii.memoizedState=Hs=d:Hs=Hs.next=d,Hs}function xc(){if(Ms===null){var d=Ii.alternate;d=d!==null?d.memoizedState:null}else d=Ms.next;var p=Hs===null?Ii.memoizedState:Hs.next;if(p!==null)Hs=p,Ms=d;else{if(d===null)throw Error(n(310));Ms=d,d={memoizedState:Ms.memoizedState,baseState:Ms.baseState,baseQueue:Ms.baseQueue,queue:Ms.queue,next:null},Hs===null?Ii.memoizedState=Hs=d:Hs=Hs.next=d}return Hs}function Bb(d,p){return typeof p=="function"?p(d):p}function ZL(d){var p=xc(),w=p.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=d;var k=Ms,P=k.baseQueue,D=w.pending;if(D!==null){if(P!==null){var K=P.next;P.next=D.next,D.next=K}k.baseQueue=P=D,w.pending=null}if(P!==null){D=P.next,k=k.baseState;var ce=K=null,he=null,je=D;do{var ot=je.lane;if((y0&ot)===ot)he!==null&&(he=he.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),k=je.hasEagerState?je.eagerState:d(k,je.action);else{var ht={lane:ot,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};he===null?(ce=he=ht,K=k):he=he.next=ht,Ii.lanes|=ot,v0|=ot}je=je.next}while(je!==null&&je!==D);he===null?K=k:he.next=ce,gu(k,p.memoizedState)||(Ua=!0),p.memoizedState=k,p.baseState=K,p.baseQueue=he,w.lastRenderedState=k}if(d=w.interleaved,d!==null){P=d;do D=P.lane,Ii.lanes|=D,v0|=D,P=P.next;while(P!==d)}else P===null&&(w.lanes=0);return[p.memoizedState,w.dispatch]}function JL(d){var p=xc(),w=p.queue;if(w===null)throw Error(n(311));w.lastRenderedReducer=d;var k=w.dispatch,P=w.pending,D=p.memoizedState;if(P!==null){w.pending=null;var K=P=P.next;do D=d(D,K.action),K=K.next;while(K!==P);gu(D,p.memoizedState)||(Ua=!0),p.memoizedState=D,p.baseQueue===null&&(p.baseState=D),w.lastRenderedState=D}return[D,k]}function Uq(){}function Gq(d,p){var w=Ii,k=xc(),P=p(),D=!gu(k.memoizedState,P);if(D&&(k.memoizedState=P,Ua=!0),k=k.queue,QL(Hq.bind(null,w,k,d),[d]),k.getSnapshot!==p||D||Hs!==null&&Hs.memoizedState.tag&1){if(w.flags|=2048,Wb(9,Wq.bind(null,w,k,P,p),void 0,null),qs===null)throw Error(n(349));(y0&30)!==0||Bq(w,p,P)}return P}function Bq(d,p,w){d.flags|=16384,d={getSnapshot:p,value:w},p=Ii.updateQueue,p===null?(p={lastEffect:null,stores:null},Ii.updateQueue=p,p.stores=[d]):(w=p.stores,w===null?p.stores=[d]:w.push(d))}function Wq(d,p,w,k){p.value=w,p.getSnapshot=k,qq(p)&&Kq(d)}function Hq(d,p,w){return w(function(){qq(p)&&Kq(d)})}function qq(d){var p=d.getSnapshot;d=d.value;try{var w=p();return!gu(d,w)}catch{return!0}}function Kq(d){var p=qd(d,1);p!==null&&wu(p,d,1,-1)}function Yq(d){var p=Ph();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bb,lastRenderedState:d},p.queue=d,d=d.dispatch=jEe.bind(null,Ii,d),[p.memoizedState,d]}function Wb(d,p,w,k){return d={tag:d,create:p,destroy:w,deps:k,next:null},p=Ii.updateQueue,p===null?(p={lastEffect:null,stores:null},Ii.updateQueue=p,p.lastEffect=d.next=d):(w=p.lastEffect,w===null?p.lastEffect=d.next=d:(k=w.next,w.next=d,d.next=k,p.lastEffect=d)),d}function Xq(){return xc().memoizedState}function yR(d,p,w,k){var P=Ph();Ii.flags|=d,P.memoizedState=Wb(1|p,w,void 0,k===void 0?null:k)}function vR(d,p,w,k){var P=xc();k=k===void 0?null:k;var D=void 0;if(Ms!==null){var K=Ms.memoizedState;if(D=K.destroy,k!==null&&KL(k,K.deps)){P.memoizedState=Wb(p,w,D,k);return}}Ii.flags|=d,P.memoizedState=Wb(1|p,w,D,k)}function Zq(d,p){return yR(8390656,8,d,p)}function QL(d,p){return vR(2048,8,d,p)}function Jq(d,p){return vR(4,2,d,p)}function Qq(d,p){return vR(4,4,d,p)}function eK(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function tK(d,p,w){return w=w!=null?w.concat([d]):null,vR(4,4,eK.bind(null,p,d),w)}function eD(){}function nK(d,p){var w=xc();p=p===void 0?null:p;var k=w.memoizedState;return k!==null&&p!==null&&KL(p,k[1])?k[0]:(w.memoizedState=[d,p],d)}function rK(d,p){var w=xc();p=p===void 0?null:p;var k=w.memoizedState;return k!==null&&p!==null&&KL(p,k[1])?k[0]:(d=d(),w.memoizedState=[d,p],d)}function iK(d,p,w){return(y0&21)===0?(d.baseState&&(d.baseState=!1,Ua=!0),d.memoizedState=w):(gu(w,p)||(w=yb(),Ii.lanes|=w,v0|=w,d.baseState=!0),p)}function DEe(d,p){var w=nr;nr=w!==0&&4>w?w:4,d(!0);var k=qL.transition;qL.transition={};try{d(!1),p()}finally{nr=w,qL.transition=k}}function sK(){return xc().memoizedState}function $Ee(d,p,w){var k=Up(d);if(w={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null},oK(d))aK(p,w);else if(w=$q(d,p,w,k),w!==null){var P=_a();wu(w,d,k,P),lK(w,p,k)}}function jEe(d,p,w){var k=Up(d),P={lane:k,action:w,hasEagerState:!1,eagerState:null,next:null};if(oK(d))aK(p,P);else{var D=d.alternate;if(d.lanes===0&&(D===null||D.lanes===0)&&(D=p.lastRenderedReducer,D!==null))try{var K=p.lastRenderedState,ce=D(K,w);if(P.hasEagerState=!0,P.eagerState=ce,gu(ce,K)){var he=p.interleaved;he===null?(P.next=P,zL(p)):(P.next=he.next,he.next=P),p.interleaved=P;return}}catch{}w=$q(d,p,P,k),w!==null&&(P=_a(),wu(w,d,k,P),lK(w,p,k))}}function oK(d){var p=d.alternate;return d===Ii||p!==null&&p===Ii}function aK(d,p){Ub=gR=!0;var w=d.pending;w===null?p.next=p:(p.next=w.next,w.next=p),d.pending=p}function lK(d,p,w){if((w&4194240)!==0){var k=p.lanes;k&=d.pendingLanes,w|=k,p.lanes=w,_b(d,w)}}var _R={readContext:_c,useCallback:$o,useContext:$o,useEffect:$o,useImperativeHandle:$o,useInsertionEffect:$o,useLayoutEffect:$o,useMemo:$o,useReducer:$o,useRef:$o,useState:$o,useDebugValue:$o,useDeferredValue:$o,useTransition:$o,useMutableSource:$o,useSyncExternalStore:$o,useId:$o,unstable_isNewReconciler:!1},FEe={readContext:_c,useCallback:function(d,p){return Ph().memoizedState=[d,p===void 0?null:p],d},useContext:_c,useEffect:Zq,useImperativeHandle:function(d,p,w){return w=w!=null?w.concat([d]):null,yR(4194308,4,eK.bind(null,p,d),w)},useLayoutEffect:function(d,p){return yR(4194308,4,d,p)},useInsertionEffect:function(d,p){return yR(4,2,d,p)},useMemo:function(d,p){var w=Ph();return p=p===void 0?null:p,d=d(),w.memoizedState=[d,p],d},useReducer:function(d,p,w){var k=Ph();return p=w!==void 0?w(p):p,k.memoizedState=k.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},k.queue=d,d=d.dispatch=$Ee.bind(null,Ii,d),[k.memoizedState,d]},useRef:function(d){var p=Ph();return d={current:d},p.memoizedState=d},useState:Yq,useDebugValue:eD,useDeferredValue:function(d){return Ph().memoizedState=d},useTransition:function(){var d=Yq(!1),p=d[0];return d=DEe.bind(null,d[1]),Ph().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,w){var k=Ii,P=Ph();if(mi){if(w===void 0)throw Error(n(407));w=w()}else{if(w=p(),qs===null)throw Error(n(349));(y0&30)!==0||Bq(k,p,w)}P.memoizedState=w;var D={value:w,getSnapshot:p};return P.queue=D,Zq(Hq.bind(null,k,D,d),[d]),k.flags|=2048,Wb(9,Wq.bind(null,k,D,w,p),void 0,null),w},useId:function(){var d=Ph(),p=qs.identifierPrefix;if(mi){var w=Hd,k=Wd;w=(k&~(1<<32-ki(k)-1)).toString(32)+w,p=":"+p+"R"+w,w=Gb++,0<w&&(p+="H"+w.toString(32)),p+=":"}else w=LEe++,p=":"+p+"r"+w.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},VEe={readContext:_c,useCallback:nK,useContext:_c,useEffect:QL,useImperativeHandle:tK,useInsertionEffect:Jq,useLayoutEffect:Qq,useMemo:rK,useReducer:ZL,useRef:Xq,useState:function(){return ZL(Bb)},useDebugValue:eD,useDeferredValue:function(d){var p=xc();return iK(p,Ms.memoizedState,d)},useTransition:function(){var d=ZL(Bb)[0],p=xc().memoizedState;return[d,p]},useMutableSource:Uq,useSyncExternalStore:Gq,useId:sK,unstable_isNewReconciler:!1},zEe={readContext:_c,useCallback:nK,useContext:_c,useEffect:QL,useImperativeHandle:tK,useInsertionEffect:Jq,useLayoutEffect:Qq,useMemo:rK,useReducer:JL,useRef:Xq,useState:function(){return JL(Bb)},useDebugValue:eD,useDeferredValue:function(d){var p=xc();return Ms===null?p.memoizedState=d:iK(p,Ms.memoizedState,d)},useTransition:function(){var d=JL(Bb)[0],p=xc().memoizedState;return[d,p]},useMutableSource:Uq,useSyncExternalStore:Gq,useId:sK,unstable_isNewReconciler:!1};function vu(d,p){if(d&&d.defaultProps){p=Ce({},p),d=d.defaultProps;for(var w in d)p[w]===void 0&&(p[w]=d[w]);return p}return p}function tD(d,p,w,k){p=d.memoizedState,w=w(k,p),w=w==null?p:Ce({},p,w),d.memoizedState=w,d.lanes===0&&(d.updateQueue.baseState=w)}var xR={isMounted:function(d){return(d=d._reactInternals)?ie(d)===d:!1},enqueueSetState:function(d,p,w){d=d._reactInternals;var k=_a(),P=Up(d),D=Kd(k,P);D.payload=p,w!=null&&(D.callback=w),p=jp(d,D,P),p!==null&&(wu(p,d,P,k),dR(p,d,P))},enqueueReplaceState:function(d,p,w){d=d._reactInternals;var k=_a(),P=Up(d),D=Kd(k,P);D.tag=1,D.payload=p,w!=null&&(D.callback=w),p=jp(d,D,P),p!==null&&(wu(p,d,P,k),dR(p,d,P))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var w=_a(),k=Up(d),P=Kd(w,k);P.tag=2,p!=null&&(P.callback=p),p=jp(d,P,k),p!==null&&(wu(p,d,k,w),dR(p,d,k))}};function cK(d,p,w,k,P,D,K){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(k,D,K):p.prototype&&p.prototype.isPureReactComponent?!Mb(w,k)||!Mb(P,D):!0}function uK(d,p,w){var k=!1,P=Lp,D=p.contextType;return typeof D=="object"&&D!==null?D=_c(D):(P=za(p)?d0:Do.current,k=p.contextTypes,D=(k=k!=null)?Ov(d,P):Lp),p=new p(w,D),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=xR,d.stateNode=p,p._reactInternals=d,k&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=P,d.__reactInternalMemoizedMaskedChildContext=D),p}function hK(d,p,w,k){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(w,k),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(w,k),p.state!==d&&xR.enqueueReplaceState(p,p.state,null)}function nD(d,p,w,k){var P=d.stateNode;P.props=w,P.state=d.memoizedState,P.refs={},UL(d);var D=p.contextType;typeof D=="object"&&D!==null?P.context=_c(D):(D=za(p)?d0:Do.current,P.context=Ov(d,D)),P.state=d.memoizedState,D=p.getDerivedStateFromProps,typeof D=="function"&&(tD(d,p,D,w),P.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(p=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),p!==P.state&&xR.enqueueReplaceState(P,P.state,null),fR(d,w,P,k),P.state=d.memoizedState),typeof P.componentDidMount=="function"&&(d.flags|=4194308)}function Uv(d,p){try{var w="",k=p;do w+=ae(k),k=k.return;while(k);var P=w}catch(D){P=`
Error generating stack: `+D.message+`
`+D.stack}return{value:d,source:p,stack:P,digest:null}}function rD(d,p,w){return{value:d,source:null,stack:w??null,digest:p??null}}function iD(d,p){try{console.error(p.value)}catch(w){setTimeout(function(){throw w})}}var UEe=typeof WeakMap=="function"?WeakMap:Map;function dK(d,p,w){w=Kd(-1,w),w.tag=3,w.payload={element:null};var k=p.value;return w.callback=function(){AR||(AR=!0,_D=k),iD(d,p)},w}function fK(d,p,w){w=Kd(-1,w),w.tag=3;var k=d.type.getDerivedStateFromError;if(typeof k=="function"){var P=p.value;w.payload=function(){return k(P)},w.callback=function(){iD(d,p)}}var D=d.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(w.callback=function(){iD(d,p),typeof k!="function"&&(Vp===null?Vp=new Set([this]):Vp.add(this));var K=p.stack;this.componentDidCatch(p.value,{componentStack:K!==null?K:""})}),w}function pK(d,p,w){var k=d.pingCache;if(k===null){k=d.pingCache=new UEe;var P=new Set;k.set(p,P)}else P=k.get(p),P===void 0&&(P=new Set,k.set(p,P));P.has(w)||(P.add(w),d=nSe.bind(null,d,p,w),p.then(d,d))}function mK(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function gK(d,p,w,k,P){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(p=Kd(-1,1),p.tag=2,jp(w,p,1))),w.lanes|=1),d):(d.flags|=65536,d.lanes=P,d)}var GEe=R.ReactCurrentOwner,Ua=!1;function va(d,p,w,k){p.child=d===null?Dq(p,null,w,k):jv(p,d.child,w,k)}function yK(d,p,w,k,P){w=w.render;var D=p.ref;return Vv(p,P),k=YL(d,p,w,k,D,P),w=XL(),d!==null&&!Ua?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~P,Yd(d,p,P)):(mi&&w&&CL(p),p.flags|=1,va(d,p,k,P),p.child)}function vK(d,p,w,k,P){if(d===null){var D=w.type;return typeof D=="function"&&!kD(D)&&D.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(p.tag=15,p.type=D,_K(d,p,D,k,P)):(d=NR(w.type,null,k,p,p.mode,P),d.ref=p.ref,d.return=p,p.child=d)}if(D=d.child,(d.lanes&P)===0){var K=D.memoizedProps;if(w=w.compare,w=w!==null?w:Mb,w(K,k)&&d.ref===p.ref)return Yd(d,p,P)}return p.flags|=1,d=Bp(D,k),d.ref=p.ref,d.return=p,p.child=d}function _K(d,p,w,k,P){if(d!==null){var D=d.memoizedProps;if(Mb(D,k)&&d.ref===p.ref)if(Ua=!1,p.pendingProps=k=D,(d.lanes&P)!==0)(d.flags&131072)!==0&&(Ua=!0);else return p.lanes=d.lanes,Yd(d,p,P)}return sD(d,p,w,k,P)}function xK(d,p,w){var k=p.pendingProps,P=k.children,D=d!==null?d.memoizedState:null;if(k.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},ti(Bv,Ll),Ll|=w;else{if((w&1073741824)===0)return d=D!==null?D.baseLanes|w:w,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,ti(Bv,Ll),Ll|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=D!==null?D.baseLanes:w,ti(Bv,Ll),Ll|=k}else D!==null?(k=D.baseLanes|w,p.memoizedState=null):k=w,ti(Bv,Ll),Ll|=k;return va(d,p,P,w),p.child}function wK(d,p){var w=p.ref;(d===null&&w!==null||d!==null&&d.ref!==w)&&(p.flags|=512,p.flags|=2097152)}function sD(d,p,w,k,P){var D=za(w)?d0:Do.current;return D=Ov(p,D),Vv(p,P),w=YL(d,p,w,k,D,P),k=XL(),d!==null&&!Ua?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~P,Yd(d,p,P)):(mi&&k&&CL(p),p.flags|=1,va(d,p,w,P),p.child)}function bK(d,p,w,k,P){if(za(w)){var D=!0;iR(p)}else D=!1;if(Vv(p,P),p.stateNode===null)bR(d,p),uK(p,w,k),nD(p,w,k,P),k=!0;else if(d===null){var K=p.stateNode,ce=p.memoizedProps;K.props=ce;var he=K.context,je=w.contextType;typeof je=="object"&&je!==null?je=_c(je):(je=za(w)?d0:Do.current,je=Ov(p,je));var ot=w.getDerivedStateFromProps,ht=typeof ot=="function"||typeof K.getSnapshotBeforeUpdate=="function";ht||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ce!==k||he!==je)&&hK(p,K,k,je),$p=!1;var rt=p.memoizedState;K.state=rt,fR(p,k,K,P),he=p.memoizedState,ce!==k||rt!==he||Va.current||$p?(typeof ot=="function"&&(tD(p,w,ot,k),he=p.memoizedState),(ce=$p||cK(p,w,ce,k,rt,he,je))?(ht||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(p.flags|=4194308)):(typeof K.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=k,p.memoizedState=he),K.props=k,K.state=he,K.context=je,k=ce):(typeof K.componentDidMount=="function"&&(p.flags|=4194308),k=!1)}else{K=p.stateNode,jq(d,p),ce=p.memoizedProps,je=p.type===p.elementType?ce:vu(p.type,ce),K.props=je,ht=p.pendingProps,rt=K.context,he=w.contextType,typeof he=="object"&&he!==null?he=_c(he):(he=za(w)?d0:Do.current,he=Ov(p,he));var Nt=w.getDerivedStateFromProps;(ot=typeof Nt=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ce!==ht||rt!==he)&&hK(p,K,k,he),$p=!1,rt=p.memoizedState,K.state=rt,fR(p,k,K,P);var Ut=p.memoizedState;ce!==ht||rt!==Ut||Va.current||$p?(typeof Nt=="function"&&(tD(p,w,Nt,k),Ut=p.memoizedState),(je=$p||cK(p,w,je,k,rt,Ut,he)||!1)?(ot||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(k,Ut,he),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(k,Ut,he)),typeof K.componentDidUpdate=="function"&&(p.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof K.componentDidUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=1024),p.memoizedProps=k,p.memoizedState=Ut),K.props=k,K.state=Ut,K.context=he,k=je):(typeof K.componentDidUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ce===d.memoizedProps&&rt===d.memoizedState||(p.flags|=1024),k=!1)}return oD(d,p,w,k,D,P)}function oD(d,p,w,k,P,D){wK(d,p);var K=(p.flags&128)!==0;if(!k&&!K)return P&&Aq(p,w,!1),Yd(d,p,D);k=p.stateNode,GEe.current=p;var ce=K&&typeof w.getDerivedStateFromError!="function"?null:k.render();return p.flags|=1,d!==null&&K?(p.child=jv(p,d.child,null,D),p.child=jv(p,null,ce,D)):va(d,p,ce,D),p.memoizedState=k.state,P&&Aq(p,w,!0),p.child}function EK(d){var p=d.stateNode;p.pendingContext?Tq(d,p.pendingContext,p.pendingContext!==p.context):p.context&&Tq(d,p.context,!1),GL(d,p.containerInfo)}function SK(d,p,w,k,P){return $v(),DL(P),p.flags|=256,va(d,p,w,k),p.child}var aD={dehydrated:null,treeContext:null,retryLane:0};function lD(d){return{baseLanes:d,cachePool:null,transitions:null}}function TK(d,p,w){var k=p.pendingProps,P=Ai.current,D=!1,K=(p.flags&128)!==0,ce;if((ce=K)||(ce=d!==null&&d.memoizedState===null?!1:(P&2)!==0),ce?(D=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(P|=1),ti(Ai,P&1),d===null)return LL(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(K=k.children,d=k.fallback,D?(k=p.mode,D=p.child,K={mode:"hidden",children:K},(k&1)===0&&D!==null?(D.childLanes=0,D.pendingProps=K):D=OR(K,k,0,null),d=b0(d,k,w,null),D.return=p,d.return=p,D.sibling=d,p.child=D,p.child.memoizedState=lD(w),p.memoizedState=aD,d):cD(p,K));if(P=d.memoizedState,P!==null&&(ce=P.dehydrated,ce!==null))return BEe(d,p,K,k,ce,P,w);if(D){D=k.fallback,K=p.mode,P=d.child,ce=P.sibling;var he={mode:"hidden",children:k.children};return(K&1)===0&&p.child!==P?(k=p.child,k.childLanes=0,k.pendingProps=he,p.deletions=null):(k=Bp(P,he),k.subtreeFlags=P.subtreeFlags&14680064),ce!==null?D=Bp(ce,D):(D=b0(D,K,w,null),D.flags|=2),D.return=p,k.return=p,k.sibling=D,p.child=k,k=D,D=p.child,K=d.child.memoizedState,K=K===null?lD(w):{baseLanes:K.baseLanes|w,cachePool:null,transitions:K.transitions},D.memoizedState=K,D.childLanes=d.childLanes&~w,p.memoizedState=aD,k}return D=d.child,d=D.sibling,k=Bp(D,{mode:"visible",children:k.children}),(p.mode&1)===0&&(k.lanes=w),k.return=p,k.sibling=null,d!==null&&(w=p.deletions,w===null?(p.deletions=[d],p.flags|=16):w.push(d)),p.child=k,p.memoizedState=null,k}function cD(d,p){return p=OR({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function wR(d,p,w,k){return k!==null&&DL(k),jv(p,d.child,null,w),d=cD(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function BEe(d,p,w,k,P,D,K){if(w)return p.flags&256?(p.flags&=-257,k=rD(Error(n(422))),wR(d,p,K,k)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(D=k.fallback,P=p.mode,k=OR({mode:"visible",children:k.children},P,0,null),D=b0(D,P,K,null),D.flags|=2,k.return=p,D.return=p,k.sibling=D,p.child=k,(p.mode&1)!==0&&jv(p,d.child,null,K),p.child.memoizedState=lD(K),p.memoizedState=aD,D);if((p.mode&1)===0)return wR(d,p,K,null);if(P.data==="$!"){if(k=P.nextSibling&&P.nextSibling.dataset,k)var ce=k.dgst;return k=ce,D=Error(n(419)),k=rD(D,k,void 0),wR(d,p,K,k)}if(ce=(K&d.childLanes)!==0,Ua||ce){if(k=qs,k!==null){switch(K&-K){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=(P&(k.suspendedLanes|K))!==0?0:P,P!==0&&P!==D.retryLane&&(D.retryLane=P,qd(d,P),wu(k,d,P,-1))}return TD(),k=rD(Error(n(421))),wR(d,p,K,k)}return P.data==="$?"?(p.flags|=128,p.child=d.child,p=rSe.bind(null,d),P._reactRetry=p,null):(d=D.treeContext,Ol=Np(P.nextSibling),Nl=p,mi=!0,yu=null,d!==null&&(yc[vc++]=Wd,yc[vc++]=Hd,yc[vc++]=f0,Wd=d.id,Hd=d.overflow,f0=p),p=cD(p,k.children),p.flags|=4096,p)}function kK(d,p,w){d.lanes|=p;var k=d.alternate;k!==null&&(k.lanes|=p),VL(d.return,p,w)}function uD(d,p,w,k,P){var D=d.memoizedState;D===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:k,tail:w,tailMode:P}:(D.isBackwards=p,D.rendering=null,D.renderingStartTime=0,D.last=k,D.tail=w,D.tailMode=P)}function AK(d,p,w){var k=p.pendingProps,P=k.revealOrder,D=k.tail;if(va(d,p,k.children,w),k=Ai.current,(k&2)!==0)k=k&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&kK(d,w,p);else if(d.tag===19)kK(d,w,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}k&=1}if(ti(Ai,k),(p.mode&1)===0)p.memoizedState=null;else switch(P){case"forwards":for(w=p.child,P=null;w!==null;)d=w.alternate,d!==null&&pR(d)===null&&(P=w),w=w.sibling;w=P,w===null?(P=p.child,p.child=null):(P=w.sibling,w.sibling=null),uD(p,!1,P,w,D);break;case"backwards":for(w=null,P=p.child,p.child=null;P!==null;){if(d=P.alternate,d!==null&&pR(d)===null){p.child=P;break}d=P.sibling,P.sibling=w,w=P,P=d}uD(p,!0,w,null,D);break;case"together":uD(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function bR(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function Yd(d,p,w){if(d!==null&&(p.dependencies=d.dependencies),v0|=p.lanes,(w&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(n(153));if(p.child!==null){for(d=p.child,w=Bp(d,d.pendingProps),p.child=w,w.return=p;d.sibling!==null;)d=d.sibling,w=w.sibling=Bp(d,d.pendingProps),w.return=p;w.sibling=null}return p.child}function WEe(d,p,w){switch(p.tag){case 3:EK(p),$v();break;case 5:zq(p);break;case 1:za(p.type)&&iR(p);break;case 4:GL(p,p.stateNode.containerInfo);break;case 10:var k=p.type._context,P=p.memoizedProps.value;ti(uR,k._currentValue),k._currentValue=P;break;case 13:if(k=p.memoizedState,k!==null)return k.dehydrated!==null?(ti(Ai,Ai.current&1),p.flags|=128,null):(w&p.child.childLanes)!==0?TK(d,p,w):(ti(Ai,Ai.current&1),d=Yd(d,p,w),d!==null?d.sibling:null);ti(Ai,Ai.current&1);break;case 19:if(k=(w&p.childLanes)!==0,(d.flags&128)!==0){if(k)return AK(d,p,w);p.flags|=128}if(P=p.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),ti(Ai,Ai.current),k)break;return null;case 22:case 23:return p.lanes=0,xK(d,p,w)}return Yd(d,p,w)}var IK,hD,RK,PK;IK=function(d,p){for(var w=p.child;w!==null;){if(w.tag===5||w.tag===6)d.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===p)break;for(;w.sibling===null;){if(w.return===null||w.return===p)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},hD=function(){},RK=function(d,p,w,k){var P=d.memoizedProps;if(P!==k){d=p.stateNode,g0(Rh.current);var D=null;switch(w){case"input":P=$t(d,P),k=$t(d,k),D=[];break;case"select":P=Ce({},P,{value:void 0}),k=Ce({},k,{value:void 0}),D=[];break;case"textarea":P=fo(d,P),k=fo(d,k),D=[];break;default:typeof P.onClick!="function"&&typeof k.onClick=="function"&&(d.onclick=tR)}Ti(w,k);var K;w=null;for(je in P)if(!k.hasOwnProperty(je)&&P.hasOwnProperty(je)&&P[je]!=null)if(je==="style"){var ce=P[je];for(K in ce)ce.hasOwnProperty(K)&&(w||(w={}),w[K]="")}else je!=="dangerouslySetInnerHTML"&&je!=="children"&&je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&je!=="autoFocus"&&(i.hasOwnProperty(je)?D||(D=[]):(D=D||[]).push(je,null));for(je in k){var he=k[je];if(ce=P?.[je],k.hasOwnProperty(je)&&he!==ce&&(he!=null||ce!=null))if(je==="style")if(ce){for(K in ce)!ce.hasOwnProperty(K)||he&&he.hasOwnProperty(K)||(w||(w={}),w[K]="");for(K in he)he.hasOwnProperty(K)&&ce[K]!==he[K]&&(w||(w={}),w[K]=he[K])}else w||(D||(D=[]),D.push(je,w)),w=he;else je==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ce=ce?ce.__html:void 0,he!=null&&ce!==he&&(D=D||[]).push(je,he)):je==="children"?typeof he!="string"&&typeof he!="number"||(D=D||[]).push(je,""+he):je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&(i.hasOwnProperty(je)?(he!=null&&je==="onScroll"&&si("scroll",d),D||ce===he||(D=[])):(D=D||[]).push(je,he))}w&&(D=D||[]).push("style",w);var je=D;(p.updateQueue=je)&&(p.flags|=4)}},PK=function(d,p,w,k){w!==k&&(p.flags|=4)};function Hb(d,p){if(!mi)switch(d.tailMode){case"hidden":p=d.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d.tail=null:w.sibling=null;break;case"collapsed":w=d.tail;for(var k=null;w!==null;)w.alternate!==null&&(k=w),w=w.sibling;k===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:k.sibling=null}}function jo(d){var p=d.alternate!==null&&d.alternate.child===d.child,w=0,k=0;if(p)for(var P=d.child;P!==null;)w|=P.lanes|P.childLanes,k|=P.subtreeFlags&14680064,k|=P.flags&14680064,P.return=d,P=P.sibling;else for(P=d.child;P!==null;)w|=P.lanes|P.childLanes,k|=P.subtreeFlags,k|=P.flags,P.return=d,P=P.sibling;return d.subtreeFlags|=k,d.childLanes=w,p}function HEe(d,p,w){var k=p.pendingProps;switch(NL(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jo(p),null;case 1:return za(p.type)&&rR(),jo(p),null;case 3:return k=p.stateNode,zv(),oi(Va),oi(Do),HL(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(d===null||d.child===null)&&(lR(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,yu!==null&&(bD(yu),yu=null))),hD(d,p),jo(p),null;case 5:BL(p);var P=g0(zb.current);if(w=p.type,d!==null&&p.stateNode!=null)RK(d,p,w,k,P),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!k){if(p.stateNode===null)throw Error(n(166));return jo(p),null}if(d=g0(Rh.current),lR(p)){k=p.stateNode,w=p.type;var D=p.memoizedProps;switch(k[Ih]=p,k[Db]=D,d=(p.mode&1)!==0,w){case"dialog":si("cancel",k),si("close",k);break;case"iframe":case"object":case"embed":si("load",k);break;case"video":case"audio":for(P=0;P<Nb.length;P++)si(Nb[P],k);break;case"source":si("error",k);break;case"img":case"image":case"link":si("error",k),si("load",k);break;case"details":si("toggle",k);break;case"input":fn(k,D),si("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!D.multiple},si("invalid",k);break;case"textarea":kr(k,D),si("invalid",k)}Ti(w,D),P=null;for(var K in D)if(D.hasOwnProperty(K)){var ce=D[K];K==="children"?typeof ce=="string"?k.textContent!==ce&&(D.suppressHydrationWarning!==!0&&eR(k.textContent,ce,d),P=["children",ce]):typeof ce=="number"&&k.textContent!==""+ce&&(D.suppressHydrationWarning!==!0&&eR(k.textContent,ce,d),P=["children",""+ce]):i.hasOwnProperty(K)&&ce!=null&&K==="onScroll"&&si("scroll",k)}switch(w){case"input":Dt(k),lr(k,D,!0);break;case"textarea":Dt(k),Rs(k);break;case"select":case"option":break;default:typeof D.onClick=="function"&&(k.onclick=tR)}k=P,p.updateQueue=k,k!==null&&(p.flags|=4)}else{K=P.nodeType===9?P:P.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Mt(w)),d==="http://www.w3.org/1999/xhtml"?w==="script"?(d=K.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof k.is=="string"?d=K.createElement(w,{is:k.is}):(d=K.createElement(w),w==="select"&&(K=d,k.multiple?K.multiple=!0:k.size&&(K.size=k.size))):d=K.createElementNS(d,w),d[Ih]=p,d[Db]=k,IK(d,p,!1,!1),p.stateNode=d;e:{switch(K=He(w,k),w){case"dialog":si("cancel",d),si("close",d),P=k;break;case"iframe":case"object":case"embed":si("load",d),P=k;break;case"video":case"audio":for(P=0;P<Nb.length;P++)si(Nb[P],d);P=k;break;case"source":si("error",d),P=k;break;case"img":case"image":case"link":si("error",d),si("load",d),P=k;break;case"details":si("toggle",d),P=k;break;case"input":fn(d,k),P=$t(d,k),si("invalid",d);break;case"option":P=k;break;case"select":d._wrapperState={wasMultiple:!!k.multiple},P=Ce({},k,{value:void 0}),si("invalid",d);break;case"textarea":kr(d,k),P=fo(d,k),si("invalid",d);break;default:P=k}Ti(w,P),ce=P;for(D in ce)if(ce.hasOwnProperty(D)){var he=ce[D];D==="style"?Ps(d,he):D==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&Ft(d,he)):D==="children"?typeof he=="string"?(w!=="textarea"||he!=="")&&On(d,he):typeof he=="number"&&On(d,""+he):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(i.hasOwnProperty(D)?he!=null&&D==="onScroll"&&si("scroll",d):he!=null&&I(d,D,he,K))}switch(w){case"input":Dt(d),lr(d,k,!1);break;case"textarea":Dt(d),Rs(d);break;case"option":k.value!=null&&d.setAttribute("value",""+Ye(k.value));break;case"select":d.multiple=!!k.multiple,D=k.value,D!=null?Xr(d,!!k.multiple,D,!1):k.defaultValue!=null&&Xr(d,!!k.multiple,k.defaultValue,!0);break;default:typeof P.onClick=="function"&&(d.onclick=tR)}switch(w){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return jo(p),null;case 6:if(d&&p.stateNode!=null)PK(d,p,d.memoizedProps,k);else{if(typeof k!="string"&&p.stateNode===null)throw Error(n(166));if(w=g0(zb.current),g0(Rh.current),lR(p)){if(k=p.stateNode,w=p.memoizedProps,k[Ih]=p,(D=k.nodeValue!==w)&&(d=Nl,d!==null))switch(d.tag){case 3:eR(k.nodeValue,w,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&eR(k.nodeValue,w,(d.mode&1)!==0)}D&&(p.flags|=4)}else k=(w.nodeType===9?w:w.ownerDocument).createTextNode(k),k[Ih]=p,p.stateNode=k}return jo(p),null;case 13:if(oi(Ai),k=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(mi&&Ol!==null&&(p.mode&1)!==0&&(p.flags&128)===0)Nq(),$v(),p.flags|=98560,D=!1;else if(D=lR(p),k!==null&&k.dehydrated!==null){if(d===null){if(!D)throw Error(n(318));if(D=p.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(n(317));D[Ih]=p}else $v(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;jo(p),D=!1}else yu!==null&&(bD(yu),yu=null),D=!0;if(!D)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=w,p):(k=k!==null,k!==(d!==null&&d.memoizedState!==null)&&k&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(Ai.current&1)!==0?Cs===0&&(Cs=3):TD())),p.updateQueue!==null&&(p.flags|=4),jo(p),null);case 4:return zv(),hD(d,p),d===null&&Ob(p.stateNode.containerInfo),jo(p),null;case 10:return FL(p.type._context),jo(p),null;case 17:return za(p.type)&&rR(),jo(p),null;case 19:if(oi(Ai),D=p.memoizedState,D===null)return jo(p),null;if(k=(p.flags&128)!==0,K=D.rendering,K===null)if(k)Hb(D,!1);else{if(Cs!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(K=pR(d),K!==null){for(p.flags|=128,Hb(D,!1),k=K.updateQueue,k!==null&&(p.updateQueue=k,p.flags|=4),p.subtreeFlags=0,k=w,w=p.child;w!==null;)D=w,d=k,D.flags&=14680066,K=D.alternate,K===null?(D.childLanes=0,D.lanes=d,D.child=null,D.subtreeFlags=0,D.memoizedProps=null,D.memoizedState=null,D.updateQueue=null,D.dependencies=null,D.stateNode=null):(D.childLanes=K.childLanes,D.lanes=K.lanes,D.child=K.child,D.subtreeFlags=0,D.deletions=null,D.memoizedProps=K.memoizedProps,D.memoizedState=K.memoizedState,D.updateQueue=K.updateQueue,D.type=K.type,d=K.dependencies,D.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),w=w.sibling;return ti(Ai,Ai.current&1|2),p.child}d=d.sibling}D.tail!==null&&ct()>Wv&&(p.flags|=128,k=!0,Hb(D,!1),p.lanes=4194304)}else{if(!k)if(d=pR(K),d!==null){if(p.flags|=128,k=!0,w=d.updateQueue,w!==null&&(p.updateQueue=w,p.flags|=4),Hb(D,!0),D.tail===null&&D.tailMode==="hidden"&&!K.alternate&&!mi)return jo(p),null}else 2*ct()-D.renderingStartTime>Wv&&w!==1073741824&&(p.flags|=128,k=!0,Hb(D,!1),p.lanes=4194304);D.isBackwards?(K.sibling=p.child,p.child=K):(w=D.last,w!==null?w.sibling=K:p.child=K,D.last=K)}return D.tail!==null?(p=D.tail,D.rendering=p,D.tail=p.sibling,D.renderingStartTime=ct(),p.sibling=null,w=Ai.current,ti(Ai,k?w&1|2:w&1),p):(jo(p),null);case 22:case 23:return SD(),k=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==k&&(p.flags|=8192),k&&(p.mode&1)!==0?(Ll&1073741824)!==0&&(jo(p),p.subtreeFlags&6&&(p.flags|=8192)):jo(p),null;case 24:return null;case 25:return null}throw Error(n(156,p.tag))}function qEe(d,p){switch(NL(p),p.tag){case 1:return za(p.type)&&rR(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return zv(),oi(Va),oi(Do),HL(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return BL(p),null;case 13:if(oi(Ai),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(n(340));$v()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return oi(Ai),null;case 4:return zv(),null;case 10:return FL(p.type._context),null;case 22:case 23:return SD(),null;case 24:return null;default:return null}}var ER=!1,Fo=!1,KEe=typeof WeakSet=="function"?WeakSet:Set,jt=null;function Gv(d,p){var w=d.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(k){Fi(d,p,k)}else w.current=null}function dD(d,p,w){try{w()}catch(k){Fi(d,p,k)}}var MK=!1;function YEe(d,p){if(SL=Vd,d=cq(),gL(d)){if("selectionStart"in d)var w={start:d.selectionStart,end:d.selectionEnd};else e:{w=(w=d.ownerDocument)&&w.defaultView||window;var k=w.getSelection&&w.getSelection();if(k&&k.rangeCount!==0){w=k.anchorNode;var P=k.anchorOffset,D=k.focusNode;k=k.focusOffset;try{w.nodeType,D.nodeType}catch{w=null;break e}var K=0,ce=-1,he=-1,je=0,ot=0,ht=d,rt=null;t:for(;;){for(var Nt;ht!==w||P!==0&&ht.nodeType!==3||(ce=K+P),ht!==D||k!==0&&ht.nodeType!==3||(he=K+k),ht.nodeType===3&&(K+=ht.nodeValue.length),(Nt=ht.firstChild)!==null;)rt=ht,ht=Nt;for(;;){if(ht===d)break t;if(rt===w&&++je===P&&(ce=K),rt===D&&++ot===k&&(he=K),(Nt=ht.nextSibling)!==null)break;ht=rt,rt=ht.parentNode}ht=Nt}w=ce===-1||he===-1?null:{start:ce,end:he}}else w=null}w=w||{start:0,end:0}}else w=null;for(TL={focusedElem:d,selectionRange:w},Vd=!1,jt=p;jt!==null;)if(p=jt,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,jt=d;else for(;jt!==null;){p=jt;try{var Ut=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Ut!==null){var Yt=Ut.memoizedProps,is=Ut.memoizedState,be=p.stateNode,ge=be.getSnapshotBeforeUpdate(p.elementType===p.type?Yt:vu(p.type,Yt),is);be.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var Me=p.stateNode.containerInfo;Me.nodeType===1?Me.textContent="":Me.nodeType===9&&Me.documentElement&&Me.removeChild(Me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(mt){Fi(p,p.return,mt)}if(d=p.sibling,d!==null){d.return=p.return,jt=d;break}jt=p.return}return Ut=MK,MK=!1,Ut}function qb(d,p,w){var k=p.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var P=k=k.next;do{if((P.tag&d)===d){var D=P.destroy;P.destroy=void 0,D!==void 0&&dD(p,w,D)}P=P.next}while(P!==k)}}function SR(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var w=p=p.next;do{if((w.tag&d)===d){var k=w.create;w.destroy=k()}w=w.next}while(w!==p)}}function fD(d){var p=d.ref;if(p!==null){var w=d.stateNode;switch(d.tag){case 5:d=w;break;default:d=w}typeof p=="function"?p(d):p.current=d}}function CK(d){var p=d.alternate;p!==null&&(d.alternate=null,CK(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[Ih],delete p[Db],delete p[RL],delete p[MEe],delete p[CEe])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function NK(d){return d.tag===5||d.tag===3||d.tag===4}function OK(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||NK(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function pD(d,p,w){var k=d.tag;if(k===5||k===6)d=d.stateNode,p?w.nodeType===8?w.parentNode.insertBefore(d,p):w.insertBefore(d,p):(w.nodeType===8?(p=w.parentNode,p.insertBefore(d,w)):(p=w,p.appendChild(d)),w=w._reactRootContainer,w!=null||p.onclick!==null||(p.onclick=tR));else if(k!==4&&(d=d.child,d!==null))for(pD(d,p,w),d=d.sibling;d!==null;)pD(d,p,w),d=d.sibling}function mD(d,p,w){var k=d.tag;if(k===5||k===6)d=d.stateNode,p?w.insertBefore(d,p):w.appendChild(d);else if(k!==4&&(d=d.child,d!==null))for(mD(d,p,w),d=d.sibling;d!==null;)mD(d,p,w),d=d.sibling}var go=null,_u=!1;function Fp(d,p,w){for(w=w.child;w!==null;)LK(d,p,w),w=w.sibling}function LK(d,p,w){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(Il,w)}catch{}switch(w.tag){case 5:Fo||Gv(w,p);case 6:var k=go,P=_u;go=null,Fp(d,p,w),go=k,_u=P,go!==null&&(_u?(d=go,w=w.stateNode,d.nodeType===8?d.parentNode.removeChild(w):d.removeChild(w)):go.removeChild(w.stateNode));break;case 18:go!==null&&(_u?(d=go,w=w.stateNode,d.nodeType===8?IL(d.parentNode,w):d.nodeType===1&&IL(d,w),Rp(d)):IL(go,w.stateNode));break;case 4:k=go,P=_u,go=w.stateNode.containerInfo,_u=!0,Fp(d,p,w),go=k,_u=P;break;case 0:case 11:case 14:case 15:if(!Fo&&(k=w.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){P=k=k.next;do{var D=P,K=D.destroy;D=D.tag,K!==void 0&&((D&2)!==0||(D&4)!==0)&&dD(w,p,K),P=P.next}while(P!==k)}Fp(d,p,w);break;case 1:if(!Fo&&(Gv(w,p),k=w.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=w.memoizedProps,k.state=w.memoizedState,k.componentWillUnmount()}catch(ce){Fi(w,p,ce)}Fp(d,p,w);break;case 21:Fp(d,p,w);break;case 22:w.mode&1?(Fo=(k=Fo)||w.memoizedState!==null,Fp(d,p,w),Fo=k):Fp(d,p,w);break;default:Fp(d,p,w)}}function DK(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var w=d.stateNode;w===null&&(w=d.stateNode=new KEe),p.forEach(function(k){var P=iSe.bind(null,d,k);w.has(k)||(w.add(k),k.then(P,P))})}}function xu(d,p){var w=p.deletions;if(w!==null)for(var k=0;k<w.length;k++){var P=w[k];try{var D=d,K=p,ce=K;e:for(;ce!==null;){switch(ce.tag){case 5:go=ce.stateNode,_u=!1;break e;case 3:go=ce.stateNode.containerInfo,_u=!0;break e;case 4:go=ce.stateNode.containerInfo,_u=!0;break e}ce=ce.return}if(go===null)throw Error(n(160));LK(D,K,P),go=null,_u=!1;var he=P.alternate;he!==null&&(he.return=null),P.return=null}catch(je){Fi(P,p,je)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)$K(p,d),p=p.sibling}function $K(d,p){var w=d.alternate,k=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(xu(p,d),Mh(d),k&4){try{qb(3,d,d.return),SR(3,d)}catch(Yt){Fi(d,d.return,Yt)}try{qb(5,d,d.return)}catch(Yt){Fi(d,d.return,Yt)}}break;case 1:xu(p,d),Mh(d),k&512&&w!==null&&Gv(w,w.return);break;case 5:if(xu(p,d),Mh(d),k&512&&w!==null&&Gv(w,w.return),d.flags&32){var P=d.stateNode;try{On(P,"")}catch(Yt){Fi(d,d.return,Yt)}}if(k&4&&(P=d.stateNode,P!=null)){var D=d.memoizedProps,K=w!==null?w.memoizedProps:D,ce=d.type,he=d.updateQueue;if(d.updateQueue=null,he!==null)try{ce==="input"&&D.type==="radio"&&D.name!=null&&yn(P,D),He(ce,K);var je=He(ce,D);for(K=0;K<he.length;K+=2){var ot=he[K],ht=he[K+1];ot==="style"?Ps(P,ht):ot==="dangerouslySetInnerHTML"?Ft(P,ht):ot==="children"?On(P,ht):I(P,ot,ht,je)}switch(ce){case"input":dt(P,D);break;case"textarea":Si(P,D);break;case"select":var rt=P._wrapperState.wasMultiple;P._wrapperState.wasMultiple=!!D.multiple;var Nt=D.value;Nt!=null?Xr(P,!!D.multiple,Nt,!1):rt!==!!D.multiple&&(D.defaultValue!=null?Xr(P,!!D.multiple,D.defaultValue,!0):Xr(P,!!D.multiple,D.multiple?[]:"",!1))}P[Db]=D}catch(Yt){Fi(d,d.return,Yt)}}break;case 6:if(xu(p,d),Mh(d),k&4){if(d.stateNode===null)throw Error(n(162));P=d.stateNode,D=d.memoizedProps;try{P.nodeValue=D}catch(Yt){Fi(d,d.return,Yt)}}break;case 3:if(xu(p,d),Mh(d),k&4&&w!==null&&w.memoizedState.isDehydrated)try{Rp(p.containerInfo)}catch(Yt){Fi(d,d.return,Yt)}break;case 4:xu(p,d),Mh(d);break;case 13:xu(p,d),Mh(d),P=d.child,P.flags&8192&&(D=P.memoizedState!==null,P.stateNode.isHidden=D,!D||P.alternate!==null&&P.alternate.memoizedState!==null||(vD=ct())),k&4&&DK(d);break;case 22:if(ot=w!==null&&w.memoizedState!==null,d.mode&1?(Fo=(je=Fo)||ot,xu(p,d),Fo=je):xu(p,d),Mh(d),k&8192){if(je=d.memoizedState!==null,(d.stateNode.isHidden=je)&&!ot&&(d.mode&1)!==0)for(jt=d,ot=d.child;ot!==null;){for(ht=jt=ot;jt!==null;){switch(rt=jt,Nt=rt.child,rt.tag){case 0:case 11:case 14:case 15:qb(4,rt,rt.return);break;case 1:Gv(rt,rt.return);var Ut=rt.stateNode;if(typeof Ut.componentWillUnmount=="function"){k=rt,w=rt.return;try{p=k,Ut.props=p.memoizedProps,Ut.state=p.memoizedState,Ut.componentWillUnmount()}catch(Yt){Fi(k,w,Yt)}}break;case 5:Gv(rt,rt.return);break;case 22:if(rt.memoizedState!==null){VK(ht);continue}}Nt!==null?(Nt.return=rt,jt=Nt):VK(ht)}ot=ot.sibling}e:for(ot=null,ht=d;;){if(ht.tag===5){if(ot===null){ot=ht;try{P=ht.stateNode,je?(D=P.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none"):(ce=ht.stateNode,he=ht.memoizedProps.style,K=he!=null&&he.hasOwnProperty("display")?he.display:null,ce.style.display=ji("display",K))}catch(Yt){Fi(d,d.return,Yt)}}}else if(ht.tag===6){if(ot===null)try{ht.stateNode.nodeValue=je?"":ht.memoizedProps}catch(Yt){Fi(d,d.return,Yt)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===d)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===d)break e;for(;ht.sibling===null;){if(ht.return===null||ht.return===d)break e;ot===ht&&(ot=null),ht=ht.return}ot===ht&&(ot=null),ht.sibling.return=ht.return,ht=ht.sibling}}break;case 19:xu(p,d),Mh(d),k&4&&DK(d);break;case 21:break;default:xu(p,d),Mh(d)}}function Mh(d){var p=d.flags;if(p&2){try{e:{for(var w=d.return;w!==null;){if(NK(w)){var k=w;break e}w=w.return}throw Error(n(160))}switch(k.tag){case 5:var P=k.stateNode;k.flags&32&&(On(P,""),k.flags&=-33);var D=OK(d);mD(d,D,P);break;case 3:case 4:var K=k.stateNode.containerInfo,ce=OK(d);pD(d,ce,K);break;default:throw Error(n(161))}}catch(he){Fi(d,d.return,he)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function XEe(d,p,w){jt=d,jK(d)}function jK(d,p,w){for(var k=(d.mode&1)!==0;jt!==null;){var P=jt,D=P.child;if(P.tag===22&&k){var K=P.memoizedState!==null||ER;if(!K){var ce=P.alternate,he=ce!==null&&ce.memoizedState!==null||Fo;ce=ER;var je=Fo;if(ER=K,(Fo=he)&&!je)for(jt=P;jt!==null;)K=jt,he=K.child,K.tag===22&&K.memoizedState!==null?zK(P):he!==null?(he.return=K,jt=he):zK(P);for(;D!==null;)jt=D,jK(D),D=D.sibling;jt=P,ER=ce,Fo=je}FK(d)}else(P.subtreeFlags&8772)!==0&&D!==null?(D.return=P,jt=D):FK(d)}}function FK(d){for(;jt!==null;){var p=jt;if((p.flags&8772)!==0){var w=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Fo||SR(5,p);break;case 1:var k=p.stateNode;if(p.flags&4&&!Fo)if(w===null)k.componentDidMount();else{var P=p.elementType===p.type?w.memoizedProps:vu(p.type,w.memoizedProps);k.componentDidUpdate(P,w.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var D=p.updateQueue;D!==null&&Vq(p,D,k);break;case 3:var K=p.updateQueue;if(K!==null){if(w=null,p.child!==null)switch(p.child.tag){case 5:w=p.child.stateNode;break;case 1:w=p.child.stateNode}Vq(p,K,w)}break;case 5:var ce=p.stateNode;if(w===null&&p.flags&4){w=ce;var he=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&w.focus();break;case"img":he.src&&(w.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var je=p.alternate;if(je!==null){var ot=je.memoizedState;if(ot!==null){var ht=ot.dehydrated;ht!==null&&Rp(ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Fo||p.flags&512&&fD(p)}catch(rt){Fi(p,p.return,rt)}}if(p===d){jt=null;break}if(w=p.sibling,w!==null){w.return=p.return,jt=w;break}jt=p.return}}function VK(d){for(;jt!==null;){var p=jt;if(p===d){jt=null;break}var w=p.sibling;if(w!==null){w.return=p.return,jt=w;break}jt=p.return}}function zK(d){for(;jt!==null;){var p=jt;try{switch(p.tag){case 0:case 11:case 15:var w=p.return;try{SR(4,p)}catch(he){Fi(p,w,he)}break;case 1:var k=p.stateNode;if(typeof k.componentDidMount=="function"){var P=p.return;try{k.componentDidMount()}catch(he){Fi(p,P,he)}}var D=p.return;try{fD(p)}catch(he){Fi(p,D,he)}break;case 5:var K=p.return;try{fD(p)}catch(he){Fi(p,K,he)}}}catch(he){Fi(p,p.return,he)}if(p===d){jt=null;break}var ce=p.sibling;if(ce!==null){ce.return=p.return,jt=ce;break}jt=p.return}}var ZEe=Math.ceil,TR=R.ReactCurrentDispatcher,gD=R.ReactCurrentOwner,wc=R.ReactCurrentBatchConfig,ur=0,qs=null,fs=null,yo=0,Ll=0,Bv=Op(0),Cs=0,Kb=null,v0=0,kR=0,yD=0,Yb=null,Ga=null,vD=0,Wv=1/0,Xd=null,AR=!1,_D=null,Vp=null,IR=!1,zp=null,RR=0,Xb=0,xD=null,PR=-1,MR=0;function _a(){return(ur&6)!==0?ct():PR!==-1?PR:PR=ct()}function Up(d){return(d.mode&1)===0?1:(ur&2)!==0&&yo!==0?yo&-yo:OEe.transition!==null?(MR===0&&(MR=yb()),MR):(d=nr,d!==0||(d=window.event,d=d===void 0?16:xv(d.type)),d)}function wu(d,p,w,k){if(50<Xb)throw Xb=0,xD=null,Error(n(185));o0(d,w,k),((ur&2)===0||d!==qs)&&(d===qs&&((ur&2)===0&&(kR|=w),Cs===4&&Gp(d,yo)),Ba(d,k),w===1&&ur===0&&(p.mode&1)===0&&(Wv=ct()+500,sR&&Dp()))}function Ba(d,p){var w=d.callbackNode;s0(d,p);var k=$d(d,d===qs?yo:0);if(k===0)w!==null&&gt(w),d.callbackNode=null,d.callbackPriority=0;else if(p=k&-k,d.callbackPriority!==p){if(w!=null&&gt(w),p===1)d.tag===0?NEe(GK.bind(null,d)):Iq(GK.bind(null,d)),REe(function(){(ur&6)===0&&Dp()}),w=null;else{switch(vh(k)){case 1:w=Ar;break;case 4:w=Lr;break;case 16:w=pi;break;case 536870912:w=mc;break;default:w=pi}w=ZK(w,UK.bind(null,d))}d.callbackPriority=p,d.callbackNode=w}}function UK(d,p){if(PR=-1,MR=0,(ur&6)!==0)throw Error(n(327));var w=d.callbackNode;if(Hv()&&d.callbackNode!==w)return null;var k=$d(d,d===qs?yo:0);if(k===0)return null;if((k&30)!==0||(k&d.expiredLanes)!==0||p)p=CR(d,k);else{p=k;var P=ur;ur|=2;var D=WK();(qs!==d||yo!==p)&&(Xd=null,Wv=ct()+500,x0(d,p));do try{eSe();break}catch(ce){BK(d,ce)}while(!0);jL(),TR.current=D,ur=P,fs!==null?p=0:(qs=null,yo=0,p=Cs)}if(p!==0){if(p===2&&(P=gb(d),P!==0&&(k=P,p=wD(d,P))),p===1)throw w=Kb,x0(d,0),Gp(d,k),Ba(d,ct()),w;if(p===6)Gp(d,k);else{if(P=d.current.alternate,(k&30)===0&&!JEe(P)&&(p=CR(d,k),p===2&&(D=gb(d),D!==0&&(k=D,p=wD(d,D))),p===1))throw w=Kb,x0(d,0),Gp(d,k),Ba(d,ct()),w;switch(d.finishedWork=P,d.finishedLanes=k,p){case 0:case 1:throw Error(n(345));case 2:w0(d,Ga,Xd);break;case 3:if(Gp(d,k),(k&130023424)===k&&(p=vD+500-ct(),10<p)){if($d(d,0)!==0)break;if(P=d.suspendedLanes,(P&k)!==k){_a(),d.pingedLanes|=d.suspendedLanes&P;break}d.timeoutHandle=AL(w0.bind(null,d,Ga,Xd),p);break}w0(d,Ga,Xd);break;case 4:if(Gp(d,k),(k&4194240)===k)break;for(p=d.eventTimes,P=-1;0<k;){var K=31-ki(k);D=1<<K,K=p[K],K>P&&(P=K),k&=~D}if(k=P,k=ct()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*ZEe(k/1960))-k,10<k){d.timeoutHandle=AL(w0.bind(null,d,Ga,Xd),k);break}w0(d,Ga,Xd);break;case 5:w0(d,Ga,Xd);break;default:throw Error(n(329))}}}return Ba(d,ct()),d.callbackNode===w?UK.bind(null,d):null}function wD(d,p){var w=Yb;return d.current.memoizedState.isDehydrated&&(x0(d,p).flags|=256),d=CR(d,p),d!==2&&(p=Ga,Ga=w,p!==null&&bD(p)),d}function bD(d){Ga===null?Ga=d:Ga.push.apply(Ga,d)}function JEe(d){for(var p=d;;){if(p.flags&16384){var w=p.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var k=0;k<w.length;k++){var P=w[k],D=P.getSnapshot;P=P.value;try{if(!gu(D(),P))return!1}catch{return!1}}}if(w=p.child,p.subtreeFlags&16384&&w!==null)w.return=p,p=w;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Gp(d,p){for(p&=~yD,p&=~kR,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var w=31-ki(p),k=1<<w;d[w]=-1,p&=~k}}function GK(d){if((ur&6)!==0)throw Error(n(327));Hv();var p=$d(d,0);if((p&1)===0)return Ba(d,ct()),null;var w=CR(d,p);if(d.tag!==0&&w===2){var k=gb(d);k!==0&&(p=k,w=wD(d,k))}if(w===1)throw w=Kb,x0(d,0),Gp(d,p),Ba(d,ct()),w;if(w===6)throw Error(n(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,w0(d,Ga,Xd),Ba(d,ct()),null}function ED(d,p){var w=ur;ur|=1;try{return d(p)}finally{ur=w,ur===0&&(Wv=ct()+500,sR&&Dp())}}function _0(d){zp!==null&&zp.tag===0&&(ur&6)===0&&Hv();var p=ur;ur|=1;var w=wc.transition,k=nr;try{if(wc.transition=null,nr=1,d)return d()}finally{nr=k,wc.transition=w,ur=p,(ur&6)===0&&Dp()}}function SD(){Ll=Bv.current,oi(Bv)}function x0(d,p){d.finishedWork=null,d.finishedLanes=0;var w=d.timeoutHandle;if(w!==-1&&(d.timeoutHandle=-1,IEe(w)),fs!==null)for(w=fs.return;w!==null;){var k=w;switch(NL(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&rR();break;case 3:zv(),oi(Va),oi(Do),HL();break;case 5:BL(k);break;case 4:zv();break;case 13:oi(Ai);break;case 19:oi(Ai);break;case 10:FL(k.type._context);break;case 22:case 23:SD()}w=w.return}if(qs=d,fs=d=Bp(d.current,null),yo=Ll=p,Cs=0,Kb=null,yD=kR=v0=0,Ga=Yb=null,m0!==null){for(p=0;p<m0.length;p++)if(w=m0[p],k=w.interleaved,k!==null){w.interleaved=null;var P=k.next,D=w.pending;if(D!==null){var K=D.next;D.next=P,k.next=K}w.pending=k}m0=null}return d}function BK(d,p){do{var w=fs;try{if(jL(),mR.current=_R,gR){for(var k=Ii.memoizedState;k!==null;){var P=k.queue;P!==null&&(P.pending=null),k=k.next}gR=!1}if(y0=0,Hs=Ms=Ii=null,Ub=!1,Gb=0,gD.current=null,w===null||w.return===null){Cs=1,Kb=p,fs=null;break}e:{var D=d,K=w.return,ce=w,he=p;if(p=yo,ce.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var je=he,ot=ce,ht=ot.tag;if((ot.mode&1)===0&&(ht===0||ht===11||ht===15)){var rt=ot.alternate;rt?(ot.updateQueue=rt.updateQueue,ot.memoizedState=rt.memoizedState,ot.lanes=rt.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var Nt=mK(K);if(Nt!==null){Nt.flags&=-257,gK(Nt,K,ce,D,p),Nt.mode&1&&pK(D,je,p),p=Nt,he=je;var Ut=p.updateQueue;if(Ut===null){var Yt=new Set;Yt.add(he),p.updateQueue=Yt}else Ut.add(he);break e}else{if((p&1)===0){pK(D,je,p),TD();break e}he=Error(n(426))}}else if(mi&&ce.mode&1){var is=mK(K);if(is!==null){(is.flags&65536)===0&&(is.flags|=256),gK(is,K,ce,D,p),DL(Uv(he,ce));break e}}D=he=Uv(he,ce),Cs!==4&&(Cs=2),Yb===null?Yb=[D]:Yb.push(D),D=K;do{switch(D.tag){case 3:D.flags|=65536,p&=-p,D.lanes|=p;var be=dK(D,he,p);Fq(D,be);break e;case 1:ce=he;var ge=D.type,Me=D.stateNode;if((D.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(Vp===null||!Vp.has(Me)))){D.flags|=65536,p&=-p,D.lanes|=p;var mt=fK(D,ce,p);Fq(D,mt);break e}}D=D.return}while(D!==null)}qK(w)}catch(Zt){p=Zt,fs===w&&w!==null&&(fs=w=w.return);continue}break}while(!0)}function WK(){var d=TR.current;return TR.current=_R,d===null?_R:d}function TD(){(Cs===0||Cs===3||Cs===2)&&(Cs=4),qs===null||(v0&268435455)===0&&(kR&268435455)===0||Gp(qs,yo)}function CR(d,p){var w=ur;ur|=2;var k=WK();(qs!==d||yo!==p)&&(Xd=null,x0(d,p));do try{QEe();break}catch(P){BK(d,P)}while(!0);if(jL(),ur=w,TR.current=k,fs!==null)throw Error(n(261));return qs=null,yo=0,Cs}function QEe(){for(;fs!==null;)HK(fs)}function eSe(){for(;fs!==null&&!It();)HK(fs)}function HK(d){var p=XK(d.alternate,d,Ll);d.memoizedProps=d.pendingProps,p===null?qK(d):fs=p,gD.current=null}function qK(d){var p=d;do{var w=p.alternate;if(d=p.return,(p.flags&32768)===0){if(w=HEe(w,p,Ll),w!==null){fs=w;return}}else{if(w=qEe(w,p),w!==null){w.flags&=32767,fs=w;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Cs=6,fs=null;return}}if(p=p.sibling,p!==null){fs=p;return}fs=p=d}while(p!==null);Cs===0&&(Cs=5)}function w0(d,p,w){var k=nr,P=wc.transition;try{wc.transition=null,nr=1,tSe(d,p,w,k)}finally{wc.transition=P,nr=k}return null}function tSe(d,p,w,k){do Hv();while(zp!==null);if((ur&6)!==0)throw Error(n(327));w=d.finishedWork;var P=d.finishedLanes;if(w===null)return null;if(d.finishedWork=null,d.finishedLanes=0,w===d.current)throw Error(n(177));d.callbackNode=null,d.callbackPriority=0;var D=w.lanes|w.childLanes;if(hL(d,D),d===qs&&(fs=qs=null,yo=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||IR||(IR=!0,ZK(pi,function(){return Hv(),null})),D=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||D){D=wc.transition,wc.transition=null;var K=nr;nr=1;var ce=ur;ur|=4,gD.current=null,YEe(d,w),$K(w,d),wEe(TL),Vd=!!SL,TL=SL=null,d.current=w,XEe(w),lt(),ur=ce,nr=K,wc.transition=D}else d.current=w;if(IR&&(IR=!1,zp=d,RR=P),D=d.pendingLanes,D===0&&(Vp=null),Tp(w.stateNode),Ba(d,ct()),p!==null)for(k=d.onRecoverableError,w=0;w<p.length;w++)P=p[w],k(P.value,{componentStack:P.stack,digest:P.digest});if(AR)throw AR=!1,d=_D,_D=null,d;return(RR&1)!==0&&d.tag!==0&&Hv(),D=d.pendingLanes,(D&1)!==0?d===xD?Xb++:(Xb=0,xD=d):Xb=0,Dp(),null}function Hv(){if(zp!==null){var d=vh(RR),p=wc.transition,w=nr;try{if(wc.transition=null,nr=16>d?16:d,zp===null)var k=!1;else{if(d=zp,zp=null,RR=0,(ur&6)!==0)throw Error(n(331));var P=ur;for(ur|=4,jt=d.current;jt!==null;){var D=jt,K=D.child;if((jt.flags&16)!==0){var ce=D.deletions;if(ce!==null){for(var he=0;he<ce.length;he++){var je=ce[he];for(jt=je;jt!==null;){var ot=jt;switch(ot.tag){case 0:case 11:case 15:qb(8,ot,D)}var ht=ot.child;if(ht!==null)ht.return=ot,jt=ht;else for(;jt!==null;){ot=jt;var rt=ot.sibling,Nt=ot.return;if(CK(ot),ot===je){jt=null;break}if(rt!==null){rt.return=Nt,jt=rt;break}jt=Nt}}}var Ut=D.alternate;if(Ut!==null){var Yt=Ut.child;if(Yt!==null){Ut.child=null;do{var is=Yt.sibling;Yt.sibling=null,Yt=is}while(Yt!==null)}}jt=D}}if((D.subtreeFlags&2064)!==0&&K!==null)K.return=D,jt=K;else e:for(;jt!==null;){if(D=jt,(D.flags&2048)!==0)switch(D.tag){case 0:case 11:case 15:qb(9,D,D.return)}var be=D.sibling;if(be!==null){be.return=D.return,jt=be;break e}jt=D.return}}var ge=d.current;for(jt=ge;jt!==null;){K=jt;var Me=K.child;if((K.subtreeFlags&2064)!==0&&Me!==null)Me.return=K,jt=Me;else e:for(K=ge;jt!==null;){if(ce=jt,(ce.flags&2048)!==0)try{switch(ce.tag){case 0:case 11:case 15:SR(9,ce)}}catch(Zt){Fi(ce,ce.return,Zt)}if(ce===K){jt=null;break e}var mt=ce.sibling;if(mt!==null){mt.return=ce.return,jt=mt;break e}jt=ce.return}}if(ur=P,Dp(),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(Il,d)}catch{}k=!0}return k}finally{nr=w,wc.transition=p}}return!1}function KK(d,p,w){p=Uv(w,p),p=dK(d,p,1),d=jp(d,p,1),p=_a(),d!==null&&(o0(d,1,p),Ba(d,p))}function Fi(d,p,w){if(d.tag===3)KK(d,d,w);else for(;p!==null;){if(p.tag===3){KK(p,d,w);break}else if(p.tag===1){var k=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(Vp===null||!Vp.has(k))){d=Uv(w,d),d=fK(p,d,1),p=jp(p,d,1),d=_a(),p!==null&&(o0(p,1,d),Ba(p,d));break}}p=p.return}}function nSe(d,p,w){var k=d.pingCache;k!==null&&k.delete(p),p=_a(),d.pingedLanes|=d.suspendedLanes&w,qs===d&&(yo&w)===w&&(Cs===4||Cs===3&&(yo&130023424)===yo&&500>ct()-vD?x0(d,0):yD|=w),Ba(d,p)}function YK(d,p){p===0&&((d.mode&1)===0?p=1:(p=kp,kp<<=1,(kp&130023424)===0&&(kp=4194304)));var w=_a();d=qd(d,p),d!==null&&(o0(d,p,w),Ba(d,w))}function rSe(d){var p=d.memoizedState,w=0;p!==null&&(w=p.retryLane),YK(d,w)}function iSe(d,p){var w=0;switch(d.tag){case 13:var k=d.stateNode,P=d.memoizedState;P!==null&&(w=P.retryLane);break;case 19:k=d.stateNode;break;default:throw Error(n(314))}k!==null&&k.delete(p),YK(d,w)}var XK;XK=function(d,p,w){if(d!==null)if(d.memoizedProps!==p.pendingProps||Va.current)Ua=!0;else{if((d.lanes&w)===0&&(p.flags&128)===0)return Ua=!1,WEe(d,p,w);Ua=(d.flags&131072)!==0}else Ua=!1,mi&&(p.flags&1048576)!==0&&Rq(p,aR,p.index);switch(p.lanes=0,p.tag){case 2:var k=p.type;bR(d,p),d=p.pendingProps;var P=Ov(p,Do.current);Vv(p,w),P=YL(null,p,k,d,P,w);var D=XL();return p.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,za(k)?(D=!0,iR(p)):D=!1,p.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,UL(p),P.updater=xR,p.stateNode=P,P._reactInternals=p,nD(p,k,d,w),p=oD(null,p,k,!0,D,w)):(p.tag=0,mi&&D&&CL(p),va(null,p,P,w),p=p.child),p;case 16:k=p.elementType;e:{switch(bR(d,p),d=p.pendingProps,P=k._init,k=P(k._payload),p.type=k,P=p.tag=oSe(k),d=vu(k,d),P){case 0:p=sD(null,p,k,d,w);break e;case 1:p=bK(null,p,k,d,w);break e;case 11:p=yK(null,p,k,d,w);break e;case 14:p=vK(null,p,k,vu(k.type,d),w);break e}throw Error(n(306,k,""))}return p;case 0:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),sD(d,p,k,P,w);case 1:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),bK(d,p,k,P,w);case 3:e:{if(EK(p),d===null)throw Error(n(387));k=p.pendingProps,D=p.memoizedState,P=D.element,jq(d,p),fR(p,k,null,w);var K=p.memoizedState;if(k=K.element,D.isDehydrated)if(D={element:k,isDehydrated:!1,cache:K.cache,pendingSuspenseBoundaries:K.pendingSuspenseBoundaries,transitions:K.transitions},p.updateQueue.baseState=D,p.memoizedState=D,p.flags&256){P=Uv(Error(n(423)),p),p=SK(d,p,k,w,P);break e}else if(k!==P){P=Uv(Error(n(424)),p),p=SK(d,p,k,w,P);break e}else for(Ol=Np(p.stateNode.containerInfo.firstChild),Nl=p,mi=!0,yu=null,w=Dq(p,null,k,w),p.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if($v(),k===P){p=Yd(d,p,w);break e}va(d,p,k,w)}p=p.child}return p;case 5:return zq(p),d===null&&LL(p),k=p.type,P=p.pendingProps,D=d!==null?d.memoizedProps:null,K=P.children,kL(k,P)?K=null:D!==null&&kL(k,D)&&(p.flags|=32),wK(d,p),va(d,p,K,w),p.child;case 6:return d===null&&LL(p),null;case 13:return TK(d,p,w);case 4:return GL(p,p.stateNode.containerInfo),k=p.pendingProps,d===null?p.child=jv(p,null,k,w):va(d,p,k,w),p.child;case 11:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),yK(d,p,k,P,w);case 7:return va(d,p,p.pendingProps,w),p.child;case 8:return va(d,p,p.pendingProps.children,w),p.child;case 12:return va(d,p,p.pendingProps.children,w),p.child;case 10:e:{if(k=p.type._context,P=p.pendingProps,D=p.memoizedProps,K=P.value,ti(uR,k._currentValue),k._currentValue=K,D!==null)if(gu(D.value,K)){if(D.children===P.children&&!Va.current){p=Yd(d,p,w);break e}}else for(D=p.child,D!==null&&(D.return=p);D!==null;){var ce=D.dependencies;if(ce!==null){K=D.child;for(var he=ce.firstContext;he!==null;){if(he.context===k){if(D.tag===1){he=Kd(-1,w&-w),he.tag=2;var je=D.updateQueue;if(je!==null){je=je.shared;var ot=je.pending;ot===null?he.next=he:(he.next=ot.next,ot.next=he),je.pending=he}}D.lanes|=w,he=D.alternate,he!==null&&(he.lanes|=w),VL(D.return,w,p),ce.lanes|=w;break}he=he.next}}else if(D.tag===10)K=D.type===p.type?null:D.child;else if(D.tag===18){if(K=D.return,K===null)throw Error(n(341));K.lanes|=w,ce=K.alternate,ce!==null&&(ce.lanes|=w),VL(K,w,p),K=D.sibling}else K=D.child;if(K!==null)K.return=D;else for(K=D;K!==null;){if(K===p){K=null;break}if(D=K.sibling,D!==null){D.return=K.return,K=D;break}K=K.return}D=K}va(d,p,P.children,w),p=p.child}return p;case 9:return P=p.type,k=p.pendingProps.children,Vv(p,w),P=_c(P),k=k(P),p.flags|=1,va(d,p,k,w),p.child;case 14:return k=p.type,P=vu(k,p.pendingProps),P=vu(k.type,P),vK(d,p,k,P,w);case 15:return _K(d,p,p.type,p.pendingProps,w);case 17:return k=p.type,P=p.pendingProps,P=p.elementType===k?P:vu(k,P),bR(d,p),p.tag=1,za(k)?(d=!0,iR(p)):d=!1,Vv(p,w),uK(p,k,P),nD(p,k,P,w),oD(null,p,k,!0,d,w);case 19:return AK(d,p,w);case 22:return xK(d,p,w)}throw Error(n(156,p.tag))};function ZK(d,p){return at(d,p)}function sSe(d,p,w,k){this.tag=d,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bc(d,p,w,k){return new sSe(d,p,w,k)}function kD(d){return d=d.prototype,!(!d||!d.isReactComponent)}function oSe(d){if(typeof d=="function")return kD(d)?1:0;if(d!=null){if(d=d.$$typeof,d===B)return 11;if(d===me)return 14}return 2}function Bp(d,p){var w=d.alternate;return w===null?(w=bc(d.tag,p,d.key,d.mode),w.elementType=d.elementType,w.type=d.type,w.stateNode=d.stateNode,w.alternate=d,d.alternate=w):(w.pendingProps=p,w.type=d.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=d.flags&14680064,w.childLanes=d.childLanes,w.lanes=d.lanes,w.child=d.child,w.memoizedProps=d.memoizedProps,w.memoizedState=d.memoizedState,w.updateQueue=d.updateQueue,p=d.dependencies,w.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},w.sibling=d.sibling,w.index=d.index,w.ref=d.ref,w}function NR(d,p,w,k,P,D){var K=2;if(k=d,typeof d=="function")kD(d)&&(K=1);else if(typeof d=="string")K=5;else e:switch(d){case M:return b0(w.children,P,D,p);case N:K=8,P|=8;break;case O:return d=bc(12,w,p,P|2),d.elementType=O,d.lanes=D,d;case U:return d=bc(13,w,p,P),d.elementType=U,d.lanes=D,d;case de:return d=bc(19,w,p,P),d.elementType=de,d.lanes=D,d;case Le:return OR(w,P,D,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case F:K=10;break e;case L:K=9;break e;case B:K=11;break e;case me:K=14;break e;case ze:K=16,k=null;break e}throw Error(n(130,d==null?d:typeof d,""))}return p=bc(K,w,p,P),p.elementType=d,p.type=k,p.lanes=D,p}function b0(d,p,w,k){return d=bc(7,d,k,p),d.lanes=w,d}function OR(d,p,w,k){return d=bc(22,d,k,p),d.elementType=Le,d.lanes=w,d.stateNode={isHidden:!1},d}function AD(d,p,w){return d=bc(6,d,null,p),d.lanes=w,d}function ID(d,p,w){return p=bc(4,d.children!==null?d.children:[],d.key,p),p.lanes=w,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function aSe(d,p,w,k,P){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vb(0),this.expirationTimes=vb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vb(0),this.identifierPrefix=k,this.onRecoverableError=P,this.mutableSourceEagerHydrationData=null}function RD(d,p,w,k,P,D,K,ce,he){return d=new aSe(d,p,w,ce,he),p===1?(p=1,D===!0&&(p|=8)):p=0,D=bc(3,null,null,p),d.current=D,D.stateNode=d,D.memoizedState={element:k,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},UL(D),d}function lSe(d,p,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:k==null?null:""+k,children:d,containerInfo:p,implementation:w}}function JK(d){if(!d)return Lp;d=d._reactInternals;e:{if(ie(d)!==d||d.tag!==1)throw Error(n(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(za(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(n(171))}if(d.tag===1){var w=d.type;if(za(w))return kq(d,w,p)}return p}function QK(d,p,w,k,P,D,K,ce,he){return d=RD(w,k,!0,d,P,D,K,ce,he),d.context=JK(null),w=d.current,k=_a(),P=Up(w),D=Kd(k,P),D.callback=p??null,jp(w,D,P),d.current.lanes=P,o0(d,P,k),Ba(d,k),d}function LR(d,p,w,k){var P=p.current,D=_a(),K=Up(P);return w=JK(w),p.context===null?p.context=w:p.pendingContext=w,p=Kd(D,K),p.payload={element:d},k=k===void 0?null:k,k!==null&&(p.callback=k),d=jp(P,p,K),d!==null&&(wu(d,P,K,D),dR(d,P,K)),K}function DR(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function eY(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var w=d.retryLane;d.retryLane=w!==0&&w<p?w:p}}function PD(d,p){eY(d,p),(d=d.alternate)&&eY(d,p)}function cSe(){return null}var tY=typeof reportError=="function"?reportError:function(d){console.error(d)};function MD(d){this._internalRoot=d}$R.prototype.render=MD.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(n(409));LR(d,p,null,null)},$R.prototype.unmount=MD.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;_0(function(){LR(null,d,null,null)}),p[Gd]=null}};function $R(d){this._internalRoot=d}$R.prototype.unstable_scheduleHydration=function(d){if(d){var p=bb();d={blockedOn:null,target:d,priority:p};for(var w=0;w<Rl.length&&p!==0&&p<Rl[w].priority;w++);Rl.splice(w,0,d),w===0&&vv(d)}};function CD(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function jR(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function nY(){}function uSe(d,p,w,k,P){if(P){if(typeof k=="function"){var D=k;k=function(){var je=DR(K);D.call(je)}}var K=QK(p,k,d,0,null,!1,!1,"",nY);return d._reactRootContainer=K,d[Gd]=K.current,Ob(d.nodeType===8?d.parentNode:d),_0(),K}for(;P=d.lastChild;)d.removeChild(P);if(typeof k=="function"){var ce=k;k=function(){var je=DR(he);ce.call(je)}}var he=RD(d,0,!1,null,null,!1,!1,"",nY);return d._reactRootContainer=he,d[Gd]=he.current,Ob(d.nodeType===8?d.parentNode:d),_0(function(){LR(p,he,w,k)}),he}function FR(d,p,w,k,P){var D=w._reactRootContainer;if(D){var K=D;if(typeof P=="function"){var ce=P;P=function(){var he=DR(K);ce.call(he)}}LR(p,K,d,P)}else K=uSe(w,p,d,P,k);return DR(K)}xb=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var w=yr(p.pendingLanes);w!==0&&(_b(p,w|1),Ba(p,ct()),(ur&6)===0&&(Wv=ct()+500,Dp()))}break;case 13:_0(function(){var k=qd(d,1);if(k!==null){var P=_a();wu(k,d,1,P)}}),PD(d,1)}},gv=function(d){if(d.tag===13){var p=qd(d,134217728);if(p!==null){var w=_a();wu(p,d,134217728,w)}PD(d,134217728)}},wb=function(d){if(d.tag===13){var p=Up(d),w=qd(d,p);if(w!==null){var k=_a();wu(w,d,p,k)}PD(d,p)}},bb=function(){return nr},Eb=function(d,p){var w=nr;try{return nr=d,p()}finally{nr=w}},rn=function(d,p,w){switch(p){case"input":if(dt(d,w),p=w.name,w.type==="radio"&&p!=null){for(w=d;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<w.length;p++){var k=w[p];if(k!==d&&k.form===d.form){var P=nR(k);if(!P)throw Error(n(90));qe(k),dt(k,P)}}}break;case"textarea":Si(d,w);break;case"select":p=w.value,p!=null&&Xr(d,!!w.multiple,p,!1)}},Q=ED,ye=_0;var hSe={usingClientEntryPoint:!1,Events:[$b,Cv,nR,oe,Ve,ED]},Zb={findFiberByHostInstance:h0,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dSe={bundleType:Zb.bundleType,version:Zb.version,rendererPackageName:Zb.rendererPackageName,rendererConfig:Zb.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Ne(d),d===null?null:d.stateNode},findFiberByHostInstance:Zb.findFiberByHostInstance||cSe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var VR=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!VR.isDisabled&&VR.supportsFiber)try{Il=VR.inject(dSe),ns=VR}catch{}}return Wa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hSe,Wa.createPortal=function(d,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!CD(p))throw Error(n(200));return lSe(d,p,null,w)},Wa.createRoot=function(d,p){if(!CD(d))throw Error(n(299));var w=!1,k="",P=tY;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onRecoverableError!==void 0&&(P=p.onRecoverableError)),p=RD(d,1,!1,null,null,w,!1,k,P),d[Gd]=p.current,Ob(d.nodeType===8?d.parentNode:d),new MD(p)},Wa.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=Ne(p),d=d===null?null:d.stateNode,d},Wa.flushSync=function(d){return _0(d)},Wa.hydrate=function(d,p,w){if(!jR(p))throw Error(n(200));return FR(null,d,p,!0,w)},Wa.hydrateRoot=function(d,p,w){if(!CD(d))throw Error(n(405));var k=w!=null&&w.hydratedSources||null,P=!1,D="",K=tY;if(w!=null&&(w.unstable_strictMode===!0&&(P=!0),w.identifierPrefix!==void 0&&(D=w.identifierPrefix),w.onRecoverableError!==void 0&&(K=w.onRecoverableError)),p=QK(p,null,d,1,w??null,P,!1,D,K),d[Gd]=p.current,Ob(d),k)for(d=0;d<k.length;d++)w=k[d],P=w._getVersion,P=P(w._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[w,P]:p.mutableSourceEagerHydrationData.push(w,P);return new $R(p)},Wa.render=function(d,p,w){if(!jR(p))throw Error(n(200));return FR(null,d,p,!1,w)},Wa.unmountComponentAtNode=function(d){if(!jR(d))throw Error(n(40));return d._reactRootContainer?(_0(function(){FR(null,null,d,!1,function(){d._reactRootContainer=null,d[Gd]=null})}),!0):!1},Wa.unstable_batchedUpdates=ED,Wa.unstable_renderSubtreeIntoContainer=function(d,p,w,k){if(!jR(w))throw Error(n(200));if(d==null||d._reactInternals===void 0)throw Error(n(38));return FR(d,p,w,!1,k)},Wa.version="18.3.1-next-f1338f8080-20240426",Wa}var dY;function bSe(){if(dY)return DD.exports;dY=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),DD.exports=wSe(),DD.exports}var fY;function ESe(){if(fY)return zR;fY=1;var t=bSe();return zR.createRoot=t.createRoot,zR.hydrateRoot=t.hydrateRoot,zR}var SSe=ESe();const TSe=nz(SSe);var X=mA();const kSe=nz(X),ll={ADD:"add",REMOVE:"remove"},Ow={PROPERTYCHANGE:"propertychange"},An={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class gA{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function ASe(t,e,n){let r,i;n=n||Uf;let s=0,o=t.length,a=!1;for(;s<o;)r=s+(o-s>>1),i=+n(t[r],e),i<0?s=r+1:(o=r,a=!i);return a?s:~s}function Uf(t,e){return t>e?1:t<e?-1:0}function ISe(t,e){return t<e?1:t>e?-1:0}function GN(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if(typeof n=="function"){for(let i=1;i<r;++i){const s=t[i];if(s===e)return i;if(s<e)return n(e,t[i-1],s)>0?i-1:i}return r-1}if(n>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(n<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function RSe(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function Rr(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let i=0;i<r;i++)t[t.length]=n[i]}function pp(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function PSe(t,e,n){const r=e||Uf;return t.every(function(i,s){if(s===0)return!0;const o=r(t[s-1],i);return!(o>0||o===0)})}function GT(){return!0}function BN(){return!1}function BT(){}function Moe(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return(!n||this!==r||!pp(i,n))&&(r=this,n=i,e=t.apply(this,arguments)),e}}function Coe(t){function e(){let n;try{n=t()}catch(r){return Promise.reject(r)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function M2(t){for(const e in t)delete t[e]}function c1(t){let e;for(e in t)return!1;return!e}class Md{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}let yA=class extends gA{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(n)||i.push(n)}dispatchEvent(e){const n=typeof e=="string",r=n?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=n?new Md(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,a[r]=0),++o[r];let l;for(let c=0,u=i.length;c<u;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[r]===0){let c=a[r];for(delete a[r];c--;)this.removeEventListener(r,BT);delete o[r]}return l}disposeInternal(){this.listeners_&&M2(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(n);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=BT,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}};function Hn(t,e,n,r,i){if(i){const o=n;n=function(a){return t.removeEventListener(e,n),o.call(r??this,a)}}else r&&r!==t&&(n=n.bind(r));const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function JC(t,e,n,r){return Hn(t,e,n,r,!0)}function Jr(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),M2(t))}class vA extends yA{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(An.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Hn(this,e[s],n);return i}return Hn(this,e,n)}onceInternal(e,n){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=JC(this,e[s],n)}else r=JC(this,e,n);return n.ol_key=r,r}unInternal(e,n){const r=n.ol_key;if(r)MSe(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],n);else this.removeEventListener(e,n)}}vA.prototype.on;vA.prototype.once;vA.prototype.un;function MSe(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Jr(t[e]);else Jr(t)}function xn(){throw new Error("Unimplemented abstract method.")}let CSe=0;function _n(t){return t.ol_uid||(t.ol_uid=String(++CSe))}class pY extends Md{constructor(e,n,r){super(e),this.key=n,this.oldValue=r}}class Cd extends vA{constructor(e){super(),this.on,this.once,this.un,_n(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new pY(r,e,n)),r=Ow.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new pY(r,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,r){const i=this.values_||(this.values_={});if(r)i[e]=n;else{const s=i[e];i[e]=n,s!==n&&this.notify(e,s)}}setProperties(e,n){for(const r in e)this.set(r,e[r],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],c1(this.values_)&&(this.values_=null),n||this.notify(e,r)}}}const mY={LENGTH:"length"};class UR extends Md{constructor(e,n,r){super(e),this.element=n,this.index=r}}class Hc extends Cd{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,r=e.length;n<r;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)e(n[r],r,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(mY.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new UR(ll.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)if(n[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new UR(ll.REMOVE,n,e)),n}setAt(e,n){const r=this.getLength();if(e>=r){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const i=this.array_[e];this.array_[e]=n,this.dispatchEvent(new UR(ll.REMOVE,i,e)),this.dispatchEvent(new UR(ll.ADD,n,e))}updateLength_(){this.set(mY.LENGTH,this.array_.length)}assertUnique_(e,n){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}}function or(t,e){if(!t)throw new Error(e)}let _i=class Noe extends Cd{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new Noe(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Jr(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Hn(e,An.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?NSe(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function NSe(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(or(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}const Qs={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function gY(t){const e=wl();for(let n=0,r=t.length;n<r;++n)LS(e,t[n]);return e}function Gf(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Ooe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function H1(t,e,n){let r,i;return e<t[0]?r=t[0]-e:t[2]<e?r=e-t[2]:r=0,n<t[1]?i=t[1]-n:t[3]<n?i=n-t[3]:i=0,r*r+i*i}function u1(t,e){return rz(t,e[0],e[1])}function zm(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function rz(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function G8(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=e[0],a=e[1];let l=Qs.UNKNOWN;return o<n?l=l|Qs.LEFT:o>i&&(l=l|Qs.RIGHT),a<r?l=l|Qs.BELOW:a>s&&(l=l|Qs.ABOVE),l===Qs.UNKNOWN&&(l=Qs.INTERSECTING),l}function wl(){return[1/0,1/0,-1/0,-1/0]}function Eg(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function _A(t){return Eg(1/0,1/0,-1/0,-1/0,t)}function Loe(t,e){const n=t[0],r=t[1];return Eg(n,r,n,r,e)}function iz(t,e,n,r,i){const s=_A(i);return $oe(s,t,e,n,r)}function h1(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Doe(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function LS(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function $oe(t,e,n,r,i){for(;n<r;n+=i)OSe(t,e[n],e[n+1]);return t}function OSe(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function joe(t,e){let n;return n=e(WN(t)),n||(n=e(HN(t)),n)||(n=e(qN(t)),n)||(n=e(q1(t)),n)?n:!1}function B8(t){let e=0;return C2(t)||(e=Gn(t)*cs(t)),e}function WN(t){return[t[0],t[1]]}function HN(t){return[t[2],t[1]]}function oh(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function LSe(t,e){let n;if(e==="bottom-left")n=WN(t);else if(e==="bottom-right")n=HN(t);else if(e==="top-left")n=q1(t);else if(e==="top-right")n=qN(t);else throw new Error("Invalid corner");return n}function QC(t,e,n,r,i){const[s,o,a,l,c,u,h,f]=Foe(t,e,n,r);return Eg(Math.min(s,a,c,h),Math.min(o,l,u,f),Math.max(s,a,c,h),Math.max(o,l,u,f),i)}function Foe(t,e,n,r){const i=e*r[0]/2,s=e*r[1]/2,o=Math.cos(n),a=Math.sin(n),l=i*o,c=i*a,u=s*o,h=s*a,f=t[0],g=t[1];return[f-l+h,g-c-u,f-l-h,g-c+u,f+l-h,g+c+u,f+l+h,g+c-u,f-l+h,g-c-u]}function cs(t){return t[3]-t[1]}function Bf(t,e,n){const r=n||wl();return Ia(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):_A(r),r}function q1(t){return[t[0],t[3]]}function qN(t){return[t[2],t[3]]}function Gn(t){return t[2]-t[0]}function Ia(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function C2(t){return t[2]<t[0]||t[3]<t[1]}function DSe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function $Se(t,e,n){let r=!1;const i=G8(t,e),s=G8(t,n);if(i===Qs.INTERSECTING||s===Qs.INTERSECTING)r=!0;else{const o=t[0],a=t[1],l=t[2],c=t[3],u=e[0],h=e[1],f=n[0],g=n[1],v=(g-h)/(f-u);let x,b;s&Qs.ABOVE&&!(i&Qs.ABOVE)&&(x=f-(g-c)/v,r=x>=o&&x<=l),!r&&s&Qs.RIGHT&&!(i&Qs.RIGHT)&&(b=g-(f-l)*v,r=b>=a&&b<=c),!r&&s&Qs.BELOW&&!(i&Qs.BELOW)&&(x=f-(g-a)/v,r=x>=o&&x<=l),!r&&s&Qs.LEFT&&!(i&Qs.LEFT)&&(b=g-(f-o)*v,r=b>=a&&b<=c)}return r}function Voe(t,e){const n=e.getExtent(),r=oh(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const i=Gn(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}function zoe(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];Voe(t,e);const i=Gn(r);if(Gn(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function ii(t,e,n){return Math.min(Math.max(t,e),n)}function jSe(t,e,n,r,i,s){const o=i-n,a=s-r;if(o!==0||a!==0){const l=((t-n)*o+(e-r)*a)/(o*o+a*a);l>1?(n=i,r=s):l>0&&(n+=o*l,r+=a*l)}return zy(t,e,n,r)}function zy(t,e,n,r){const i=n-t,s=r-e;return i*i+s*s}function FSe(t){const e=t.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(t[r][r]);for(let a=r+1;a<e;a++){const l=Math.abs(t[a][r]);l>s&&(s=l,i=a)}if(s===0)return null;const o=t[i];t[i]=t[r],t[r]=o;for(let a=r+1;a<e;a++){const l=-t[a][r]/t[r][r];for(let c=r;c<e+1;c++)r==c?t[a][c]=0:t[a][c]+=l*t[r][c]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}function yY(t){return t*180/Math.PI}function Wf(t){return t*Math.PI/180}function og(t,e){const n=t%e;return n*e<0?n+e:n}function Yl(t,e,n){return t+n*(e-t)}function xA(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function e3(t,e){return Math.round(xA(t,e))}function GR(t,e){return Math.floor(xA(t,e))}function Um(t,e){return Math.ceil(xA(t,e))}function W8(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}function eE(t,e,n){const r=""+t;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function Uoe(t,e){const n=(""+t).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(n.length,r.length);i++){const s=parseInt(n[i]||"0",10),o=parseInt(r[i]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function VSe(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function t3(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function sz(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,s=t[1]*n+t[0]*r;return t[0]=i,t[1]=s,t}function zSe(t,e){return t[0]*=e,t[1]*=e,t}function Goe(t,e){if(e.canWrapX()){const n=Gn(e.getExtent()),r=Boe(t,e,n);r&&(t[0]-=r*n)}return t}function Boe(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||Gn(r),i=Math.floor((t[0]-r[0])/n)),i}function Woe(...t){console.warn(...t)}const Lw={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let KN=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Lw[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const wA=6378137,hx=Math.PI*wA,USe=[-hx,-hx,hx,hx],GSe=[-180,-85,180,85],BR=wA*Math.log(Math.tan(Math.PI/2));class qv extends KN{constructor(e){super({code:e,units:"m",extent:USe,global:!0,worldExtent:GSe,getPointResolution:function(n,r){return n/Math.cosh(r[1]/wA)}})}}const vY=[new qv("EPSG:3857"),new qv("EPSG:102100"),new qv("EPSG:102113"),new qv("EPSG:900913"),new qv("http://www.opengis.net/def/crs/EPSG/0/3857"),new qv("http://www.opengis.net/gml/srs/epsg.xml#3857")];function BSe(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=hx*t[s]/180;let o=wA*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));o>BR?o=BR:o<-BR&&(o=-BR),e[s+1]=o}return e}function WSe(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*t[s]/hx,e[s+1]=360*Math.atan(Math.exp(t[s+1]/wA))/Math.PI-90;return e}const HSe=6378137,_Y=[-180,-90,180,90],qSe=Math.PI*HSe/180;class E0 extends KN{constructor(e,n){super({code:e,units:"degrees",extent:_Y,axisOrientation:n,global:!0,metersPerUnit:qSe,worldExtent:_Y})}}const xY=[new E0("CRS:84"),new E0("EPSG:4326","neu"),new E0("urn:ogc:def:crs:OGC:1.3:CRS84"),new E0("urn:ogc:def:crs:OGC:2:84"),new E0("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new E0("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new E0("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let H8={};function vM(t){return H8[t]||H8[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function KSe(t,e){H8[t]=e}let Lx={};function d1(t,e,n){const r=t.getCode(),i=e.getCode();r in Lx||(Lx[r]={}),Lx[r][i]=n}function _M(t,e){return t in Lx&&e in Lx[t]?Lx[t][e]:null}const n3=.9996,Jc=.00669438,YN=Jc*Jc,XN=YN*Jc,xy=Jc/(1-Jc),wY=Math.sqrt(1-Jc),Dw=(1-wY)/(1+wY),Hoe=Dw*Dw,oz=Hoe*Dw,az=oz*Dw,qoe=az*Dw,Koe=1-Jc/4-3*YN/64-5*XN/256,YSe=3*Jc/8+3*YN/32+45*XN/1024,XSe=15*YN/256+45*XN/1024,ZSe=35*XN/3072,JSe=3/2*Dw-27/32*oz+269/512*qoe,QSe=21/16*Hoe-55/32*az,eTe=151/96*oz-417/128*qoe,tTe=1097/512*az,r3=6378137;function nTe(t,e,n){const r=t-5e5,o=(n.north?e:e-1e7)/n3/(r3*Koe),a=o+JSe*Math.sin(2*o)+QSe*Math.sin(4*o)+eTe*Math.sin(6*o)+tTe*Math.sin(8*o),l=Math.sin(a),c=l*l,u=Math.cos(a),h=l/u,f=h*h,g=f*f,v=1-Jc*c,x=Math.sqrt(1-Jc*c),b=r3/x,T=(1-Jc)/v,A=xy*u**2,I=A*A,R=r/(b*n3),C=R*R,V=C*R,M=V*R,N=M*R,O=N*R,F=a-h/T*(C/2-M/24*(5+3*f+10*A-4*I-9*xy))+O/720*(61+90*f+298*A+45*g-252*xy-3*I);let L=(R-V/6*(1+2*f+A)+N/120*(5-2*A+28*f-3*I+8*xy+24*g))/u;return L=W8(L+Wf(Yoe(n.number)),-Math.PI,Math.PI),[yY(L),yY(F)]}const bY=-80,EY=84,rTe=-180,iTe=180;function sTe(t,e,n){t=W8(t,rTe,iTe),e<bY?e=bY:e>EY&&(e=EY);const r=Wf(e),i=Math.sin(r),s=Math.cos(r),o=i/s,a=o*o,l=a*a,c=Wf(t),u=Yoe(n.number),h=Wf(u),f=r3/Math.sqrt(1-Jc*i**2),g=xy*s**2,v=s*W8(c-h,-Math.PI,Math.PI),x=v*v,b=x*v,T=b*v,A=T*v,I=A*v,R=r3*(Koe*r-YSe*Math.sin(2*r)+XSe*Math.sin(4*r)-ZSe*Math.sin(6*r)),C=n3*f*(v+b/6*(1-a+g)+A/120*(5-18*a+l+72*g-58*xy))+5e5;let V=n3*(R+f*o*(x/2+T/24*(5-a+9*g+4*g**2)+I/720*(61-58*a+l+600*g-330*xy)));return n.north||(V+=1e7),[C,V]}function Yoe(t){return(t-1)*6-180+3}const oTe=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Xoe(t){let e=0;for(const i of oTe){const s=t.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function SY(t,e){return function(n,r,i,s){const o=n.length;i=i>1?i:2,s=s??i,r||(i>2?r=n.slice():r=new Array(o));for(let a=0;a<o;a+=s){const l=n[a],c=n[a+1],u=t(l,c,e);r[a]=u[0],r[a+1]=u[1]}return r}}function aTe(t){return Xoe(t)?new KN({code:t,units:"m"}):null}function lTe(t){const e=Xoe(t.getCode());return e?{forward:SY(sTe,e),inverse:SY(nTe,e)}:null}const cTe=63710088e-1;function TY(t,e,n){n=n||cTe;const r=Wf(t[1]),i=Wf(e[1]),s=(i-r)/2,o=Wf(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const uTe=[lTe],hTe=[aTe];let q8=!0;function Zoe(t){q8=!1}function lz(t,e){if(e!==void 0){for(let n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function i3(t){KSe(t.getCode(),t),d1(t,t,lz)}function dTe(t){t.forEach(i3)}function Yr(t){if(typeof t!="string")return t;const e=vM(t);if(e)return e;for(const n of hTe){const r=n(t);if(r)return r}return null}function s3(t,e,n,r){t=Yr(t);let i;const s=t.getPointResolutionFunc();if(s){if(i=s(e,n),r&&r!==t.getUnits()){const o=t.getMetersPerUnit();o&&(i=i*o/Lw[r])}}else{const o=t.getUnits();if(o=="degrees"&&!r||r=="degrees")i=e;else{const a=uz(t,Yr("EPSG:4326"));if(!a&&o!=="degrees")i=e*t.getMetersPerUnit();else{let c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];c=a(c,c,2);const u=TY(c.slice(0,2),c.slice(2,4)),h=TY(c.slice(4,6),c.slice(6,8));i=(u+h)/2}const l=r?Lw[r]:t.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function K8(t){dTe(t),t.forEach(function(e){t.forEach(function(n){e!==n&&d1(e,n,lz)})})}function fTe(t,e,n,r){t.forEach(function(i){e.forEach(function(s){d1(i,s,n),d1(s,i,r)})})}function cz(t,e){return t?typeof t=="string"?Yr(t):t:Yr(e)}function Y8(t){return(function(e,n,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,n=n!==void 0?n:new Array(s);for(let o=0;o<s;o+=i){const a=t(e.slice(o,o+r)),l=a.length;for(let c=0,u=i;c<u;++c)n[o+c]=c>=l?e[o+c]:a[c]}return n})}function pTe(t,e,n,r){const i=Yr(t),s=Yr(e);d1(i,s,Y8(n)),d1(s,i,Y8(r))}function Pi(t,e){return Zoe(),N2(t,"EPSG:4326","EPSG:3857")}function Zn(t,e){const n=N2(t,"EPSG:3857","EPSG:4326"),r=n[0];return(r<-180||r>180)&&(n[0]=og(r+180,360)-180),n}function Uy(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||uz(t,e)===lz)&&n}function uz(t,e){const n=t.getCode(),r=e.getCode();let i=_M(n,r);if(i)return i;let s=null,o=null;for(const l of uTe)s||(s=l(t)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)i=FD(s.inverse,o.forward);else{const l=_M(n,a);l&&(i=FD(l,o.forward))}else{const l=_M(a,r);l&&(i=FD(s.inverse,l))}return i&&(i3(t),i3(e),d1(t,e,i)),i}function FD(t,e){return function(n,r,i,s){return r=t(n,r,i,s),e(r,r,i,s)}}function WT(t,e){const n=Yr(t),r=Yr(e);return uz(n,r)}function N2(t,e,n){const r=WT(e,n);if(!r){const i=Yr(e).getCode(),s=Yr(n).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(t,void 0,t.length)}function X8(t,e){return t}function af(t,e){return q8&&!t3(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(q8=!1,Woe("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function Joe(t,e){return t}function nd(t,e){return t}function kY(t,e,n){return function(r){let i,s;if(t.canWrapX()){const o=t.getExtent(),a=Gn(o);r=r.slice(0),s=Boe(r,t,a),s&&(r[0]=r[0]-s*a),r[0]=ii(r[0],o[0],o[2]),r[1]=ii(r[1],o[1],o[3]),i=n(r)}else i=n(r);return s&&e.canWrapX()&&(i[0]+=s*Gn(e.getExtent())),i}}function mTe(){K8(vY),K8(xY),fTe(xY,vY,BSe,WSe)}mTe();const gTe=new Array(6);function js(){return[1,0,0,1,0,0]}function Qoe(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],g=e[5];return t[0]=n*l+i*c,t[1]=r*l+s*c,t[2]=n*u+i*h,t[3]=r*u+s*h,t[4]=n*f+i*g+o,t[5]=r*f+s*g+a,t}function yTe(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function eae(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Ki(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function vTe(t,e,n){return Qoe(t,yTe(gTe,1,0,0,1,e,n))}function iu(t,e,n,r,i,s,o,a){const l=Math.sin(s),c=Math.cos(s);return t[0]=r*c,t[1]=i*l,t[2]=-r*l,t[3]=i*c,t[4]=o*r*c-a*r*l+e,t[5]=o*i*l+a*i*c+n,t}function HT(t,e){const n=_Te(e);or(n!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return t[0]=o/n,t[1]=-i/n,t[2]=-s/n,t[3]=r/n,t[4]=(s*l-o*a)/n,t[5]=-(r*l-i*a)/n,t}function _Te(t){return t[0]*t[3]-t[1]*t[2]}const xTe=[1e5,1e5,1e5,1e5,2,2];function wTe(t){return"matrix("+t.join(", ")+")"}function Z8(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function bTe(t,e){const n=Z8(t),r=Z8(e);for(let i=0;i<6;++i)if(Math.round((n[i]-r[i])*xTe[i])!==0)return!1;return!0}function ad(t,e,n,r,i,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<n;l+=r){const c=t[l],u=t[l+1];s[a++]=i[0]*c+i[2]*u+i[4],s[a++]=i[1]*c+i[3]*u+i[5];for(let h=2;h<o;h++)s[a++]=t[l+h]}return s&&s.length!=a&&(s.length=a),s}function tae(t,e,n,r,i,s,o){o=o||[];const a=Math.cos(i),l=Math.sin(i),c=s[0],u=s[1];let h=0;for(let f=e;f<n;f+=r){const g=t[f]-c,v=t[f+1]-u;o[h++]=c+g*a-v*l,o[h++]=u+g*l+v*a;for(let x=f+2;x<f+r;++x)o[h++]=t[x]}return o&&o.length!=h&&(o.length=h),o}function ETe(t,e,n,r,i,s,o,a){a=a||[];const l=o[0],c=o[1];let u=0;for(let h=e;h<n;h+=r){const f=t[h]-l,g=t[h+1]-c;a[u++]=l+i*f,a[u++]=c+s*g;for(let v=h+2;v<h+r;++v)a[u++]=t[v]}return a&&a.length!=u&&(a.length=u),a}function STe(t,e,n,r,i,s,o){o=o||[];let a=0;for(let l=e;l<n;l+=r){o[a++]=t[l]+i,o[a++]=t[l+1]+s;for(let c=l+2;c<l+r;++c)o[a++]=t[c]}return o&&o.length!=a&&(o.length=a),o}const AY=js(),TTe=[NaN,NaN];class nae extends Cd{constructor(){super(),this.extent_=wl(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Moe((e,n,r)=>{if(!r)return this.getSimplifiedGeometry(n);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return xn()}closestPointXY(e,n,r,i){return xn()}containsXY(e,n){return this.closestPointXY(e,n,TTe,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return xn()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&_A(n),this.extentRevision_=this.getRevision()}return DSe(this.extent_,e)}rotate(e,n){xn()}scale(e,n,r){xn()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return xn()}getType(){return xn()}applyTransform(e){xn()}intersectsExtent(e){return xn()}translate(e,n){xn()}transform(e,n){const r=Yr(e),i=r.getUnits()=="tile-pixels"?function(s,o,a){const l=r.getExtent(),c=r.getWorldExtent(),u=cs(c)/cs(l);iu(AY,c[0],c[3],u,-u,0,0,0);const h=ad(s,0,s.length,a,AY,o),f=WT(r,n);return f?f(h,h,a):h}:WT(r,n);return this.applyTransform(i),this}}class K1 extends nae{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return iz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return xn()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=IY(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){xn()}setLayout(e,n,r){let i;if(e)i=IY(e);else{for(let s=0;s<r;++s){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}i=n.length,e=Y1(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();tae(r,0,r.length,i,e,n,r),this.changed()}}scale(e,n,r){n===void 0&&(n=e),r||(r=oh(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();ETe(i,0,i.length,s,e,n,r,i),this.changed()}}translate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();STe(r,0,r.length,i,e,n,r),this.changed()}}}function Y1(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function IY(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function kTe(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return ad(r,0,r.length,i,e,n)}function RY(t,e,n,r,i,s,o){const a=t[e],l=t[e+1],c=t[n]-a,u=t[n+1]-l;let h;if(c===0&&u===0)h=e;else{const f=((i-a)*c+(s-l)*u)/(c*c+u*u);if(f>1)h=n;else if(f>0){for(let g=0;g<r;++g)o[g]=Yl(t[e+g],t[n+g],f);o.length=r;return}else h=e}for(let f=0;f<r;++f)o[f]=t[h+f];o.length=r}function hz(t,e,n,r,i){let s=t[e],o=t[e+1];for(e+=r;e<n;e+=r){const a=t[e],l=t[e+1],c=zy(s,o,a,l);c>i&&(i=c),s=a,o=l}return i}function dz(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=hz(t,e,a,r,i),e=a}return i}function ATe(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=dz(t,e,a,r,i),e=a[a.length-1]}return i}function fz(t,e,n,r,i,s,o,a,l,c,u){if(e==n)return c;let h,f;if(i===0){if(f=zy(o,a,t[e],t[e+1]),f<c){for(h=0;h<r;++h)l[h]=t[e+h];return l.length=r,f}return c}u=u||[NaN,NaN];let g=e+r;for(;g<n;)if(RY(t,g-r,g,r,o,a,u),f=zy(o,a,u[0],u[1]),f<c){for(c=f,h=0;h<r;++h)l[h]=u[h];l.length=r,g+=r}else g+=r*Math.max((Math.sqrt(f)-Math.sqrt(c))/i|0,1);if(s&&(RY(t,n-r,e,r,o,a,u),f=zy(o,a,u[0],u[1]),f<c)){for(c=f,h=0;h<r;++h)l[h]=u[h];l.length=r}return c}function pz(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let h=0,f=n.length;h<f;++h){const g=n[h];c=fz(t,e,g,r,i,s,o,a,l,c,u),e=g}return c}function ITe(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let h=0,f=n.length;h<f;++h){const g=n[h];c=pz(t,e,g,r,i,s,o,a,l,c,u),e=g[g.length-1]}return c}function RTe(t,e,n,r){for(let i=0,s=n.length;i<s;++i)t[e++]=n[i];return e}function ZN(t,e,n,r){for(let i=0,s=n.length;i<s;++i){const o=n[i];for(let a=0;a<r;++a)t[e++]=o[a]}return e}function bA(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=ZN(t,e,n[o],r);i[s++]=l,e=l}return i.length=s,i}function rae(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=bA(t,e,n[o],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function Gm(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=e;o<n;o+=r)i[s++]=t.slice(o,o+r);return i.length=s,i}function qT(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=Gm(t,e,l,r,i[s]),e=l}return i.length=s,i}function J8(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=l.length===1&&l[0]===e?[]:qT(t,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function o3(t,e,n,r,i,s,o){let a,l;const c=(n-e)/r;if(c===1)a=e;else if(c===2)a=e,l=i;else if(c!==0){let u=t[e],h=t[e+1],f=0;const g=[0];for(let b=e+r;b<n;b+=r){const T=t[b],A=t[b+1];f+=Math.sqrt((T-u)*(T-u)+(A-h)*(A-h)),g.push(f),u=T,h=A}const v=i*f,x=ASe(g,v);x<0?(l=(v-g[-x-2])/(g[-x-1]-g[-x-2]),a=e+(-x-2)*r):a=e+x*r}o=o>1?o:2,s=s||new Array(o);for(let u=0;u<o;++u)s[u]=a===void 0?NaN:l===void 0?t[a+u]:Yl(t[a+u],t[a+r+u],l);return s}function Q8(t,e,n,r,i,s){if(n==e)return null;let o;if(i<t[e+r-1])return s?(o=t.slice(e,e+r),o[r-1]=i,o):null;if(t[n-1]<i)return s?(o=t.slice(n-r,n),o[r-1]=i,o):null;if(i==t[e+r-1])return t.slice(e,e+r);let a=e/r,l=n/r;for(;a<l;){const f=a+l>>1;i<t[(f+1)*r-1]?l=f:a=f+1}const c=t[a*r-1];if(i==c)return t.slice((a-1)*r,(a-1)*r+r);const u=t[(a+1)*r-1],h=(i-c)/(u-c);o=[];for(let f=0;f<r-1;++f)o.push(Yl(t[(a-1)*r+f],t[a*r+f],h));return o.push(i),o}function PTe(t,e,n,r,i,s,o){if(o)return Q8(t,e,n[n.length-1],r,i,s);let a;if(i<t[r-1])return s?(a=t.slice(0,r),a[r-1]=i,a):null;if(t[t.length-1]<i)return s?(a=t.slice(t.length-r),a[r-1]=i,a):null;for(let l=0,c=n.length;l<c;++l){const u=n[l];if(e!=u){if(i<t[e+r-1])return null;if(i<=t[u-1])return Q8(t,e,u,r,i,!1);e=u}}return null}function MTe(t,e,n,r,i){return!joe(i,function(o){return!wy(t,e,n,r,o[0],o[1])})}function wy(t,e,n,r,i,s){let o=0,a=t[n-r],l=t[n-r+1];for(;e<n;e+=r){const c=t[e],u=t[e+1];l<=s?u>s&&(c-a)*(s-l)-(i-a)*(u-l)>0&&o++:u<=s&&(c-a)*(s-l)-(i-a)*(u-l)<0&&o--,a=c,l=u}return o!==0}function mz(t,e,n,r,i,s){if(n.length===0||!wy(t,e,n[0],r,i,s))return!1;for(let o=1,a=n.length;o<a;++o)if(wy(t,n[o-1],n[o],r,i,s))return!1;return!0}function CTe(t,e,n,r,i,s){if(n.length===0)return!1;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(mz(t,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function iae(t,e,n,r,i){let s;for(e+=r;e<n;e+=r)if(s=i(t.slice(e-r,e),t.slice(e,e+r)),s)return s;return!1}function JN(t,e,n,r,i,s){return s=s??$oe(wl(),t,e,n,r),Ia(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:iae(t,e,n,r,function(o,a){return $Se(i,o,a)}):!1}function NTe(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){if(JN(t,e,n[s],r,i))return!0;e=n[s]}return!1}function sae(t,e,n,r,i){return!!(JN(t,e,n,r,i)||wy(t,e,n,r,i[0],i[1])||wy(t,e,n,r,i[0],i[3])||wy(t,e,n,r,i[2],i[1])||wy(t,e,n,r,i[2],i[3]))}function oae(t,e,n,r,i){if(!sae(t,e,n[0],r,i))return!1;if(n.length===1)return!0;for(let s=1,o=n.length;s<o;++s)if(MTe(t,n[s-1],n[s],r,i)&&!JN(t,n[s-1],n[s],r,i))return!1;return!0}function OTe(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(oae(t,e,a,r,i))return!0;e=a[a.length-1]}return!1}function gz(t,e,n,r){let i=t[e],s=t[e+1],o=0;for(let a=e+r;a<n;a+=r){const l=t[a],c=t[a+1];o+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return o}function QN(t,e,n,r,i,s,o){const a=(n-e)/r;if(a<3){for(;e<n;e+=r)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,n-r];let u=0;for(;c.length>0;){const h=c.pop(),f=c.pop();let g=0;const v=t[f],x=t[f+1],b=t[h],T=t[h+1];for(let A=f+r;A<h;A+=r){const I=t[A],R=t[A+1],C=jSe(I,R,v,x,b,T);C>g&&(u=A,g=C)}g>i&&(l[(u-e)/r]=1,f+r<u&&c.push(f,u),u+r<h&&c.push(u,h))}for(let h=0;h<a;++h)l[h]&&(s[o++]=t[e+h*r],s[o++]=t[e+h*r+1]);return o}function aae(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=QN(t,e,u,r,i,s,o),a.push(o),e=u}return o}function $0(t,e){return e*Math.round(t/e)}function LTe(t,e,n,r,i,s,o){if(e==n)return o;let a=$0(t[e],i),l=$0(t[e+1],i);e+=r,s[o++]=a,s[o++]=l;let c,u;do if(c=$0(t[e],i),u=$0(t[e+1],i),e+=r,e==n)return s[o++]=c,s[o++]=u,o;while(c==a&&u==l);for(;e<n;){const h=$0(t[e],i),f=$0(t[e+1],i);if(e+=r,h==c&&f==u)continue;const g=c-a,v=u-l,x=h-a,b=f-l;if(g*b==v*x&&(g<0&&x<g||g==x||g>0&&x>g)&&(v<0&&b<v||v==b||v>0&&b>v)){c=h,u=f;continue}s[o++]=c,s[o++]=u,a=c,l=u,c=h,u=f}return s[o++]=c,s[o++]=u,o}function yz(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=LTe(t,e,u,r,i,s,o),a.push(o),e=u}return o}function DTe(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l],h=[];o=yz(t,e,u,r,i,s,o,h),a.push(h),e=u[u.length-1]}return o}class ro extends K1{constructor(e,n){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendCoordinate(e){Rr(this.flatCoordinates,e),this.changed()}clone(){const e=new ro(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,n,r,i))}forEachSegment(e){return iae(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,n){return this.layout!="XYM"&&this.layout!="XYZM"?null:(n=n!==void 0?n:!1,Q8(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n))}getCoordinates(){return Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,n){return o3(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,this.stride)}getLength(){return gz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const n=[];return n.length=QN(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new ro(n,"XY")}getType(){return"LineString"}intersectsExtent(e){return JN(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ZN(this.flatCoordinates,0,e,this.stride),this.changed()}}let Vs=class lae extends K1{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new lae(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const s=this.flatCoordinates,o=zy(e,n,s[0],s[1]);if(o<i){const a=this.stride;for(let l=0;l<a;++l)r[l]=s[l];return r.length=a,o}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return Loe(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return rz(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=RTe(this.flatCoordinates,0,e,this.stride),this.changed()}};const no={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},f1=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",$Te=f1.includes("safari")&&!f1.includes("chrom"),jTe=$Te&&(f1.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(f1)),FTe=f1.includes("webkit")&&!f1.includes("edge"),cae=f1.includes("macintosh"),VTe=typeof devicePixelRatio<"u"?devicePixelRatio:1,tc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,vz=typeof Image<"u"&&Image.prototype.decode,uae=typeof createImageBitmap=="function",hae=(function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t})(),Vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Ts(t,e,n,r){let i;return n&&n.length?i=n.shift():tc?i=new class extends OffscreenCanvas{style={}}(t??300,e??150):i=document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let VD;function a3(){return VD||(VD=Ts(1,1)),VD}function e5(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function PY(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function zTe(t){for(;t.lastChild;)t.lastChild.remove()}function UTe(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){t.appendChild(s);continue}if(!s){t.removeChild(i),--r;continue}t.insertBefore(s,i)}}}function dae(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,n,r){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,r)}})}function Bm(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}const _z=[NaN,NaN,NaN,0];let zD;function GTe(){return zD||(zD=Ts(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),zD}const BTe=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,WTe=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,HTe=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,qTe=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function WR(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function DS(t){throw new Error('failed to parse "'+t+'" as color')}function fae(t){if(t.toLowerCase().startsWith("rgb")){const s=t.match(WTe)||t.match(BTe)||t.match(HTe);if(s){const o=s[4],a=100/255;return[ii(WR(s[1],a)+.5|0,0,255),ii(WR(s[2],a)+.5|0,0,255),ii(WR(s[3],a)+.5|0,0,255),o!==void 0?ii(WR(o,100),0,1):1]}DS(t)}if(t.startsWith("#")){if(qTe.test(t)){const s=t.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let u=parseInt(s.substring(l,l+o),16);o===1&&(u+=u<<4),a[l/o]=u}return a[3]=a[3]/255,a}DS(t)}const e=GTe();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&DS(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return fae(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=xA(i[3]/255,3),i}function KTe(t){return typeof t=="string"?t:wz(t)}const YTe=1024,tE={};let UD=0;function XTe(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function GD(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function BD(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function WD(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function HD(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function MY(t){const e=WD(t[0]),n=WD(t[1]),r=WD(t[2]),i=HD(e*.222488403+n*.716873169+r*.06060791),s=500*(HD(e*.452247074+n*.399439023+r*.148375274)-i),o=200*(i-HD(e*.016863605+n*.117638439+r*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+o*o),a<0?a+360:a,t[3]]}function ZTe(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=BD(e),s=BD(e+n/500*Math.cos(r)),o=BD(e-n/200*Math.sin(r)),a=GD(s*3.021973625-i*1.617392459-o*.404875592),l=GD(s*-.943766287+i*1.916279586+o*.027607165),c=GD(s*.069407491-i*.22898585+o*1.159737864);return[ii(a+.5|0,0,255),ii(l+.5|0,0,255),ii(c+.5|0,0,255),t[3]]}function xz(t){if(t==="none")return _z;if(tE.hasOwnProperty(t))return tE[t];if(UD>=YTe){let n=0;for(const r in tE)(n++&3)===0&&(delete tE[r],--UD)}const e=fae(t);e.length!==4&&DS(t);for(const n of e)isNaN(n)&&DS(t);return tE[t]=e,++UD,e}function su(t){return Array.isArray(t)?t:xz(t)}function wz(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let r=t[2];r!=(r|0)&&(r=r+.5|0);const i=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+r+","+i+")"}class pae extends yA{constructor(e,n,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=n,this.state=typeof i=="function"?Vt.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(An.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==Vt.IDLE&&this.loader){this.state=Vt.LOADING,this.changed();const e=this.getResolution(),n=Array.isArray(e)?e[0]:e;Coe(()=>this.loader(this.getExtent(),n,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||uae&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=Vt.LOADED}).catch(r=>{this.state=Vt.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function JTe(t,e,n){const r=t;let i=!0,s=!1,o=!1;const a=[JC(r,An.LOAD,function(){o=!0,s||e()})];return r.src&&vz?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(o?e():n())})):a.push(JC(r,An.ERROR,n)),function(){i=!1,a.forEach(Jr)}}function QTe(t,e){return new Promise((n,r)=>{function i(){o(),n(t)}function s(){o(),r(new Error("Image load error"))}function o(){t.removeEventListener("load",i),t.removeEventListener("error",s)}t.addEventListener("load",i),t.addEventListener("error",s)})}function mae(t,e){return e&&(t.src=e),t.src&&vz?new Promise((n,r)=>t.decode().then(()=>n(t)).catch(i=>t.complete&&t.width?n(t):r(i))):QTe(t)}function gae(t,e){return e&&(t.src=e),t.src&&vz&&uae?t.decode().then(()=>createImageBitmap(t)).catch(n=>{if(t.complete&&t.width)return t;throw n}):mae(t)}class eke{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const r=this.cache_[n];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,r){const i=qD(e,n,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,n,r){const i=qD(e,n,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,n,r,i,s){const o=qD(e,n,r),a=o in this.cache_;this.cache_[o]=i,s&&(i.getImageState()===Vt.IDLE&&i.load(),i.getImageState()===Vt.LOADING?i.ready().then(()=>{this.patternCache_[o]=a3().createPattern(i.getImage(1),"repeat")}):this.patternCache_[o]=a3().createPattern(i.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function qD(t,e,n){const r=n?su(n):"null";return e+":"+t+":"+r}const qc=new eke;let nE=null;class yae extends yA{constructor(e,n,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?Vt.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Vt.LOADED){nE||(nE=Ts(1,1,void 0,{willReadFrequently:!0})),nE.drawImage(this.image_,0,0);try{nE.getImageData(0,0,1,1),this.tainted_=!1}catch{nE=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(An.CHANGE)}handleImageError_(){this.imageState_=Vt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Vt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],r=Ts(e,n);r.fillRect(0,0,e,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Vt.IDLE){this.image_||this.initializeImage_(),this.imageState_=Vt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&mae(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==Vt.LOADED)return;const n=this.image_,r=Ts(Math.ceil(n.width*e),Math.ceil(n.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(n,0,0),r.globalCompositeOperation="multiply",r.fillStyle=KTe(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(n,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===Vt.LOADED||this.imageState_===Vt.ERROR)e();else{const n=()=>{(this.imageState_===Vt.LOADED||this.imageState_===Vt.ERROR)&&(this.removeEventListener(An.CHANGE,n),e())};this.addEventListener(An.CHANGE,n)}})),this.ready_}}function l3(t,e,n,r,i,s){let o=e===void 0?void 0:qc.get(e,n,i);return o||(o=new yae(t,t&&"src"in t?t.src||void 0:e,n,r,i),qc.set(e,n,i,o,s)),s&&o&&!qc.getPattern(e,n,i)&&qc.set(e,n,i,o,s),o}function rd(t){return t?Array.isArray(t)?wz(t):typeof t=="object"&&"src"in t?tke(t):t:null}function tke(t){if(!t.offset||!t.size)return qc.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=qc.getPattern(e,void 0,t.color);if(n)return n;const r=qc.get(t.src,"anonymous",null);if(r.getImageState()!==Vt.LOADED)return null;const i=Ts(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),l3(i.canvas,e,void 0,Vt.LOADED,t.color,!0),qc.getPattern(e,void 0,t.color)}class vae{drawCustom(e,n,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,r){}drawFeature(e,n,r){}drawGeometryCollection(e,n,r){}drawLineString(e,n,r){}drawMultiLineString(e,n,r){}drawMultiPoint(e,n,r){}drawMultiPolygon(e,n,r){}drawPoint(e,n,r){}drawPolygon(e,n,r){}drawText(e,n,r){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const HR="ol-hidden",EA="ol-unselectable",bz="ol-control",CY="ol-collapsed",nke=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),NY=["style","variant","weight","size","lineHeight","family"],ej={normal:400,bold:700},tj=function(t){const e=t.match(nke);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=NY.length;r<i;++r){const s=e[r+1];s!==void 0&&(n[NY[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(n.weight))&&n.weight in ej&&(n.weight=ej[n.weight]),n.families=n.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),n},_ae="10px sans-serif",cl="#000",$w="round",Hf=[],qf=0,jw="round",KT=10,YT="#000",XT="center",c3="middle",by=[0,0,0,0],ZT=1,A_=new Cd;let rE=null,OY;const nj={},rke=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function ike(t,e,n){return`${t} ${e} 16px "${n}"`}const ske=(function(){let e,n;async function r(s){await n.ready;const o=await n.load(s);if(o.length===0)return!1;const a=tj(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(u=>{const h=u.family.replace(/^['"]|['"]$/g,"").toLowerCase(),f=ej[u.weight]||u.weight;return h===l&&u.style===a.style&&f==c})}async function i(){await n.ready;let s=!0;const o=A_.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let u=o[c];u<100&&(await r(c)?(M2(nj),A_.set(c,100)):(u+=10,A_.set(c,u,!0),u<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){n||(n=tc?self.fonts:document.fonts);const o=tj(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(rke.has(c))continue;const u=ike(o.style,o.weight,c);A_.get(u)===void 0&&(A_.set(u,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}})(),oke=(function(){let t;return function(e){let n=nj[e];if(n==null){if(tc){const r=tj(e),i=xae(e,"g");n=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);nj[e]=n}return n}})();function xae(t,e){return rE||(rE=Ts(1,1)),t!=OY&&(rE.font=t,OY=rE.font),rE.measureText(e)}function wae(t,e){return xae(t,e).width}function LY(t,e,n){if(e in n)return n[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,wae(t,s)),0);return n[e]=r,r}function ake(t,e){const n=[],r=[],i=[];let s=0,o=0,a=0,l=0;for(let c=0,u=e.length;c<=u;c+=2){const h=e[c];if(h===`
`||c===u){s=Math.max(s,o),i.push(o),o=0,a+=l,l=0;continue}const f=e[c+1]||t.font,g=wae(f,h);n.push(g),o+=g;const v=oke(f);r.push(v),l=Math.max(l,v)}return{width:s,height:a,widths:n,heights:r,lineWidths:i}}function lke(t,e,n,r,i,s,o,a,l,c,u){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=h=>h.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(l,c),t.scale(u[0],u[1]),cke(r,t)):u[0]<0||u[1]<0?(t.translate(l,c),t.scale(u[0],u[1]),t.drawImage(r,i,s,o,a,0,0,o,a)):t.drawImage(r,i,s,o,a,l,c,o*u[0],a*u[1]),t.restore()}function cke(t,e){const n=t.contextInstructions;for(let r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}class uke extends vae{constructor(e,n,r,i,s,o,a){super(),this.context_=e,this.pixelRatio_=n,this.extent_=r,this.transform_=i,this.transformRotation_=i?xA(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=js()}drawImages_(e,n,r,i){if(!this.image_)return;const s=ad(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,h=s.length;u<h;u+=2){const f=s[u]-this.imageAnchorX_,g=s[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=f+this.imageAnchorX_,x=g+this.imageAnchorY_;iu(a,v,x,1,1,c,-v,-x),o.save(),o.transform.apply(o,a),o.translate(v,x),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,g,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,n,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=ad(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);n<r;n+=i){const l=s[n]+this.textOffsetX_,c=s[n+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,n,r,i,s){const o=this.context_,a=ad(e,n,r,i,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),r}drawRings_(e,n,r,i){for(let s=0,o=r.length;s<o;++s)n=this.moveToLineTo_(e,n,r[s],i,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=kTe(e,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],i=n[3]-n[1],s=Math.sqrt(r*r+i*i),o=this.context_;o.beginPath(),o.arc(n[0],n[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const r=n.getGeometryFunction()(e);r&&(this.setStyle(n),this.drawGeometry(r))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let r=0,i=n.length;r<i;++r)this.drawGeometry(n[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(Ia(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();r.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(i,s,o[l],a,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Ia(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),o=e.getStride();n.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];i=this.drawRings_(r,i,c,o)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,n.lineCap=e.lineCap),pp(r.lineDash,e.lineDash)||n.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:XT;r?(r.font!=e.font&&(r.font=e.font,n.font=e.font),r.textAlign!=i&&(r.textAlign=i,n.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=i,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:rd(r||cl)}}if(!n)this.strokeState_=null;else{const r=n.getColor(),i=n.getLineCap(),s=n.getLineDash(),o=n.getLineDashOffset(),a=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit(),u=s||Hf;this.strokeState_={lineCap:i!==void 0?i:$w,lineDash:this.pixelRatio_===1?u:u.map(h=>h*this.pixelRatio_),lineDashOffset:(o||qf)*this.pixelRatio_,lineJoin:a!==void 0?a:jw,lineWidth:(l!==void 0?l:ZT)*this.pixelRatio_,miterLimit:c!==void 0?c:KT,strokeStyle:rd(r||YT)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=n[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/r,o[1]*this.pixelRatio_/r],this.imageWidth_=n[0]*r}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const g=n.getColor();this.textFillState_={fillStyle:rd(g||cl)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const g=r.getColor(),v=r.getLineCap(),x=r.getLineDash(),b=r.getLineDashOffset(),T=r.getLineJoin(),A=r.getWidth(),I=r.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:$w,lineDash:x||Hf,lineDashOffset:b||qf,lineJoin:T!==void 0?T:jw,lineWidth:A!==void 0?A:ZT,miterLimit:I!==void 0?I:KT,strokeStyle:rd(g||YT)}}const i=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),u=e.getText(),h=e.getTextAlign(),f=e.getTextBaseline();this.textState_={font:i!==void 0?i:_ae,textAlign:h!==void 0?h:XT,textBaseline:f!==void 0?f:c3},this.text_=u!==void 0?Array.isArray(u)?u.reduce((g,v,x)=>g+=x%2?" ":v,""):u:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const hke=.5,bae={Point:_ke,LineString:gke,Polygon:wke,MultiPoint:xke,MultiLineString:yke,MultiPolygon:vke,GeometryCollection:mke,Circle:fke};function dke(t,e){return parseInt(_n(t),10)-parseInt(_n(e),10)}function DY(t,e){const n=Eae(t,e);return n*n}function Eae(t,e){return hke*t/e}function fke(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}}function $Y(t,e,n,r,i,s,o,a){const l=[],c=n.getImage();if(c){let f=!0;const g=c.getImageState();g==Vt.LOADED||g==Vt.ERROR?f=!1:g==Vt.IDLE&&c.load(),f&&l.push(c.ready())}const u=n.getFill();u&&u.loading()&&l.push(u.ready());const h=l.length>0;return h&&Promise.all(l).then(()=>i(null)),pke(t,e,n,r,s,o,a),h}function pke(t,e,n,r,i,s,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(r,i);if(n.getRenderer())Sae(t,l,n,e,o);else{const u=bae[l.getType()];u(t,l,n,e,o,s)}}function Sae(t,e,n,r,i){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)Sae(t,o[a],n,r,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i)}function mke(t,e,n,r,i,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=bae[o[a].getType()];c(t,o[a],n,r,i,s)}}function gke(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function yke(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function vke(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(o||s){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}function _ke(t,e,n,r,i,s){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=Vt.LOADED)return;const u=t.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,c),u.drawPoint(e,r,i)}if(l){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(e,r,i)}}function xke(t,e,n,r,i,s){const o=n.getImage(),a=o&&o.getOpacity()!==0,l=n.getText(),c=l&&l.getText(),u=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=Vt.LOADED)return;const h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(o,u),h.drawMultiPoint(e,r,i)}if(c){const h=t.getBuilder(n.getZIndex(),"Text");h.setTextStyle(l,u),h.drawText(e,r,i)}}function wke(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}let bke=!1;function Eke(t,e,n,r,i,s,o){const a=new XMLHttpRequest;a.open("GET",typeof t=="function"?t(n,r,i):t,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=bke,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let u;c=="text"||c=="json"?u=a.responseText:c=="xml"?u=a.responseXML||a.responseText:c=="arraybuffer"&&(u=a.response),u?s(e.readFeatures(u,{extent:n,featureProjection:i}),e.readProjection(u)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function jY(t,e){return function(n,r,i,s,o){Eke(t,e,n,r,i,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function Ske(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Tae(t,e,n,r){const i=[];let s=wl();for(let o=0,a=n.length;o<a;++o){const l=n[o];s=iz(t,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function Ez(t,e,n,r,i,s,o){let a,l,c,u,h,f,g;const v=i[s+1],x=[];for(let A=0,I=n.length;A<I;++A){const R=n[A];for(u=t[R-r],f=t[R-r+1],a=e;a<R;a+=r)h=t[a],g=t[a+1],(v<=f&&g<=v||f<=v&&v<=g)&&(c=(v-f)/(g-f)*(h-u)+u,x.push(c)),u=h,f=g}let b=NaN,T=-1/0;for(x.sort(Uf),u=x[0],a=1,l=x.length;a<l;++a){h=x[a];const A=Math.abs(h-u);A>T&&(c=(u+h)/2,mz(t,e,n,r,c,v)&&(b=c,T=A)),u=h}return isNaN(b)&&(b=i[s]),o?(o.push(b,v,T),o):[b,v,T]}function kae(t,e,n,r,i){let s=[];for(let o=0,a=n.length;o<a;++o){const l=n[o];s=Ez(t,e,l,r,i,2*o,s),e=l[l.length-1]}return s}function Tke(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const s=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=s}e+=r,n-=r}}function Sz(t,e,n,r){let i=0,s=t[n-r],o=t[n-r+1];for(;e<n;e+=r){const a=t[e],l=t[e+1];i+=(a-s)*(l+o),s=a,o=l}return i===0?void 0:i>0}function Tz(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=Sz(t,e,a,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=a}return!0}function Aae(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!Tz(t,e,a,r,i))return!1;a.length&&(e=a[a.length-1])}return!0}function u3(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=Sz(t,e,a,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&Tke(t,e,a,r),e=a}return e}function rj(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s)e=u3(t,e,n[s],r,i);return e}function Iae(t,e){const n=[];let r=0,i=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=Sz(t,r,l,2);if(s===void 0&&(s=c),c===s)n.push(e.slice(i,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[i])}i=o+1,r=l}return n}class eh extends nae{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Jr),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)this.changeEventsKeys_.push(Hn(e[n],An.CHANGE,this.changed,this))}clone(){const e=new eh(KD(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<H1(this.getExtent(),e,n))return i;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)i=s[o].closestPointXY(e,n,r,i);return i}containsXY(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,n))return!0;return!1}computeExtent(e){_A(e);const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)Doe(e,n[r].getExtent());return e}getGeometries(){return KD(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].getType()===this.getType()?e=e.concat(n[r].getGeometriesArrayRecursive()):e.push(n[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=[],r=this.geometries_;let i=!1;for(let s=0,o=r.length;s<o;++s){const a=r[s],l=a.getSimplifiedGeometry(e);n.push(l),l!==a&&(i=!0)}return i?new eh(n):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)if(n[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,n);this.changed()}scale(e,n,r){r||(r=oh(this.getExtent()));const i=this.geometries_;for(let s=0,o=i.length;s<o;++s)i[s].scale(e,n,r);this.changed()}setGeometries(e){this.setGeometriesArray(KD(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].applyTransform(e);this.changed()}translate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,n);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function KD(t){return t.map(e=>e.clone())}function Rae(t,e,n,r){let i=0;const s=t[n-r],o=t[n-r+1];let a=0,l=0;for(;e<n;e+=r){const c=t[e]-s,u=t[e+1]-o;i+=l*c-a*u,a=c,l=u}return i/2}function Pae(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=Rae(t,e,a,r),e=a}return i}function kke(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=Pae(t,e,a,r),e=a[a.length-1]}return i}class JT extends K1{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new JT(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fz(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,r,i))}getArea(){return Rae(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=QN(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new JT(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ZN(this.flatCoordinates,0,e,this.stride),this.changed()}}class np extends K1{constructor(e,n,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,n);else if(n!==void 0&&r)this.setFlatCoordinates(n,e),this.ends_=r;else{const i=e,s=[],o=[];for(let l=0,c=i.length;l<c;++l){const u=i[l];Rr(s,u.getFlatCoordinates()),o.push(s.length)}const a=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){Rr(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new np(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(dz(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pz(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,n,r,i))}getCoordinateAtM(e,n,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(n=n!==void 0?n:!1,r=r!==void 0?r:!1,PTe(this.flatCoordinates,0,this.ends_,this.stride,e,n,r))}getCoordinates(){return qT(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new ro(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,n=this.ends_,r=this.layout,i=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=new ro(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let n=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=gz(this.flatCoordinates,n,e[i],this.stride),n=e[i];return r}getFlatMidpoints(){const e=[],n=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=o3(n,r,l,s,.5);Rr(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=aae(this.flatCoordinates,0,this.ends_,this.stride,e,n,0,r),new np(n,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return NTe(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=bA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class X1 extends K1{constructor(e,n){super(),n&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendPoint(e){Rr(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new X1(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<H1(this.getExtent(),e,n))return i;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=zy(e,n,s[a],s[a+1]);if(c<i){i=c;for(let u=0;u<o;++u)r[u]=s[a+u];r.length=o}}return i}getCoordinates(){return Gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const n=this.flatCoordinates.length/this.stride;return e<0||n<=e?null:new Vs(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,n=this.layout,r=this.stride,i=[];for(let s=0,o=e.length;s<o;s+=r){const a=new Vs(e.slice(s,s+r),n);i.push(a)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const n=this.flatCoordinates,r=this.stride;for(let i=0,s=n.length;i<s;i+=r){const o=n[i],a=n[i+1];if(rz(e,o,a))return!0}return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ZN(this.flatCoordinates,0,e,this.stride),this.changed()}}class ou extends K1{constructor(e,n,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&r?(this.setFlatCoordinates(n,e),this.ends_=r):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?Rr(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new ou(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(dz(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pz(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return mz(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return Pae(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),u3(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,qT(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=oh(this.getExtent());this.flatInteriorPoint_=Ez(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Vs(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new JT(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=new JT(n.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Tz(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=u3(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=yz(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,r),new ou(n,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return oae(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=bA(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function FY(t){if(C2(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],s=[e,n,e,i,r,i,r,n,e,n];return new ou(s,"XY",[s.length])}class p1 extends K1{constructor(e,n,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],o=[];for(let a=0,l=i.length;a<l;++a){const c=i[a],u=s.length,h=c.getEnds();for(let f=0,g=h.length;f<g;++f)h[f]+=u;Rr(s,c.getFlatCoordinates()),o.push(h)}n=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=o}n!==void 0&&r?(this.setFlatCoordinates(n,e),this.endss_=r):this.setCoordinates(e,n)}appendPolygon(e){let n;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),n=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;Rr(this.flatCoordinates,e.getFlatCoordinates()),n=e.getEnds().slice();for(let i=0,s=n.length;i<s;++i)n[i]+=r}this.endss_.push(n),this.changed()}clone(){const e=this.endss_.length,n=new Array(e);for(let i=0;i<e;++i)n[i]=this.endss_[i].slice();const r=new p1(this.flatCoordinates.slice(),this.layout,n);return r.applyProperties(this),r}closestPointXY(e,n,r,i){return i<H1(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ATe(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ITe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return CTe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,n)}getArea(){return kke(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),rj(n,0,this.endss_,this.stride,e)):n=this.flatCoordinates,J8(n,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=Tae(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=kae(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new X1(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Aae(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=rj(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=DTe(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),n,0,r),new p1(n,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let n;if(e===0)n=0;else{const s=this.endss_[e-1];n=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(n!==0)for(let s=0,o=r.length;s<o;++s)r[s]-=n;return new ou(this.flatCoordinates.slice(n,i),this.layout,r)}getPolygons(){const e=this.layout,n=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o].slice(),c=l[l.length-1];if(s!==0)for(let h=0,f=l.length;h<f;++h)l[h]-=s;const u=new ou(n.slice(s,c),e,l);i.push(u),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return OTe(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=rae(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const VY=js();class ul{constructor(e,n,r,i,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Loe(this.flatCoordinates_):iz(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=oh(this.getExtent());this.flatInteriorPoints_=Ez(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=Iae(this.flatCoordinates_,this.ends_),n=Tae(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=kae(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=o3(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const o=r[i],a=o3(e,n,o,2,.5);Rr(this.flatMidpoints_,a),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Yr(e);const n=e.getExtent(),r=e.getWorldExtent();if(n&&r){const i=cs(r)/cs(n);iu(VY,r[0],r[3],i,-i,0,0,0),ad(this.flatCoordinates_,0,this.flatCoordinates_.length,2,VY,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new ul(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Moe((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=QN(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=aae(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=yz(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new ul(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}ul.prototype.getFlatCoordinates=ul.prototype.getOrientedFlatCoordinates;function Mae(t,e,n=0,r=t.length-1,i=Ake){for(;r>n;){if(r-n>600){const l=r-n+1,c=e-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),g=Math.max(n,Math.floor(e-c*h/l+f)),v=Math.min(r,Math.floor(e+(l-c)*h/l+f));Mae(t,e,g,v,i)}const s=t[e];let o=n,a=r;for(iE(t,n,e),i(t[r],s)>0&&iE(t,n,r);o<a;){for(iE(t,o,a),o++,a--;i(t[o],s)<0;)o++;for(;i(t[a],s)>0;)a--}i(t[n],s)===0?iE(t,n,a):(a++,iE(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function iE(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Ake(t,e){return t<e?-1:t>e?1:0}let Cae=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!KR(e,n))return r;const i=this.toBBox,s=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?i(a):a;KR(e,l)&&(n.leaf?r.push(a):XD(e,l)?this._all(a,r):s.push(a))}n=s.pop()}return r}collides(e){let n=this.data;if(!KR(e,n))return!1;const r=[];for(;n;){for(let i=0;i<n.children.length;i++){const s=n.children[i],o=n.leaf?this.toBBox(s):s;if(KR(e,o)){if(n.leaf||XD(e,o))return!0;r.push(s)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=I_([]),this}remove(e,n){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],o=[];let a,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),r.leaf){const u=Ike(e,r.children,n);if(u!==-1)return r.children.splice(u,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&XD(r,i)?(s.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,i){const s=r-n+1;let o=this._maxEntries,a;if(s<=o)return a=I_(e.slice(n,r+1)),Kv(a,this.toBBox),a;i||(i=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,i-1))),a=I_([]),a.leaf=!1,a.height=i;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));zY(e,n,r,c,this.compareMinX);for(let u=n;u<=r;u+=c){const h=Math.min(u+c-1,r);zY(e,u,h,l,this.compareMinY);for(let f=u;f<=h;f+=l){const g=Math.min(f+l-1,h);a.children.push(this._build(e,f,g,i-1))}}return Kv(a,this.toBBox),a}_chooseSubtree(e,n,r,i){for(;i.push(n),!(n.leaf||i.length-1===r);){let s=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],u=YD(c),h=Mke(e,c)-u;h<o?(o=h,s=u<s?u:s,a=c):h===o&&u<s&&(s=u,a=c)}n=a||n.children[0]}return n}_insert(e,n,r){const i=r?e:this.toBBox(e),s=[],o=this._chooseSubtree(i,this.data,n,s);for(o.children.push(e),VE(o,i);n>=0&&s[n].children.length>this._maxEntries;)this._split(s,n),n--;this._adjustParentBBoxes(i,s,n)}_split(e,n){const r=e[n],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const o=this._chooseSplitIndex(r,s,i),a=I_(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Kv(r,this.toBBox),Kv(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,n){this.data=I_([e,n]),this.data.height=e.height+1,this.data.leaf=!1,Kv(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let i,s=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=FE(e,0,a,this.toBBox),c=FE(e,a,r,this.toBBox),u=Cke(l,c),h=YD(l)+YD(c);u<s?(s=u,i=a,o=h<o?h:o):u===s&&h<o&&(o=h,i=a)}return i||r-n}_chooseSplitAxis(e,n,r){const i=e.leaf?this.compareMinX:Rke,s=e.leaf?this.compareMinY:Pke,o=this._allDistMargin(e,n,r,i),a=this._allDistMargin(e,n,r,s);o<a&&e.children.sort(i)}_allDistMargin(e,n,r,i){e.children.sort(i);const s=this.toBBox,o=FE(e,0,n,s),a=FE(e,r-n,r,s);let l=qR(o)+qR(a);for(let c=n;c<r-n;c++){const u=e.children[c];VE(o,e.leaf?s(u):u),l+=qR(o)}for(let c=r-n-1;c>=n;c--){const u=e.children[c];VE(a,e.leaf?s(u):u),l+=qR(a)}return l}_adjustParentBBoxes(e,n,r){for(let i=r;i>=0;i--)VE(n[i],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():Kv(e[n],this.toBBox)}};function Ike(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function Kv(t,e){FE(t,0,t.children.length,e,t)}function FE(t,e,n,r,i){i||(i=I_(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<n;s++){const o=t.children[s];VE(i,t.leaf?r(o):o)}return i}function VE(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Rke(t,e){return t.minX-e.minX}function Pke(t,e){return t.minY-e.minY}function YD(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function qR(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Mke(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Cke(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function XD(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function KR(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function I_(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function zY(t,e,n,r,i){const s=[e,n];for(;s.length;){if(n=s.pop(),e=s.pop(),n-e<=r)continue;const o=e+Math.ceil((n-e)/r/2)*r;Mae(t,o,e,n,i),s.push(e,o,o,n)}}class UY{constructor(e){this.rbush_=new Cae(e),this.items_={}}insert(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[_n(n)]=r}load(e,n){const r=new Array(n.length);for(let i=0,s=n.length;i<s;i++){const o=e[i],a=n[i],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};r[i]=l,this.items_[_n(a)]=l}this.rbush_.load(r)}remove(e){const n=_n(e),r=this.items_[n];return delete this.items_[n],this.rbush_.remove(r)!==null}update(e,n){const r=this.items_[_n(n)],i=[r.minX,r.minY,r.maxX,r.maxY];h1(i,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let r;for(let i=0,s=e.length;i<s;i++)if(r=n(e[i]),r)return r;return r}isEmpty(){return c1(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return Eg(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class kz extends Cd{constructor(e){super(),this.projection=Yr(e.projection),this.attributions_=GY(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(r,i){n.viewResolver=r,n.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=GY(e),this.changed()}setState(e){this.state_=e,this.changed()}}function GY(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const Xo={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Hp extends Md{constructor(e,n,r){super(e),this.feature=n,this.features=r}}class Nd extends kz{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=BT,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(or(this.format_,"`format` must be set when `url` is set"),this.loader_=jY(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:Ske;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new UY:null,this.loadedExtentsRtree_=new UY,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!n&&r===void 0&&(r=new Hc(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=_n(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new Hp(Xo.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof ul||(this.featureChangeKeys_[e]=[Hn(n,An.CHANGE,this.handleFeatureChange_,this),Hn(n,Ow.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let r=!0;if(n.getId()!==void 0){const i=String(n.getId());if(!(i in this.idIndex_))this.idIndex_[i]=n;else if(n instanceof ul){const s=this.idIndex_[i];s instanceof ul?Array.isArray(s)?s.push(n):this.idIndex_[i]=[s,n]:r=!1}else r=!1}return r&&(or(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],r=[],i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=_n(a);this.addToIndex_(l,a)&&r.push(a)}for(let s=0,o=r.length;s<o;s++){const a=r[s],l=_n(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const u=c.getExtent();n.push(u),i.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(Xo.ADDFEATURE))for(let s=0,o=r.length;s<o;s++)this.dispatchEvent(new Hp(Xo.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(Xo.ADDFEATURE,function(r){n||(n=!0,e.push(r.feature),n=!1)}),this.addEventListener(Xo.REMOVEFEATURE,function(r){n||(n=!0,e.remove(r.feature),n=!1)}),e.addEventListener(ll.ADD,r=>{n||(n=!0,this.addFeature(r.element),n=!1)}),e.addEventListener(ll.REMOVE,r=>{n||(n=!0,this.removeFeature(r.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(Jr);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new Hp(Xo.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof ul||s.intersectsCoordinate(e))return n(i)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof ul||i.intersectsExtent(e)){const s=n(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),c1(this.nullGeometryFeatures_)||Rr(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){n.push(r)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=zoe(e,n);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const r=e[0],i=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return n=n||GT,this.featuresRtree_.forEachInExtent(l,function(c){if(n(c)){const u=c.getGeometry(),h=a;if(a=u instanceof ul?0:u.closestPointXY(r,i,o,a),a<h){s=c;const f=Math.sqrt(a);l[0]=r-f,l[1]=i-f,l[2]=r+f,l[3]=i+f}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,r=_n(n),i=n.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{const o=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const s=n.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new Hp(Xo.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:_n(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&c1(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,n,r);for(let o=0,a=s.length;o<a;++o){const l=s[o];i.forEachInExtent(l,function(u){return zm(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Hp(Xo.FEATURESLOADSTART)),this.loader_.call(this,l,n,r,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new Hp(Xo.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Hp(Xo.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,r=n.forEachInExtent(e,function(i){if(h1(i.extent,e))return i});r&&n.remove(r)}removeFeatures(e){let n=!1;for(let r=0,i=e.length;r<i;++r)n=this.removeFeatureInternal(e[r])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=_n(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[n]?.forEach(Jr),delete this.featureChangeKeys_[n];const i=e.getId();if(i!==void 0){const s=i.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[n],this.hasListener(Xo.REMOVEFEATURE)&&this.dispatchEvent(new Hp(Xo.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){or(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(jY(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class Nr{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Nr({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=l3(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===Vt.IDLE&&n.load(),n.getImageState()===Vt.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?_n(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:su(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Sr{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Sr({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}function BY(t){return t[0]>0&&t[1]>0}function Nke(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function Ma(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}class t5{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ma(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new t5({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return xn()}getImage(e){return xn()}getHitDetectionImage(){return xn()}getPixelRatio(e){return 1}getImageState(){return xn()}getImageSize(){return xn()}getOrigin(){return xn()}getSize(){return xn()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ma(e)}listenImageChange(e){xn()}load(){xn()}unlistenImageChange(e){xn()}ready(){return Promise.resolve()}}class n5 extends t5{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?Vt.LOADING:Vt.LOADED,this.imageState_===Vt.LOADING&&this.ready().then(()=>this.imageState_=Vt.LOADED),this.render()}clone(){const e=this.getScale(),n=new n5({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-n[0]/r[0],e[1]/2+n[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const n=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let i=qc.get(r,null,null)?.getImage(1);if(!i){const s=this.renderOptions_,o=Math.ceil(s.size*e),a=Ts(o,o);this.draw_(s,a,e),i=a.canvas,qc.set(r,null,null,new yae(i,void 0,null,Vt.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,r){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const V=i;i=s,s=V}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),u=i-c,h=Math.sqrt(l*l+u*u),f=h/l;if(e==="miter"&&f<=r)return f*n;const g=n/2/f,v=n/2*(u/h),b=Math.sqrt((i+g)*(i+g)+v*v)-i;if(this.radius2_===void 0||e==="bevel")return b*2;const T=i*Math.sin(a),A=Math.sqrt(i*i-T*T),I=s-A,C=Math.sqrt(T*T+I*I)/T;if(C<=r){const V=C*n/2-s-i;return 2*Math.max(b,V)}return b*2}createRenderOptions(){let e=$w,n=jw,r=0,i=null,s=0,o,a=0;this.stroke_&&(o=rd(this.stroke_.getColor()??YT),a=this.stroke_.getWidth()??ZT,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??jw,e=this.stroke_.getLineCap()??$w,r=this.stroke_.getMiterLimit()??KT);const l=this.calculateLineJoinSize_(n,a,r),c=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:u,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,r){if(n.scale(r,r),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let i=this.fill_.getColor();i===null&&(i=cl),n.fillStyle=rd(i),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=su(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(n=Ts(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const r=this.radius;if(n===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let a=0;a<n;a++){const l=s+a*o,c=a%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=cl,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class $a extends n5{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new $a({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class zn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=WY,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new zn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=WY,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function Oke(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(or(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let ZD=null;function Nae(t,e){if(!ZD){const n=new Nr({color:"rgba(255,255,255,0.4)"}),r=new Sr({color:"#3399CC",width:1.25});ZD=[new zn({image:new $a({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return ZD}function WY(t){return t.getGeometry()}const Lke="#333";class th{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Ma(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Nr({color:Lke}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new th({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Nr?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ma(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const ws={ANIMATING:0,INTERACTING:1},an={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},YR=[an.FILL],Wm=[an.STROKE],Ey=[an.BEGIN_PATH],HY=[an.CLOSE_PATH];class SA extends vae{constructor(e,n,r,i){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(r){return r*n})}appendFlatPointCoordinates(e,n){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=n)i[0]=e[a],i[1]=e[a+1],u1(r,i)&&(s[o++]=i[0],s[o++]=i[1]);return o}appendFlatLineCoordinates(e,n,r,i,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(n+=i);let u=e[n],h=e[n+1];const f=this.tmpCoordinate_;let g=!0,v,x,b;for(v=n+i;v<r;v+=i)f[0]=e[v],f[1]=e[v+1],b=G8(c,f),b!==x?(g&&(a[l++]=u,a[l++]=h,g=!1),a[l++]=f[0],a[l++]=f[1]):b===Qs.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],g=!1):g=!0,u=f[0],h=f[1],x=b;return(s&&g||v===n+i)&&(a[l++]=u,a[l++]=h),l}drawCustomCoordinates_(e,n,r,i,s){for(let o=0,a=r.length;o<a;++o){const l=r[o],c=this.appendFlatLineCoordinates(e,n,l,i,!1,!1);s.push(c),n=l}return n}drawCustom(e,n,r,i,s){this.beginGeometry(e,n,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,u,h,f,g;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),f=[];const v=e.getEndss();g=0;for(let x=0,b=v.length;x<b;++x){const T=[];g=this.drawCustomCoordinates_(c,g,v[x],a,T),f.push(T)}this.instructions.push([an.CUSTOM,l,f,e,r,J8,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,f,e,i||r,J8,s]);break;case"Polygon":case"MultiLineString":h=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),g=this.drawCustomCoordinates_(c,0,e.getEnds(),a,h),this.instructions.push([an.CUSTOM,l,h,e,r,qT,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,h,e,i||r,qT,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([an.CUSTOM,l,u,e,r,Gm,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,u,e,i||r,Gm,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(c,a),u>l&&(this.instructions.push([an.CUSTOM,l,u,e,r,Gm,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,u,e,i||r,Gm,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),u=this.coordinates.length,this.instructions.push([an.CUSTOM,l,u,e,r,void 0,s]),this.hitDetectionInstructions.push([an.CUSTOM,l,u,e,i||r,void 0,s]);break}this.endGeometry(n)}beginGeometry(e,n,r){this.beginGeometryInstruction1_=[an.BEGIN_GEOMETRY,n,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[an.BEGIN_GEOMETRY,n,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const r=e.length;let i,s,o=-1;for(n=0;n<r;++n)i=e[n],s=i[0],s==an.END_GEOMETRY?o=n:s==an.BEGIN_GEOMETRY&&(i[2]=n,RSe(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const r=e.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=rd(r||cl)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const r=e.getColor();n.strokeStyle=rd(r||YT);const i=e.getLineCap();n.lineCap=i!==void 0?i:$w;const s=e.getLineDash();n.lineDash=s?s.slice():Hf;const o=e.getLineDashOffset();n.lineDashOffset=o||qf;const a=e.getLineJoin();n.lineJoin=a!==void 0?a:jw;const l=e.getWidth();n.lineWidth=l!==void 0?l:ZT;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:KT,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(n,r)}createFill(e){const n=e.fillStyle,r=[an.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[an.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,n){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!pp(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(n.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[an.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ooe(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Gf(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Dke extends SA{constructor(e,n,r,i){super(e,n,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,r){if(!this.image_||this.maxExtent&&!u1(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(i,s);this.instructions.push([an.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([an.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,r){if(!this.image_)return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||u1(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([an.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([an.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class $ke extends SA{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinates_(e,n,r,i){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,n,r,i,!1,!1),a=[an.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),r}drawLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf],Ey);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Wm),this.endGeometry(n)}drawMultiLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf],Ey);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let u=0;for(let h=0,f=a.length;h<f;++h)u=this.drawFlatCoordinates_(l,u,a[h],c);this.hitDetectionInstructions.push(Wm),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Wm),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Wm),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Ey)}}class qY extends SA{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinatess_(e,n,r,i){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Ey),this.hitDetectionInstructions.push(Ey);for(let c=0;c<l;++c){const u=r[c],h=this.coordinates.length,f=this.appendFlatLineCoordinates(e,n,u,i,!0,!a),g=[an.MOVE_TO_LINE_TO,h,f];this.instructions.push(g),this.hitDetectionInstructions.push(g),a&&(this.instructions.push(HY),this.hitDetectionInstructions.push(HY)),n=u}return o&&(this.instructions.push(YR),this.hitDetectionInstructions.push(YR)),a&&(this.instructions.push(Wm),this.hitDetectionInstructions.push(Wm)),n}drawCircle(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,cl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const u=[an.CIRCLE,c];this.instructions.push(Ey,u),this.hitDetectionInstructions.push(Ey,u),i.fillStyle!==void 0&&(this.instructions.push(YR),this.hitDetectionInstructions.push(YR)),i.strokeStyle!==void 0&&(this.instructions.push(Wm),this.hitDetectionInstructions.push(Wm)),this.endGeometry(n)}drawPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,cl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(n)}drawMultiPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_FILL_STYLE,cl]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([an.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Hf,qf]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let u=0;for(let h=0,f=a.length;h<f;++h)u=this.drawFlatCoordinatess_(l,u,a[h],c);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let r=0,i=n.length;r<i;++r)n[r]=$0(n[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function jke(t,e,n,r,i){const s=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+i<r;){const[c,u]=l.slice(-2),h=e[o+i],f=e[o+i+1],g=Math.sqrt((h-c)*(h-c)+(f-u)*(f-u));if(a+=g,a>=t){const v=(t-a+g)/g,x=Yl(c,h,v),b=Yl(u,f,v);l.push(x,b),s.push(l),l=[x,b],a==t&&(o+=i),a=0}else if(a<t)l.push(e[o+i],e[o+i+1]),o+=i;else{const v=g-a,x=Yl(c,h,v/g),b=Yl(u,f,v/g);l.push(x,b),s.push(l),l=[x,b],a=0,o+=i}}return a>0&&s.push(l),s}function Fke(t,e,n,r,i){let s=n,o=n,a=0,l=0,c=n,u,h,f,g,v,x,b,T,A,I;for(h=n;h<r;h+=i){const R=e[h],C=e[h+1];v!==void 0&&(A=R-v,I=C-x,g=Math.sqrt(A*A+I*I),b!==void 0&&(l+=f,u=Math.acos((b*A+T*I)/(f*g)),u>t&&(l>a&&(a=l,s=c,o=h),l=0,c=h-i)),f=g,b=A,T=I),v=R,x=C}return l+=g,l>a?[c,h]:[s,o]}const h3={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Vke extends SA{constructor(e,n,r,i){super(e,n,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[cl]={fillStyle:cl},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,r){const i=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!i&&!s)return;const a=this.coordinates;let l=a.length;const c=e.getType();let u=null,h=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Ia(this.maxExtent,e.getExtent()))return;let f;if(u=e.getFlatCoordinates(),c=="LineString")f=[u.length];else if(c=="MultiLineString")f=e.getEnds();else if(c=="Polygon")f=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const b=e.getEndss();f=[];for(let T=0,A=b.length;T<A;++T)f.push(b[T][0])}this.beginGeometry(e,n,r);const g=o.repeat,v=g?void 0:o.textAlign;let x=0;for(let b=0,T=f.length;b<T;++b){let A;g?A=jke(g*this.resolution,u,x,f[b],h):A=[u.slice(x,f[b])];for(let I=0,R=A.length;I<R;++I){const C=A[I];let V=0,M=C.length;if(v==null){const O=Fke(o.maxAngle,C,0,C.length,2);V=O[0],M=O[1]}for(let O=V;O<M;O+=h)a.push(C[O],C[O+1]);const N=a.length;x=f[b],this.drawChars_(l,N),l=N}}this.endGeometry(n)}else{let f=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),h=2;break;case"Polygon":u=e.getFlatInteriorPoint(),o.overflow||f.push(u[2]/this.resolution),h=3;break;case"MultiPolygon":const R=e.getFlatInteriorPoints();u=[];for(let C=0,V=R.length;C<V;C+=3)o.overflow||f.push(R[C+2]/this.resolution),u.push(R[C],R[C+1]);if(u.length===0)return;h=2;break}const g=this.appendFlatPointCoordinates(u,h);if(g===l)return;if(f&&(g-l)/2!==u.length/h){let R=l/2;f=f.filter((C,V)=>{const M=a[(R+V)*2]===u[V*h]&&a[(R+V)*2+1]===u[V*h+1];return M||--R,M})}this.saveTextStates_();const v=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,x=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,r);let b=o.padding;if(b!=by&&(o.scale[0]<0||o.scale[1]<0)){let R=o.padding[0],C=o.padding[1],V=o.padding[2],M=o.padding[3];o.scale[0]<0&&(C=-C,M=-M),o.scale[1]<0&&(R=-R,V=-V),b=[R,C,V,M]}const T=this.pixelRatio;this.instructions.push([an.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,b==by?by:b.map(function(R){return R*T}),v,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const A=1/T,I=v?v.slice(0):null;I&&(I[1]=cl),this.hitDetectionInstructions.push([an.DRAW_IMAGE,l,g,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[A,A],NaN,this.declutterMode_,this.declutterImageWithText_,b,I,x,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?cl:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:n.font,textAlign:n.textAlign||XT,justify:n.justify,textBaseline:n.textBaseline||c3,scale:n.scale});const o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))}drawChars_(e,n){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=h3[i.textBaseline],u=this.textOffsetY_*l,h=this.text_,f=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([an.DRAW_CHARS,e,n,c,i.overflow,a,i.maxAngle,l,u,s,f*l,h,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([an.DRAW_CHARS,e,n,c,i.overflow,a&&cl,i.maxAngle,l,u,s,f*l,h,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let r,i,s;if(!e)this.text_="";else{const o=e.getFill();o?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=rd(o.getColor()||cl)):(i=null,this.textFillState_=i);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const x=a.getLineDash(),b=a.getLineDashOffset(),T=a.getWidth(),A=a.getMiterLimit();s.lineCap=a.getLineCap()||$w,s.lineDash=x?x.slice():Hf,s.lineDashOffset=b===void 0?qf:b,s.lineJoin=a.getLineJoin()||jw,s.lineWidth=T===void 0?ZT:T,s.miterLimit=A===void 0?KT:A,s.strokeStyle=rd(a.getColor()||YT)}r=this.textState_;const l=e.getFont()||_ae;ske(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||c3,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||by,r.scale=c===void 0?[1,1]:c;const u=e.getOffsetX(),h=e.getOffsetY(),f=e.getRotateWithView(),g=e.getKeepUpright(),v=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=h===void 0?0:h,this.textRotateWithView_=f===void 0?!1:f,this.textKeepUpright_=g===void 0?!0:g,this.textRotation_=v===void 0?0:v,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:_n(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+_n(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const zke={Circle:qY,Default:SA,Image:Dke,LineString:$ke,Polygon:qY,Text:Vke};class Uke{constructor(e,n,r,i){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const r=this.buildersByZIndex_[n];for(const i in r){const s=r[i].finish();e[n][i]=s}}return e}getBuilder(e,n){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[n];if(s===void 0){const o=zke[n];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[n]=s}return s}}function Gke(t,e,n,r,i,s,o,a,l,c,u,h,f=!0){let g=t[e],v=t[e+1],x=0,b=0,T=0,A=0;function I(){x=g,b=v,e+=r,g=t[e],v=t[e+1],A+=T,T=Math.sqrt((g-x)*(g-x)+(v-b)*(v-b))}do I();while(e<n-r&&A+T<s);let R=T===0?0:(s-A)/T;const C=Yl(x,g,R),V=Yl(b,v,R),M=e-r,N=A,O=s+a*l(c,i,u);for(;e<n-r&&A+T<O;)I();R=T===0?0:(O-A)/T;const F=Yl(x,g,R),L=Yl(b,v,R);let B=!1;if(f)if(h){const Le=[C,V,F,L];tae(Le,0,4,2,h,Le,Le),B=Le[0]>Le[2]}else B=C>F;const U=Math.PI,de=[],me=M+r===e;e=M,T=0,A=N,g=t[e],v=t[e+1];let ze;if(me){I(),ze=Math.atan2(v-b,g-x),B&&(ze+=ze>0?-U:U);const Le=(F+C)/2,fe=(L+V)/2;return de[0]=[Le,fe,(O-s)/2,ze,i],de}i=i.replace(/\n/g," ");for(let Le=0,fe=i.length;Le<fe;){I();let $e=Math.atan2(v-b,g-x);if(B&&($e+=$e>0?-U:U),ze!==void 0){let ae=$e-ze;if(ae+=ae>U?-2*U:ae<-U?2*U:0,Math.abs(ae)>o)return null}ze=$e;const Ce=Le;let le=0;for(;Le<fe;++Le){const ae=B?fe-Le-1:Le,_e=a*l(c,i[ae],u);if(e+r<n&&A+T<s+le+_e/2)break;le+=_e}if(Le===Ce)continue;const W=B?i.substring(fe-Ce,fe-Le):i.substring(Ce,Le);R=T===0?0:(s+le/2-A)/T;const ne=Yl(x,g,R),se=Yl(b,v,R);de.push([ne,se,le/2,$e,W]),s+=le}return de}class Oae{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(a3(),{get:(e,n)=>{if(typeof a3()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,r)=>(this.push_(n,r),!0)})}push_(...e){const n=this.instructions_,r=this.zIndex+this.offset_;n[r]||(n[r]=[]),n[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let r=0,i=n.length;r<i;++r){const s=n[r];if(typeof s=="function"){s(e);continue}const o=n[++r];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Yv=wl(),qp=[],Zd=[],Jd=[],Kp=[];function KY(t){return t[3].declutterBox}const YY=new RegExp("[-----]");function JD(t,e){return e==="start"?e=YY.test(t)?"right":"left":e==="end"&&(e=YY.test(t)?"left":"right"),h3[e]}function Bke(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function Wke(t,e,n){return n%2===0&&(t+=e),t}class Hke{constructor(e,n,r,i,s){this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=js(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Oae:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,r,i){const s=e+n+r+i;if(this.labels_[s])return this.labels_[s];const o=i?this.strokeStates[i]:null,a=r?this.fillStates[r]:null,l=this.textStates[n],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],h=l.justify?h3[l.justify]:JD(Array.isArray(e)?e[0]:e,l.textAlign||XT),f=i&&o.lineWidth?o.lineWidth:0,g=Array.isArray(e)?e:String(e).split(`
`).reduce(Bke,[]),{width:v,height:x,widths:b,heights:T,lineWidths:A}=ake(l,g),I=v+f,R=[],C=(I+2)*u[0],V=(x+f)*u[1],M={width:C<0?Math.floor(C):Math.ceil(C),height:V<0?Math.floor(V):Math.ceil(V),contextInstructions:R};(u[0]!=1||u[1]!=1)&&R.push("scale",u),i&&(R.push("strokeStyle",o.strokeStyle),R.push("lineWidth",f),R.push("lineCap",o.lineCap),R.push("lineJoin",o.lineJoin),R.push("miterLimit",o.miterLimit),R.push("setLineDash",[o.lineDash]),R.push("lineDashOffset",o.lineDashOffset)),r&&R.push("fillStyle",a.fillStyle),R.push("textBaseline","middle"),R.push("textAlign","center");const N=.5-h;let O=h*I+N*f;const F=[],L=[];let B=0,U=0,de=0,me=0,ze;for(let Le=0,fe=g.length;Le<fe;Le+=2){const $e=g[Le];if($e===`
`){U+=B,B=0,O=h*I+N*f,++me;continue}const Ce=g[Le+1]||l.font;Ce!==ze&&(i&&F.push("font",Ce),r&&L.push("font",Ce),ze=Ce),B=Math.max(B,T[de]);const le=[$e,O+N*b[de]+h*(b[de]-A[me]),.5*(f+B)+U];O+=b[de],i&&F.push("strokeText",le),r&&L.push("fillText",le),++de}return Array.prototype.push.apply(R,F),Array.prototype.push.apply(R,L),this.labels_[s]=M,M}replayTextBackground_(e,n,r,i,s,o,a){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,n,r,i,s,o,a,l,c,u,h,f,g,v,x,b){a*=f[0],l*=f[1];let T=r-a,A=i-l;const I=s+c>e?e-c:s,R=o+u>n?n-u:o,C=v[3]+I*f[0]+v[1],V=v[0]+R*f[1]+v[2],M=T-v[3],N=A-v[0];(x||h!==0)&&(qp[0]=M,Kp[0]=M,qp[1]=N,Zd[1]=N,Zd[0]=M+C,Jd[0]=Zd[0],Jd[1]=N+V,Kp[1]=Jd[1]);let O;return h!==0?(O=iu(js(),r,i,1,1,h,-r,-i),Ki(O,qp),Ki(O,Zd),Ki(O,Jd),Ki(O,Kp),Eg(Math.min(qp[0],Zd[0],Jd[0],Kp[0]),Math.min(qp[1],Zd[1],Jd[1],Kp[1]),Math.max(qp[0],Zd[0],Jd[0],Kp[0]),Math.max(qp[1],Zd[1],Jd[1],Kp[1]),Yv)):Eg(Math.min(M,M+C),Math.min(N,N+V),Math.max(M,M+C),Math.max(N,N+V),Yv),g&&(T=Math.round(T),A=Math.round(A)),{drawImageX:T,drawImageY:A,drawImageW:I,drawImageH:R,originX:c,originY:u,declutterBox:{minX:Yv[0],minY:Yv[1],maxX:Yv[2],maxY:Yv[3],value:b},canvasTransform:O,scale:f}}replayImageOrLabel_(e,n,r,i,s,o,a){const l=!!(o||a),c=i.declutterBox,u=a?a[2]*i.scale[0]/2:0;return c.minX-u<=n[0]&&c.maxX+u>=0&&c.minY-u<=n[1]&&c.maxY+u>=0&&(l&&this.replayTextBackground_(e,qp,Zd,Jd,Kp,o,a),lke(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const r=Ki(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,r,i){const s=this.textStates[n],o=this.createLabel(e,n,i,r),a=this.strokeStates[r],l=this.pixelRatio,c=JD(Array.isArray(e)?e[0]:e,s.textAlign||XT),u=h3[s.textBaseline||c3],h=a&&a.lineWidth?a.lineWidth:0,f=o.width/l-2*s.scale[0],g=c*f+2*(.5-c)*h,v=u*o.height/l+2*(.5-u)*h;return{label:o,anchorX:g,anchorY:v}}execute_(e,n,r,i,s,o,a,l){const c=this.zIndexContext_;let u;this.pixelCoordinates_&&pp(r,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=ad(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),eae(this.renderedTransform_,r));let h=0;const f=i.length;let g=0,v,x,b,T,A,I,R,C,V,M,N,O,F,L=0,B=0;const U=this.coordinateCache_,de=this.viewRotation_,me=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,ze={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:de},Le=this.instructions!=i||this.overlaps?0:200;let fe,$e,Ce,le;for(;h<f;){const W=i[h];switch(W[0]){case an.BEGIN_GEOMETRY:fe=W[1],le=W[3],fe.getGeometry()?a!==void 0&&!Ia(a,le.getExtent())?h=W[2]+1:++h:h=W[2],c&&(c.zIndex=W[4]);break;case an.BEGIN_PATH:L>Le&&(this.fill_(e),L=0),B>Le&&(e.stroke(),B=0),!L&&!B&&(e.beginPath(),A=NaN,I=NaN),++h;break;case an.CIRCLE:g=W[1];const se=u[g],ae=u[g+1],_e=u[g+2],Ke=u[g+3],Ye=_e-se,ke=Ke-ae,Te=Math.sqrt(Ye*Ye+ke*ke);e.moveTo(se+Te,ae),e.arc(se,ae,Te,0,2*Math.PI,!0),++h;break;case an.CLOSE_PATH:e.closePath(),++h;break;case an.CUSTOM:g=W[1],v=W[2];const Dt=W[3],qe=W[4],sn=W[5];ze.geometry=Dt,ze.feature=fe,h in U||(U[h]=[]);const $t=U[h];sn?sn(u,g,v,2,$t):($t[0]=u[g],$t[1]=u[g+1],$t.length=2),c&&(c.zIndex=W[6]),qe($t,ze),++h;break;case an.DRAW_IMAGE:g=W[1],v=W[2],V=W[3],x=W[4],b=W[5];let fn=W[6];const yn=W[7],dt=W[8],lr=W[9],$n=W[10];let Un=W[11];const Xr=W[12];let fo=W[13];T=W[14]||"declutter";const kr=W[15];if(!V&&W.length>=20){M=W[19],N=W[20],O=W[21],F=W[22];const Ve=this.drawLabelWithPointPlacement_(M,N,O,F);V=Ve.label,W[3]=V;const Q=W[23];x=(Ve.anchorX-Q)*this.pixelRatio,W[4]=x;const ye=W[24];b=(Ve.anchorY-ye)*this.pixelRatio,W[5]=b,fn=V.height,W[6]=fn,fo=V.width,W[13]=fo}let Si;W.length>25&&(Si=W[25]);let Rs,Mt,Yn;W.length>17?(Rs=W[16],Mt=W[17],Yn=W[18]):(Rs=by,Mt=null,Yn=null),$n&&me?Un+=de:!$n&&!me&&(Un-=de);let cr=0;for(;g<v;g+=2){if(Si&&Si[cr++]<fo/this.pixelRatio)continue;const Ve=this.calculateImageOrLabelDimensions_(V.width,V.height,u[g],u[g+1],fo,fn,x,b,dt,lr,Un,Xr,s,Rs,!!Mt||!!Yn,fe),Q=[e,n,V,Ve,yn,Mt,Yn];if(l){let ye,De,Je;if(kr){const et=v-g;if(!kr[et]){kr[et]={args:Q,declutterMode:T};continue}const Pt=kr[et];ye=Pt.args,De=Pt.declutterMode,delete kr[et],Je=KY(ye)}let Ue,nt;if(ye&&(De!=="declutter"||!l.collides(Je))&&(Ue=!0),(T!=="declutter"||!l.collides(Ve.declutterBox))&&(nt=!0),De==="declutter"&&T==="declutter"){const et=Ue&&nt;Ue=et,nt=et}Ue&&(De!=="none"&&l.insert(Je),this.replayImageOrLabel_.apply(this,ye)),nt&&(T!=="none"&&l.insert(Ve.declutterBox),this.replayImageOrLabel_.apply(this,Q))}else this.replayImageOrLabel_.apply(this,Q)}++h;break;case an.DRAW_CHARS:const Ft=W[1],On=W[2],Qt=W[3],Oo=W[4];F=W[5];const ji=W[6],Ps=W[7],Pn=W[8];O=W[9];const Ti=W[10];M=W[11],Array.isArray(M)&&(M=M.reduce(Wke,"")),N=W[12];const He=[W[13],W[13]];T=W[14]||"declutter";const Ae=W[15],Ie=this.textStates[N],rn=Ie.font,z=[Ie.scale[0]*Ps,Ie.scale[1]*Ps];let bt;rn in this.widths_?bt=this.widths_[rn]:(bt={},this.widths_[rn]=bt);const Y=gz(u,Ft,On,2),oe=Math.abs(z[0])*LY(rn,M,bt);if(Oo||oe<=Y){const Ve=this.textStates[N].textAlign,Q=(Y-oe)*JD(M,Ve),ye=Gke(u,Ft,On,2,M,Q,ji,Math.abs(z[0]),LY,rn,bt,me?0:this.viewRotation_,Ae);e:if(ye){const De=[];let Je,Ue,nt,et,Pt;if(O)for(Je=0,Ue=ye.length;Je<Ue;++Je){Pt=ye[Je],nt=Pt[4],et=this.createLabel(nt,N,"",O),x=Pt[2]+(z[0]<0?-Ti:Ti),b=Qt*et.height+(.5-Qt)*2*Ti*z[1]/z[0]-Pn;const zt=this.calculateImageOrLabelDimensions_(et.width,et.height,Pt[0],Pt[1],et.width,et.height,x,b,0,0,Pt[3],He,!1,by,!1,fe);if(l&&T==="declutter"&&l.collides(zt.declutterBox))break e;De.push([e,n,et,zt,1,null,null])}if(F)for(Je=0,Ue=ye.length;Je<Ue;++Je){Pt=ye[Je],nt=Pt[4],et=this.createLabel(nt,N,F,""),x=Pt[2],b=Qt*et.height-Pn;const zt=this.calculateImageOrLabelDimensions_(et.width,et.height,Pt[0],Pt[1],et.width,et.height,x,b,0,0,Pt[3],He,!1,by,!1,fe);if(l&&T==="declutter"&&l.collides(zt.declutterBox))break e;De.push([e,n,et,zt,1,null,null])}l&&T!=="none"&&l.load(De.map(KY));for(let zt=0,gn=De.length;zt<gn;++zt)this.replayImageOrLabel_.apply(this,De[zt])}}++h;break;case an.END_GEOMETRY:if(o!==void 0){fe=W[1];const Ve=o(fe,le,T);if(Ve)return Ve}++h;break;case an.FILL:Le?L++:this.fill_(e),++h;break;case an.MOVE_TO_LINE_TO:for(g=W[1],v=W[2],$e=u[g],Ce=u[g+1],e.moveTo($e,Ce),A=$e+.5|0,I=Ce+.5|0,g+=2;g<v;g+=2)$e=u[g],Ce=u[g+1],R=$e+.5|0,C=Ce+.5|0,(g==v-2||R!==A||C!==I)&&(e.lineTo($e,Ce),A=R,I=C);++h;break;case an.SET_FILL_STYLE:this.alignAndScaleFill_=W[2],L&&(this.fill_(e),L=0,B&&(e.stroke(),B=0)),e.fillStyle=W[1],++h;break;case an.SET_STROKE_STYLE:B&&(e.stroke(),B=0),this.setStrokeStyle_(e,W),++h;break;case an.STROKE:Le?B++:e.stroke(),++h;break;default:++h;break}}L&&this.fill_(e),B&&e.stroke()}execute(e,n,r,i,s,o){this.viewRotation_=i,this.execute_(e,n,r,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,n,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,i,s)}}const uy=["Polygon","Circle","LineString","Image","Text","Default"],Lae=["Image","Text"],qke=uy.filter(t=>!Lae.includes(t));class Kke{constructor(e,n,r,i,s,o,a){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=js(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,n){const r=this.getClipCoords(n);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,n){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const o in s){const a=s[o];i[o]=new Hke(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const r=this.executorsByZIndex_[n];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,n,r,i,s,o){i=Math.round(i);const a=i*2+1,l=iu(this.hitDetectionTransform_,i+.5,i+.5,1/n,-1/n,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Ts(a,a));const u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let h;this.renderBuffer_!==void 0&&(h=wl(),LS(h,e),Gf(h,n*(this.renderBuffer_+i),h));const f=Yke(i);let g;function v(C,V,M){const N=u.getImageData(0,0,a,a).data;for(let O=0,F=f.length;O<F;O++)if(N[f[O]]>0){if(!o||M==="none"||g!=="Image"&&g!=="Text"||o.includes(C)){const L=(f[O]-3)/4,B=i-L%a,U=i-(L/a|0),de=s(C,V,B*B+U*U);if(de)return de}u.clearRect(0,0,a,a);break}}const x=Object.keys(this.executorsByZIndex_).map(Number);x.sort(Uf);let b,T,A,I,R;for(b=x.length-1;b>=0;--b){const C=x[b].toString();for(A=this.executorsByZIndex_[C],T=uy.length-1;T>=0;--T)if(g=uy[T],I=A[g],I!==void 0&&(R=I.executeHitDetection(u,l,r,v,h),R))return R}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const r=n[0],i=n[1],s=n[2],o=n[3],a=[r,i,r,o,s,o,s,i];return ad(a,0,8,2,e,a),a}isEmpty(){return c1(this.executorsByZIndex_)}execute(e,n,r,i,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?ISe:Uf),o=o||uy;const c=uy.length;for(let u=0,h=l.length;u<h;++u){const f=l[u].toString(),g=this.executorsByZIndex_[f];for(let v=0,x=o.length;v<x;++v){const b=o[v],T=g[b];if(T!==void 0){const A=a===null?void 0:T.getZIndexContext(),I=A?A.getContext():e,R=this.maxExtent_&&b!=="Image"&&b!=="Text";if(R&&(I.save(),this.clip(I,r)),!A||b==="Text"||b==="Image"?T.execute(I,n,r,i,s,a):A.pushFunction(C=>T.execute(C,n,r,i,s,a)),R&&I.restore(),A){A.offset();const C=l[u]*c+uy.indexOf(b);this.deferredZIndexContexts_[C]||(this.deferredZIndexContexts_[C]=[]),this.deferredZIndexContexts_[C].push(A)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(Uf);for(let r=0,i=n.length;r<i;++r)e[n[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[n[r]].length=0}}const QD={};function Yke(t){if(QD[t]!==void 0)return QD[t];const e=t*2+1,n=t*t,r=new Array(n+1);for(let s=0;s<=t;++s)for(let o=0;o<=t;++o){const a=s*s+o*o;if(a>n)break;let l=r[a];l||(l=[],r[a]=l),l.push(((t+s)*e+(t+o))*4+3),s>0&&l.push(((t-s)*e+(t+o))*4+3),o>0&&(l.push(((t+s)*e+(t-o))*4+3),s>0&&l.push(((t-s)*e+(t-o))*4+3))}const i=[];for(let s=0,o=r.length;s<o;++s)r[s]&&i.push(...r[s]);return QD[t]=i,i}function XY(t,e,n,r){return n!==void 0&&r!==void 0?[n/t,r/e]:n!==void 0?n/t:r!==void 0?r/e:1}let TA=class Dae extends t5{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;or(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||_n(o)),or(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),or(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=Vt.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?Vt.LOADED:Vt.IDLE:l=Vt.LOADING:l=Vt.LOADED),this.color_=e.color!==void 0?su(e.color):null,this.iconImage_=l3(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,u;if(e.size)[c,u]=e.size;else{const h=this.getImage(1);if(h.width&&h.height)c=h.width,u=h.height;else if(h instanceof HTMLImageElement){this.initialOptions_=e;const f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;const g=this.iconImage_.getSize();this.setScale(XY(g[0],g[1],e.width,e.height))};this.listenImageChange(f);return}}c!==void 0&&this.setScale(XY(c,u,e.width,e.height))}}clone(){let e,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Dae({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),r=this.getScaleArray();return[e[0]-n[0]/r[0],e[1]+n[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=l3(null,e,this.crossOrigin_,Vt.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==Vt.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==Vt.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(An.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(An.CHANGE,e)}ready(){return this.iconImage_.ready()}};const Jh=.5;function Xke(t,e,n,r,i,s,o,a,l){const c=i,u=t[0]*Jh,h=t[1]*Jh,f=Ts(u,h);f.imageSmoothingEnabled=!1;const g=f.canvas,v=new uke(f,Jh,i,null,o,a,null),x=n.length,b=Math.floor((256*256*256-1)/x),T={};for(let I=1;I<=x;++I){const R=n[I-1],C=R.getStyleFunction()||r;if(!C)continue;let V=C(R,s);if(!V)continue;Array.isArray(V)||(V=[V]);const N=(I*b).toString(16).padStart(7,"#00000");for(let O=0,F=V.length;O<F;++O){const L=V[O],B=L.getGeometryFunction()(R);if(!B||!Ia(c,B.getExtent()))continue;const U=L.clone(),de=U.getFill();de&&de.setColor(N);const me=U.getStroke();me&&(me.setColor(N),me.setLineDash(null)),U.setText(void 0);const ze=L.getImage();if(ze){const Ce=ze.getImageSize();if(!Ce)continue;const le=Ts(Ce[0],Ce[1],void 0,{alpha:!1}),W=le.canvas;le.fillStyle=N,le.fillRect(0,0,W.width,W.height),U.setImage(new TA({img:W,anchor:ze.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ze.getOrigin(),opacity:1,size:ze.getSize(),scale:ze.getScale(),rotation:ze.getRotation(),rotateWithView:ze.getRotateWithView()}))}const Le=U.getZIndex()||0;let fe=T[Le];fe||(fe={},T[Le]=fe,fe.Polygon=[],fe.Circle=[],fe.LineString=[],fe.Point=[]);const $e=B.getType();if($e==="GeometryCollection"){const Ce=B.getGeometriesArrayRecursive();for(let le=0,W=Ce.length;le<W;++le){const ne=Ce[le];fe[ne.getType().replace("Multi","")].push(ne,U)}}else fe[$e.replace("Multi","")].push(B,U)}}const A=Object.keys(T).map(Number).sort(Uf);for(let I=0,R=A.length;I<R;++I){const C=T[A[I]];for(const V in C){const M=C[V];for(let N=0,O=M.length;N<O;N+=2){v.setStyle(M[N+1]);for(let F=0,L=e.length;F<L;++F)v.setTransform(e[F]),v.drawGeometry(M[N])}}}return f.getImageData(0,0,g.width,g.height)}function Zke(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*Jh),s=Math.floor(Math.round(t[1])*Jh),o=(ii(i,0,n.width-1)+ii(s,0,n.height-1)*n.width)*4,a=n.data[o],l=n.data[o+1],u=n.data[o+2]+256*(l+256*a),h=Math.floor((256*256*256-1)/e.length);u&&u%h===0&&r.push(e[u/h-1])}return r}class $S extends Md{constructor(e,n,r,i){super(e),this.inversePixelTransform=n,this.frameState=r,this.context=i}}const Jke=5;class $ae extends vA{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=Jke}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return xn()}getData(e){return null}prepareFrame(e){return xn()}renderFrame(e,n){return xn()}forEachFeatureAtCoordinate(e,n,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===Vt.LOADED||n.getState()===Vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=Vt.LOADED&&n!=Vt.ERROR&&e.addEventListener(An.CHANGE,this.boundHandleImageChange_),n==Vt.IDLE&&(e.load(),n=e.getState()),n==Vt.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const ZY=[];let R_=null;function Qke(){R_=Ts(1,1,void 0,{willReadFrequently:!0})}class Az extends $ae{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=js(),this.pixelTransform=js(),this.inversePixelTransform=js(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,r){R_||Qke(),R_.clearRect(0,0,1,1);let i;try{R_.drawImage(e,n,r,1,1,0,0,1,1),i=R_.getImageData(0,0,1,1).data}catch{return R_=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,n,r){const i=this.getLayer().getClassName();let s,o;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&pp(su(e.style.backgroundColor),su(r)))){const a=e.firstElementChild;Bm(a)&&(o=a.getContext("2d"))}if(o&&bTe(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=tc?dae():document.createElement("div"),s.className=i;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Ts();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,n,r){const i=q1(r),s=qN(r),o=HN(r),a=WN(r);Ki(n.coordinateToPixelTransform,i),Ki(n.coordinateToPixelTransform,s),Ki(n.coordinateToPixelTransform,o),Ki(n.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Ki(l,i),Ki(l,s),Ki(l,o),Ki(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,n){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(Gn(r)/i*o),l=Math.round(cs(r)/i*o);iu(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),HT(this.inversePixelTransform,this.pixelTransform);const c=wTe(this.pixelTransform);if(this.useContainer(n,c,this.getBackground(e)),!this.containerReused){const u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),c!==u.style.transform&&(u.style.transform=c)}}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){const s=new $S(e,this.inversePixelTransform,r,n);i.dispatchEvent(s)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(no.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(no.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Oae),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(no.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(no.POSTRENDER,this.context,e))}getRenderTransform(e,n,r,i,s,o,a){const l=s/2,c=o/2,u=i/n,h=-u,f=-e[0]+a,g=-e[1];return iu(this.tempTransform,l,c,u,h,-r,f,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}}class eAe extends Az{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=wl(),this.wrappedRenderedExtent_=wl(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,r){const i=n.extent,s=n.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,u=l.getExtent(),h=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),g=n.pixelRatio,v=n.viewHints,x=!(v[ws.ANIMATING]||v[ws.INTERACTING]),b=this.context,T=Math.round(Gn(i)/a*g),A=Math.round(cs(i)/a*g),I=h.getWrapX()&&l.canWrapX(),R=I?Gn(u):null,C=I?Math.ceil((i[2]-u[2])/R)+1:1;let V=I?Math.floor((i[0]-u[0])/R):0;do{let M=this.getRenderTransform(o,a,0,g,T,A,V*R);n.declutter&&(M=M.slice(0)),e.execute(b,[b.canvas.width,b.canvas.height],M,c,x,r===void 0?uy:r?Lae:qke,r?f&&n.declutter[f]:void 0)}while(++V<C)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Ts(this.context.canvas.width,this.context.canvas.height,ZY))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,e5(this.context),ZY.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,n);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(no.PRERENDER)||this.getLayer().hasListener(no.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,a&&r.extent&&this.clipping){const l=nd(r.extent);a=Ia(l,e.extent),this.clipped_=a&&!zm(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],h=r[0]*Jh,f=r[1]*Jh;u.push(this.getRenderTransform(i,s,o,Jh,h,f,0).slice());const g=c.getSource(),v=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!zm(v,l)){let x=l[0];const b=Gn(v);let T=0,A;for(;x<v[0];)--T,A=b*T,u.push(this.getRenderTransform(i,s,o,Jh,h,f,A).slice()),x+=b;for(T=0,x=l[2];x>v[2];)++T,A=b*T,u.push(this.getRenderTransform(i,s,o,Jh,h,f,A).slice()),x-=b}this.hitDetectionImageData_=Xke(r,u,this.renderedFeatures_,c.getStyleFunction(),l,s,o,DY(s,this.renderedPixelRatio_))}n(Zke(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,r,i,s){if(!this.replayGroup_)return;const o=n.viewState.resolution,a=n.viewState.rotation,l=this.getLayer(),c={},u=function(f,g,v){const x=_n(f),b=c[x];if(b){if(b!==!0&&v<b.distanceSq){if(v===0)return c[x]=!0,s.splice(s.lastIndexOf(b),1),i(f,l,g);b.geometry=g,b.distanceSq=v}}else{if(v===0)return c[x]=!0,i(f,l,g);s.push(c[x]={feature:f,layer:l,geometry:g,distanceSq:v,callback:i})}},h=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,r,u,h?n.declutter?.[h]?.all().map(f=>f.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),r=n.getSource();if(!r)return!1;const i=e.viewHints[ws.ANIMATING],s=e.viewHints[ws.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&i||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,u=c.projection,h=c.resolution,f=e.pixelRatio,g=n.getRevision(),v=n.getRenderBuffer();let x=n.getRenderOrder();x===void 0&&(x=dke);const b=c.center.slice(),T=Gf(l,v*h),A=T.slice(),I=[T.slice()],R=u.getExtent();if(r.getWrapX()&&u.canWrapX()&&!zm(R,e.extent)){const de=Gn(R),me=Math.max(Gn(T)/2,de);T[0]=R[0]-me,T[2]=R[2]+me,Goe(b,u);const ze=Voe(I[0],u);ze[0]<R[0]&&ze[2]<R[2]?I.push([ze[0]+de,ze[1],ze[2]+de,ze[3]]):ze[0]>R[0]&&ze[2]>R[2]&&I.push([ze[0]-de,ze[1],ze[2]-de,ze[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==g&&this.renderedRenderOrder_==x&&this.renderedFrameDeclutter_===!!e.declutter&&zm(this.wrappedRenderedExtent_,T))return pp(this.renderedExtent_,A)||(this.hitDetectionImageData_=null,this.renderedExtent_=A),this.renderedCenter_=b,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const C=new Uke(Eae(h,f),T,h,f);let V;for(let de=0,me=I.length;de<me;++de)r.loadFeatures(I[de],h,u);const M=DY(h,f);let N=!0;const O=(de,me)=>{let ze;const Le=de.getStyleFunction()||n.getStyleFunction();if(Le&&(ze=Le(de,h)),ze){const fe=this.renderFeature(de,M,ze,C,V,this.getLayer().getDeclutter(),me);N=N&&!fe}},F=Joe(T),L=r.getFeaturesInExtent(F);x&&L.sort(x);for(let de=0,me=L.length;de<me;++de)O(L[de],de);this.renderedFeatures_=L,this.ready=N;const B=C.finish(),U=new Kke(T,h,f,r.getOverlaps(),B,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=h,this.renderedRevision_=g,this.renderedRenderOrder_=x,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=A,this.wrappedRenderedExtent_=T,this.renderedCenter_=b,this.renderedProjection_=u,this.renderedPixelRatio_=f,this.replayGroup_=U,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,r,i,s,o,a){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,u=r.length;c<u;++c)l=$Y(i,e,r[c],n,this.boundHandleStyleImageChange_,s,o,a)||l;else l=$Y(i,e,r,n,this.boundHandleStyleImageChange_,s,o,a);return l}}let Z1=0;const Es=1<<Z1++,Wt=1<<Z1++,$s=1<<Z1++,xi=1<<Z1++,bl=1<<Z1++,Kc=1<<Z1++,XR=Math.pow(2,Z1)-1,Iz={[Es]:"boolean",[Wt]:"number",[$s]:"string",[xi]:"color",[bl]:"number[]",[Kc]:"size"},tAe=Object.keys(Iz).map(Number).sort(Uf);function nAe(t){return t in Iz}function dx(t){const e=[];for(const n of tAe)zE(t,n)&&e.push(Iz[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function zE(t,e){return(t&e)===e}function Hh(t,e){return t===e}class Ls{constructor(e,n){if(!nAe(e))throw new Error(`literal expressions must have a specific type, got ${dx(e)}`);this.type=e,this.value=n}}class jae{constructor(e,n,...r){this.type=e,this.operator=n,this.args=r}}function Rz(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function oo(t,e,n){switch(typeof t){case"boolean":{if(Hh(e,$s))return new Ls($s,t?"true":"false");if(!zE(e,Es))throw new Error(`got a boolean, but expected ${dx(e)}`);return new Ls(Es,t)}case"number":{if(Hh(e,Kc))return new Ls(Kc,Ma(t));if(Hh(e,Es))return new Ls(Es,!!t);if(Hh(e,$s))return new Ls($s,t.toString());if(!zE(e,Wt))throw new Error(`got a number, but expected ${dx(e)}`);return new Ls(Wt,t)}case"string":{if(Hh(e,xi))return new Ls(xi,xz(t));if(Hh(e,Es))return new Ls(Es,!!t);if(!zE(e,$s))throw new Error(`got a string, but expected ${dx(e)}`);return new Ls($s,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return fAe(t,e,n);for(const r of t)if(typeof r!="number")throw new Error("expected an array of numbers");if(Hh(e,Kc)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new Ls(Kc,t)}if(Hh(e,xi)){if(t.length===3)return new Ls(xi,[...t,1]);if(t.length===4)return new Ls(xi,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!zE(e,bl))throw new Error(`got an array of numbers, but expected ${dx(e)}`);return new Ls(bl,t)}const Se={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},rAe={[Se.Get]:En(Ln(1,1/0),JY),[Se.Var]:En(Ln(1,1),iAe),[Se.Has]:En(Ln(1,1/0),JY),[Se.Id]:En(sAe,Xv),[Se.Concat]:En(Ln(2,1/0),vr($s)),[Se.GeometryType]:En(oAe,Xv),[Se.LineMetric]:En(Xv),[Se.Resolution]:En(e6,Xv),[Se.Zoom]:En(e6,Xv),[Se.Time]:En(e6,Xv),[Se.Any]:En(Ln(2,1/0),vr(Es)),[Se.All]:En(Ln(2,1/0),vr(Es)),[Se.Not]:En(Ln(1,1),vr(Es)),[Se.Equal]:En(Ln(2,2),vr(XR)),[Se.NotEqual]:En(Ln(2,2),vr(XR)),[Se.GreaterThan]:En(Ln(2,2),vr(Wt)),[Se.GreaterThanOrEqualTo]:En(Ln(2,2),vr(Wt)),[Se.LessThan]:En(Ln(2,2),vr(Wt)),[Se.LessThanOrEqualTo]:En(Ln(2,2),vr(Wt)),[Se.Multiply]:En(Ln(2,1/0),QY),[Se.Coalesce]:En(Ln(2,1/0),QY),[Se.Divide]:En(Ln(2,2),vr(Wt)),[Se.Add]:En(Ln(2,1/0),vr(Wt)),[Se.Subtract]:En(Ln(2,2),vr(Wt)),[Se.Clamp]:En(Ln(3,3),vr(Wt)),[Se.Mod]:En(Ln(2,2),vr(Wt)),[Se.Pow]:En(Ln(2,2),vr(Wt)),[Se.Abs]:En(Ln(1,1),vr(Wt)),[Se.Floor]:En(Ln(1,1),vr(Wt)),[Se.Ceil]:En(Ln(1,1),vr(Wt)),[Se.Round]:En(Ln(1,1),vr(Wt)),[Se.Sin]:En(Ln(1,1),vr(Wt)),[Se.Cos]:En(Ln(1,1),vr(Wt)),[Se.Atan]:En(Ln(1,2),vr(Wt)),[Se.Sqrt]:En(Ln(1,1),vr(Wt)),[Se.Match]:En(Ln(4,1/0),eX,lAe),[Se.Between]:En(Ln(3,3),vr(Wt)),[Se.Interpolate]:En(Ln(6,1/0),eX,cAe),[Se.Case]:En(Ln(3,1/0),aAe,uAe),[Se.In]:En(Ln(2,2),hAe),[Se.Number]:En(Ln(1,1/0),vr(XR)),[Se.String]:En(Ln(1,1/0),vr(XR)),[Se.Array]:En(Ln(1,1/0),vr(Wt)),[Se.Color]:En(Ln(1,4),vr(Wt)),[Se.Band]:En(Ln(1,3),vr(Wt)),[Se.Palette]:En(Ln(2,2),dAe),[Se.ToString]:En(Ln(1,1),vr(Es|Wt|$s|xi))};function JY(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=t[s+1];switch(typeof o){case"number":{i[s]=new Ls(Wt,o);break}case"string":{i[s]=new Ls($s,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&n.properties.add(String(o))}return i}function iAe(t,e,n){const r=t[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return n.variables.add(r),[new Ls($s,r)]}function sAe(t,e,n){n.featureId=!0}function oAe(t,e,n){n.geometryType=!0}function e6(t,e,n){n.mapState=!0}function Xv(t,e,n){const r=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function Ln(t,e){return function(n,r,i){const s=n[0],o=n.length-1;if(t===e){if(o!==t){const a=t===1?"":"s";throw new Error(`expected ${t} argument${a} for ${s}, got ${o}`)}}else if(o<t||o>e){const a=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function QY(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=oo(t[s+1],e,n);i[s]=o}return i}function vr(t){return function(e,n,r){const i=e.length-1,s=new Array(i);for(let o=0;o<i;++o){const a=oo(e[o+1],t,r);s[o]=a}return s}}function aAe(t,e,n){const r=t[0],i=t.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function eX(t,e,n){const r=t[0],i=t.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function lAe(t,e,n){const r=t.length-1,i=$s|Wt|Es,s=oo(t[1],i,n),o=oo(t[t.length-1],e,n),a=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=oo(t[l+2],s.type,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=oo(t[l+3],o.type,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function cAe(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new Ls(Wt,i);let o;try{o=oo(t[2],Wt,n)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){try{const c=oo(t[l+3],Wt,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=oo(t[l+4],e,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function uAe(t,e,n){const r=oo(t[t.length-1],e,n),i=new Array(t.length-1);for(let s=0;s<i.length-1;s+=2){try{const o=oo(t[s+1],Es,n);i[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=oo(t[s+2],r.type,n);i[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return i[i.length-1]=r,i}function hAe(t,e,n){let r=t[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=$s}else i=Wt;const s=new Array(r.length);for(let a=0;a<s.length;a++)try{const l=oo(r[a],i,n);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[oo(t[1],i,n),...s]}function dAe(t,e,n){let r;try{r=oo(t[1],Wt,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let o=0;o<s.length;o++){let a;try{a=oo(i[o],xi,n)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Ls))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[r,...s]}function En(...t){return function(e,n,r){const i=e[0];let s;for(let o=0;o<t.length;o++){const a=t[o](e,n,r);if(o==t.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new jae(n,i,...s)}}function fAe(t,e,n){const r=t[0],i=rAe[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}function Pz(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Pz(t.getGeometries()[0]);default:return""}}function Fae(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function mp(t,e,n){const r=oo(t,e,n);return ah(r)}function ah(t,e){if(t instanceof Ls){if(t.type===xi&&typeof t.value=="string"){const r=xz(t.value);return function(){return r}}return function(){return t.value}}const n=t.operator;switch(n){case Se.Number:case Se.String:case Se.Coalesce:return pAe(t);case Se.Get:case Se.Var:case Se.Has:return mAe(t);case Se.Id:return r=>r.featureId;case Se.GeometryType:return r=>r.geometryType;case Se.Concat:{const r=t.args.map(i=>ah(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Se.Resolution:return r=>r.resolution;case Se.Any:case Se.All:case Se.Between:case Se.In:case Se.Not:return yAe(t);case Se.Equal:case Se.NotEqual:case Se.LessThan:case Se.LessThanOrEqualTo:case Se.GreaterThan:case Se.GreaterThanOrEqualTo:return gAe(t);case Se.Multiply:case Se.Divide:case Se.Add:case Se.Subtract:case Se.Clamp:case Se.Mod:case Se.Pow:case Se.Abs:case Se.Floor:case Se.Ceil:case Se.Round:case Se.Sin:case Se.Cos:case Se.Atan:case Se.Sqrt:return vAe(t);case Se.Case:return _Ae(t);case Se.Match:return xAe(t);case Se.Interpolate:return wAe(t);case Se.ToString:return bAe(t);default:throw new Error(`Unsupported operator ${n}`)}}function pAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case Se.Coalesce:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case Se.Number:case Se.String:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a===n)return a}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function mAe(t,e){const r=t.args[0].value;switch(t.operator){case Se.Get:return i=>{const s=t.args;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;o=o[u]}return o};case Se.Var:return i=>i.variables[r];case Se.Has:return i=>{const s=t.args;if(!(r in i.properties))return!1;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;if(!o||!Object.hasOwn(o,u))return!1;o=o[u]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function gAe(t,e){const n=t.operator,r=ah(t.args[0]),i=ah(t.args[1]);switch(n){case Se.Equal:return s=>r(s)===i(s);case Se.NotEqual:return s=>r(s)!==i(s);case Se.LessThan:return s=>r(s)<i(s);case Se.LessThanOrEqualTo:return s=>r(s)<=i(s);case Se.GreaterThan:return s=>r(s)>i(s);case Se.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${n}`)}}function yAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case Se.Any:return s=>{for(let o=0;o<r;++o)if(i[o](s))return!0;return!1};case Se.All:return s=>{for(let o=0;o<r;++o)if(!i[o](s))return!1;return!0};case Se.Between:return s=>{const o=i[0](s),a=i[1](s),l=i[2](s);return o>=a&&o<=l};case Se.In:return s=>{const o=i[0](s);for(let a=1;a<r;++a)if(o===i[a](s))return!0;return!1};case Se.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${n}`)}}function vAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case Se.Multiply:return s=>{let o=1;for(let a=0;a<r;++a)o*=i[a](s);return o};case Se.Divide:return s=>i[0](s)/i[1](s);case Se.Add:return s=>{let o=0;for(let a=0;a<r;++a)o+=i[a](s);return o};case Se.Subtract:return s=>i[0](s)-i[1](s);case Se.Clamp:return s=>{const o=i[0](s),a=i[1](s);if(o<a)return a;const l=i[2](s);return o>l?l:o};case Se.Mod:return s=>i[0](s)%i[1](s);case Se.Pow:return s=>Math.pow(i[0](s),i[1](s));case Se.Abs:return s=>Math.abs(i[0](s));case Se.Floor:return s=>Math.floor(i[0](s));case Se.Ceil:return s=>Math.ceil(i[0](s));case Se.Round:return s=>Math.round(i[0](s));case Se.Sin:return s=>Math.sin(i[0](s));case Se.Cos:return s=>Math.cos(i[0](s));case Se.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Se.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${n}`)}}function _Ae(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ah(t.args[i]);return i=>{for(let s=0;s<n-1;s+=2)if(r[s](i))return r[s+1](i);return r[n-1](i)}}function xAe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ah(t.args[i]);return i=>{const s=r[0](i);for(let o=1;o<n-1;o+=2)if(s===r[o](i))return r[o+1](i);return r[n-1](i)}}function wAe(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ah(t.args[i]);return i=>{const s=r[0](i),o=r[1](i);let a,l;for(let c=2;c<n;c+=2){const u=r[c](i);let h=r[c+1](i);const f=Array.isArray(h);if(f&&(h=XTe(h)),u>=o)return c===2?h:f?EAe(s,o,a,l,u,h):UE(s,o,a,l,u,h);a=u,l=h}return l}}function bAe(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=ah(t.args[s]);switch(n){case Se.ToString:return s=>{const o=i[0](s);return t.args[0].type===xi?wz(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function UE(t,e,n,r,i,s){const o=i-n;if(o===0)return r;const a=e-n,l=t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1);return r+l*(s-r)}function EAe(t,e,n,r,i,s){if(i-n===0)return r;const a=MY(r),l=MY(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const u=[UE(t,e,n,a[0],i,l[0]),UE(t,e,n,a[1],i,l[1]),a[2]+UE(t,e,n,0,i,c),UE(t,e,n,r[3],i,s[3])];return ZTe(u)}function SAe(t){return!0}function TAe(t){const e=Rz(),n=kAe(t,e),r=Fae();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const o=i.getId();o!==void 0?r.featureId=o:r.featureId=null}return e.geometryType&&(r.geometryType=Pz(i.getGeometry())),n(r)}}function tX(t){const e=Rz(),n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=ij(t[o],e);const i=Fae(),s=new Array(n);return function(o,a){if(i.properties=o.getPropertiesInternal(),i.resolution=a,e.featureId){const c=o.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<n;++c){const u=r[c](i);u&&(s[l]=u,l+=1)}return s.length=l,s}}function kAe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const s=t[i],o="filter"in s?mp(s.filter,Es,e):SAe;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=ij(s.style[c],e)}else a=[ij(s.style,e)];r[i]={filter:o,styles:a}}return function(i){const s=[];let o=!1;for(let a=0;a<n;++a){const l=r[a].filter;if(l(i)&&!(t[a].else&&o)){o=!0;for(const c of r[a].styles){const u=c(i);u&&s.push(u)}}}return s}}function ij(t,e){const n=QT(t,"",e),r=ek(t,"",e),i=AAe(t,e),s=IAe(t,e),o=hl(t,"z-index",e);if(!n&&!r&&!i&&!s&&!c1(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new zn;return function(l){let c=!0;if(n){const u=n(l);u&&(c=!1),a.setFill(u)}if(r){const u=r(l);u&&(c=!1),a.setStroke(u)}if(i){const u=i(l);u&&(c=!1),a.setText(u)}if(s){const u=s(l);u&&(c=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),c?null:a}}function QT(t,e,n){let r;if(e+"fill-pattern-src"in t)r=CAe(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return s=>null;r=Mz(t,e+"fill-color",n)}if(!r)return null;const i=new Nr;return function(s){const o=r(s);return o===_z?null:(i.setColor(o),i)}}function ek(t,e,n){const r=hl(t,e+"stroke-width",n),i=Mz(t,e+"stroke-color",n);if(!r&&!i)return null;const s=If(t,e+"stroke-line-cap",n),o=If(t,e+"stroke-line-join",n),a=Vae(t,e+"stroke-line-dash",n),l=hl(t,e+"stroke-line-dash-offset",n),c=hl(t,e+"stroke-miter-limit",n),u=new Sr;return function(h){if(i){const f=i(h);if(f===_z)return null;u.setColor(f)}if(r&&u.setWidth(r(h)),s){const f=s(h);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(f)}if(o){const f=o(h);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(f)}return a&&u.setLineDash(a(h)),l&&u.setLineDashOffset(l(h)),c&&u.setMiterLimit(c(h)),u}}function AAe(t,e){const n="text-",r=If(t,n+"value",e);if(!r)return null;const i=QT(t,n,e),s=QT(t,n+"background-",e),o=ek(t,n,e),a=ek(t,n+"background-",e),l=If(t,n+"font",e),c=hl(t,n+"max-angle",e),u=hl(t,n+"offset-x",e),h=hl(t,n+"offset-y",e),f=Dx(t,n+"overflow",e),g=If(t,n+"placement",e),v=hl(t,n+"repeat",e),x=r5(t,n+"scale",e),b=Dx(t,n+"rotate-with-view",e),T=hl(t,n+"rotation",e),A=If(t,n+"align",e),I=If(t,n+"justify",e),R=If(t,n+"baseline",e),C=Dx(t,n+"keep-upright",e),V=Vae(t,n+"padding",e),M=i5(t,n+"declutter-mode"),N=new th({declutterMode:M});return function(O){if(N.setText(r(O)),i&&N.setFill(i(O)),s&&N.setBackgroundFill(s(O)),o&&N.setStroke(o(O)),a&&N.setBackgroundStroke(a(O)),l&&N.setFont(l(O)),c&&N.setMaxAngle(c(O)),u&&N.setOffsetX(u(O)),h&&N.setOffsetY(h(O)),f&&N.setOverflow(f(O)),g){const F=g(O);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");N.setPlacement(F)}if(v&&N.setRepeat(v(O)),x&&N.setScale(x(O)),b&&N.setRotateWithView(b(O)),T&&N.setRotation(T(O)),A){const F=A(O);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");N.setTextAlign(F)}if(I){const F=I(O);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");N.setJustify(F)}if(R){const F=R(O);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");N.setTextBaseline(F)}return V&&N.setPadding(V(O)),C&&N.setKeepUpright(C(O)),N}}function IAe(t,e){return"icon-src"in t?RAe(t,e):"shape-points"in t?PAe(t,e):"circle-radius"in t?MAe(t,e):null}function RAe(t,e){const n="icon-",r=n+"src",i=zae(t[r],r),s=d3(t,n+"anchor",e),o=r5(t,n+"scale",e),a=hl(t,n+"opacity",e),l=d3(t,n+"displacement",e),c=hl(t,n+"rotation",e),u=Dx(t,n+"rotate-with-view",e),h=rX(t,n+"anchor-origin"),f=iX(t,n+"anchor-x-units"),g=iX(t,n+"anchor-y-units"),v=DAe(t,n+"color"),x=OAe(t,n+"cross-origin"),b=LAe(t,n+"offset"),T=rX(t,n+"offset-origin"),A=f3(t,n+"width"),I=f3(t,n+"height"),R=NAe(t,n+"size"),C=i5(t,n+"declutter-mode"),V=new TA({src:i,anchorOrigin:h,anchorXUnits:f,anchorYUnits:g,color:v,crossOrigin:x,offset:b,offsetOrigin:T,height:I,width:A,size:R,declutterMode:C});return function(M){return a&&V.setOpacity(a(M)),l&&V.setDisplacement(l(M)),c&&V.setRotation(c(M)),u&&V.setRotateWithView(u(M)),o&&V.setScale(o(M)),s&&V.setAnchor(s(M)),V}}function PAe(t,e){const n="shape-",r=n+"points",i=n+"radius",s=sj(t[r],r),o=sj(t[i],i),a=QT(t,n,e),l=ek(t,n,e),c=r5(t,n+"scale",e),u=d3(t,n+"displacement",e),h=hl(t,n+"rotation",e),f=Dx(t,n+"rotate-with-view",e),g=f3(t,n+"radius2"),v=f3(t,n+"angle"),x=i5(t,n+"declutter-mode"),b=new n5({points:s,radius:o,radius2:g,angle:v,declutterMode:x});return function(T){return a&&b.setFill(a(T)),l&&b.setStroke(l(T)),u&&b.setDisplacement(u(T)),h&&b.setRotation(h(T)),f&&b.setRotateWithView(f(T)),c&&b.setScale(c(T)),b}}function MAe(t,e){const n="circle-",r=QT(t,n,e),i=ek(t,n,e),s=hl(t,n+"radius",e),o=r5(t,n+"scale",e),a=d3(t,n+"displacement",e),l=hl(t,n+"rotation",e),c=Dx(t,n+"rotate-with-view",e),u=i5(t,n+"declutter-mode"),h=new $a({radius:5,declutterMode:u});return function(f){return s&&h.setRadius(s(f)),r&&h.setFill(r(f)),i&&h.setStroke(i(f)),a&&h.setDisplacement(a(f)),l&&h.setRotation(l(f)),c&&h.setRotateWithView(c(f)),o&&h.setScale(o(f)),h}}function hl(t,e,n){if(!(e in t))return;const r=mp(t[e],Wt,n);return function(i){return sj(r(i),e)}}function If(t,e,n){if(!(e in t))return null;const r=mp(t[e],$s,n);return function(i){return zae(r(i),e)}}function CAe(t,e,n){const r=If(t,e+"pattern-src",n),i=nX(t,e+"pattern-offset",n),s=nX(t,e+"pattern-size",n),o=Mz(t,e+"color",n);return function(a){return{src:r(a),offset:i&&i(a),size:s&&s(a),color:o&&o(a)}}}function Dx(t,e,n){if(!(e in t))return null;const r=mp(t[e],Es,n);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Mz(t,e,n){if(!(e in t))return null;const r=mp(t[e],xi,n);return function(i){return Uae(r(i),e)}}function Vae(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl,n);return function(i){return kA(r(i),e)}}function d3(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl,n);return function(i){const s=kA(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function nX(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl,n);return function(i){return Gae(r(i),e)}}function r5(t,e,n){if(!(e in t))return null;const r=mp(t[e],bl|Wt,n);return function(i){return $Ae(r(i),e)}}function f3(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function NAe(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return Ma(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function OAe(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function rX(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function iX(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function LAe(t,e){const n=t[e];if(n!==void 0)return kA(n,e)}function i5(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function DAe(t,e){const n=t[e];if(n!==void 0)return Uae(n,e)}function kA(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if(typeof t[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function zae(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function sj(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function Uae(t,e){if(typeof t=="string")return t;const n=kA(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function Gae(t,e){const n=kA(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function $Ae(t,e){return typeof t=="number"?t:Gae(t,e)}const Su={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function sX(t,e,n){return(function(r,i,s,o,a){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,u=a?a[0]:0,h=a?a[1]:0;let f=t[0]+l/2+u,g=t[2]-l/2+u,v=t[1]+c/2+h,x=t[3]-c/2+h;f>g&&(f=(g+f)/2,g=f),v>x&&(v=(x+v)/2,x=v);let b=ii(r[0],f,g),T=ii(r[1],v,x);if(o&&n&&i){const A=30*i;b+=-A*Math.log(1+Math.max(0,f-r[0])/A)+A*Math.log(1+Math.max(0,r[0]-g)/A),T+=-A*Math.log(1+Math.max(0,v-r[1])/A)+A*Math.log(1+Math.max(0,r[1]-x)/A)}return[b,T]})}function jAe(t){return t}function Bae(t){return Math.pow(t,3)}function O2(t){return 1-Bae(1-t)}function FAe(t){return 3*t*t-2*t*t*t}function VAe(t){return t}function Cz(t,e,n,r){const i=Gn(e)/n[0],s=cs(e)/n[1];return r?Math.min(t,Math.max(i,s)):Math.min(t,Math.min(i,s))}function Nz(t,e,n){let r=Math.min(t,e);const i=50;return r*=Math.log(1+i*Math.max(0,t/e-1))/i+1,n&&(r=Math.max(r,n),r/=Math.log(1+i*Math.max(0,n/t-1))/i+1),ii(r,n/2,e*2)}function zAe(t,e,n,r){return e=e!==void 0?e:!0,(function(i,s,o,a){if(i!==void 0){const l=t[0],c=t[t.length-1],u=n?Cz(l,n,o,r):l;if(a)return e?Nz(i,u,c):ii(i,c,u);const h=Math.min(u,i),f=Math.floor(GN(t,h,s));return t[f]>u&&f<t.length-1?t[f+1]:t[f]}})}function UAe(t,e,n,r,i,s){return r=r!==void 0?r:!0,n=n!==void 0?n:0,(function(o,a,l,c){if(o!==void 0){const u=i?Cz(e,i,l,s):e;if(c)return r?Nz(o,u,n):ii(o,n,u);const h=1e-9,f=Math.ceil(Math.log(e/u)/Math.log(t)-h),g=-a*(.5-h)+.5,v=Math.min(u,o),x=Math.floor(Math.log(e/v)/Math.log(t)+g),b=Math.max(f,x),T=e/Math.pow(t,b);return ii(T,n,u)}})}function oX(t,e,n,r,i){return n=n!==void 0?n:!0,(function(s,o,a,l){if(s!==void 0){const c=r?Cz(t,r,a,i):t;return!n||!l?ii(s,e,c):Nz(s,c,e)}})}function Oz(t){if(t!==void 0)return 0}function aX(t){if(t!==void 0)return t}function GAe(t){const e=2*Math.PI/t;return(function(n,r){if(r)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n})}function BAe(t){const e=Wf(5);return(function(n,r){return r||n===void 0?n:Math.abs(n)<=e?0:n})}const WAe=42,Lz=256,t6=0;class Qh extends Cd{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=cz(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Zoe(),e.center&&(e.center=af(e.center,this.projection_)),e.extent&&(e.extent=nd(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const a in Su)delete n[a];this.setProperties(n,!0);const r=qAe(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=HAe(e),s=r.constraint,o=KAe(e);this.constraints_={center:i,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];n=n||[0,0,0,0];const s=this.getResolution(),o=s/2*(i[3]-n[3]+n[1]-i[1]),a=s/2*(i[0]-n[0]+n[2]-i[2]);this.setCenterInternal([r[0]+o,r[1]-a])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let r=0;r<n.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=af(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=af(i.anchor,this.getProjection())),n[r]=i}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const u=arguments[i];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(i===n){r&&ZR(r,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<n;++i){const u=arguments[i],h={start:s,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||FAe,callback:r};if(u.center&&(h.sourceCenter=o,h.targetCenter=u.center.slice(),o=h.targetCenter),u.zoom!==void 0?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(u.zoom),a=h.targetResolution):u.resolution&&(h.sourceResolution=a,h.targetResolution=u.resolution,a=h.targetResolution),u.rotation!==void 0){h.sourceRotation=l;const f=og(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=l+f,l=h.targetRotation}YAe(h)?h.complete=!0:s+=h.duration,c.push(h)}this.animations_.push(c),this.setHint(ws.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ws.ANIMATING]>0}getInteracting(){return this.hints_[ws.INTERACTING]>0}cancelAnimations(){this.setHint(ws.ANIMATING,-this.hints_[ws.ANIMATING]);let e;for(let n=0,r=this.animations_.length;n<r;++n){const i=this.animations_[n];if(i[0].callback&&ZR(i[0].callback,!1),!e)for(let s=0,o=i.length;s<o;++s){const a=i[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let o=0,a=i.length;o<a;++o){const l=i[o];if(l.complete)continue;const c=e-l.start;let u=l.duration>0?c/l.duration:1;u>=1?(l.complete=!0,u=1):s=!1;const h=l.easing(u);if(l.sourceCenter){const f=l.sourceCenter[0],g=l.sourceCenter[1],v=l.targetCenter[0],x=l.targetCenter[1];this.nextCenter_=l.targetCenter;const b=f+h*(v-f),T=g+h*(x-g);this.targetCenter_=[b,T]}if(l.sourceResolution&&l.targetResolution){const f=h===1?l.targetResolution:l.sourceResolution+h*(l.targetResolution-l.sourceResolution);if(l.anchor){const g=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(f,0,g,!0);this.targetCenter_=this.calculateCenterZoom(v,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const f=h===1?og(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+h*(l.targetRotation-l.sourceRotation);if(l.anchor){const g=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(g,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),n=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(ws.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=i[0].callback;o&&ZR(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-n[0],i[1]-n[1]],sz(r,e-this.getRotation()),VSe(r,n)),r}calculateCenterZoom(e,n){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const o=n[0]-e*(n[0]-i[0])/s,a=n[1]-e*(n[1]-i[1])/s;r=[o,a]}return r}getViewportSize_(e){const n=this.viewportSize_;if(e){const r=n[0],i=n[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&X8(e,this.getProjection())}getCenterInternal(){return this.get(Su.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return Joe(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();or(n,"The view center is not defined");const r=this.getResolution();or(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return or(i!==void 0,"The view rotation is not defined"),QC(n,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Su.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(nd(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const r=Gn(e)/n[0],i=cs(e)/n[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return(function(s){return n/Math.pow(e,s*i)})}getRotation(){return this.get(Su.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/n;return(function(o){return Math.log(r/o)/n/s})}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();i=n6(i,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],n,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,r,i;if(this.resolutions_){const s=GN(this.resolutions_,e,1);n=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const n=ii(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(r,ii(e-n,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let r;if(or(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){or(!C2(e),"Cannot fit empty extent provided as `geometry`");const i=nd(e,this.getProjection());r=FY(i)}else if(e.getType()==="Circle"){const i=nd(e.getExtent(),this.getProjection());r=FY(i),r.rotate(this.getRotation(),oh(i))}else r=e;this.fitInternal(r,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),r=Math.cos(n),i=Math.sin(-n),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,u=-1/0;for(let h=0,f=s.length;h<f;h+=o){const g=s[h]*r-s[h+1]*i,v=s[h]*i+s[h+1]*r;a=Math.min(a,g),l=Math.min(l,v),c=Math.max(c,g),u=Math.max(u,v)}return[a,l,c,u]}fitInternal(e,n){n=n||{};let r=n.size;r||(r=this.getViewportSizeMinusPadding_());const i=n.padding!==void 0?n.padding:[0,0,0,0],s=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),u=Math.sin(c),h=Math.cos(c),f=oh(a);f[0]+=(i[1]-i[3])/2*l,f[1]+=(i[0]-i[2])/2*l;const g=f[0]*h-f[1]*u,v=f[1]*h+f[0]*u,x=this.getConstrainedCenter([g,v],l),b=n.callback?n.callback:BT;n.duration!==void 0?this.animateInternal({resolution:l,center:x,duration:n.duration,easing:n.easing},b):(this.targetResolution_=l,this.targetCenter_=x,this.applyTargetState_(!1,!0),ZR(b,!0))}centerOn(e,n,r){this.centerOnInternal(af(e,this.getProjection()),n,r)}centerOnInternal(e,n,r){this.setCenterInternal(n6(e,n,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,r,i){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-r),l=n6(e,i,[a[0]/2+o[3],a[1]/2+o[0]],n,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=X8(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&af(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);n&&(this.targetCenter_=this.calculateCenterZoom(s,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=af(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);n&&(this.targetCenter_=this.calculateCenterRotate(i,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&af(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const r=this.getAnimating()||this.getInteracting()||n,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,s,r),a=this.constraints_.center(this.targetCenter_,o,s,r,this.calculateCenterShift(this.targetCenter_,o,i,s));this.get(Su.ROTATION)!==i&&this.set(Su.ROTATION,i),this.get(Su.RESOLUTION)!==o&&(this.set(Su.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Su.CENTER)||!t3(this.get(Su.CENTER),a))&&this.set(Su.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,r){e=e!==void 0?e:200;const i=n||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,i,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!t3(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:O2,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ws.INTERACTING,1)}endInteraction(e,n,r){r=r&&af(r,this.getProjection()),this.endInteractionInternal(e,n,r)}endInteractionInternal(e,n,r){this.getInteracting()&&(this.setHint(ws.INTERACTING,-1),this.resolveConstraints(e,n,r))}getConstrainedCenter(e,n){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),r)}getConstrainedZoom(e,n){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,n))}getConstrainedResolution(e,n){n=n||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,r)}}function ZR(t,e){setTimeout(function(){t(e)},0)}function HAe(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return sX(t.extent,t.constrainOnlyCenter,n)}const e=cz(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,sX(n,!1,!1)}return jAe}function qAe(t){let e,n,r,o=t.minZoom!==void 0?t.minZoom:t6,a=t.maxZoom!==void 0?t.maxZoom:28;const l=t.zoomFactor!==void 0?t.zoomFactor:2,c=t.multiWorld!==void 0?t.multiWorld:!1,u=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,h=t.showFullExtent!==void 0?t.showFullExtent:!1,f=cz(t.projection,"EPSG:3857"),g=f.getExtent();let v=t.constrainOnlyCenter,x=t.extent;if(!c&&!x&&f.isGlobal()&&(v=!1,x=g),t.resolutions!==void 0){const b=t.resolutions;n=b[o],r=b[a]!==void 0?b[a]:b[b.length-1],t.constrainResolution?e=zAe(b,u,!v&&x,h):e=oX(n,r,u,!v&&x,h)}else{const T=(g?Math.max(Gn(g),cs(g)):360*Lw.degrees/f.getMetersPerUnit())/Lz/Math.pow(2,t6),A=T/Math.pow(2,28-t6);n=t.maxResolution,n!==void 0?o=0:n=T/Math.pow(l,o),r=t.minResolution,r===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?r=n/Math.pow(l,a):r=T/Math.pow(l,a):r=A),a=o+Math.floor(Math.log(n/r)/Math.log(l)),r=n/Math.pow(l,a-o),t.constrainResolution?e=UAe(l,n,r,u,!v&&x,h):e=oX(n,r,u,!v&&x,h)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:o,zoomFactor:l}}function KAe(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?BAe():n===!1?aX:typeof n=="number"?GAe(n):aX}return Oz}function YAe(t){return!(t.sourceCenter&&t.targetCenter&&!t3(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function n6(t,e,n,r,i){const s=Math.cos(-i);let o=Math.sin(-i),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;a+=(e[0]/2-n[0])*r,l+=(n[1]-e[1]/2)*r,o=-o;const c=a*s-l*o,u=l*s+a*o;return[c,u]}const xr={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Wae extends Cd{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[xr.OPACITY]=e.opacity!==void 0?e.opacity:1,or(typeof n[xr.OPACITY]=="number","Layer opacity must be a number"),n[xr.VISIBLE]=e.visible!==void 0?e.visible:!0,n[xr.Z_INDEX]=e.zIndex,n[xr.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[xr.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[xr.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[xr.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return n.opacity=ii(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return xn()}getLayerStatesArray(e){return xn()}getExtent(){return this.get(xr.EXTENT)}getMaxResolution(){return this.get(xr.MAX_RESOLUTION)}getMinResolution(){return this.get(xr.MIN_RESOLUTION)}getMinZoom(){return this.get(xr.MIN_ZOOM)}getMaxZoom(){return this.get(xr.MAX_ZOOM)}getOpacity(){return this.get(xr.OPACITY)}getSourceState(){return xn()}getVisible(){return this.get(xr.VISIBLE)}getZIndex(){return this.get(xr.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(xr.EXTENT,e)}setMaxResolution(e){this.set(xr.MAX_RESOLUTION,e)}setMinResolution(e){this.set(xr.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(xr.MAX_ZOOM,e)}setMinZoom(e){this.set(xr.MIN_ZOOM,e)}setOpacity(e){or(typeof e=="number","Layer opacity must be a number"),this.set(xr.OPACITY,e)}setVisible(e){this.set(xr.VISIBLE,e)}setZIndex(e){this.set(xr.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class AA extends Wae{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(xr.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(xr.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Jr(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Hn(e,An.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof Qh?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&r&&(n.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(n.layerStatesArray){if(i=n.layerStatesArray.find(o=>o.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return Dz(i,n.viewState)&&(!s||Ia(s,n.extent))}getAttributions(e){if(!this.isVisible(e))return[];const n=this.getSource()?.getAttributions();if(!n)return[];const r=e instanceof Qh?e.getViewStateAndExtent():e;let i=n(r);return Array.isArray(i)||(i=[i]),i}render(e,n){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(xr.MAP,e)}getMapInternal(){return this.get(xr.MAP)}setMap(e){this.mapPrecomposeKey_&&(Jr(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Jr(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Hn(e,no.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Hn(this,An.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);or(!n.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}setSource(e){this.set(xr.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Dz(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}const lX={RENDER_ORDER:"renderOrder"};class s5 extends AA{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(lX.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new Cae(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(lX.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?Nae:e;const n=XAe(e);this.styleFunction_=e===null?void 0:Oke(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function XAe(t){if(t===void 0)return Nae;if(!t)return null;if(typeof t=="function"||t instanceof zn)return t;if(!Array.isArray(t))return tX([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof zn){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!(o instanceof zn))throw new Error("Expected a list of style instances");i[s]=o}return i}if("style"in n){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");i[s]=o}return TAe(i)}return tX(t)}class gp extends s5{constructor(e){super(e)}createRenderer(){return new eAe(this)}}const Yp={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class km extends Md{constructor(e,n){super(e),this.layer=n}}const r6={LAYERS:"layers"};let o5=class Hae extends Wae{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let r=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(r6.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Hc(r.slice(),{unique:!0}):or(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Hc(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Jr),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Hn(e,ll.ADD,this.handleLayersAdd_,this),Hn(e,ll.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(Jr);M2(this.listenerKeys_);const n=e.getArray();for(let r=0,i=n.length;r<i;r++){const s=n[r];this.registerLayerListeners_(s),this.dispatchEvent(new km(Yp.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const n=[Hn(e,Ow.PROPERTYCHANGE,this.handleLayerChange_,this),Hn(e,An.CHANGE,this.handleLayerChange_,this)];e instanceof Hae&&n.push(Hn(e,Yp.ADDLAYER,this.handleLayerGroupAdd_,this),Hn(e,Yp.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[_n(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new km(Yp.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new km(Yp.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new km(Yp.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,r=_n(n);this.listenerKeys_[r].forEach(Jr),delete this.listenerKeys_[r],this.dispatchEvent(new km(Yp.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(r6.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const r=n.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new km(Yp.REMOVELAYER,r[i]))}this.set(r6.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],r=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let o=r,a=n.length;o<a;o++){const l=n[o];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Bf(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return n}getSourceState(){return"ready"}};const ln={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function qae(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function oj(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}const p3=34962,$z=34963,ZAe=35044,i6=35048,JAe=5121,QAe=5123,eIe=5125,Kae=5126,cX=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function tIe(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!jTe},e);const n=cX.length;for(let r=0;r<n;++r)try{const i=t.getContext(cX[r],e);if(i)return i}catch{}return null}const nIe={STATIC_DRAW:ZAe};class s6{constructor(e,n){this.array_=null,this.type_=e,or(e===p3||e===$z,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=n!==void 0?n:nIe.STATIC_DRAW}ofSize(e){return this.array_=new(JR(this.type_))(e),this}fromArray(e){return this.array_=JR(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(JR(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const n=JR(this.type_);if(!(e instanceof n))throw new Error(`Expected ${n}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function JR(t){switch(t){case p3:return Float32Array;case $z:return Uint32Array;default:return Float32Array}}const QR={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},rIe=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,iIe=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class uX{constructor(e){this.gl_=e.webGlContext;const n=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=n.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=n.createFramebuffer(),this.depthBuffer_=n.createRenderbuffer();const r=n.createShader(n.VERTEX_SHADER);n.shaderSource(r,e.vertexShader||rIe),n.compileShader(r);const i=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(i,e.fragmentShader||iIe),n.compileShader(i),this.renderTargetProgram_=n.createProgram(),n.attachShader(this.renderTargetProgram_,r),n.attachShader(this.renderTargetProgram_,i),n.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=n.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.bufferData(n.ARRAY_BUFFER,new Float32Array(s),n.STATIC_DRAW),this.renderTargetAttribLocation_=n.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:n.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const n=this.getGL(),r=[n.drawingBufferWidth*this.scaleRatio_,n.drawingBufferHeight*this.scaleRatio_];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.getDepthBuffer()),n.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=n.RGBA,o=0,a=n.RGBA,l=n.UNSIGNED_BYTE,c=null;n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.texImage2D(n.TEXTURE_2D,i,s,r[0],r[1],o,a,l,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.renderTargetTexture_,0),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,r[0],r[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer_)}}apply(e,n,r,i){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,n?n.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!n){const l=_n(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const n=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=n.createTexture()),n.activeTexture(n[`TEXTURE${i}`]),n.bindTexture(n.TEXTURE_2D,s.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,r.width,r.height,0,n.UNSIGNED_BYTE,new Uint8Array(r.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:n.uniform2f(s.location,r[0],r[1]);return;case 3:n.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:n.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(s.location,r)})}}const lf={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},wo={UNSIGNED_BYTE:JAe,UNSIGNED_SHORT:QAe,UNSIGNED_INT:eIe,FLOAT:Kae},m3={};function hX(t){return"shared/"+t}let dX=0;function sIe(){const t="unique/"+dX;return dX+=1,t}function oIe(t){let e=m3[t];if(!e){const n=document.createElement("canvas");n.width=1,n.height=1,n.style.position="absolute",n.style.left="0",e={users:0,context:tIe(n)},m3[t]=e}return e.users+=1,e.context}function aIe(t){const e=m3[t];if(!e||(e.users-=1,e.users>0))return;const n=e.context,r=n.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=n.canvas;i.width=1,i.height=1,delete m3[t]}class lIe extends gA{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?hX(e.canvasCacheKey):sIe(),this.gl_=oIe(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const n=this.gl_.canvas;n.addEventListener(QR.LOST,this.boundHandleWebGLContextLost_),n.addEventListener(QR.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=js(),this.offsetScaleMatrix_=js(),this.tmpMat4_=qae(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new uX({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new uX({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const n in e)this.uniforms_.push({name:n,value:e[n]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===hX(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return or(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const n=this.gl_,r=_n(e);let i=this.bufferCache_[r];if(!i){const s=n.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}n.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const n=this.gl_;this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const n=_n(e);delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(QR.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(QR.RESTORED,this.boundHandleWebGLContextRestored_),aIe(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,n,r){const i=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,n){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0)}bindInitialFrameBuffer(){const e=this.getGL(),n=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,n,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+n),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),n)}bindAttribute(e,n,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(n);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,n,r,i){const s=this.gl_,o=n.getSize();s.bindFramebuffer(s.FRAMEBUFFER,n.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,n.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,n.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,n){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,o=n-e,a=e*s;r.drawElements(r.TRIANGLES,o,i,a)}drawElementsInstanced(e,n,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),o=i.UNSIGNED_INT,a=4,l=n-e,c=e*a;s.drawElementsInstancedANGLE(i.TRIANGLES,l,o,c,r);for(let u=0;u<this.maxAttributeCount_;u++)s.vertexAttribDivisorANGLE(u,0)}finalizeDraw(e,n,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,n,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const n=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(lf.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(lf.ZOOM,e.viewState.zoom),this.setUniformFloatValue(lf.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(lf.PIXEL_RATIO,i),this.setUniformFloatVec2(lf.VIEWPORT_SIZE_PX,[n[0],n[1]]),this.setUniformFloatValue(lf.ROTATION,r)}applyHitDetectionUniform(e){const n=this.getUniformLocation(lf.HIT_DETECTION);this.getGL().uniform1i(n,e?1:0),e&&this.setUniformFloatValue(lf.PIXEL_RATIO,.5)}applyUniforms(e){const n=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=n.createTexture()),this.bindTexture(s.texture,i,s.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&o&&s.prevValue!==r&&(s.prevValue=r,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,oj(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:n.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:n.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:n.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,n){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,n&&(this.applyFrameState(n),this.applyUniforms(n))}compileShader(e,n){const r=this.gl_,i=r.createShader(n);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,n){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(n,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,i),r.attachShader(o,s),r.linkProgram(o),!r.getShaderParameter(i,r.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(a)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(a)}if(r.deleteShader(s),!r.getProgramParameter(o,r.LINK_STATUS)){const a=`GL program linking failed: ${r.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const n=_n(this.currentProgram_);return this.uniformLocationsByProgram_[n]===void 0&&(this.uniformLocationsByProgram_[n]={}),this.uniformLocationsByProgram_[n][e]===void 0&&(this.uniformLocationsByProgram_[n][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[n][e]}getAttributeLocation(e){const n=_n(this.currentProgram_);return this.attribLocationsByProgram_[n]===void 0&&(this.attribLocationsByProgram_[n]={}),this.attribLocationsByProgram_[n][e]===void 0&&(this.attribLocationsByProgram_[n][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[n][e]}makeProjectionTransform(e,n){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return iu(n,0,0,2/(s*r[0]),2/(s*r[1]),-i,-o[0],-o[1]),n}setUniformFloatValue(e,n){this.gl_.uniform1f(this.getUniformLocation(e),n)}setUniformFloatVec2(e,n){this.gl_.uniform2fv(this.getUniformLocation(e),n)}setUniformFloatVec4(e,n){this.gl_.uniform4fv(this.getUniformLocation(e),n)}setUniformMatrixValue(e,n){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,n)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,n,r,i,s,o){const a=this.getAttributeLocation(e);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,n,r,!1,i,s),o&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(a,1))}enableAttributes_(e,n){const r=cIe(e);let i=0;for(let s=0;s<e.length;s++){const o=e[s];o.name&&this.enableAttributeArray_(o.name,o.size,o.type||Kae,r,i,n),i+=o.size*Yae(o.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){M2(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,n,r,i){const s=this.gl_;r=r||s.createTexture();const o=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,c=0,u=s.RGBA,h=s.UNSIGNED_BYTE;return n instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,h,n):n?s.texImage2D(s.TEXTURE_2D,a,l,u,h,n):s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,h,null),r}}function cIe(t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];e+=r.size*Yae(r.type)}return e}function Yae(t){switch(t){case wo.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case wo.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case wo.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case wo.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class jz extends yA{constructor(e,n,r){super(),r=r||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(An.CHANGE)}release(){this.setState(ln.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ln.EMPTY){if(this.state!==ln.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){xn()}getAlpha(e,n){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=n,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=n-r+1e3/60;return i>=this.transition_?1:Bae(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function aj(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const uIe=new Error("disposed"),hIe=[256,256];class fX extends jz{constructor(e){const n=ln.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=aj(this.data_);return e?[e.width,e.height]:hIe}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ln.IDLE&&this.state!==ln.ERROR)return;this.state=ln.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=ln.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=ln.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(uIe),this.controller_=null),super.disposeInternal()}}class Xae extends jz{constructor(e,n,r,i,s,o){super(e,n,o),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,tc?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ln.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=ln.ERROR,this.unlistenImage_(),this.image_=dIe(),this.changed()}handleImageLoad_(){if(tc)this.state=ln.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ln.LOADED:this.state=ln.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==ln.ERROR&&(this.state=ln.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ln.IDLE&&(this.state=ln.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=JTe(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function dIe(){const t=Ts(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}let o6;const $x=[];function pX(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function a6(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function fIe(){if(o6===void 0){const t=Ts(6,6,$x);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",pX(t,4,5,4,0),pX(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;o6=a6(e,0)||a6(e,4)||a6(e,8),e5(t),$x.push(t.canvas)}return o6}function g3(t,e,n,r){const i=N2(n,e,t);let s=s3(e,r,n);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=t.getMetersPerUnit();a!==void 0&&(s/=a);const l=t.getExtent();if(!l||u1(l,i)){const c=s3(t,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function pIe(t,e,n,r){const i=oh(n);let s=g3(t,e,i,r);return(!isFinite(s)||s<=0)&&joe(n,function(o){return s=g3(t,e,o,r),isFinite(s)&&s>0}),s}function Zae(t,e,n,r,i,s,o,a,l,c,u,h,f,g){const v=Ts(Math.round(n*t),Math.round(n*e),$x);if(h||(v.imageSmoothingEnabled=!1),l.length===0)return v.canvas;v.scale(n,n);function x(C){return Math.round(C*n)/n}v.globalCompositeOperation="lighter";const b=wl();l.forEach(function(C,V,M){Doe(b,C.extent)});let T;const A=n/r,I=(h?1:1+Math.pow(2,-24))/A;if(!f||l.length!==1||c!==0){if(T=Ts(Math.round(Gn(b)*A),Math.round(cs(b)*A),$x),h||(T.imageSmoothingEnabled=!1),i&&g){const C=(i[0]-b[0])*A,V=-(i[3]-b[3])*A,M=Gn(i)*A,N=cs(i)*A;T.rect(C,V,M,N),T.clip()}l.forEach(function(C,V,M){if(C.image.width>0&&C.image.height>0){if(C.clipExtent){T.save();const B=(C.clipExtent[0]-b[0])*A,U=-(C.clipExtent[3]-b[3])*A,de=Gn(C.clipExtent)*A,me=cs(C.clipExtent)*A;T.rect(h?B:Math.round(B),h?U:Math.round(U),h?de:Math.round(B+de)-Math.round(B),h?me:Math.round(U+me)-Math.round(U)),T.clip()}const N=(C.extent[0]-b[0])*A,O=-(C.extent[3]-b[3])*A,F=Gn(C.extent)*A,L=cs(C.extent)*A;T.drawImage(C.image,c,c,C.image.width-2*c,C.image.height-2*c,h?N:Math.round(N),h?O:Math.round(O),h?F:Math.round(N+F)-Math.round(N),h?L:Math.round(O+L)-Math.round(O)),C.clipExtent&&T.restore()}})}const R=q1(o);return a.getTriangles().forEach(function(C,V,M){const N=C.source,O=C.target;let F=N[0][0],L=N[0][1],B=N[1][0],U=N[1][1],de=N[2][0],me=N[2][1];const ze=x((O[0][0]-R[0])/s),Le=x(-(O[0][1]-R[1])/s),fe=x((O[1][0]-R[0])/s),$e=x(-(O[1][1]-R[1])/s),Ce=x((O[2][0]-R[0])/s),le=x(-(O[2][1]-R[1])/s),W=F,ne=L;F=0,L=0,B-=W,U-=ne,de-=W,me-=ne;const se=[[B,U,0,0,fe-ze],[de,me,0,0,Ce-ze],[0,0,B,U,$e-Le],[0,0,de,me,le-Le]],ae=FSe(se);if(!ae)return;if(v.save(),v.beginPath(),fIe()||!h){v.moveTo(fe,$e);const Ke=4,Ye=ze-fe,ke=Le-$e;for(let Te=0;Te<Ke;Te++)v.lineTo(fe+x((Te+1)*Ye/Ke),$e+x(Te*ke/(Ke-1))),Te!=Ke-1&&v.lineTo(fe+x((Te+1)*Ye/Ke),$e+x((Te+1)*ke/(Ke-1)));v.lineTo(Ce,le)}else v.moveTo(fe,$e),v.lineTo(ze,Le),v.lineTo(Ce,le);v.clip(),v.transform(ae[0],ae[2],ae[1],ae[3],ze,Le),v.translate(b[0]-W,b[3]-ne);let _e;if(T)_e=T.canvas,v.scale(I,-I);else{const Ke=l[0],Ye=Ke.extent;_e=Ke.image,v.scale(Gn(Ye)/_e.width,-cs(Ye)/_e.height)}v.drawImage(_e,0,0),v.restore()}),T&&(e5(T),$x.push(T.canvas)),u&&(v.save(),v.globalCompositeOperation="source-over",v.strokeStyle="black",v.lineWidth=1,a.getTriangles().forEach(function(C,V,M){const N=C.target,O=(N[0][0]-R[0])/s,F=-(N[0][1]-R[1])/s,L=(N[1][0]-R[0])/s,B=-(N[1][1]-R[1])/s,U=(N[2][0]-R[0])/s,de=-(N[2][1]-R[1])/s;v.beginPath(),v.moveTo(L,B),v.lineTo(O,F),v.lineTo(U,de),v.closePath(),v.stroke()}),v.restore()),v.canvas}const mIe=10,mX=.25;class Jae{constructor(e,n,r,i,s,o,a){this.sourceProj_=e,this.targetProj_=n;let l={};const c=a?Y8(I=>Ki(a,N2(I,this.targetProj_,this.sourceProj_))):WT(this.targetProj_,this.sourceProj_);this.transformInv_=function(I){const R=I[0]+"/"+I[1];return l[R]||(l[R]=c(I)),l[R]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Gn(i)>=Gn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Gn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Gn(this.targetProj_.getExtent()):null;const u=q1(r),h=qN(r),f=HN(r),g=WN(r),v=this.transformInv_(u),x=this.transformInv_(h),b=this.transformInv_(f),T=this.transformInv_(g),A=mIe+(o?Math.max(0,Math.ceil(Math.log2(B8(r)/(o*o*256*256)))):0);if(this.addQuad_(u,h,f,g,v,x,b,T,A),this.wrapsXInSource_){let I=1/0;this.triangles_.forEach(function(R,C,V){I=Math.min(I,R.source[0][0],R.source[1][0],R.source[2][0])}),this.triangles_.forEach(R=>{if(Math.max(R.source[0][0],R.source[1][0],R.source[2][0])-I>this.sourceWorldWidth_/2){const C=[[R.source[0][0],R.source[0][1]],[R.source[1][0],R.source[1][1]],[R.source[2][0],R.source[2][1]]];C[0][0]-I>this.sourceWorldWidth_/2&&(C[0][0]-=this.sourceWorldWidth_),C[1][0]-I>this.sourceWorldWidth_/2&&(C[1][0]-=this.sourceWorldWidth_),C[2][0]-I>this.sourceWorldWidth_/2&&(C[2][0]-=this.sourceWorldWidth_);const V=Math.min(C[0][0],C[1][0],C[2][0]);Math.max(C[0][0],C[1][0],C[2][0])-V<this.sourceWorldWidth_/2&&(R.source=C)}})}l={}}addTriangle_(e,n,r,i,s,o){this.triangles_.push({source:[i,s,o],target:[e,n,r]})}addQuad_(e,n,r,i,s,o,a,l,c){const u=gY([s,o,a,l]),h=this.sourceWorldWidth_?Gn(u)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&h>.5&&h<1;let v=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const b=gY([e,n,r,i]);v=Gn(b)/this.targetWorldWidth_>mX||v}!g&&this.sourceProj_.isGlobal()&&h&&(v=h>mX||v)}if(!v&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!Ia(u,this.maxSourceExtent_))return;let x=0;if(!v&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)v=!0;else if(x=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(c>0){if(!v){const b=[(e[0]+r[0])/2,(e[1]+r[1])/2],T=this.transformInv_(b);let A;g?A=(og(s[0],f)+og(a[0],f))/2-og(T[0],f):A=(s[0]+a[0])/2-T[0];const I=(s[1]+a[1])/2-T[1];v=A*A+I*I>this.errorThresholdSquared_}if(v){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const b=[(n[0]+r[0])/2,(n[1]+r[1])/2],T=this.transformInv_(b),A=[(i[0]+e[0])/2,(i[1]+e[1])/2],I=this.transformInv_(A);this.addQuad_(e,n,b,A,s,o,T,I,c-1),this.addQuad_(A,b,r,i,I,T,a,l,c-1)}else{const b=[(e[0]+n[0])/2,(e[1]+n[1])/2],T=this.transformInv_(b),A=[(r[0]+i[0])/2,(r[1]+i[1])/2],I=this.transformInv_(A);this.addQuad_(e,b,A,i,s,T,I,l,c-1),this.addQuad_(b,n,r,A,T,o,a,I,c-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(e,r,i,s,a,l),(x&14)==0&&this.addTriangle_(e,r,n,s,a,o),x&&((x&13)==0&&this.addTriangle_(n,i,e,o,l,s),(x&7)==0&&this.addTriangle_(n,i,r,o,l,a))}calculateSourceExtent(){const e=wl();return this.triangles_.forEach(function(n,r,i){const s=n.source;LS(e,s[0]),LS(e,s[1]),LS(e,s[2])}),e}getTriangles(){return this.triangles_}}const Qae=.5;class ele extends jz{constructor(e,n,r,i,s,o,a,l,c,u,h,f){super(s,ln.IDLE,f),this.renderEdges_=h!==void 0?h:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=i,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const g=i.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let x=this.sourceTileGrid_.getExtent();const b=v?Bf(g,v):g;if(B8(b)===0){this.state=ln.EMPTY;return}const T=e.getExtent();T&&(x?x=Bf(x,T):x=T);const A=i.getResolution(this.wrappedTileCoord_[0]),I=pIe(e,r,b,A);if(!isFinite(I)||I<=0){this.state=ln.EMPTY;return}const R=u!==void 0?u:Qae;if(this.triangulation_=new Jae(e,r,b,x,I*R,A),this.triangulation_.getTriangles().length===0){this.state=ln.EMPTY;return}this.sourceZ_=n.getZForResolution(I);let C=this.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(C[1]=ii(C[1],x[1],x[3]),C[3]=ii(C[3],x[1],x[3])):C=Bf(C,x)),!B8(C))this.state=ln.EMPTY;else{let V=0,M=0;e.canWrapX()&&(V=Gn(T),M=Math.floor((C[0]-T[0])/V)),zoe(C.slice(),e,!0).forEach(O=>{const F=n.getTileRangeForExtentAndZ(O,this.sourceZ_);for(let L=F.minX;L<=F.maxX;L++)for(let B=F.minY;B<=F.maxY;B++){const U=c(this.sourceZ_,L,B,a);if(U){const de=M*V;this.sourceTiles_.push({tile:U,offset:de})}}++M}),this.sourceTiles_.length===0&&(this.state=ln.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{const r=n.tile;if(r&&r.getState()==ln.LOADED){const i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=n.offset,i[2]+=n.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=n.offset,s[2]+=n.offset),e.push({extent:i,clipExtent:s,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=ln.ERROR;else{const n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],o=this.targetTileGrid_.getResolution(n),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Zae(i,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ln.LOADED}this.changed()}load(){if(this.state==ln.IDLE){this.state=ln.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const r=n.getState();if(r==ln.IDLE||r==ln.LOADING){e++;const i=Hn(n,An.CHANGE,s=>{const o=n.getState();(o==ln.LOADED||o==ln.ERROR||o==ln.EMPTY)&&(Jr(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},r,i){n.getState()==ln.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Jr),this.sourcesListenerKeys_=null}release(){this.canvas_&&(e5(this.canvas_.getContext("2d")),$x.push(this.canvas_),this.canvas_=null),super.release()}}class Fz{constructor(e,n,r,i){this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Zv(t,e,n,r,i){return i!==void 0?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new Fz(t,e,n,r)}class gX{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof gA&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const r=this.entries_[e];return or(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const n=this.entries_[e];return or(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.key_;return e}getValues(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){or(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function y3(t,e,n,r){return r!==void 0?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function gIe(t,e,n){return t+"/"+e+"/"+n}function xM(t,e,n,r,i){return`${_n(t)},${e},${gIe(n,r,i)}`}function tle(t){return yIe(t[0],t[1],t[2])}function yIe(t,e,n){return(e<<t)+n}function vIe(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return s?s.containsXY(r,i):!0}class Vz extends $ae{constructor(e,n){super(e),n=n||{},this.inversePixelTransform_=js(),this.postProcesses_=n.postProcesses,this.uniforms_=n.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(xr.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(no.PRECOMPOSE)){const i=new $S(no.PRECOMPOSE,void 0,n,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(no.POSTCOMPOSE)){const i=new $S(no.POSTCOMPOSE,void 0,n,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let n=!0,r=-1,i;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof Vz)){n=!0;continue}const u=l.getClassName();if((n||u!==i)&&(r+=1,n=!1),i=u,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new lIe({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(xr.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){iu(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new $S(e,this.inversePixelTransform_,r,n);i.dispatchEvent(s)}}preRender(e,n){this.dispatchRenderEvent_(no.PRERENDER,e,n)}postRender(e,n){this.dispatchRenderEvent_(no.POSTRENDER,e,n)}}const l6={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class _Ie{constructor(e,n){this.name=e,this.data=n,this.texture_=null}getTexture(e){if(!this.texture_){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=n}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function xIe(t,e){return`operator_${t}_${Object.keys(e.functions).length}`}function ag(t){const e=t.toString();return e.includes(".")?e:e+".0"}function zz(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(ag).join(", ")})`}function wM(t){const e=su(t),n=e.length>3?e[3]:1;return zz([e[0]/255,e[1]/255,e[2]/255,n])}function wIe(t){const e=Ma(t);return zz(e)}const c6={};let bIe=0;function tk(t){return t in c6||(c6[t]=bIe++),c6[t]}function Rf(t){return ag(tk(t))}function Uz(t){return"u_var_"+t}function nle(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const u6="getBandValue",EIe="u_paletteTextures",rle="featureId",ile="geometryType",lj=-9999999;function SIe(t,e,n,r){const i=oo(t,e,n);return Gz(i,e,r)}function pr(t){return(e,n,r)=>{const i=n.args.length,s=new Array(i);for(let o=0;o<i;++o)s[o]=Gz(n.args[o],r,e);return t(s,e)}}const TIe={[Se.Get]:(t,e)=>{const r=e.args[0].value;r in t.properties||(t.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return Hh(e.type,Es)&&(s=`(${s} > 0.0)`),s},[Se.Id]:t=>(t.featureId=!0,"a_"+rle),[Se.GeometryType]:t=>(t.geometryType=!0,"a_"+ile),[Se.LineMetric]:()=>"currentLineMetric",[Se.Var]:(t,e)=>{const r=e.args[0].value;r in t.variables||(t.variables[r]={name:r,type:e.type});let s=Uz(r);return Hh(e.type,Es)&&(s=`(${s} > 0.0)`),s},[Se.Has]:(t,e)=>{const r=e.args[0].value;return r in t.properties||(t.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${ag(lj)})`},[Se.Resolution]:()=>"u_resolution",[Se.Zoom]:()=>"u_zoom",[Se.Time]:()=>"u_time",[Se.Any]:pr(t=>`(${t.join(" || ")})`),[Se.All]:pr(t=>`(${t.join(" && ")})`),[Se.Not]:pr(([t])=>`(!${t})`),[Se.Equal]:pr(([t,e])=>`(${t} == ${e})`),[Se.NotEqual]:pr(([t,e])=>`(${t} != ${e})`),[Se.GreaterThan]:pr(([t,e])=>`(${t} > ${e})`),[Se.GreaterThanOrEqualTo]:pr(([t,e])=>`(${t} >= ${e})`),[Se.LessThan]:pr(([t,e])=>`(${t} < ${e})`),[Se.LessThanOrEqualTo]:pr(([t,e])=>`(${t} <= ${e})`),[Se.Multiply]:pr(t=>`(${t.join(" * ")})`),[Se.Divide]:pr(([t,e])=>`(${t} / ${e})`),[Se.Add]:pr(t=>`(${t.join(" + ")})`),[Se.Subtract]:pr(([t,e])=>`(${t} - ${e})`),[Se.Clamp]:pr(([t,e,n])=>`clamp(${t}, ${e}, ${n})`),[Se.Mod]:pr(([t,e])=>`mod(${t}, ${e})`),[Se.Pow]:pr(([t,e])=>`pow(${t}, ${e})`),[Se.Abs]:pr(([t])=>`abs(${t})`),[Se.Floor]:pr(([t])=>`floor(${t})`),[Se.Ceil]:pr(([t])=>`ceil(${t})`),[Se.Round]:pr(([t])=>`floor(${t} + 0.5)`),[Se.Sin]:pr(([t])=>`sin(${t})`),[Se.Cos]:pr(([t])=>`cos(${t})`),[Se.Atan]:pr(([t,e])=>e!==void 0?`atan(${t}, ${e})`:`atan(${t})`),[Se.Sqrt]:pr(([t])=>`sqrt(${t})`),[Se.Match]:pr(t=>{const e=t[0],n=t[t.length-1];let r=null;for(let i=t.length-3;i>=1;i-=2){const s=t[i],o=t[i+1];r=`(${e} == ${s} ? ${o} : ${r||n})`}return r}),[Se.Between]:pr(([t,e,n])=>`(${t} >= ${e} && ${t} <= ${n})`),[Se.Interpolate]:pr(([t,e,...n])=>{let r="";for(let i=0;i<n.length-2;i+=2){const s=n[i],o=r||n[i+1],a=n[i+2],l=n[i+3];let c;t===ag(1)?c=`(${e} - ${s}) / (${a} - ${s})`:c=`(pow(${t}, (${e} - ${s})) - 1.0) / (pow(${t}, (${a} - ${s})) - 1.0)`,r=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[Se.Case]:pr(t=>{const e=t[t.length-1];let n=null;for(let r=t.length-3;r>=0;r-=2){const i=t[r],s=t[r+1];n=`(${i} ? ${s} : ${n||e})`}return n}),[Se.In]:pr(([t,...e],n)=>{const r=xIe("in",n),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return n.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${t})`}),[Se.Array]:pr(t=>`vec${t.length}(${t.join(", ")})`),[Se.Color]:pr(t=>{if(t.length===1)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(t.length===2)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(r=>`${r} / 255.0`);if(t.length===3)return`vec4(${e.join(", ")}, 1.0)`;const n=t[3];return`vec4(${e.join(", ")}, ${n})`}),[Se.Band]:pr(([t,e,n],r)=>{if(!(u6 in r.functions)){let i="";const s=r.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const c=`${l6.TILE_TEXTURE_ARRAY}[${a}]`;i+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[u6]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${l6.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${l6.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${u6}(${t}, ${e??"0.0"}, ${n??"0.0"})`}),[Se.Palette]:(t,e)=>{const[n,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const u=r[c].value,h=su(u),f=c*4;s[f]=h[0],s[f+1]=h[1],s[f+2]=h[2],s[f+3]=h[3]*255}t.paletteTextures||(t.paletteTextures=[]);const o=`${EIe}[${t.paletteTextures.length}]`,a=new _Ie(o,s);t.paletteTextures.push(a);const l=Gz(n,Wt,t);return`texture2D(${o}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function Gz(t,e,n){if(t instanceof jae){const r=TIe[t.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return r(n,t,e)}if((t.type&Wt)>0)return ag(t.value);if((t.type&Es)>0)return t.value.toString();if((t.type&$s)>0)return Rf(t.value.toString());if((t.type&xi)>0)return wM(t.value);if((t.type&bl)>0)return zz(t.value);if((t.type&Kc)>0)return wIe(t.value);throw new Error(`Unexpected expression ${t.value} (expected type ${dx(e)})`)}function kIe(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const yX=.985;function Tn(t,e,n){const r=Rz();return SIe(e,n,r,t)}function AIe(t){const e=su(t),n=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[n+r,i+s]}const IIe=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function Bz(t){return t===xi||t===Kc?2:t===bl?4:1}function cj(t){const e=Bz(t);return e>1?`vec${e}`:"float"}function sle(t,e){for(const n in e.variables){const r=e.variables[n],i=Uz(r.name);let s=cj(r.type);r.type===xi&&(s="vec4"),t.addUniform(i,s)}for(const n in e.properties){const r=e.properties[n],i=cj(r.type),s=`a_prop_${r.name}`;r.type===xi?t.addAttribute(s,i,`unpackColor(${s})`,"vec4"):t.addAttribute(s,i)}for(const n in e.functions)t.addVertexShaderFunction(e.functions[n]),t.addFragmentShaderFunction(e.functions[n])}function ole(t,e){const n={};for(const r in t.variables){const i=t.variables[r],s=Uz(i.name);n[s]=()=>{const o=e[i.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(i.type===xi){const a=[...su(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??=1,a}return typeof o=="string"?tk(o):o}}return n}function ale(t){const e={};for(const n in t.properties){const r=t.properties[n],i=s=>{const o=s.get(r.name);return r.type===xi?AIe([...su(o||"#eee")]):typeof o=="string"?tk(o):typeof o=="boolean"?o?1:0:o};e[`prop_${r.name}`]={size:Bz(r.type),callback:i}}return e}const Jv=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${IIe}
`,Qv=kIe();class lle{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${ag(Qv["circle-radius"])} + ${ag(Qv["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=wM(Qv["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=ag(Qv["stroke-width"]),this.strokeColorExpression_=wM(Qv["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=Rf("round"),this.strokeJoinExpression_=Rf("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=wM(Qv["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,n){return this.uniforms_.push({name:e,type:n}),this}addAttribute(e,n,r,i){return this.attributes_.push({name:e,type:n,varyingName:e.replace(/^a_/,"v_"),varyingType:i??n,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${yX} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${yX}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${Rf("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${Rf("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${Rf("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${Rf("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Jv}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class v3{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,n){for(let r=0;r<e.length;r++)this.addFeature(e[r],n)}addFeature(e,n){let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const n=_n(e),r=this.pointBatch.entries[n];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[n],r}clearFeatureEntryInLineStringBatch_(e){const n=_n(e),r=this.lineStringBatch.entries[n];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[n],r}clearFeatureEntryInPolygonBatch_(e){const n=_n(e),r=this.polygonBatch.entries[n];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[n],r}addGeometry_(e,n){const r=e.getType();switch(r){case"GeometryCollection":{const i=e.getGeometriesArray();for(const s of i)this.addGeometry_(s,n);break}case"MultiPolygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEndss(),n,_n(n),i.getStride());break}case"MultiLineString":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),n,_n(n),i.getStride());break}case"MultiPoint":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,n,_n(n),i.getStride());break}case"Polygon":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),i.getEnds(),n,_n(n),i.getStride());break}case"Point":{const i=e;this.addCoordinates_(r,i.getFlatCoordinates(),null,n,_n(n),i.getStride());break}case"LineString":case"LinearRing":{const i=e,s=i.getStride();this.addCoordinates_(r,i.getFlatCoordinates(),null,n,_n(n),s,i.getLayout?.());break}}}addCoordinates_(e,n,r,i,s,o,a){let l;switch(e){case"MultiPolygon":{const c=r;for(let u=0,h=c.length;u<h;u++){let f=c[u];const g=u>0?c[u-1]:null,v=g?g[g.length-1]:0,x=f[f.length-1];f=v>0?f.map(b=>b-v):f,this.addCoordinates_("Polygon",n.slice(v,x),f,i,s,o,a)}break}case"MultiLineString":{const c=r;for(let u=0,h=c.length;u<h;u++){const f=u>0?c[u-1]:0;this.addCoordinates_("LineString",n.slice(f,c[u]),null,i,s,o,a)}break}case"MultiPoint":for(let c=0,u=n.length;c<u;c+=o)this.addCoordinates_("Point",n.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof ul){const f=Iae(n,c);if(f.length>1){this.addCoordinates_("MultiPolygon",n,f,i,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=n.length/o;const u=r.length,h=r.map((f,g,v)=>g>0?(f-v[g-1])/o:f/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=u,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(RIe(n,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(h),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=u;for(let f=0,g=c.length;f<g;f++){const v=f>0?c[f-1]:0;this.addCoordinates_("LinearRing",n.slice(v,c[f]),null,i,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(n);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=n.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(PIe(n,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,n){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return n.ref=i,r||(this.refToFeature_.set(i,n.feature),this.uidToRef_.set(e,i)),n}removeRef_(e,n){if(!e)throw new Error("This feature has no ref: "+n);this.refToFeature_.delete(e),this.uidToRef_.delete(n),this.freeGlobalRef_.push(e)}changeFeature(e,n){if(!this.uidToRef_.get(_n(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}removeFeature(e){let n=this.clearFeatureEntryInPointBatch_(e);n=this.clearFeatureEntryInPolygonBatch_(e)||n,n=this.clearFeatureEntryInLineStringBatch_(e)||n,n&&this.removeRef_(n.ref,_n(n.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const n=new v3;n.globalCounter_=this.globalCounter_,n.uidToRef_=this.uidToRef_,n.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(n.addFeature(i),r=!1);return r?new v3:n}}function RIe(t,e){return e===2?t:t.filter((n,r)=>r%e<2)}function PIe(t,e,n){return e===3&&n==="XYM"?t:e===4?t.filter((r,i)=>i%e!==2):e===3?t.map((r,i)=>i%e!==2?r:0):new Array(t.length*1.5).fill(0).map((r,i)=>i%3===2?0:t[Math.round(i/1.5)])}function MIe(){const t='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}const h6={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function CIe(t,e){e=e||[];const n=256,r=n-1,i=Math.floor(t/n/n/n)/r,s=Math.floor(t/n/n)%n/r,o=Math.floor(t/n)%n/r,a=t%n/r;return e[0]=i*256*255+s*255,e[1]=o*256*255+a*255,e}function NIe(t){let e=0;const n=256,r=n-1;return e+=Math.round(t[0]*n*n*n*r),e+=Math.round(t[1]*n*n*r),e+=Math.round(t[2]*n*r),e+=Math.round(t[3]*r),e}function Wz(t,e,n,r){let i=0;for(const s in e){const o=e[s],a=o.callback.call(n,n.feature);let l=a?.[0]??a;l===lj&&console.warn('The "has" operator might return false positives.'),l===void 0?l=lj:l===null&&(l=0),t[r+i++]=l,!(!o.size||o.size===1)&&(t[r+i++]=a[1],!(o.size<3)&&(t[r+i++]=a[2],!(o.size<4)&&(t[r+i++]=a[3])))}return i}function a5(t){return Object.keys(t).reduce((e,n)=>e+(t[n].size||1),0)}function OIe(t,e,n,r){const i=(2+a5(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],Ki(r,s),e[o++]=s[0],e[o++]=s[1],o+=Wz(e,n,l,o)}return e}function LIe(t,e,n,r){const i=3*t.verticesCount+(1+a5(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,ad(l.flatCoordss[c],0,s.length,3,r,s,3),o+=Wz(e,n,l,o),e[o++]=s.length/3;for(let h=0,f=s.length;h<f;h+=3)e[o++]=s[h],e[o++]=s[h+1],e[o++]=s[h+2]}}return e}function DIe(t,e,n,r){const i=2*t.verticesCount+(1+a5(n))*t.geometriesCount+t.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,ad(l.flatCoordss[c],0,s.length,2,r,s),o+=Wz(e,n,l,o),e[o++]=l.ringsVerticesCounts[c].length;for(let h=0,f=l.ringsVerticesCounts[c].length;h<f;h++)e[o++]=l.ringsVerticesCounts[c][h];for(let h=0,f=s.length;h<f;h+=2)e[o++]=s[h],e[o++]=s[h+1]}}return e}function _3(t){return(JSON.stringify(t).split("").reduce((n,r)=>(n<<5)-n+r.charCodeAt(0),0)>>>0).toString()}function Hz(t,e,n,r){if(`${r}radius`in t&&r!=="icon-"){let i=Tn(n,t[`${r}radius`],Wt);if(`${r}radius2`in t){const s=Tn(n,t[`${r}radius2`],Wt);i=`max(${i}, ${s})`}`${r}stroke-width`in t&&(i=`(${i} + ${Tn(n,t[`${r}stroke-width`],Wt)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in t){const i=Tn(n,t[`${r}scale`],Kc);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in t&&e.setSymbolOffsetExpression(Tn(n,t[`${r}displacement`],bl)),`${r}rotation`in t&&e.setSymbolRotationExpression(Tn(n,t[`${r}rotation`],Wt)),`${r}rotate-with-view`in t&&e.setSymbolRotateWithView(!!t[`${r}rotate-with-view`])}function cle(t,e,n,r,i){let s="vec4(0.)";if(e!==null&&(s=e),n!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${t})`;s=`mix(${n}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${t}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return i!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${i})`),a}function qz(t,e,n,r,i){const s=new Image;s.crossOrigin=t[`${r}cross-origin`]===void 0?"anonymous":t[`${r}cross-origin`],or(typeof t[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=t[`${r}src`],n[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const o=`u_texture${i}_size`;return n[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),o}function Kz(t,e,n,r,i){let s=Tn(n,t[`${e}offset`],Kc);if(`${e}offset-origin`in t)switch(t[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function $Ie(t,e,n,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,Hz(t,e,r,"circle-");let i=null;"circle-opacity"in t&&(i=Tn(r,t["circle-opacity"],Wt));let s="coordsPx";"circle-scale"in t&&(s=`coordsPx / ${Tn(r,t["circle-scale"],Kc)}`);let o=null;"circle-fill-color"in t&&(o=Tn(r,t["circle-fill-color"],xi));let a=null;"circle-stroke-color"in t&&(a=Tn(r,t["circle-stroke-color"],xi));let l=Tn(r,t["circle-radius"],Wt),c=null;"circle-stroke-width"in t&&(c=Tn(r,t["circle-stroke-width"],Wt),l=`(${l} + ${c} * 0.5)`);const u=`circleDistanceField(${s}, ${l})`,h=cle(u,o,a,c,i);e.setSymbolColorExpression(h)}function jIe(t,e,n,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,Hz(t,e,r,"shape-");let i=null;"shape-opacity"in t&&(i=Tn(r,t["shape-opacity"],Wt));let s="coordsPx";"shape-scale"in t&&(s=`coordsPx / ${Tn(r,t["shape-scale"],Kc)}`);let o=null;"shape-fill-color"in t&&(o=Tn(r,t["shape-fill-color"],xi));let a=null;"shape-stroke-color"in t&&(a=Tn(r,t["shape-stroke-color"],xi));let l=null;"shape-stroke-width"in t&&(l=Tn(r,t["shape-stroke-width"],Wt));const c=Tn(r,t["shape-points"],Wt);let u="0.";"shape-angle"in t&&(u=Tn(r,t["shape-angle"],Wt));let h,f=Tn(r,t["shape-radius"],Wt);if(l!==null&&(f=`${f} + ${l} * 0.5`),"shape-radius2"in t){let v=Tn(r,t["shape-radius2"],Wt);l!==null&&(v=`${v} + ${l} * 0.5`),h=`starDistanceField(${s}, ${c}, ${f}, ${v}, ${u})`}else h=`regularDistanceField(${s}, ${c}, ${f}, ${u})`;const g=cle(h,o,a,l,i);e.setSymbolColorExpression(g)}function FIe(t,e,n,r){let i="vec4(1.0)";"icon-color"in t&&(i=Tn(r,t["icon-color"],xi)),"icon-opacity"in t&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${Tn(r,t["icon-opacity"],Wt)})`);const s=_3(t["icon-src"]),o=qz(t,e,n,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in t&&"icon-height"in t&&e.setSymbolSizeExpression(`vec2(${Tn(r,t["icon-width"],Wt)}, ${Tn(r,t["icon-height"],Wt)})`),"icon-offset"in t&&"icon-size"in t){const a=Tn(r,t["icon-size"],bl),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(a);const c=Kz(t,"icon-",r,"v_quadSizePx",a);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(Hz(t,e,r,"icon-"),"icon-anchor"in t){const a=Tn(r,t["icon-anchor"],bl);let l="1.0";"icon-scale"in t&&(l=Tn(r,t["icon-scale"],Kc));let c;t["icon-anchor-x-units"]==="pixels"&&t["icon-anchor-y-units"]==="pixels"?c=`${a} * ${l}`:t["icon-anchor-x-units"]==="pixels"?c=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:t["icon-anchor-y-units"]==="pixels"?c=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${a} * v_quadSizePx`;let u=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in t)switch(t["icon-anchor-origin"]){case"top-right":u=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":u=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":u=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${u}`)}}function VIe(t,e,n,r){if("stroke-color"in t&&e.setStrokeColorExpression(Tn(r,t["stroke-color"],xi)),"stroke-pattern-src"in t){const i=_3(t["stroke-pattern-src"]),s=qz(t,e,n,"stroke-pattern-",i);let o=s,a="vec2(0.)";"stroke-pattern-offset"in t&&"stroke-pattern-size"in t&&(o=Tn(r,t["stroke-pattern-size"],bl),a=Kz(t,"stroke-pattern-",r,s,o));let l="0.";"stroke-pattern-spacing"in t&&(l=Tn(r,t["stroke-pattern-spacing"],Wt));let c="0.";"stroke-pattern-start-offset"in t&&(c=Tn(r,t["stroke-pattern-start-offset"],Wt)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const u=`u_texture${i}`;let h="1.";"stroke-color"in t&&(h=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${h} * sampleStrokePattern(${u}, ${s}, ${a}, ${o}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${o}, ${l}, v_width)`)}if("stroke-width"in t&&e.setStrokeWidthExpression(Tn(r,t["stroke-width"],Wt)),"stroke-offset"in t&&e.setStrokeOffsetExpression(Tn(r,t["stroke-offset"],Wt)),"stroke-line-cap"in t&&e.setStrokeCapExpression(Tn(r,t["stroke-line-cap"],$s)),"stroke-line-join"in t&&e.setStrokeJoinExpression(Tn(r,t["stroke-line-join"],$s)),"stroke-miter-limit"in t&&e.setStrokeMiterLimitExpression(Tn(r,t["stroke-miter-limit"],Wt)),"stroke-line-dash"in t){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${Rf("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${Rf("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=t["stroke-line-dash"].map(v=>Tn(r,v,Wt));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in t&&(s=Tn(r,t["stroke-line-dash-offset"],Wt));const a=`dashDistanceField_${_3(t["stroke-line-dash"])}`,l=i.map((v,x)=>`float dashLength${x}`).join(", "),c=i.map((v,x)=>`dashLength${x}`).join(" + ");let u="0.",h=`getSingleDashDistance(distance, radius, ${u}, dashLength0, totalDashLength, capType, lineWidth)`;for(let v=2;v<i.length;v+=2)u=`${u} + dashLength${v-2} + dashLength${v-1}`,h=`min(${h}, getSingleDashDistance(distance, radius, ${u}, dashLength${v}, totalDashLength, capType, lineWidth))`;r.functions[a]=`float ${a}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${h};
}`;const f=i.map((v,x)=>`${v}`).join(", ");e.setStrokeDistanceFieldExpression(`${a}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${f})`);let g=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,g=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${g})`),e.setStrokePatternLengthExpression(g)}}function zIe(t,e,n,r){if("fill-color"in t&&e.setFillColorExpression(Tn(r,t["fill-color"],xi)),"fill-pattern-src"in t){const i=_3(t["fill-pattern-src"]),s=qz(t,e,n,"fill-pattern-",i);let o=s,a="vec2(0.)";"fill-pattern-offset"in t&&"fill-pattern-size"in t&&(o=Tn(r,t["fill-pattern-size"],bl),a=Kz(t,"fill-pattern-",r,s,o)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in t&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function vX(t,e,n){const r=nle(),i=new lle,s={};if("icon-src"in t?FIe(t,i,s,r):"shape-points"in t?jIe(t,i,s,r):"circle-radius"in t&&$Ie(t,i,s,r),VIe(t,i,s,r),zIe(t,i,s,r),n){const l=Tn(r,n,Es);i.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,c,u,h){if(!r[l])return;const f=cj(u),g=Bz(u);i.addAttribute(`a_${c}`,f),o[c]={size:g,callback:h}}return a("geometryType",ile,$s,l=>tk(Pz(l.getGeometry()))),a("featureId",rle,$s|Wt,l=>{const c=l.getId()??null;return typeof c=="string"?tk(c):c}),sle(i,r),{builder:i,attributes:{...o,...ale(r)},uniforms:{...s,...ole(r,e)}}}const UIe=[];let d6;function GIe(){return d6||(d6=MIe()),d6}let BIe=0;const Ec={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class WIe{constructor(e,n,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=HIe(e,n),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return CIe(this.ref,UIe)},size:2});for(const s of this.styleShaders){for(const o in s.attributes)o in this.customAttributes_||(this.customAttributes_[o]=s.attributes[o]);for(const o in s.uniforms)o in this.uniforms_||(this.uniforms_[o]=s.uniforms[o])}this.renderPasses_=this.styleShaders.map(s=>{const o={},a=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:wo.FLOAT}));return s.builder.getFillVertexShader()&&(o.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:Ec.POSITION,size:2,type:wo.FLOAT},...a],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(o.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:Ec.LOCAL_POSITION,size:2,type:wo.FLOAT}],instancedAttributesDesc:[{name:Ec.SEGMENT_START,size:2,type:wo.FLOAT},{name:Ec.MEASURE_START,size:1,type:wo.FLOAT},{name:Ec.SEGMENT_END,size:2,type:wo.FLOAT},{name:Ec.MEASURE_END,size:1,type:wo.FLOAT},{name:Ec.JOIN_ANGLES,size:2,type:wo.FLOAT},{name:Ec.DISTANCE_LOW,size:1,type:wo.FLOAT},{name:Ec.DISTANCE_HIGH,size:1,type:wo.FLOAT},{name:Ec.ANGLE_TANGENT_SUM,size:1,type:wo.FLOAT},...a],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(o.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:Ec.LOCAL_POSITION,size:2,type:wo.FLOAT}],instancedAttributesDesc:[{name:Ec.POSITION,size:2,type:wo.FLOAT},...a],instancePrimitiveVertexCount:6}),o}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,n){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,n),[i,s,o]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",n),this.generateBuffersForType_(r.lineStringInstructions,"LineString",n),this.generateBuffersForType_(r.pointInstructions,"Point",n)]),a=HT(js(),n);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:o,invertVerticesTransform:a}}generateRenderInstructions_(e,n){const r=this.hasFill_?DIe(e.polygonBatch,new Float32Array(0),this.customAttributes_,n):null,i=this.hasStroke_?LIe(e.lineStringBatch,new Float32Array(0),this.customAttributes_,n):null,s=this.hasSymbol_?OIe(e.pointBatch,new Float32Array(0),this.customAttributes_,n):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,n,r){if(e===null)return null;const i=BIe++;let s;switch(n){case"Polygon":s=h6.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=h6.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=h6.GENERATE_POINT_BUFFERS;break}const o={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:a5(this.customAttributes_)},a=GIe();return a.postMessage(o,[e.buffer]),e=null,new Promise(l=>{const c=u=>{const h=u.data;if(h.id!==i||(a.removeEventListener("message",c),!this.helper_.getGL()))return;const f=new s6($z,i6).fromArrayBuffer(h.indicesBuffer),g=new s6(p3,i6).fromArrayBuffer(h.vertexAttributesBuffer),v=new s6(p3,i6).fromArrayBuffer(h.instanceAttributesBuffer);this.helper_.flushBufferData(f),this.helper_.flushBufferData(g),this.helper_.flushBufferData(v),l([f,g,v])};a.addEventListener("message",c)})}render(e,n,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,n,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,n,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,n,r)}renderInternal_(e,n,r,i,s,o){const a=e.getSize();if(a===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(n),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),o(),l){const c=i.instancedAttributesDesc.reduce((h,f)=>h+(f.size||1),0),u=r.getSize()/c;this.helper_.drawElementsInstanced(0,a,u)}else this.helper_.drawElements(0,a)}setHelper(e,n=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),n&&(n.polygonBuffers&&(this.helper_.flushBufferData(n.polygonBuffers[0]),this.helper_.flushBufferData(n.polygonBuffers[1]),this.helper_.flushBufferData(n.polygonBuffers[2])),n.lineStringBuffers&&(this.helper_.flushBufferData(n.lineStringBuffers[0]),this.helper_.flushBufferData(n.lineStringBuffers[1]),this.helper_.flushBufferData(n.lineStringBuffers[2])),n.pointBuffers&&(this.helper_.flushBufferData(n.pointBuffers[0]),this.helper_.flushBufferData(n.pointBuffers[1]),this.helper_.flushBufferData(n.pointBuffers[2])))}}function HIe(t,e){const n=Array.isArray(t)?t:[t];if("style"in n[0]){const r=[],i=n,s=[];for(const o of i){const a=Array.isArray(o.style)?o.style:[o.style];let l=o.filter;o.else&&s.length&&(l=["all",...s.map(u=>["!",u])],o.filter&&l.push(o.filter),l.length<3&&(l=l[1])),o.filter&&s.push(o.filter);const c=a.map(u=>vX(u,e,l));r.push(...c)}return r}return"builder"in n[0]?n:n.map(r=>vX(r,e,null))}const Ch=new Uint8Array(4);class qIe{constructor(e,n){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=n||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){pp(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,n=this.helper_.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.readPixels(0,0,e[0],e[1],n.RGBA,n.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,n){if(e<0||n<0||e>this.size_[0]||n>=this.size_[1])return Ch[0]=0,Ch[1]=0,Ch[2]=0,Ch[3]=0,Ch;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(n)-1)*this.size_[0];return Ch[0]=this.data_[r*4],Ch[1]=this.data_[r*4+1],Ch[2]=this.data_[r*4+2],Ch[3]=this.data_[r*4+3],Ch}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,n=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.viewport(0,0,e[0],e[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture_,0),n.bindRenderbuffer(n.RENDERBUFFER,this.depthbuffer_),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e[0],e[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function KIe(t,e){const n=t.viewState.projection,i=e.getSource().getWrapX()&&n.canWrapX(),s=n.getExtent(),o=t.extent,a=i?Gn(s):null,l=i?Math.ceil((o[2]-s[2])/a)+1:1;return[i?Math.floor((o[0]-s[0])/a):0,l,a]}const e_={...lf,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class YIe extends Vz{constructor(e,n){const r={[e_.RENDER_EXTENT]:[0,0,0,0],[e_.PATTERN_ORIGIN]:[0,0],[e_.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:n.postProcesses}),this.hitDetectionEnabled_=!n.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=wl(),this.currentTransform_=js(),this.tmpCoords_=[0,0],this.tmpTransform_=js(),this.tmpMat4_=qae(),this.currentFrameStateTransform_=js(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(n),this.batch_=new v3,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const n=this.getLayer().getSource();let r;this.batch_.addFeatures(n.getFeatures(),r),this.sourceListenKeys_=[Hn(n,Xo.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),Hn(n,Xo.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),Hn(n,Xo.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),Hn(n,Xo.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new WIe(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new qIe(this.helper))}handleSourceFeatureAdded_(e,n){const r=n.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,n){const r=n.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const n=e.feature;this.batch_.removeFeature(n)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){eae(this.tmpTransform_,this.currentFrameStateTransform_),Qoe(this.tmpTransform_,e),this.helper.setUniformMatrixValue(e_.PROJECTION_MATRIX,oj(this.tmpMat4_,this.tmpTransform_)),HT(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(e_.SCREEN_TO_WORLD_MATRIX,oj(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,HT(this.tmpTransform_,e),Ki(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(e_.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const n=this.helper.getGL();this.preRender(n,e);const[r,i,s]=KIe(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(n,e),o}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const n=this.getLayer(),r=n.getSource(),i=e.viewState,s=!e.viewHints[ws.ANIMATING]&&!e.viewHints[ws.INTERACTING],o=!h1(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),s&&(o||a)){const l=i.projection,c=i.resolution,u=n instanceof s5?n.getRenderBuffer():0,h=Gf(e.extent,u*c);r.loadFeatures(h,c,l),this.ready=!1;const f=this.helper.makeProjectionTransform(e,js());this.styleRenderer_.generateBuffers(this.batch_,f).then(g=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=g,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,n,r,i,s){let o=r;n&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),vTe(this.currentFrameStateTransform_,o*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(n)});while(++o<i)}forEachFeatureAtCoordinate(e,n,r,i,s){if(or(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const o=Ki(n.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],c=NIe(l),u=this.batch_.getFeatureFromRef(c);if(u)return i(u,this.getLayer(),null)}disposeBuffers(e){const n=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&n(e.pointBuffers),e.lineStringBuffers&&n(e.lineStringBuffers),e.polygonBuffers&&n(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){Jr(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const Qd={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},XIe=["#00f","#0ff","#0f0","#ff0","#f00"];class ZIe extends s5{constructor(e){e=e||{};const n=Object.assign({},e);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,super(n),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(Qd.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:XIe),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(Qd.BLUR)}getGradient(){return this.get(Qd.GRADIENT)}getRadius(){return this.get(Qd.RADIUS)}handleGradientChanged_(){this.gradient_=JIe(this.getGradient())}setBlur(e){const n=this.get(Qd.BLUR);if(this.set(Qd.BLUR,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(Qd.GRADIENT,e)}setRadius(e){const n=this.get(Qd.RADIUS);if(this.set(Qd.RADIUS,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new lle,n=nle(),r=Tn(n,this.filter_,Es);let i=Tn(n,this.getRadius(),Wt),s=Tn(n,this.getBlur(),Wt);const o={};typeof this.getBlur()=="number"&&(s="a_blur",o.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",o.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const a={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const h=typeof this.weight_=="string"?f=>f.get(this.weight_):this.weight_;a.prop_weight={size:1,callback:f=>{const g=h(f);return g!==void 0?ii(g,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const h=["clamp",this.weight_,0,1];l=Tn(n,h,Wt)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),sle(e,n);const c=ale(n),u=ole(n,this.styleVariables_);return new YIe(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...a},uniforms:{...u,...o}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function JIe(t){const r=Ts(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(t.length-1);for(let o=0,a=t.length;o<a;++o)i.addColorStop(o*s,t[o]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}class QIe extends Az{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const n=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(n.extent!==void 0&&(l=Bf(l,nd(n.extent,i.projection))),!a[ws.ANIMATING]&&!a[ws.INTERACTING]&&!C2(l))if(o){const c=i.projection,u=o.getImage(l,s,r,c);u&&(this.loadImage(u)?this.image=u:u.getState()===Vt.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=Ki(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!u1(s,i))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=Gn(o),c=Math.floor(a.width*((i[0]-o[0])/l));if(c<0||c>=a.width)return null;const u=cs(o),h=Math.floor(a.height*((o[3]-i[1])/u));return h<0||h>=a.height?null:this.getImageData(a,c,h)}renderFrame(e,n){const r=this.image,i=r.getExtent(),s=r.getResolution(),[o,a]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],u=e.pixelRatio,h=e.viewState,f=h.center,g=h.resolution,v=u*o/(g*l),x=u*a/(g*l);this.prepareContainer(e,n);const b=this.context.canvas.width,T=this.context.canvas.height,A=this.getRenderContext(e);let I=!1,R=!0;if(c.extent){const O=nd(c.extent,h.projection);R=Ia(O,e.extent),I=R&&!zm(O,e.extent),I&&this.clipUnrotated(A,e,O)}const C=r.getImage(),V=iu(this.tempTransform,b/2,T/2,v,x,0,l*(i[0]-f[0])/o,l*(f[1]-i[3])/a);this.renderedResolution=a*u/l;const M=C.width*V[0],N=C.height*V[3];if(this.getLayer().getSource().getInterpolate()||(A.imageSmoothingEnabled=!1),this.preRender(A,e),R&&M>=.5&&N>=.5){const O=V[4],F=V[5],L=c.opacity;L!==1&&(A.save(),A.globalAlpha=L),A.drawImage(C,0,0,+C.width,+C.height,O,F,M,N),L!==1&&A.restore()}return this.postRender(this.context,e),I&&A.restore(),A.imageSmoothingEnabled=!0,this.container}}class eRe extends AA{constructor(e){e=e||{},super(e)}}class tRe extends eRe{constructor(e){super(e)}createRenderer(){return new QIe(this)}getData(e){return super.getData(e)}}function f6(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function nRe(t,e,n){const r=t[n];return r?r.delete(e):!1}function _X(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=Bf(e,nd(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=Bf(e,i))}return e}class rRe extends Az{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=wl(),this.tempTileRange_=new Fz(0,0,0,0),this.tempTileCoord_=y3(0,0,0);const r=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new gX(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new gX(512)),this.sourceTileCache_}getOrCreateTile(e,n,r,i){const s=this.tileCache_,a=this.getLayer().getSource(),l=xM(a,a.getKey(),e,n,r);let c;if(s.containsKey(l))c=s.get(l);else{const u=i.viewState.projection,h=a.getProjection();if(c=a.getTile(e,n,r,i.pixelRatio,u,!h||Uy(h,u)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,n,r,i){const s=this.getOrCreateTile(e,n,r,i);return s||null}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=Ki(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!u1(s,i))return null;const o=n.viewState,a=r.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(n.pixelRatio);for(let u=l.getZForResolution(o.resolution);u>=l.getMinZoom();--u){const h=l.getTileCoordForCoordAndZ(i,u),f=this.getTile(u,h[1],h[2],n);if(!f||f.getState()!==ln.LOADED)continue;const g=l.getOrigin(u),v=Ma(l.getTileSize(u)),x=l.getResolution(u);let b;if(f instanceof Xae||f instanceof ele)b=f.getImage();else if(f instanceof fX){if(b=aj(f.getData()),!b)continue}else continue;const T=Math.floor(c*((i[0]-g[0])/x-h[1]*v[0])),A=Math.floor(c*((g[1]-i[1])/x-h[2]*v[1])),I=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(b,T+I,A+I)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const r=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,r,i,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),u=_n(l);u in e.wantedTiles||(e.wantedTiles[u]={});const h=e.wantedTiles[u],f=a.getMapInternal(),g=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),v=o.rotation,x=v?Foe(o.center,o.resolution,v,e.size):void 0;for(let b=r;b>=g;--b){const T=c.getTileRangeForExtentAndZ(n,b,this.tempTileRange_),A=c.getResolution(b);for(let I=T.minX;I<=T.maxX;++I)for(let R=T.minY;R<=T.maxY;++R){if(v&&!c.tileCoordIntersectsViewport([b,I,R],x))continue;const C=this.getTile(b,I,R,e);if(!C||!f6(i,C,b))continue;const M=C.getKey();if(h[M]=!0,C.getState()===ln.IDLE&&!e.tileQueue.isKeyQueued(M)){const N=y3(b,I,R,this.tempTileCoord_);e.tileQueue.enqueue([C,u,c.getTileCoordCenter(N),A])}}}}findStaleTile_(e,n){const r=this.tileCache_,i=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=xM(this.getLayer().getSource(),a[l],i,s,o);if(r.containsKey(c)){const u=r.peek(c);if(u.getState()===ln.LOADED)return u.endTransition(_n(this)),f6(n,u,i),!0}}return!1}findAltTiles_(e,n,r,i){const s=e.getTileRangeForTileCoordAndZ(n,r,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let u=s.minX;u<=s.maxX;++u)for(let h=s.minY;h<=s.maxY;++h){const f=xM(l,c,r,u,h);let g=!1;if(a.containsKey(f)){const v=a.peek(f);v.getState()===ln.LOADED&&(f6(i,v,r),g=!0)}g||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,o=i.resolution,a=i.center,l=e.pixelRatio,c=this.getLayer(),u=c.getSource(),h=u.getTileGridForProjection(s),f=h.getZForResolution(o,u.zDirection),g=h.getResolution(f),v=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==v&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=v):this.renderedSourceKey_=v;let x=e.extent;const b=u.getTilePixelRatio(l);this.prepareContainer(e,n);const T=this.context.canvas.width,A=this.context.canvas.height,I=r.extent&&nd(r.extent);I&&(x=Bf(x,nd(r.extent)));const R=g*T/2/b,C=g*A/2/b,V=[a[0]-R,a[1]-C,a[0]+R,a[1]+C],M={};this.renderedTiles.length=0;const N=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const fe=h.getZForResolution(i.nextResolution,u.zDirection),$e=_X(e,e.nextExtent);this.enqueueTiles(e,$e,fe,M,N)}const O=_X(e,x);if(this.enqueueTiles(e,O,f,M,0),N>0&&setTimeout(()=>{this.enqueueTiles(e,O,f-1,M,N-1)},0),!(f in M))return this.container;const F=_n(this),L=e.time;for(const fe of M[f]){const $e=fe.getState();if($e===ln.EMPTY)continue;const Ce=fe.tileCoord;if($e===ln.LOADED&&fe.getAlpha(F,L)===1){fe.endTransition(F);continue}if($e!==ln.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Ce,M)){nRe(M,fe,f),e.animate=!0;continue}if(this.findAltTiles_(h,Ce,f+1,M))continue;const ne=h.getMinZoom();for(let se=f-1;se>=ne&&!this.findAltTiles_(h,Ce,se,M);--se);}const B=g/o*l/b,U=this.getRenderContext(e);iu(this.tempTransform,T/2,A/2,B,B,0,-T/2,-A/2),r.extent&&this.clipUnrotated(U,e,I),u.getInterpolate()||(U.imageSmoothingEnabled=!1),this.preRender(U,e);const de=Object.keys(M).map(Number);de.sort(Uf);let me;const ze=[],Le=[];for(let fe=de.length-1;fe>=0;--fe){const $e=de[fe],Ce=u.getTilePixelSize($e,l,s),W=h.getResolution($e)/g,ne=Ce[0]*W*B,se=Ce[1]*W*B,ae=h.getTileCoordForCoordAndZ(q1(V),$e),_e=h.getTileCoordExtent(ae),Ke=Ki(this.tempTransform,[b*(_e[0]-V[0])/g,b*(V[3]-_e[3])/g]),Ye=b*u.getGutterForProjection(s);for(const ke of M[$e]){if(ke.getState()!==ln.LOADED)continue;const Te=ke.tileCoord,Dt=ae[1]-Te[1],qe=Math.round(Ke[0]-(Dt-1)*ne),sn=ae[2]-Te[2],$t=Math.round(Ke[1]-(sn-1)*se),fn=Math.round(Ke[0]-Dt*ne),yn=Math.round(Ke[1]-sn*se),dt=qe-fn,lr=$t-yn,$n=de.length===1;let Un=!1;me=[fn,yn,fn+dt,yn,fn+dt,yn+lr,fn,yn+lr];for(let Xr=0,fo=ze.length;Xr<fo;++Xr)if(!$n&&$e<Le[Xr]){const kr=ze[Xr];Ia([fn,yn,fn+dt,yn+lr],[kr[0],kr[3],kr[4],kr[7]])&&(Un||(U.save(),Un=!0),U.beginPath(),U.moveTo(me[0],me[1]),U.lineTo(me[2],me[3]),U.lineTo(me[4],me[5]),U.lineTo(me[6],me[7]),U.moveTo(kr[6],kr[7]),U.lineTo(kr[4],kr[5]),U.lineTo(kr[2],kr[3]),U.lineTo(kr[0],kr[1]),U.clip())}ze.push(me),Le.push($e),this.drawTile(ke,e,fn,yn,dt,lr,Ye,$n),Un&&U.restore(),this.renderedTiles.unshift(ke),this.updateUsedTiles(e.usedTiles,u,ke)}}if(this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!h1(this.renderedExtent_,V),this.renderedExtent_=V,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&U.restore(),U.imageSmoothingEnabled=!0,this.renderComplete){const fe=($e,Ce)=>{const le=_n(u),W=Ce.wantedTiles[le],ne=W?Object.keys(W).length:0;this.updateCacheSize(ne),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};e.postRenderFunctions.push(fe)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,r,i,s,o,a,l){let c;if(e instanceof fX){if(c=aj(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const u=this.getRenderContext(n),h=_n(this),f=n.layerStatesArray[n.layerIndex],g=f.opacity*(l?e.getAlpha(h,n.time):1),v=g!==u.globalAlpha;v&&(u.save(),u.globalAlpha=g),u.drawImage(c,a,a,c.width-2*a,c.height-2*a,r,i,s,o),v&&u.restore(),g!==f.opacity?n.animate=!0:l&&e.endTransition(h)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,r){const i=_n(n);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const eP={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class iRe extends AA{constructor(e){e=e||{};const n=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(eP.PRELOAD)}setPreload(e){this.set(eP.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(eP.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(eP.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class Am extends iRe{constructor(e){super(e)}createRenderer(){return new rRe(this,{cacheSize:this.getCacheSize()})}}function uj(t){return Array.isArray(t)?Math.min(...t):t}const t_=[0,0,0],Xp=5;class ule{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,or(PSe(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!n)n=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,or(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=q1(r)),or(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,or(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Lz,or(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const o=new Fz(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const a=this.getTileRangeForExtentAndZ(r,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,n,r){const i=this.getTileRangeForExtentAndZ(e,n);for(let s=i.minX,o=i.maxX;s<=o;++s)for(let a=i.minY,l=i.maxY;a<=l;++a)r([n,s,a])}forEachTileCoordParentTileRange(e,n,r,i){let s,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Zv(o,o,a,a,r)):s=this.getTileRangeForExtentAndZ(l,c,r),n(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return Zv(s,s+1,o,o+1,n)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,r){if(n>this.maxZoom||n<this.minZoom)return null;const i=e[0],s=e[1],o=e[2];if(n===i)return Zv(s,o,s,o,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,n-i),c=Math.floor(s*l),u=Math.floor(o*l);if(n<i)return Zv(c,c,u,u,r);const h=Math.floor(l*(s+1))-1,f=Math.floor(l*(o+1))-1;return Zv(c,h,u,f,r)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,n,r)}getTileRangeForExtentAndZ(e,n,r){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,t_);const i=t_[1],s=t_[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,t_);const o=t_[1],a=t_[2];return Zv(i,o,s,a,r)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Ma(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*i[0]*r,n[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,n){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Ma(this.getTileSize(e[0]),this.tmpSize_),o=r[0]+e[1]*s[0]*i,a=r[1]-(e[2]+1)*s[1]*i,l=o+s[0]*i,c=a+s[1]*i;return Eg(o,a,l,c,n)}getTileCoordForCoordAndResolution(e,n,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,r)}getTileCoordForXYAndResolution_(e,n,r,i,s){const o=this.getZForResolution(r),a=r/this.getResolution(o),l=this.getOrigin(o),c=Ma(this.getTileSize(o),this.tmpSize_);let u=a*(e-l[0])/r/c[0],h=a*(l[1]-n)/r/c[1];return i?(u=Um(u,Xp)-1,h=Um(h,Xp)-1):(u=GR(u,Xp),h=GR(h,Xp)),y3(o,u,h,s)}getTileCoordForXYAndZ_(e,n,r,i,s){const o=this.getOrigin(r),a=this.getResolution(r),l=Ma(this.getTileSize(r),this.tmpSize_);let c=(e-o[0])/a/l[0],u=(o[1]-n)/a/l[1];return i?(c=Um(c,Xp)-1,u=Um(u,Xp)-1):(c=GR(c,Xp),u=GR(u,Xp)),y3(r,c,u,s)}getTileCoordForCoordAndZ(e,n,r){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const r=GN(this.resolutions_,e,n||0);return ii(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return sae(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,r=new Array(n);for(let i=this.minZoom;i<n;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function hle(t){let e=t.getDefaultTileGrid();return e||(e=lRe(t),t.setDefaultTileGrid(e)),e}function sRe(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),s=Yz(n);if(!u1(s,i)){const o=Gn(s),a=Math.ceil((s[0]-i[0])/o);return i[0]+=o*a,t.getTileCoordForCoordAndZ(i,r)}return e}function oRe(t,e,n,r){r=r!==void 0?r:"top-left";const i=dle(t,e,n);return new ule({extent:t,origin:LSe(t,r),resolutions:i,tileSize:n})}function aRe(t){const e=t||{},n=e.extent||Yr("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:dle(n,e.maxZoom,e.tileSize,e.maxResolution)};return new ule(r)}function dle(t,e,n,r){e=e!==void 0?e:WAe,n=Ma(n!==void 0?n:Lz);const i=cs(t),s=Gn(t);r=r>0?r:Math.max(s/n[0],i/n[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=r/Math.pow(2,l);return a}function lRe(t,e,n,r){const i=Yz(t);return oRe(i,e,n,r)}function Yz(t){t=Yr(t);let e=t.getExtent();if(!e){const n=180*Lw.degrees/t.getMetersPerUnit();e=Eg(-n,-n,n,n)}return e}function Xz(t,e){const n=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&n.push(i+"="+encodeURIComponent(e[i]))});const r=n.join("&");return t=t.replace(/[?&]$/,""),t+=t.includes("?")?"&":"?",t+r}const cRe=/\{z\}/g,uRe=/\{x\}/g,hRe=/\{y\}/g,dRe=/\{-y\}/g;function fRe(t,e,n,r,i){return t.replace(cRe,e.toString()).replace(uRe,n.toString()).replace(hRe,r.toString()).replace(dRe,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function pRe(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}function mRe(t,e){return(function(n,r,i){if(!n)return;let s;const o=n[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return fRe(t,o,n[1],n[2],s)})}function gRe(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=mRe(t[i],e);return yRe(r)}function yRe(t){return t.length===1?t[0]:(function(e,n,r){if(!e)return;const i=tle(e),s=og(i,t.length);return t[s](e,n,r)})}class vRe extends kz{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&Ma(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||_n(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,r,i,s,o){return xn()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:hle(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(n),o=Ma(i.getTileSize(e),this.tmpSize);return s==1?o:Nke(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const r=n!==void 0?n:this.getProjection(),i=n!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=sRe(i,e,r)),vIe(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class _Re extends Md{constructor(e,n){super(e),this.tile=n}}const p6={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class Zz extends vRe{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Zz.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,r=_n(n),i=n.getState();let s;i==ln.LOADING?(this.tileLoadingKeys_[r]=!0,s=p6.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==ln.ERROR?p6.TILELOADERROR:i==ln.LOADED?p6.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new _Re(s,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=pRe(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(gRe(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,r){}}class fle extends Zz{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ple,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Xae,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Uy(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Uy(n,e)))return this.tileGrid;const r=_n(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=hle(e)),this.tileGridForProjection[r]}createTile_(e,n,r,i,s,o){const a=[e,n,r],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,i,s):void 0,u=new this.tileClass(a,c!==void 0?ln.IDLE:ln.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(An.CHANGE,this.handleTileChange.bind(this)),u}getTile(e,n,r,i,s,o){const a=this.getProjection();if(!a||!s||Uy(a,s))return this.getTileInternal(e,n,r,i,a||s);const l=[e,n,r],c=this.getKey(),u=this.getTileGridForProjection(a),h=this.getTileGridForProjection(s),f=this.getTileCoordForTileUrlFunction(l,s),g=new ele(a,u,s,h,l,f,this.getTilePixelRatio(i),this.getGutter(),(v,x,b,T)=>this.getTileInternal(v,x,b,T,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,g}getTileInternal(e,n,r,i,s,o){const a=this.getKey(),l=xM(this,a,e,n,r);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(e,n,r,i,s,a);return o?.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const r=Yr(e);if(r){const i=_n(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=n)}}}function ple(t,e){if(tc){const n=t.getCrossOrigin();let r="same-origin",i="same-origin";n==="anonymous"||n===""?(r="cors",i="omit"):n==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=t.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class hy extends fle{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:aRe({extent:Yz(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const xRe="modulepreload",wRe=function(t){return"/detectorapp-nl/"+t},xX={},xe=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=l(n.map(c=>{if(c=wRe(c),c in xX)return;xX[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":xRe,u||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),u)return new Promise((g,v)=>{f.addEventListener("load",g),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};class bRe extends pae{constructor(e,n,r,i,s,o,a){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=n.getExtent();c&&n.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const u=c?Bf(r,c):r,h=oh(u),f=g3(e,n,h,i),g=Qae,v=new Jae(e,n,u,l,f*g,i),x=v.calculateSourceExtent(),b=C2(x)?null:o(x,f,s),T=b?Vt.IDLE:Vt.EMPTY,A=b?b.getPixelRatio():1;super(r,i,A,T),this.targetProj_=n,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=b,this.sourcePixelRatio_=A,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Vt.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Vt.LOADED){const n=Gn(this.targetExtent_)/this.targetResolution_,r=cs(this.targetExtent_)/this.targetResolution_;this.canvas_=Zae(n,r,this.sourcePixelRatio_,uj(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==Vt.IDLE){this.state=Vt.LOADING,this.changed();const e=this.sourceImage_.getState();e==Vt.LOADED||e==Vt.ERROR?this.reproject_():(this.sourceListenerKey_=Hn(this.sourceImage_,An.CHANGE,n=>{const r=this.sourceImage_.getState();(r==Vt.LOADED||r==Vt.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){Jr(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Hm=4,m6={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class ERe extends Md{constructor(e,n){super(e),this.image=n}}class SRe extends kz{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const n=this.getResolutions();if(n){const r=GN(n,e,0);e=n[r]}return e}getImage(e,n,r,i){const s=this.getProjection();if(!s||!i||Uy(s,i))return s&&(i=s),this.getImageInternal(e,n,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Uy(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==n&&h1(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new bRe(s,i,e,n,r,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,n,r,i){if(this.loader){const s=mle(e,n,r,1),o=this.findNearestResolution(n);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&zm(this.wantedExtent_,s)||zm(this.image.getExtent(),s))&&(this.wantedResolution_&&uj(this.wantedResolution_)===o||uj(this.image.getResolution())===o)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new pae(s,o,r,this.loader),this.image.addEventListener(An.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const n=e.target;let r;switch(n.getState()){case Vt.LOADING:this.loading=!0,r=m6.IMAGELOADSTART;break;case Vt.LOADED:this.loading=!1,r=m6.IMAGELOADEND;break;case Vt.ERROR:this.loading=!1,r=m6.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new ERe(r,n))}}function TRe(t,e){t.getImage().src=e}function mle(t,e,n,r){const i=e/n,s=oh(t),o=Um(Gn(t)/i,Hm),a=Um(cs(t)/i,Hm),l=Um((r-1)*o/2,Hm),c=o+2*l,u=Um((r-1)*a/2,Hm),h=a+2*u;return QC(s,i,0,[c,h])}function kRe(t,e,n,r,i,s){const o=i.getCode().split(/:(?=\d+$)/).pop(),a=n/r,l=[e3(Gn(e)/a,Hm),e3(cs(e)/a,Hm)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return Xz(c,s)}function ARe(t){const e=t.load?t.load:gae,n=Yr(t.projection||"EPSG:3857"),r=t.ratio??1.5,i=t.crossOrigin??null;return function(s,o,a){a=t.hidpi?a:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,t.params),s=mle(s,o,a,r);const c=kRe(t.url,s,o,a,n,l),u=new Image;return u.crossOrigin=i,e(u,c).then(h=>{const f=Gn(s)/h.width*a;return{image:h,extent:s,resolution:f,pixelRatio:a}})}}class IRe extends SRe{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:TRe,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,n,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=ARe({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),gae(s))})),super.getImageInternal(e,n,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const hj="1.3.0";function RRe(t,e,n,r,i){i.WIDTH=n[0],i.HEIGHT=n[1];const s=r.getAxisOrientation(),o=Uoe(i.VERSION,"1.3")>=0;i[o?"CRS":"SRS"]=r.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=a.join(","),Xz(t,i)}function PRe(t,e,n,r,i,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/n,l=[e3(Gn(t)/a,Hm),e3(cs(t)/a,Hm)];if(n!=1)switch(o){case"geoserver":const u=90*n+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+u:s.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":s.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":s.DPI=90*n;break;default:throw new Error("Unknown `serverType` configured")}return RRe(i,t,l,r,s)}function wX(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:hj,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}const MRe='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class CRe extends hy{constructor(e){e=e||{};let n;e.attributions!==void 0?n=e.attributions:n=[MRe];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:n,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!tc&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(e.tileLoadFunction||ple)(s,o)},transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}}const x3=1/0;class NRe{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,M2(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,r=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){or(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=x3?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,r=this.priorities_,i=n.length,s=n[e],o=r[e],a=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),u=c<i&&r[c]<r[l]?c:l;n[e]=n[u],r[e]=r[u],e=u}n[e]=s,r[e]=o,this.siftDown_(a,e)}siftDown_(e,n){const r=this.elements_,i=this.priorities_,s=r[n],o=i[n];for(;n>e;){const a=this.getParentIndex_(n);if(i[a]>o)r[n]=r[a],i[n]=i[a],n=a;else break}r[n]=s,i[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,r=this.priorities_;let i=0;const s=n.length;let o,a,l;for(a=0;a<s;++a)o=n[a],l=e(o),l==x3?delete this.queuedElements_[this.keyFunction_(o)]:(r[i]=l,n[i++]=o);n.length=i,r.length=i,this.heapify_()}}class ORe extends NRe{constructor(e,n){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(An.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,r=n.getState();if(r===ln.LOADED||r===ln.ERROR||r===ln.EMPTY){r!==ln.ERROR&&n.removeEventListener(An.CHANGE,this.boundHandleTileChange_);const i=n.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let r=0;for(;this.tilesLoading_<e&&r<n&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===ln.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function LRe(t,e,n,r,i){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return x3;const s=t.viewState.center,o=r[0]-s[0],a=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(o*o+a*a)/i}class DRe extends fle{constructor(e){e=e||{};const n=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=n,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=wl(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,n,r,i){const s=Yr(r),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=N2(e,s,o),c=g3(o,s,e,n),u=a.getZForResolution(c,this.zDirection),h=a.getResolution(u),f=a.getTileCoordForCoordAndZ(l,u);if(a.getResolutions().length<=f[0])return;let g=a.getTileCoordExtent(f,this.tmpExtent_);const v=this.gutter_;v!==0&&(g=Gf(g,h*v,g));const x={QUERY_LAYERS:this.params_.LAYERS};Object.assign(x,wX(this.params_,"GetFeatureInfo"),i);const b=Math.floor((l[0]-g[0])/h),T=Math.floor((g[3]-l[1])/h);return x[this.v13_?"I":"X"]=b,x[this.v13_?"J":"Y"]=T,this.getRequestUrl_(f,g,1,o||s,x)}getLegendUrl(e,n){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:hj,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n===void 0||n.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,n),Xz(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,n,r,i,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=og(tle(e),o.length);a=o[l]}return PRe(n,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const n=[];for(const r in this.params_)n[e++]=r+"-"+this.params_[r];return n.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||hj;this.v13_=Uoe(e,"1.3")>=0}tileUrlFunction(e,n,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;n!=1&&(!this.hidpi_||this.serverType_===void 0)&&(n=1);const s=i.getResolution(e[0]);let o=i.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Gf(o,s*a,o));const l=Object.assign({},wX(this.params_,"GetMap"));return this.getRequestUrl_(e,o,n,r,l)}}class P_ extends Md{constructor(e,n,r){super(e),this.map=n,this.frameState=r!==void 0?r:null}}class dm extends P_{constructor(e,n,r,i,s,o){super(e,n,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Bi={SINGLECLICK:"singleclick",CLICK:An.CLICK,DBLCLICK:An.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},dj={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class $Re extends yA{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=Hn(r,dj.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Hn(r,dj.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(An.TOUCHMOVE,this.boundHandleTouchMove_,hae?{passive:!1}:!1)}emulateClick_(e){let n=new dm(Bi.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new dm(Bi.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new dm(Bi.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const n=e,r=n.pointerId;if(n.type==Bi.POINTERUP||n.type==Bi.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==n.target){delete this.trackedTouches_[i];break}}else(n.type==Bi.POINTERDOWN||n.type==Bi.POINTERMOVE)&&(this.trackedTouches_[r]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new dm(Bi.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Jr),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new dm(Bi.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Hn(r,Bi.POINTERMOVE,this.handlePointerMove_,this),Hn(r,Bi.POINTERUP,this.handlePointerUp_,this),Hn(this.element_,Bi.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(Hn(this.element_.getRootNode(),Bi.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new dm(Bi.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new dm(Bi.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Jr(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(An.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Jr(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Jr),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const fm={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Ko={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class l5 extends Cd{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let n=0,r=this.listenerKeys.length;n<r;++n)Jr(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=e,e){const n=this.target_??e.getOverlayContainerStopEvent();this.element&&n.appendChild(this.element),this.render!==BT&&this.listenerKeys.push(Hn(e,fm.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class jRe extends l5{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:n+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=i):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(An.CLICK,this.handleClick_.bind(this),!1);const c=n+" "+EA+" "+bz+(this.collapsed_&&this.collapsible_?" "+CY:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),r=new Set(n.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!n.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(i=>Coe(()=>i))),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!pp(n,this.renderedAttributions_)){zTe(this.ulElement_);for(let i=0,s=n.length;i<s;++i){const o=document.createElement("li");o.innerHTML=n[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(CY),this.collapsed_?PY(this.collapseLabel_,this.label_):PY(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class FRe extends l5{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(An.CLICK,this.handleClick_.bind(this),!1);const a=n+" "+EA+" "+bz,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(HR)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:O2}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const r=n.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(HR);!s&&r===0?this.element.classList.add(HR):s&&r!==0&&this.element.classList.remove(HR)}this.label_.style.transform=i}this.rotation_=r}}class VRe extends l5{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=i,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener(An.CLICK,this.handleClick_.bind(this,r),!1);const h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=c,h.appendChild(typeof a=="string"?document.createTextNode(a):a),h.addEventListener(An.CLICK,this.handleClick_.bind(this,-r),!1);const f=n+" "+EA+" "+bz,g=this.element;g.className=f,g.appendChild(u),g.appendChild(h),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:O2})):r.setZoom(s)}}}function zRe(t){t=t||{};const e=new Hc;return(t.zoom===void 0||t.zoom)&&e.push(new VRe(t.zoomOptions)),(t.rotate===void 0||t.rotate)&&e.push(new FRe(t.rotateOptions)),(t.attribution===void 0||t.attribution)&&e.push(new jRe(t.attributionOptions)),e}class URe{constructor(e,n,r){this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let r=n-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[n+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[n]-this.points_[r],o=this.points_[n+1]-this.points_[r+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const bX={ACTIVE:"active"};class IA extends Cd{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(bX.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(bX.ACTIVE,e)}setMap(e){this.map_=e}}function GRe(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:VAe,center:t.getConstrainedCenter(i)})}}function Jz(t,e,n,r){const i=t.getZoom();if(i===void 0)return;const s=t.getConstrainedZoom(i+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:r!==void 0?r:250,easing:O2})}class BRe extends IA{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==Bi.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,o=r.shiftKey?-this.delta_:this.delta_,a=i.getView();Jz(a,o,s,this.duration_),r.preventDefault(),n=!0}return!n}}function fj(t){const e=arguments;return function(n){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](n),!!r);++i);return r}}const WRe=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},HRe=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)},gle=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?HRe(t):!0},qRe=GT,yle=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(FTe&&cae&&e.ctrlKey)},vle=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},KRe=function(t){const e=t.originalEvent;return cae?e.metaKey:e.ctrlKey},YRe=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},_le=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},g6=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},XRe=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class RA extends IA{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Bi.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Bi.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Bi.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,n=this.stopDown(r)}else e.type==Bi.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Qz(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}class ZRe extends RA{constructor(e){super({stopDown:BN}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:fj(vle,XRe);this.condition_=e.onFocusOnly?fj(gle,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const r=this.targetPointers,i=n.getEventPixel(Qz(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],a=e.map.getView();zSe(s,a.getResolution()),sz(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=r.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),l=n.getCoordinateFromPixelInternal([a[0]-i*Math.cos(s),a[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:O2})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class JRe extends RA{constructor(e){e=e||{},super({stopDown:BN}),this.condition_=e.condition?e.condition:WRe,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!g6(e))return;const n=e.map,r=n.getView();if(r.getConstraints().rotation===Oz)return;const i=n.getSize(),s=e.pixel,o=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return g6(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return g6(e)&&yle(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class QRe extends gA{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],n[0])+r,i.top=Math.min(e[1],n[1])+r,i.width=Math.abs(n[0]-e[0])+r,i.height=Math.abs(n[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new ou([i])}getGeometry(){return this.geometry_}}const n_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class sE extends Md{constructor(e,n,r){super(e),this.coordinate=n,this.mapBrowserEvent=r}}class ePe extends RA{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new QRe(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??yle,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,r){const i=r[0]-n[0],s=r[1]-n[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new sE(n_.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new sE(n?n_.BOXEND:n_.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new sE(n_.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new sE(n_.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new sE(n_.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class tPe extends ePe{constructor(e){e=e||{};const n=e.condition?e.condition:YRe;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),o=r.getResolutionForExtentInternal(s),a=r.getResolution()/o;i=i.clone(),i.scale(a*a)}r.fitInternal(i,{duration:this.duration_,easing:O2})}}const S0={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class nPe extends IA{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return vle(n)&&_le(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==An.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==S0.DOWN||i==S0.LEFT||i==S0.RIGHT||i==S0.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;i==S0.DOWN?c=-a:i==S0.LEFT?l=-a:i==S0.RIGHT?l=a:c=a;const u=[l,c];sz(u,o.getRotation()),GRe(o,u,this.duration_),r.preventDefault(),n=!0}}return!n}}class rPe extends IA{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!KRe(n)&&_le(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==An.KEYDOWN||e.type==An.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,o=i==="+"?this.delta_:-this.delta_,a=s.getView();Jz(a,o,void 0,this.duration_),r.preventDefault(),n=!0}}return!n}}const iPe=40,sPe=300;class oPe extends IA{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:qRe;this.condition_=e.onFocusOnly?fj(gle,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==An.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=iPe;break;case WheelEvent.DOM_DELTA_PAGE:s*=sPe;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=r.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let r=-ii(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),Jz(n,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class aPe extends RA{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=BN),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==Oz&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Qz(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class lPe extends RA{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=BN),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,o=r.clientY-i.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Qz(this.targetPointers))),l.render(),c.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function cPe(t){t=t||{};const e=new Hc,n=new URe(-.005,.05,100);return(t.altShiftDragRotate===void 0||t.altShiftDragRotate)&&e.push(new JRe),(t.doubleClickZoom===void 0||t.doubleClickZoom)&&e.push(new BRe({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan===void 0||t.dragPan)&&e.push(new ZRe({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate===void 0||t.pinchRotate)&&e.push(new aPe),(t.pinchZoom===void 0||t.pinchZoom)&&e.push(new lPe({duration:t.zoomDuration})),(t.keyboard===void 0||t.keyboard)&&(e.push(new nPe),e.push(new rPe({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom===void 0||t.mouseWheelZoom)&&e.push(new oPe({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom===void 0||t.shiftDragZoom)&&e.push(new tPe({duration:t.zoomDuration})),e}class uPe extends gA{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){xn()}calculateMatrices2D(e){const n=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;iu(r,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),HT(i,r)}forEachFeatureAtCoordinate(e,n,r,i,s,o,a,l){let c;const u=n.viewState;function h(R,C,V,M){return s.call(o,C,R?V:null,M)}const f=u.projection,g=Goe(e.slice(),f),v=[[0,0]];if(f.canWrapX()&&i){const R=f.getExtent(),C=Gn(R);v.push([-C,0],[C,0])}const x=n.layerStatesArray,b=x.length,T=[],A=[];for(let R=0;R<v.length;R++)for(let C=b-1;C>=0;--C){const V=x[C],M=V.layer;if(M.hasRenderer()&&Dz(V,u)&&a.call(l,M)){const N=M.getRenderer(),O=M.getSource();if(N&&O){const F=O.getWrapX()?g:e,L=h.bind(null,V.managed);A[0]=F[0]+v[R][0],A[1]=F[1]+v[R][1],c=N.forEachFeatureAtCoordinate(A,n,r,L,T)}if(c)return c}}if(T.length===0)return;const I=1/T.length;return T.forEach((R,C)=>R.distanceSq+=C*I),T.sort((R,C)=>R.distanceSq-C.distanceSq),T.some(R=>c=R.callback(R.feature,R.layer,R.geometry)),c}hasFeatureAtCoordinate(e,n,r,i,s,o){return this.forEachFeatureAtCoordinate(e,n,r,i,GT,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){xn()}scheduleExpireIconCache(e){qc.canExpireCache()&&e.postRenderFunctions.push(hPe)}}function hPe(t,e){qc.expire()}class dPe extends uPe{constructor(e){super(e),this.fontChangeListenerKey_=Hn(A_,Ow.PROPERTYCHANGE,e.redrawText,e),this.element_=tc?dae():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=EA+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const r=this.getMap();if(r.hasListener(e)){const i=new $S(e,void 0,n);r.dispatchEvent(i)}}disposeInternal(){Jr(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(no.PRECOMPOSE,e);const n=e.layerStatesArray.sort((c,u)=>c.zIndex-u.zIndex);n.some(c=>c.layer instanceof s5&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let o=null;for(let c=0,u=n.length;c<u;++c){const h=n[c];e.layerIndex=c;const f=h.layer,g=f.getSourceState();if(!Dz(h,i)||g!="ready"&&g!="undefined"){f.unrender();continue}const v=f.render(e,o);v&&(v!==o&&(this.children_.push(v),o=v),s.push(h))}this.declutter(e,s),UTe(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Bm(l)){const c=l.getContext("2d");for(const u of this.children_){const h=u.firstElementChild||u,f=u.style.backgroundColor;if(f&&(!Bm(h)||h.width>0)&&(c.fillStyle=f,c.fillRect(0,0,l.width,l.height)),Bm(h)&&h.width>0){const g=u.style.opacity||h.style.opacity;c.globalAlpha=g===""?1:Number(g);const v=h.style.transform;if(v)c.setTransform(...Z8(v));else{const x=parseFloat(h.style.width)/h.width,b=parseFloat(h.style.height)/h.height;c.setTransform(x,0,0,b,0,0)}c.drawImage(h,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(no.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let r=n.length-1;r>=0;--r){const i=n[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}n.forEach(r=>r.layer.renderDeferred(e))}}}function xle(t){if(t instanceof AA){t.setMapInternal(null);return}t instanceof o5&&t.getLayers().forEach(xle)}function wle(t,e){if(t instanceof AA){t.setMapInternal(e);return}if(t instanceof o5){const n=t.getLayers().getArray();for(let r=0,i=n.length;r<i;++r)wle(n[r],e)}}let fPe=class extends Cd{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=pPe(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:VTe,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=js(),this.pixelToCoordinateTransform_=js(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,tc||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,tc||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(tc?new Hc:zRe()),this.interactions=n.interactions||(tc?new Hc:cPe({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new ORe(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Ko.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Ko.VIEW,this.handleViewChanged_),this.addChangeListener(Ko.SIZE,this.handleSizeChanged_),this.addChangeListener(Ko.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const r=this;e.view&&!(e.view instanceof Qh)&&e.view.then(function(i){r.setView(new Qh(i))}),this.controls.addEventListener(ll.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(ll.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(ll.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(ll.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(ll.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(ll.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){wle(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,o=r.layerFilter!==void 0?r.layerFilter:GT,a=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,a,n,null,o,null)}getFeaturesAtPixel(e,n){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},n),r}getAllLayers(){const e=[];function n(r){r.forEach(function(i){i instanceof o5?n(i.getLayers()):e.push(i)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const i=n.layerFilter!==void 0?n.layerFilter:GT,s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,o,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],o=r.height/i[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-r.left)/s,(a.clientY-r.top)/o]}getTarget(){return this.get(Ko.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return X8(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?Ki(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Ko.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Hc){n.setLayers(e);return}const r=n.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,r=e.length;n<r;++n){const i=e[n];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const o=i.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=af(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?Ki(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Ko.SIZE)}getView(){return this.get(Ko.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,r,i){return LRe(this.frameState_,e,n,r,i)}handleBrowserEvent(e,n){n=n||e.type;const r=new dm(n,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,r=n.type;if(r===dj.POINTERDOWN||r===An.WHEEL||r===An.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,o=n.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const o=e.viewHints;if(o[ws.ANIMATING]||o[ws.INTERACTING]){const a=Date.now()-e.time>8;i=a?0:8,s=a?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(no.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(no.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new P_(fm.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new P_(fm.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)Jr(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(An.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(An.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Bm(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Bm(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new dPe(this)),!Bm(n)){this.mapBrowserEventHandler_=new $Re(this,this.moveTolerance_);for(const i in Bi)this.mapBrowserEventHandler_.addEventListener(Bi[i],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(An.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(An.WHEEL,this.boundHandleBrowserEvent_,hae?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const i=n.getRootNode();r=i instanceof ShadowRoot?i.host:n}if(this.targetChangeHandlerKeys_=[Hn(r,An.KEYDOWN,this.handleBrowserEvent,this),Hn(r,An.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const i=n.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_?.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Jr(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Jr(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Hn(e,Ow.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Hn(e,An.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Jr),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new km("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Hn(e,Ow.PROPERTYCHANGE,this.render,this),Hn(e,An.CHANGE,this.render,this),Hn(e,"addlayer",this.handleLayerAdd_,this),Hn(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,r=e.length;n<r;++n){const i=e[n].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){xle(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(n!==void 0&&BY(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:QC(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:_n(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=QC(a.nextCenter,a.nextResolution,l,n)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!C2(this.previousExtent_)&&!h1(s.extent,this.previousExtent_))&&(this.dispatchEvent(new P_(fm.MOVESTART,this,i)),this.previousExtent_=_A(this.previousExtent_)),this.previousExtent_&&!s.viewHints[ws.ANIMATING]&&!s.viewHints[ws.INTERACTING]&&!h1(s.extent,this.previousExtent_)&&(this.dispatchEvent(new P_(fm.MOVEEND,this,s)),Ooe(s.extent,this.previousExtent_))),this.dispatchEvent(new P_(fm.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(fm.LOADSTART)||this.hasListener(fm.LOADEND)||this.hasListener(no.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new km("removelayer",n)),this.set(Ko.LAYERGROUP,e)}setSize(e){this.set(Ko.SIZE,e)}setTarget(e){this.set(Ko.TARGET,e)}setView(e){if(!e||e instanceof Qh){this.set(Ko.VIEW,e);return}this.set(Ko.VIEW,new Qh);const n=this;e.then(function(r){n.setView(new Qh(r))})}updateSize(){const e=this.getTargetElement();let n;if(e){let i,s;if(Bm(e))i=e.width,s=e.height;else{const o=getComputedStyle(e);i=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(n=[Math.max(0,i),Math.max(0,s)],!BY(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Woe("No map visible because the map container's width or height are 0."))}const r=this.getSize();n&&(!r||!pp(n,r))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function pPe(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new o5({layers:t.layers});n[Ko.LAYERGROUP]=r,n[Ko.TARGET]=t.target,n[Ko.VIEW]=t.view instanceof Qh?t.view:new Qh;let i;t.controls!==void 0&&(Array.isArray(t.controls)?i=new Hc(t.controls.slice()):(or(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls));let s;t.interactions!==void 0&&(Array.isArray(t.interactions)?s=new Hc(t.interactions.slice()):(or(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new Hc(t.overlays.slice()):(or(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new Hc,{controls:i,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}const y6="units",mPe=[1,2,5],oE=25.4/.28;class gPe extends l5{constructor(e){e=e||{};const n=document.createElement("div");n.style.pointerEvents="none",super({element:n,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+EA,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(y6,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(y6)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(y6,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let o=s3(r,e.resolution,n,s);const a=this.minWidth_*(this.dpi_||oE)/oE,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||oE)/oE:void 0;let c=a*o,u="";if(i=="degrees"){const I=Lw.degrees;c*=I,c<I/60?(u="",o*=3600):c<I?(u="",o*=60):u=""}else if(i=="imperial")c<.9144?(u="in",o/=.0254):c<1609.344?(u="ft",o/=.3048):(u="mi",o/=1609.344);else if(i=="nautical")o/=1852,u="NM";else if(i=="metric")c<1e-6?(u="nm",o*=1e9):c<.001?(u="m",o*=1e6):c<1?(u="mm",o*=1e3):c<1e3?u="m":(u="km",o/=1e3);else if(i=="us")c<.9144?(u="in",o*=39.37):c<1609.344?(u="ft",o/=.30480061):(u="mi",o/=1609.3472);else throw new Error("Invalid units");let h=3*Math.floor(Math.log(a*o)/Math.log(10)),f,g,v,x=0,b,T;for(;;){v=Math.floor(h/3);const I=Math.pow(10,v);if(f=mPe[(h%3+3)%3]*I,g=Math.round(f/o),isNaN(g)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&g>=l){f=x,g=b,v=T;break}else if(g>=a)break;x=f,b=g,T=v,++h}const A=this.scaleBar_?this.createScaleBar(g,f,u):f.toFixed(v<0?-v:0)+" "+u;this.renderedHTML_!=A&&(this.innerElement_.innerHTML=A,this.renderedHTML_=A),this.renderedWidth_!=g&&(this.innerElement_.style.width=g+"px",this.renderedWidth_=g),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,n,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let u=0;u<o;++u){const h=u%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${h}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(u%2===0||o===2?this.createStepText(u,e,!1,n,r):"")+"</div>")}return l.push(this.createStepText(o,e,!0,n,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,n,r,i,s){const a=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:n/this.scaleBarSteps_*-1,c=e===0?0:n/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?n+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=s3(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),n=this.dpi_||oE,r=1e3/25.4;return e*r*n}render(e){const n=e.frameState;n?this.viewState_=n.viewState:this.viewState_=null,this.updateElement_()}}const yPe={},EX=t=>{let e;const n=new Set,r=(u,h)=>{const f=typeof u=="function"?u(e):u;if(!Object.is(f,e)){const g=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(v=>v(e,g))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(yPe?"commercial":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},vPe=t=>t?EX(t):EX;var v6={exports:{}},_6={},x6={exports:{}},w6={};var SX;function _Pe(){if(SX)return w6;SX=1;var t=mA();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function a(h,f){var g=f(),v=r({inst:{value:g,getSnapshot:f}}),x=v[0].inst,b=v[1];return s(function(){x.value=g,x.getSnapshot=f,l(x)&&b({inst:x})},[h,g,f]),i(function(){return l(x)&&b({inst:x}),h(function(){l(x)&&b({inst:x})})},[h]),o(g),g}function l(h){var f=h.getSnapshot;h=h.value;try{var g=f();return!n(h,g)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return w6.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,w6}var TX;function xPe(){return TX||(TX=1,x6.exports=_Pe()),x6.exports}var kX;function wPe(){if(kX)return _6;kX=1;var t=mA(),e=xPe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,a=t.useMemo,l=t.useDebugValue;return _6.useSyncExternalStoreWithSelector=function(c,u,h,f,g){var v=s(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=a(function(){function T(V){if(!A){if(A=!0,I=V,V=f(V),g!==void 0&&x.hasValue){var M=x.value;if(g(M,V))return R=M}return R=V}if(M=R,r(I,V))return M;var N=f(V);return g!==void 0&&g(M,N)?(I=V,M):(I=V,R=N)}var A=!1,I,R,C=h===void 0?null:h;return[function(){return T(u())},C===null?void 0:function(){return T(C())}]},[u,h,f,g]);var b=i(c,v[0],v[1]);return o(function(){x.hasValue=!0,x.value=b},[b]),l(b),b},_6}var AX;function bPe(){return AX||(AX=1,v6.exports=wPe()),v6.exports}var EPe=bPe();const SPe=nz(EPe),ble={},{useDebugValue:TPe}=kSe,{useSyncExternalStoreWithSelector:kPe}=SPe;let IX=!1;const APe=t=>t;function IPe(t,e=APe,n){(ble?"commercial":void 0)!=="production"&&n&&!IX&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),IX=!0);const r=kPe(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return TPe(r),r}const RPe=t=>{(ble?"commercial":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?vPe(t):t,n=(r,i)=>IPe(e,r,i);return Object.assign(n,e),n},No=t=>RPe;var Ele=Symbol.for("immer-nothing"),RX=Symbol.for("immer-draftable"),lc=Symbol.for("immer-state");function Bu(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var nk=Object.getPrototypeOf;function Fw(t){return!!t&&!!t[lc]}function m1(t){return t?Sle(t)||Array.isArray(t)||!!t[RX]||!!t.constructor?.[RX]||PA(t)||u5(t):!1}var PPe=Object.prototype.constructor.toString(),PX=new WeakMap;function Sle(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);if(e===null||e===Object.prototype)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let r=PX.get(n);return r===void 0&&(r=Function.toString.call(n),PX.set(n,r)),r===PPe}function w3(t,e,n=!0){c5(t)===0?(n?Reflect.ownKeys(t):Object.keys(t)).forEach(i=>{e(i,t[i],t)}):t.forEach((r,i)=>e(i,r,t))}function c5(t){const e=t[lc];return e?e.type_:Array.isArray(t)?1:PA(t)?2:u5(t)?3:0}function pj(t,e){return c5(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Tle(t,e,n){const r=c5(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function MPe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function PA(t){return t instanceof Map}function u5(t){return t instanceof Set}function j0(t){return t.copy_||t.base_}function mj(t,e){if(PA(t))return new Map(t);if(u5(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=Sle(t);if(e===!0||e==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(t);delete r[lc];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const o=i[s],a=r[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[o]})}return Object.create(nk(t),r)}else{const r=nk(t);if(r!==null&&n)return{...t};const i=Object.create(r);return Object.assign(i,t)}}function eU(t,e=!1){return h5(t)||Fw(t)||!m1(t)||(c5(t)>1&&Object.defineProperties(t,{set:tP,add:tP,clear:tP,delete:tP}),Object.freeze(t),e&&Object.values(t).forEach(n=>eU(n,!0))),t}function CPe(){Bu(2)}var tP={value:CPe};function h5(t){return t===null||typeof t!="object"?!0:Object.isFrozen(t)}var NPe={};function g1(t){const e=NPe[t];return e||Bu(0,t),e}var rk;function kle(){return rk}function OPe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function MX(t,e){e&&(g1("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function gj(t){yj(t),t.drafts_.forEach(LPe),t.drafts_=null}function yj(t){t===rk&&(rk=t.parent_)}function CX(t){return rk=OPe(rk,t)}function LPe(t){const e=t[lc];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function NX(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[lc].modified_&&(gj(e),Bu(4)),m1(t)&&(t=b3(e,t),e.parent_||E3(e,t)),e.patches_&&g1("Patches").generateReplacementPatches_(n[lc].base_,t,e.patches_,e.inversePatches_)):t=b3(e,n,[]),gj(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==Ele?t:void 0}function b3(t,e,n){if(h5(e))return e;const r=t.immer_.shouldUseStrictIteration(),i=e[lc];if(!i)return w3(e,(s,o)=>OX(t,i,e,s,o,n),r),e;if(i.scope_!==t)return e;if(!i.modified_)return E3(t,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,a=!1;i.type_===3&&(o=new Set(s),s.clear(),a=!0),w3(o,(l,c)=>OX(t,i,s,l,c,n,a),r),E3(t,s,!1),n&&t.patches_&&g1("Patches").generatePatches_(i,n,t.patches_,t.inversePatches_)}return i.copy_}function OX(t,e,n,r,i,s,o){if(i==null||typeof i!="object"&&!o)return;const a=h5(i);if(!(a&&!o)){if(Fw(i)){const l=s&&e&&e.type_!==3&&!pj(e.assigned_,r)?s.concat(r):void 0,c=b3(t,i,l);if(Tle(n,r,c),Fw(c))t.canAutoFreeze_=!1;else return}else o&&n.add(i);if(m1(i)&&!a){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1||e&&e.base_&&e.base_[r]===i&&a)return;b3(t,i),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&(PA(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&E3(t,i)}}}function E3(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&eU(e,n)}function DPe(t,e){const n=Array.isArray(t),r={type_:n?1:0,scope_:e?e.scope_:kle(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=tU;n&&(i=[r],s=ik);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return r.draft_=a,r.revoke_=o,a}var tU={get(t,e){if(e===lc)return t;const n=j0(t);if(!pj(n,e))return $Pe(t,n,e);const r=n[e];return t.finalized_||!m1(r)?r:r===b6(t.base_,e)?(E6(t),t.copy_[e]=_j(r,t)):r},has(t,e){return e in j0(t)},ownKeys(t){return Reflect.ownKeys(j0(t))},set(t,e,n){const r=Ale(j0(t),e);if(r?.set)return r.set.call(t.draft_,n),!0;if(!t.modified_){const i=b6(j0(t),e),s=i?.[lc];if(s&&s.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(MPe(n,i)&&(n!==void 0||pj(t.base_,e)))return!0;E6(t),vj(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return b6(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,E6(t),vj(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=j0(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty(){Bu(11)},getPrototypeOf(t){return nk(t.base_)},setPrototypeOf(){Bu(12)}},ik={};w3(tU,(t,e)=>{ik[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ik.deleteProperty=function(t,e){return ik.set.call(this,t,e,void 0)};ik.set=function(t,e,n){return tU.set.call(this,t[0],e,n,t[0])};function b6(t,e){const n=t[lc];return(n?j0(n):t)[e]}function $Pe(t,e,n){const r=Ale(e,n);return r?"value"in r?r.value:r.get?.call(t.draft_):void 0}function Ale(t,e){if(!(e in t))return;let n=nk(t);for(;n;){const r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=nk(n)}}function vj(t){t.modified_||(t.modified_=!0,t.parent_&&vj(t.parent_))}function E6(t){t.copy_||(t.copy_=mj(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var jPe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,n,r)=>{if(typeof e=="function"&&typeof n!="function"){const s=n;n=e;const o=this;return function(l=s,...c){return o.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&Bu(6),r!==void 0&&typeof r!="function"&&Bu(7);let i;if(m1(e)){const s=CX(this),o=_j(e,void 0);let a=!0;try{i=n(o),a=!1}finally{a?gj(s):yj(s)}return MX(s,r),NX(i,s)}else if(!e||typeof e!="object"){if(i=n(e),i===void 0&&(i=e),i===Ele&&(i=void 0),this.autoFreeze_&&eU(i,!0),r){const s=[],o=[];g1("Patches").generateReplacementPatches_(e,i,s,o),r(s,o)}return i}else Bu(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let r,i;return[this.produce(e,n,(o,a)=>{r=o,i=a}),r,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),typeof t?.useStrictIteration=="boolean"&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){m1(t)||Bu(8),Fw(t)&&(t=FPe(t));const e=CX(this),n=_j(t,void 0);return n[lc].isManual_=!0,yj(e),n}finishDraft(t,e){const n=t&&t[lc];(!n||!n.isManual_)&&Bu(9);const{scope_:r}=n;return MX(r,e),NX(void 0,r)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const i=e[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(e=e.slice(n+1));const r=g1("Patches").applyPatches_;return Fw(t)?r(t,e):this.produce(t,i=>r(i,e))}};function _j(t,e){const n=PA(t)?g1("MapSet").proxyMap_(t,e):u5(t)?g1("MapSet").proxySet_(t,e):DPe(t,e);return(e?e.scope_:kle()).drafts_.push(n),n}function FPe(t){return Fw(t)||Bu(10,t),Ile(t)}function Ile(t){if(!m1(t)||h5(t))return t;const e=t[lc];let n,r=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=mj(t,e.scope_.immer_.useStrictShallowCopy_),r=e.scope_.immer_.shouldUseStrictIteration()}else n=mj(t,!0);return w3(n,(i,s)=>{Tle(n,i,Ile(s))},r),e&&(e.finalized_=!1),n}var VPe=new jPe,zPe=VPe.produce;const UPe=t=>(e,n,r)=>(r.setState=(i,s,...o)=>{const a=typeof i=="function"?zPe(i):i;return e(a,s,...o)},t(r.setState,n,r)),L2=UPe,bs=No()(L2((t,e)=>({tracking:!1,position:null,heading:null,smoothHeading:null,rawGPSHeading:null,accuracy:null,speed:null,headingSource:null,watchId:null,firstFix:!0,navigationMode:"free",config:{centerOnUser:!0},fetchPassivePosition:()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(n=>{t(r=>{r.tracking||(r.position={lat:n.coords.latitude,lng:n.coords.longitude},r.accuracy=n.coords.accuracy)})},()=>{},{enableHighAccuracy:!1,maximumAge:6e4,timeout:1e4})},startTracking:()=>{t(n=>{n.tracking=!0})},stopTracking:()=>{t(n=>{const{watchId:r}=e();r!==null&&navigator.geolocation.clearWatch(r),n.tracking=!1,n.speed=null,n.headingSource=null,n.heading=null,n.smoothHeading=null,n.rawGPSHeading=null,n.watchId=null,n.navigationMode="free"})},updatePosition:n=>{t(r=>{r.position={lat:n.coords.latitude,lng:n.coords.longitude},r.accuracy=n.coords.accuracy,r.speed=n.coords.speed,r.rawGPSHeading=n.coords.heading,n.coords.accuracy!==null&&n.coords.accuracy<20?n.coords.heading!==null&&n.coords.speed!==null&&n.coords.speed>.5?r.headingSource="gps":r.headingSource="compass":r.headingSource=null})},setSmoothedHeading:n=>{t(r=>{r.smoothHeading=n,r.heading=n})},setWatchId:n=>{t(r=>{r.watchId=n})},resetFirstFix:()=>{t(n=>{n.firstFix=!1})},setNavigationMode:n=>{t(r=>{r.navigationMode=n})},toggleNavigationMode:()=>{t(n=>{n.navigationMode=n.navigationMode==="free"?"headingUp":"free"})}}))),Sy={Kansenkaart:{name:"Kansenkaart",factory:async()=>{const{createKansenkaartLayerOL:t}=await xe(async()=>{const{createKansenkaartLayerOL:e}=await import("./kansenkaartOL-CkTYkEGC.js");return{createKansenkaartLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"TMK 1850":{name:"TMK 1850",factory:async()=>null,immediateLoad:!0,tier:"premium"},"Bonnebladen 1900":{name:"Bonnebladen 1900",factory:async()=>null,immediateLoad:!0,tier:"premium"},"AHN 0.5m":{name:"AHN 0.5m",factory:async()=>{const{createAHNLayerOL:t}=await xe(async()=>{const{createAHNLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createAHNLayerOL:e}},[]);return t()},immediateLoad:!0},Geomorfologie:{name:"Geomorfologie",factory:async()=>{const{createGeomorfologieLayerOL:t}=await xe(async()=>{const{createGeomorfologieLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createGeomorfologieLayerOL:e}},[]);return t()},immediateLoad:!0},Bodemkaart:{name:"Bodemkaart",factory:async()=>{const{createBodemkaartLayerOL:t}=await xe(async()=>{const{createBodemkaartLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createBodemkaartLayerOL:e}},[]);return t()},immediateLoad:!0},IKAW:{name:"IKAW",factory:async()=>{const{createIKAWLayerOL:t}=await xe(async()=>{const{createIKAWLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createIKAWLayerOL:e}},[]);return t()},immediateLoad:!0},"FAMKE Steentijd":{name:"FAMKE Steentijd",factory:async()=>{const{createFAMKESteentijdLayerOL:t}=await xe(async()=>{const{createFAMKESteentijdLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createFAMKESteentijdLayerOL:e}},[]);return t()},immediateLoad:!0},"FAMKE IJzertijd":{name:"FAMKE IJzertijd",factory:async()=>{const{createFAMKEIJzertijdLayerOL:t}=await xe(async()=>{const{createFAMKEIJzertijdLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createFAMKEIJzertijdLayerOL:e}},[]);return t()},immediateLoad:!0},Essen:{name:"Essen",factory:async()=>{const{createEssenLayerOL:t}=await xe(async()=>{const{createEssenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createEssenLayerOL:e}},[]);return t()},immediateLoad:!0},Rijksmonumenten:{name:"Rijksmonumenten",factory:async()=>{const{createRijksmonumentenLayerOL:t}=await xe(async()=>{const{createRijksmonumentenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createRijksmonumentenLayerOL:e}},[]);return t()},immediateLoad:!0},"Archeo Onderzoeken":{name:"Archeo Onderzoeken",factory:async()=>{const{createArcheoOnderzoekenLayerOL:t}=await xe(async()=>{const{createArcheoOnderzoekenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createArcheoOnderzoekenLayerOL:e}},[]);return t()},immediateLoad:!0},Werelderfgoed:{name:"Werelderfgoed",factory:async()=>{const{createWerelderfgoedLayerOL:t}=await xe(async()=>{const{createWerelderfgoedLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createWerelderfgoedLayerOL:e}},[]);return t()},immediateLoad:!0},Terpen:{name:"Terpen",factory:async()=>{const{createTerpenLayerOL:t}=await xe(async()=>{const{createTerpenLayerOL:e}=await import("./terpenOL-C5mqy73R.js");return{createTerpenLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},Verdedigingslinies:{name:"Verdedigingslinies",factory:async()=>{const{createLiniesLayerOL:t}=await xe(async()=>{const{createLiniesLayerOL:e}=await import("./verdedigingswerkenOL-DdzfkYfm.js");return{createLiniesLayerOL:e}},[]);return t()},immediateLoad:!0},Inundatiegebieden:{name:"Inundatiegebieden",factory:async()=>{const{createInundatiesLayerOL:t}=await xe(async()=>{const{createInundatiesLayerOL:e}=await import("./verdedigingswerkenOL-DdzfkYfm.js");return{createInundatiesLayerOL:e}},[]);return t()},immediateLoad:!0},"Militaire Objecten":{name:"Militaire Objecten",factory:async()=>{const{createMilitaireObjectenLayerOL:t}=await xe(async()=>{const{createMilitaireObjectenLayerOL:e}=await import("./verdedigingswerkenOL-DdzfkYfm.js");return{createMilitaireObjectenLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 800 n.Chr.":{name:"Paleokaart 800 n.Chr.",factory:async()=>{const{createPaleo800ncLayerOL:t}=await xe(async()=>{const{createPaleo800ncLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo800ncLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 100 n.Chr.":{name:"Paleokaart 100 n.Chr.",factory:async()=>{const{createPaleo100ncLayerOL:t}=await xe(async()=>{const{createPaleo100ncLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo100ncLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 500 v.Chr.":{name:"Paleokaart 500 v.Chr.",factory:async()=>{const{createPaleo500vcLayerOL:t}=await xe(async()=>{const{createPaleo500vcLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 1500 v.Chr.":{name:"Paleokaart 1500 v.Chr.",factory:async()=>{const{createPaleo1500vcLayerOL:t}=await xe(async()=>{const{createPaleo1500vcLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo1500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 2750 v.Chr.":{name:"Paleokaart 2750 v.Chr.",factory:async()=>{const{createPaleo2750vcLayerOL:t}=await xe(async()=>{const{createPaleo2750vcLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo2750vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 5500 v.Chr.":{name:"Paleokaart 5500 v.Chr.",factory:async()=>{const{createPaleo5500vcLayerOL:t}=await xe(async()=>{const{createPaleo5500vcLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo5500vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Paleokaart 9000 v.Chr.":{name:"Paleokaart 9000 v.Chr.",factory:async()=>{const{createPaleo9000vcLayerOL:t}=await xe(async()=>{const{createPaleo9000vcLayerOL:e}=await import("./paleokaartOL-CoRcBCu5.js");return{createPaleo9000vcLayerOL:e}},[]);return t()},immediateLoad:!0},"Religieus Erfgoed":{name:"Religieus Erfgoed",factory:async()=>{const{createReligieusErfgoedLayerOL:t}=await xe(async()=>{const{createReligieusErfgoedLayerOL:e}=await import("./religieusErfgoedOL-l7uOlguJ.js");return{createReligieusErfgoedLayerOL:e}},[]);return t()},immediateLoad:!0},"AHN4 Hoogtekaart Kleur":{name:"AHN4 Hoogtekaart Kleur",factory:async()=>{const{createArcGISAHN4ColorElevation:t}=await xe(async()=>{const{createArcGISAHN4ColorElevation:e}=await import("./arcgisAHNLayers-DJcJ2p-F.js");return{createArcGISAHN4ColorElevation:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},"AHN4 Hillshade NL":{name:"AHN4 Hillshade NL",factory:async()=>{const{createArcGISAHN4Hillshade:t}=await xe(async()=>{const{createArcGISAHN4Hillshade:e}=await import("./arcgisAHNLayers-DJcJ2p-F.js");return{createArcGISAHN4Hillshade:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},"AHN4 Multi-Hillshade NL":{name:"AHN4 Multi-Hillshade NL",factory:async()=>{const{createArcGISAHN4MultiHillshade:t}=await xe(async()=>{const{createArcGISAHN4MultiHillshade:e}=await import("./arcgisAHNLayers-DJcJ2p-F.js");return{createArcGISAHN4MultiHillshade:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},"AHN4 Hillshade Kleur":{name:"AHN4 Hillshade Kleur",factory:async()=>{const{createArcGISAHN4ShadedRelief:t}=await xe(async()=>{const{createArcGISAHN4ShadedRelief:e}=await import("./arcgisAHNLayers-DJcJ2p-F.js");return{createArcGISAHN4ShadedRelief:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67]));return t()},immediateLoad:!0,tier:"premium",platform:"arcgis"},Gewaspercelen:{name:"Gewaspercelen",factory:async()=>{const{createGewaspercelenLayerOL:t}=await xe(async()=>{const{createGewaspercelenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createGewaspercelenLayerOL:e}},[]);return t()},immediateLoad:!0,tier:"premium"},"Kadastrale Grenzen":{name:"Kadastrale Grenzen",factory:async()=>{const{createKadastraleKaartLayerOL:t}=await xe(async()=>{const{createKadastraleKaartLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createKadastraleKaartLayerOL:e}},[]);return t()},immediateLoad:!0},Scheepswrakken:{name:"Scheepswrakken",factory:async()=>{const{createScheepswrakkenLayerOL:t}=await xe(async()=>{const{createScheepswrakkenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createScheepswrakkenLayerOL:e}},[]);return t()},immediateLoad:!0},"Woonheuvels ZH":{name:"Woonheuvels ZH",factory:async()=>{const{createWoonheuvelsLayerOL:t}=await xe(async()=>{const{createWoonheuvelsLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createWoonheuvelsLayerOL:e}},[]);return t()},immediateLoad:!0},"Romeinse Forten":{name:"Romeinse Forten",factory:async()=>{const{createRomeinseFortenLayerOL:t}=await xe(async()=>{const{createRomeinseFortenLayerOL:e}=await import("./romeinseFortenOL-DfMw7SGA.js");return{createRomeinseFortenLayerOL:e}},__vite__mapDeps([68,69]));return t()},immediateLoad:!1},"Romeinse Forten Lijnen":{name:"Romeinse Forten Lijnen",factory:async()=>{const{createRomeinseFortenLijnenLayerOL:t}=await xe(async()=>{const{createRomeinseFortenLijnenLayerOL:e}=await import("./romeinseFortenOL-DfMw7SGA.js");return{createRomeinseFortenLijnenLayerOL:e}},__vite__mapDeps([68,69]));return t()},immediateLoad:!1},Windmolens:{name:"Windmolens",factory:async()=>{const{createWindmolensLayerOL:t}=await xe(async()=>{const{createWindmolensLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createWindmolensLayerOL:e}},[]);return t()},immediateLoad:!0},Erfgoedlijnen:{name:"Erfgoedlijnen",factory:async()=>{const{createErfgoedlijnenLayerOL:t}=await xe(async()=>{const{createErfgoedlijnenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createErfgoedlijnenLayerOL:e}},[]);return t()},immediateLoad:!0},"Oude Kernen":{name:"Oude Kernen",factory:async()=>{const{createOudeKernenLayerOL:t}=await xe(async()=>{const{createOudeKernenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createOudeKernenLayerOL:e}},[]);return t()},immediateLoad:!0},"Relictenkaart Punten":{name:"Relictenkaart Punten",factory:async()=>{const{createRelictenPuntenLayerOL:t}=await xe(async()=>{const{createRelictenPuntenLayerOL:e}=await import("./relictenGelderlandOL-BhH1Mg78.js");return{createRelictenPuntenLayerOL:e}},[]);return t()},immediateLoad:!1},"Relictenkaart Lijnen":{name:"Relictenkaart Lijnen",factory:async()=>{const{createRelictenkaartLijnenLayerOL:t}=await xe(async()=>{const{createRelictenkaartLijnenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createRelictenkaartLijnenLayerOL:e}},[]);return t()},immediateLoad:!0},"Relictenkaart Vlakken":{name:"Relictenkaart Vlakken",factory:async()=>{const{createRelictenkaartVlakkenLayerOL:t}=await xe(async()=>{const{createRelictenkaartVlakkenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createRelictenkaartVlakkenLayerOL:e}},[]);return t()},immediateLoad:!0},"Verdronken Dorpen":{name:"Verdronken Dorpen",factory:async()=>{const{createVerdronkenDorpenLayerOL:t}=await xe(async()=>{const{createVerdronkenDorpenLayerOL:e}=await import("./pdokWMSLayers-B7u1WMFS.js");return{createVerdronkenDorpenLayerOL:e}},[]);return t()},immediateLoad:!0},"AMK Monumenten":{name:"AMK Monumenten",factory:async()=>{const{createAMKLayerOL:t}=await xe(async()=>{const{createAMKLayerOL:e}=await import("./amkOL-JO93aFqa.js");return{createAMKLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Romeins":{name:"AMK Romeins",factory:async()=>{const{createAMKRomeinsLayerOL:t}=await xe(async()=>{const{createAMKRomeinsLayerOL:e}=await import("./amkOL-JO93aFqa.js");return{createAMKRomeinsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Steentijd":{name:"AMK Steentijd",factory:async()=>{const{createAMKSteentijdLayerOL:t}=await xe(async()=>{const{createAMKSteentijdLayerOL:e}=await import("./amkOL-JO93aFqa.js");return{createAMKSteentijdLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Vroege ME":{name:"AMK Vroege ME",factory:async()=>{const{createAMKVroegeMELayerOL:t}=await xe(async()=>{const{createAMKVroegeMELayerOL:e}=await import("./amkOL-JO93aFqa.js");return{createAMKVroegeMELayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Late ME":{name:"AMK Late ME",factory:async()=>{const{createAMKLateMELayerOL:t}=await xe(async()=>{const{createAMKLateMELayerOL:e}=await import("./amkOL-JO93aFqa.js");return{createAMKLateMELayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"AMK Overig":{name:"AMK Overig",factory:async()=>{const{createAMKOverigLayerOL:t}=await xe(async()=>{const{createAMKOverigLayerOL:e}=await import("./amkOL-JO93aFqa.js");return{createAMKOverigLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium"},"Romeinse wegen (regio)":{name:"Romeinse wegen (regio)",factory:async()=>{const{createRomeinseWegenLayerOL:t}=await xe(async()=>{const{createRomeinseWegenLayerOL:e}=await import("./romeinsOL-D5hdkKpQ.js");return{createRomeinseWegenLayerOL:e}},[]);return t()},immediateLoad:!1},"Romeinse wegen (Wereld)":{name:"Romeinse wegen (Wereld)",factory:async()=>{const{createRomeinseWegenWereldLayerOL:t}=await xe(async()=>{const{createRomeinseWegenWereldLayerOL:e}=await import("./romeinsOL-D5hdkKpQ.js");return{createRomeinseWegenWereldLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Kastelen:{name:"Kastelen",factory:async()=>{const{createKastelenLayerOL:t}=await xe(async()=>{const{createKastelenLayerOL:e}=await import("./kastelenOL-CiznzFJq.js");return{createKastelenLayerOL:e}},__vite__mapDeps([70,69]));return t()},immediateLoad:!1},Runes:{name:"Runes",factory:async()=>{const{createRuinesLayerOL:t}=await xe(async()=>{const{createRuinesLayerOL:e}=await import("./ruinesOL-ogBKYImd.js");return{createRuinesLayerOL:e}},__vite__mapDeps([71,69]));return t()},immediateLoad:!1},Veengebieden:{name:"Veengebieden",factory:async()=>{const{createVeengebiedenLayerOL:t}=await xe(async()=>{const{createVeengebiedenLayerOL:e}=await import("./veengebiedenOL-CLG1S38L.js");return{createVeengebiedenLayerOL:e}},[]);return t()},immediateLoad:!1},Hunebedden:{name:"Hunebedden",factory:async()=>{const{createHunebeddenLayerOL:t}=await xe(async()=>{const{createHunebeddenLayerOL:e}=await import("./hunebeddenOL-DjGc7G6f.js");return{createHunebeddenLayerOL:e}},__vite__mapDeps([72,69]));return t()},immediateLoad:!1},"UIKAV Punten":{name:"UIKAV Punten",factory:async()=>{const{createUIKAVArcheoPuntenLayerOL:t}=await xe(async()=>{const{createUIKAVArcheoPuntenLayerOL:e}=await import("./uikavArcheoPuntenOL-D6--_5Nv.js");return{createUIKAVArcheoPuntenLayerOL:e}},__vite__mapDeps([73,69]));return t()},immediateLoad:!1,tier:"premium"},"UIKAV Vlakken":{name:"UIKAV Vlakken",factory:async()=>{const{createUIKAVVlakkenLayerOL:t}=await xe(async()=>{const{createUIKAVVlakkenLayerOL:e}=await import("./uikavVlakkenOL-BSiX7GgE.js");return{createUIKAVVlakkenLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Buffer":{name:"UIKAV Buffer",factory:async()=>{const{createUIKAVBufferlaagLayerOL:t}=await xe(async()=>{const{createUIKAVBufferlaagLayerOL:e}=await import("./uikavBufferlaagOL-VpzazLUX.js");return{createUIKAVBufferlaagLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Expert":{name:"UIKAV Expert",factory:async()=>{const{createUIKAVExpertLayerOL:t}=await xe(async()=>{const{createUIKAVExpertLayerOL:e}=await import("./uikavExpertOL-VfahkDTL.js");return{createUIKAVExpertLayerOL:e}},[]);return t()},immediateLoad:!1},"UIKAV Indeling":{name:"UIKAV Indeling",factory:async()=>{const{createUIKAVUiterwaardenLayerOL:t}=await xe(async()=>{const{createUIKAVUiterwaardenLayerOL:e}=await import("./uikavUiterwaardenOL-BaKK-eFy.js");return{createUIKAVUiterwaardenLayerOL:e}},[]);return t()},immediateLoad:!1},Speeltuinen:{name:"Speeltuinen",factory:async()=>{const{createSpeeltuinenLayerOL:t}=await xe(async()=>{const{createSpeeltuinenLayerOL:e}=await import("./speeltuinenOL-BhgbP69W.js");return{createSpeeltuinenLayerOL:e}},__vite__mapDeps([74,69]));return t()},immediateLoad:!1},Musea:{name:"Musea",factory:async()=>{const{createMuseaLayerOL:t}=await xe(async()=>{const{createMuseaLayerOL:e}=await import("./museaOL-BHnT_5aG.js");return{createMuseaLayerOL:e}},__vite__mapDeps([75,69]));return t()},immediateLoad:!1},Strandjes:{name:"Strandjes",factory:async()=>{const{createStrandjesLayerOL:t}=await xe(async()=>{const{createStrandjesLayerOL:e}=await import("./strandjesOL-B23yafjX.js");return{createStrandjesLayerOL:e}},[]);return t()},immediateLoad:!1},Parken:{name:"Parken",factory:async()=>{const{createParkenLayerOL:t}=await xe(async()=>{const{createParkenLayerOL:e}=await import("./parkenOL-Zr9vyb2l.js");return{createParkenLayerOL:e}},[]);return t()},immediateLoad:!1},Kringloopwinkels:{name:"Kringloopwinkels",factory:async()=>{const{createKringloopwinkelsLayerOL:t}=await xe(async()=>{const{createKringloopwinkelsLayerOL:e}=await import("./kringloopwinkelsOL-D04e0P9k.js");return{createKringloopwinkelsLayerOL:e}},__vite__mapDeps([76,69]));return t()},immediateLoad:!1},Ruiterpaden:{name:"Ruiterpaden",factory:async()=>{const{createRuiterpadenLayerOL:t}=await xe(async()=>{const{createRuiterpadenLayerOL:e}=await import("./ruiterpadenOL-cv7fvjLc.js");return{createRuiterpadenLayerOL:e}},[]);return t()},immediateLoad:!1},Laarzenpaden:{name:"Laarzenpaden",factory:async()=>{const{createLaarzenpadenLayerOL:t}=await xe(async()=>{const{createLaarzenpadenLayerOL:e}=await import("./laarzenpadenOL-CvppwT5d.js");return{createLaarzenpadenLayerOL:e}},[]);return t()},immediateLoad:!1},"Fossielen Nederland":{name:"Fossielen Nederland",factory:async()=>{const{createFossielenLayerOL:t}=await xe(async()=>{const{createFossielenLayerOL:e}=await import("./fossielenOL-gnqP-Z-F.js");return{createFossielenLayerOL:e}},__vite__mapDeps([77,78,69]));return t()},immediateLoad:!1,tier:"premium"},"Fossielen Belgi":{name:"Fossielen Belgi",factory:async()=>{const{createFossielenBelgieLayerOL:t}=await xe(async()=>{const{createFossielenBelgieLayerOL:e}=await import("./fossielenBelgieOL-KdjEQ_sS.js");return{createFossielenBelgieLayerOL:e}},__vite__mapDeps([79,78,69]));return t()},immediateLoad:!1,tier:"premium",regions:["be"]},"Fossielen Duitsland":{name:"Fossielen Duitsland",factory:async()=>{const{createFossielenDuitslandLayerOL:t}=await xe(async()=>{const{createFossielenDuitslandLayerOL:e}=await import("./fossielenDuitslandOL-DuPD0caz.js");return{createFossielenDuitslandLayerOL:e}},__vite__mapDeps([80,78,69]));return t()},immediateLoad:!1,tier:"premium",regions:["de"]},"Fossielen Frankrijk":{name:"Fossielen Frankrijk",factory:async()=>{const{createFossielenFrankrijkLayerOL:t}=await xe(async()=>{const{createFossielenFrankrijkLayerOL:e}=await import("./fossielenFrankrijkOL-B4qYScUE.js");return{createFossielenFrankrijkLayerOL:e}},__vite__mapDeps([81,78,69]));return t()},immediateLoad:!1,tier:"premium",regions:["fr"]},"Fossiel Hotspots":{name:"Fossiel Hotspots",factory:async()=>{const{createFossielHotspotsLayerOL:t}=await xe(async()=>{const{createFossielHotspotsLayerOL:e}=await import("./fossielHotspotsOL-65lrC6rv.js");return{createFossielHotspotsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"Mineralen Hotspots":{name:"Mineralen Hotspots",factory:async()=>{const{createMineralenHotspotsLayerOL:t}=await xe(async()=>{const{createMineralenHotspotsLayerOL:e}=await import("./mineralenHotspotsOL-DhnQGes8.js");return{createMineralenHotspotsLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},Goudrivieren:{name:"Goudrivieren",factory:async()=>{const{createGoudrivierenLayerOL:t}=await xe(async()=>{const{createGoudrivierenLayerOL:e}=await import("./goudrivierenOL-CtGdlEcH.js");return{createGoudrivierenLayerOL:e}},[]);return t()},immediateLoad:!1,tier:"premium",regions:["nl","be","de","fr"]},"WWII Bunkers":{name:"WWII Bunkers",factory:async()=>{const{createBunkersLayerOL:t}=await xe(async()=>{const{createBunkersLayerOL:e}=await import("./bunkersOL-B23q53-E.js");return{createBunkersLayerOL:e}},__vite__mapDeps([82,69]));return t()},immediateLoad:!1},Grafheuvels:{name:"Grafheuvels",factory:async()=>{const{createGrafheuvelsLayerOL:t}=await xe(async()=>{const{createGrafheuvelsLayerOL:e}=await import("./grafheuvelsOL-CE8781tv.js");return{createGrafheuvelsLayerOL:e}},__vite__mapDeps([83,69]));return t()},immediateLoad:!1},Slagvelden:{name:"Slagvelden",factory:async()=>{const{createSlagveldenLayerOL:t}=await xe(async()=>{const{createSlagveldenLayerOL:e}=await import("./slagveldenOL-C_0qaCrM.js");return{createSlagveldenLayerOL:e}},__vite__mapDeps([84,69]));return t()},immediateLoad:!1},"Militaire Vliegvelden":{name:"Militaire Vliegvelden",factory:async()=>{const{createVliegveldenLayerOL:t}=await xe(async()=>{const{createVliegveldenLayerOL:e}=await import("./vliegveldenOL-CR5OhhWz.js");return{createVliegveldenLayerOL:e}},[]);return t()},immediateLoad:!1}};function GPe(){return Object.values(Sy).filter(t=>t.immediateLoad&&t.platform!=="arcgis")}const es=No()(L2((t,e)=>({map:null,arcgisMap:null,arcgisView:null,arcgisInitialized:!1,rotation:0,rotationEnabled:!0,setMap:n=>{t(r=>{r.map=n})},setArcGISMap:(n,r)=>{t(i=>{i.arcgisMap=n,i.arcgisView=r,i.arcgisInitialized=!0})},setRotation:n=>{t(r=>{if(r.rotation=n,r.map&&r.rotationEnabled){const i=n*Math.PI/180;r.map.getView().setRotation(i)}})},enableRotation:()=>{t(n=>{n.rotationEnabled=!0})},disableRotation:()=>{t(n=>{n.rotationEnabled=!1,n.rotation=0,n.map&&n.map.getView().animate({rotation:0,duration:500})})}}))),io=No()(L2((t,e)=>({visible:{"CartoDB (licht)":!0,OpenStreetMap:!1,Luchtfoto:!1,"Labels Overlay":!1,"TMK 1850":!1,"Bonnebladen 1900":!1,Hunebedden:!1,"FAMKE Steentijd":!1,"FAMKE IJzertijd":!1,Grafheuvels:!1,Terpen:!1,"AMK Monumenten":!1,"AMK Romeins":!1,"AMK Steentijd":!1,"AMK Vroege ME":!1,"AMK Late ME":!1,"AMK Overig":!1,"Archeo Onderzoeken":!1,"Romeinse wegen (regio)":!1,"Romeinse wegen (Wereld)":!1,Kastelen:!1,IKAW:!1,Essen:!1,Rijksmonumenten:!1,Werelderfgoed:!1,"WWII Bunkers":!1,Slagvelden:!1,"Militaire Vliegvelden":!1,Verdedigingslinies:!1,Inundatiegebieden:!1,"Militaire Objecten":!1,"Paleokaart 800 n.Chr.":!1,"Paleokaart 100 n.Chr.":!1,"Paleokaart 500 v.Chr.":!1,"Paleokaart 1500 v.Chr.":!1,"Paleokaart 2750 v.Chr.":!1,"Paleokaart 5500 v.Chr.":!1,"Paleokaart 9000 v.Chr.":!1,"Religieus Erfgoed":!1,"UIKAV Punten":!1,"UIKAV Vlakken":!1,"UIKAV Buffer":!1,"UIKAV Expert":!1,"UIKAV Indeling":!1,"AHN4 Hoogtekaart Kleur":!1,"AHN4 Hillshade NL":!1,"AHN4 Multi-Hillshade NL":!1,"AHN4 Hillshade Kleur":!1,"AHN 0.5m":!1,Veengebieden:!1,Geomorfologie:!1,Bodemkaart:!1,"Fossielen Nederland":!1,"Fossielen Belgi":!1,"Fossielen Duitsland":!1,"Fossielen Frankrijk":!1,Parken:!1,Speeltuinen:!1,Musea:!1,Strandjes:!1,Ruiterpaden:!1,Laarzenpaden:!1,Gewaspercelen:!1,"Kadastrale Grenzen":!1,Scheepswrakken:!1,"Woonheuvels ZH":!1,"Romeinse Forten":!1,"Romeinse Forten Lijnen":!1,Windmolens:!1,Erfgoedlijnen:!1,"Oude Kernen":!1,"Relictenkaart Punten":!1,"Relictenkaart Lijnen":!1,"Relictenkaart Vlakken":!1,"Verdronken Dorpen":!1,"Mijn Vondsten":!0},opacity:{"AHN4 Hoogtekaart Kleur":.85,"AHN4 Hillshade NL":.7,"AHN4 Multi-Hillshade NL":.7,"AHN4 Hillshade Kleur":.8,"AHN 0.5m":.7,"TMK 1850":.8,"Bonnebladen 1900":.8,Geomorfologie:.5,Bodemkaart:.6,Veengebieden:.6,IKAW:.5,"FAMKE Steentijd":.6,"FAMKE IJzertijd":.6,Essen:.6,Terpen:.7,"AMK Monumenten":.45,"AMK Romeins":.6,"AMK Steentijd":.6,"AMK Vroege ME":.6,"AMK Late ME":.6,"AMK Overig":.6,"Paleokaart 9000 v.Chr.":.7,"Paleokaart 5500 v.Chr.":.7,"Paleokaart 2750 v.Chr.":.7,"Paleokaart 1500 v.Chr.":.7,"Paleokaart 500 v.Chr.":.7,"Paleokaart 100 n.Chr.":.7,"Paleokaart 800 n.Chr.":.7,Verdedigingslinies:.7,Inundatiegebieden:.5,"Militaire Objecten":.8,"Religieus Erfgoed":.8,Gewaspercelen:.6,"Kadastrale Grenzen":.7,Erfgoedlijnen:.7,"Oude Kernen":.6,"Relictenkaart Vlakken":.5},loadingState:{},layers:{},arcgisLayers:{},toggleLayer:n=>{const r=e(),i=!r.visible[n];t(a=>{a.visible[n]=i}),Sy[n]?.platform==="arcgis"?i&&!r.arcgisLayers[n]?e().loadLayer(n):r.arcgisLayers[n]&&(r.arcgisLayers[n].visible=i):i&&!r.layers[n]?e().loadLayer(n):r.layers[n]&&r.layers[n].setVisible(i)},setLayerVisibility:(n,r)=>{const i=e(),o=Sy[n]?.platform==="arcgis";t(l=>{if(l.visible[n]=r,o){const c=l.arcgisLayers[n];c&&(c.visible=r)}else{const c=l.layers[n];c&&c.setVisible(r)}});const a=o?i.arcgisLayers[n]:i.layers[n];r&&!a&&e().loadLayer(n)},setLayerOpacity:(n,r)=>{const s=Sy[n]?.platform==="arcgis";t(o=>{if(o.opacity[n]=r,s){const a=o.arcgisLayers[n];a&&(a.opacity=r)}else{const a=o.layers[n];a&&a.setOpacity(r)}})},registerLayer:(n,r)=>{t(i=>{i.layers[n]=r,i.loadingState[n]="loaded",i.visible[n]!==void 0&&r.setVisible(i.visible[n]),i.opacity[n]!==void 0&&r.setOpacity(i.opacity[n])})},registerArcGISLayer:(n,r)=>{t(i=>{i.arcgisLayers[n]=r,i.loadingState[n]="loaded",i.visible[n]!==void 0&&(r.visible=i.visible[n]),i.opacity[n]!==void 0&&(r.opacity=i.opacity[n])})},unregisterLayer:n=>{t(r=>{delete r.layers[n],delete r.arcgisLayers[n],delete r.loadingState[n]})},loadLayer:async n=>{const r=e(),i=Sy[n];if(!i){console.warn(` Layer "${n}" not found in registry`);return}const s=i.platform==="arcgis";if(r.loadingState[n]==="loading"||s&&r.arcgisLayers[n]||!s&&r.layers[n])return;const o=es.getState();if(s){if(!o.arcgisMap||!o.arcgisInitialized){console.warn(` Cannot load ArcGIS layer "${n}": ArcGIS map not initialized`);return}}else if(!o.map){console.warn(` Cannot load layer "${n}": map not initialized`);return}t(a=>{a.loadingState[n]="loading"}),console.log(` Loading ${s?"ArcGIS":"OL"} layer: ${n}...`);try{const a=await i.factory();if(!a)throw new Error("Factory returned null");const l=e();if(s){const c=a;c.visible=l.visible[n]??!1,l.opacity[n]!==void 0&&(c.opacity=l.opacity[n]),o.arcgisMap.add(c),t(u=>{u.arcgisLayers[n]=c,u.loadingState[n]="loaded"})}else{const c=a;c.setVisible(l.visible[n]??!1),l.opacity[n]!==void 0&&c.setOpacity(l.opacity[n]),o.map.addLayer(c),t(u=>{u.layers[n]=c,u.loadingState[n]="loaded"})}console.log(` Layer loaded: ${n}`)}catch(a){console.error(` Failed to load layer "${n}":`,a),t(l=>{l.loadingState[n]="error"})}}}))),ri=No()(L2((t,e)=>({layerControlOpen:!1,legendOpen:!1,backgroundsPanelOpen:!1,themesPanelOpen:!1,settingsPanelOpen:!1,infoPanelOpen:!1,presetsPanelOpen:!1,monumentSearchOpen:!1,vondstFormOpen:!1,vondstFormLocation:null,vondstFormPhoto:null,vondstDashboardOpen:!1,createLayerModalOpen:!1,addPointModalOpen:!1,addPointModalLayerId:null,addPointModalLocation:null,layerManagerModalOpen:!1,layerDashboardOpen:!1,layerDashboardLayerId:null,routeDashboardOpen:!1,collapsedCategories:new Set,closeAllPanels:()=>{t(n=>{n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1})},toggleLayerControl:()=>{t(n=>{n.layerControlOpen=!n.layerControlOpen})},toggleLegend:()=>{t(n=>{n.legendOpen=!n.legendOpen})},toggleBackgroundsPanel:()=>{t(n=>{const r=n.backgroundsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.backgroundsPanelOpen=!0)})},toggleThemesPanel:()=>{t(n=>{const r=n.themesPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.themesPanelOpen=!0)})},toggleSettingsPanel:()=>{t(n=>{const r=n.settingsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.settingsPanelOpen=!0)})},toggleInfoPanel:()=>{t(n=>{const r=n.infoPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.infoPanelOpen=!0)})},togglePresetsPanel:()=>{t(n=>{const r=n.presetsPanelOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,r||(n.presetsPanelOpen=!0)})},toggleCategory:n=>{t(r=>{r.collapsedCategories.has(n)?r.collapsedCategories.delete(n):r.collapsedCategories.add(n)})},setLayerControlOpen:n=>{t(r=>{r.layerControlOpen=n})},setLegendOpen:n=>{t(r=>{r.legendOpen=n})},openVondstForm:(n,r)=>{t(i=>{i.backgroundsPanelOpen=!1,i.themesPanelOpen=!1,i.settingsPanelOpen=!1,i.infoPanelOpen=!1,i.presetsPanelOpen=!1,i.vondstFormOpen=!0,i.vondstFormLocation=n||null,i.vondstFormPhoto=r||null})},closeVondstForm:()=>{t(n=>{n.vondstFormOpen=!1,n.vondstFormLocation=null,n.vondstFormPhoto=null})},toggleVondstDashboard:()=>{t(n=>{const r=n.vondstDashboardOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.vondstDashboardOpen=!r})},openCreateLayerModal:()=>{t(n=>{n.createLayerModalOpen=!0})},closeCreateLayerModal:()=>{t(n=>{n.createLayerModalOpen=!1})},openAddPointModal:(n,r)=>{t(i=>{i.addPointModalOpen=!0,i.addPointModalLayerId=n,i.addPointModalLocation=r})},closeAddPointModal:()=>{t(n=>{n.addPointModalOpen=!1,n.addPointModalLayerId=null,n.addPointModalLocation=null})},openLayerManagerModal:()=>{t(n=>{n.layerManagerModalOpen=!0})},closeLayerManagerModal:()=>{t(n=>{n.layerManagerModalOpen=!1})},openLayerDashboard:n=>{t(r=>{r.layerDashboardOpen=!0,r.layerDashboardLayerId=n,r.layerManagerModalOpen=!1})},closeLayerDashboard:()=>{t(n=>{n.layerDashboardOpen=!1,n.layerDashboardLayerId=null})},toggleRouteDashboard:()=>{t(n=>{n.routeDashboardOpen=!n.routeDashboardOpen})},toggleMonumentSearch:()=>{t(n=>{const r=n.monumentSearchOpen;n.backgroundsPanelOpen=!1,n.themesPanelOpen=!1,n.settingsPanelOpen=!1,n.infoPanelOpen=!1,n.presetsPanelOpen=!1,n.monumentSearchOpen=!r})},closeMonumentSearch:()=>{t(n=>{n.monumentSearchOpen=!1})}}))),BPe=()=>{};var LX={};const Rle=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},WPe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Ple={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(f=64)),r.push(n[u],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Rle(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):WPe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new HPe;const f=s<<2|a>>4;if(r.push(f),c!==64){const g=a<<4&240|c>>2;if(r.push(g),h!==64){const v=c<<6&192|h;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class HPe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qPe=function(t){const e=Rle(t);return Ple.encodeByteArray(e,!0)},S3=function(t){return qPe(t).replace(/\./g,"")},Mle=function(t){try{return Ple.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Cle(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const KPe=()=>Cle().__FIREBASE_DEFAULTS__,YPe=()=>{if(typeof process>"u"||typeof LX>"u")return;const t=LX.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XPe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Mle(t[1]);return e&&JSON.parse(e)},d5=()=>{try{return BPe()||KPe()||YPe()||XPe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Nle=t=>d5()?.emulatorHosts?.[t],Ole=t=>{const e=Nle(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Lle=()=>d5()?.config,Dle=t=>d5()?.[`_${t}`];let ZPe=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};function J1(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function nU(t){return(await fetch(t,{credentials:"include"})).ok}function $le(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...t};return[S3(JSON.stringify(n)),S3(JSON.stringify(o)),""].join(".")}const jS={};function JPe(){const t={prod:[],emulator:[]};for(const e of Object.keys(jS))jS[e]?t.emulator.push(e):t.prod.push(e);return t}function QPe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let DX=!1;function rU(t,e){if(typeof window>"u"||typeof document>"u"||!J1(window.location.host)||jS[t]===e||jS[t]||DX)return;jS[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",s=JPe().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{DX=!0,o()},f}function u(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=QPe(r),g=n("text"),v=document.getElementById(g)||document.createElement("span"),x=n("learnmore"),b=document.getElementById(x)||document.createElement("a"),T=n("preprendIcon"),A=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const I=f.element;a(I),u(b,x);const R=c();l(A,T),I.append(A,v,b,R),document.body.appendChild(I)}s?(v.innerText="Preview backend disconnected.",A.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(A.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}function Us(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eMe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Us())}function jle(){const t=d5()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tMe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nMe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function rMe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function iMe(){const t=Us();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Fle(){return!jle()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vle(){return!jle()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function zle(){try{return typeof indexedDB=="object"}catch{return!1}}function sMe(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(n){e(n)}})}const oMe="FirebaseError";class Od extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=oMe,Object.setPrototypeOf(this,Od.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,MA.prototype.create)}}class MA{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?aMe(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Od(i,a,r)}}function aMe(t,e){return t.replace(lMe,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const lMe=/\{\$([^}]+)}/g;function cMe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function y1(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if($X(s)&&$X(o)){if(!y1(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function $X(t){return t!==null&&typeof t=="object"}function CA(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function uMe(t,e){const n=new hMe(t,e);return n.subscribe.bind(n)}class hMe{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");dMe(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=S6),i.error===void 0&&(i.error=S6),i.complete===void 0&&(i.complete=S6);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dMe(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function S6(){}function co(t){return t&&t._delegate?t._delegate:t}class Sg{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const F0="[DEFAULT]";class fMe{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ZPe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mMe(e))try{this.getOrInitializeService({instanceIdentifier:F0})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=F0){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=F0){return this.instances.has(e)}getOptions(e=F0){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pMe(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=F0){return this.component?this.component.multipleInstances?e:F0:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pMe(t){return t===F0?void 0:t}function mMe(t){return t.instantiationMode==="EAGER"}class gMe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new fMe(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Jn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Jn||(Jn={}));const yMe={debug:Jn.DEBUG,verbose:Jn.VERBOSE,info:Jn.INFO,warn:Jn.WARN,error:Jn.ERROR,silent:Jn.SILENT},vMe=Jn.INFO,_Me={[Jn.DEBUG]:"log",[Jn.VERBOSE]:"log",[Jn.INFO]:"info",[Jn.WARN]:"warn",[Jn.ERROR]:"error"},xMe=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=_Me[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iU{constructor(e){this.name=e,this._logLevel=vMe,this._logHandler=xMe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Jn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yMe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Jn.DEBUG,...e),this._logHandler(this,Jn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Jn.VERBOSE,...e),this._logHandler(this,Jn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Jn.INFO,...e),this._logHandler(this,Jn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Jn.WARN,...e),this._logHandler(this,Jn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Jn.ERROR,...e),this._logHandler(this,Jn.ERROR,...e)}}const wMe=(t,e)=>e.some(n=>t instanceof n);let jX,FX;function bMe(){return jX||(jX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EMe(){return FX||(FX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ule=new WeakMap,xj=new WeakMap,Gle=new WeakMap,T6=new WeakMap,sU=new WeakMap;function SMe(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(lg(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Ule.set(n,t)}).catch(()=>{}),sU.set(e,t),e}function TMe(t){if(xj.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});xj.set(t,e)}let wj={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xj.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Gle.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return lg(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function kMe(t){wj=t(wj)}function AMe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(k6(this),e,...n);return Gle.set(r,e.sort?e.sort():[e]),lg(r)}:EMe().includes(t)?function(...e){return t.apply(k6(this),e),lg(Ule.get(this))}:function(...e){return lg(t.apply(k6(this),e))}}function IMe(t){return typeof t=="function"?AMe(t):(t instanceof IDBTransaction&&TMe(t),wMe(t,bMe())?new Proxy(t,wj):t)}function lg(t){if(t instanceof IDBRequest)return SMe(t);if(T6.has(t))return T6.get(t);const e=IMe(t);return e!==t&&(T6.set(t,e),sU.set(e,t)),e}const k6=t=>sU.get(t);function RMe(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=lg(o);return r&&o.addEventListener("upgradeneeded",l=>{r(lg(o.result),l.oldVersion,l.newVersion,lg(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const PMe=["get","getKey","getAll","getAllKeys","count"],MMe=["put","add","delete","clear"],A6=new Map;function VX(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(A6.get(e))return A6.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=MMe.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||PMe.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return A6.set(e,s),s}kMe(t=>({...t,get:(e,n,r)=>VX(e,n)||t.get(e,n,r),has:(e,n)=>!!VX(e,n)||t.has(e,n)}));class CMe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(NMe(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function NMe(t){return t.getComponent()?.type==="VERSION"}const bj="@firebase/app",zX="0.14.6";const rp=new iU("@firebase/app"),OMe="@firebase/app-compat",LMe="@firebase/analytics-compat",DMe="@firebase/analytics",$Me="@firebase/app-check-compat",jMe="@firebase/app-check",FMe="@firebase/auth",VMe="@firebase/auth-compat",zMe="@firebase/database",UMe="@firebase/data-connect",GMe="@firebase/database-compat",BMe="@firebase/functions",WMe="@firebase/functions-compat",HMe="@firebase/installations",qMe="@firebase/installations-compat",KMe="@firebase/messaging",YMe="@firebase/messaging-compat",XMe="@firebase/performance",ZMe="@firebase/performance-compat",JMe="@firebase/remote-config",QMe="@firebase/remote-config-compat",eCe="@firebase/storage",tCe="@firebase/storage-compat",nCe="@firebase/firestore",rCe="@firebase/ai",iCe="@firebase/firestore-compat",sCe="firebase",oCe="12.6.0";const Ej="[DEFAULT]",aCe={[bj]:"fire-core",[OMe]:"fire-core-compat",[DMe]:"fire-analytics",[LMe]:"fire-analytics-compat",[jMe]:"fire-app-check",[$Me]:"fire-app-check-compat",[FMe]:"fire-auth",[VMe]:"fire-auth-compat",[zMe]:"fire-rtdb",[UMe]:"fire-data-connect",[GMe]:"fire-rtdb-compat",[BMe]:"fire-fn",[WMe]:"fire-fn-compat",[HMe]:"fire-iid",[qMe]:"fire-iid-compat",[KMe]:"fire-fcm",[YMe]:"fire-fcm-compat",[XMe]:"fire-perf",[ZMe]:"fire-perf-compat",[JMe]:"fire-rc",[QMe]:"fire-rc-compat",[eCe]:"fire-gcs",[tCe]:"fire-gcs-compat",[nCe]:"fire-fst",[iCe]:"fire-fst-compat",[rCe]:"fire-vertex","fire-js":"fire-js",[sCe]:"fire-js-all"};const T3=new Map,lCe=new Map,Sj=new Map;function UX(t,e){try{t.container.addComponent(e)}catch(n){rp.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function v1(t){const e=t.name;if(Sj.has(e))return rp.debug(`There were multiple attempts to register component ${e}.`),!1;Sj.set(e,t);for(const n of T3.values())UX(n,t);for(const n of lCe.values())UX(n,t);return!0}function f5(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ec(t){return t==null?!1:t.settings!==void 0}const cCe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cg=new MA("app","Firebase",cCe);class uCe{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Sg("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cg.create("app-deleted",{appName:this._name})}}const Q1=oCe;function Ble(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Ej,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw cg.create("bad-app-name",{appName:String(i)});if(n||(n=Lle()),!n)throw cg.create("no-options");const s=T3.get(i);if(s){if(y1(n,s.options)&&y1(r,s.config))return s;throw cg.create("duplicate-app",{appName:i})}const o=new gMe(i);for(const l of Sj.values())o.addComponent(l);const a=new uCe(n,r,o);return T3.set(i,a),a}function oU(t=Ej){const e=T3.get(t);if(!e&&t===Ej&&Lle())return Ble();if(!e)throw cg.create("no-app",{appName:t});return e}function ld(t,e,n){let r=aCe[t]??t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rp.warn(o.join(" "));return}v1(new Sg(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const hCe="firebase-heartbeat-database",dCe=1,sk="firebase-heartbeat-store";let I6=null;function Wle(){return I6||(I6=RMe(hCe,dCe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(sk)}catch(n){console.warn(n)}}}}).catch(t=>{throw cg.create("idb-open",{originalErrorMessage:t.message})})),I6}async function fCe(t){try{const n=(await Wle()).transaction(sk),r=await n.objectStore(sk).get(Hle(t));return await n.done,r}catch(e){if(e instanceof Od)rp.warn(e.message);else{const n=cg.create("idb-get",{originalErrorMessage:e?.message});rp.warn(n.message)}}}async function GX(t,e){try{const r=(await Wle()).transaction(sk,"readwrite");await r.objectStore(sk).put(e,Hle(t)),await r.done}catch(n){if(n instanceof Od)rp.warn(n.message);else{const r=cg.create("idb-set",{originalErrorMessage:n?.message});rp.warn(r.message)}}}function Hle(t){return`${t.name}!${t.options.appId}`}const pCe=1024,mCe=30;class gCe{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new vCe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=BX();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>mCe){const i=_Ce(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){rp.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=BX(),{heartbeatsToSend:n,unsentEntries:r}=yCe(this._heartbeatsCache.heartbeats),i=S3(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return rp.warn(e),""}}}function BX(){return new Date().toISOString().substring(0,10)}function yCe(t,e=pCe){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),WX(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),WX(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class vCe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zle()?sMe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await fCe(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return GX(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return GX(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function WX(t){return S3(JSON.stringify({version:2,heartbeats:t})).length}function _Ce(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function xCe(t){v1(new Sg("platform-logger",e=>new CMe(e),"PRIVATE")),v1(new Sg("heartbeat",e=>new gCe(e),"PRIVATE")),ld(bj,zX,t),ld(bj,zX,"esm2020"),ld("fire-js","")}xCe("");function qle(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wCe=qle,Kle=new MA("auth","Firebase",qle());const k3=new iU("@firebase/auth");function bCe(t,...e){k3.logLevel<=Jn.WARN&&k3.warn(`Auth (${Q1}): ${t}`,...e)}function bM(t,...e){k3.logLevel<=Jn.ERROR&&k3.error(`Auth (${Q1}): ${t}`,...e)}function wd(t,...e){throw lU(t,...e)}function nh(t,...e){return lU(t,...e)}function aU(t,e,n){const r={...wCe(),[e]:n};return new MA("auth","Firebase",r).create(e,{appName:t.name})}function ug(t){return aU(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ECe(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&wd(t,"argument-error"),aU(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function lU(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Kle.create(t,...e)}function kn(t,e,...n){if(!t)throw lU(e,...n)}function Df(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bM(e),new Error(e)}function ip(t,e){t||Df(e)}function Tj(){return typeof self<"u"&&self.location?.href||""}function SCe(){return HX()==="http:"||HX()==="https:"}function HX(){return typeof self<"u"&&self.location?.protocol||null}function TCe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(SCe()||nMe()||"connection"in navigator)?navigator.onLine:!0}function kCe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class NA{constructor(e,n){this.shortDelay=e,this.longDelay=n,ip(n>e,"Short delay should be less than long delay!"),this.isMobile=eMe()||rMe()}get(){return TCe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cU(t,e){ip(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Yle{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Df("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Df("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Df("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ACe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const ICe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RCe=new NA(3e4,6e4);function p5(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function D2(t,e,n,r,i={}){return Xle(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=CA({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...s};return tMe()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&J1(t.emulatorConfig.host)&&(c.credentials="include"),Yle.fetch()(await Jle(t,t.config.apiHost,n,a),c)})}async function Xle(t,e,n){t._canInitEmulator=!1;const r={...ACe,...e};try{const i=new PCe(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw nP(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw nP(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw nP(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw nP(t,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw aU(t,u,c);wd(t,u)}}catch(i){if(i instanceof Od)throw i;wd(t,"network-request-failed",{message:String(i)})}}async function Zle(t,e,n,r,i={}){const s=await D2(t,e,n,r,i);return"mfaPendingCredential"in s&&wd(t,"multi-factor-auth-required",{_serverResponse:s}),s}async function Jle(t,e,n,r){const i=`${e}${n}?${r}`,s=t,o=s.config.emulator?cU(t.config,i):`${t.config.apiScheme}://${i}`;return ICe.includes(n)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}class PCe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(nh(this.auth,"network-request-failed")),RCe.get())})}}function nP(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=nh(t,e,r);return i.customData._tokenResponse=n,i}async function MCe(t,e){return D2(t,"POST","/v1/accounts:delete",e)}async function A3(t,e){return D2(t,"POST","/v1/accounts:lookup",e)}function FS(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function CCe(t,e=!1){const n=co(t),r=await n.getIdToken(e),i=uU(r);kn(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:FS(R6(i.auth_time)),issuedAtTime:FS(R6(i.iat)),expirationTime:FS(R6(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function R6(t){return Number(t)*1e3}function uU(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return bM("JWT malformed, contained fewer than 3 sections"),null;try{const i=Mle(n);return i?JSON.parse(i):(bM("Failed to decode base64 JWT payload"),null)}catch(i){return bM("Caught error parsing JWT payload as JSON",i?.toString()),null}}function qX(t){const e=uU(t);return kn(e,"internal-error"),kn(typeof e.exp<"u","internal-error"),kn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ok(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Od&&NCe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function NCe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class OCe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class kj{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=FS(this.lastLoginAt),this.creationTime=FS(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function I3(t){const e=t.auth,n=await t.getIdToken(),r=await ok(t,A3(e,{idToken:n}));kn(r?.users.length,e,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const s=i.providerUserInfo?.length?Qle(i.providerUserInfo):[],o=DCe(t.providerData,s),a=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!o?.length,c=a?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new kj(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function LCe(t){const e=co(t);await I3(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function DCe(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Qle(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function $Ce(t,e){const n=await Xle(t,{},async()=>{const r=CA({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=await Jle(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:r};return t.emulatorConfig&&J1(t.emulatorConfig.host)&&(l.credentials="include"),Yle.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function jCe(t,e){return D2(t,"POST","/v2/accounts:revokeToken",p5(t,e))}class jx{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kn(e.idToken,"internal-error"),kn(typeof e.idToken<"u","internal-error"),kn(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qX(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){kn(e.length!==0,"internal-error");const n=qX(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(kn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await $Ce(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new jx;return r&&(kn(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(kn(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(kn(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jx,this.toJSON())}_performRefresh(){return Df("not implemented")}}function Zp(t,e){kn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Yu{constructor({uid:e,auth:n,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new OCe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new kj(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ok(this,this.stsTokenManager.getToken(this.auth,e));return kn(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return CCe(this,e)}reload(){return LCe(this)}_assign(e){this!==e&&(kn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Yu({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){kn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await I3(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ec(this.auth.app))return Promise.reject(ug(this.auth));const e=await this.getIdToken();return await ok(this,MCe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,i=n.email??void 0,s=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,c=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:v,stsTokenManager:x}=n;kn(h&&x,e,"internal-error");const b=jx.fromJSON(this.name,x);kn(typeof h=="string",e,"internal-error"),Zp(r,e.name),Zp(i,e.name),kn(typeof f=="boolean",e,"internal-error"),kn(typeof g=="boolean",e,"internal-error"),Zp(s,e.name),Zp(o,e.name),Zp(a,e.name),Zp(l,e.name),Zp(c,e.name),Zp(u,e.name);const T=new Yu({uid:h,auth:e,email:i,emailVerified:f,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:b,createdAt:c,lastLoginAt:u});return v&&Array.isArray(v)&&(T.providerData=v.map(A=>({...A}))),l&&(T._redirectEventId=l),T}static async _fromIdTokenResponse(e,n,r=!1){const i=new jx;i.updateFromServerResponse(n);const s=new Yu({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await I3(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];kn(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Qle(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new jx;a.updateFromIdToken(r);const l=new Yu({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new kj(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,c),l}}const KX=new Map;function $f(t){ip(t instanceof Function,"Expected a class definition");let e=KX.get(t);return e?(ip(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,KX.set(t,e),e)}class ece{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ece.type="NONE";const YX=ece;function EM(t,e,n){return`firebase:${t}:${e}:${n}`}class Fx{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=EM(this.userKey,i.apiKey,s),this.fullPersistenceKey=EM("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await A3(this.auth,{idToken:e}).catch(()=>{});return n?Yu._fromGetAccountInfoResponse(this.auth,n,e):null}return Yu._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Fx($f(YX),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||$f(YX);const o=EM(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(o);if(u){let h;if(typeof u=="string"){const f=await A3(e,{idToken:u}).catch(()=>{});if(!f)break;h=await Yu._fromGetAccountInfoResponse(e,f,u)}else h=Yu._fromJSON(e,u);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Fx(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Fx(s,e,r))}}function XX(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ice(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tce(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oce(e))return"Blackberry";if(ace(e))return"Webos";if(nce(e))return"Safari";if((e.includes("chrome/")||rce(e))&&!e.includes("edge/"))return"Chrome";if(sce(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function tce(t=Us()){return/firefox\//i.test(t)}function nce(t=Us()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rce(t=Us()){return/crios\//i.test(t)}function ice(t=Us()){return/iemobile/i.test(t)}function sce(t=Us()){return/android/i.test(t)}function oce(t=Us()){return/blackberry/i.test(t)}function ace(t=Us()){return/webos/i.test(t)}function hU(t=Us()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function FCe(t=Us()){return hU(t)&&!!window.navigator?.standalone}function VCe(){return iMe()&&document.documentMode===10}function lce(t=Us()){return hU(t)||sce(t)||ace(t)||oce(t)||/windows phone/i.test(t)||ice(t)}function cce(t,e=[]){let n;switch(t){case"Browser":n=XX(Us());break;case"Worker":n=`${XX(Us())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Q1}/${r}`}class zCe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function UCe(t,e={}){return D2(t,"GET","/v2/passwordPolicy",p5(t,e))}const GCe=6;class BCe{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??GCe,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class WCe{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ZX(this),this.idTokenSubscription=new ZX(this),this.beforeStateQueue=new zCe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kle,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=$f(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Fx.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await A3(this,{idToken:e}),r=await Yu._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ec(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===o)&&a?.user&&(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return kn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await I3(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kCe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ec(this.app))return Promise.reject(ug(this));const n=e?co(e):null;return n&&kn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&kn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ec(this.app)?Promise.reject(ug(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ec(this.app)?Promise.reject(ug(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($f(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await UCe(this),n=new BCe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new MA("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await jCe(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&$f(e)||this._popupRedirectResolver;kn(n,this,"argument-error"),this.redirectPersistenceManager=await Fx.create(this,[$f(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(kn(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=cce(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(ec(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&bCe(`Error while retrieving App Check token: ${e.error}`),e?.token}}function OA(t){return co(t)}class ZX{constructor(e){this.auth=e,this.observer=null,this.addObserver=uMe(n=>this.observer=n)}get next(){return kn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let dU={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function HCe(t){dU=t}function qCe(t){return dU.loadJS(t)}function KCe(){return dU.gapiScript}function YCe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function XCe(t,e){const n=f5(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(y1(s,e??{}))return i;wd(i,"already-initialized")}return n.initialize({options:e})}function ZCe(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map($f);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function JCe(t,e,n){const r=OA(t);kn(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=uce(e),{host:o,port:a}=QCe(e),l=a===null?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){kn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),kn(y1(c,r.config.emulator)&&y1(u,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,J1(o)?(nU(`${s}//${o}${l}`),rU("Auth",!0)):e3e()}function uce(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function QCe(t){const e=uce(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:JX(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:JX(o)}}}function JX(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function e3e(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class hce{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Df("not implemented")}_getIdTokenResponse(e){return Df("not implemented")}_linkToIdToken(e,n){return Df("not implemented")}_getReauthenticationResolver(e){return Df("not implemented")}}async function Vx(t,e){return Zle(t,"POST","/v1/accounts:signInWithIdp",p5(t,e))}const t3e="http://localhost";class _1 extends hce{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new _1(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):wd("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=n;if(!r||!i)return null;const o=new _1(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Vx(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Vx(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Vx(e,n)}buildRequest(){const e={requestUri:t3e,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=CA(n)}return e}}class fU{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class LA extends fU{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Om extends LA{constructor(){super("facebook.com")}static credential(e){return _1._fromParams({providerId:Om.PROVIDER_ID,signInMethod:Om.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Om.credentialFromTaggedObject(e)}static credentialFromError(e){return Om.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Om.credential(e.oauthAccessToken)}catch{return null}}}Om.FACEBOOK_SIGN_IN_METHOD="facebook.com";Om.PROVIDER_ID="facebook.com";class Wu extends LA{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return _1._fromParams({providerId:Wu.PROVIDER_ID,signInMethod:Wu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Wu.credentialFromTaggedObject(e)}static credentialFromError(e){return Wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Wu.credential(n,r)}catch{return null}}}Wu.GOOGLE_SIGN_IN_METHOD="google.com";Wu.PROVIDER_ID="google.com";class Lm extends LA{constructor(){super("github.com")}static credential(e){return _1._fromParams({providerId:Lm.PROVIDER_ID,signInMethod:Lm.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lm.credentialFromTaggedObject(e)}static credentialFromError(e){return Lm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Lm.credential(e.oauthAccessToken)}catch{return null}}}Lm.GITHUB_SIGN_IN_METHOD="github.com";Lm.PROVIDER_ID="github.com";class Dm extends LA{constructor(){super("twitter.com")}static credential(e,n){return _1._fromParams({providerId:Dm.PROVIDER_ID,signInMethod:Dm.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Dm.credentialFromTaggedObject(e)}static credentialFromError(e){return Dm.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Dm.credential(n,r)}catch{return null}}}Dm.TWITTER_SIGN_IN_METHOD="twitter.com";Dm.PROVIDER_ID="twitter.com";async function n3e(t,e){return Zle(t,"POST","/v1/accounts:signUp",p5(t,e))}class Tg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Yu._fromIdTokenResponse(e,r,i),o=QX(r);return new Tg({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=QX(r);return new Tg({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function QX(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function r3e(t){if(ec(t.app))return Promise.reject(ug(t));const e=OA(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Tg({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await n3e(e,{returnSecureToken:!0}),r=await Tg._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}class R3 extends Od{constructor(e,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,R3.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new R3(e,n,r,i)}}function dce(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?R3._fromErrorAndOperation(t,s,e,r):s})}async function i3e(t,e,n=!1){const r=await ok(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Tg._forOperation(t,"link",r)}async function s3e(t,e,n=!1){const{auth:r}=t;if(ec(r.app))return Promise.reject(ug(r));const i="reauthenticate";try{const s=await ok(t,dce(r,i,e,t),n);kn(s.idToken,r,"internal-error");const o=uU(s.idToken);kn(o,r,"internal-error");const{sub:a}=o;return kn(t.uid===a,r,"user-mismatch"),Tg._forOperation(t,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&wd(r,"user-mismatch"),s}}async function o3e(t,e,n=!1){if(ec(t.app))return Promise.reject(ug(t));const r="signIn",i=await dce(t,r,e),s=await Tg._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}function a3e(t,e,n,r){return co(t).onIdTokenChanged(e,n,r)}function l3e(t,e,n){return co(t).beforeAuthStateChanged(e,n)}function fce(t,e,n,r){return co(t).onAuthStateChanged(e,n,r)}function pce(t){return co(t).signOut()}const P3="__sak";class mce{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(P3,"1"),this.storage.removeItem(P3),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const c3e=1e3,u3e=10;class gce extends mce{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lce(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);VCe()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,u3e):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},c3e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}gce.type="LOCAL";const h3e=gce;class yce extends mce{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}yce.type="SESSION";const vce=yce;function d3e(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class m5{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new m5(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await d3e(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}m5.receivers=[];function pU(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class f3e{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=pU("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function cd(){return window}function p3e(t){cd().location.href=t}function _ce(){return typeof cd().WorkerGlobalScope<"u"&&typeof cd().importScripts=="function"}async function m3e(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function g3e(){return navigator?.serviceWorker?.controller||null}function y3e(){return _ce()?self:null}const xce="firebaseLocalStorageDb",v3e=1,M3="firebaseLocalStorage",wce="fbase_key";class DA{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function g5(t,e){return t.transaction([M3],e?"readwrite":"readonly").objectStore(M3)}function _3e(){const t=indexedDB.deleteDatabase(xce);return new DA(t).toPromise()}function Aj(){const t=indexedDB.open(xce,v3e);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(M3,{keyPath:wce})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(M3)?e(r):(r.close(),await _3e(),e(await Aj()))})})}async function eZ(t,e,n){const r=g5(t,!0).put({[wce]:e,value:n});return new DA(r).toPromise()}async function x3e(t,e){const n=g5(t,!1).get(e),r=await new DA(n).toPromise();return r===void 0?null:r.value}function tZ(t,e){const n=g5(t,!0).delete(e);return new DA(n).toPromise()}const w3e=800,b3e=3;class bce{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Aj(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>b3e)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _ce()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=m5._getInstance(y3e()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await m3e(),!this.activeServiceWorker)return;this.sender=new f3e(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||g3e()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Aj();return await eZ(e,P3,"1"),await tZ(e,P3),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>eZ(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>x3e(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tZ(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=g5(i,!1).getAll();return new DA(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),w3e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}bce.type="LOCAL";const E3e=bce;new NA(3e4,6e4);function Ece(t,e){return e?$f(e):(kn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class mU extends hce{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vx(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Vx(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Vx(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function S3e(t){return o3e(t.auth,new mU(t),t.bypassAuthState)}function T3e(t){const{auth:e,user:n}=t;return kn(n,e,"internal-error"),s3e(n,new mU(t),t.bypassAuthState)}async function k3e(t){const{auth:e,user:n}=t;return kn(n,e,"internal-error"),i3e(n,new mU(t),t.bypassAuthState)}class Sce{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return S3e;case"linkViaPopup":case"linkViaRedirect":return k3e;case"reauthViaPopup":case"reauthViaRedirect":return T3e;default:wd(this.auth,"internal-error")}}resolve(e){ip(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ip(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const A3e=new NA(2e3,1e4);async function nZ(t,e,n){if(ec(t.app))return Promise.reject(nh(t,"operation-not-supported-in-this-environment"));const r=OA(t);ECe(t,e,fU);const i=Ece(r,n);return new Ty(r,"signInViaPopup",e,i).executeNotNull()}class Ty extends Sce{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ty.currentPopupAction&&Ty.currentPopupAction.cancel(),Ty.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kn(e,this.auth,"internal-error"),e}async onExecution(){ip(this.filter.length===1,"Popup operations only handle one event");const e=pU();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(nh(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nh(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ty.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nh(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,A3e.get())};e()}}Ty.currentPopupAction=null;const I3e="pendingRedirect",SM=new Map;class R3e extends Sce{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=SM.get(this.auth._key());if(!e){try{const r=await P3e(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}SM.set(this.auth._key(),e)}return this.bypassAuthState||SM.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function P3e(t,e){const n=N3e(e),r=C3e(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function M3e(t,e){SM.set(t._key(),e)}function C3e(t){return $f(t._redirectPersistence)}function N3e(t){return EM(I3e,t.config.apiKey,t.name)}async function O3e(t,e,n=!1){if(ec(t.app))return Promise.reject(ug(t));const r=OA(t),i=Ece(r,e),o=await new R3e(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const L3e=600*1e3;class D3e{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$3e(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!Tce(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(nh(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=L3e&&this.cachedEventUids.clear(),this.cachedEventUids.has(rZ(e))}saveEventToCache(e){this.cachedEventUids.add(rZ(e)),this.lastProcessedEventTime=Date.now()}}function rZ(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Tce({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function $3e(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tce(t);default:return!1}}async function j3e(t,e={}){return D2(t,"GET","/v1/projects",e)}const F3e=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,V3e=/^https?/;async function z3e(t){if(t.config.emulator)return;const{authorizedDomains:e}=await j3e(t);for(const n of e)try{if(U3e(n))return}catch{}wd(t,"unauthorized-domain")}function U3e(t){const e=Tj(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!V3e.test(n))return!1;if(F3e.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const G3e=new NA(3e4,6e4);function iZ(){const t=cd().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function B3e(t){return new Promise((e,n)=>{function r(){iZ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iZ(),n(nh(t,"network-request-failed"))},timeout:G3e.get()})}if(cd().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cd().gapi?.load)r();else{const i=YCe("iframefcb");return cd()[i]=()=>{gapi.load?r():n(nh(t,"network-request-failed"))},qCe(`${KCe()}?onload=${i}`).catch(s=>n(s))}}).catch(e=>{throw TM=null,e})}let TM=null;function W3e(t){return TM=TM||B3e(t),TM}const H3e=new NA(5e3,15e3),q3e="__/auth/iframe",K3e="emulator/auth/iframe",Y3e={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},X3e=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Z3e(t){const e=t.config;kn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?cU(e,K3e):`https://${t.config.authDomain}/${q3e}`,r={apiKey:e.apiKey,appName:t.name,v:Q1},i=X3e.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${CA(r).slice(1)}`}async function J3e(t){const e=await W3e(t),n=cd().gapi;return kn(n,t,"internal-error"),e.open({where:document.body,url:Z3e(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Y3e,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=nh(t,"network-request-failed"),a=cd().setTimeout(()=>{s(o)},H3e.get());function l(){cd().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}const Q3e={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},e4e=500,t4e=600,n4e="_blank",r4e="http://localhost";class sZ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function i4e(t,e,n,r=e4e,i=t4e){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...Q3e,width:r.toString(),height:i.toString(),top:s,left:o},c=Us().toLowerCase();n&&(a=rce(c)?n4e:n),tce(c)&&(e=e||r4e,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[g,v])=>`${f}${g}=${v},`,"");if(FCe(c)&&a!=="_self")return s4e(e||"",a),new sZ(null);const h=window.open(e||"",a,u);kn(h,t,"popup-blocked");try{h.focus()}catch{}return new sZ(h)}function s4e(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const o4e="__/auth/handler",a4e="emulator/auth/handler",l4e=encodeURIComponent("fac");async function oZ(t,e,n,r,i,s){kn(t.config.authDomain,t,"auth-domain-config-required"),kn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Q1,eventId:i};if(e instanceof fU){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",cMe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))o[u]=h}if(e instanceof LA){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(o.scopes=u.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${l4e}=${encodeURIComponent(l)}`:"";return`${c4e(t)}?${CA(a).slice(1)}${c}`}function c4e({config:t}){return t.emulator?cU(t,a4e):`https://${t.authDomain}/${o4e}`}const P6="webStorageSupport";class u4e{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vce,this._completeRedirectFn=O3e,this._overrideRedirectResult=M3e}async _openPopup(e,n,r,i){ip(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const s=await oZ(e,n,r,Tj(),i);return i4e(e,s,pU())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await oZ(e,n,r,Tj(),i);return p3e(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ip(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await J3e(e),r=new D3e(e);return n.register("authEvent",i=>(kn(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(P6,{type:P6},i=>{const s=i?.[0]?.[P6];s!==void 0&&n(!!s),wd(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=z3e(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return lce()||nce()||hU()}}const h4e=u4e;var aZ="@firebase/auth",lZ="1.12.0";class d4e{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){kn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function f4e(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function p4e(t){v1(new Sg("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;kn(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cce(t)},c=new WCe(r,i,s,l);return ZCe(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),v1(new Sg("auth-internal",e=>{const n=OA(e.getProvider("auth").getImmediate());return(r=>new d4e(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ld(aZ,lZ,f4e(t)),ld(aZ,lZ,"esm2020")}const m4e=300,g4e=Dle("authIdTokenMaxAge")||m4e;let cZ=null;const y4e=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>g4e)return;const i=n?.token;cZ!==i&&(cZ=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function v4e(t=oU()){const e=f5(t,"auth");if(e.isInitialized())return e.getImmediate();const n=XCe(t,{popupRedirectResolver:h4e,persistence:[E3e,h3e,vce]}),r=Dle("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=y4e(s.toString());l3e(n,o,()=>o(n.currentUser)),a3e(n,a=>o(a))}}const i=Nle("auth");return i&&JCe(n,`http://${i}`),n}function _4e(){return document.getElementsByTagName("head")?.[0]??document}HCe({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=nh("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",_4e().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});p4e("Browser");var x4e="firebase",w4e="12.7.0";ld(x4e,w4e,"app");var uZ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hg,kce;(function(){var t;function e(M,N){function O(){}O.prototype=N.prototype,M.F=N.prototype,M.prototype=new O,M.prototype.constructor=M,M.D=function(F,L,B){for(var U=Array(arguments.length-2),de=2;de<arguments.length;de++)U[de-2]=arguments[de];return N.prototype[L].apply(F,U)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(M,N,O){O||(O=0);const F=Array(16);if(typeof N=="string")for(var L=0;L<16;++L)F[L]=N.charCodeAt(O++)|N.charCodeAt(O++)<<8|N.charCodeAt(O++)<<16|N.charCodeAt(O++)<<24;else for(L=0;L<16;++L)F[L]=N[O++]|N[O++]<<8|N[O++]<<16|N[O++]<<24;N=M.g[0],O=M.g[1],L=M.g[2];let B=M.g[3],U;U=N+(B^O&(L^B))+F[0]+3614090360&4294967295,N=O+(U<<7&4294967295|U>>>25),U=B+(L^N&(O^L))+F[1]+3905402710&4294967295,B=N+(U<<12&4294967295|U>>>20),U=L+(O^B&(N^O))+F[2]+606105819&4294967295,L=B+(U<<17&4294967295|U>>>15),U=O+(N^L&(B^N))+F[3]+3250441966&4294967295,O=L+(U<<22&4294967295|U>>>10),U=N+(B^O&(L^B))+F[4]+4118548399&4294967295,N=O+(U<<7&4294967295|U>>>25),U=B+(L^N&(O^L))+F[5]+1200080426&4294967295,B=N+(U<<12&4294967295|U>>>20),U=L+(O^B&(N^O))+F[6]+2821735955&4294967295,L=B+(U<<17&4294967295|U>>>15),U=O+(N^L&(B^N))+F[7]+4249261313&4294967295,O=L+(U<<22&4294967295|U>>>10),U=N+(B^O&(L^B))+F[8]+1770035416&4294967295,N=O+(U<<7&4294967295|U>>>25),U=B+(L^N&(O^L))+F[9]+2336552879&4294967295,B=N+(U<<12&4294967295|U>>>20),U=L+(O^B&(N^O))+F[10]+4294925233&4294967295,L=B+(U<<17&4294967295|U>>>15),U=O+(N^L&(B^N))+F[11]+2304563134&4294967295,O=L+(U<<22&4294967295|U>>>10),U=N+(B^O&(L^B))+F[12]+1804603682&4294967295,N=O+(U<<7&4294967295|U>>>25),U=B+(L^N&(O^L))+F[13]+4254626195&4294967295,B=N+(U<<12&4294967295|U>>>20),U=L+(O^B&(N^O))+F[14]+2792965006&4294967295,L=B+(U<<17&4294967295|U>>>15),U=O+(N^L&(B^N))+F[15]+1236535329&4294967295,O=L+(U<<22&4294967295|U>>>10),U=N+(L^B&(O^L))+F[1]+4129170786&4294967295,N=O+(U<<5&4294967295|U>>>27),U=B+(O^L&(N^O))+F[6]+3225465664&4294967295,B=N+(U<<9&4294967295|U>>>23),U=L+(N^O&(B^N))+F[11]+643717713&4294967295,L=B+(U<<14&4294967295|U>>>18),U=O+(B^N&(L^B))+F[0]+3921069994&4294967295,O=L+(U<<20&4294967295|U>>>12),U=N+(L^B&(O^L))+F[5]+3593408605&4294967295,N=O+(U<<5&4294967295|U>>>27),U=B+(O^L&(N^O))+F[10]+38016083&4294967295,B=N+(U<<9&4294967295|U>>>23),U=L+(N^O&(B^N))+F[15]+3634488961&4294967295,L=B+(U<<14&4294967295|U>>>18),U=O+(B^N&(L^B))+F[4]+3889429448&4294967295,O=L+(U<<20&4294967295|U>>>12),U=N+(L^B&(O^L))+F[9]+568446438&4294967295,N=O+(U<<5&4294967295|U>>>27),U=B+(O^L&(N^O))+F[14]+3275163606&4294967295,B=N+(U<<9&4294967295|U>>>23),U=L+(N^O&(B^N))+F[3]+4107603335&4294967295,L=B+(U<<14&4294967295|U>>>18),U=O+(B^N&(L^B))+F[8]+1163531501&4294967295,O=L+(U<<20&4294967295|U>>>12),U=N+(L^B&(O^L))+F[13]+2850285829&4294967295,N=O+(U<<5&4294967295|U>>>27),U=B+(O^L&(N^O))+F[2]+4243563512&4294967295,B=N+(U<<9&4294967295|U>>>23),U=L+(N^O&(B^N))+F[7]+1735328473&4294967295,L=B+(U<<14&4294967295|U>>>18),U=O+(B^N&(L^B))+F[12]+2368359562&4294967295,O=L+(U<<20&4294967295|U>>>12),U=N+(O^L^B)+F[5]+4294588738&4294967295,N=O+(U<<4&4294967295|U>>>28),U=B+(N^O^L)+F[8]+2272392833&4294967295,B=N+(U<<11&4294967295|U>>>21),U=L+(B^N^O)+F[11]+1839030562&4294967295,L=B+(U<<16&4294967295|U>>>16),U=O+(L^B^N)+F[14]+4259657740&4294967295,O=L+(U<<23&4294967295|U>>>9),U=N+(O^L^B)+F[1]+2763975236&4294967295,N=O+(U<<4&4294967295|U>>>28),U=B+(N^O^L)+F[4]+1272893353&4294967295,B=N+(U<<11&4294967295|U>>>21),U=L+(B^N^O)+F[7]+4139469664&4294967295,L=B+(U<<16&4294967295|U>>>16),U=O+(L^B^N)+F[10]+3200236656&4294967295,O=L+(U<<23&4294967295|U>>>9),U=N+(O^L^B)+F[13]+681279174&4294967295,N=O+(U<<4&4294967295|U>>>28),U=B+(N^O^L)+F[0]+3936430074&4294967295,B=N+(U<<11&4294967295|U>>>21),U=L+(B^N^O)+F[3]+3572445317&4294967295,L=B+(U<<16&4294967295|U>>>16),U=O+(L^B^N)+F[6]+76029189&4294967295,O=L+(U<<23&4294967295|U>>>9),U=N+(O^L^B)+F[9]+3654602809&4294967295,N=O+(U<<4&4294967295|U>>>28),U=B+(N^O^L)+F[12]+3873151461&4294967295,B=N+(U<<11&4294967295|U>>>21),U=L+(B^N^O)+F[15]+530742520&4294967295,L=B+(U<<16&4294967295|U>>>16),U=O+(L^B^N)+F[2]+3299628645&4294967295,O=L+(U<<23&4294967295|U>>>9),U=N+(L^(O|~B))+F[0]+4096336452&4294967295,N=O+(U<<6&4294967295|U>>>26),U=B+(O^(N|~L))+F[7]+1126891415&4294967295,B=N+(U<<10&4294967295|U>>>22),U=L+(N^(B|~O))+F[14]+2878612391&4294967295,L=B+(U<<15&4294967295|U>>>17),U=O+(B^(L|~N))+F[5]+4237533241&4294967295,O=L+(U<<21&4294967295|U>>>11),U=N+(L^(O|~B))+F[12]+1700485571&4294967295,N=O+(U<<6&4294967295|U>>>26),U=B+(O^(N|~L))+F[3]+2399980690&4294967295,B=N+(U<<10&4294967295|U>>>22),U=L+(N^(B|~O))+F[10]+4293915773&4294967295,L=B+(U<<15&4294967295|U>>>17),U=O+(B^(L|~N))+F[1]+2240044497&4294967295,O=L+(U<<21&4294967295|U>>>11),U=N+(L^(O|~B))+F[8]+1873313359&4294967295,N=O+(U<<6&4294967295|U>>>26),U=B+(O^(N|~L))+F[15]+4264355552&4294967295,B=N+(U<<10&4294967295|U>>>22),U=L+(N^(B|~O))+F[6]+2734768916&4294967295,L=B+(U<<15&4294967295|U>>>17),U=O+(B^(L|~N))+F[13]+1309151649&4294967295,O=L+(U<<21&4294967295|U>>>11),U=N+(L^(O|~B))+F[4]+4149444226&4294967295,N=O+(U<<6&4294967295|U>>>26),U=B+(O^(N|~L))+F[11]+3174756917&4294967295,B=N+(U<<10&4294967295|U>>>22),U=L+(N^(B|~O))+F[2]+718787259&4294967295,L=B+(U<<15&4294967295|U>>>17),U=O+(B^(L|~N))+F[9]+3951481745&4294967295,M.g[0]=M.g[0]+N&4294967295,M.g[1]=M.g[1]+(L+(U<<21&4294967295|U>>>11))&4294967295,M.g[2]=M.g[2]+L&4294967295,M.g[3]=M.g[3]+B&4294967295}r.prototype.v=function(M,N){N===void 0&&(N=M.length);const O=N-this.blockSize,F=this.C;let L=this.h,B=0;for(;B<N;){if(L==0)for(;B<=O;)i(this,M,B),B+=this.blockSize;if(typeof M=="string"){for(;B<N;)if(F[L++]=M.charCodeAt(B++),L==this.blockSize){i(this,F),L=0;break}}else for(;B<N;)if(F[L++]=M[B++],L==this.blockSize){i(this,F),L=0;break}}this.h=L,this.o+=N},r.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var N=1;N<M.length-8;++N)M[N]=0;N=this.o*8;for(var O=M.length-8;O<M.length;++O)M[O]=N&255,N/=256;for(this.v(M),M=Array(16),N=0,O=0;O<4;++O)for(let F=0;F<32;F+=8)M[N++]=this.g[O]>>>F&255;return M};function s(M,N){var O=a;return Object.prototype.hasOwnProperty.call(O,M)?O[M]:O[M]=N(M)}function o(M,N){this.h=N;const O=[];let F=!0;for(let L=M.length-1;L>=0;L--){const B=M[L]|0;F&&B==N||(O[L]=B,F=!1)}this.g=O}var a={};function l(M){return-128<=M&&M<128?s(M,function(N){return new o([N|0],N<0?-1:0)}):new o([M|0],M<0?-1:0)}function c(M){if(isNaN(M)||!isFinite(M))return h;if(M<0)return b(c(-M));const N=[];let O=1;for(let F=0;M>=O;F++)N[F]=M/O|0,O*=4294967296;return new o(N,0)}function u(M,N){if(M.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(M.charAt(0)=="-")return b(u(M.substring(1),N));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=c(Math.pow(N,8));let F=h;for(let B=0;B<M.length;B+=8){var L=Math.min(8,M.length-B);const U=parseInt(M.substring(B,B+L),N);L<8?(L=c(Math.pow(N,L)),F=F.j(L).add(c(U))):(F=F.j(O),F=F.add(c(U)))}return F}var h=l(0),f=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-b(this).m();let M=0,N=1;for(let O=0;O<this.g.length;O++){const F=this.i(O);M+=(F>=0?F:4294967296+F)*N,N*=4294967296}return M},t.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(v(this))return"0";if(x(this))return"-"+b(this).toString(M);const N=c(Math.pow(M,6));var O=this;let F="";for(;;){const L=R(O,N).g;O=T(O,L.j(N));let B=((O.g.length>0?O.g[0]:O.h)>>>0).toString(M);if(O=L,v(O))return B+F;for(;B.length<6;)B="0"+B;F=B+F}},t.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function v(M){if(M.h!=0)return!1;for(let N=0;N<M.g.length;N++)if(M.g[N]!=0)return!1;return!0}function x(M){return M.h==-1}t.l=function(M){return M=T(this,M),x(M)?-1:v(M)?0:1};function b(M){const N=M.g.length,O=[];for(let F=0;F<N;F++)O[F]=~M.g[F];return new o(O,~M.h).add(f)}t.abs=function(){return x(this)?b(this):this},t.add=function(M){const N=Math.max(this.g.length,M.g.length),O=[];let F=0;for(let L=0;L<=N;L++){let B=F+(this.i(L)&65535)+(M.i(L)&65535),U=(B>>>16)+(this.i(L)>>>16)+(M.i(L)>>>16);F=U>>>16,B&=65535,U&=65535,O[L]=U<<16|B}return new o(O,O[O.length-1]&-2147483648?-1:0)};function T(M,N){return M.add(b(N))}t.j=function(M){if(v(this)||v(M))return h;if(x(this))return x(M)?b(this).j(b(M)):b(b(this).j(M));if(x(M))return b(this.j(b(M)));if(this.l(g)<0&&M.l(g)<0)return c(this.m()*M.m());const N=this.g.length+M.g.length,O=[];for(var F=0;F<2*N;F++)O[F]=0;for(F=0;F<this.g.length;F++)for(let L=0;L<M.g.length;L++){const B=this.i(F)>>>16,U=this.i(F)&65535,de=M.i(L)>>>16,me=M.i(L)&65535;O[2*F+2*L]+=U*me,A(O,2*F+2*L),O[2*F+2*L+1]+=B*me,A(O,2*F+2*L+1),O[2*F+2*L+1]+=U*de,A(O,2*F+2*L+1),O[2*F+2*L+2]+=B*de,A(O,2*F+2*L+2)}for(M=0;M<N;M++)O[M]=O[2*M+1]<<16|O[2*M];for(M=N;M<2*N;M++)O[M]=0;return new o(O,0)};function A(M,N){for(;(M[N]&65535)!=M[N];)M[N+1]+=M[N]>>>16,M[N]&=65535,N++}function I(M,N){this.g=M,this.h=N}function R(M,N){if(v(N))throw Error("division by zero");if(v(M))return new I(h,h);if(x(M))return N=R(b(M),N),new I(b(N.g),b(N.h));if(x(N))return N=R(M,b(N)),new I(b(N.g),N.h);if(M.g.length>30){if(x(M)||x(N))throw Error("slowDivide_ only works with positive integers.");for(var O=f,F=N;F.l(M)<=0;)O=C(O),F=C(F);var L=V(O,1),B=V(F,1);for(F=V(F,2),O=V(O,2);!v(F);){var U=B.add(F);U.l(M)<=0&&(L=L.add(O),B=U),F=V(F,1),O=V(O,1)}return N=T(M,L.j(N)),new I(L,N)}for(L=h;M.l(N)>=0;){for(O=Math.max(1,Math.floor(M.m()/N.m())),F=Math.ceil(Math.log(O)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),B=c(O),U=B.j(N);x(U)||U.l(M)>0;)O-=F,B=c(O),U=B.j(N);v(B)&&(B=f),L=L.add(B),M=T(M,U)}return new I(L,M)}t.B=function(M){return R(this,M).h},t.and=function(M){const N=Math.max(this.g.length,M.g.length),O=[];for(let F=0;F<N;F++)O[F]=this.i(F)&M.i(F);return new o(O,this.h&M.h)},t.or=function(M){const N=Math.max(this.g.length,M.g.length),O=[];for(let F=0;F<N;F++)O[F]=this.i(F)|M.i(F);return new o(O,this.h|M.h)},t.xor=function(M){const N=Math.max(this.g.length,M.g.length),O=[];for(let F=0;F<N;F++)O[F]=this.i(F)^M.i(F);return new o(O,this.h^M.h)};function C(M){const N=M.g.length+1,O=[];for(let F=0;F<N;F++)O[F]=M.i(F)<<1|M.i(F-1)>>>31;return new o(O,M.h)}function V(M,N){const O=N>>5;N%=32;const F=M.g.length-O,L=[];for(let B=0;B<F;B++)L[B]=N>0?M.i(B+O)>>>N|M.i(B+O+1)<<32-N:M.i(B+O);return new o(L,M.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kce=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,hg=o}).apply(typeof uZ<"u"?uZ:typeof self<"u"?self:typeof window<"u"?window:{});var rP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ace,GE,Ice,kM,Ij,Rce,Pce,Mce;(function(){var t,e=Object.defineProperty;function n(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof rP=="object"&&rP];for(var j=0;j<S.length;++j){var G=S[j];if(G&&G.Math==Math)return G}throw Error("Cannot find global object")}var r=n(this);function i(S,j){if(j)e:{var G=r;S=S.split(".");for(var Z=0;Z<S.length-1;Z++){var Ee=S[Z];if(!(Ee in G))break e;G=G[Ee]}S=S[S.length-1],Z=G[S],j=j(Z),j!=Z&&j!=null&&e(G,S,{configurable:!0,writable:!0,value:j})}}i("Symbol.dispose",function(S){return S||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(S){return S||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(S){return S||function(j){var G=[],Z;for(Z in j)Object.prototype.hasOwnProperty.call(j,Z)&&G.push([Z,j[Z]]);return G}});var s=s||{},o=this||self;function a(S){var j=typeof S;return j=="object"&&S!=null||j=="function"}function l(S,j,G){return S.call.apply(S.bind,arguments)}function c(S,j,G){return c=l,c.apply(null,arguments)}function u(S,j){var G=Array.prototype.slice.call(arguments,1);return function(){var Z=G.slice();return Z.push.apply(Z,arguments),S.apply(this,Z)}}function h(S,j){function G(){}G.prototype=j.prototype,S.Z=j.prototype,S.prototype=new G,S.prototype.constructor=S,S.Ob=function(Z,Ee,Fe){for(var _t=Array(arguments.length-2),Mn=2;Mn<arguments.length;Mn++)_t[Mn-2]=arguments[Mn];return j.prototype[Ee].apply(Z,_t)}}var f=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?S=>S&&AsyncContext.Snapshot.wrap(S):S=>S;function g(S){const j=S.length;if(j>0){const G=Array(j);for(let Z=0;Z<j;Z++)G[Z]=S[Z];return G}return[]}function v(S,j){for(let Z=1;Z<arguments.length;Z++){const Ee=arguments[Z];var G=typeof Ee;if(G=G!="object"?G:Ee?Array.isArray(Ee)?"array":G:"null",G=="array"||G=="object"&&typeof Ee.length=="number"){G=S.length||0;const Fe=Ee.length||0;S.length=G+Fe;for(let _t=0;_t<Fe;_t++)S[G+_t]=Ee[_t]}else S.push(Ee)}}class x{constructor(j,G){this.i=j,this.j=G,this.h=0,this.g=null}get(){let j;return this.h>0?(this.h--,j=this.g,this.g=j.next,j.next=null):j=this.i(),j}}function b(S){o.setTimeout(()=>{throw S},0)}function T(){var S=M;let j=null;return S.g&&(j=S.g,S.g=S.g.next,S.g||(S.h=null),j.next=null),j}class A{constructor(){this.h=this.g=null}add(j,G){const Z=I.get();Z.set(j,G),this.h?this.h.next=Z:this.g=Z,this.h=Z}}var I=new x(()=>new R,S=>S.reset());class R{constructor(){this.next=this.g=this.h=null}set(j,G){this.h=j,this.g=G,this.next=null}reset(){this.next=this.g=this.h=null}}let C,V=!1,M=new A,N=()=>{const S=Promise.resolve(void 0);C=()=>{S.then(O)}};function O(){for(var S;S=T();){try{S.h.call(S.g)}catch(G){b(G)}var j=I;j.j(S),j.h<100&&(j.h++,S.next=j.g,j.g=S)}V=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(S,j){this.type=S,this.g=this.target=j,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var S=!1,j=Object.defineProperty({},"passive",{get:function(){S=!0}});try{const G=()=>{};o.addEventListener("test",G,j),o.removeEventListener("test",G,j)}catch{}return S})();function U(S){return/^[\s\xa0]*$/.test(S)}function de(S,j){L.call(this,S?S.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,S&&this.init(S,j)}h(de,L),de.prototype.init=function(S,j){const G=this.type=S.type,Z=S.changedTouches&&S.changedTouches.length?S.changedTouches[0]:null;this.target=S.target||S.srcElement,this.g=j,j=S.relatedTarget,j||(G=="mouseover"?j=S.fromElement:G=="mouseout"&&(j=S.toElement)),this.relatedTarget=j,Z?(this.clientX=Z.clientX!==void 0?Z.clientX:Z.pageX,this.clientY=Z.clientY!==void 0?Z.clientY:Z.pageY,this.screenX=Z.screenX||0,this.screenY=Z.screenY||0):(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0),this.button=S.button,this.key=S.key||"",this.ctrlKey=S.ctrlKey,this.altKey=S.altKey,this.shiftKey=S.shiftKey,this.metaKey=S.metaKey,this.pointerId=S.pointerId||0,this.pointerType=S.pointerType,this.state=S.state,this.i=S,S.defaultPrevented&&de.Z.h.call(this)},de.prototype.h=function(){de.Z.h.call(this);const S=this.i;S.preventDefault?S.preventDefault():S.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),ze=0;function Le(S,j,G,Z,Ee){this.listener=S,this.proxy=null,this.src=j,this.type=G,this.capture=!!Z,this.ha=Ee,this.key=++ze,this.da=this.fa=!1}function fe(S){S.da=!0,S.listener=null,S.proxy=null,S.src=null,S.ha=null}function $e(S,j,G){for(const Z in S)j.call(G,S[Z],Z,S)}function Ce(S,j){for(const G in S)j.call(void 0,S[G],G,S)}function le(S){const j={};for(const G in S)j[G]=S[G];return j}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(S,j){let G,Z;for(let Ee=1;Ee<arguments.length;Ee++){Z=arguments[Ee];for(G in Z)S[G]=Z[G];for(let Fe=0;Fe<W.length;Fe++)G=W[Fe],Object.prototype.hasOwnProperty.call(Z,G)&&(S[G]=Z[G])}}function se(S){this.src=S,this.g={},this.h=0}se.prototype.add=function(S,j,G,Z,Ee){const Fe=S.toString();S=this.g[Fe],S||(S=this.g[Fe]=[],this.h++);const _t=_e(S,j,Z,Ee);return _t>-1?(j=S[_t],G||(j.fa=!1)):(j=new Le(j,this.src,Fe,!!Z,Ee),j.fa=G,S.push(j)),j};function ae(S,j){const G=j.type;if(G in S.g){var Z=S.g[G],Ee=Array.prototype.indexOf.call(Z,j,void 0),Fe;(Fe=Ee>=0)&&Array.prototype.splice.call(Z,Ee,1),Fe&&(fe(j),S.g[G].length==0&&(delete S.g[G],S.h--))}}function _e(S,j,G,Z){for(let Ee=0;Ee<S.length;++Ee){const Fe=S[Ee];if(!Fe.da&&Fe.listener==j&&Fe.capture==!!G&&Fe.ha==Z)return Ee}return-1}var Ke="closure_lm_"+(Math.random()*1e6|0),Ye={};function ke(S,j,G,Z,Ee){if(Array.isArray(j)){for(let Fe=0;Fe<j.length;Fe++)ke(S,j[Fe],G,Z,Ee);return null}return G=lr(G),S&&S[me]?S.J(j,G,a(Z)?!!Z.capture:!1,Ee):Te(S,j,G,!1,Z,Ee)}function Te(S,j,G,Z,Ee,Fe){if(!j)throw Error("Invalid event type");const _t=a(Ee)?!!Ee.capture:!!Ee;let Mn=yn(S);if(Mn||(S[Ke]=Mn=new se(S)),G=Mn.add(j,G,Z,_t,Fe),G.proxy)return G;if(Z=Dt(),G.proxy=Z,Z.src=S,Z.listener=G,S.addEventListener)B||(Ee=_t),Ee===void 0&&(Ee=!1),S.addEventListener(j.toString(),Z,Ee);else if(S.attachEvent)S.attachEvent($t(j.toString()),Z);else if(S.addListener&&S.removeListener)S.addListener(Z);else throw Error("addEventListener and attachEvent are unavailable.");return G}function Dt(){function S(G){return j.call(S.src,S.listener,G)}const j=fn;return S}function qe(S,j,G,Z,Ee){if(Array.isArray(j))for(var Fe=0;Fe<j.length;Fe++)qe(S,j[Fe],G,Z,Ee);else Z=a(Z)?!!Z.capture:!!Z,G=lr(G),S&&S[me]?(S=S.i,Fe=String(j).toString(),Fe in S.g&&(j=S.g[Fe],G=_e(j,G,Z,Ee),G>-1&&(fe(j[G]),Array.prototype.splice.call(j,G,1),j.length==0&&(delete S.g[Fe],S.h--)))):S&&(S=yn(S))&&(j=S.g[j.toString()],S=-1,j&&(S=_e(j,G,Z,Ee)),(G=S>-1?j[S]:null)&&sn(G))}function sn(S){if(typeof S!="number"&&S&&!S.da){var j=S.src;if(j&&j[me])ae(j.i,S);else{var G=S.type,Z=S.proxy;j.removeEventListener?j.removeEventListener(G,Z,S.capture):j.detachEvent?j.detachEvent($t(G),Z):j.addListener&&j.removeListener&&j.removeListener(Z),(G=yn(j))?(ae(G,S),G.h==0&&(G.src=null,j[Ke]=null)):fe(S)}}}function $t(S){return S in Ye?Ye[S]:Ye[S]="on"+S}function fn(S,j){if(S.da)S=!0;else{j=new de(j,this);const G=S.listener,Z=S.ha||S.src;S.fa&&sn(S),S=G.call(Z,j)}return S}function yn(S){return S=S[Ke],S instanceof se?S:null}var dt="__closure_events_fn_"+(Math.random()*1e9>>>0);function lr(S){return typeof S=="function"?S:(S[dt]||(S[dt]=function(j){return S.handleEvent(j)}),S[dt])}function $n(){F.call(this),this.i=new se(this),this.M=this,this.G=null}h($n,F),$n.prototype[me]=!0,$n.prototype.removeEventListener=function(S,j,G,Z){qe(this,S,j,G,Z)};function Un(S,j){var G,Z=S.G;if(Z)for(G=[];Z;Z=Z.G)G.push(Z);if(S=S.M,Z=j.type||j,typeof j=="string")j=new L(j,S);else if(j instanceof L)j.target=j.target||S;else{var Ee=j;j=new L(Z,S),ne(j,Ee)}Ee=!0;let Fe,_t;if(G)for(_t=G.length-1;_t>=0;_t--)Fe=j.g=G[_t],Ee=Xr(Fe,Z,!0,j)&&Ee;if(Fe=j.g=S,Ee=Xr(Fe,Z,!0,j)&&Ee,Ee=Xr(Fe,Z,!1,j)&&Ee,G)for(_t=0;_t<G.length;_t++)Fe=j.g=G[_t],Ee=Xr(Fe,Z,!1,j)&&Ee}$n.prototype.N=function(){if($n.Z.N.call(this),this.i){var S=this.i;for(const j in S.g){const G=S.g[j];for(let Z=0;Z<G.length;Z++)fe(G[Z]);delete S.g[j],S.h--}}this.G=null},$n.prototype.J=function(S,j,G,Z){return this.i.add(String(S),j,!1,G,Z)},$n.prototype.K=function(S,j,G,Z){return this.i.add(String(S),j,!0,G,Z)};function Xr(S,j,G,Z){if(j=S.i.g[String(j)],!j)return!0;j=j.concat();let Ee=!0;for(let Fe=0;Fe<j.length;++Fe){const _t=j[Fe];if(_t&&!_t.da&&_t.capture==G){const Mn=_t.listener,rs=_t.ha||_t.src;_t.fa&&ae(S.i,_t),Ee=Mn.call(rs,Z)!==!1&&Ee}}return Ee&&!Z.defaultPrevented}function fo(S,j){if(typeof S!="function")if(S&&typeof S.handleEvent=="function")S=c(S.handleEvent,S);else throw Error("Invalid listener argument");return Number(j)>2147483647?-1:o.setTimeout(S,j||0)}function kr(S){S.g=fo(()=>{S.g=null,S.i&&(S.i=!1,kr(S))},S.l);const j=S.h;S.h=null,S.m.apply(null,j)}class Si extends F{constructor(j,G){super(),this.m=j,this.l=G,this.h=null,this.i=!1,this.g=null}j(j){this.h=arguments,this.g?this.i=!0:kr(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rs(S){F.call(this),this.h=S,this.g={}}h(Rs,F);var Mt=[];function Yn(S){$e(S.g,function(j,G){this.g.hasOwnProperty(G)&&sn(j)},S),S.g={}}Rs.prototype.N=function(){Rs.Z.N.call(this),Yn(this)},Rs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=o.JSON.stringify,Ft=o.JSON.parse,On=class{stringify(S){return o.JSON.stringify(S,void 0)}parse(S){return o.JSON.parse(S,void 0)}};function Qt(){}function Oo(){}var ji={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ps(){L.call(this,"d")}h(Ps,L);function Pn(){L.call(this,"c")}h(Pn,L);var Ti={},He=null;function Ae(){return He=He||new $n}Ti.Ia="serverreachability";function Ie(S){L.call(this,Ti.Ia,S)}h(Ie,L);function rn(S){const j=Ae();Un(j,new Ie(j))}Ti.STAT_EVENT="statevent";function z(S,j){L.call(this,Ti.STAT_EVENT,S),this.stat=j}h(z,L);function bt(S){const j=Ae();Un(j,new z(j,S))}Ti.Ja="timingevent";function Y(S,j){L.call(this,Ti.Ja,S),this.size=j}h(Y,L);function oe(S,j){if(typeof S!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){S()},j)}function Ve(){this.g=!0}Ve.prototype.ua=function(){this.g=!1};function Q(S,j,G,Z,Ee,Fe){S.info(function(){if(S.g)if(Fe){var _t="",Mn=Fe.split("&");for(let Dr=0;Dr<Mn.length;Dr++){var rs=Mn[Dr].split("=");if(rs.length>1){const ds=rs[0];rs=rs[1];const Cl=ds.split("_");_t=Cl.length>=2&&Cl[1]=="type"?_t+(ds+"="+rs+"&"):_t+(ds+"=redacted&")}}}else _t=null;else _t=Fe;return"XMLHTTP REQ ("+Z+") [attempt "+Ee+"]: "+j+`
`+G+`
`+_t})}function ye(S,j,G,Z,Ee,Fe,_t){S.info(function(){return"XMLHTTP RESP ("+Z+") [ attempt "+Ee+"]: "+j+`
`+G+`
`+Fe+" "+_t})}function De(S,j,G,Z){S.info(function(){return"XMLHTTP TEXT ("+j+"): "+Ue(S,G)+(Z?" "+Z:"")})}function Je(S,j){S.info(function(){return"TIMEOUT: "+j})}Ve.prototype.info=function(){};function Ue(S,j){if(!S.g)return j;if(!j)return null;try{const Fe=JSON.parse(j);if(Fe){for(S=0;S<Fe.length;S++)if(Array.isArray(Fe[S])){var G=Fe[S];if(!(G.length<2)){var Z=G[1];if(Array.isArray(Z)&&!(Z.length<1)){var Ee=Z[0];if(Ee!="noop"&&Ee!="stop"&&Ee!="close")for(let _t=1;_t<Z.length;_t++)Z[_t]=""}}}}return cr(Fe)}catch{return j}}var nt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},et={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Pt;function zt(){}h(zt,Qt),zt.prototype.g=function(){return new XMLHttpRequest},Pt=new zt;function gn(S){return encodeURIComponent(String(S))}function q(S){var j=1;S=S.split(":");const G=[];for(;j>0&&S.length;)G.push(S.shift()),j--;return S.length&&G.push(S.join(":")),G}function te(S,j,G,Z){this.j=S,this.i=j,this.l=G,this.S=Z||1,this.V=new Rs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new J}function J(){this.i=null,this.g="",this.h=!1}var ee={},re={};function ie(S,j,G){S.M=1,S.A=$d(gc(j)),S.u=G,S.R=!0,Pe(S,null)}function Pe(S,j){S.F=Date.now(),Oe(S),S.B=gc(S.A);var G=S.B,Z=S.S;Array.isArray(Z)||(Z=[String(Z)]),bb(G.i,"t",Z),S.C=0,G=S.j.L,S.h=new J,S.g=WI(S.j,G?j:null,!S.u),S.P>0&&(S.O=new Si(c(S.Y,S,S.g),S.P)),j=S.V,G=S.g,Z=S.ba;var Ee="readystatechange";Array.isArray(Ee)||(Ee&&(Mt[0]=Ee.toString()),Ee=Mt);for(let Fe=0;Fe<Ee.length;Fe++){const _t=ke(G,Ee[Fe],Z||j.handleEvent,!1,j.h||j);if(!_t)break;j.g[_t.key]=_t}j=S.J?le(S.J):{},S.u?(S.v||(S.v="POST"),j["Content-Type"]="application/x-www-form-urlencoded",S.g.ea(S.B,S.v,S.u,j)):(S.v="GET",S.g.ea(S.B,S.v,null,j)),rn(),Q(S.i,S.v,S.B,S.l,S.S,S.u)}te.prototype.ba=function(S){S=S.target;const j=this.O;j&&bh(S)==3?j.j():this.Y(S)},te.prototype.Y=function(S){try{if(S==this.g)e:{const Mn=bh(this.g),rs=this.g.ya(),Dr=this.g.ca();if(!(Mn<3)&&(Mn!=3||this.g&&(this.h.h||this.g.la()||GI(this.g)))){this.K||Mn!=4||rs==7||(rs==8||Dr<=0?rn(3):rn(2)),gt(this);var j=this.g.ca();this.X=j;var G=Be(this);if(this.o=j==200,ye(this.i,this.v,this.B,this.l,this.S,Mn,j),this.o){if(this.U&&!this.L){t:{if(this.g){var Z,Ee=this.g;if((Z=Ee.g?Ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Z)){var Fe=Z;break t}}Fe=null}if(S=Fe)De(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ct(this,S);else{this.o=!1,this.m=3,bt(12),lt(this),It(this);break e}}if(this.R){S=!0;let ds;for(;!this.K&&this.C<G.length;)if(ds=Ne(this,G),ds==re){Mn==4&&(this.m=4,bt(14),S=!1),De(this.i,this.l,null,"[Incomplete Response]");break}else if(ds==ee){this.m=4,bt(15),De(this.i,this.l,G,"[Invalid Chunk]"),S=!1;break}else De(this.i,this.l,ds,null),ct(this,ds);if(Re(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mn!=4||G.length!=0||this.h.h||(this.m=1,bt(16),S=!1),this.o=this.o&&S,!S)De(this.i,this.l,G,"[Invalid Chunked Response]"),lt(this),It(this);else if(G.length>0&&!this.W){this.W=!0;var _t=this.j;_t.g==this&&_t.aa&&!_t.P&&(_t.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),c0(_t),_t.P=!0,bt(11))}}else De(this.i,this.l,G,null),ct(this,G);Mn==4&&lt(this),this.o&&!this.K&&(Mn==4?Ev(this.j,this):(this.o=!1,Oe(this)))}else Sb(this.g),j==400&&G.indexOf("Unknown SID")>0?(this.m=3,bt(12)):(this.m=0,bt(13)),lt(this),It(this)}}}catch{}};function Be(S){if(!Re(S))return S.g.la();const j=GI(S.g);if(j==="")return"";let G="";const Z=j.length,Ee=bh(S.g)==4;if(!S.h.i){if(typeof TextDecoder>"u")return lt(S),It(S),"";S.h.i=new o.TextDecoder}for(let Fe=0;Fe<Z;Fe++)S.h.h=!0,G+=S.h.i.decode(j[Fe],{stream:!(Ee&&Fe==Z-1)});return j.length=0,S.h.g+=G,S.C=0,S.h.g}function Re(S){return S.g?S.v=="GET"&&S.M!=2&&S.j.Aa:!1}function Ne(S,j){var G=S.C,Z=j.indexOf(`
`,G);return Z==-1?re:(G=Number(j.substring(G,Z)),isNaN(G)?ee:(Z+=1,Z+G>j.length?re:(j=j.slice(Z,Z+G),S.C=Z+G,j)))}te.prototype.cancel=function(){this.K=!0,lt(this)};function Oe(S){S.T=Date.now()+S.H,at(S,S.H)}function at(S,j){if(S.D!=null)throw Error("WatchDog timer not null");S.D=oe(c(S.aa,S),j)}function gt(S){S.D&&(o.clearTimeout(S.D),S.D=null)}te.prototype.aa=function(){this.D=null;const S=Date.now();S-this.T>=0?(Je(this.i,this.B),this.M!=2&&(rn(),bt(17)),lt(this),this.m=2,It(this)):at(this,this.T-S)};function It(S){S.j.I==0||S.K||Ev(S.j,S)}function lt(S){gt(S);var j=S.O;j&&typeof j.dispose=="function"&&j.dispose(),S.O=null,Yn(S.V),S.g&&(j=S.g,S.g=null,j.abort(),j.dispose())}function ct(S,j){try{var G=S.j;if(G.I!=0&&(G.g==S||pu(G.h,S))){if(!S.L&&pu(G.h,S)&&G.I==3){try{var Z=G.Ba.g.parse(j)}catch{Z=null}if(Array.isArray(Z)&&Z.length==3){var Ee=Z;if(Ee[0]==0){e:if(!G.v){if(G.g)if(G.g.F+3e3<S.F)bv(G),Pl(G);else break e;Th(G),bt(18)}}else G.xa=Ee[1],0<G.xa-G.K&&Ee[2]<37500&&G.F&&G.A==0&&!G.C&&(G.C=oe(c(G.Va,G),6e3));pi(G.h)<=1&&G.ta&&(G.ta=void 0)}else Ml(G,11)}else if((S.L||G.g==S)&&bv(G),!U(j))for(Ee=G.Ba.g.parse(j),j=0;j<Ee.length;j++){let Dr=Ee[j];const ds=Dr[0];if(!(ds<=G.K))if(G.K=ds,Dr=Dr[1],G.I==2)if(Dr[0]=="c"){G.M=Dr[1],G.ba=Dr[2];const Cl=Dr[3];Cl!=null&&(G.ka=Cl,G.j.info("VER="+G.ka));const Ud=Dr[4];Ud!=null&&(G.za=Ud,G.j.info("SVER="+G.za));const kh=Dr[5];kh!=null&&typeof kh=="number"&&kh>0&&(Z=1.5*kh,G.O=Z,G.j.info("backChannelRequestTimeoutMs_="+Z)),Z=G;const Ah=S.g;if(Ah){const kv=Ah.g?Ah.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kv){var Fe=Z.h;Fe.g||kv.indexOf("spdy")==-1&&kv.indexOf("quic")==-1&&kv.indexOf("h2")==-1||(Fe.j=Fe.l,Fe.g=new Set,Fe.h&&(mc(Fe,Fe.h),Fe.h=null))}if(Z.G){const Ab=Ah.g?Ah.g.getResponseHeader("X-HTTP-Session-Id"):null;Ab&&(Z.wa=Ab,yr(Z.J,Z.G,Ab))}}G.I=3,G.l&&G.l.ra(),G.aa&&(G.T=Date.now()-S.F,G.j.info("Handshake RTT: "+G.T+"ms")),Z=G;var _t=S;if(Z.na=kb(Z,Z.L?Z.ba:null,Z.W),_t.L){Il(Z.h,_t);var Mn=_t,rs=Z.O;rs&&(Mn.H=rs),Mn.D&&(gt(Mn),Oe(Mn)),Z.g=_t}else Lo(Z);G.i.length>0&&zd(G)}else Dr[0]!="stop"&&Dr[0]!="close"||Ml(G,7);else G.I==3&&(Dr[0]=="stop"||Dr[0]=="close"?Dr[0]=="stop"?Ml(G,7):xv(G):Dr[0]!="noop"&&G.l&&G.l.qa(Dr),G.A=0)}}rn(4)}catch{}}var wn=class{constructor(S,j){this.g=S,this.map=j}};function Ar(S){this.l=S||10,o.PerformanceNavigationTiming?(S=o.performance.getEntriesByType("navigation"),S=S.length>0&&(S[0].nextHopProtocol=="hq"||S[0].nextHopProtocol=="h2")):S=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=S?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lr(S){return S.h?!0:S.g?S.g.size>=S.j:!1}function pi(S){return S.h?1:S.g?S.g.size:0}function pu(S,j){return S.h?S.h==j:S.g?S.g.has(j):!1}function mc(S,j){S.g?S.g.add(j):S.h=j}function Il(S,j){S.h&&S.h==j?S.h=null:S.g&&S.g.has(j)&&S.g.delete(j)}Ar.prototype.cancel=function(){if(this.i=ns(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const S of this.g.values())S.cancel();this.g.clear()}};function ns(S){if(S.h!=null)return S.i.concat(S.h.G);if(S.g!=null&&S.g.size!==0){let j=S.i;for(const G of S.g.values())j=j.concat(G.G);return j}return g(S.i)}var Tp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ki(S,j){if(S){S=S.split("&");for(let G=0;G<S.length;G++){const Z=S[G].indexOf("=");let Ee,Fe=null;Z>=0?(Ee=S[G].substring(0,Z),Fe=S[G].substring(Z+1)):Ee=S[G],j(Ee,Fe?decodeURIComponent(Fe.replace(/\+/g," ")):"")}}}function gh(S){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let j;S instanceof gh?(this.l=S.l,r0(this,S.j),this.o=S.o,this.g=S.g,yh(this,S.u),this.h=S.h,kp(this,Eb(S.i)),this.m=S.m):S&&(j=String(S).match(Tp))?(this.l=!1,r0(this,j[1]||"",!0),this.o=i0(j[2]||""),this.g=i0(j[3]||"",!0),yh(this,j[4]),this.h=i0(j[5]||"",!0),kp(this,j[6]||"",!0),this.m=i0(j[7]||"")):(this.l=!1,this.i=new nr(null,this.l))}gh.prototype.toString=function(){const S=[];var j=this.j;j&&S.push(s0(j,yb,!0),":");var G=this.g;return(G||j=="file")&&(S.push("//"),(j=this.o)&&S.push(s0(j,yb,!0),"@"),S.push(gn(G).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),G=this.u,G!=null&&S.push(":",String(G))),(G=this.h)&&(this.g&&G.charAt(0)!="/"&&S.push("/"),S.push(s0(G,G.charAt(0)=="/"?o0:vb,!0))),(G=this.i.toString())&&S.push("?",G),(G=this.m)&&S.push("#",s0(G,_b)),S.join("")},gh.prototype.resolve=function(S){const j=gc(this);let G=!!S.j;G?r0(j,S.j):G=!!S.o,G?j.o=S.o:G=!!S.g,G?j.g=S.g:G=S.u!=null;var Z=S.h;if(G)yh(j,S.u);else if(G=!!S.h){if(Z.charAt(0)!="/")if(this.g&&!this.h)Z="/"+Z;else{var Ee=j.h.lastIndexOf("/");Ee!=-1&&(Z=j.h.slice(0,Ee+1)+Z)}if(Ee=Z,Ee==".."||Ee==".")Z="";else if(Ee.indexOf("./")!=-1||Ee.indexOf("/.")!=-1){Z=Ee.lastIndexOf("/",0)==0,Ee=Ee.split("/");const Fe=[];for(let _t=0;_t<Ee.length;){const Mn=Ee[_t++];Mn=="."?Z&&_t==Ee.length&&Fe.push(""):Mn==".."?((Fe.length>1||Fe.length==1&&Fe[0]!="")&&Fe.pop(),Z&&_t==Ee.length&&Fe.push("")):(Fe.push(Mn),Z=!0)}Z=Fe.join("/")}else Z=Ee}return G?j.h=Z:G=S.i.toString()!=="",G?kp(j,Eb(S.i)):G=!!S.m,G&&(j.m=S.m),j};function gc(S){return new gh(S)}function r0(S,j,G){S.j=G?i0(j,!0):j,S.j&&(S.j=S.j.replace(/:$/,""))}function yh(S,j){if(j){if(j=Number(j),isNaN(j)||j<0)throw Error("Bad port number "+j);S.u=j}else S.u=null}function kp(S,j,G){j instanceof nr?(S.i=j,yv(S.i,S.l)):(G||(j=s0(j,hL)),S.i=new nr(j,S.l))}function yr(S,j,G){S.i.set(j,G)}function $d(S){return yr(S,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),S}function i0(S,j){return S?j?decodeURI(S.replace(/%25/g,"%2525")):decodeURIComponent(S):""}function s0(S,j,G){return typeof S=="string"?(S=encodeURI(S).replace(j,gb),G&&(S=S.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S):null}function gb(S){return S=S.charCodeAt(0),"%"+(S>>4&15).toString(16)+(S&15).toString(16)}var yb=/[#\/\?@]/g,vb=/[#\?:]/g,o0=/[#\?]/g,hL=/[#\?@]/g,_b=/#/g;function nr(S,j){this.h=this.g=null,this.i=S||null,this.j=!!j}function vh(S){S.g||(S.g=new Map,S.h=0,S.i&&ki(S.i,function(j,G){S.add(decodeURIComponent(j.replace(/\+/g," ")),G)}))}t=nr.prototype,t.add=function(S,j){vh(this),this.i=null,S=_h(this,S);let G=this.g.get(S);return G||this.g.set(S,G=[]),G.push(j),this.h+=1,this};function xb(S,j){vh(S),j=_h(S,j),S.g.has(j)&&(S.i=null,S.h-=S.g.get(j).length,S.g.delete(j))}function gv(S,j){return vh(S),j=_h(S,j),S.g.has(j)}t.forEach=function(S,j){vh(this),this.g.forEach(function(G,Z){G.forEach(function(Ee){S.call(j,Ee,Z,this)},this)},this)};function wb(S,j){vh(S);let G=[];if(typeof j=="string")gv(S,j)&&(G=G.concat(S.g.get(_h(S,j))));else for(S=Array.from(S.g.values()),j=0;j<S.length;j++)G=G.concat(S[j]);return G}t.set=function(S,j){return vh(this),this.i=null,S=_h(this,S),gv(this,S)&&(this.h-=this.g.get(S).length),this.g.set(S,[j]),this.h+=1,this},t.get=function(S,j){return S?(S=wb(this,S),S.length>0?String(S[0]):j):j};function bb(S,j,G){xb(S,j),G.length>0&&(S.i=null,S.g.set(_h(S,j),g(G)),S.h+=G.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const S=[],j=Array.from(this.g.keys());for(let Z=0;Z<j.length;Z++){var G=j[Z];const Ee=gn(G);G=wb(this,G);for(let Fe=0;Fe<G.length;Fe++){let _t=Ee;G[Fe]!==""&&(_t+="="+gn(G[Fe])),S.push(_t)}}return this.i=S.join("&")};function Eb(S){const j=new nr;return j.i=S.i,S.g&&(j.g=new Map(S.g),j.h=S.h),j}function _h(S,j){return j=String(j),S.j&&(j=j.toLowerCase()),j}function yv(S,j){j&&!S.j&&(vh(S),S.i=null,S.g.forEach(function(G,Z){const Ee=Z.toLowerCase();Z!=Ee&&(xb(this,Z),bb(this,Ee,G))},S)),S.j=j}function xh(S,j){const G=new Ve;if(o.Image){const Z=new Image;Z.onload=u(po,G,"TestLoadImage: loaded",!0,j,Z),Z.onerror=u(po,G,"TestLoadImage: error",!1,j,Z),Z.onabort=u(po,G,"TestLoadImage: abort",!1,j,Z),Z.ontimeout=u(po,G,"TestLoadImage: timeout",!1,j,Z),o.setTimeout(function(){Z.ontimeout&&Z.ontimeout()},1e4),Z.src=S}else j(!1)}function wh(S,j){const G=new Ve,Z=new AbortController,Ee=setTimeout(()=>{Z.abort(),po(G,"TestPingServer: timeout",!1,j)},1e4);fetch(S,{signal:Z.signal}).then(Fe=>{clearTimeout(Ee),Fe.ok?po(G,"TestPingServer: ok",!0,j):po(G,"TestPingServer: server error",!1,j)}).catch(()=>{clearTimeout(Ee),po(G,"TestPingServer: error",!1,j)})}function po(S,j,G,Z,Ee){try{Ee&&(Ee.onload=null,Ee.onerror=null,Ee.onabort=null,Ee.ontimeout=null),Z(G)}catch{}}function a0(){this.g=new On}function jd(S){this.i=S.Sb||null,this.h=S.ab||!1}h(jd,Qt),jd.prototype.g=function(){return new Rl(this.i,this.h)};function Rl(S,j){$n.call(this),this.H=S,this.o=j,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}h(Rl,$n),t=Rl.prototype,t.open=function(S,j){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=S,this.D=j,this.readyState=1,mu(this)},t.send=function(S){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const j={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};S&&(j.body=S),(this.H||o).fetch(new Request(this.D,j)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ap(this)),this.readyState=0},t.Pa=function(S){if(this.g&&(this.l=S,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=S.headers,this.readyState=2,mu(this)),this.g&&(this.readyState=3,mu(this),this.g)))if(this.responseType==="arraybuffer")S.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in S){if(this.j=S.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;VI(this)}else S.text().then(this.Oa.bind(this),this.ga.bind(this))};function VI(S){S.j.read().then(S.Ma.bind(S)).catch(S.ga.bind(S))}t.Ma=function(S){if(this.g){if(this.o&&S.value)this.response.push(S.value);else if(!this.o){var j=S.value?S.value:new Uint8Array(0);(j=this.B.decode(j,{stream:!S.done}))&&(this.response=this.responseText+=j)}S.done?Ap(this):mu(this),this.readyState==3&&VI(this)}},t.Oa=function(S){this.g&&(this.response=this.responseText=S,Ap(this))},t.Na=function(S){this.g&&(this.response=S,Ap(this))},t.ga=function(){this.g&&Ap(this)};function Ap(S){S.readyState=4,S.l=null,S.j=null,S.B=null,mu(S)}t.setRequestHeader=function(S,j){this.A.append(S,j)},t.getResponseHeader=function(S){return this.h&&this.h.get(S.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const S=[],j=this.h.entries();for(var G=j.next();!G.done;)G=G.value,S.push(G[0]+": "+G[1]),G=j.next();return S.join(`\r
`)};function mu(S){S.onreadystatechange&&S.onreadystatechange.call(S)}Object.defineProperty(Rl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(S){this.m=S?"include":"same-origin"}});function zI(S){let j="";return $e(S,function(G,Z){j+=Z,j+=":",j+=G,j+=`\r
`}),j}function vv(S,j,G){e:{for(Z in G){var Z=!1;break e}Z=!0}Z||(G=zI(G),typeof S=="string"?G!=null&&gn(G):yr(S,j,G))}function Zr(S){$n.call(this),this.headers=new Map,this.L=S||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}h(Zr,$n);var UI=/^https?$/i,dL=["POST","PUT"];t=Zr.prototype,t.Fa=function(S){this.H=S},t.ea=function(S,j,G,Z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+S);j=j?j.toUpperCase():"GET",this.D=S,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Pt.g(),this.g.onreadystatechange=f(c(this.Ca,this));try{this.B=!0,this.g.open(j,String(S),!0),this.B=!1}catch(Fe){Ip(this,Fe);return}if(S=G||"",G=new Map(this.headers),Z)if(Object.getPrototypeOf(Z)===Object.prototype)for(var Ee in Z)G.set(Ee,Z[Ee]);else if(typeof Z.keys=="function"&&typeof Z.get=="function")for(const Fe of Z.keys())G.set(Fe,Z.get(Fe));else throw Error("Unknown input type for opt_headers: "+String(Z));Z=Array.from(G.keys()).find(Fe=>Fe.toLowerCase()=="content-type"),Ee=o.FormData&&S instanceof o.FormData,!(Array.prototype.indexOf.call(dL,j,void 0)>=0)||Z||Ee||G.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Fe,_t]of G)this.g.setRequestHeader(Fe,_t);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(S),this.v=!1}catch(Fe){Ip(this,Fe)}};function Ip(S,j){S.h=!1,S.g&&(S.j=!0,S.g.abort(),S.j=!1),S.l=j,S.o=5,Rp(S),Vd(S)}function Rp(S){S.A||(S.A=!0,Un(S,"complete"),Un(S,"error"))}t.abort=function(S){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=S||7,Un(this,"complete"),Un(this,"abort"),Vd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vd(this,!0)),Zr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Fd(this):this.Xa())},t.Xa=function(){Fd(this)};function Fd(S){if(S.h&&typeof s<"u"){if(S.v&&bh(S)==4)setTimeout(S.Ca.bind(S),0);else if(Un(S,"readystatechange"),bh(S)==4){S.h=!1;try{const Fe=S.ca();e:switch(Fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var j=!0;break e;default:j=!1}var G;if(!(G=j)){var Z;if(Z=Fe===0){let _t=String(S.D).match(Tp)[1]||null;!_t&&o.self&&o.self.location&&(_t=o.self.location.protocol.slice(0,-1)),Z=!UI.test(_t?_t.toLowerCase():"")}G=Z}if(G)Un(S,"complete"),Un(S,"success");else{S.o=6;try{var Ee=bh(S)>2?S.g.statusText:""}catch{Ee=""}S.l=Ee+" ["+S.ca()+"]",Rp(S)}}finally{Vd(S)}}}}function Vd(S,j){if(S.g){S.m&&(clearTimeout(S.m),S.m=null);const G=S.g;S.g=null,j||Un(S,"ready");try{G.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function bh(S){return S.g?S.g.readyState:0}t.ca=function(){try{return bh(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(S){if(this.g){var j=this.g.responseText;return S&&j.indexOf(S)==0&&(j=j.substring(S.length)),Ft(j)}};function GI(S){try{if(!S.g)return null;if("response"in S.g)return S.g.response;switch(S.F){case"":case"text":return S.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in S.g)return S.g.mozResponseArrayBuffer}return null}catch{return null}}function Sb(S){const j={};S=(S.g&&bh(S)>=2&&S.g.getAllResponseHeaders()||"").split(`\r
`);for(let Z=0;Z<S.length;Z++){if(U(S[Z]))continue;var G=q(S[Z]);const Ee=G[0];if(G=G[1],typeof G!="string")continue;G=G.trim();const Fe=j[Ee]||[];j[Ee]=Fe,Fe.push(G)}Ce(j,function(Z){return Z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Eh(S,j,G){return G&&G.internalChannelParams&&G.internalChannelParams[S]||j}function _v(S){this.za=0,this.i=[],this.j=new Ve,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Eh("failFast",!1,S),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Eh("baseRetryDelayMs",5e3,S),this.Za=Eh("retryDelaySeedMs",1e4,S),this.Ta=Eh("forwardChannelMaxRetries",2,S),this.va=Eh("forwardChannelRequestTimeoutMs",2e4,S),this.ma=S&&S.xmlHttpFactory||void 0,this.Ua=S&&S.Rb||void 0,this.Aa=S&&S.useFetchStreams||!1,this.O=void 0,this.L=S&&S.supportsCrossDomainXhr||!1,this.M="",this.h=new Ar(S&&S.concurrentRequestLimit),this.Ba=new a0,this.S=S&&S.fastHandshake||!1,this.R=S&&S.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=S&&S.Pb||!1,S&&S.ua&&this.j.ua(),S&&S.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&S&&S.detectBufferingProxy||!1,this.ia=void 0,S&&S.longPollingTimeout&&S.longPollingTimeout>0&&(this.ia=S.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=_v.prototype,t.ka=8,t.I=1,t.connect=function(S,j,G,Z){bt(0),this.W=S,this.H=j||{},G&&Z!==void 0&&(this.H.OSID=G,this.H.OAID=Z),this.F=this.X,this.J=kb(this,null,this.W),zd(this)};function xv(S){if(wv(S),S.I==3){var j=S.V++,G=gc(S.J);if(yr(G,"SID",S.M),yr(G,"RID",j),yr(G,"TYPE","terminate"),Sh(S,G),j=new te(S,S.j,j),j.M=2,j.A=$d(gc(G)),G=!1,o.navigator&&o.navigator.sendBeacon)try{G=o.navigator.sendBeacon(j.A.toString(),"")}catch{}!G&&o.Image&&(new Image().src=j.A,G=!0),G||(j.g=WI(j.j,null),j.g.ea(j.A)),j.F=Date.now(),Oe(j)}u0(S)}function Pl(S){S.g&&(c0(S),S.g.cancel(),S.g=null)}function wv(S){Pl(S),S.v&&(o.clearTimeout(S.v),S.v=null),bv(S),S.h.cancel(),S.m&&(typeof S.m=="number"&&o.clearTimeout(S.m),S.m=null)}function zd(S){if(!Lr(S.h)&&!S.m){S.m=!0;var j=S.Ea;C||N(),V||(C(),V=!0),M.add(j,S),S.D=0}}function BI(S,j){return pi(S.h)>=S.h.j-(S.m?1:0)?!1:S.m?(S.i=j.G.concat(S.i),!0):S.I==1||S.I==2||S.D>=(S.Sa?0:S.Ta)?!1:(S.m=oe(c(S.Ea,S,j),Sv(S,S.D)),S.D++,!0)}t.Ea=function(S){if(this.m)if(this.m=null,this.I==1){if(!S){this.V=Math.floor(Math.random()*1e5),S=this.V++;const Ee=new te(this,this.j,S);let Fe=this.o;if(this.U&&(Fe?(Fe=le(Fe),ne(Fe,this.U)):Fe=this.U),this.u!==null||this.R||(Ee.J=Fe,Fe=null),this.S)e:{for(var j=0,G=0;G<this.i.length;G++){t:{var Z=this.i[G];if("__data__"in Z.map&&(Z=Z.map.__data__,typeof Z=="string")){Z=Z.length;break t}Z=void 0}if(Z===void 0)break;if(j+=Z,j>4096){j=G;break e}if(j===4096||G===this.i.length-1){j=G+1;break e}}j=1e3}else j=1e3;j=Tb(this,Ee,j),G=gc(this.J),yr(G,"RID",S),yr(G,"CVER",22),this.G&&yr(G,"X-HTTP-Session-Id",this.G),Sh(this,G),Fe&&(this.R?j="headers="+gn(zI(Fe))+"&"+j:this.u&&vv(G,this.u,Fe)),mc(this.h,Ee),this.Ra&&yr(G,"TYPE","init"),this.S?(yr(G,"$req",j),yr(G,"SID","null"),Ee.U=!0,ie(Ee,G,null)):ie(Ee,G,j),this.I=2}}else this.I==3&&(S?l0(this,S):this.i.length==0||Lr(this.h)||l0(this))};function l0(S,j){var G;j?G=j.l:G=S.V++;const Z=gc(S.J);yr(Z,"SID",S.M),yr(Z,"RID",G),yr(Z,"AID",S.K),Sh(S,Z),S.u&&S.o&&vv(Z,S.u,S.o),G=new te(S,S.j,G,S.D+1),S.u===null&&(G.J=S.o),j&&(S.i=j.G.concat(S.i)),j=Tb(S,G,1e3),G.H=Math.round(S.va*.5)+Math.round(S.va*.5*Math.random()),mc(S.h,G),ie(G,Z,j)}function Sh(S,j){S.H&&$e(S.H,function(G,Z){yr(j,Z,G)}),S.l&&$e({},function(G,Z){yr(j,Z,G)})}function Tb(S,j,G){G=Math.min(S.i.length,G);const Z=S.l?c(S.l.Ka,S.l,S):null;e:{var Ee=S.i;let Mn=-1;for(;;){const rs=["count="+G];Mn==-1?G>0?(Mn=Ee[0].g,rs.push("ofs="+Mn)):Mn=0:rs.push("ofs="+Mn);let Dr=!0;for(let ds=0;ds<G;ds++){var Fe=Ee[ds].g;const Cl=Ee[ds].map;if(Fe-=Mn,Fe<0)Mn=Math.max(0,Ee[ds].g-100),Dr=!1;else try{Fe="req"+Fe+"_"||"";try{var _t=Cl instanceof Map?Cl:Object.entries(Cl);for(const[Ud,kh]of _t){let Ah=kh;a(kh)&&(Ah=cr(kh)),rs.push(Fe+Ud+"="+encodeURIComponent(Ah))}}catch(Ud){throw rs.push(Fe+"type="+encodeURIComponent("_badmap")),Ud}}catch{Z&&Z(Cl)}}if(Dr){_t=rs.join("&");break e}}_t=void 0}return S=S.i.splice(0,G),j.G=S,_t}function Lo(S){if(!S.g&&!S.v){S.Y=1;var j=S.Da;C||N(),V||(C(),V=!0),M.add(j,S),S.A=0}}function Th(S){return S.g||S.v||S.A>=3?!1:(S.Y++,S.v=oe(c(S.Da,S),Sv(S,S.A)),S.A++,!0)}t.Da=function(){if(this.v=null,Pp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var S=4*this.T;this.j.info("BP detection timer enabled: "+S),this.B=oe(c(this.Wa,this),S)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,bt(10),Pl(this),Pp(this))};function c0(S){S.B!=null&&(o.clearTimeout(S.B),S.B=null)}function Pp(S){S.g=new te(S,S.j,"rpc",S.Y),S.u===null&&(S.g.J=S.o),S.g.P=0;var j=gc(S.na);yr(j,"RID","rpc"),yr(j,"SID",S.M),yr(j,"AID",S.K),yr(j,"CI",S.F?"0":"1"),!S.F&&S.ia&&yr(j,"TO",S.ia),yr(j,"TYPE","xmlhttp"),Sh(S,j),S.u&&S.o&&vv(j,S.u,S.o),S.O&&(S.g.H=S.O);var G=S.g;S=S.ba,G.M=1,G.A=$d(gc(j)),G.u=null,G.R=!0,Pe(G,S)}t.Va=function(){this.C!=null&&(this.C=null,Pl(this),Th(this),bt(19))};function bv(S){S.C!=null&&(o.clearTimeout(S.C),S.C=null)}function Ev(S,j){var G=null;if(S.g==j){bv(S),c0(S),S.g=null;var Z=2}else if(pu(S.h,j))G=j.G,Il(S.h,j),Z=1;else return;if(S.I!=0){if(j.o)if(Z==1){G=j.u?j.u.length:0,j=Date.now()-j.F;var Ee=S.D;Z=Ae(),Un(Z,new Y(Z,G)),zd(S)}else Lo(S);else if(Ee=j.m,Ee==3||Ee==0&&j.X>0||!(Z==1&&BI(S,j)||Z==2&&Th(S)))switch(G&&G.length>0&&(j=S.h,j.i=j.i.concat(G)),Ee){case 1:Ml(S,5);break;case 4:Ml(S,10);break;case 3:Ml(S,6);break;default:Ml(S,2)}}}function Sv(S,j){let G=S.Qa+Math.floor(Math.random()*S.Za);return S.isActive()||(G*=2),G*j}function Ml(S,j){if(S.j.info("Error code "+j),j==2){var G=c(S.bb,S),Z=S.Ua;const Ee=!Z;Z=new gh(Z||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||r0(Z,"https"),$d(Z),Ee?xh(Z.toString(),G):wh(Z.toString(),G)}else bt(2);S.I=0,S.l&&S.l.pa(j),u0(S),wv(S)}t.bb=function(S){S?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function u0(S){if(S.I=0,S.ja=[],S.l){const j=ns(S.h);(j.length!=0||S.i.length!=0)&&(v(S.ja,j),v(S.ja,S.i),S.h.i.length=0,g(S.i),S.i.length=0),S.l.oa()}}function kb(S,j,G){var Z=G instanceof gh?gc(G):new gh(G);if(Z.g!="")j&&(Z.g=j+"."+Z.g),yh(Z,Z.u);else{var Ee=o.location;Z=Ee.protocol,j=j?j+"."+Ee.hostname:Ee.hostname,Ee=+Ee.port;const Fe=new gh(null);Z&&r0(Fe,Z),j&&(Fe.g=j),Ee&&yh(Fe,Ee),G&&(Fe.h=G),Z=Fe}return G=S.G,j=S.wa,G&&j&&yr(Z,G,j),yr(Z,"VER",S.ka),Sh(S,Z),Z}function WI(S,j,G){if(j&&!S.L)throw Error("Can't create secondary domain capable XhrIo object.");return j=S.Aa&&!S.ma?new Zr(new jd({ab:G})):new Zr(S.ma),j.Fa(S.L),j}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function HI(){}t=HI.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Tv(){}Tv.prototype.g=function(S,j){return new mo(S,j)};function mo(S,j){$n.call(this),this.g=new _v(j),this.l=S,this.h=j&&j.messageUrlParams||null,S=j&&j.messageHeaders||null,j&&j.clientProtocolHeaderRequired&&(S?S["X-Client-Protocol"]="webchannel":S={"X-Client-Protocol":"webchannel"}),this.g.o=S,S=j&&j.initMessageHeaders||null,j&&j.messageContentType&&(S?S["X-WebChannel-Content-Type"]=j.messageContentType:S={"X-WebChannel-Content-Type":j.messageContentType}),j&&j.sa&&(S?S["X-WebChannel-Client-Profile"]=j.sa:S={"X-WebChannel-Client-Profile":j.sa}),this.g.U=S,(S=j&&j.Qb)&&!U(S)&&(this.g.u=S),this.A=j&&j.supportsCrossDomainXhr||!1,this.v=j&&j.sendRawJson||!1,(j=j&&j.httpSessionIdParam)&&!U(j)&&(this.g.G=j,S=this.h,S!==null&&j in S&&(S=this.h,j in S&&delete S[j])),this.j=new Mp(this)}h(mo,$n),mo.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},mo.prototype.close=function(){xv(this.g)},mo.prototype.o=function(S){var j=this.g;if(typeof S=="string"){var G={};G.__data__=S,S=G}else this.v&&(G={},G.__data__=cr(S),S=G);j.i.push(new wn(j.Ya++,S)),j.I==3&&zd(j)},mo.prototype.N=function(){this.g.l=null,delete this.j,xv(this.g),delete this.g,mo.Z.N.call(this)};function qI(S){Ps.call(this),S.__headers__&&(this.headers=S.__headers__,this.statusCode=S.__status__,delete S.__headers__,delete S.__status__);var j=S.__sm__;if(j){e:{for(const G in j){S=G;break e}S=void 0}(this.i=S)&&(S=this.i,j=j!==null&&S in j?j[S]:void 0),this.data=j}else this.data=S}h(qI,Ps);function KI(){Pn.call(this),this.status=1}h(KI,Pn);function Mp(S){this.g=S}h(Mp,HI),Mp.prototype.ra=function(){Un(this.g,"a")},Mp.prototype.qa=function(S){Un(this.g,new qI(S))},Mp.prototype.pa=function(S){Un(this.g,new KI)},Mp.prototype.oa=function(){Un(this.g,"b")},Tv.prototype.createWebChannel=Tv.prototype.g,mo.prototype.send=mo.prototype.o,mo.prototype.open=mo.prototype.m,mo.prototype.close=mo.prototype.close,Mce=function(){return new Tv},Pce=function(){return Ae()},Rce=Ti,Ij={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,kM=nt,et.COMPLETE="complete",Ice=et,Oo.EventType=ji,ji.OPEN="a",ji.CLOSE="b",ji.ERROR="c",ji.MESSAGE="d",$n.prototype.listen=$n.prototype.J,GE=Oo,Zr.prototype.listenOnce=Zr.prototype.K,Zr.prototype.getLastError=Zr.prototype.Ha,Zr.prototype.getLastErrorCode=Zr.prototype.ya,Zr.prototype.getStatus=Zr.prototype.ca,Zr.prototype.getResponseJson=Zr.prototype.La,Zr.prototype.getResponseText=Zr.prototype.la,Zr.prototype.send=Zr.prototype.ea,Zr.prototype.setWithCredentials=Zr.prototype.Fa,Ace=Zr}).apply(typeof rP<"u"?rP:typeof self<"u"?self:typeof window<"u"?window:{});const hZ="@firebase/firestore",dZ="4.9.3";let ko=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ko.UNAUTHENTICATED=new ko(null),ko.GOOGLE_CREDENTIALS=new ko("google-credentials-uid"),ko.FIRST_PARTY=new ko("first-party-uid"),ko.MOCK_USER=new ko("mock-user");let $2="12.7.0";const x1=new iU("@firebase/firestore");function M_(){return x1.logLevel}function ft(t,...e){if(x1.logLevel<=Jn.DEBUG){const n=e.map(gU);x1.debug(`Firestore (${$2}): ${t}`,...n)}}function Ra(t,...e){if(x1.logLevel<=Jn.ERROR){const n=e.map(gU);x1.error(`Firestore (${$2}): ${t}`,...n)}}function w1(t,...e){if(x1.logLevel<=Jn.WARN){const n=e.map(gU);x1.warn(`Firestore (${$2}): ${t}`,...n)}}function gU(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ht(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Cce(t,r,n)}function Cce(t,e,n){let r=`FIRESTORE (${$2}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ra(r),new Error(r)}function nn(t,e,n,r){let i="Unexpected state";typeof n=="string"?i=n:r=n,t||Cce(e,i,r)}function Rn(t,e){return t}const We={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Et extends Od{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ud{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class Nce{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class b4e{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(ko.UNAUTHENTICATED)))}shutdown(){}}class E4e{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class S4e{constructor(e){this.t=e,this.currentUser=ko.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){nn(this.o===void 0,42304);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new ud;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ud,e.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const l=s;e.enqueueRetryable((async()=>{await l.promise,await i(this.currentUser)}))},a=l=>{ft("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ft("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ud)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(ft("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nn(typeof r.accessToken=="string",31837,{l:r}),new Nce(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nn(e===null||typeof e=="string",2055,{h:e}),new ko(e)}}class T4e{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=ko.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class k4e{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new T4e(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(ko.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class A4e{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ec(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){nn(this.o===void 0,3512);const r=s=>{s.error!=null&&ft("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,ft("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};const i=s=>{ft("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):ft("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fZ(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(nn(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new fZ(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function I4e(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class yU{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=I4e(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%62))}return r}}function In(t,e){return t<e?-1:t>e?1:0}function Rj(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const i=t.charAt(r),s=e.charAt(r);if(i!==s)return M6(i)===M6(s)?In(i,s):M6(i)?1:-1}return In(t.length,e.length)}const R4e=55296,P4e=57343;function M6(t){const e=t.charCodeAt(0);return e>=R4e&&e<=P4e}function Vw(t,e,n){return t.length===e.length&&t.every(((r,i)=>n(r,e[i])))}function Oce(t){return t+"\0"}const pZ="__name__";class qh{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ht(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ht(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return qh.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qh?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=qh.compareSegments(e.get(i),n.get(i));if(s!==0)return s}return In(e.length,n.length)}static compareSegments(e,n){const r=qh.isNumericId(e),i=qh.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?qh.extractNumericId(e).compare(qh.extractNumericId(n)):Rj(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hg.fromString(e.substring(4,e.length-2))}}class Er extends qh{construct(e,n,r){return new Er(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Et(We.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((i=>i.length>0)))}return new Er(n)}static emptyPath(){return new Er([])}}const M4e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ni extends qh{construct(e,n,r){return new Ni(e,n,r)}static isValidIdentifier(e){return M4e.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ni.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pZ}static keyField(){return new Ni([pZ])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Et(We.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Et(We.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Et(We.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new Et(We.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ni(n)}static emptyPath(){return new Ni([])}}class Tt{constructor(e){this.path=e}static fromPath(e){return new Tt(Er.fromString(e))}static fromName(e){return new Tt(Er.fromString(e).popFirst(5))}static empty(){return new Tt(Er.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Er.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Er.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Tt(new Er(e.slice()))}}function Lce(t,e,n){if(!n)throw new Et(We.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function C4e(t,e,n,r){if(e===!0&&r===!0)throw new Et(We.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function mZ(t){if(!Tt.isDocumentKey(t))throw new Et(We.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gZ(t){if(Tt.isDocumentKey(t))throw new Et(We.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Dce(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function y5(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ht(12329,{type:typeof t})}function au(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Et(We.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=y5(t);throw new Et(We.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Ss(t,e){const n={typeString:t};return e&&(n.value=e),n}function $A(t,e){if(!Dce(t))throw new Et(We.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new Et(We.INVALID_ARGUMENT,n);return!0}const yZ=-62135596800,vZ=1e6;class Vr{static now(){return Vr.fromMillis(Date.now())}static fromDate(e){return Vr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*vZ);return new Vr(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Et(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Et(We.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<yZ)throw new Et(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Et(We.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vZ}_compareTo(e){return this.seconds===e.seconds?In(this.nanoseconds,e.nanoseconds):In(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($A(e,Vr._jsonSchema))return new Vr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yZ;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vr._jsonSchemaVersion="firestore/timestamp/1.0",Vr._jsonSchema={type:Ss("string",Vr._jsonSchemaVersion),seconds:Ss("number"),nanoseconds:Ss("number")};class on{static fromTimestamp(e){return new on(e)}static min(){return new on(new Vr(0,0))}static max(){return new on(new Vr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ak=-1;class C3{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Pj(t){return t.fields.find((e=>e.kind===2))}function V0(t){return t.fields.filter((e=>e.kind!==2))}C3.UNKNOWN_ID=-1;class AM{constructor(e,n){this.fieldPath=e,this.kind=n}}class lk{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new lk(0,cc.min())}}function N4e(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=on.fromTimestamp(r===1e9?new Vr(n+1,0):new Vr(n,r));return new cc(i,Tt.empty(),e)}function $ce(t){return new cc(t.readTime,t.key,ak)}class cc{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new cc(on.min(),Tt.empty(),ak)}static max(){return new cc(on.max(),Tt.empty(),ak)}}function vU(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Tt.comparator(t.documentKey,e.documentKey),n!==0?n:In(t.largestBatchId,e.largestBatchId))}const jce="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fce{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ev(t){if(t.code!==We.FAILED_PRECONDITION||t.message!==jce)throw t;ft("LocalStore","Unexpectedly lost primary lease")}class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ht(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new we(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof we?n:we.resolve(n)}catch(n){return we.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):we.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):we.reject(n)}static resolve(e){return new we(((n,r)=>{n(e)}))}static reject(e){return new we(((n,r)=>{r(e)}))}static waitFor(e){return new we(((n,r)=>{let i=0,s=0,o=!1;e.forEach((a=>{++i,a.next((()=>{++s,o&&s===i&&n()}),(l=>r(l)))})),o=!0,s===i&&n()}))}static or(e){let n=we.resolve(!1);for(const r of e)n=n.next((i=>i?we.resolve(i):r()));return n}static forEach(e,n){const r=[];return e.forEach(((i,s)=>{r.push(n.call(this,i,s))})),this.waitFor(r)}static mapArray(e,n){return new we(((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next((u=>{o[c]=u,++a,a===s&&r(o)}),(u=>i(u)))}}))}static doWhile(e,n){return new we(((r,i)=>{const s=()=>{e()===!0?n().next((()=>{s()}),i):r()};s()}))}}const ql="SimpleDb";class v5{static open(e,n,r,i){try{return new v5(n,e.transaction(i,r))}catch(s){throw new VS(n,s)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ud,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new VS(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=_U(r.target.error);this.S.reject(new VS(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ft(ql,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new L4e(n)}}class dg{static delete(e){return ft(ql,"Removing database:",e),dy(Cle().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!zle())return!1;if(dg.F())return!0;const e=Us(),n=dg.M(e),r=0<n&&n<10,i=Vce(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,dg.M(Us())===12.2&&Ra("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ft(ql,"Opening database:",this.name),this.db=await new Promise(((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new VS(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new Et(We.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Et(We.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new VS(e,o))},i.onupgradeneeded=s=>{ft(ql,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{ft(ql,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=n=>this.q(n)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=v5.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next((c=>(a.C(),c))).catch((c=>(a.abort(c),we.reject(c)))).toPromise();return l.catch((()=>{})),await a.D,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(ft(ql,"Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Vce(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class O4e{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return dy(this.U.delete())}}class VS extends Et{constructor(e,n){super(We.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function qg(t){return t.name==="IndexedDbTransactionError"}class L4e{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(ft(ql,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(ft(ql,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),dy(r)}add(e){return ft(ql,"ADD",this.store.name,e,e),dy(this.store.add(e))}get(e){return dy(this.store.get(e)).next((n=>(n===void 0&&(n=null),ft(ql,"GET",this.store.name,e,n),n)))}delete(e){return ft(ql,"DELETE",this.store.name,e),dy(this.store.delete(e))}count(){return ft(ql,"COUNT",this.store.name),dy(this.store.count())}J(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new we(((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}}))}{const s=this.cursor(r),o=[];return this.H(s,((a,l)=>{o.push(l)})).next((()=>o))}}Y(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new we(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,n){ft(ql,"DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,((s,o,a)=>a.delete()))}ee(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}te(e){const n=this.cursor({});return new we(((r,i)=>{n.onerror=s=>{const o=_U(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next((a=>{a?o.continue():r()})):r()}}))}H(e,n){const r=[];return new we(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new O4e(a),c=n(a.primaryKey,a.value,l);if(c instanceof we){const u=c.catch((h=>(l.done(),we.reject(h))));r.push(u)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}})).next((()=>we.waitFor(r)))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function dy(t){return new we(((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=_U(r.target.error);n(i)}}))}let _Z=!1;function _U(t){const e=dg.M(Us());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Et("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _Z||(_Z=!0,setTimeout((()=>{throw r}),0)),r}}return t}const zS="IndexBackfiller";class D4e{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ft(zS,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const n=await this.ne.ie();ft(zS,`Documents written: ${n}`)}catch(n){qg(n)?ft(zS,"Ignoring IndexedDB error during index backfill: ",n):await ev(n)}await this.re(6e4)}))}}class $4e{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(n=>this.se(n,e)))}se(e,n){const r=new Set;let i=n,s=!0;return we.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return ft(zS,`Processing collection: ${o}`),this.oe(e,o,i).next((a=>{i-=a,r.add(o)}));s=!1})))).next((()=>n-i))}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next((i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next((s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((a=>(ft(zS,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a)))).next((()=>o.size))}))))}_e(e,n){let r=e;return n.changes.forEach(((i,s)=>{const o=$ce(s);vU(o,r)>0&&(r=o)})),new cc(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}class Yc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Yc.ce=-1;const Gy=-1;function _5(t){return t==null}function ck(t){return t===0&&1/t==-1/0}function j4e(t){return typeof t=="number"&&Number.isInteger(t)&&!ck(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const N3="";function ua(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=xZ(e)),e=F4e(t.get(n),e);return xZ(e)}function F4e(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case N3:n+="";break;default:n+=s}}return n}function xZ(t){return t+N3+""}function id(t){const e=t.length;if(nn(e>=2,64408,{path:t}),e===2)return nn(t.charAt(0)===N3&&t.charAt(1)==="",56145,{path:t}),Er.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf(N3,s);switch((o<0||o>n)&&Ht(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:Ht(61167,{path:t})}s=o+2}return new Er(r)}const z0="remoteDocuments",jA="owner",r_="owner",uk="mutationQueues",V4e="userId",Uu="mutations",wZ="batchId",ky="userMutationsIndex",bZ=["userId","batchId"];function IM(t,e){return[t,ua(e)]}function zce(t,e,n){return[t,ua(e),n]}const z4e={},zw="documentMutations",O3="remoteDocumentsV14",U4e=["prefixPath","collectionGroup","readTime","documentId"],RM="documentKeyIndex",G4e=["prefixPath","collectionGroup","documentId"],Uce="collectionGroupIndex",B4e=["collectionGroup","readTime","prefixPath","documentId"],hk="remoteDocumentGlobal",Mj="remoteDocumentGlobalKey",Uw="targets",Gce="queryTargetsIndex",W4e=["canonicalId","targetId"],Gw="targetDocuments",H4e=["targetId","path"],xU="documentTargetsIndex",q4e=["path","targetId"],L3="targetGlobalKey",By="targetGlobal",dk="collectionParents",K4e=["collectionId","parent"],Bw="clientMetadata",Y4e="clientId",x5="bundles",X4e="bundleId",w5="namedQueries",Z4e="name",wU="indexConfiguration",J4e="indexId",Cj="collectionGroupIndex",Q4e="collectionGroup",US="indexState",eNe=["indexId","uid"],Bce="sequenceNumberIndex",tNe=["uid","sequenceNumber"],GS="indexEntries",nNe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Wce="documentKeyIndex",rNe=["indexId","uid","orderedDocumentKey"],b5="documentOverlays",iNe=["userId","collectionPath","documentId"],Nj="collectionPathOverlayIndex",sNe=["userId","collectionPath","largestBatchId"],Hce="collectionGroupOverlayIndex",oNe=["userId","collectionGroup","largestBatchId"],bU="globals",aNe="name",qce=[uk,Uu,zw,z0,Uw,jA,By,Gw,Bw,hk,dk,x5,w5],lNe=[...qce,b5],Kce=[uk,Uu,zw,O3,Uw,jA,By,Gw,Bw,hk,dk,x5,w5,b5],Yce=Kce,EU=[...Yce,wU,US,GS],cNe=EU,Xce=[...EU,bU],uNe=Xce;class Oj extends Fce{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function Bs(t,e){const n=Rn(t);return dg.O(n.le,e)}function EZ(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Kg(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Zce(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class bi{constructor(e,n){this.comparator=e,this.root=n||Ao.EMPTY}insert(e,n){return new bi(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ao.BLACK,null,null))}remove(e){return new bi(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ao.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new iP(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new iP(this.root,e,this.comparator,!1)}getReverseIterator(){return new iP(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new iP(this.root,e,this.comparator,!0)}}class iP{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ao{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Ao.RED,this.left=i??Ao.EMPTY,this.right=s??Ao.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ao(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ao.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ao.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ao.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ao.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ht(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ht(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ht(27949);return e+(this.isRed()?0:1)}}Ao.EMPTY=null,Ao.RED=!0,Ao.BLACK=!1;Ao.EMPTY=new class{constructor(){this.size=0}get key(){throw Ht(57766)}get value(){throw Ht(16141)}get color(){throw Ht(16727)}get left(){throw Ht(29726)}get right(){throw Ht(36894)}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ao(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Gr{constructor(e){this.comparator=e,this.data=new bi(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new SZ(this.data.getIterator())}getIteratorFrom(e){return new SZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof Gr)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Gr(this.comparator);return n.data=e,n}}class SZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function i_(t){return t.hasNext()?t.getNext():void 0}class fl{constructor(e){this.fields=e,e.sort(Ni.comparator)}static empty(){return new fl([])}unionWith(e){let n=new Gr(Ni.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fl(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Vw(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class Jce extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class As{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Jce("Invalid base64 string: "+s):s}})(e);return new As(n)}static fromUint8Array(e){const n=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new As(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return In(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}As.EMPTY_BYTE_STRING=new As("");const hNe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sp(t){if(nn(!!t,39018),typeof t=="string"){let e=0;const n=hNe.exec(t);if(nn(!!n,46558,{timestamp:t}),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vi(t.seconds),nanos:vi(t.nanos)}}function vi(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function op(t){return typeof t=="string"?As.fromBase64String(t):As.fromUint8Array(t)}const Qce="server_timestamp",eue="__type__",tue="__previous_value__",nue="__local_write_time__";function SU(t){return(t?.mapValue?.fields||{})[eue]?.stringValue===Qce}function E5(t){const e=t.mapValue.fields[tue];return SU(e)?E5(e):e}function fk(t){const e=sp(t.mapValue.fields[nue].timestampValue);return new Vr(e.seconds,e.nanos)}class dNe{constructor(e,n,r,i,s,o,a,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const D3="(default)";class b1{constructor(e,n){this.projectId=e,this.database=n||D3}static empty(){return new b1("","")}get isDefaultDatabase(){return this.database===D3}isEqual(e){return e instanceof b1&&e.projectId===this.projectId&&e.database===this.database}}const TU="__type__",rue="__max__",qm={mapValue:{fields:{__type__:{stringValue:rue}}}},kU="__vector__",Ww="value",PM={nullValue:"NULL_VALUE"};function kg(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?SU(t)?4:iue(t)?9007199254740991:S5(t)?10:11:Ht(28295,{value:t})}function bd(t,e){if(t===e)return!0;const n=kg(t);if(n!==kg(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fk(t).isEqual(fk(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=sp(i.timestampValue),a=sp(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(i,s){return op(i.bytesValue).isEqual(op(s.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(i,s){return vi(i.geoPointValue.latitude)===vi(s.geoPointValue.latitude)&&vi(i.geoPointValue.longitude)===vi(s.geoPointValue.longitude)})(t,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return vi(i.integerValue)===vi(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=vi(i.doubleValue),a=vi(s.doubleValue);return o===a?ck(o)===ck(a):isNaN(o)&&isNaN(a)}return!1})(t,e);case 9:return Vw(t.arrayValue.values||[],e.arrayValue.values||[],bd);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(EZ(o)!==EZ(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!bd(o[l],a[l])))return!1;return!0})(t,e);default:return Ht(52216,{left:t})}}function pk(t,e){return(t.values||[]).find((n=>bd(n,e)))!==void 0}function Ag(t,e){if(t===e)return 0;const n=kg(t),r=kg(e);if(n!==r)return In(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return In(t.booleanValue,e.booleanValue);case 2:return(function(s,o){const a=vi(s.integerValue||s.doubleValue),l=vi(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(t,e);case 3:return TZ(t.timestampValue,e.timestampValue);case 4:return TZ(fk(t),fk(e));case 5:return Rj(t.stringValue,e.stringValue);case 6:return(function(s,o){const a=op(s),l=op(o);return a.compareTo(l)})(t.bytesValue,e.bytesValue);case 7:return(function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=In(a[c],l[c]);if(u!==0)return u}return In(a.length,l.length)})(t.referenceValue,e.referenceValue);case 8:return(function(s,o){const a=In(vi(s.latitude),vi(o.latitude));return a!==0?a:In(vi(s.longitude),vi(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return kZ(t.arrayValue,e.arrayValue);case 10:return(function(s,o){const a=s.fields||{},l=o.fields||{},c=a[Ww]?.arrayValue,u=l[Ww]?.arrayValue,h=In(c?.values?.length||0,u?.values?.length||0);return h!==0?h:kZ(c,u)})(t.mapValue,e.mapValue);case 11:return(function(s,o){if(s===qm.mapValue&&o===qm.mapValue)return 0;if(s===qm.mapValue)return 1;if(o===qm.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const f=Rj(l[h],u[h]);if(f!==0)return f;const g=Ag(a[l[h]],c[u[h]]);if(g!==0)return g}return In(l.length,u.length)})(t.mapValue,e.mapValue);default:throw Ht(23264,{he:n})}}function TZ(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return In(t,e);const n=sp(t),r=sp(e),i=In(n.seconds,r.seconds);return i!==0?i:In(n.nanos,r.nanos)}function kZ(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=Ag(n[i],r[i]);if(s)return s}return In(n.length,r.length)}function Hw(t){return Lj(t)}function Lj(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=sp(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return op(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Tt.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Lj(s);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Lj(n.fields[o])}`;return i+"}"})(t.mapValue):Ht(61005,{value:t})}function MM(t){switch(kg(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=E5(t);return e?16+MM(e):16;case 5:return 2*t.stringValue.length;case 6:return op(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+MM(s)),0)})(t.arrayValue);case 10:case 11:return(function(r){let i=0;return Kg(r.fields,((s,o)=>{i+=s.length+MM(o)})),i})(t.mapValue);default:throw Ht(13486,{value:t})}}function mk(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Dj(t){return!!t&&"integerValue"in t}function gk(t){return!!t&&"arrayValue"in t}function AZ(t){return!!t&&"nullValue"in t}function IZ(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function CM(t){return!!t&&"mapValue"in t}function S5(t){return(t?.mapValue?.fields||{})[TU]?.stringValue===kU}function BS(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Kg(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=BS(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=BS(t.arrayValue.values[n]);return e}return{...t}}function iue(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===rue}const sue={mapValue:{fields:{[TU]:{stringValue:kU},[Ww]:{arrayValue:{}}}}};function fNe(t){return"nullValue"in t?PM:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?mk(b1.empty(),Tt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?S5(t)?sue:{mapValue:{}}:Ht(35942,{value:t})}function pNe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?mk(b1.empty(),Tt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?sue:"mapValue"in t?S5(t)?{mapValue:{}}:qm:Ht(61959,{value:t})}function RZ(t,e){const n=Ag(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function PZ(t,e){const n=Ag(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class ra{constructor(e){this.value=e}static empty(){return new ra({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!CM(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=BS(n)}setAll(e){let n=Ni.emptyPath(),r={},i=[];e.forEach(((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=BS(o):i.push(a.lastSegment())}));const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());CM(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bd(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];CM(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Kg(n,((i,s)=>e[i]=s));for(const i of r)delete e[i]}clone(){return new ra(BS(this.value))}}function oue(t){const e=[];return Kg(t.fields,((n,r)=>{const i=new Ni([n]);if(CM(r)){const s=oue(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)})),new fl(e)}class Xi{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Xi(e,0,on.min(),on.min(),on.min(),ra.empty(),0)}static newFoundDocument(e,n,r,i){return new Xi(e,1,n,on.min(),r,i,0)}static newNoDocument(e,n){return new Xi(e,2,n,on.min(),on.min(),ra.empty(),0)}static newUnknownDocument(e,n){return new Xi(e,3,n,on.min(),on.min(),ra.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(on.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ra.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ra.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=on.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qw{constructor(e,n){this.position=e,this.inclusive=n}}function MZ(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=Tt.comparator(Tt.fromName(o.referenceValue),n.key):r=Ag(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function CZ(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bd(t.position[n],e.position[n]))return!1;return!0}class $3{constructor(e,n="asc"){this.field=e,this.dir=n}}function mNe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class aue{}class er extends aue{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new gNe(e,n,r):n==="array-contains"?new _Ne(e,r):n==="in"?new fue(e,r):n==="not-in"?new xNe(e,r):n==="array-contains-any"?new wNe(e,r):new er(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new yNe(e,r):new vNe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ag(n,this.value)):n!==null&&kg(this.value)===kg(n)&&this.matchesComparison(Ag(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ht(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zr extends aue{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new zr(e,n)}matches(e){return Kw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Kw(t){return t.op==="and"}function $j(t){return t.op==="or"}function AU(t){return lue(t)&&Kw(t)}function lue(t){for(const e of t.filters)if(e instanceof zr)return!1;return!0}function jj(t){if(t instanceof er)return t.field.canonicalString()+t.op.toString()+Hw(t.value);if(AU(t))return t.filters.map((e=>jj(e))).join(",");{const e=t.filters.map((n=>jj(n))).join(",");return`${t.op}(${e})`}}function cue(t,e){return t instanceof er?(function(r,i){return i instanceof er&&r.op===i.op&&r.field.isEqual(i.field)&&bd(r.value,i.value)})(t,e):t instanceof zr?(function(r,i){return i instanceof zr&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,a)=>s&&cue(o,i.filters[a])),!0):!1})(t,e):void Ht(19439)}function uue(t,e){const n=t.filters.concat(e);return zr.create(n,t.op)}function hue(t){return t instanceof er?(function(n){return`${n.field.canonicalString()} ${n.op} ${Hw(n.value)}`})(t):t instanceof zr?(function(n){return n.op.toString()+" {"+n.getFilters().map(hue).join(" ,")+"}"})(t):"Filter"}class gNe extends er{constructor(e,n,r){super(e,n,r),this.key=Tt.fromName(r.referenceValue)}matches(e){const n=Tt.comparator(e.key,this.key);return this.matchesComparison(n)}}class yNe extends er{constructor(e,n){super(e,"in",n),this.keys=due("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class vNe extends er{constructor(e,n){super(e,"not-in",n),this.keys=due("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function due(t,e){return(e.arrayValue?.values||[]).map((n=>Tt.fromName(n.referenceValue)))}class _Ne extends er{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return gk(n)&&pk(n.arrayValue,this.value)}}class fue extends er{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&pk(this.value.arrayValue,n)}}class xNe extends er{constructor(e,n){super(e,"not-in",n)}matches(e){if(pk(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!pk(this.value.arrayValue,n)}}class wNe extends er{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!gk(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>pk(this.value.arrayValue,r)))}}class bNe{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function Fj(t,e=null,n=[],r=[],i=null,s=null,o=null){return new bNe(t,e,n,r,i,s,o)}function E1(t){const e=Rn(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>jj(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),_5(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>Hw(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>Hw(r))).join(",")),e.Te=n}return e.Te}function FA(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!mNe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!cue(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CZ(t.startAt,e.startAt)&&CZ(t.endAt,e.endAt)}function j3(t){return Tt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function F3(t,e){return t.filters.filter((n=>n instanceof er&&n.field.isEqual(e)))}function NZ(t,e,n){let r=PM,i=!0;for(const s of F3(t,e)){let o=PM,a=!0;switch(s.op){case"<":case"<=":o=fNe(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=PM}RZ({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];RZ({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function OZ(t,e,n){let r=qm,i=!0;for(const s of F3(t,e)){let o=qm,a=!0;switch(s.op){case">=":case">":o=pNe(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=qm}PZ({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];PZ({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}class VA{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ENe(t,e,n,r,i,s,o,a){return new VA(t,e,n,r,i,s,o,a)}function T5(t){return new VA(t)}function LZ(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function pue(t){return t.collectionGroup!==null}function WS(t){const e=Rn(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Gr(Ni.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(e).forEach((s=>{n.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new $3(s,r))})),n.has(Ni.keyField().canonicalString())||e.Ie.push(new $3(Ni.keyField(),r))}return e.Ie}function Qc(t){const e=Rn(t);return e.Ee||(e.Ee=SNe(e,WS(t))),e.Ee}function SNe(t,e){if(t.limitType==="F")return Fj(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new $3(i.field,s)}));const n=t.endAt?new qw(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new qw(t.startAt.position,t.startAt.inclusive):null;return Fj(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Vj(t,e){const n=t.filters.concat([e]);return new VA(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zj(t,e,n){return new VA(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function k5(t,e){return FA(Qc(t),Qc(e))&&t.limitType===e.limitType}function mue(t){return`${E1(Qc(t))}|lt:${t.limitType}`}function C_(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((i=>hue(i))).join(", ")}]`),_5(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((i=>Hw(i))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((i=>Hw(i))).join(",")),`Target(${r})`})(Qc(t))}; limitType=${t.limitType})`}function zA(t,e){return e.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Tt.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(t,e)&&(function(r,i){for(const s of WS(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(t,e)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(t,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,l){const c=MZ(o,a,l);return o.inclusive?c<=0:c<0})(r.startAt,WS(r),i)||r.endAt&&!(function(o,a,l){const c=MZ(o,a,l);return o.inclusive?c>=0:c>0})(r.endAt,WS(r),i))})(t,e)}function TNe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gue(t){return(e,n)=>{let r=!1;for(const i of WS(t)){const s=kNe(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function kNe(t,e,n){const r=t.field.isKeyField()?Tt.comparator(e.key,n.key):(function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?Ag(l,c):Ht(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ht(19790,{direction:t.dir})}}class yp{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Kg(this.inner,((n,r)=>{for(const[i,s]of r)e(i,s)}))}isEmpty(){return Zce(this.inner)}size(){return this.innerSize}}const ANe=new bi(Tt.comparator);function nc(){return ANe}const yue=new bi(Tt.comparator);function BE(...t){let e=yue;for(const n of t)e=e.insert(n.key,n);return e}function vue(t){let e=yue;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function sd(){return HS()}function _ue(){return HS()}function HS(){return new yp((t=>t.toString()),((t,e)=>t.isEqual(e)))}const INe=new bi(Tt.comparator),RNe=new Gr(Tt.comparator);function Bn(...t){let e=RNe;for(const n of t)e=e.add(n);return e}const PNe=new Gr(In);function MNe(){return PNe}function IU(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ck(e)?"-0":e}}function xue(t){return{integerValue:""+t}}function CNe(t,e){return j4e(e)?xue(e):IU(t,e)}class A5{constructor(){this._=void 0}}function NNe(t,e,n){return t instanceof Yw?(function(i,s){const o={fields:{[eue]:{stringValue:Qce},[nue]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&SU(s)&&(s=E5(s)),s&&(o.fields[tue]=s),{mapValue:o}})(n,e):t instanceof Xw?bue(t,e):t instanceof Zw?Eue(t,e):(function(i,s){const o=wue(i,s),a=DZ(o)+DZ(i.Ae);return Dj(o)&&Dj(i.Ae)?xue(a):IU(i.serializer,a)})(t,e)}function ONe(t,e,n){return t instanceof Xw?bue(t,e):t instanceof Zw?Eue(t,e):n}function wue(t,e){return t instanceof yk?(function(r){return Dj(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}class Yw extends A5{}class Xw extends A5{constructor(e){super(),this.elements=e}}function bue(t,e){const n=Sue(e);for(const r of t.elements)n.some((i=>bd(i,r)))||n.push(r);return{arrayValue:{values:n}}}class Zw extends A5{constructor(e){super(),this.elements=e}}function Eue(t,e){let n=Sue(e);for(const r of t.elements)n=n.filter((i=>!bd(i,r)));return{arrayValue:{values:n}}}class yk extends A5{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function DZ(t){return vi(t.integerValue||t.doubleValue)}function Sue(t){return gk(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Tue{constructor(e,n){this.field=e,this.transform=n}}function LNe(t,e){return t.field.isEqual(e.field)&&(function(r,i){return r instanceof Xw&&i instanceof Xw||r instanceof Zw&&i instanceof Zw?Vw(r.elements,i.elements,bd):r instanceof yk&&i instanceof yk?bd(r.Ae,i.Ae):r instanceof Yw&&i instanceof Yw})(t.transform,e.transform)}class DNe{constructor(e,n){this.version=e,this.transformResults=n}}class oa{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new oa}static exists(e){return new oa(void 0,e)}static updateTime(e){return new oa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function NM(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class I5{}function kue(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new R5(t.key,oa.none()):new j2(t.key,t.data,oa.none());{const n=t.data,r=ra.empty();let i=new Gr(Ni.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new vp(t.key,r,new fl(i.toArray()),oa.none())}}function $Ne(t,e,n){t instanceof j2?(function(i,s,o){const a=i.value.clone(),l=jZ(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(t,e,n):t instanceof vp?(function(i,s,o){if(!NM(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=jZ(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Aue(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,n):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function qS(t,e,n,r){return t instanceof j2?(function(s,o,a,l){if(!NM(s.precondition,o))return a;const c=s.value.clone(),u=FZ(s.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null})(t,e,n,r):t instanceof vp?(function(s,o,a,l){if(!NM(s.precondition,o))return a;const c=FZ(s.fieldTransforms,l,o),u=o.data;return u.setAll(Aue(s)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((h=>h.field)))})(t,e,n,r):(function(s,o,a){return NM(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(t,e,n)}function jNe(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=wue(r.transform,i||null);s!=null&&(n===null&&(n=ra.empty()),n.set(r.field,s))}return n||null}function $Z(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Vw(r,i,((s,o)=>LNe(s,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class j2 extends I5{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class vp extends I5{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Aue(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function jZ(t,e,n){const r=new Map;nn(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,ONe(o,a,n[i]))}return r}function FZ(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,NNe(s,o,e))}return r}class R5 extends I5{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Iue extends I5{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class RU{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&$Ne(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=qS(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=qS(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=_ue();return this.mutations.forEach((i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=kue(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(on.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Bn())}isEqual(e){return this.batchId===e.batchId&&Vw(this.mutations,e.mutations,((n,r)=>$Z(n,r)))&&Vw(this.baseMutations,e.baseMutations,((n,r)=>$Z(n,r)))}}class PU{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){nn(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return INe})();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new PU(e,n,r,i)}}class MU{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class FNe{constructor(e,n){this.count=e,this.unchangedNames=n}}var gs,rr;function VNe(t){switch(t){case We.OK:return Ht(64938);case We.CANCELLED:case We.UNKNOWN:case We.DEADLINE_EXCEEDED:case We.RESOURCE_EXHAUSTED:case We.INTERNAL:case We.UNAVAILABLE:case We.UNAUTHENTICATED:return!1;case We.INVALID_ARGUMENT:case We.NOT_FOUND:case We.ALREADY_EXISTS:case We.PERMISSION_DENIED:case We.FAILED_PRECONDITION:case We.ABORTED:case We.OUT_OF_RANGE:case We.UNIMPLEMENTED:case We.DATA_LOSS:return!0;default:return Ht(15467,{code:t})}}function Rue(t){if(t===void 0)return Ra("GRPC error has no .code"),We.UNKNOWN;switch(t){case gs.OK:return We.OK;case gs.CANCELLED:return We.CANCELLED;case gs.UNKNOWN:return We.UNKNOWN;case gs.DEADLINE_EXCEEDED:return We.DEADLINE_EXCEEDED;case gs.RESOURCE_EXHAUSTED:return We.RESOURCE_EXHAUSTED;case gs.INTERNAL:return We.INTERNAL;case gs.UNAVAILABLE:return We.UNAVAILABLE;case gs.UNAUTHENTICATED:return We.UNAUTHENTICATED;case gs.INVALID_ARGUMENT:return We.INVALID_ARGUMENT;case gs.NOT_FOUND:return We.NOT_FOUND;case gs.ALREADY_EXISTS:return We.ALREADY_EXISTS;case gs.PERMISSION_DENIED:return We.PERMISSION_DENIED;case gs.FAILED_PRECONDITION:return We.FAILED_PRECONDITION;case gs.ABORTED:return We.ABORTED;case gs.OUT_OF_RANGE:return We.OUT_OF_RANGE;case gs.UNIMPLEMENTED:return We.UNIMPLEMENTED;case gs.DATA_LOSS:return We.DATA_LOSS;default:return Ht(39323,{code:t})}}(rr=gs||(gs={}))[rr.OK=0]="OK",rr[rr.CANCELLED=1]="CANCELLED",rr[rr.UNKNOWN=2]="UNKNOWN",rr[rr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rr[rr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rr[rr.NOT_FOUND=5]="NOT_FOUND",rr[rr.ALREADY_EXISTS=6]="ALREADY_EXISTS",rr[rr.PERMISSION_DENIED=7]="PERMISSION_DENIED",rr[rr.UNAUTHENTICATED=16]="UNAUTHENTICATED",rr[rr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rr[rr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rr[rr.ABORTED=10]="ABORTED",rr[rr.OUT_OF_RANGE=11]="OUT_OF_RANGE",rr[rr.UNIMPLEMENTED=12]="UNIMPLEMENTED",rr[rr.INTERNAL=13]="INTERNAL",rr[rr.UNAVAILABLE=14]="UNAVAILABLE",rr[rr.DATA_LOSS=15]="DATA_LOSS";function zNe(){return new TextEncoder}const UNe=new hg([4294967295,4294967295],0);function VZ(t){const e=zNe().encode(t),n=new kce;return n.update(e),new Uint8Array(n.digest())}function zZ(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new hg([n,r],0),new hg([i,s],0)]}class CU{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new WE(`Invalid padding: ${n}`);if(r<0)throw new WE(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new WE(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new WE(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=hg.fromNumber(this.ge)}ye(e,n,r){let i=e.add(n.multiply(hg.fromNumber(r)));return i.compare(UNe)===1&&(i=new hg([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=VZ(e),[r,i]=zZ(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new CU(s,i,n);return r.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const n=VZ(e),[r,i]=zZ(n);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class WE extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class P5{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,UA.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new P5(on.min(),i,new bi(In),nc(),Bn())}}class UA{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new UA(r,n,Bn(),Bn(),Bn())}}class OM{constructor(e,n,r,i){this.be=e,this.removedTargetIds=n,this.key=r,this.De=i}}class Pue{constructor(e,n){this.targetId=e,this.Ce=n}}class Mue{constructor(e,n,r=As.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class UZ{constructor(){this.ve=0,this.Fe=GZ(),this.Me=As.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Bn(),n=Bn(),r=Bn();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ht(38017,{changeType:s})}})),new UA(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=GZ()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,nn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class GNe{constructor(e){this.Ge=e,this.ze=new Map,this.je=nc(),this.Je=sP(),this.He=sP(),this.Ye=new bi(In)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:Ht(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,i)=>{this.rt(i)&&n(i)}))}st(e){const n=e.targetId,r=e.Ce.count,i=this.ot(n);if(i){const s=i.target;if(j3(s))if(r===0){const o=new Tt(s.path);this.et(n,o,Xi.newNoDocument(o,on.min()))}else nn(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,c)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=op(r).toUint8Array()}catch(l){if(l instanceof Jce)return w1("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new CU(o,i,s)}catch(l){return w1(l instanceof WE?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(n,s,null),i++)})),i}Tt(e){const n=new Map;this.ze.forEach(((s,o)=>{const a=this.ot(o);if(a){if(s.current&&j3(a.target)){const l=new Tt(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Xi.newNoDocument(l,e))}s.Be&&(n.set(o,s.ke()),s.qe())}}));let r=Bn();this.He.forEach(((s,o)=>{let a=!0;o.forEachWhile((l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));const i=new P5(e,n,this.Ye,this.je,r);return this.je=nc(),this.Je=sP(),this.He=sP(),this.Ye=new bi(In),i}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,n)?i.Qe(n,1):i.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new UZ,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Gr(In),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Gr(In),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ft("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new UZ),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function sP(){return new bi(Tt.comparator)}function GZ(){return new bi(Tt.comparator)}const BNe={asc:"ASCENDING",desc:"DESCENDING"},WNe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HNe={and:"AND",or:"OR"};class qNe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Uj(t,e){return t.useProto3Json||_5(e)?e:{value:e}}function Jw(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cue(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function KNe(t,e){return Jw(t,e.toTimestamp())}function Oa(t){return nn(!!t,49232),on.fromTimestamp((function(n){const r=sp(n);return new Vr(r.seconds,r.nanos)})(t))}function NU(t,e){return Gj(t,e).canonicalString()}function Gj(t,e){const n=(function(i){return new Er(["projects",i.projectId,"databases",i.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Nue(t){const e=Er.fromString(t);return nn(Uue(e),10190,{key:e.toString()}),e}function V3(t,e){return NU(t.databaseId,e.path)}function Wy(t,e){const n=Nue(e);if(n.get(1)!==t.databaseId.projectId)throw new Et(We.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Et(We.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Tt(Due(n))}function Oue(t,e){return NU(t.databaseId,e)}function Lue(t){const e=Nue(t);return e.length===4?Er.emptyPath():Due(e)}function Bj(t){return new Er(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Due(t){return nn(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function BZ(t,e,n){return{name:V3(t,e),fields:n.value.mapValue.fields}}function YNe(t,e,n){const r=Wy(t,e.name),i=Oa(e.updateTime),s=e.createTime?Oa(e.createTime):on.min(),o=new ra({mapValue:{fields:e.fields}}),a=Xi.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function XNe(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ht(39313,{state:c})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(c,u){return c.useProto3Json?(nn(u===void 0||typeof u=="string",58123),As.fromBase64String(u||"")):(nn(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),As.fromUint8Array(u||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(c){const u=c.code===void 0?We.UNKNOWN:Rue(c.code);return new Et(u,c.message||"")})(o);n=new Mue(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Wy(t,r.document.name),s=Oa(r.document.updateTime),o=r.document.createTime?Oa(r.document.createTime):on.min(),a=new ra({mapValue:{fields:r.document.fields}}),l=Xi.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new OM(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Wy(t,r.document),s=r.readTime?Oa(r.readTime):on.min(),o=Xi.newNoDocument(i,s),a=r.removedTargetIds||[];n=new OM([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Wy(t,r.document),s=r.removedTargetIds||[];n=new OM([],s,i,null)}else{if(!("filter"in e))return Ht(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new FNe(i,s),a=r.targetId;n=new Pue(a,o)}}return n}function z3(t,e){let n;if(e instanceof j2)n={update:BZ(t,e.key,e.value)};else if(e instanceof R5)n={delete:V3(t,e.key)};else if(e instanceof vp)n={update:BZ(t,e.key,e.data),updateMask:n5e(e.fieldMask)};else{if(!(e instanceof Iue))return Ht(16599,{Vt:e.type});n={verify:V3(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){const a=o.transform;if(a instanceof Yw)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Xw)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Zw)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof yk)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Ht(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:KNe(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ht(27497)})(t,e.precondition)),n}function Wj(t,e){const n=e.currentDocument?(function(s){return s.updateTime!==void 0?oa.updateTime(Oa(s.updateTime)):s.exists!==void 0?oa.exists(s.exists):oa.none()})(e.currentDocument):oa.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,a){let l=null;if("setToServerValue"in a)nn(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),l=new Yw;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];l=new Xw(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];l=new Zw(u)}else"increment"in a?l=new yk(o,a.increment):Ht(16584,{proto:a});const c=Ni.fromServerFormat(a.fieldPath);return new Tue(c,l)})(t,i))):[];if(e.update){e.update.name;const i=Wy(t,e.update.name),s=new ra({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=(function(l){const c=l.fieldPaths||[];return new fl(c.map((u=>Ni.fromServerFormat(u))))})(e.updateMask);return new vp(i,s,o,n,r)}return new j2(i,s,n,r)}if(e.delete){const i=Wy(t,e.delete);return new R5(i,n)}if(e.verify){const i=Wy(t,e.verify);return new Iue(i,n)}return Ht(1463,{proto:e})}function ZNe(t,e){return t&&t.length>0?(nn(e!==void 0,14353),t.map((n=>(function(i,s){let o=i.updateTime?Oa(i.updateTime):Oa(s);return o.isEqual(on.min())&&(o=Oa(s)),new DNe(o,i.transformResults||[])})(n,e)))):[]}function $ue(t,e){return{documents:[Oue(t,e.path)]}}function jue(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Oue(t,i);const s=(function(c){if(c.length!==0)return zue(zr.create(c,"and"))})(e.filters);s&&(n.structuredQuery.where=s);const o=(function(c){if(c.length!==0)return c.map((u=>(function(f){return{field:N_(f.field),direction:QNe(f.dir)}})(u)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Uj(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(e.endAt)),{ft:n,parent:i}}function Fue(t){let e=Lue(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){nn(r===1,65062);const u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=(function(h){const f=Vue(h);return f instanceof zr&&AU(f)?f.getFilters():[f]})(n.where));let o=[];n.orderBy&&(o=(function(h){return h.map((f=>(function(v){return new $3(O_(v.field),(function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(v.direction))})(f)))})(n.orderBy));let a=null;n.limit&&(a=(function(h){let f;return f=typeof h=="object"?h.value:h,_5(f)?null:f})(n.limit));let l=null;n.startAt&&(l=(function(h){const f=!!h.before,g=h.values||[];return new qw(g,f)})(n.startAt));let c=null;return n.endAt&&(c=(function(h){const f=!h.before,g=h.values||[];return new qw(g,f)})(n.endAt)),ENe(e,i,o,s,a,"F",l,c)}function JNe(t,e){const n=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ht(28987,{purpose:i})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Vue(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=O_(n.unaryFilter.field);return er.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=O_(n.unaryFilter.field);return er.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=O_(n.unaryFilter.field);return er.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=O_(n.unaryFilter.field);return er.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ht(61313);default:return Ht(60726)}})(t):t.fieldFilter!==void 0?(function(n){return er.create(O_(n.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ht(58110);default:return Ht(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return zr.create(n.compositeFilter.filters.map((r=>Vue(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ht(1026)}})(n.compositeFilter.op))})(t):Ht(30097,{filter:t})}function QNe(t){return BNe[t]}function e5e(t){return WNe[t]}function t5e(t){return HNe[t]}function N_(t){return{fieldPath:t.canonicalString()}}function O_(t){return Ni.fromServerFormat(t.fieldPath)}function zue(t){return t instanceof er?(function(n){if(n.op==="=="){if(IZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NAN"}};if(AZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(IZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NOT_NAN"}};if(AZ(n.value))return{unaryFilter:{field:N_(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:N_(n.field),op:e5e(n.op),value:n.value}}})(t):t instanceof zr?(function(n){const r=n.getFilters().map((i=>zue(i)));return r.length===1?r[0]:{compositeFilter:{op:t5e(n.op),filters:r}}})(t):Ht(54877,{filter:t})}function n5e(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Uue(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class jf{constructor(e,n,r,i,s=on.min(),o=on.min(),a=As.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new jf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new jf(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new jf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new jf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Gue{constructor(e){this.yt=e}}function r5e(t,e){let n;if(e.document)n=YNe(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Tt.fromSegments(e.noDocument.path),i=T1(e.noDocument.readTime);n=Xi.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ht(56709);{const r=Tt.fromSegments(e.unknownDocument.path),i=T1(e.unknownDocument.version);n=Xi.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime((function(i){const s=new Vr(i[0],i[1]);return on.fromTimestamp(s)})(e.readTime)),n}function WZ(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:U3(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:V3(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Jw(s,o.version.toTimestamp()),createTime:Jw(s,o.createTime.toTimestamp())}})(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:S1(e.version)};else{if(!e.isUnknownDocument())return Ht(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:S1(e.version)}}return r}function U3(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function S1(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function T1(t){const e=new Vr(t.seconds,t.nanoseconds);return on.fromTimestamp(e)}function fy(t,e){const n=(e.baseMutations||[]).map((s=>Wj(t.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map((s=>Wj(t.yt,s))),i=Vr.fromMillis(e.localWriteTimeMs);return new RU(e.batchId,i,n,r)}function HE(t){const e=T1(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?T1(t.lastLimboFreeSnapshotVersion):on.min();let r;return r=(function(s){return s.documents!==void 0})(t.query)?(function(s){const o=s.documents.length;return nn(o===1,1966,{count:o}),Qc(T5(Lue(s.documents[0])))})(t.query):(function(s){return Qc(Fue(s))})(t.query),new jf(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,As.fromBase64String(t.resumeToken))}function Bue(t,e){const n=S1(e.snapshotVersion),r=S1(e.lastLimboFreeSnapshotVersion);let i;i=j3(e.target)?$ue(t.yt,e.target):jue(t.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:E1(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Wue(t){const e=Fue({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zj(e,e.limit,"L"):e}function C6(t,e){return new MU(e.largestBatchId,Wj(t.yt,e.overlayMutation))}function HZ(t,e){const n=e.path.lastSegment();return[t,ua(e.path.popLast()),n]}function qZ(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:S1(r.readTime),documentKey:ua(r.documentKey.path),largestBatchId:r.largestBatchId}}class i5e{getBundleMetadata(e,n){return KZ(e).get(n).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:T1(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,n){return KZ(e).put((function(i){return{bundleId:i.id,createTime:S1(Oa(i.createTime)),version:i.version}})(n))}getNamedQuery(e,n){return YZ(e).get(n).next((r=>{if(r)return(function(s){return{name:s.name,query:Wue(s.bundledQuery),readTime:T1(s.readTime)}})(r)}))}saveNamedQuery(e,n){return YZ(e).put((function(i){return{name:i.name,readTime:S1(Oa(i.readTime)),bundledQuery:i.bundledQuery}})(n))}}function KZ(t){return Bs(t,x5)}function YZ(t){return Bs(t,w5)}class M5{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new M5(e,r)}getOverlay(e,n){return aE(e).get(HZ(this.userId,n)).next((r=>r?C6(this.serializer,r):null))}getOverlays(e,n){const r=sd();return we.forEach(n,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,n,r){const i=[];return r.forEach(((s,o)=>{const a=new MU(n,o);i.push(this.St(e,a))})),we.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach((o=>i.add(ua(o.getCollectionPath()))));const s=[];return i.forEach((o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(aE(e).Z(Nj,a))})),we.waitFor(s)}getOverlaysForCollection(e,n,r){const i=sd(),s=ua(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return aE(e).J(Nj,o).next((a=>{for(const l of a){const c=C6(this.serializer,l);i.set(c.getKey(),c)}return i}))}getOverlaysForCollectionGroup(e,n,r,i){const s=sd();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return aE(e).ee({index:Hce,range:a},((l,c,u)=>{const h=C6(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()})).next((()=>s))}St(e,n){return aE(e).put((function(i,s,o){const[a,l,c]=HZ(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:z3(i.yt,o.mutation)}})(this.serializer,this.userId,n))}}function aE(t){return Bs(t,b5)}class s5e{bt(e){return Bs(e,bU)}getSessionToken(e){return this.bt(e).get("sessionToken").next((n=>{const r=n?.value;return r?As.fromUint8Array(r):As.EMPTY_BYTE_STRING}))}setSessionToken(e,n){return this.bt(e).put({name:"sessionToken",value:n.toUint8Array()})}}class py{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(vi(e.integerValue));else if("doubleValue"in e){const r=vi(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),ck(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=sp(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(op(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?iue(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):S5(e)?this.kt(e.mapValue,n):(this.qt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.Qt(e.arrayValue,n),this.Nt(n)):Ht(19022,{$t:e})}Ot(e,n){this.Ft(n,25),this.Ut(e,n)}Ut(e,n){n.xt(e)}qt(e,n){const r=e.fields||{};this.Ft(n,55);for(const i of Object.keys(r))this.Ot(i,n),this.Ct(r[i],n)}kt(e,n){const r=e.fields||{};this.Ft(n,53);const i=Ww,s=r[i].arrayValue?.values?.length||0;this.Ft(n,15),n.Mt(vi(s)),this.Ot(i,n),this.Ct(r[i],n)}Qt(e,n){const r=e.values||[];this.Ft(n,50);for(const i of r)this.Ct(i,n)}Lt(e,n){this.Ft(n,37),Tt.fromName(e).path.forEach((r=>{this.Ft(n,60),this.Ut(r,n)}))}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}py.Kt=new py;const s_=255;function o5e(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function XZ(t){const e=64-(function(r){let i=0;for(let s=0;s<8;++s){const o=o5e(255&r[s]);if(i+=o,o!==8)break}return i})(t);return Math.ceil(e/8)}class a5e{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Ht()}Yt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const i=n.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=n.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){const n=this.en(e),r=XZ(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}nn(e){const n=this.en(e),r=XZ(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}rn(){this.sn(s_),this.sn(255)}_n(){this.an(s_),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=(function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===s_?(this.sn(s_),this.sn(0)):this.sn(n)}Jt(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===s_?(this.an(s_),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class l5e{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class c5e{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class lE{constructor(){this.cn=new a5e,this.ln=new l5e(this.cn),this.hn=new c5e(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class my{constructor(e,n,r,i){this.Tn=e,this.In=n,this.En=r,this.dn=i}An(){const e=this.dn.length,n=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.dn,0),n!==e?r.set([0],this.dn.length):++r[r.length-1],new my(this.Tn,this.In,this.En,r)}Rn(e,n,r){return{indexId:this.Tn,uid:e,arrayValue:LM(this.En),directionalValue:LM(this.dn),orderedDocumentKey:LM(n),documentKey:r.path.toArray()}}Vn(e,n,r){const i=this.Rn(e,n,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Jp(t,e){let n=t.Tn-e.Tn;return n!==0?n:(n=ZZ(t.En,e.En),n!==0?n:(n=ZZ(t.dn,e.dn),n!==0?n:Tt.comparator(t.In,e.In)))}function ZZ(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function LM(t){return Vle()?(function(n){let r="";for(let i=0;i<n.length;i++)r+=String.fromCharCode(n[i]);return r})(t):t}function JZ(t){return typeof t!="string"?t:(function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r})(t)}class QZ{constructor(e){this.mn=new Gr(((n,r)=>Ni.comparator(n.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const n of e.filters){const r=n;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(nn(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const n=Pj(e);if(n!==void 0&&!this.wn(n))return!1;const r=V0(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){const a=this.mn.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.Sn(a,l)||!this.bn(this.fn[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],a))return!1}return!0}Dn(){if(this.pn)return null;let e=new Gr(Ni.comparator);const n=[];for(const r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new AM(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new AM(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new AM(r.field,r.dir==="asc"?0:1)));return new C3(C3.UNKNOWN_ID,this.collectionId,n,lk.empty())}wn(e){for(const n of this.gn)if(this.Sn(n,e))return!0;return!1}Sn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}bn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}function Hue(t){if(nn(t instanceof er||t instanceof zr,20012),t instanceof er){if(t instanceof fue){const n=t.value.arrayValue?.values?.map((r=>er.create(t.field,"==",r)))||[];return zr.create(n,"or")}return t}const e=t.filters.map((n=>Hue(n)));return zr.create(e,t.op)}function u5e(t){if(t.getFilters().length===0)return[];const e=Kj(Hue(t));return nn(que(e),7391),Hj(e)||qj(e)?[e]:e.getFilters()}function Hj(t){return t instanceof er}function qj(t){return t instanceof zr&&AU(t)}function que(t){return Hj(t)||qj(t)||(function(n){if(n instanceof zr&&$j(n)){for(const r of n.getFilters())if(!Hj(r)&&!qj(r))return!1;return!0}return!1})(t)}function Kj(t){if(nn(t instanceof er||t instanceof zr,34018),t instanceof er)return t;if(t.filters.length===1)return Kj(t.filters[0]);const e=t.filters.map((r=>Kj(r)));let n=zr.create(e,t.op);return n=G3(n),que(n)?n:(nn(n instanceof zr,64498),nn(Kw(n),40251),nn(n.filters.length>1,57927),n.filters.reduce(((r,i)=>OU(r,i))))}function OU(t,e){let n;return nn(t instanceof er||t instanceof zr,38388),nn(e instanceof er||e instanceof zr,25473),n=t instanceof er?e instanceof er?(function(i,s){return zr.create([i,s],"and")})(t,e):eJ(t,e):e instanceof er?eJ(e,t):(function(i,s){if(nn(i.filters.length>0&&s.filters.length>0,48005),Kw(i)&&Kw(s))return uue(i,s.getFilters());const o=$j(i)?i:s,a=$j(i)?s:i,l=o.filters.map((c=>OU(c,a)));return zr.create(l,"or")})(t,e),G3(n)}function eJ(t,e){if(Kw(e))return uue(e,t.getFilters());{const n=e.filters.map((r=>OU(t,r)));return zr.create(n,"or")}}function G3(t){if(nn(t instanceof er||t instanceof zr,11850),t instanceof er)return t;const e=t.getFilters();if(e.length===1)return G3(e[0]);if(lue(t))return t;const n=e.map((i=>G3(i))),r=[];return n.forEach((i=>{i instanceof er?r.push(i):i instanceof zr&&(i.op===t.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:zr.create(r,t.op)}class h5e{constructor(){this.Cn=new LU}addToCollectionParentIndex(e,n){return this.Cn.add(n),we.resolve()}getCollectionParents(e,n){return we.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return we.resolve()}deleteFieldIndex(e,n){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,n){return we.resolve()}getDocumentsMatchingTarget(e,n){return we.resolve(null)}getIndexType(e,n){return we.resolve(0)}getFieldIndexes(e,n){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,n){return we.resolve(cc.min())}getMinOffsetFromCollectionGroup(e,n){return we.resolve(cc.min())}updateCollectionGroup(e,n,r){return we.resolve()}updateIndexEntries(e,n){return we.resolve()}}class LU{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Gr(Er.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Gr(Er.comparator)).toArray()}}const tJ="IndexedDbIndexManager",oP=new Uint8Array(0);class d5e{constructor(e,n){this.databaseId=n,this.vn=new LU,this.Fn=new yp((r=>E1(r)),((r,i)=>FA(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.vn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener((()=>{this.vn.add(n)}));const s={collectionId:r,parent:ua(i)};return nJ(e).put(s)}return we.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[Oce(n),""],!1,!0);return nJ(e).J(i).next((s=>{for(const o of s){if(o.collectionId!==n)break;r.push(id(o.parent))}return r}))}addFieldIndex(e,n){const r=cE(e),i=(function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map((l=>[l.fieldPath.canonicalString(),l.kind]))}})(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=a_(e);return s.next((a=>{o.put(qZ(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))}))}return s.next()}deleteFieldIndex(e,n){const r=cE(e),i=a_(e),s=o_(e);return r.delete(n.indexId).next((()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const n=cE(e),r=o_(e),i=a_(e);return n.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,n){return we.forEach(this.Mn(n),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){const s=new QZ(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,n){const r=o_(e);let i=!0;const s=new Map;return we.forEach(this.Mn(n),(o=>this.xn(e,o).next((a=>{i&&(i=!!a),s.set(o,a)})))).next((()=>{if(i){let o=Bn();const a=[];return we.forEach(s,((l,c)=>{ft(tJ,`Using index ${(function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map((R=>`${R.fieldPath}:${R.kind}`)).join(",")}`})(l)} to execute ${E1(n)}`);const u=(function(I,R){const C=Pj(R);if(C===void 0)return null;for(const V of F3(I,C.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null})(c,l),h=(function(I,R){const C=new Map;for(const V of V0(R))for(const M of F3(I,V.fieldPath))switch(M.op){case"==":case"in":C.set(V.fieldPath.canonicalString(),M.value);break;case"not-in":case"!=":return C.set(V.fieldPath.canonicalString(),M.value),Array.from(C.values())}return null})(c,l),f=(function(I,R){const C=[];let V=!0;for(const M of V0(R)){const N=M.kind===0?NZ(I,M.fieldPath,I.startAt):OZ(I,M.fieldPath,I.startAt);C.push(N.value),V&&(V=N.inclusive)}return new qw(C,V)})(c,l),g=(function(I,R){const C=[];let V=!0;for(const M of V0(R)){const N=M.kind===0?OZ(I,M.fieldPath,I.endAt):NZ(I,M.fieldPath,I.endAt);C.push(N.value),V&&(V=N.inclusive)}return new qw(C,V)})(c,l),v=this.On(l,c,f),x=this.On(l,c,g),b=this.Nn(l,c,h),T=this.Bn(l.indexId,u,v,f.inclusive,x,g.inclusive,b);return we.forEach(T,(A=>r.Y(A,n.limit).next((I=>{I.forEach((R=>{const C=Tt.fromSegments(R.documentKey);o.has(C)||(o=o.add(C),a.push(C))}))}))))})).next((()=>a))}return we.resolve(null)}))}Mn(e){let n=this.Fn.get(e);return n||(e.filters.length===0?n=[e]:n=u5e(zr.create(e.filters,"and")).map((r=>Fj(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,n),n)}Bn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const f=n?this.Ln(n[h/c]):oP,g=this.kn(e,f,r[h%c],i),v=this.qn(e,f,s[h%c],o),x=a.map((b=>this.kn(e,f,b,!0)));u.push(...this.createRange(g,v,x))}return u}kn(e,n,r,i){const s=new my(e,Tt.empty(),n,r);return i?s:s.An()}qn(e,n,r,i){const s=new my(e,Tt.empty(),n,r);return i?s.An():s}xn(e,n){const r=new QZ(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(const a of s)r.yn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o}))}getIndexType(e,n){let r=2;const i=this.Mn(n);return we.forEach(i,(s=>this.xn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(l){let c=new Gr(Ni.comparator),u=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?u=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(u?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(n)&&i.length>1&&r===2?1:r))}Qn(e,n){const r=new lE;for(const i of V0(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Pn(i.kind);py.Kt.Dt(s,o)}return r.un()}Ln(e){const n=new lE;return py.Kt.Dt(e,n.Pn(0)),n.un()}$n(e,n){const r=new lE;return py.Kt.Dt(mk(this.databaseId,n),r.Pn((function(s){const o=V0(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,n,r){if(r===null)return[];let i=[];i.push(new lE);let s=0;for(const o of V0(e)){const a=r[s++];for(const l of i)if(this.Un(n,o.fieldPath)&&gk(a))i=this.Kn(i,o,a);else{const c=l.Pn(o.kind);py.Kt.Dt(a,c)}}return this.Wn(i)}On(e,n,r){return this.Nn(e,n,r.position)}Wn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Kn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new lE;l.seed(a.un()),py.Kt.Dt(o,l.Pn(n.kind)),s.push(l)}return s}Un(e,n){return!!e.filters.find((r=>r instanceof er&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,n){const r=cE(e),i=a_(e);return(n?r.J(Cj,IDBKeyRange.bound(n,n)):r.J()).next((s=>{const o=[];return we.forEach(s,(a=>i.get([a.indexId,this.uid]).next((l=>{o.push((function(u,h){const f=h?new lk(h.sequenceNumber,new cc(T1(h.readTime),new Tt(id(h.documentKey)),h.largestBatchId)):lk.empty(),g=u.fields.map((([v,x])=>new AM(Ni.fromServerFormat(v),x)));return new C3(u.indexId,u.collectionGroup,g,f)})(a,l))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((n=>n.length===0?null:(n.sort(((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:In(r.collectionGroup,i.collectionGroup)})),n[0].collectionGroup)))}updateCollectionGroup(e,n,r){const i=cE(e),s=a_(e);return this.Gn(e).next((o=>i.J(Cj,IDBKeyRange.bound(n,n)).next((a=>we.forEach(a,(l=>s.put(qZ(l.indexId,this.uid,o,r))))))))}updateIndexEntries(e,n){const r=new Map;return we.forEach(n,((i,s)=>{const o=r.get(i.collectionGroup);return(o?we.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((a=>(r.set(i.collectionGroup,a),we.forEach(a,(l=>this.zn(e,i,l).next((c=>{const u=this.jn(s,l);return c.isEqual(u)?we.resolve():this.Jn(e,s,l,c,u)})))))))}))}Hn(e,n,r,i){return o_(e).put(i.Rn(this.uid,this.$n(r,n.key),n.key))}Yn(e,n,r,i){return o_(e).delete(i.Vn(this.uid,this.$n(r,n.key),n.key))}zn(e,n,r){const i=o_(e);let s=new Gr(Jp);return i.ee({index:Wce,range:IDBKeyRange.only([r.indexId,this.uid,LM(this.$n(r,n))])},((o,a)=>{s=s.add(new my(r.indexId,n,JZ(a.arrayValue),JZ(a.directionalValue)))})).next((()=>s))}jn(e,n){let r=new Gr(Jp);const i=this.Qn(n,e);if(i==null)return r;const s=Pj(n);if(s!=null){const o=e.data.field(s.fieldPath);if(gk(o))for(const a of o.arrayValue.values||[])r=r.add(new my(n.indexId,e.key,this.Ln(a),i))}else r=r.add(new my(n.indexId,e.key,oP,i));return r}Jn(e,n,r,i,s){ft(tJ,"Updating index entries for document '%s'",n.key);const o=[];return(function(l,c,u,h,f){const g=l.getIterator(),v=c.getIterator();let x=i_(g),b=i_(v);for(;x||b;){let T=!1,A=!1;if(x&&b){const I=u(x,b);I<0?A=!0:I>0&&(T=!0)}else x!=null?A=!0:T=!0;T?(h(b),b=i_(v)):A?(f(x),x=i_(g)):(x=i_(g),b=i_(v))}})(i,s,Jp,(a=>{o.push(this.Hn(e,n,r,a))}),(a=>{o.push(this.Yn(e,n,r,a))})),we.waitFor(o)}Gn(e){let n=1;return a_(e).ee({index:Bce,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),n=i.sequenceNumber+1})).next((()=>n))}createRange(e,n,r){r=r.sort(((o,a)=>Jp(o,a))).filter(((o,a,l)=>!a||Jp(o,l[a-1])!==0));const i=[];i.push(e);for(const o of r){const a=Jp(o,e),l=Jp(o,n);if(a===0)i[0]=e.An();else if(a>0&&l<0)i.push(o),i.push(o.An());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];const a=i[o].Vn(this.uid,oP,Tt.empty()),l=i[o+1].Vn(this.uid,oP,Tt.empty());s.push(IDBKeyRange.bound(a,l))}return s}Zn(e,n){return Jp(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(rJ)}getMinOffset(e,n){return we.mapArray(this.Mn(n),(r=>this.xn(e,r).next((i=>i||Ht(44426))))).next(rJ)}}function nJ(t){return Bs(t,dk)}function o_(t){return Bs(t,GS)}function cE(t){return Bs(t,wU)}function a_(t){return Bs(t,US)}function rJ(t){nn(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;vU(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new cc(e.readTime,e.documentKey,n)}const iJ={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Kue=41943040;class Jo{static withCacheSize(e){return new Jo(e,Jo.DEFAULT_COLLECTION_PERCENTILE,Jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}function Yue(t,e,n){const r=t.store(Uu),i=t.store(zw),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.ee({range:o},((u,h,f)=>(a++,f.delete())));s.push(l.next((()=>{nn(a===1,47070,{batchId:n.batchId})})));const c=[];for(const u of n.mutations){const h=zce(e,u.key.path,n.batchId);s.push(i.delete(h)),c.push(u.key)}return we.waitFor(s).next((()=>c))}function B3(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ht(14731);e=t.noDocument}return JSON.stringify(e).length}Jo.DEFAULT_COLLECTION_PERCENTILE=10,Jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jo.DEFAULT=new Jo(Kue,Jo.DEFAULT_COLLECTION_PERCENTILE,Jo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jo.DISABLED=new Jo(-1,0,0);class C5{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,n,r,i){nn(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new C5(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qp(e).ee({index:ky,range:r},((i,s,o)=>{n=!1,o.done()})).next((()=>n))}addMutationBatch(e,n,r,i){const s=L_(e),o=Qp(e);return o.add({}).next((a=>{nn(typeof a=="number",49019);const l=new RU(a,n,r,i),c=(function(g,v,x){const b=x.baseMutations.map((A=>z3(g.yt,A))),T=x.mutations.map((A=>z3(g.yt,A)));return{userId:v,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:b,mutations:T}})(this.serializer,this.userId,l),u=[];let h=new Gr(((f,g)=>In(f.canonicalString(),g.canonicalString())));for(const f of i){const g=zce(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),u.push(o.put(c)),u.push(s.put(g,z4e))}return h.forEach((f=>{u.push(this.indexManager.addToCollectionParentIndex(e,f))})),e.addOnCommittedListener((()=>{this.Xn[a]=l.keys()})),we.waitFor(u).next((()=>l))}))}lookupMutationBatch(e,n){return Qp(e).get(n).next((r=>r?(nn(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),fy(this.serializer,r)):null))}er(e,n){return this.Xn[n]?we.resolve(this.Xn[n]):this.lookupMutationBatch(e,n).next((r=>{if(r){const i=r.keys();return this.Xn[n]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Qp(e).ee({index:ky,range:i},((o,a,l)=>{a.userId===this.userId&&(nn(a.batchId>=r,47524,{tr:r}),s=fy(this.serializer,a)),l.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Gy;return Qp(e).ee({index:ky,range:n,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Gy],[this.userId,Number.POSITIVE_INFINITY]);return Qp(e).J(ky,n).next((r=>r.map((i=>fy(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=IM(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return L_(e).ee({range:i},((o,a,l)=>{const[c,u,h]=o,f=id(u);if(c===this.userId&&n.path.isEqual(f))return Qp(e).get(h).next((g=>{if(!g)throw Ht(61480,{nr:o,batchId:h});nn(g.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:g.userId,batchId:h}),s.push(fy(this.serializer,g))}));l.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Gr(In);const i=[];return n.forEach((s=>{const o=IM(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=L_(e).ee({range:a},((c,u,h)=>{const[f,g,v]=c,x=id(g);f===this.userId&&s.path.isEqual(x)?r=r.add(v):h.done()}));i.push(l)})),we.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=IM(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Gr(In);return L_(e).ee({range:o},((l,c,u)=>{const[h,f,g]=l,v=id(f);h===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(g)):u.done()})).next((()=>this.rr(e,a)))}rr(e,n){const r=[],i=[];return n.forEach((s=>{i.push(Qp(e).get(s).next((o=>{if(o===null)throw Ht(35274,{batchId:s});nn(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(fy(this.serializer,o))})))})),we.waitFor(i).next((()=>r))}removeMutationBatch(e,n){return Yue(e.le,this.userId,n).next((r=>(e.addOnCommittedListener((()=>{this.ir(n.batchId)})),we.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((n=>{if(!n)return we.resolve();const r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return L_(e).ee({range:r},((s,o,a)=>{if(s[0]===this.userId){const l=id(s[1]);i.push(l)}else a.done()})).next((()=>{nn(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,n){return Xue(e,this.userId,n)}_r(e){return Zue(e).get(this.userId).next((n=>n||{userId:this.userId,lastAcknowledgedBatchId:Gy,lastStreamToken:""}))}}function Xue(t,e,n){const r=IM(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return L_(t).ee({range:s,X:!0},((a,l,c)=>{const[u,h,f]=a;u===e&&h===i&&(o=!0),c.done()})).next((()=>o))}function Qp(t){return Bs(t,Uu)}function L_(t){return Bs(t,zw)}function Zue(t){return Bs(t,uk)}class k1{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new k1(0)}static cr(){return new k1(-1)}}class f5e{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.lr(e).next((n=>{const r=new k1(n.highestTargetId);return n.highestTargetId=r.next(),this.hr(e,n).next((()=>n.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((n=>on.fromTimestamp(new Vr(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((n=>n.highestListenSequenceNumber))}setTargetsMetadata(e,n,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.hr(e,i))))}addTargetData(e,n){return this.Pr(e,n).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(n,r),this.hr(e,r))))))}updateTargetData(e,n){return this.Pr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next((()=>l_(e).delete(n.targetId))).next((()=>this.lr(e))).next((r=>(nn(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,n,r){let i=0;const s=[];return l_(e).ee(((o,a)=>{const l=HE(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))})).next((()=>we.waitFor(s))).next((()=>i))}forEachTarget(e,n){return l_(e).ee(((r,i)=>{const s=HE(i);n(s)}))}lr(e){return sJ(e).get(L3).next((n=>(nn(n!==null,2888),n)))}hr(e,n){return sJ(e).put(L3,n)}Pr(e,n){return l_(e).put(Bue(this.serializer,n))}Tr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((n=>n.targetCount))}getTargetData(e,n){const r=E1(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return l_(e).ee({range:i,index:Gce},((o,a,l)=>{const c=HE(a);FA(n,c.target)&&(s=c,l.done())})).next((()=>s))}addMatchingKeys(e,n,r){const i=[],s=$m(e);return n.forEach((o=>{const a=ua(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))})),we.waitFor(i)}removeMatchingKeys(e,n,r){const i=$m(e);return we.forEach(n,(s=>{const o=ua(s.path);return we.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,n){const r=$m(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=$m(e);let s=Bn();return i.ee({range:r,X:!0},((o,a,l)=>{const c=id(o[1]),u=new Tt(c);s=s.add(u)})).next((()=>s))}containsKey(e,n){const r=ua(n.path),i=IDBKeyRange.bound([r],[Oce(r)],!1,!0);let s=0;return $m(e).ee({index:xU,X:!0,range:i},(([o,a],l,c)=>{o!==0&&(s++,c.done())})).next((()=>s>0))}At(e,n){return l_(e).get(n).next((r=>r?HE(r):null))}}function l_(t){return Bs(t,Uw)}function sJ(t){return Bs(t,By)}function $m(t){return Bs(t,Gw)}const oJ="LruGarbageCollector",p5e=1048576;function aJ([t,e],[n,r]){const i=In(t,n);return i===0?In(e,r):i}class m5e{constructor(e){this.Ir=e,this.buffer=new Gr(aJ),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();aJ(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Jue{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ft(oJ,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){qg(n)?ft(oJ,"Ignoring IndexedDB error during garbage collection: ",n):await ev(n)}await this.Vr(3e5)}))}}class g5e{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return we.resolve(Yc.ce);const r=new m5e(n);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ft("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(iJ)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ft("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iJ):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,i,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((h=>(h>this.params.maximumSequenceNumbersToCollect?(ft("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i)))).next((h=>(r=h,a=Date.now(),this.removeTargets(e,r,n)))).next((h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((h=>(c=Date.now(),M_()<=Jn.DEBUG&&ft("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h}))))}}function Que(t,e){return new g5e(t,e)}class y5e{constructor(e,n){this.db=e,this.garbageCollector=Que(this,n)}gr(e){const n=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}pr(e,n){return this.Sr(e,((r,i)=>n(i)))}addReference(e,n,r){return aP(e,r)}removeReference(e,n,r){return aP(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return aP(e,n)}br(e,n){return(function(i,s){let o=!1;return Zue(i).te((a=>Xue(i,a,s).next((l=>(l&&(o=!0),we.resolve(!l)))))).next((()=>o))})(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,((o,a)=>{if(a<=n){const l=this.br(e,o).next((c=>{if(!c)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,on.min()),$m(e).delete((function(h){return[0,ua(h.path)]})(o)))))}));i.push(l)}})).next((()=>we.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return aP(e,n)}Sr(e,n){const r=$m(e);let i,s=Yc.ce;return r.ee({index:xU},(([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==Yc.ce&&n(new Tt(id(i)),s),s=c,i=l):s=Yc.ce})).next((()=>{s!==Yc.ce&&n(new Tt(id(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function aP(t,e){return $m(t).put((function(r,i){return{targetId:0,path:ua(r.path),sequenceNumber:i}})(e,t.currentSequenceNumber))}class ehe{constructor(){this.changes=new yp((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Xi.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?we.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class v5e{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return T0(e).put(r)}removeEntry(e,n,r){return T0(e).delete((function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],U3(o),a[a.length-1]]})(n,r))}updateMetadata(e,n){return this.getMetadata(e).next((r=>(r.byteSize+=n,this.Dr(e,r))))}getEntry(e,n){let r=Xi.newInvalidDocument(n);return T0(e).ee({index:RM,range:IDBKeyRange.only(uE(n))},((i,s)=>{r=this.Cr(n,s)})).next((()=>r))}vr(e,n){let r={size:0,document:Xi.newInvalidDocument(n)};return T0(e).ee({index:RM,range:IDBKeyRange.only(uE(n))},((i,s)=>{r={document:this.Cr(n,s),size:B3(s)}})).next((()=>r))}getEntries(e,n){let r=nc();return this.Fr(e,n,((i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)})).next((()=>r))}Mr(e,n){let r=nc(),i=new bi(Tt.comparator);return this.Fr(e,n,((s,o)=>{const a=this.Cr(s,o);r=r.insert(s,a),i=i.insert(s,B3(o))})).next((()=>({documents:r,Or:i})))}Fr(e,n,r){if(n.isEmpty())return we.resolve();let i=new Gr(uJ);n.forEach((l=>i=i.add(l)));const s=IDBKeyRange.bound(uE(i.first()),uE(i.last())),o=i.getIterator();let a=o.getNext();return T0(e).ee({index:RM,range:s},((l,c,u)=>{const h=Tt.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&uJ(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(uE(a)):u.done()})).next((()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),U3(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return T0(e).J(IDBKeyRange.bound(a,l,!0)).next((c=>{s?.incrementDocumentReadCount(c.length);let u=nc();for(const h of c){const f=this.Cr(Tt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(zA(n,f)||i.has(f.key))&&(u=u.insert(f.key,f))}return u}))}getAllFromCollectionGroup(e,n,r,i){let s=nc();const o=cJ(n,r),a=cJ(n,cc.max());return T0(e).ee({index:Uce,range:IDBKeyRange.bound(o,a,!0)},((l,c,u)=>{const h=this.Cr(Tt.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&u.done()})).next((()=>s))}newChangeBuffer(e){return new _5e(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((n=>n.byteSize))}getMetadata(e){return lJ(e).get(Mj).next((n=>(nn(!!n,20021),n)))}Dr(e,n){return lJ(e).put(Mj,n)}Cr(e,n){if(n){const r=r5e(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(on.min())))return r}return Xi.newInvalidDocument(e)}}function the(t){return new v5e(t)}class _5e extends ehe{constructor(e,n){super(),this.Nr=e,this.trackRemovals=n,this.Br=new yp((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){const n=[];let r=0,i=new Gr(((s,o)=>In(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{const a=this.Br.get(s);if(n.push(this.Nr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=WZ(this.Nr.serializer,o);i=i.add(s.path.popLast());const c=B3(l);r+=c-a.size,n.push(this.Nr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=WZ(this.Nr.serializer,o.convertToNoDocument(on.min()));n.push(this.Nr.addEntry(e,s,l))}})),i.forEach((s=>{n.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),n.push(this.Nr.updateMetadata(e,r)),we.waitFor(n)}getFromCache(e,n){return this.Nr.vr(e,n).next((r=>(this.Br.set(n,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,n){return this.Nr.Mr(e,n).next((({documents:r,Or:i})=>(i.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}}function lJ(t){return Bs(t,hk)}function T0(t){return Bs(t,O3)}function uE(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cJ(t,e){const n=e.documentKey.path.toArray();return[t,U3(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function uJ(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=In(n[s],r[s]),i)return i;return i=In(n.length,r.length),i||(i=In(n[n.length-2],r[r.length-2]),i||In(n[n.length-1],r[r.length-1]))}class x5e{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class nhe{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,n)))).next((i=>(r!==null&&qS(r.mutation,i,fl.empty(),Vr.now()),i)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,Bn()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=Bn()){const i=sd();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,r).next((s=>{let o=BE();return s.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=sd();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,Bn())))}populateOverlays(e,n,r){const i=[];return r.forEach((s=>{n.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,a)=>{n.set(o,a)}))}))}computeViews(e,n,r,i){let s=nc();const o=HS(),a=(function(){return HS()})();return n.forEach(((l,c)=>{const u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof vp)?s=s.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),qS(u.mutation,c,u.mutation.getFieldMask(),Vr.now())):o.set(c.key,fl.empty())})),this.recalculateAndSaveOverlays(e,s).next((l=>(l.forEach(((c,u)=>o.set(c,u))),n.forEach(((c,u)=>a.set(c,new x5e(u,o.get(c)??null)))),a)))}recalculateAndSaveOverlays(e,n){const r=HS();let i=new bi(((o,a)=>o-a)),s=Bn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const a of o)a.keys().forEach((l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||fl.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(i.get(a.batchId)||Bn()).add(l);i=i.insert(a.batchId,h)}))})).next((()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=_ue();u.forEach((f=>{if(!s.has(f)){const g=kue(n.get(f),r.get(f));g!==null&&h.set(f,g),s=s.add(f)}})),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return we.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,i){return(function(o){return Tt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):pue(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):we.resolve(sd());let a=ak,l=s;return o.next((c=>we.forEach(c,((u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?we.resolve():this.remoteDocumentCache.getEntry(e,u).next((f=>{l=l.insert(u,f)}))))).next((()=>this.populateOverlays(e,c,s))).next((()=>this.computeViews(e,l,c,Bn()))).next((u=>({batchId:a,changes:vue(u)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Tt(n)).next((r=>{let i=BE();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=BE();return this.indexManager.getCollectionParents(e,s).next((a=>we.forEach(a,(l=>{const c=(function(h,f){return new VA(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)})(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next((u=>{u.forEach(((h,f)=>{o=o.insert(h,f)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i)))).next((o=>{s.forEach(((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Xi.newInvalidDocument(u)))}));let a=BE();return o.forEach(((l,c)=>{const u=s.get(l);u!==void 0&&qS(u.mutation,c,fl.empty(),Vr.now()),zA(n,c)&&(a=a.insert(l,c))})),a}))}}class w5e{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return we.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(i){return{id:i.id,version:i.version,createTime:Oa(i.createTime)}})(n)),we.resolve()}getNamedQuery(e,n){return we.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(i){return{name:i.name,query:Wue(i.bundledQuery),readTime:Oa(i.readTime)}})(n)),we.resolve()}}class b5e{constructor(){this.overlays=new bi(Tt.comparator),this.qr=new Map}getOverlay(e,n){return we.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sd();return we.forEach(n,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((i,s)=>{this.St(e,n,s)})),we.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),we.resolve()}getOverlaysForCollection(e,n,r){const i=sd(),s=n.length+1,o=new Tt(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return we.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new bi(((c,u)=>c-u));const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=sd(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=sd(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((c,u)=>a.set(c,u))),!(a.size()>=i)););return we.resolve(a)}St(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new MU(n,r));let s=this.qr.get(n);s===void 0&&(s=Bn(),this.qr.set(n,s)),this.qr.set(n,s.add(r.key))}}class E5e{constructor(){this.sessionToken=As.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,we.resolve()}}class DU{constructor(){this.Qr=new Gr(eo.$r),this.Ur=new Gr(eo.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new eo(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Gr(new eo(e,n))}zr(e,n){e.forEach((r=>this.removeReference(r,n)))}jr(e){const n=new Tt(new Er([])),r=new eo(n,e),i=new eo(n,e+1),s=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Tt(new Er([])),r=new eo(n,e),i=new eo(n,e+1);let s=Bn();return this.Ur.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){const n=new eo(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class eo{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Tt.comparator(e.key,n.key)||In(e.Yr,n.Yr)}static Kr(e,n){return In(e.Yr,n.Yr)||Tt.comparator(e.key,n.key)}}class S5e{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Gr(eo.$r)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new RU(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.Zr=this.Zr.add(new eo(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return we.resolve(o)}lookupMutationBatch(e,n){return we.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ei(r),s=i<0?0:i;return we.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?Gy:this.tr-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new eo(n,0),i=new eo(n,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(o=>{const a=this.Xr(o.Yr);s.push(a)})),we.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Gr(In);return n.forEach((i=>{const s=new eo(i,0),o=new eo(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(a=>{r=r.add(a.Yr)}))})),we.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;Tt.isDocumentKey(s)||(s=s.child(""));const o=new eo(new Tt(s),0);let a=new Gr(In);return this.Zr.forEachWhile((l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Yr)),!0)}),o),we.resolve(this.ti(a))}ti(e){const n=[];return e.forEach((r=>{const i=this.Xr(r);i!==null&&n.push(i)})),n}removeMutationBatch(e,n){nn(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return we.forEach(n.mutations,(i=>{const s=new eo(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,n){const r=new eo(n,0),i=this.Zr.firstAfterOrEqual(r);return we.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class T5e{constructor(e){this.ri=e,this.docs=(function(){return new bi(Tt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return we.resolve(r?r.document.mutableCopy():Xi.newInvalidDocument(n))}getEntries(e,n){let r=nc();return n.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Xi.newInvalidDocument(i))})),we.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=nc();const o=n.path,a=new Tt(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||vU($ce(u),r)<=0||(i.has(u.key)||zA(n,u))&&(s=s.insert(u.key,u.mutableCopy()))}return we.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ht(9500)}ii(e,n){return we.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new k5e(this)}getSize(e){return we.resolve(this.size)}}class k5e extends ehe{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?n.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),we.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class A5e{constructor(e){this.persistence=e,this.si=new yp((n=>E1(n)),FA),this.lastRemoteSnapshotVersion=on.min(),this.highestTargetId=0,this.oi=0,this._i=new DU,this.targetCount=0,this.ai=k1.ur()}forEachTarget(e,n){return this.si.forEach(((r,i)=>n(i))),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),we.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new k1(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,we.resolve()}updateTargetData(e,n){return this.Pr(n),we.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)})),we.waitFor(s).next((()=>i))}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return we.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),we.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),we.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),we.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return we.resolve(r)}containsKey(e,n){return we.resolve(this._i.containsKey(n))}}class $U{constructor(e,n){this.ui={},this.overlays={},this.ci=new Yc(0),this.li=!1,this.li=!0,this.hi=new E5e,this.referenceDelegate=e(this),this.Pi=new A5e(this),this.indexManager=new h5e,this.remoteDocumentCache=(function(i){return new T5e(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new Gue(n),this.Ii=new w5e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new b5e,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new S5e(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ft("MemoryPersistence","Starting transaction:",e);const i=new I5e(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,n){return we.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,n))))}}class I5e extends Fce{constructor(e){super(),this.currentSequenceNumber=e}}class N5{constructor(e){this.persistence=e,this.Ri=new DU,this.Vi=null}static mi(e){return new N5(e)}get fi(){if(this.Vi)return this.Vi;throw Ht(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),we.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),we.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),we.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((i=>this.fi.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.fi,(r=>{const i=Tt.fromPath(r);return this.gi(e,i).next((s=>{s||n.removeEntry(i,on.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return we.or([()=>we.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class W3{constructor(e,n){this.persistence=e,this.pi=new yp((r=>ua(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=Que(this,n)}static mi(e,n){return new W3(e,n)}Ei(){}di(e){return we.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((i=>r+i))))}wr(e){let n=0;return this.pr(e,(r=>{n++})).next((()=>n))}pr(e,n){return we.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?we.resolve():n(i)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,n).next((a=>{a||(r++,s.removeEntry(o,on.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),we.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),we.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),we.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=MM(e.data.value)),n}br(e,n,r){return we.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.pi.get(n);return we.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class R5e{constructor(e){this.serializer=e}k(e,n,r,i){const s=new v5("createOrUpgrade",n);r<1&&i>=1&&((function(l){l.createObjectStore(jA)})(e),(function(l){l.createObjectStore(uk,{keyPath:V4e}),l.createObjectStore(Uu,{keyPath:wZ,autoIncrement:!0}).createIndex(ky,bZ,{unique:!0}),l.createObjectStore(zw)})(e),hJ(e),(function(l){l.createObjectStore(z0)})(e));let o=we.resolve();return r<3&&i>=3&&(r!==0&&((function(l){l.deleteObjectStore(Gw),l.deleteObjectStore(Uw),l.deleteObjectStore(By)})(e),hJ(e)),o=o.next((()=>(function(l){const c=l.store(By),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:on.min().toTimestamp(),targetCount:0};return c.put(L3,u)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(l,c){return c.store(Uu).J().next((h=>{l.deleteObjectStore(Uu),l.createObjectStore(Uu,{keyPath:wZ,autoIncrement:!0}).createIndex(ky,bZ,{unique:!0});const f=c.store(Uu),g=h.map((v=>f.put(v)));return we.waitFor(g)}))})(e,s)))),o=o.next((()=>{(function(l){l.createObjectStore(Bw,{keyPath:Y4e})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(l){l.createObjectStore(hk)})(e),this.wi(s))))),r<7&&i>=7&&(o=o.next((()=>this.Si(s)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(l){l.createObjectStore(x5,{keyPath:X4e})})(e),(function(l){l.createObjectStore(w5,{keyPath:Z4e})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(l){const c=l.createObjectStore(b5,{keyPath:iNe});c.createIndex(Nj,sNe,{unique:!1}),c.createIndex(Hce,oNe,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(l){const c=l.createObjectStore(O3,{keyPath:U4e});c.createIndex(RM,G4e),c.createIndex(Uce,B4e)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(z0)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(l){l.createObjectStore(wU,{keyPath:J4e,autoIncrement:!0}).createIndex(Cj,Q4e,{unique:!1}),l.createObjectStore(US,{keyPath:eNe}).createIndex(Bce,tNe,{unique:!1}),l.createObjectStore(GS,{keyPath:nNe}).createIndex(Wce,rNe,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{n.objectStore(US).clear()})).next((()=>{n.objectStore(GS).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(l){l.createObjectStore(bU,{keyPath:aNe})})(e)}))),r<18&&i>=18&&Vle()&&(o=o.next((()=>{n.objectStore(US).clear()})).next((()=>{n.objectStore(GS).clear()}))),o}wi(e){let n=0;return e.store(z0).ee(((r,i)=>{n+=B3(i)})).next((()=>{const r={byteSize:n};return e.store(hk).put(Mj,r)}))}yi(e){const n=e.store(uk),r=e.store(Uu);return n.J().next((i=>we.forEach(i,(s=>{const o=IDBKeyRange.bound([s.userId,Gy],[s.userId,s.lastAcknowledgedBatchId]);return r.J(ky,o).next((a=>we.forEach(a,(l=>{nn(l.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:l.batchId});const c=fy(this.serializer,l);return Yue(e,s.userId,c).next((()=>{}))}))))}))))}Si(e){const n=e.store(Gw),r=e.store(z0);return e.store(By).get(L3).next((i=>{const s=[];return r.ee(((o,a)=>{const l=new Er(o),c=(function(h){return[0,ua(h)]})(l);s.push(n.get(c).next((u=>u?we.resolve():(h=>n.put({targetId:0,path:ua(h),sequenceNumber:i.highestListenSequenceNumber}))(l))))})).next((()=>we.waitFor(s)))}))}bi(e,n){e.createObjectStore(dk,{keyPath:K4e});const r=n.store(dk),i=new LU,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:ua(l)})}};return n.store(z0).ee({X:!0},((o,a)=>{const l=new Er(o);return s(l.popLast())})).next((()=>n.store(zw).ee({X:!0},(([o,a,l],c)=>{const u=id(a);return s(u.popLast())}))))}Di(e){const n=e.store(Uw);return n.ee(((r,i)=>{const s=HE(i),o=Bue(this.serializer,s);return n.put(o)}))}Ci(e,n){const r=n.store(z0),i=[];return r.ee(((s,o)=>{const a=n.store(O3),l=(function(h){return h.document?new Tt(Er.fromString(h.document.name).popFirst(5)):h.noDocument?Tt.fromSegments(h.noDocument.path):h.unknownDocument?Tt.fromSegments(h.unknownDocument.path):Ht(36783)})(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))})).next((()=>we.waitFor(i)))}Fi(e,n){const r=n.store(Uu),i=the(this.serializer),s=new $U(N5.mi,this.serializer.yt);return r.J().next((o=>{const a=new Map;return o.forEach((l=>{let c=a.get(l.userId)??Bn();fy(this.serializer,l).keys().forEach((u=>c=c.add(u))),a.set(l.userId,c)})),we.forEach(a,((l,c)=>{const u=new ko(c),h=M5.wt(this.serializer,u),f=s.getIndexManager(u),g=C5.wt(u,this.serializer,f,s.referenceDelegate);return new nhe(i,g,h,f).recalculateAndSaveOverlaysForDocumentKeys(new Oj(n,Yc.ce),l).next()}))}))}}function hJ(t){t.createObjectStore(Gw,{keyPath:H4e}).createIndex(xU,q4e,{unique:!0}),t.createObjectStore(Uw,{keyPath:"targetId"}).createIndex(Gce,W4e,{unique:!0}),t.createObjectStore(By)}const em="IndexedDbPersistence",N6=18e5,O6=5e3,L6="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",P5e="main";class jU{constructor(e,n,r,i,s,o,a,l,c,u,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Mi=s,this.window=o,this.document=a,this.xi=c,this.Oi=u,this.Ni=h,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=f=>Promise.resolve(),!jU.v())throw new Et(We.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new y5e(this,i),this.$i=n+P5e,this.serializer=new Gue(l),this.Ui=new dg(this.$i,this.Ni,new R5e(this.serializer)),this.hi=new s5e,this.Pi=new f5e(this.referenceDelegate,this.serializer),this.remoteDocumentCache=the(this.serializer),this.Ii=new i5e,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,u===!1&&Ra(em,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Et(We.FAILED_PRECONDITION,L6);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Yc(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async n=>{n.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>lP(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((n=>{n||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((n=>this.isPrimary&&!n?this.Zi(e).next((()=>!1)):!!n&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(qg(e))return ft(em,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ft(em,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return hE(e).get(r_).next((n=>we.resolve(this.es(n))))}ts(e){return lP(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,N6)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(n=>{const r=Bs(n,Bw);return r.J().next((i=>{const s=this.ss(i,N6),o=i.filter((a=>s.indexOf(a)===-1));return we.forEach(o,(a=>r.delete(a.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(const n of e)this.Ki.removeItem(this._s(n.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?we.resolve(!0):hE(e).get(r_).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,O6)&&!this.us(n.ownerId)){if(this.es(n)&&this.networkEnabled)return!0;if(!this.es(n)){if(!n.allowTabSynchronization)throw new Et(We.FAILED_PRECONDITION,L6);return!1}}return!(!this.networkEnabled||!this.inForeground)||lP(e).J().next((r=>this.ss(r,O6).find((i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1}))===void 0))})).next((n=>(this.isPrimary!==n&&ft(em,`Client ${n?"is":"is not"} eligible for a primary lease.`),n)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[jA,Bw],(e=>{const n=new Oj(e,Yc.ce);return this.Zi(n).next((()=>this.ts(n)))})),this.Ui.close(),this.Ps()}ss(e,n){return e.filter((r=>this.rs(r.updateTimeMs,n)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>lP(e).J().next((n=>this.ss(n,N6).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,n){return C5.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new d5e(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return M5.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,n,r){ft(em,"Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=(function(l){return l===18?uNe:l===17?Xce:l===16?cNe:l===15?EU:l===14?Yce:l===13?Kce:l===12?lNe:l===11?qce:void Ht(60245)})(this.Ni);let o;return this.Ui.runTransaction(e,i,s,(a=>(o=new Oj(a,this.ci?this.ci.next():Yc.ce),n==="readwrite-primary"?this.Hi(o).next((l=>!!l||this.Yi(o))).next((l=>{if(!l)throw Ra(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Et(We.FAILED_PRECONDITION,jce);return r(o)})).next((l=>this.Xi(o).next((()=>l)))):this.Is(o).next((()=>r(o)))))).then((a=>(o.raiseOnCommittedEvent(),a)))}Is(e){return hE(e).get(r_).next((n=>{if(n!==null&&this.rs(n.leaseTimestampMs,O6)&&!this.us(n.ownerId)&&!this.es(n)&&!(this.Oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Et(We.FAILED_PRECONDITION,L6)}))}Xi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return hE(e).put(r_,n)}static v(){return dg.v()}Zi(e){const n=hE(e);return n.get(r_).next((r=>this.es(r)?(ft(em,"Releasing primary lease."),n.delete(r_)):we.resolve()))}rs(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ra(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;Fle()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{const n=this.Ki?.getItem(this._s(e))!==null;return ft(em,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ra(em,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Ra("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function hE(t){return Bs(t,jA)}function lP(t){return Bs(t,Bw)}function M5e(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class FU{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=i}static As(e,n){let r=Bn(),i=Bn();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new FU(e,n.fromCache,r,i)}}class C5e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rhe{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Fle()?8:Vce(Us())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.ys(e,n).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,n,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new C5e;return this.Ss(e,n,o).next((a=>{if(s.result=a,this.Vs)return this.bs(e,n,o,a.size)}))})).next((()=>s.result))}bs(e,n,r,i){return r.documentReadCount<this.fs?(M_()<=Jn.DEBUG&&ft("QueryEngine","SDK will not create cache indexes for query:",C_(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),we.resolve()):(M_()<=Jn.DEBUG&&ft("QueryEngine","Query:",C_(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(M_()<=Jn.DEBUG&&ft("QueryEngine","The SDK decides to create cache indexes for query:",C_(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qc(n))):we.resolve())}ys(e,n){if(LZ(n))return we.resolve(null);let r=Qc(n);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(n.limit!==null&&i===1&&(n=zj(n,null,"F"),r=Qc(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{const o=Bn(...s);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,r).next((l=>{const c=this.Ds(n,a);return this.Cs(n,c,o,l.readTime)?this.ys(e,zj(n,null,"F")):this.vs(e,c,n,l)}))))})))))}ws(e,n,r,i){return LZ(n)||i.isEqual(on.min())?we.resolve(null):this.ps.getDocuments(e,r).next((s=>{const o=this.Ds(n,s);return this.Cs(n,o,r,i)?we.resolve(null):(M_()<=Jn.DEBUG&&ft("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),C_(n)),this.vs(e,o,n,N4e(i,ak)).next((a=>a)))}))}Ds(e,n){let r=new Gr(gue(e));return n.forEach(((i,s)=>{zA(e,s)&&(r=r.add(s))})),r}Cs(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,n,r){return M_()<=Jn.DEBUG&&ft("QueryEngine","Using full collection scan to execute query:",C_(n)),this.ps.getDocumentsMatchingQuery(e,n,cc.min(),r)}vs(e,n,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(n.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const VU="LocalStore",N5e=3e8;class O5e{constructor(e,n,r,i){this.persistence=e,this.Fs=n,this.serializer=i,this.Ms=new bi(In),this.xs=new yp((s=>E1(s)),FA),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nhe(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function ihe(t,e,n,r){return new O5e(t,e,n,r)}async function she(t,e){const n=Rn(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,n.Bs(e),n.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],a=[];let l=Bn();for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next((c=>({Ls:c,removedBatchIds:o,addedBatchIds:a})))}))}))}function L5e(t,e){const n=Rn(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,c,u){const h=c.batch,f=h.keys();let g=we.resolve();return f.forEach((v=>{g=g.next((()=>u.getEntry(l,v))).next((x=>{const b=c.docVersions.get(v);nn(b!==null,48541),x.version.compareTo(b)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),u.addEntry(x)))}))})),g.next((()=>a.mutationQueue.removeMutationBatch(l,h)))})(n,r,e,s).next((()=>s.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let l=Bn();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l})(e)))).next((()=>n.localDocuments.getDocuments(r,i)))}))}function ohe(t){const e=Rn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function D5e(t,e){const n=Rn(t),r=e.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];e.targetChanges.forEach(((u,h)=>{const f=i.get(h);if(!f)return;a.push(n.Pi.removeMatchingKeys(s,u.removedDocuments,h).next((()=>n.Pi.addMatchingKeys(s,u.addedDocuments,h))));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(As.EMPTY_BYTE_STRING,on.min()).withLastLimboFreeSnapshotVersion(on.min()):u.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(u.resumeToken,r)),i=i.insert(h,g),(function(x,b,T){return x.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=N5e?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(f,g,u)&&a.push(n.Pi.updateTargetData(s,g))}));let l=nc(),c=Bn();if(e.documentUpdates.forEach((u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))})),a.push($5e(s,o,e.documentUpdates).next((u=>{l=u.ks,c=u.qs}))),!r.isEqual(on.min())){const u=n.Pi.getLastRemoteSnapshotVersion(s).next((h=>n.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));a.push(u)}return we.waitFor(a).next((()=>o.apply(s))).next((()=>n.localDocuments.getLocalViewOfDocuments(s,l,c))).next((()=>l))})).then((s=>(n.Ms=i,s)))}function $5e(t,e,n){let r=Bn(),i=Bn();return n.forEach((s=>r=r.add(s))),e.getEntries(t,r).next((s=>{let o=nc();return n.forEach(((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(on.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ft(VU,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)})),{ks:o,qs:i}}))}function j5e(t,e){const n=Rn(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Gy),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function F5e(t,e){const n=Rn(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return n.Pi.getTargetData(r,e).next((s=>s?(i=s,we.resolve(i)):n.Pi.allocateTargetId(r).next((o=>(i=new jf(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=n.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r}))}async function Yj(t,e,n){const r=Rn(t),i=r.Ms.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!qg(o))throw o;ft(VU,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function dJ(t,e,n){const r=Rn(t);let i=on.min(),s=Bn();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,c,u){const h=Rn(l),f=h.xs.get(u);return f!==void 0?we.resolve(h.Ms.get(f)):h.Pi.getTargetData(c,u)})(r,o,Qc(e)).next((a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{s=l}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,n?i:on.min(),n?s:Bn()))).next((a=>(V5e(r,TNe(e),a),{documents:a,Qs:s})))))}function V5e(t,e,n){let r=t.Os.get(e)||on.min();n.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),t.Os.set(e,r)}class fJ{constructor(){this.activeTargetIds=MNe()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ahe{constructor(){this.Mo=new fJ,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fJ,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class z5e{Oo(e){}shutdown(){}}const pJ="ConnectivityMonitor";class mJ{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ft(pJ,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ft(pJ,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let cP=null;function Xj(){return cP===null?cP=(function(){return 268435456+Math.round(2147483648*Math.random())})():cP++,"0x"+cP.toString(16)}const D6="RestConnection",U5e={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class G5e{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===D3?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,n,r,i,s){const o=Xj(),a=this.zo(e,n.toUriEncodedString());ft(D6,`Sending RPC '${e}' ${o}:`,a,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,s);const{host:c}=new URL(a),u=J1(c);return this.Jo(e,a,l,r,u).then((h=>(ft(D6,`Received RPC '${e}' ${o}: `,h),h)),(h=>{throw w1(D6,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",r),h}))}Ho(e,n,r,i,s,o){return this.Go(e,n,r,i,s)}jo(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+$2})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,n){const r=U5e[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}class B5e{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Vo="WebChannelConnection";class W5e extends G5e{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,i,s){const o=Xj();return new Promise(((a,l)=>{const c=new Ace;c.setWithCredentials(!0),c.listenOnce(Ice.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case kM.NO_ERROR:const h=c.getResponseJson();ft(Vo,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),a(h);break;case kM.TIMEOUT:ft(Vo,`RPC '${e}' ${o} timed out`),l(new Et(We.DEADLINE_EXCEEDED,"Request time out"));break;case kM.HTTP_ERROR:const f=c.getStatus();if(ft(Vo,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);const v=g?.error;if(v&&v.status&&v.message){const x=(function(T){const A=T.toLowerCase().replace(/_/g,"-");return Object.values(We).indexOf(A)>=0?A:We.UNKNOWN})(v.status);l(new Et(x,v.message))}else l(new Et(We.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Et(We.UNAVAILABLE,"Connection failed."));break;default:Ht(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ft(Vo,`RPC '${e}' ${o} completed.`)}}));const u=JSON.stringify(i);ft(Vo,`RPC '${e}' ${o} sending request:`,i),c.send(n,"POST",u,r,15)}))}T_(e,n,r){const i=Xj(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Mce(),a=Pce(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const u=s.join("");ft(Vo,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=o.createWebChannel(u,l);this.I_(h);let f=!1,g=!1;const v=new B5e({Yo:b=>{g?ft(Vo,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(f||(ft(Vo,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),ft(Vo,`RPC '${e}' stream ${i} sending:`,b),h.send(b))},Zo:()=>h.close()}),x=(b,T,A)=>{b.listen(T,(I=>{try{A(I)}catch(R){setTimeout((()=>{throw R}),0)}}))};return x(h,GE.EventType.OPEN,(()=>{g||(ft(Vo,`RPC '${e}' stream ${i} transport opened.`),v.o_())})),x(h,GE.EventType.CLOSE,(()=>{g||(g=!0,ft(Vo,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(h))})),x(h,GE.EventType.ERROR,(b=>{g||(g=!0,w1(Vo,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),v.a_(new Et(We.UNAVAILABLE,"The operation could not be completed")))})),x(h,GE.EventType.MESSAGE,(b=>{if(!g){const T=b.data[0];nn(!!T,16349);const A=T,I=A?.error||A[0]?.error;if(I){ft(Vo,`RPC '${e}' stream ${i} received error:`,I);const R=I.status;let C=(function(N){const O=gs[N];if(O!==void 0)return Rue(O)})(R),V=I.message;C===void 0&&(C=We.INTERNAL,V="Unknown error status: "+R+" with message "+I.message),g=!0,v.a_(new Et(C,V)),h.close()}else ft(Vo,`RPC '${e}' stream ${i} received:`,T),v.u_(T)}})),x(a,Rce.STAT_EVENT,(b=>{b.stat===Ij.PROXY?ft(Vo,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===Ij.NOPROXY&&ft(Vo,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{v.__()}),0),v}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function H5e(){return typeof window<"u"?window:null}function DM(){return typeof document<"u"?document:null}function O5(t){return new qNe(t,!0)}class lhe{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,n-r);i>0&&ft("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const gJ="PersistentStream";class che{constructor(e,n,r,i,s,o,a,l){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new lhe(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===We.RESOURCE_EXHAUSTED?(Ra(n.toString()),Ra("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===We.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===n&&this.G_(r,i)}),(r=>{e((()=>{const i=new Et(We.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ft(gJ,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(ft(gJ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class q5e extends che{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=XNe(this.serializer,e),r=(function(s){if(!("targetChange"in s))return on.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?on.min():o.readTime?Oa(o.readTime):on.min()})(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=Bj(this.serializer),n.addTarget=(function(s,o){let a;const l=o.target;if(a=j3(l)?{documents:$ue(s,l)}:{query:jue(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Cue(s,o.resumeToken);const c=Uj(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(on.min())>0){a.readTime=Jw(s,o.snapshotVersion.toTimestamp());const c=Uj(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a})(this.serializer,e);const r=JNe(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=Bj(this.serializer),n.removeTarget=e,this.q_(n)}}class K5e extends che{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return nn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,nn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){nn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=ZNe(e.writeResults,e.commitTime),r=Oa(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Bj(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>z3(this.serializer,r)))};this.q_(n)}}class Y5e{}class X5e extends Y5e{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Et(We.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,Gj(n,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Et(We.UNKNOWN,s.toString())}))}Ho(e,n,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,Gj(n,r),i,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===We.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Et(We.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Z5e{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ra(n),this.aa=!1):ft("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const A1="RemoteStore";class J5e{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{tv(this)&&(ft(A1,"Restarting streams for network reachability change."),await(async function(l){const c=Rn(l);c.Ea.add(4),await GA(c),c.Ra.set("Unknown"),c.Ea.delete(4),await L5(c)})(this))}))})),this.Ra=new Z5e(r,i)}}async function L5(t){if(tv(t))for(const e of t.da)await e(!0)}async function GA(t){for(const e of t.da)await e(!1)}function uhe(t,e){const n=Rn(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),BU(n)?GU(n):F2(n).O_()&&UU(n,e))}function zU(t,e){const n=Rn(t),r=F2(n);n.Ia.delete(e),r.O_()&&hhe(n,e),n.Ia.size===0&&(r.O_()?r.L_():tv(n)&&n.Ra.set("Unknown"))}function UU(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(on.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}F2(t).Y_(e)}function hhe(t,e){t.Va.Ue(e),F2(t).Z_(e)}function GU(t){t.Va=new GNe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),F2(t).start(),t.Ra.ua()}function BU(t){return tv(t)&&!F2(t).x_()&&t.Ia.size>0}function tv(t){return Rn(t).Ea.size===0}function dhe(t){t.Va=void 0}async function Q5e(t){t.Ra.set("Online")}async function eOe(t){t.Ia.forEach(((e,n)=>{UU(t,e)}))}async function tOe(t,e){dhe(t),BU(t)?(t.Ra.ha(e),GU(t)):t.Ra.set("Unknown")}async function nOe(t,e,n){if(t.Ra.set("Online"),e instanceof Mue&&e.state===2&&e.cause)try{await(async function(i,s){const o=s.cause;for(const a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))})(t,e)}catch(r){ft(A1,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await H3(t,r)}else if(e instanceof OM?t.Va.Ze(e):e instanceof Pue?t.Va.st(e):t.Va.tt(e),!n.isEqual(on.min()))try{const r=await ohe(t.localStore);n.compareTo(r)>=0&&await(function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach(((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.Ia.get(c);u&&s.Ia.set(c,u.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,c)=>{const u=s.Ia.get(l);if(!u)return;s.Ia.set(l,u.withResumeToken(As.EMPTY_BYTE_STRING,u.snapshotVersion)),hhe(s,l);const h=new jf(u.target,l,c,u.sequenceNumber);UU(s,h)})),s.remoteSyncer.applyRemoteEvent(a)})(t,n)}catch(r){ft(A1,"Failed to raise snapshot:",r),await H3(t,r)}}async function H3(t,e,n){if(!qg(e))throw e;t.Ea.add(1),await GA(t),t.Ra.set("Offline"),n||(n=()=>ohe(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{ft(A1,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await L5(t)}))}function fhe(t,e){return e().catch((n=>H3(t,n,e)))}async function BA(t){const e=Rn(t),n=Ig(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gy;for(;rOe(e);)try{const i=await j5e(e.localStore,r);if(i===null){e.Ta.length===0&&n.L_();break}r=i.batchId,iOe(e,i)}catch(i){await H3(e,i)}phe(e)&&mhe(e)}function rOe(t){return tv(t)&&t.Ta.length<10}function iOe(t,e){t.Ta.push(e);const n=Ig(t);n.O_()&&n.X_&&n.ea(e.mutations)}function phe(t){return tv(t)&&!Ig(t).x_()&&t.Ta.length>0}function mhe(t){Ig(t).start()}async function sOe(t){Ig(t).ra()}async function oOe(t){const e=Ig(t);for(const n of t.Ta)e.ea(n.mutations)}async function aOe(t,e,n){const r=t.Ta.shift(),i=PU.from(r,e,n);await fhe(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await BA(t)}async function lOe(t,e){e&&Ig(t).X_&&await(async function(r,i){if((function(o){return VNe(o)&&o!==We.ABORTED})(i.code)){const s=r.Ta.shift();Ig(r).B_(),await fhe(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await BA(r)}})(t,e),phe(t)&&mhe(t)}async function yJ(t,e){const n=Rn(t);n.asyncQueue.verifyOperationInProgress(),ft(A1,"RemoteStore received new credentials");const r=tv(n);n.Ea.add(3),await GA(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await L5(n)}async function cOe(t,e){const n=Rn(t);e?(n.Ea.delete(2),await L5(n)):e||(n.Ea.add(2),await GA(n),n.Ra.set("Unknown"))}function F2(t){return t.ma||(t.ma=(function(n,r,i){const s=Rn(n);return s.sa(),new q5e(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Xo:Q5e.bind(null,t),t_:eOe.bind(null,t),r_:tOe.bind(null,t),H_:nOe.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),BU(t)?GU(t):t.Ra.set("Unknown")):(await t.ma.stop(),dhe(t))}))),t.ma}function Ig(t){return t.fa||(t.fa=(function(n,r,i){const s=Rn(n);return s.sa(),new K5e(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:sOe.bind(null,t),r_:lOe.bind(null,t),ta:oOe.bind(null,t),na:aOe.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await BA(t)):(await t.fa.stop(),t.Ta.length>0&&(ft(A1,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class WU{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ud,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new WU(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Et(We.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function HU(t,e){if(Ra("AsyncQueue",`${e}: ${t}`),qg(t))return new Et(We.UNAVAILABLE,`${e}: ${t}`);throw t}class zx{static emptySet(e){return new zx(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Tt.comparator(n.key,r.key):(n,r)=>Tt.comparator(n.key,r.key),this.keyedMap=BE(),this.sortedSet=new bi(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof zx)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new zx;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class vJ{constructor(){this.ga=new bi(Tt.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ht(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Qw{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach((a=>{o.push({type:0,doc:a})})),new Qw(e,n,zx.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&k5(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class uOe{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class hOe{constructor(){this.queries=_J(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const i=Rn(n),s=i.queries;i.queries=_J(),s.forEach(((o,a)=>{for(const l of a.Sa)l.onError(r)}))})(this,new Et(We.ABORTED,"Firestore shutting down"))}}function _J(){return new yp((t=>mue(t)),k5)}async function ghe(t,e){const n=Rn(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new uOe,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=HU(o,`Initialization of query '${C_(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.Sa.push(e),e.va(n.onlineState),s.wa&&e.Fa(s.wa)&&qU(n)}async function yhe(t,e){const n=Rn(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function dOe(t,e){const n=Rn(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&qU(n)}function fOe(t,e,n){const r=Rn(t),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(e)}function qU(t){t.Ca.forEach((e=>{e.next()}))}var Zj,xJ;(xJ=Zj||(Zj={})).Ma="default",xJ.Cache="cache";class vhe{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Qw(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Qw.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Zj.Cache}}class _he{constructor(e){this.key=e}}class xhe{constructor(e){this.key=e}}class pOe{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Bn(),this.mutatedKeys=Bn(),this.eu=gue(e),this.tu=new zx(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new vJ,i=n?n.tu:this.tu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((u,h)=>{const f=i.get(u),g=zA(this.query,h)?h:null,v=!!f&&this.mutatedKeys.has(f.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let b=!1;f&&g?f.data.isEqual(g.data)?v!==x&&(r.track({type:3,doc:g}),b=!0):this.su(f,g)||(r.track({type:2,doc:g}),b=!0,(l&&this.eu(g,l)>0||c&&this.eu(g,c)<0)&&(a=!0)):!f&&g?(r.track({type:0,doc:g}),b=!0):f&&!g&&(r.track({type:1,doc:f}),b=!0,(l||c)&&(a=!0)),b&&(g?(o=o.add(g),s=x?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((u,h)=>(function(g,v){const x=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ht(20277,{Rt:b})}};return x(g)-x(v)})(u.type,h.type)||this.eu(u.doc,h.doc))),this.ou(r),i=i??!1;const a=n&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Qw(this.query,e.tu,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vJ,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Bn(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const n=[];return e.forEach((r=>{this.Xa.has(r)||n.push(new xhe(r))})),this.Xa.forEach((r=>{e.has(r)||n.push(new _he(r))})),n}cu(e){this.Ya=e.Qs,this.Xa=Bn();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Qw.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const KU="SyncEngine";class mOe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class gOe{constructor(e){this.key=e,this.hu=!1}}class yOe{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new yp((a=>mue(a)),k5),this.Iu=new Map,this.Eu=new Set,this.du=new bi(Tt.comparator),this.Au=new Map,this.Ru=new DU,this.Vu={},this.mu=new Map,this.fu=k1.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function vOe(t,e,n=!0){const r=khe(t);let i;const s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await whe(r,e,n,!0),i}async function _Oe(t,e){const n=khe(t);await whe(n,e,!0,!1)}async function whe(t,e,n,r){const i=await F5e(t.localStore,Qc(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await xOe(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&uhe(t.remoteStore,i),a}async function xOe(t,e,n,r,i){t.pu=(h,f,g)=>(async function(x,b,T,A){let I=b.view.ru(T);I.Cs&&(I=await dJ(x.localStore,b.query,!1).then((({documents:M})=>b.view.ru(M,I))));const R=A&&A.targetChanges.get(b.targetId),C=A&&A.targetMismatches.get(b.targetId)!=null,V=b.view.applyChanges(I,x.isPrimaryClient,R,C);return bJ(x,b.targetId,V.au),V.snapshot})(t,h,f,g);const s=await dJ(t.localStore,e,!0),o=new pOe(e,s.Qs),a=o.ru(s.documents),l=UA.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);bJ(t,n,c.au);const u=new mOe(e,n,o);return t.Tu.set(e,u),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),c.snapshot}async function wOe(t,e,n){const r=Rn(t),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!k5(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Yj(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&zU(r.remoteStore,i.targetId),Jj(r,i.targetId)})).catch(ev)):(Jj(r,i.targetId),await Yj(r.localStore,i.targetId,!0))}async function bOe(t,e){const n=Rn(t),r=n.Tu.get(e),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),zU(n.remoteStore,r.targetId))}async function EOe(t,e,n){const r=Ahe(t);try{const i=await(function(o,a){const l=Rn(o),c=Vr.now(),u=a.reduce(((g,v)=>g.add(v.key)),Bn());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",(g=>{let v=nc(),x=Bn();return l.Ns.getEntries(g,u).next((b=>{v=b,v.forEach(((T,A)=>{A.isValidDocument()||(x=x.add(T))}))})).next((()=>l.localDocuments.getOverlayedDocuments(g,v))).next((b=>{h=b;const T=[];for(const A of a){const I=jNe(A,h.get(A.key).overlayedDocument);I!=null&&T.push(new vp(A.key,I,oue(I.value.mapValue),oa.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,T,a)})).next((b=>{f=b;const T=b.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(g,b.batchId,T)}))})).then((()=>({batchId:f.batchId,changes:vue(h)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new bi(In)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c})(r,i.batchId,n),await WA(r,i.changes),await BA(r.remoteStore)}catch(i){const s=HU(i,"Failed to persist write");n.reject(s)}}async function bhe(t,e){const n=Rn(t);try{const r=await D5e(n.localStore,e);e.targetChanges.forEach(((i,s)=>{const o=n.Au.get(s);o&&(nn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?nn(o.hu,14607):i.removedDocuments.size>0&&(nn(o.hu,42227),o.hu=!1))})),await WA(n,r,e)}catch(r){await ev(r)}}function wJ(t,e,n){const r=Rn(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Tu.forEach(((s,o)=>{const a=o.view.va(e);a.snapshot&&i.push(a.snapshot)})),(function(o,a){const l=Rn(o);l.onlineState=a;let c=!1;l.queries.forEach(((u,h)=>{for(const f of h.Sa)f.va(a)&&(c=!0)})),c&&qU(l)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function SOe(t,e,n){const r=Rn(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Au.get(e),s=i&&i.key;if(s){let o=new bi(Tt.comparator);o=o.insert(s,Xi.newNoDocument(s,on.min()));const a=Bn().add(s),l=new P5(on.min(),new Map,new bi(In),o,a);await bhe(r,l),r.du=r.du.remove(s),r.Au.delete(e),YU(r)}else await Yj(r.localStore,e,!1).then((()=>Jj(r,e,n))).catch(ev)}async function TOe(t,e){const n=Rn(t),r=e.batch.batchId;try{const i=await L5e(n.localStore,e);She(n,r,null),Ehe(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await WA(n,i)}catch(i){await ev(i)}}async function kOe(t,e,n){const r=Rn(t);try{const i=await(function(o,a){const l=Rn(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next((h=>(nn(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h)))).next((()=>l.mutationQueue.performConsistencyCheck(c))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u))).next((()=>l.localDocuments.getDocuments(c,u)))}))})(r.localStore,e);She(r,e,n),Ehe(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await WA(r,i)}catch(i){await ev(i)}}function Ehe(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function She(t,e,n){const r=Rn(t);let i=r.Vu[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Jj(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((r=>{t.Ru.containsKey(r)||The(t,r)}))}function The(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(zU(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),YU(t))}function bJ(t,e,n){for(const r of n)r instanceof _he?(t.Ru.addReference(r.key,e),AOe(t,r)):r instanceof xhe?(ft(KU,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||The(t,r.key)):Ht(19791,{wu:r})}function AOe(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ft(KU,"New document in limbo: "+n),t.Eu.add(r),YU(t))}function YU(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Tt(Er.fromString(e)),r=t.fu.next();t.Au.set(r,new gOe(n)),t.du=t.du.insert(n,r),uhe(t.remoteStore,new jf(Qc(T5(n.path)),r,"TargetPurposeLimboResolution",Yc.ce))}}async function WA(t,e,n){const r=Rn(t),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((a,l)=>{o.push(r.pu(l,e,n).then((c=>{if((c||n)&&r.isPrimaryClient){const u=c?!c.fromCache:n?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){i.push(c);const u=FU.As(l.targetId,c);s.push(u)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(l,c){const u=Rn(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(h=>we.forEach(c,(f=>we.forEach(f.Es,(g=>u.persistence.referenceDelegate.addReference(h,f.targetId,g))).next((()=>we.forEach(f.ds,(g=>u.persistence.referenceDelegate.removeReference(h,f.targetId,g)))))))))}catch(h){if(!qg(h))throw h;ft(VU,"Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const g=u.Ms.get(f),v=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(f,x)}}})(r.localStore,s))}async function IOe(t,e){const n=Rn(t);if(!n.currentUser.isEqual(e)){ft(KU,"User change. New user:",e.toKey());const r=await she(n.localStore,e);n.currentUser=e,(function(s,o){s.mu.forEach((a=>{a.forEach((l=>{l.reject(new Et(We.CANCELLED,o))}))})),s.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await WA(n,r.Ls)}}function ROe(t,e){const n=Rn(t),r=n.Au.get(e);if(r&&r.hu)return Bn().add(r.key);{let i=Bn();const s=n.Iu.get(e);if(!s)return i;for(const o of s){const a=n.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function khe(t){const e=Rn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bhe.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ROe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=SOe.bind(null,e),e.Pu.H_=dOe.bind(null,e.eventManager),e.Pu.yu=fOe.bind(null,e.eventManager),e}function Ahe(t){const e=Rn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TOe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kOe.bind(null,e),e}class vk{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=O5(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return ihe(this.persistence,new rhe,e.initialUser,this.serializer)}Cu(e){return new $U(N5.mi,this.serializer)}Du(e){return new ahe}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vk.provider={build:()=>new vk};class POe extends vk{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){nn(this.persistence.referenceDelegate instanceof W3,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Jue(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Jo.withCacheSize(this.cacheSizeBytes):Jo.DEFAULT;return new $U((r=>W3.mi(r,n)),this.serializer)}}class MOe extends vk{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Ahe(this.xu.syncEngine),await BA(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return ihe(this.persistence,new rhe,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new Jue(r,e.asyncQueue,n)}Mu(e,n){const r=new $4e(n,this.persistence);return new D4e(e.asyncQueue,r)}Cu(e){const n=M5e(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Jo.withCacheSize(this.cacheSizeBytes):Jo.DEFAULT;return new jU(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,H5e(),DM(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new ahe}}class q3{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wJ(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=IOe.bind(null,this.syncEngine),await cOe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new hOe})()}createDatastore(e){const n=O5(e.databaseInfo.databaseId),r=(function(s){return new W5e(s)})(e.databaseInfo);return(function(s,o,a,l){return new X5e(s,o,a,l)})(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,i,s,o,a){return new J5e(r,i,s,o,a)})(this.localStore,this.datastore,e.asyncQueue,(n=>wJ(this.syncEngine,n,0)),(function(){return mJ.v()?new mJ:new z5e})())}createSyncEngine(e,n){return(function(i,s,o,a,l,c,u){const h=new yOe(i,s,o,a,l,c);return u&&(h.gu=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=Rn(n);ft(A1,"RemoteStore shutting down."),r.Ea.add(5),await GA(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}q3.provider={build:()=>new q3};class Ihe{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ra("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Rg="FirestoreClient";class COe{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=ko.UNAUTHENTICATED,this.clientId=yU.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{ft(Rg,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(ft(Rg,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ud;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=HU(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function $6(t,e){t.asyncQueue.verifyOperationInProgress(),ft(Rg,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async i=>{r.isEqual(i)||(await she(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function EJ(t,e){t.asyncQueue.verifyOperationInProgress();const n=await NOe(t);ft(Rg,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>yJ(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,i)=>yJ(e.remoteStore,i))),t._onlineComponents=e}async function NOe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ft(Rg,"Using user provided OfflineComponentProvider");try{await $6(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(i){return i.name==="FirebaseError"?i.code===We.FAILED_PRECONDITION||i.code===We.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(n))throw n;w1("Error using user provided cache. Falling back to memory cache: "+n),await $6(t,new vk)}}else ft(Rg,"Using default OfflineComponentProvider"),await $6(t,new POe(void 0));return t._offlineComponents}async function Rhe(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ft(Rg,"Using user provided OnlineComponentProvider"),await EJ(t,t._uninitializedComponentsProvider._online)):(ft(Rg,"Using default OnlineComponentProvider"),await EJ(t,new q3))),t._onlineComponents}function OOe(t){return Rhe(t).then((e=>e.syncEngine))}async function Phe(t){const e=await Rhe(t),n=e.eventManager;return n.onListen=vOe.bind(null,e.syncEngine),n.onUnlisten=wOe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_Oe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=bOe.bind(null,e.syncEngine),n}function LOe(t,e,n={}){const r=new ud;return t.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,c){const u=new Ihe({next:f=>{u.Nu(),o.enqueueAndForget((()=>yhe(s,h)));const g=f.docs.has(a);!g&&f.fromCache?c.reject(new Et(We.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&f.fromCache&&l&&l.source==="server"?c.reject(new Et(We.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new vhe(T5(a.path),u,{includeMetadataChanges:!0,qa:!0});return ghe(s,h)})(await Phe(t),t.asyncQueue,e,n,r))),r.promise}function DOe(t,e,n={}){const r=new ud;return t.asyncQueue.enqueueAndForget((async()=>(function(s,o,a,l,c){const u=new Ihe({next:f=>{u.Nu(),o.enqueueAndForget((()=>yhe(s,h))),f.fromCache&&l.source==="server"?c.reject(new Et(We.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new vhe(a,u,{includeMetadataChanges:!0,qa:!0});return ghe(s,h)})(await Phe(t),t.asyncQueue,e,n,r))),r.promise}function Mhe(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const SJ=new Map;const Che="firestore.googleapis.com",TJ=!0;class kJ{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Et(We.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Che,this.ssl=TJ}else this.host=e.host,this.ssl=e.ssl??TJ;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Kue;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<p5e)throw new Et(We.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}C4e("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Mhe(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Et(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Et(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Et(We.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class D5{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kJ({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Et(We.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Et(We.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kJ(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new b4e;switch(r.type){case"firstParty":return new k4e(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Et(We.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=SJ.get(n);r&&(ft("ComponentProvider","Removing Datastore"),SJ.delete(n),r.terminate())})(this),Promise.resolve()}}function $Oe(t,e,n,r={}){t=au(t,D5);const i=J1(e),s=t._getSettings(),o={...s,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;i&&(nU(`https://${a}`),rU("Firestore",!0)),s.host!==Che&&s.host!==a&&w1("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!y1(l,o)&&(t._setSettings(l),r.mockUserToken)){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=ko.MOCK_USER;else{c=$le(r.mockUserToken,t._app?.options.projectId);const h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new Et(We.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ko(h)}t._authCredentials=new E4e(new Nce(c,u))}}class V2{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new V2(this.firestore,e,this._query)}}class hs{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hs(this.firestore,e,this._key)}toJSON(){return{type:hs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if($A(n,hs._jsonSchema))return new hs(e,r||null,new Tt(Er.fromString(n.referencePath)))}}hs._jsonSchemaVersion="firestore/documentReference/1.0",hs._jsonSchema={type:Ss("string",hs._jsonSchemaVersion),referencePath:Ss("string")};class fg extends V2{constructor(e,n,r){super(e,n,T5(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hs(this.firestore,null,new Tt(e))}withConverter(e){return new fg(this.firestore,e,this._path)}}function AJ(t,e,...n){if(t=co(t),Lce("collection","path",e),t instanceof D5){const r=Er.fromString(e,...n);return gZ(r),new fg(t,null,r)}{if(!(t instanceof hs||t instanceof fg))throw new Et(We.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Er.fromString(e,...n));return gZ(r),new fg(t.firestore,null,r)}}function Ay(t,e,...n){if(t=co(t),arguments.length===1&&(e=yU.newId()),Lce("doc","path",e),t instanceof D5){const r=Er.fromString(e,...n);return mZ(r),new hs(t,null,new Tt(r))}{if(!(t instanceof hs||t instanceof fg))throw new Et(We.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Er.fromString(e,...n));return mZ(r),new hs(t.firestore,t instanceof fg?t.converter:null,new Tt(r))}}const IJ="AsyncQueue";class RJ{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new lhe(this,"async_queue_retry"),this._c=()=>{const r=DM();r&&ft(IJ,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=DM();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=DM();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new ud;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qg(e))throw e;ft(IJ,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ra("INTERNAL UNHANDLED ERROR: ",PJ(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const i=WU.createAndSchedule(this,e,n,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Ht(47125,{Pc:PJ(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function PJ(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Yg extends D5{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new RJ,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new RJ(e),this._firestoreClient=void 0,await e}}}function jOe(t,e){const n=typeof t=="object"?t:oU(),r=typeof t=="string"?t:D3,i=f5(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=Ole("firestore");s&&$Oe(i,...s)}return i}function XU(t){if(t._terminated)throw new Et(We.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Nhe(t),t._firestoreClient}function Nhe(t){const e=t._freezeSettings(),n=(function(i,s,o,a){return new dNe(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,Mhe(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new COe(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(t._componentsProvider))}function FOe(t,e){w1("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return VOe(t,q3.provider,{build:r=>new MOe(r,n.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function VOe(t,e,n){if((t=au(t,Yg))._firestoreClient||t._terminated)throw new Et(We.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new Et(We.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Nhe(t)}class Gc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gc(As.fromBase64String(e))}catch(n){throw new Et(We.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gc(As.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Gc._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($A(e,Gc._jsonSchema))return Gc.fromBase64String(e.bytes)}}Gc._jsonSchemaVersion="firestore/bytes/1.0",Gc._jsonSchema={type:Ss("string",Gc._jsonSchemaVersion),bytes:Ss("string")};class $5{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Et(We.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ni(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class j5{constructor(e){this._methodName=e}}class hd{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Et(We.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Et(We.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return In(this._lat,e._lat)||In(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hd._jsonSchemaVersion}}static fromJSON(e){if($A(e,hd._jsonSchema))return new hd(e.latitude,e.longitude)}}hd._jsonSchemaVersion="firestore/geoPoint/1.0",hd._jsonSchema={type:Ss("string",hd._jsonSchemaVersion),latitude:Ss("number"),longitude:Ss("number")};class dd{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:dd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($A(e,dd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new dd(e.vectorValues);throw new Et(We.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}dd._jsonSchemaVersion="firestore/vectorValue/1.0",dd._jsonSchema={type:Ss("string",dd._jsonSchemaVersion),vectorValues:Ss("object")};const zOe=/^__.*__$/;class UOe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new vp(e,this.data,this.fieldMask,n,this.fieldTransforms):new j2(e,this.data,n,this.fieldTransforms)}}class Ohe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new vp(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Lhe(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ht(40011,{Ac:t})}}class ZU{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ZU({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){const n=this.path?.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return K3(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Lhe(this.Ac)&&zOe.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GOe{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||O5(e)}Cc(e,n,r,i=!1){return new ZU({Ac:e,methodName:n,Dc:r,path:Ni.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function F5(t){const e=t._freezeSettings(),n=O5(t._databaseId);return new GOe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dhe(t,e,n,r,i,s={}){const o=t.Cc(s.merge||s.mergeFields?2:0,e,n,i);QU("Data must be an object, but it was:",o,r);const a=$he(r,o);let l,c;if(s.merge)l=new fl(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const f=Qj(e,h,n);if(!o.contains(f))throw new Et(We.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Fhe(u,f)||u.push(f)}l=new fl(u),c=o.fieldTransforms.filter((h=>l.covers(h.field)))}else l=null,c=o.fieldTransforms;return new UOe(new ra(a),l,c)}class V5 extends j5{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof V5}}class JU extends j5{_toFieldTransform(e){return new Tue(e.path,new Yw)}isEqual(e){return e instanceof JU}}function BOe(t,e,n,r){const i=t.Cc(1,e,n);QU("Data must be an object, but it was:",i,r);const s=[],o=ra.empty();Kg(r,((l,c)=>{const u=eG(e,l,n);c=co(c);const h=i.yc(u);if(c instanceof V5)s.push(u);else{const f=HA(c,h);f!=null&&(s.push(u),o.set(u,f))}}));const a=new fl(s);return new Ohe(o,a,i.fieldTransforms)}function WOe(t,e,n,r,i,s){const o=t.Cc(1,e,n),a=[Qj(e,r,n)],l=[i];if(s.length%2!=0)throw new Et(We.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Qj(e,s[f])),l.push(s[f+1]);const c=[],u=ra.empty();for(let f=a.length-1;f>=0;--f)if(!Fhe(c,a[f])){const g=a[f];let v=l[f];v=co(v);const x=o.yc(g);if(v instanceof V5)c.push(g);else{const b=HA(v,x);b!=null&&(c.push(g),u.set(g,b))}}const h=new fl(c);return new Ohe(u,h,o.fieldTransforms)}function HOe(t,e,n,r=!1){return HA(n,t.Cc(r?4:3,e))}function HA(t,e){if(jhe(t=co(t)))return QU("Unsupported field value:",e,t),$he(t,e);if(t instanceof j5)return(function(r,i){if(!Lhe(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const a of r){let l=HA(a,i.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}})(t,e)}return(function(r,i){if((r=co(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return CNe(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Vr.fromDate(r);return{timestampValue:Jw(i.serializer,s)}}if(r instanceof Vr){const s=new Vr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jw(i.serializer,s)}}if(r instanceof hd)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Gc)return{bytesValue:Cue(i.serializer,r._byteString)};if(r instanceof hs){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:NU(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof dd)return(function(o,a){return{mapValue:{fields:{[TU]:{stringValue:kU},[Ww]:{arrayValue:{values:o.toArray().map((c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return IU(a.serializer,c)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${y5(r)}`)})(t,e)}function $he(t,e){const n={};return Zce(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Kg(t,((r,i)=>{const s=HA(i,e.mc(r));s!=null&&(n[r]=s)})),{mapValue:{fields:n}}}function jhe(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Vr||t instanceof hd||t instanceof Gc||t instanceof hs||t instanceof j5||t instanceof dd)}function QU(t,e,n){if(!jhe(n)||!Dce(n)){const r=y5(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function Qj(t,e,n){if((e=co(e))instanceof $5)return e._internalPath;if(typeof e=="string")return eG(t,e);throw K3("Field path arguments must be of type string or ",t,!1,void 0,n)}const qOe=new RegExp("[~\\*/\\[\\]]");function eG(t,e,n){if(e.search(qOe)>=0)throw K3(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new $5(...e.split("."))._internalPath}catch{throw K3(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function K3(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Et(We.INVALID_ARGUMENT,a+t+l)}function Fhe(t,e){return t.some((n=>n.isEqual(e)))}class Vhe{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new hs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KOe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(tG("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class KOe extends Vhe{data(){return super.data()}}function tG(t,e){return typeof e=="string"?eG(t,e):e instanceof $5?e._internalPath:e._delegate._internalPath}function YOe(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Et(We.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nG{}class XOe extends nG{}function ZOe(t,e,...n){let r=[];e instanceof nG&&r.push(e),r=r.concat(n),(function(s){const o=s.filter((l=>l instanceof rG)).length,a=s.filter((l=>l instanceof z5)).length;if(o>1||o>0&&a>0)throw new Et(We.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)t=i._apply(t);return t}class z5 extends XOe{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new z5(e,n,r)}_apply(e){const n=this._parse(e);return zhe(e._query,n),new V2(e.firestore,e.converter,Vj(e._query,n))}_parse(e){const n=F5(e.firestore);return(function(s,o,a,l,c,u,h){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Et(We.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){CJ(h,u);const v=[];for(const x of h)v.push(MJ(l,s,x));f={arrayValue:{values:v}}}else f=MJ(l,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||CJ(h,u),f=HOe(a,o,h,u==="in"||u==="not-in");return er.create(c,u,f)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function JOe(t,e,n){const r=e,i=tG("where",t);return z5._create(i,r,n)}class rG extends nG{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new rG(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:zr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)zhe(o,l),o=Vj(o,l)})(e._query,n),new V2(e.firestore,e.converter,Vj(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function MJ(t,e,n){if(typeof(n=co(n))=="string"){if(n==="")throw new Et(We.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!pue(e)&&n.indexOf("/")!==-1)throw new Et(We.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Er.fromString(n));if(!Tt.isDocumentKey(r))throw new Et(We.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mk(t,new Tt(r))}if(n instanceof hs)return mk(t,n._key);throw new Et(We.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${y5(n)}.`)}function CJ(t,e){if(!Array.isArray(t)||t.length===0)throw new Et(We.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zhe(t,e){const n=(function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(t.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Et(We.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Et(We.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class QOe{convertValue(e,n="none"){switch(kg(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vi(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(op(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ht(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Kg(e,((i,s)=>{r[i]=this.convertValue(s,n)})),r}convertVectorValue(e){const n=e.fields?.[Ww].arrayValue?.values?.map((r=>vi(r.doubleValue)));return new dd(n)}convertGeoPoint(e){return new hd(vi(e.latitude),vi(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=E5(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(fk(e));default:return null}}convertTimestamp(e){const n=sp(e);return new Vr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Er.fromString(e);nn(Uue(r),9688,{name:e});const i=new b1(r.get(1),r.get(3)),s=new Tt(r.popFirst(5));return i.isEqual(n)||Ra(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function Uhe(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class qE{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hy extends Vhe{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new $M(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(tG("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Et(We.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Hy._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Hy._jsonSchemaVersion="firestore/documentSnapshot/1.0",Hy._jsonSchema={type:Ss("string",Hy._jsonSchemaVersion),bundleSource:Ss("string","DocumentSnapshot"),bundleName:Ss("string"),bundle:Ss("string")};class $M extends Hy{data(e={}){return super.data(e)}}class Ux{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new qE(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new $M(this._firestore,this._userDataWriter,r.key,r,new qE(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Et(We.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((a=>{const l=new $M(i._firestore,i._userDataWriter,a.doc.key,a.doc,new qE(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((a=>s||a.type!==3)).map((a=>{const l=new $M(i._firestore,i._userDataWriter,a.doc.key,a.doc,new qE(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:eLe(a.type),doc:l,oldIndex:c,newIndex:u}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Et(We.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ux._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=yU.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(n.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function eLe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ht(61501,{type:t})}}function tLe(t){t=au(t,hs);const e=au(t.firestore,Yg);return LOe(XU(e),t._key).then((n=>oLe(e,t,n)))}Ux._jsonSchemaVersion="firestore/querySnapshot/1.0",Ux._jsonSchema={type:Ss("string",Ux._jsonSchemaVersion),bundleSource:Ss("string","QuerySnapshot"),bundleName:Ss("string"),bundle:Ss("string")};class Ghe extends QOe{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gc(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hs(this.firestore,null,n)}}function nLe(t){t=au(t,V2);const e=au(t.firestore,Yg),n=XU(e),r=new Ghe(e);return YOe(t._query),DOe(n,t._query).then((i=>new Ux(e,r,t,i)))}function j6(t,e,n){t=au(t,hs);const r=au(t.firestore,Yg),i=Uhe(t.converter,e,n);return U5(r,[Dhe(F5(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,oa.none())])}function rLe(t,e,n,...r){t=au(t,hs);const i=au(t.firestore,Yg),s=F5(i);let o;return o=typeof(e=co(e))=="string"||e instanceof $5?WOe(s,"updateDoc",t._key,e,n,r):BOe(s,"updateDoc",t._key,e),U5(i,[o.toMutation(t._key,oa.exists(!0))])}function iLe(t){return U5(au(t.firestore,Yg),[new R5(t._key,oa.none())])}function sLe(t,e){const n=au(t.firestore,Yg),r=Ay(t),i=Uhe(t.converter,e);return U5(n,[Dhe(F5(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,oa.exists(!1))]).then((()=>r))}function U5(t,e){return(function(r,i){const s=new ud;return r.asyncQueue.enqueueAndForget((async()=>EOe(await OOe(r),i,s))),s.promise})(XU(t),e)}function oLe(t,e,n){const r=n.docs.get(e._key),i=new Ghe(t);return new Hy(t,i,e._key,r,new qE(n.hasPendingWrites,n.fromCache),e.converter)}function F6(){return new JU("serverTimestamp")}(function(e,n=!0){(function(i){$2=i})(Q1),v1(new Sg("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Yg(new S4e(r.getProvider("auth-internal")),new A4e(o,r.getProvider("app-check-internal")),(function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Et(We.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new b1(c.options.projectId,u)})(o,i),o);return s={useFetchStreams:n,...s},a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),ld(hZ,dZ,e),ld(hZ,dZ,"esm2020")})();const Bhe="firebasestorage.googleapis.com",aLe="storageBucket",lLe=120*1e3,cLe=600*1e3;class Ld extends Od{constructor(e,n,r=0){super(V6(e),`Firebase Storage: ${n} (${V6(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ld.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return V6(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ed;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ed||(Ed={}));function V6(t){return"storage/"+t}function uLe(){const t="An unknown error occurred, please check the error payload for server response.";return new Ld(Ed.UNKNOWN,t)}function hLe(){return new Ld(Ed.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dLe(){return new Ld(Ed.CANCELED,"User canceled the upload/download.")}function fLe(t){return new Ld(Ed.INVALID_URL,"Invalid URL '"+t+"'.")}function pLe(t){return new Ld(Ed.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function NJ(t){return new Ld(Ed.INVALID_ARGUMENT,t)}function Whe(){return new Ld(Ed.APP_DELETED,"The Firebase app was deleted.")}function mLe(t){return new Ld(Ed.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class Xu{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Xu.makeFromUrl(e,n)}catch{return new Xu(e,"")}if(r.path==="")return r;throw pLe(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(R){R.path_=decodeURIComponent(R.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",g=new RegExp(`^https?://${h}/${u}/b/${i}/o${f}`,"i"),v={bucket:1,path:3},x=n===Bhe?"(?:storage.googleapis.com|storage.cloud.google.com)":n,b="([^?#]*)",T=new RegExp(`^https?://${x}/${i}/${b}`,"i"),I=[{regex:a,indices:l,postModify:s},{regex:g,indices:v,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let R=0;R<I.length;R++){const C=I[R],V=C.regex.exec(e);if(V){const M=V[C.indices.bucket];let N=V[C.indices.path];N||(N=""),r=new Xu(M,N),C.postModify(r);break}}if(r==null)throw fLe(e);return r}}class gLe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function yLe(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...b){c||(c=!0,e.apply(null,b))}function h(b){i=setTimeout(()=>{i=null,t(g,l())},b)}function f(){s&&clearTimeout(s)}function g(b,...T){if(c){f();return}if(b){f(),u.call(null,b,...T);return}if(l()||o){f(),u.call(null,b,...T);return}r<64&&(r*=2);let I;a===1?(a=2,I=0):I=(r+Math.random())*1e3,h(I)}let v=!1;function x(b){v||(v=!0,f(),!c&&(i!==null?(b||(a=2),clearTimeout(i),h(0)):b||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,x(!0)},n),x}function vLe(t){t(!1)}function _Le(t){return t!==void 0}function OJ(t,e,n,r){if(r<e)throw NJ(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw NJ(`Invalid value for '${t}'. Expected ${n} or less.`)}function xLe(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Y3;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Y3||(Y3={}));function wLe(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}class bLe{constructor(e,n,r,i,s,o,a,l,c,u,h,f=!0,g=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,x)=>{this.resolve_=v,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new uP(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Y3.NO_ERROR,l=s.getStatus();if(!a||wLe(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Y3.ABORT;r(!1,new uP(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new uP(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());_Le(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=uLe();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?Whe():dLe();o(l)}else{const l=hLe();o(l)}};this.canceled_?n(!1,new uP(!1,null,!0)):this.backoffId_=yLe(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vLe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class uP{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function ELe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function SLe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function TLe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function kLe(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ALe(t,e,n,r,i,s,o=!0,a=!1){const l=xLe(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return TLe(u,e),ELe(u,n),SLe(u,s),kLe(u,r),new bLe(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o,a)}function ILe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function RLe(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class X3{constructor(e,n){this._service=e,n instanceof Xu?this._location=n:this._location=Xu.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new X3(e,n)}get root(){const e=new Xu(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RLe(this._location.path)}get storage(){return this._service}get parent(){const e=ILe(this._location.path);if(e===null)return null;const n=new Xu(this._location.bucket,e);return new X3(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw mLe(e)}}function LJ(t,e){const n=e?.[aLe];return n==null?null:Xu.makeFromBucketSpec(n,t)}function PLe(t,e,n,r={}){t.host=`${e}:${n}`;const i=J1(e);i&&(nU(`https://${t.host}/b`),rU("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:$le(s,t.app.options.projectId))}class MLe{constructor(e,n,r,i,s,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=Bhe,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lLe,this._maxUploadRetryTime=cLe,this._requests=new Set,i!=null?this._bucket=Xu.makeFromBucketSpec(i,this._host):this._bucket=LJ(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xu.makeFromBucketSpec(this._url,e):this._bucket=LJ(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){OJ("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){OJ("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(ec(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new X3(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new gLe(Whe());{const o=ALe(e,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const DJ="@firebase/storage",$J="0.14.0";const Hhe="storage";function CLe(t=oU(),e){t=co(t);const r=f5(t,Hhe).getImmediate({identifier:e}),i=Ole("storage");return i&&NLe(r,...i),r}function NLe(t,e,n,r={}){PLe(t,e,n,r)}function OLe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new MLe(n,r,i,e,Q1)}function LLe(){v1(new Sg(Hhe,OLe,"PUBLIC").setMultipleInstances(!0)),ld(DJ,$J,""),ld(DJ,$J,"esm2020")}LLe();const DLe={apiKey:"AIzaSyBcLuKvUr5XqEJTwOf9I0hqJ1o9g3kOZ-g",authDomain:"detectorapp-nl.firebaseapp.com",projectId:"detectorapp-nl",storageBucket:"detectorapp-nl.firebasestorage.app",messagingSenderId:"110954177210",appId:"1:110954177210:web:d77c9ed262ad92bc431883"},iG=Ble(DLe),Iy=v4e(iG),Ff=jOe(iG);CLe(iG);FOe(Ff).catch(t=>{t.code==="failed-precondition"?console.warn("Offline persistence failed: Multiple tabs open"):t.code==="unimplemented"&&console.warn("Offline persistence not available in this browser")});const $Le={};function jLe(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var s;const o=l=>l===null?null:JSON.parse(l,void 0),a=(s=n.getItem(i))!=null?s:null;return a instanceof Promise?a.then(o):o(a)},setItem:(i,s)=>n.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>n.removeItem(i)}}const _k=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return _k(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return _k(r)(n)}}}},FLe=(t,e)=>(n,r,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:b=>b,version:0,merge:(b,T)=>({...T,...b}),...e},o=!1;const a=new Set,l=new Set;let c;try{c=s.getStorage()}catch{}if(!c)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...b)},r,i);const u=_k(s.serialize),h=()=>{const b=s.partialize({...r()});let T;const A=u({state:b,version:s.version}).then(I=>c.setItem(s.name,I)).catch(I=>{T=I});if(T)throw T;return A},f=i.setState;i.setState=(b,T)=>{f(b,T),h()};const g=t((...b)=>{n(...b),h()},r,i);let v;const x=()=>{var b;if(!c)return;o=!1,a.forEach(A=>A(r()));const T=((b=s.onRehydrateStorage)==null?void 0:b.call(s,r()))||void 0;return _k(c.getItem.bind(c))(s.name).then(A=>{if(A)return s.deserialize(A)}).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==s.version){if(s.migrate)return s.migrate(A.state,A.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return A.state}).then(A=>{var I;return v=s.merge(A,(I=r())!=null?I:g),n(v,!0),h()}).then(()=>{T?.(v,void 0),o=!0,l.forEach(A=>A(v))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:b=>{s={...s,...b},b.getStorage&&(c=b.getStorage())},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>x(),hasHydrated:()=>o,onHydrate:b=>(a.add(b),()=>{a.delete(b)}),onFinishHydration:b=>(l.add(b),()=>{l.delete(b)})},x(),v||g},VLe=(t,e)=>(n,r,i)=>{let s={storage:jLe(()=>localStorage),partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},o=!1;const a=new Set,l=new Set;let c=s.storage;if(!c)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...x)},r,i);const u=()=>{const x=s.partialize({...r()});return c.setItem(s.name,{state:x,version:s.version})},h=i.setState;i.setState=(x,b)=>{h(x,b),u()};const f=t((...x)=>{n(...x),u()},r,i);i.getInitialState=()=>f;let g;const v=()=>{var x,b;if(!c)return;o=!1,a.forEach(A=>{var I;return A((I=r())!=null?I:f)});const T=((b=s.onRehydrateStorage)==null?void 0:b.call(s,(x=r())!=null?x:f))||void 0;return _k(c.getItem.bind(c))(s.name).then(A=>{if(A)if(typeof A.version=="number"&&A.version!==s.version){if(s.migrate)return[!0,s.migrate(A.state,A.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,A.state];return[!1,void 0]}).then(A=>{var I;const[R,C]=A;if(g=s.merge(C,(I=r())!=null?I:f),n(g,!0),R)return u()}).then(()=>{T?.(g,void 0),g=r(),o=!0,l.forEach(A=>A(g))}).catch(A=>{T?.(void 0,A)})};return i.persist={setOptions:x=>{s={...s,...x},x.storage&&(c=x.storage)},clearStorage:()=>{c?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:x=>(a.add(x),()=>{a.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},s.skipHydration||v(),g||f},zLe=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?(($Le?"commercial":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),FLe(t,e)):VLe(t,e),dh=zLe,Nn=No()(dh(t=>({defaultBackground:"CartoDB (licht)",showScaleBar:!0,gpsAutoStart:!1,showAccuracyCircle:!0,hapticFeedback:!0,vondstenLocalOnly:!0,showVondstButton:!1,showRouteRecordButton:!1,showLocalVondsten:!0,showCustomPointLayers:!0,fontScale:100,layerPanelFontScale:100,presetPanelFontScale:100,menuFontScale:100,weatherFontScale:100,voiceFeedbackEnabled:!1,showStepCounter:!1,showFontSliders:!1,showWeatherButton:!1,setDefaultBackground:e=>t({defaultBackground:e}),setShowScaleBar:e=>t({showScaleBar:e}),setGpsAutoStart:e=>t({gpsAutoStart:e}),setShowAccuracyCircle:e=>t({showAccuracyCircle:e}),setHapticFeedback:e=>t({hapticFeedback:e}),setVondstenLocalOnly:e=>t({vondstenLocalOnly:e}),setShowVondstButton:e=>t({showVondstButton:e}),setShowRouteRecordButton:e=>t({showRouteRecordButton:e}),setShowLocalVondsten:e=>t({showLocalVondsten:e}),setShowCustomPointLayers:e=>t({showCustomPointLayers:e}),setFontScale:e=>t({fontScale:e}),setLayerPanelFontScale:e=>t({layerPanelFontScale:e}),setPresetPanelFontScale:e=>t({presetPanelFontScale:e}),setMenuFontScale:e=>t({menuFontScale:e}),setWeatherFontScale:e=>t({weatherFontScale:e}),setVoiceFeedbackEnabled:e=>t({voiceFeedbackEnabled:e}),setShowStepCounter:e=>t({showStepCounter:e}),setShowFontSliders:e=>t({showFontSliders:e}),setShowWeatherButton:e=>t({showWeatherButton:e})}),{name:"detectorapp-settings",version:2,migrate:(t,e)=>e<2?{...t,showScaleBar:!0}:t})),G5=No()(L2((t,e)=>({user:null,accessToken:null,loading:!1,error:null,initialized:!1,setUser:n=>{t(r=>{r.user=n,r.loading=!1})},setLoading:n=>{t(r=>{r.loading=n})},setError:n=>{t(r=>{r.error=n})},setAccessToken:n=>{t(r=>{r.accessToken=n})},signInWithGoogle:async()=>{t(n=>{n.loading=!0,n.error=null});try{const n=new Wu;await nZ(Iy,n)}catch(n){console.error("Google sign-in error:",n),t(r=>{r.error=n.message,r.loading=!1})}},connectGoogleFit:async()=>{t(n=>{n.loading=!0,n.error=null});try{const n=new Wu;n.addScope("https://www.googleapis.com/auth/fitness.activity.read");const r=await nZ(Iy,n),i=Wu.credentialFromResult(r);return i?.accessToken?(t(s=>{s.accessToken=i.accessToken||null,s.loading=!1}),console.log(" Google Fit gekoppeld"),!0):(t(s=>{s.loading=!1}),!1)}catch(n){return console.error("Google Fit connect error:",n),t(r=>{r.error=n.message,r.loading=!1}),!1}},logout:async()=>{t(n=>{n.loading=!0});try{await pce(Iy),t(n=>{n.accessToken=null})}catch(n){console.error("Logout error:",n),t(r=>{r.error=n.message,r.loading=!1})}},initAuth:()=>{e().initialized||(t(n=>{n.initialized=!0}),fce(Iy,n=>{t(r=>{r.user=n,r.loading=!1}),n&&Nn.getState().setVondstenLocalOnly(!1)}))}})));No()(L2((t,e)=>({vondsten:[],loading:!1,error:null,loadVondsten:async n=>{t(r=>{r.loading=!0});try{const r=ZOe(AJ(Ff,"vondsten"),JOe("userId","==",n)),s=(await nLe(r)).docs.map(o=>({id:o.id,...o.data()}));t(o=>{o.vondsten=s,o.loading=!1})}catch(r){t(i=>{i.error=r.message,i.loading=!1})}},addVondst:async n=>{const r=new Date().toISOString(),i={...n,createdAt:r,updatedAt:r},s=await sLe(AJ(Ff,"vondsten"),i);return t(o=>{o.vondsten.push({...i,id:s.id})}),s.id},updateVondst:async(n,r)=>{const i=Ay(Ff,"vondsten",n);await rLe(i,{...r,updatedAt:new Date().toISOString()}),t(s=>{const o=s.vondsten.findIndex(a=>a.id===n);o!==-1&&(s.vondsten[o]={...s.vondsten[o],...r})})},deleteVondst:async n=>{await iLe(Ay(Ff,"vondsten",n)),t(r=>{r.vondsten=r.vondsten.filter(i=>i.id!==n)})}})));const z6=[{id:"detectie",name:"Detectie",icon:"Compass",layers:["AMK Monumenten","Gewaspercelen"],baseLayer:"CartoDB (licht)",isBuiltIn:!1},{id:"steentijd",name:"Steentijd",icon:"Mountain",layers:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","AMK Steentijd","AHN4 Multi-Hillshade NL","Labels Overlay"],baseLayer:"Luchtfoto",isBuiltIn:!1},{id:"romeins-midvroeg",name:"Romeins - Mid vroeg",icon:"Layers",layers:["Romeinse wegen (regio)","Romeinse Forten","Romeinse Forten Lijnen","AMK Romeins","AMK Vroege ME","Gewaspercelen","Kadastrale Grenzen"],isBuiltIn:!1},{id:"midlaat-nieuwetijd",name:"Mid laat - Nieuwe tijd",icon:"Grid",layers:["AMK Late ME","Kastelen","Essen","Rijksmonumenten","Gewaspercelen","Kadastrale Grenzen","Oude Kernen"],isBuiltIn:!1},{id:"woii-militair",name:"WOII & Militair",icon:"Target",layers:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten"],isBuiltIn:!1},{id:"analyse",name:"Terrein Analyse",icon:"Search",layers:["IKAW","Geomorfologie","Bodemkaart","AHN4 Multi-Hillshade NL","AHN4 Hoogtekaart Kleur"],isBuiltIn:!1}],jJ=["Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],qhe=No()(dh((t,e)=>({presets:[...z6],applyPreset:n=>{const r=e().presets.find(s=>s.id===n);if(!r)return;const i=io.getState();jJ.forEach(s=>i.setLayerVisibility(s,!1)),r.layers.forEach(s=>i.setLayerVisibility(s,!0)),r.baseLayer&&["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(o=>{i.setLayerVisibility(o,o===r.baseLayer)}),console.log(` Preset toegepast: ${r.name}${r.baseLayer?` (${r.baseLayer})`:""}`)},createPreset:(n,r)=>{const i=io.getState(),s=Object.entries(i.visible).filter(([a,l])=>l&&jJ.includes(a)).map(([a])=>a),o={id:`custom-${Date.now()}`,name:n,icon:r,layers:s,isBuiltIn:!1};t(a=>({presets:[...a.presets,o]})),console.log(` Preset aangemaakt: ${n} met ${s.length} lagen`)},updatePreset:(n,r)=>{t(i=>({presets:i.presets.map(s=>s.id===n?{...s,...r}:s)}))},deletePreset:n=>{t(r=>({presets:r.presets.filter(i=>i.id!==n||i.isBuiltIn)}))},resetToDefaults:()=>{t({presets:[...z6]})}}),{name:"detectorapp-presets",version:10,migrate:(t,e)=>e<10?{presets:[...z6]}:t})),FJ=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],qA=No()(dh((t,e)=>({layers:[],addLayer:n=>{const r=crypto.randomUUID(),i=e().layers.length,s=FJ[i%FJ.length];return t(o=>({layers:[...o.layers,{...n,id:r,createdAt:new Date().toISOString(),color:n.color||s,visible:n.visible??!0,opacity:n.opacity??1}]})),r},removeLayer:n=>t(r=>({layers:r.layers.filter(i=>i.id!==n)})),updateLayer:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,...r}:s)})),toggleVisibility:n=>t(r=>({layers:r.layers.map(i=>i.id===n?{...i,visible:!i.visible}:i)})),setOpacity:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,opacity:r}:s)})),setColor:(n,r)=>t(i=>({layers:i.layers.map(s=>s.id===n?{...s,color:r}:s)})),clearAll:()=>t({layers:[]})}),{name:"detectorapp-custom-layers",version:1})),ULe=["CartoDB (licht)","OpenStreetMap","Luchtfoto","Labels Overlay","Mijn Vondsten"],sG=No()(dh((t,e)=>({tier:"free",unlockedRegions:["nl"],devMode:!0,setTier:n=>t({tier:n}),unlockRegion:n=>t(r=>({unlockedRegions:r.unlockedRegions.includes(n)?r.unlockedRegions:[...r.unlockedRegions,n]})),lockRegion:n=>t(r=>({unlockedRegions:r.unlockedRegions.filter(i=>i!==n)})),setDevMode:n=>t({devMode:n}),isRegionUnlocked:n=>{const r=e();return r.devMode||r.tier==="pro"?!0:r.unlockedRegions.includes(n)},isLayerUnlocked:(n,r="free",i=["nl"])=>{const s=e();return s.devMode||ULe.includes(n)||r==="free"||s.tier==="pro"?!0:s.tier==="premium"?i.some(o=>s.unlockedRegions.includes(o)):!1},canAccessPremiumFeatures:()=>{const n=e();return n.devMode||n.tier!=="free"}}),{name:"detectorapp-subscription",version:1}));No()(dh(t=>({parkingLocation:null,showParkingButton:!0,setParkingLocation:e=>t({parkingLocation:e}),clearParkingLocation:()=>t({parkingLocation:null}),setShowParkingButton:e=>t({showParkingButton:e})}),{name:"detectorapp-parking"}));function VJ(){return new Date().toISOString().split("T")[0]}No()(dh((t,e)=>({steps:0,distance:0,startTime:null,isActive:!1,todaySteps:0,todayDate:VJ(),stepLength:.75,incrementStep:()=>{const n=e(),r=VJ(),i=n.todayDate===r?n.todaySteps+1:1;t({steps:n.steps+1,distance:(n.steps+1)*n.stepLength,todaySteps:i,todayDate:r})},resetSession:()=>{t({steps:0,distance:0,startTime:null})},setActive:n=>{t({isActive:n,startTime:n?Date.now():e().startTime})},setStepLength:n=>{const r=e();t({stepLength:n,distance:r.steps*n})}}),{name:"step-counter-storage",partialize:t=>({todaySteps:t.todaySteps,todayDate:t.todayDate,stepLength:t.stepLength})}));const zJ={sunAzimuth:315,sunElevation:45,verticalExaggeration:2,colorRamp:"terrain",minElevation:-5,maxElevation:50,showControls:!1};No()(dh(t=>({...zJ,setSunAzimuth:e=>t({sunAzimuth:e}),setSunElevation:e=>t({sunElevation:e}),setVerticalExaggeration:e=>t({verticalExaggeration:e}),setColorRamp:e=>t({colorRamp:e}),setMinElevation:e=>t({minElevation:e}),setMaxElevation:e=>t({maxElevation:e}),setShowControls:e=>t({showControls:e}),resetToDefaults:()=>t(zJ)}),{name:"detectorapp-hillshade"}));const GLe=()=>Math.random().toString(36).substring(2,9),BLe={0:"Helder",1:"Overwegend helder",2:"Halfbewolkt",3:"Bewolkt",45:"Mist",48:"Rijp/mist",51:"Lichte motregen",53:"Motregen",55:"Dichte motregen",56:"Lichte ijzel",57:"Ijzel",61:"Lichte regen",63:"Regen",65:"Hevige regen",66:"Lichte ijsregen",67:"IJsregen",71:"Lichte sneeuw",73:"Sneeuw",75:"Hevige sneeuw",77:"Korrelsneeuw",80:"Lichte buien",81:"Buien",82:"Hevige buien",85:"Lichte sneeuwbuien",86:"Sneeuwbuien",95:"Onweer",96:"Onweer met hagel",99:"Zwaar onweer met hagel"};function WLe(t){const e=["N","NNO","NO","ONO","O","OZO","ZO","ZZO","Z","ZZW","ZW","WZW","W","WNW","NW","NNW"],n=Math.round(t/22.5)%16;return e[n]}const KS=No()(dh((t,e)=>({weatherData:null,isLoading:!1,error:null,savedLocations:[{id:"current",name:"Huidige locatie",lat:0,lon:0,isCurrentLocation:!0}],selectedLocationId:"current",weatherPanelOpen:!1,showBuienradar:!1,setWeatherData:n=>t({weatherData:n}),setIsLoading:n=>t({isLoading:n}),setError:n=>t({error:n}),addLocation:n=>t(r=>({savedLocations:[...r.savedLocations,{...n,id:GLe()}]})),removeLocation:n=>t(r=>({savedLocations:r.savedLocations.filter(i=>i.id!==n),selectedLocationId:r.selectedLocationId===n?"current":r.selectedLocationId})),setSelectedLocation:n=>t({selectedLocationId:n}),updateCurrentLocation:(n,r)=>t(i=>({savedLocations:i.savedLocations.map(s=>s.isCurrentLocation?{...s,lat:n,lon:r}:s)})),toggleWeatherPanel:()=>t(n=>({weatherPanelOpen:!n.weatherPanelOpen})),setWeatherPanelOpen:n=>t({weatherPanelOpen:n}),setShowBuienradar:n=>t({showBuienradar:n}),fetchWeather:async(n,r)=>{const{setIsLoading:i,setError:s,setWeatherData:o,savedLocations:a,selectedLocationId:l}=e();i(!0),s(null);try{const c=new URL("https://api.open-meteo.com/v1/forecast");c.searchParams.set("latitude",n.toString()),c.searchParams.set("longitude",r.toString()),c.searchParams.set("current","temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,wind_direction_10m,wind_gusts_10m,cloud_cover,is_day,snow_depth"),c.searchParams.set("hourly","temperature_2m,precipitation,precipitation_probability,weather_code,wind_speed_10m,wind_direction_10m,relative_humidity_2m"),c.searchParams.set("daily","weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max,wind_speed_10m_max,sunrise,sunset"),c.searchParams.set("minutely_15","precipitation"),c.searchParams.set("timezone","Europe/Amsterdam"),c.searchParams.set("forecast_days","7"),c.searchParams.set("past_days","7");const u=await fetch(c.toString());if(!u.ok)throw new Error("Kon weerdata niet ophalen");const h=await u.json();let f=0;const g=h.daily.temperature_2m_min||[],v=new Date().toISOString().split("T")[0],x=h.daily.time.indexOf(v);for(let O=x-1;O>=0&&g[O]<0;O--)f++;const b=a.find(O=>O.id===l)||a[0],T=new Date,A=[],I=[];if(h.minutely_15?.time&&h.minutely_15?.precipitation){const O=new Date(T.getTime()+72e5),F=new Date(T.getTime()+2880*60*1e3);for(let L=0;L<h.minutely_15.time.length;L++){const B=new Date(h.minutely_15.time[L]);B<T||(B<=O&&A.push({time:h.minutely_15.time[L],precipitation:h.minutely_15.precipitation[L]}),B<=F&&I.push({time:h.minutely_15.time[L],precipitation:h.minutely_15.precipitation[L]}))}}const R=T.getHours(),C=T.toISOString().split("T")[0],V=h.hourly.time.map((O,F)=>({time:O,temperature:h.hourly.temperature_2m[F],precipitation:h.hourly.precipitation[F],precipitationProbability:h.hourly.precipitation_probability[F],weatherCode:h.hourly.weather_code[F],windSpeed:h.hourly.wind_speed_10m[F],windDirection:h.hourly.wind_direction_10m[F],humidity:h.hourly.relative_humidity_2m[F]})).filter(O=>new Date(O.time)>=T).slice(0,24),M=h.daily.time.map((O,F)=>({date:O,temperatureMax:h.daily.temperature_2m_max[F],temperatureMin:h.daily.temperature_2m_min[F],precipitationSum:h.daily.precipitation_sum[F],precipitationProbability:h.daily.precipitation_probability_max[F],weatherCode:h.daily.weather_code[F],windSpeedMax:h.daily.wind_speed_10m_max[F],sunrise:h.daily.sunrise[F],sunset:h.daily.sunset[F]})).filter(O=>O.date>=C),N={location:{...b,lat:n,lon:r},current:{temperature:h.current.temperature_2m,apparentTemperature:h.current.apparent_temperature,humidity:h.current.relative_humidity_2m,precipitation:h.current.precipitation,weatherCode:h.current.weather_code,windSpeed:h.current.wind_speed_10m,windDirection:h.current.wind_direction_10m,windGusts:h.current.wind_gusts_10m,cloudCover:h.current.cloud_cover,isDay:h.current.is_day===1,snowDepth:h.current.snow_depth},hourly:V,daily:M,precipitation15min:A,precipitation48h:I,frostDays:f,lastUpdated:Date.now()};try{const O=new URL("https://air-quality-api.open-meteo.com/v1/air-quality");O.searchParams.set("latitude",n.toString()),O.searchParams.set("longitude",r.toString()),O.searchParams.set("current","grass_pollen,birch_pollen,alder_pollen,mugwort_pollen,ragweed_pollen,olive_pollen");const F=await fetch(O.toString());if(F.ok){const L=await F.json();if(L.current){const B=U=>Math.min(5,Math.round(U/20));N.pollen={grass:B(L.current.grass_pollen||0),birch:B(L.current.birch_pollen||0),alder:B(L.current.alder_pollen||0),mugwort:B(L.current.mugwort_pollen||0),ragweed:B(L.current.ragweed_pollen||0),olive:B(L.current.olive_pollen||0)}}}}catch{}o(N)}catch(c){s(c instanceof Error?c.message:"Onbekende fout")}finally{i(!1)}}}),{name:"detectorapp-weather",partialize:t=>({savedLocations:t.savedLocations,selectedLocationId:t.selectedLocationId,showBuienradar:t.showBuienradar})}));function HLe({target:t,viewOptions:e}){const n=X.useRef(null),r=X.useRef(null),i=es(o=>o.setMap),s=Nn(o=>o.showScaleBar);return X.useEffect(()=>{if(!n.current){const o={center:[5.1214,52.0907],zoom:8,rotation:0,minZoom:3,maxZoom:19,...e},a=new fPe({target:t,controls:[],view:new Qh({center:Pi(o.center),zoom:o.zoom,rotation:o.rotation,minZoom:o.minZoom,maxZoom:o.maxZoom})});n.current=a,i(a),window.__olMap=a}return()=>{n.current&&(n.current.setTarget(void 0),i(null),window.__olMap=null)}},[t,e,i]),X.useEffect(()=>{const o=n.current;o&&(s?r.current||(r.current=new gPe({units:"metric",bar:!1,text:!0,minWidth:80}),o.addControl(r.current)):r.current&&(o.removeControl(r.current),r.current=null))},[s]),n.current}function _(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s}function WTt(t,e){return function(n,r){e(n,r,t)}}function HTt(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function qTt(t,e,n){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),t.stack.push({value:e,dispose:r,async:n})}else n&&t.stack.push({async:!0});return e}var qLe=typeof SuppressedError=="function"?SuppressedError:function(t,e,n){var r=new Error(n);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};function KTt(t){function e(s){t.error=t.hasError?new qLe(s,t.error,"An error was suppressed during disposal."):s,t.hasError=!0}var n,r=0;function i(){for(;n=t.stack.pop();)try{if(!n.async&&r===1)return r=0,t.stack.push(n),Promise.resolve().then(i);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return r|=2,Promise.resolve(s).then(i,function(o){return e(o),i()})}else r|=1}catch(o){e(o)}if(r===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}let Km;const vo=globalThis;function ve(t){return typeof Km[t]=="function"?Km[t]=Km[t](vo):Km[t]}Km=vo.dojoConfig?.has||vo.esriConfig?.has?{...vo.dojoConfig?.has,...vo.esriConfig?.has}:{},ve.add=(t,e,n,r)=>{(r||Km[t]===void 0)&&(Km[t]=e),n&&ve(t)},ve.cache=Km,ve.add("big-integer-warning-enabled",!0),ve.add("esri-deprecation-warnings",!0),ve.add("esri-tests-disable-screenshots",!1),ve.add("esri-tests-use-full-window",!1),ve.add("esri-tests-post-to-influx",!0),ve.add("esri-cim-animations-enable-status","enabled"),ve.add("esri-cim-animations-spotlight",!1),ve.add("esri-cim-animations-freeze-time",!1),(()=>{ve.add("host-webworker",vo.WorkerGlobalScope!==void 0&&self instanceof vo.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ve.add("host-browser",t),ve.add("host-node",!(typeof vo.process!="object"||!vo.process.versions?.node||!vo.process.versions.v8)),ve.add("dom",t),ve("host-browser")){const e=navigator,n=e.userAgent,r=e.appVersion,i=parseFloat(r);if(ve.add("wp",parseFloat(n.split("Windows Phone")[1])||void 0),ve.add("msapp",parseFloat(n.split("MSAppHost/")[1])||void 0),ve.add("khtml",r.includes("Konqueror")?i:void 0),ve.add("edge",parseFloat(n.split("Edge/")[1])||void 0),ve.add("opr",parseFloat(n.split("OPR/")[1])||void 0),ve.add("webkit",!ve("wp")&&!ve("edge")&&parseFloat(n.split("WebKit/")[1])||void 0),ve.add("chrome",!ve("edge")&&!ve("opr")&&parseFloat(n.split("Chrome/")[1])||void 0),ve.add("android",!ve("wp")&&parseFloat(n.split("Android ")[1])||void 0),ve.add("safari",!r.includes("Safari")||ve("wp")||ve("chrome")||ve("android")||ve("edge")||ve("opr")?void 0:parseFloat(r.split("Version/")[1])),ve.add("mac",r.includes("Macintosh")),!ve("wp")&&/(iPhone|iPod|iPad)/.test(n)){const s=RegExp.$1.replace(/P/,"p"),o=/OS ([\d_]+)/.test(n)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replaceAll("_",""));ve.add(s,a),ve.add("ios",a)}ve("webkit")||(!n.includes("Gecko")||ve("wp")||ve("khtml")||ve("edge")||ve.add("mozilla",i),ve("mozilla")&&ve.add("ff",parseFloat(n.split("Firefox/")[1]||n.split("Minefield/")[1])||void 0))}})(),(()=>{if(vo.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),n=/iPhone/i.test(t);e&&ve.add("esri-mobile",e),n&&ve.add("esri-iPhone",n),ve.add("esri-geolocation",!!navigator.geolocation)}ve.add("esri-wasm","WebAssembly"in vo),ve.add("esri-performance-mode-frames-between-render",20),ve.add("esri-force-performance-mode",!1),ve.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in vo,e=vo.crossOriginIsolated===!1;return t&&!e}),ve.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ve.add("esri-atomics","Atomics"in vo),ve.add("esri-workers","Worker"in vo),ve.add("web-feat:cache","caches"in vo),ve.add("esri-workers-arraybuffer-transfer",!ve("safari")||Number(ve("safari"))>=12),ve.add("workers-pool-size",8),ve.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ve.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ve.add("featurelayer-fast-triangulation-enabled",!0),ve.add("featurelayer-animation-enabled",!0),ve.add("featurelayer-snapshot-enabled",!0),ve.add("featurelayer-snapshot-initial-tolerance",0),ve.add("featurelayer-snapshot-point-min-threshold",8e4),ve.add("featurelayer-snapshot-point-max-threshold",4e5),ve.add("featurelayer-snapshot-multipoint-min-threshold",2e4),ve.add("featurelayer-snapshot-multipoint-max-threshold",1e5),ve.add("featurelayer-snapshot-polygon-min-threshold",2e3),ve.add("featurelayer-snapshot-polygon-max-threshold",2e3),ve.add("featurelayer-snapshot-polyline-min-threshold",2e3),ve.add("featurelayer-snapshot-polyline-max-threshold",2e3),ve.add("featurelayer-snapshot-max-vertex-count",25e4),ve.add("featurelayer-snapshot-non-hosted-exceedslimit-enabled",!0),ve.add("featurelayer-snapshot-concurrency",4),ve.add("featurelayer-snapshot-coverage",.1),ve.add("featurelayer-query-max-depth",4),ve.add("featurelayer-query-pausing-enabled",!1),ve.add("featurelayer-query-tile-concurrency",4),ve.add("featurelayer-query-tile-max-features",6e5),ve.add("featurelayer-advanced-symbols",!1),ve.add("featurelayer-pbf",!0),ve.add("featurelayer-pbf-statistics",!1),ve.add("feature-layers-workers",!0),ve.add("feature-polyline-generalization-factor",1),ve.add("parquetlayer-full-query-feature-count",2e4),ve.add("parquetlayer-hittest-max-feature-count",1),ve.add("parquetlayer-persistence-enabled",!1),ve.add("mapview-transitions-duration",200),ve.add("mapview-essential-goto-duration",200),ve.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ve.add("mapserver-pbf-version-support",10.81),ve.add("mapservice-popup-identify-max-tolerance",20),ve.add("request-queue-concurrency-hosted",16),ve.add("request-queue-concurrency-non-hosted",4),ve.add("curve-densification-coarse-segments",128),ve.add("curve-densification-max-segments",2e3),ve.add("curve-densification-min-segments",3),ve.add("curve-densification-pixel-deviation",.5),ve.add("view-readyState-waiting-delay",1e3),ve.add("gradient-depth-bias",.01),ve.add("gradient-depth-epsilon",1e-8),ve.add("enable-feature:esri-compress-textures",!0),ve("host-webworker")||ve("host-browser")&&(ve.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ve.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function YTt(t){}function KLe(t){return()=>t}function XTt(t){return t}var il;let YLe=(il=class{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*il._m}getInt(){return this._seed=(il._a*this._seed+il._c)%il._m,this._seed}getFloat(){return this.getInt()/(il._m-1)}getIntRange(e,n){return Math.round(this.getFloatRange(e,n))}getFloatRange(e,n){const r=n-e;return e+this.getInt()/il._m*r}},il._m=2147483647,il._a=48271,il._c=0,il);const XLe=1.5,ZTt=1/XLe,JTt=.5;function Khe(t){return t}function ZLe(t,e=Khe){if(!t||t.length===0)return;let n=t[0],r=e(n);for(let i=1;i<t.length;++i){const s=t[i],o=Number(e(s));o>r&&(r=o,n=s)}return n}function QTt(t,e=Khe){return ZLe(t,n=>-e(n))}function ekt(t,e){return e?t.filter((n,r,i)=>i.findIndex(e.bind(null,n))===r):Array.from(new Set(t))}function JLe(t,e,n,r,i,s,o){if(t==null&&r==null)return!0;e=Math.max(0,e),i=Math.max(0,i),n=Math.max(0,n<0?(t?.length??0)+n:n),s=Math.max(0,s<0?(r?.length??0)+s:s);const a=n-e;if(t==null||r==null||a!==s-i)return!1;if(o){for(let l=0;l<a;l++)if(!o(t[e+l],r[i+l]))return!1}else for(let l=0;l<a;l++)if(t[e+l]!==r[i+l])return!1;return!0}function B5(t,e,n){return JLe(t,0,t?.length??0,e,0,e?.length??0,n)}function tkt(){return(t,e)=>{if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}}function UJ(t,e,n){let r,i;return n?(r=e.filter(s=>!t.some(o=>n(o,s))),i=t.filter(s=>!e.some(o=>n(o,s)))):(r=e.filter(s=>!t.includes(s)),i=t.filter(s=>!e.includes(s))),{added:r,removed:i}}function nkt(t){return t&&typeof t.length=="number"}function rkt(t,e){const n=t.length;if(n===0)return[];const r=[];for(let i=0;i<n;i+=e)r.push(t.slice(i,i+e));return r}let Yhe=class{constructor(){this.last=0}};const Xhe=new Yhe;function eF(t,e,n,r){r=r||Xhe;const i=Math.max(0,r.last-10);for(let o=i;o<n;++o)if(t[o]===e)return r.last=o,o;const s=Math.min(i,n);for(let o=0;o<s;++o)if(t[o]===e)return r.last=o,o;return-1}function tF(t,e,n,r){const i=t.length,s=eF(t,e,i,r);if(s!==-1)return t[s]=t[i-1],t.pop(),e}const Tu=new Set;function QLe(t,e,n=t.length,r=e.length,i,s){if(r===0||n===0)return n;Tu.clear();for(let a=0;a<r;++a)Tu.add(e[a]);i=i||Xhe;const o=Math.max(0,i.last-10);for(let a=o;a<n;++a)if(Tu.has(t[a])&&(s?.push(t[a]),Tu.delete(t[a]),t[a]=t[n-1],--n,--a,Tu.size===0||n===0))return Tu.clear(),n;for(let a=0;a<o;++a)if(Tu.has(t[a])&&(s?.push(t[a]),Tu.delete(t[a]),t[a]=t[n-1],--n,--a,Tu.size===0||n===0))return Tu.clear(),n;return Tu.clear(),n}function eDe(t,e){let n=0;for(let r=0;r<t.length;++r){const i=t[r];e(i,r)&&(t[n]=i,n++)}return t.length=n,t}function skt(t,e,n){const r=t.length;if(e>=r)return t.slice();const i=Zhe(n),s=new Set,o=[];for(;o.length<e;){const a=Math.floor(i()*r);s.has(a)||(s.add(a),o.push(t[a]))}return o}function Zhe(t){return t?(GJ.seed=t,()=>GJ.getFloat()):Math.random}const GJ=new YLe;function okt(t,e){if(!t)return t;const n=Zhe(e);for(let r=t.length-1;r>0;r--){const i=Math.floor(n()*(r+1)),s=t[r];t[r]=t[i],t[i]=s}return t}function Jhe(t,e){const n=t.indexOf(e);return n!==-1?(t.splice(n,1),e):null}function e2(t,e){return t!=null}const akt=[];function lkt(t){return t instanceof ArrayBuffer}function oG(t){return t?.constructor?.name==="Int8Array"}function Qhe(t){return t?.constructor?.name==="Uint8Array"}function ede(t){return t?.constructor?.name==="Uint8ClampedArray"}function aG(t){return t?.constructor?.name==="Int16Array"}function tde(t){return t?.constructor?.name==="Uint16Array"}function lG(t){return t?.constructor?.name==="Int32Array"}function nde(t){return t?.constructor?.name==="Uint32Array"}function tDe(t){return t?.constructor?.name==="Float16Array"}function W5(t){return t?.constructor?.name==="Float32Array"}function H5(t){return t?.constructor?.name==="Float64Array"}function nDe(t){return"buffer"in t}const rde=1024;function ckt(t){return H5(t)||W5(t)||lG(t)||aG(t)||oG(t)}function ukt(t){return H5(t)||W5(t)}function hkt(t){return H5(t)?179769e303:tDe(t)?65504:W5(t)?3402823e32:nde(t)?4294967295:tde(t)?65535:Qhe(t)||ede(t)?255:lG(t)?2147483647:aG(t)?32767:oG(t)?127:256}const dkt=-32768,fkt=-2147483648;function pkt(t){return t}function rDe(t,e){let n;for(n in t)t.hasOwnProperty(n)&&t[n]===void 0&&delete t[n];return t}function Ze(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=ode(t);if(e!=null)return e;if(YS(t))return t.clone();if(ide(t))return t.map(Ze);if(sde(t))throw new Error("Trying to clone an unclonable Accessor instance");const n={};for(const r of Object.getOwnPropertyNames(t))n[r]=Ze(t[r]);return n}function nF(t,e){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const n=ode(t);if(n!=null)return n;if(ide(t)){let i=!0;const s=t.map(o=>{const a=nF(o,e);return o!=null&&a==null&&(i=!1),a});return i?s:null}if(YS(t))return t.clone(e);if(t instanceof File||t instanceof Blob)return t;if(sde(t))return null;const r=new(Object.getPrototypeOf(t)).constructor;for(const i of Object.getOwnPropertyNames(t)){const s=t[i],o=nF(s);if(s!=null&&o==null)return null;r[i]=o}return r}function YS(t){return typeof t.clone=="function"}function ide(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function sde(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function BJ(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function ode(t){if(oG(t)||Qhe(t)||ede(t)||aG(t)||tde(t)||lG(t)||nde(t)||W5(t)||H5(t))return t.slice();if(t instanceof Date)return new Date(t);if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[n,r]of t)e.set(n,Ze(r));return e}if(t instanceof Set){const e=new Set;for(const n of t)e.add(Ze(n));return e}return null}function cG(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof t?.getTime=="function"&&typeof e?.getTime=="function"&&t.getTime()===e.getTime()||!1}function ade(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&B5(t,e):t instanceof Set?e instanceof Set&&sDe(t,e):t instanceof Map?e instanceof Map&&oDe(t,e):!!BJ(t)&&BJ(e)&&iDe(t,e))}function iDe(t,e){if(t===null||e===null)return!1;const n=Object.keys(t);if(e===null||Object.keys(e).length!==n.length)return!1;for(const r of n)if(t[r]!==e[r]||!Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function sDe(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function oDe(t,e){if(t.size!==e.size)return!1;for(const[n,r]of t){const i=e.get(n);if(i!==r||i===void 0&&!e.has(n))return!1}return!0}function aDe(t,e,n=!1){return cde(t,e,n)}function q5(t,e){if(e!=null)return e[t]||lde(t.split("."),!1,e)}function z2(t,e,n){const r=t.split("."),i=r.pop(),s=lde(r,!0,n);s&&i&&(s[i]=e)}function WJ(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const n=e;if(t.length!==n.length)return!0;for(let r=0;r<t.length;r++)if(WJ(t[r],n[r]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const n in t)if(WJ(t[n],e[n]))return!0;return!1}return t!==e}function lde(t,e,n){let r=n;for(const i of t){if(r==null)return;if(!(i in r)){if(!e)return;r[i]={}}r=r[i]}return r}function cde(t,e,n){return e?Object.keys(e).reduce((r,i)=>{if(i==="__proto__")return r;let s=r[i],o=e[i];return s===o?r:s===void 0?(r[i]=Ze(o),r):(Array.isArray(o)||Array.isArray(r)?(s=s?Array.isArray(s)?r[i]=s.slice():r[i]=[s]:r[i]=[],o&&(Array.isArray(o)||(o=[o]),n?o.forEach(a=>{s.includes(a)||s.push(a)}):r[i]=o.slice())):o&&typeof o=="object"?r[i]=cde(s,o,n):r.hasOwnProperty(i)&&!e.hasOwnProperty(i)||(r[i]=o),r)},t||{}):t}function mkt(t,e){for(const n of Object.entries(t))if(e===n[1])return n[0]}function K5(t,e){return Object.values(t).includes(e)}const Qn={apiKey:void 0,apiKeys:{scopes:[]},applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(aDe(Qn,globalThis.esriConfig,!0),delete Qn.has),!Qn.assetsPath){{const t="4.34";Qn.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Qn.defaultAssetsPath=Qn.assetsPath}const lDe=/\{([^}]+)\}/g;function HJ(t){return t??""}function ude(t,e){return e?t.replaceAll(lDe,typeof e=="object"?(n,r)=>HJ(q5(r,e)):(n,r)=>HJ(e(r))):t}function gkt(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,n=>e?.includes(n)?n:`\\${n}`)}function hde(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}let qJ;function ykt(t){return qJ??=new DOMParser,qJ.parseFromString(t||"","text/html").body.innerText||""}function vkt(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function _kt(t,...e){let n=t[0];for(let r=0;r<e.length;++r)n+=e[r]+t[r+1];return n}const KJ={info:0,warn:1,error:2,none:3};var os;let St=(os=class{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,os._loggers.set(this.module,this);const n=this.module.lastIndexOf(".");n!==-1&&(this._parent=os.getLogger(this.module.slice(0,n)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,os._loggers.get(e)||new os({module:e})}_log(e,n,...r){if(this._matchLevel(e)){if(n!=="always"&&!os._throttlingDisabled){const i=uDe(r),s=this._loggedMessages[e].get(i);if(n==="once"&&s!=null||n==="oncePerTick"&&s&&s>=os._tickCounter)return;this._loggedMessages[e].set(i,os._tickCounter),os._scheduleTickCounterIncrement()}for(const i of Qn.log.interceptors)if(i(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,n){let r=this;for(;r!=null;){const i=r[e];if(i!=null)return i;r=r.parent}return n}_inheritedWriter(){return this._parentWithMember("writer",cDe)}_matchLevel(e){const n=Qn.log.level||"warn";return KJ[this._parentWithMember("level",n)]<=KJ[e]}static _scheduleTickCounterIncrement(){os._tickCounterScheduled||(os._tickCounterScheduled=!0,Promise.resolve().then(()=>{os._tickCounter++,os._tickCounterScheduled=!1}))}},os._loggers=new Map,os._tickCounter=0,os._tickCounterScheduled=!1,os._throttlingDisabled=!1,os);function cDe(t,e,...n){console[t](`[${e}]`,...n)}function uDe(...t){return hde(JSON.stringify(t,(n,r)=>typeof r!="object"||Array.isArray(r)?r:"[Object]"))}function hDe(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(n,r)=>r===""?"$":(q5(r,e)??"").toString())}let dde=class{constructor(e,n,r=void 0){this.name=e,this.details=r,this.message=(n&&hDe(n,r))??""}toString(){return"["+this.name+"]: "+this.message}},Xe=class fde extends dde{constructor(e,n,r){super(e,n,r)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,n)=>{if(n&&typeof n=="object"&&typeof n.toJSON=="function")return n;try{return Ze(n)}catch{return"[object]"}}))}}catch(e){throw St.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new fde(e.name,e.message,e.details)}};Xe.prototype.type="error";function Z3(t){return t&&typeof t=="object"&&"toJSON"in t&&typeof t.toJSON=="function"}const dDe=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,fDe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function YJ(t){const e=t?.match(dDe);if(!e)return null;const[,n,r,i]=e;if(!n)return null;let s=null,o=null,a=null;const{devext:l,qaext:c,www:u}=fDe;if(r)if(s=n,i)switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=u);else switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function pde(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function mde(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,n=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,r=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):n.test(t)?t=t.replace(n,"https://devext.arcgis.com"):r.test(t)&&(t=t.replace(r,"https://qaext.arcgis.com")),t}function gde(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n.buffer}function pDe(t){const e=new Uint8Array(t);let n="";for(let r=0;r<e.length;r++)n+=String.fromCharCode(e[r]);return btoa(n)}const mDe=()=>St.getLogger("esri.core.urlUtils"),U2=Qn.request,XJ="esri/config: esriConfig.request.proxyUrl is not set.",yde=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,vde=/^\s*http:/i,gDe=/^\s*https:/i,yDe=/^\s*file:/i,_de=/:\d+$/,vDe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,_De=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),xDe=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Gx=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let n=this.uri.match(_De);this.scheme=n[2]||(n[1]?"":null),this.authority=n[4]||(n[3]?"":null),this.path=n[5],this.query=n[7]||(n[6]?"":null),this.fragment=n[9]||(n[8]?"":null),this.authority!=null&&(n=this.authority.match(xDe),this.user=n[3]||null,this.password=n[4]||null,this.host=n[6]||n[7],this.port=n[9]||null)}toString(){return this.uri}};const hP={},wDe=new Gx(Qn.applicationUrl);let ia=wDe;const bDe=EDe();let uG=bDe;const hG=()=>ia,bkt=()=>uG;function EDe(){const t=ia.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${ia.scheme}://${ia.host}${ia.port!=null?`:${ia.port}`:""}`}${e}`}function ja(t){if(!t)return null;const e={path:null,query:null},n=new Gx(t),r=t.indexOf("?");return n.query===null?e.path=t:(e.path=t.slice(0,r),e.query=dG(n.query)),n.fragment&&(e.hash=n.fragment,n.query===null&&(e.path=e.path.slice(0,e.path.length-(n.fragment.length+1)))),e}function dG(t){const e=t.split("&"),n={};for(const r of e){if(!r)continue;const i=r.indexOf("=");let s,o;i<0?(s=decodeURIComponent(r),o=""):(s=decodeURIComponent(r.slice(0,i)),o=decodeURIComponent(r.slice(i+1)));let a=n[s];typeof a=="string"&&(a=n[s]=[a]),Array.isArray(a)?a.push(o):n[s]=o}return n}function xk(t,e){return t?Object.keys(t).map(n=>{const r=t[n];if(r==null)return"";const i=encodeURIComponent(n)+"=";return Array.isArray(r)?r.map(s=>Z3(s)?i+encodeURIComponent(JSON.stringify(s)):i+encodeURIComponent(s)).join("&"):Z3(r)?i+encodeURIComponent(JSON.stringify(r)):i+encodeURIComponent(r)}).filter(n=>n).join("&"):""}function xde(t=!1){let e,n=U2.proxyUrl;if(typeof t=="string"){e=PDe(t);const r=Y5(t);r&&(n=r.proxyUrl)}else e=!!t;if(!n)throw mDe().warn(XJ),new Xe("urlUtils:proxy-not-set",XJ);return e&&iF()&&(n=yG(n)),ja(n)}function Ekt(t,e=!1){const n=Y5(t);let r,i;if(n){const s=fG(n.proxyUrl);r=s.path,i=s.query?dG(s.query):null}else if(e){const s=xde(t);r=s.path,i=s.query}if(r){const s=ja(t);t=r+"?"+s.path;const o=xk({...i,...s.query});o&&(t=`${t}?${o}`)}return t}const dE={path:"",query:""};function fG(t){const e=t.indexOf("?");return e!==-1?(dE.path=t.slice(0,e),dE.query=t.slice(e+1)):(dE.path=t,dE.query=null),dE}function wde(t){return t=(t=Q3(t=LDe(t=fG(t).path),!0)).toLowerCase()}function SDe(t){const e={proxyUrl:t.proxyUrl,urlPrefix:wde(t.urlPrefix)},n=U2.proxyRules,r=e.urlPrefix;let i=n.length;for(let s=0;s<n.length;s++){const o=n[s].urlPrefix;if(r.startsWith(o)){if(r.length===o.length)return-1;i=s;break}o.startsWith(r)&&(i=s+1)}return n.splice(i,0,e),i}function Y5(t){const e=U2.proxyRules,n=wde(t);for(let r=0;r<e.length;r++)if(n.startsWith(e[r].urlPrefix))return e[r]}function Skt(t,e){if(!t||!e)return!1;t=J3(t),e=J3(e);const n=YJ(t),r=YJ(e);return n!=null&&r!=null?n.portalHostname===r.portalHostname:n==null&&r==null&&I1(t,e,!0)}function TDe(t,e){return t=J3(t),e=J3(e),Q3(t)===Q3(e)}function J3(t){const e=(t=pg(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function rF(t,e=U2.interceptors){const n=r=>r instanceof RegExp?r.test(t):typeof r=="string"?t.startsWith(r):r==null;if(e){for(const r of e)if(Array.isArray(r.urls)){if(r.urls.some(n))return r}else if(n(r.urls))return r}return null}function I1(t,e,n=!1){if(!t||!e)return!1;const r=oF(t),i=oF(e);return!(!n&&r.scheme!==i.scheme)&&r.host!=null&&i.host!=null&&r.host.toLowerCase()===i.host.toLowerCase()&&r.port===i.port}function pG(t){if(typeof t=="string"){if(!yl(t))return!0;t=oF(t)}if(I1(t,ia))return!0;const e=U2.trustedServers||[];for(let n=0;n<e.length;n++){const r=kDe(e[n]);for(let i=0;i<r.length;i++)if(I1(t,r[i]))return!0}return!1}function kDe(t){return hP[t]||(gG(t)||Sd(t)?hP[t]=[new Gx(Bc(t))]:hP[t]=[new Gx(`http://${t}`),new Gx(`https://${t}`)]),hP[t]}function Bc(t,e=uG,n){return Sd(t)?n?.preserveProtocolRelative?t:ia.scheme==="http"&&ia.authority===sc(t).slice(2)?`http:${t}`:`https:${t}`:gG(t)?t:KA(t.startsWith("/")?ODe(e):e,t)}function mG(t,e=uG,n){if(t==null||!yl(t))return t;const r=pg(t),i=r.toLowerCase(),s=pg(e).toLowerCase().replace(/\/+$/,""),o=n?pg(n).toLowerCase().replace(/\/+$/,""):null;if(o&&!s.startsWith(o))return t;const a=(h,f,g)=>(g=h.indexOf(f,g))===-1?h.length:g;let l=a(i,"/",i.indexOf("//")+2),c=-1;for(;i.slice(0,l+1)===s.slice(0,l)+"/"&&(c=l+1,l!==i.length);)l=a(i,"/",l+1);if(c===-1||o&&c<o.length)return t;t=r.slice(c);const u=s.slice(c-1).replaceAll(/[^/]+/g,"").length;if(u>0)for(let h=0;h<u;h++)t=`../${t}`;else t=`./${t}`;return t}function pg(t){return t=jDe(t=$De(t=DDe(t=Bc(t=t.trim()))))}function KA(...t){const e=t.filter(e2);if(!e?.length)return;const n=[];if(yl(e[0])){const i=e[0],s=i.indexOf("//");s!==-1&&(n.push(i.slice(0,s+1)),CDe(e[0])&&(n[0]+="/"),e[0]=i.slice(s+2))}else e[0].startsWith("/")&&n.push("");const r=e.reduce((i,s)=>s?i.concat(s.split("/")):i,[]);for(let i=0;i<r.length;i++){const s=r[i];s===".."&&n.length>0&&n[n.length-1]!==".."?n.pop():(!s&&i===r.length-1||s&&(s!=="."||n.length===0))&&n.push(s)}return n.join("/")}function sc(t,e=!1){if(t==null||YA(t)||nv(t))return null;let n=t.indexOf("://");if(n===-1&&Sd(t))n=2;else{if(n===-1)return null;n+=3}const r=t.indexOf("/",n);return r!==-1&&(t=t.slice(0,r)),e&&(t=Q3(t,!0)),t}function yl(t){return Sd(t)||gG(t)}function YA(t){return t!=null&&t.startsWith("blob:")}function nv(t){return t!=null&&t.startsWith("data:")}function ADe(t){const e=t2(t);return e?.isBase64?gde(e.data):null}function Tkt(t){return pDe(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const IDe=/^data:(.*?)(;base64)?,(.*)$/;function t2(t){const e=t.match(IDe);if(!e)return null;const[,n,r,i]=e;return{mediaType:n,isBase64:!!r,data:i}}function bde(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function RDe(t){return(await fetch(t)).blob()}function kkt(t){const e=ADe(t);if(!e)return null;const n=t2(t);return new Blob([e],{type:n.mediaType})}function Sd(t){return t!=null&&t.startsWith("/")&&t[1]==="/"}function gG(t){return t!=null&&yde.test(t)}function PDe(t){return t!=null&&gDe.test(t)||ia.scheme==="https"&&Sd(t)}function MDe(t){return t!=null&&vde.test(t)||ia.scheme==="http"&&Sd(t)}function CDe(t){return t!=null&&yDe.test(t)}function yG(t){return Sd(t)?`https:${t}`:t.replace(vde,"https:")}function NDe(){return ia.scheme==="http"}function iF(){return ia.scheme==="https"}function Q3(t,e=!1){return Sd(t)?t.slice(2):(t=t.replace(yde,""),e&&t.length>1&&t.startsWith("/")&&t[1]==="/"&&(t=t.slice(2)),t)}function ODe(t){const e=t.indexOf("//"),n=t.indexOf("/",e+2);return n===-1?t:t.slice(0,n)}function Akt(t){let e=0;if(yl(t)){const r=t.indexOf("//");r!==-1&&(e=r+2)}const n=t.lastIndexOf("/");return n<e?t:t.slice(0,n+1)}function Ikt(t,e){if(!t)return"";const n=ja(t).path.replace(/\/+$/,""),r=n.slice(n.lastIndexOf("/")+1);if(!e?.length)return r;const i=new RegExp(`\\.(${e.join("|")})$`,"i");return r.replace(i,"")}function LDe(t){return t.endsWith("/")?t:`${t}/`}function Ede(t){return t.replace(/\/+$/,"")}function DDe(t){if(/^https?:\/\//i.test(t)){const e=fG(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function $De(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function jDe(t){const e=U2.httpsDomains;if(!MDe(t))return t;const n=t.indexOf("/",7);let r;if(r=n===-1?t:t.slice(0,n),r=r.toLowerCase().slice(7),_de.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","")}return NDe()&&r===ia.authority&&!vDe.test(t)||(iF()&&r===ia.authority||e&&e.some(i=>r===i||r.endsWith(`.${i}`))||iF()&&!Y5(t))&&(t=yG(t)),t}function sF(t,e,n){if(!(e&&n&&t&&yl(t)))return t;const r=t.indexOf("//"),i=t.indexOf("/",r+2),s=t.indexOf(":",r+2),o=Math.min(i<0?t.length:i,s<0?t.length:s);return t.slice(r+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,r+2)}${n}${t.slice(o)}`}function FDe(t,e){const n=new URL(t);return n.host=e,n.port&&!_de.test(e)&&(n.port=""),n.toString()}function Rkt(t){return new URL(t).host}function oF(t){return typeof t=="string"?new Gx(Bc(t)):(t.scheme||(t.scheme=ia.scheme),t)}function Pkt(t){return zDe.test(t)}function Sde(t,e){const n=ja(t),r=Object.keys(n.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),n.path}function VDe(t,e,n){const r=ja(t),i=r.query||{};return i[e]=String(n),`${r.path}?${xk(i)}`}function U6(t,e){if(!e)return t;const n=ja(t),r=n.query||{};for(const[s,o]of Object.entries(e))o!=null&&(r[s]=o);const i=xk(r);return i?`${n.path}?${i}`:n.path}function Tde(t){if(t==null)return null;const e=t.match(kde);return e?e[2]:null}function ZJ(t){if(t==null)return null;const e=t.match(kde);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function Mkt(t){return typeof t=="string"?t2(t)??{data:t}:new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(t2(r.result)),r.onerror=i=>n(i)})}const kde=/([^.]*)\.([^/]*)$/,zDe=/(^data:image\/svg|\.svg$)/i,Ade="20251114",Ide="ec088c999de2dac6fb9478a47da1bad775545540";Symbol.dispose??=Symbol("Symbol.dispose"),Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");const UDe="4.34";let Kr,vG=UDe;function Ckt(t){Kr=t}function Nkt(t){const e=Kr?.findCredential(t);return e?.token?VDe(t,"token",e.token):t}vG="4.34.8",ve("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),ve("host-webworker");function GDe(t,e){for(const n of t.values())if(e(n))return!0;return!1}function Okt(t,e){for(const n of t.values())if(!e(n))return!1;return!0}function Lkt(t,e){for(const n of t.values())if(e(n))return n;return null}function XA(t,e,n){const r=t.get(e);if(r!==void 0)return r;const i=n();return t.set(e,i),i}function Dkt(t){const e=new Map;return n=>(e.has(n)||e.set(n,t(n)),e.get(n))}const BDe={remove:()=>{}};function qn(t){return t?{remove(){t&&(t(),t=void 0)}}:BDe}function Rde(t){t.forEach(e=>e?.remove())}function $kt(t){Rde(t),t.length=0}function rv(t){return qn(()=>Rde(t))}function jkt(t){return qn(()=>t()?.remove())}function WDe(t){return qn(()=>t?.abort())}function Fkt(t){return qn(t!=null?()=>t.destroy():void 0)}function HDe(t){return typeof t=="object"&&!!t&&"remove"in t&&typeof t.remove=="function"}function Vkt(t){HDe(t)&&t.remove()}function zkt(t){return{[Symbol.dispose](){t.remove()}}}function qDe(t){return{setTimeout:(e,n)=>{const r=t.setTimeout(e,n);return qn(()=>t.clearTimeout(r))}}}const G2=qDe(globalThis);function X5(t){return KDe(t)||Pde(t)}function KDe(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function Pde(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function B2(t,e,n){if(!X5(t))throw new TypeError("target is not a Evented or EventTarget object");return Pde(t)?YDe(t,e,n):t.on(e,n)}function YDe(t,e,n,r){if(Array.isArray(e)){const i=e.slice();for(const s of i)t.addEventListener(s,n,r);return qn(()=>{for(const s of i)t.removeEventListener(s,n,r)})}return t.addEventListener(e,n,r),qn(()=>t.removeEventListener(e,n,r))}function Mde(t,e,n){if(!X5(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,n);const r=B2(t,e,i=>{r.remove(),n.call(t,i)});return r}function Cde(t,e){if(t==null)throw new Error(e??"value is None")}function Ci(t){return t?.destroy(),null}function Ukt(t){return t?.dispose(),null}function Qr(t){return t?.remove(),null}function R1(t){return t?.abort(),null}function Gkt(t){return t?.release(),null}function Bkt(t,e,n){return t!=null&&e!=null?n!=null?n(t,e):t.equals(e):t===e}function XDe(t,e){let n;return t.some((r,i)=>(n=e(r,i),n!=null)),n??void 0}function Tr(t="Aborted"){return new Xe("AbortError",t)}function hi(t,e="Aborted"){if(ha(t))throw Tr(e)}function ZA(t){return t instanceof AbortSignal?t:t?.signal??void 0}function ha(t){const e=ZA(t);return e!=null&&e.aborted}function Nde(t){if(ya(t))throw t}function JJ(t){if(!ya(t))throw t}function lu(t,e){const n=ZA(t);if(n!=null){if(!n.aborted)return Mde(n,"abort",()=>e());e()}}function _G(t,e){const n=ZA(t);if(n!=null)return hi(n),Mde(n,"abort",()=>e(Tr()))}function ZDe(t,e){return ZA(e)==null?t:new Promise((n,r)=>{let i=lu(e,()=>r(Tr()));const s=()=>{i=Qr(i)};t.then(s,s),t.then(n,r)})}function ya(t){return t?.name==="AbortError"}async function e4(t){try{return await t}catch(e){if(!ya(e))throw e;return}}async function xG(t){if(!t)return;if(typeof t.forEach!="function"){const n=Object.keys(t),r=n.map(o=>t[o]),i=await xG(r),s={};return n.map((o,a)=>s[o]=i[a]),s}const e=t;return Promise.allSettled(e).then(n=>Array.from(e,(r,i)=>{const s=n[i];return s.status==="fulfilled"?{promise:r,value:s.value}:{promise:r,error:s.reason}}))}async function JDe(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function Wkt(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function Ode(t,e=void 0,n){const r=new AbortController;return lu(n,()=>r.abort()),new Promise((i,s)=>{let o=setTimeout(()=>{o=0,i(e)},t);lu(r,()=>{o&&(clearTimeout(o),s(Tr()))})})}function Hkt(t,e,n,r){const i=n&&"abort"in n?n:null;r!=null||i||(r=n);let s=setTimeout(()=>{s=0,i?.abort()},e);const o=()=>r||new Xe("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(a=>{if(s===0)throw o();return clearTimeout(s),a},a=>{throw clearTimeout(s),s===0?o():a})}function QDe(t,e){const n=new AbortController,r=setTimeout(()=>n.abort(),e);return lu(t,()=>{n.abort(),clearTimeout(r)}),{...t,signal:n.signal}}function da(t){return t&&typeof t.then=="function"}function aF(t){return da(t)?t:Promise.resolve(t)}function e6e(t,e=-1){let n,r,i,s,o=null;const a=(...l)=>{if(n){r=l,s&&s.reject(Tr()),s=uc();const f=s.promise;if(o){const g=o;o=null,g.abort()}return f}if(i=s||uc(),s=null,e>0){const f=new AbortController;n=aF(t(...l,f.signal));const g=n;Ode(e).then(()=>{n===g&&(s?f.abort():o=f)})}else n=1,n=aF(t(...l));const c=()=>{const f=r;r=i=n=o=null,f!=null&&a(...f)},u=n,h=i;return u.then(c,c),u.then(h.resolve,h.reject),h.promise};return a}function uc(){let t,e;const n=new Promise((i,s)=>{t=i,e=s}),r=i=>{t(i)};return r.resolve=i=>t(i),r.reject=i=>e(i),r.timeout=(i,s)=>G2.setTimeout(()=>r.reject(s),i),r.promise=n,r}function qkt(t,e){e.then(t.resolve,t.reject)}async function QJ(t){await Promise.resolve(),hi(t)}function W2(t,e){const n=e?.url?.path;if(t&&n&&(t=Bc(t,n,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const r=mG(t,e.portalItem.itemUrl);r!=null&&r.startsWith(t6e)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(r).path)}return(t=lF(t,e?.portal))&&J5.test(t)?wG(t):t}function n2(t,e,n=0){if((t=t&&J5.test(t)?jde(t):t)==null)return t;!yl(t)&&e?.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let r=Bc(t);if(e){const i=e.verifyItemRelativeUrls?.rootPath||e.url?.path;if(i){const s=lF(i,e.portal),o=lF(r,e.portal);r=mG(o,s,s),r!=null&&r!==o&&r!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(r)}}return r=$de(r,e?.portal),yl(r)&&(r=pg(r)),e?.resources&&e?.portalItem&&!yl(r)&&!nv(r)&&n===0&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(r),compress:!1}),r}function Z5(t,e,n){return W2(t,n)}function r2(t,e,n,r){const i=n2(t,r);i!==void 0&&(e[n]=i)}const J5=/\/items\/([^/]+)\/resources\/(.*)/,t6e="./resources/";function Lde(t){return(t?.match(J5)??null)?.[1]??null}function Dde(t){const e=t?.match(J5)??null;if(e==null)return null;const n=e[2],r=n.lastIndexOf("/");if(r===-1){const{path:o,extension:a}=ZJ(n);return{prefix:null,filename:o,extension:a}}const{path:i,extension:s}=ZJ(n.slice(r+1));return{prefix:n.slice(0,r),filename:i,extension:s}}function $de(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?sF(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function lF(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const n=`${e.urlKey}.${e.customBaseUrl}`,r=hG();return I1(r,`${r.scheme}://${n}`)?sF(t,e.portalHostname,n):sF(t,n,e.portalHostname)}function wG(t){if(!t)return t||null;let e=t;return e&&Kr&&!Kr.findCredential(e)&&(e=mde(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function jde(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Kr&&!Kr.findCredential(e)&&(e=mde(e)),e}const n6e=Object.freeze(Object.defineProperty({__proto__:null,ensureMainOnlineDomain:$de,fromCDNUrl:jde,fromJSON:W2,itemIdFromResourceUrl:Lde,prefixAndFilenameFromResourceUrl:Dde,read:Z5,toCDNUrl:wG,toJSON:n2,write:r2},Symbol.toStringTag,{value:"Module"})),Fde={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},Vde=Object.values(Fde),zde=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${Vde.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),r6e=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${Vde.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),i6e=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function Kkt(t){return zde.test(t)}function JA(t){if(t==null)return null;const e=ja(t),n=e?.path.match(zde)||e?.path.match(r6e);if(!n)return null;const[,r,i,s,o]=n,a=i.indexOf("/");return{title:Ude(a!==-1?i.slice(a+1):i),serverType:Fde[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:r}}}function s6e(t){const e=ja(t).path.match(i6e);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function Ude(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function Ykt(t,e){const n=[];if(t){const r=JA(t);r!=null&&r.title&&n.push(r.title)}if(e){const r=Ude(e);n.push(r)}if(n.length===2){if(n[0].toLowerCase().includes(n[1].toLowerCase()))return n[0];if(n[1].toLowerCase().includes(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function eQ(t){let e=sc(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(e)))}function Xkt(t,e){return t&&Ede(Sde(t,e))}function Zkt(t){let{url:e}=t;if(!e)return{url:e};e=Sde(e,t.logger);const n=ja(e),r=JA(n.path);let i;if(r!=null)r.sublayer!=null&&t.layer.layerId==null&&(i=r.sublayer),e=r.url.path;else if(t.nonStandardUrlAllowed){const s=s6e(n.path);s!=null&&(e=s.serviceUrl,i=s.sublayerId)}return{url:Ede(e),layerId:i}}function Jkt(t,e,n,r,i){r2(e,r,"url",i),r.url&&t.layerId!=null&&(r.url=KA(r.url,n,t.layerId.toString()))}function Qkt(t){if(!t)return!1;const e=t.toLowerCase(),n=e.includes("/services/"),r=e.includes("/mapserver/wmsserver"),i=e.includes("/imageserver/wmsserver"),s=e.includes("/wmsserver");return n&&(r||i||s)}const o6e=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function bG(t){if(!EG(t))return null;const e=r=>r instanceof RegExp?r.test(t):typeof r=="string"&&t.startsWith(r),n=Qn.apiKeys;if(Array.isArray(n.scopes)){for(const r of n.scopes)if(Array.isArray(r.urls)){if(r.urls.some(e))return r.token}else if(e(r.urls))return r.token}return n.basemapStyles&&/^https?:\/\/(i?basemaps|basemapstyles)-api\.arcgis\.com\//i.test(t)?n.basemapStyles:Qn.apiKey&&/^https?:\/\/.+\.arcgis\.com(\/|$)/i.test(t)?Qn.apiKey:null}function cF(){return Qn.apiKey!=null||Qn.apiKeys.basemapStyles!=null}function a6e(t,e){return e?EG(t):bG(t)!=null}function EG(t){const e=sc(t,!0);return!!e&&!o6e.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function l6e(t,e,n=!1,r){return new Promise((i,s)=>{if(ha(r))return void s(tQ());let o=()=>{c(),s(new Error(`Unable to load ${e}`))},a=async()=>{const u=t;try{await u.decode()}catch{}c(),i(u)},l=()=>{if(!t)return;const u=t;c(),u.src="",s(tQ())};const c=()=>{t&&(t.removeEventListener("error",o),t.removeEventListener("load",a),o=null,a=null,t=null,r?.removeEventListener("abort",l),l=null,n&&URL.revokeObjectURL(e))};r?.addEventListener("abort",l),t.addEventListener("error",o),t.addEventListener("load",a)})}function tQ(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const Gde="Timeout exceeded";function c6e(){return new Error(Gde)}function eAt(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===Gde}function u6e(t){Qn.request.crossOriginNoCorsDomains||(Qn.request.crossOriginNoCorsDomains={});const e=Qn.request.crossOriginNoCorsDomains;for(let n of t)n=n.toLowerCase(),/^https?:\/\//.test(n)?e[sc(n)??""]=0:(e[sc("http://"+n)??""]=0,e[sc("https://"+n)??""]=0)}function h6e(t){const e=Qn.request.crossOriginNoCorsDomains;if(e){let n=sc(t);if(n)return n=n.toLowerCase(),!I1(n,hG())&&e[n]<Date.now()-36e5}return!1}async function d6e(t){const e=ja(t);t=e.path,e.query?.f==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const n=Qn.request.crossOriginNoCorsDomains,r=sc(t);n&&r&&(n[r.toLowerCase()]=Date.now())}const uF=new Map;function f6e(t,e){const n=e?.preferredHost;if(!n||I1(t,`https://${n}`,!0))return;const r=JA(t);if(!r||r.serverType!=="FeatureServer"||pde(t))return;const i=r.url.path.toLowerCase();uF.has(i)||uF.set(i,n)}function nQ(t){const e=JA(t)?.url.path.toLowerCase();if(!e)return t;const n=uF.get(e);return n?FDe(t,n):t}async function Ji(t,e){t instanceof URL&&(t=t.toString()),e?.query instanceof URLSearchParams&&(e.query=dG(e.query.toString().replaceAll("+"," ")));const n=nv(t),r=YA(t);r||n||(t=pg(t));const i={url:t,requestOptions:{...e}},s=g=>({data:g,getAllHeaders:i2,getHeader:i2,httpStatus:200,requestOptions:i.requestOptions,url:i.url}),o=rF(t,Vc.internalInterceptors);if(o){const g=await iQ(o,i);if(g!=null)return s(g)}let a=rF(t);if(a){const g=await iQ(a,i);if(g!=null)return s(g);a.after||a.error||(a=null)}if(t=i.url,(e=i.requestOptions).responseType==="image"&&(ve("host-webworker")||ve("host-node")))throw rh("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),i);if(e.method==="head"){if(e.body)throw rh("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),i);if(n||r)throw rh("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),i)}if(await v6e(),t4)return t4.execute(t,e);const l=new AbortController,c=lu(e,()=>l.abort()),u={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:i,redoRequest:!1,useIdentity:Vc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=e.useRequestQueue?E6e(u):dF(u),f=await h.finally(()=>c?.remove());return a?.after?.(f),f}let t4,Bde=!1;const Vc=Qn.request,Wde="FormData"in globalThis,p6e=new Set([499,498,403,401]),m6e=new Set(["COM_0056","COM_0057","SB_0008"]),g6e=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],i2=()=>null,n4=Symbol();function y6e(t){const e=sc(t);e&&!Ji._corsServers.includes(e)&&Ji._corsServers.push(e)}function rQ(t){const e=sc(t);return!e||e.endsWith(".arcgis.com")||Ji._corsServers.includes(e)||pG(e)}function rh(t,e,n,r){let i;const s={url:n.url,requestOptions:n.requestOptions,getAllHeaders:i2,getHeader:i2,ssl:!1};if(e instanceof Xe)return e.details?(e.details=Ze(e.details),e.details.url=n.url,e.details.requestOptions=n.requestOptions):e.details=s,e;if(e){const o=r&&(()=>Array.from(r.headers)),a=r&&(u=>r.headers.get(u)),l=r?.status,c=e.message;c&&(i=c),o&&a&&(s.getAllHeaders=o,s.getHeader=a),s.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,s.subCode=e.subcode,s.messageCode=e.messageCode,typeof e.details=="string"?(s.messages=[e.details],i??=e.details):(s.messages=e.details,i??=s.messages?.[0]),s.raw=n4 in e?e[n4]:e}return i??="Error",ya(e)?Tr():new Xe(t,i,s)}async function v6e(){ve("host-webworker")&&(!t4&&globalThis.invokeStaticMessage?t4=await xe(()=>import("./request-KAO9Yjzt.js"),[]):Bde=!0)}async function hF(){Kr||await xe(()=>import("./IdentityManager-AGDxIlwi.js"),__vite__mapDeps([85,86]))}async function _6e(t){const e=t.params.url,n=t.params.requestOptions,r=t.controller.signal,i=n.body;let s=null,o=null;if(Wde&&"HTMLFormElement"in globalThis&&(i instanceof FormData?s=i:i instanceof HTMLFormElement&&(s=new FormData(i))),typeof i=="string"&&(o=i),t.fetchOptions={cache:n.cacheBust?"no-cache":"default",credentials:"same-origin",headers:n.headers||{},keepalive:n.keepAlive??!1,method:n.method==="head"?"HEAD":"GET",mode:"cors",priority:Vc.priority,redirect:"follow",signal:r},(s||o)&&(t.fetchOptions.body=s||o),(Bde||n.authMode==="anonymous")&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||n.query?.token||s?.get("token")),!t.hasToken){const a=bG(e);a&&(n.query??={},n.query.token=a,t.hasToken=!0)}if(t.useIdentity&&!t.hasToken&&!t.credential&&!t.credentialToken&&!Hde(e)&&!ha(r)){let a;n.authMode==="immediate"?(await hF(),a=await Kr.getCredential(e,{signal:r})):n.authMode==="no-prompt"?(await hF(),a=await Kr.getCredential(e,{prompt:!1,signal:r}).catch(()=>{})):Kr&&(a=Kr.findCredential(e)),a&&(t.credential=a,t.credentialToken=a.token,t.useSSL=!!a.ssl)}}function Hde(t){return g6e.some(e=>e.test(t))}async function x6e(t){let e=t.params.url,n=nQ(e);const r=t.params.requestOptions,i=t.fetchOptions??{},s=YA(e)||nv(e),o=r.responseType||"json",a=s?0:r.timeout!=null?r.timeout:Vc.timeout;let l=!1;if(!s){t.useSSL&&(e=yG(e));let g={...r.query};t.credentialToken&&(g.token=t.credentialToken);let v=xk(g);ve("esri-url-encodes-apostrophe")&&(v=v.replaceAll("'","%27"));const x=n.length+1+v.length;let b;l=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||x>Vc.maxUrlLength;const T=r.useProxy||!!Y5(e);if(T){const A=xde(e);b=A.path,!l&&b.length+1+x>Vc.maxUrlLength&&(l=!0),A.query&&(g={...A.query,...g})}if(i.method==="HEAD"&&(l||T)){if(l)throw x>Vc.maxUrlLength?rh("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):rh("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(T)throw rh("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}l?(i.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?e=U6(e,g):(i.body=xk(g),i.headers||(i.headers={}),i.headers["Content-Type"]="application/x-www-form-urlencoded")):e=U6(e,g),T&&(t.useProxy=!0,e=`${b}?${e}`),g.token&&Wde&&i.body instanceof FormData&&!pde(e)&&i.body.set("token",g.token),r.hasOwnProperty("withCredentials")?t.withCredentials=r.withCredentials:I1(e,hG())||(pG(e)||Kr&&Kr.findServerInfo(e)?.webTierAuth)&&(t.withCredentials=!0),t.withCredentials&&(i.credentials="include",h6e(e)&&await d6e(l?U6(e,g):e)),n=nQ(e)}let c,u,h=0,f=!1;a>0&&(h=setTimeout(()=>{f=!0,t.controller.abort()},a));try{if(r.responseType==="native-request-init")u=i,u.url=n,r.signal?u.signal=r.signal:delete u.signal;else if(r.responseType!=="image"||i.cache!=="default"||i.keepalive||i.method!=="GET"||l||w6e(r.headers)||!s&&!t.useProxy&&Vc.proxyUrl&&!rQ(e)){if(Ji._beforeFetch&&await Ji._beforeFetch(e,i),c=await fetch(n,i),Ji._afterFetch&&await Ji._afterFetch(c),t.useProxy||y6e(e),r.responseType==="native")u=c;else if(i.method!=="HEAD")if(c.ok){switch(o){case"array-buffer":u=await c.arrayBuffer();break;case"blob":case"image":u=await c.blob();break;default:u=await c.text()}if(h&&(clearTimeout(h),h=0),o==="json"||o==="xml"||o==="document")if(u)switch(o){case"json":u=JSON.parse(u);break;case"xml":u=sQ(u,"application/xml");break;case"document":u=sQ(u,"text/html")}else u=null;if(u){if(o==="array-buffer"||o==="blob"){const g=c.headers.get("Content-Type");if(g&&/application\/json|text\/plain/i.test(g)&&u[o==="blob"?"size":"byteLength"]<=750)try{const v=await new Response(u).json();v.error&&(u=v)}catch{}}o==="image"&&u instanceof Blob&&(u=await oQ(URL.createObjectURL(u),t,!0))}}else{u=await c.text();try{u=JSON.parse(u)}catch{}}}else u=await oQ(n,t)}catch(g){if(g.name==="AbortError")throw f?c6e():Tr("Request canceled");if(!(!c&&g instanceof TypeError&&Vc.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||t.useProxy||rQ(e))throw g;t.redoRequest=!0,SDe({proxyUrl:Vc.proxyUrl,urlPrefix:sc(e)??""})}finally{h&&clearTimeout(h)}return[c,u]}async function iQ(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let n,r;try{r=await t.before(e)}catch(i){n=rh("request:interceptor",i,e)}if((r instanceof Error||r instanceof Xe)&&(n=rh("request:interceptor",r,e)),n)throw t.error&&t.error(n),n;return r}}function w6e(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function sQ(t,e){let n;try{n=new DOMParser().parseFromString(t,e)}catch{}if(!n||n.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return n}Ji._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],Ji._beforeFetch=void 0,Ji._afterFetch=void 0;const b6e=new Map;async function E6e(t){const e=T6e(t.params.url);if(!e)return dF(t);const{QueueProcessor:n}=await xe(()=>import("./QueueProcessor-DeAIYwRA.js"),[]);return XA(b6e,e.origin,()=>{const i=e.isHosted?ve("request-queue-concurrency-hosted"):ve("request-queue-concurrency-non-hosted");return new n({concurrency:i,process:s=>{if(ha(s.params.requestOptions))throw rh("",Tr("Request canceled"),s.params);return dF(s)}})}).push(t)}async function dF(t){let e,n;await _6e(t);try{do[e,n]=await x6e(t);while(!await S6e(t,e,n))}catch(s){const o=rh("request:server",s,t.params,e);throw o.details.ssl=t.useSSL,t.interceptor?.error&&t.interceptor.error(o),o}const r=t.params.url;if(n)if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(r)){if(!t.hasToken&&!t.credentialToken&&n.user?.username&&!pG(r)){const s=sc(r,!0);s&&Vc.trustedServers.push(s)}Array.isArray(n.authorizedCrossOriginNoCorsDomains)&&u6e(n.authorizedCrossOriginNoCorsDomains)}else(t.params.requestOptions.responseType||"json")==="json"&&f6e(r,n);const i=t.credential;if(i&&Kr){let o=Kr.findServerInfo(i.server)?.owningSystemUrl;if(o){o=o.replace(/\/?$/,"/sharing");const a=Kr.findCredential(o,i.userId);a&&Kr._getIdenticalSvcIdx(o,a)===-1&&a.resources.unshift(o)}}return{data:n,getAllHeaders:e?()=>Array.from(e.headers):i2,getHeader:e?s=>e.headers.get(s):i2,httpStatus:e?.status??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function S6e(t,e,n){if(t.redoRequest)return t.redoRequest=!1,!1;const r=t.params.requestOptions;if(!e||r.responseType==="native"||r.responseType==="native-request-init")return!0;let i,s;if(n&&(n.error&&typeof n.error=="object"?i=n.error:n.status==="error"&&Array.isArray(n.messages)&&(i={...n},i[n4]=n,i.details=n.messages)),!i&&!e.ok)throw i=new Error(`Unable to load ${e.url} status: ${e.status}`),i[n4]=n,i;let o,a=null;i&&(s=Number(i.code),a=i.hasOwnProperty("subcode")?Number(i.subcode):null,o=i.messageCode,o=o?.toUpperCase());const l=r.authMode;if(s===403&&(a===4||i.message?.toLowerCase().includes("ssl")&&!i.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||s===498)&&s!==void 0&&p6e.has(s)&&!Hde(t.params.url)&&(s!==403||(!o||!m6e.has(o))&&(a==null||a===2&&t.credentialToken))){await hF();try{const c=await Kr.getCredential(t.params.url,{error:rh("request:server",i,t.params),credential:t.credential,prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=c,t.credentialToken=c.token,t.useSSL=t.useSSL||c.ssl,!1}catch(c){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;i=c}}if(i)throw i;return!0}function oQ(t,e,n=!1){const r=e.controller.signal,i=new Image;return e.withCredentials?i.crossOrigin="use-credentials":i.crossOrigin="anonymous",i.alt="",i.fetchPriority=Vc.priority,i.src=t,l6e(i,t,n,r)}function T6e(t){let e,n;return typeof t=="string"?(e=sc(t,!0),n=eQ(t)):(e=t.origin,n=eQ(t.toString())),e==null?null:{origin:e,isHosted:n}}function k6e(t){return t?.release&&typeof t.release=="function"}function A6e(t){return t?.acquire&&typeof t.acquire=="function"}var xg;let H2=(xg=class{constructor(e,n,r,i=1,s=0){this._creator=e,this._acquireFunction=n,this._releaseFunction=r,this.allocationSize=i,this._pool=new Array(s),this._initialSize=s;for(let o=0;o<s;o++)this._pool[o]=this._creator();this.allocationSize=Math.max(i,1)}destroy(){this.prune(0)}acquire(...e){let n;if(xg.test.disabled)n=this._creator();else{if(this._pool.length===0){const r=this.allocationSize;for(let i=0;i<r;i++)this._pool[i]=this._creator()}n=this._pool.pop()}return this._acquireFunction?this._acquireFunction(n,...e):A6e(n)&&n.acquire(...e),n}release(e){e&&!xg.test.disabled&&(this._releaseFunction?this._releaseFunction(e):k6e(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let n=e;n<this._pool.length;++n){const r=this._pool[n];this._dispose(r)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}},xg.test={disabled:!!ve("esri-tests-disable-memory-pools")},xg);function I6e(t){t.length=0}let Aa=class{constructor(e=50,n=50){this._pool=new H2(()=>[],void 0,I6e,n,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return G6.acquire()}static release(e){return G6.release(e)}static prune(){G6.prune()}};const G6=new Aa(100),aQ=new WeakMap;function R6e(t,e,n=!1){const r=` DEPRECATED - ${e}`;if(!n)return void t.warn(r);let i=aQ.get(t);i||(i=new Set,aQ.set(t,i)),i.has(e)||(i.add(e),t.warn(r))}const r4="https://www.esriurl.com/";function P6e(t,e,n,r={}){ve("esri-deprecation-warnings")&&Pg(t,`This widget is deprecated. Use the ${e} component instead.`,{see:[`${e} component reference: ${r4}${n}/`,`Esri's move to web components: ${r4}components-transition-plan/`],replacement:`<${n}></${n}>`,warnOnce:!0,...r})}function M6e(t,e,n,r={}){ve("esri-deprecation-warnings")&&Pg(t,`This view model is deprecated. Use the ${e} component directly instead.`,{see:[`${e} component reference: ${r4}${n}/`,`Esri's move to web components: ${r4}components-transition-plan/`],replacement:`<${n}></${n}>`,warnOnce:!0,...r})}function nAt(t,e,n={}){ve("esri-deprecation-warnings")&&Pg(t,`Module: ${e}`,n)}function qde(t,e,n={}){if(ve("esri-deprecation-warnings")){const{moduleName:r}=n;Pg(t,`Function: ${(r?r+"::":"")+e+"()"}`,n)}}function fF(t,e,n={}){if(ve("esri-deprecation-warnings")){const{moduleName:r}=n;Pg(t,`Property: ${(r?r+"::":"")+e}`,n)}}function C6e(t,e,n={}){ve("esri-deprecation-warnings")&&Pg(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...n})}function Pg(t,e,n={}){if(ve("esri-deprecation-warnings")){const{replacement:r,version:i,see:s,warnOnce:o}=n;let a=e;if(r&&(a+=`
	 Replacement: ${r}`),i&&(a+=`
	 Version: ${i}`),s)if(Array.isArray(s)){a+=`
	 See for more details:`;for(const l of s)a+=`
		${l}`}else a+=`
	 See ${s} for more details.`;R6e(t,a,o)}}function rAt(t){const e=[];return function*(){yield*e;let n,r=e.length;for(;!(n=t.next()).done;)for(e.push(n.value),yield n.value;++r<e.length;)yield e[r]}}function N6e(t,e){for(const n of t)if(n!=null&&e(n))return n}function i4(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let q2=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(n=>{e+=n.length}),e}add(e,n){if(i4(e)){const r=this._getOrCreateGroup(n);for(const i of e)cQ(i)&&r.push(i)}else cQ(e)&&this._getOrCreateGroup(n).push(e);return this}forEach(e,n){if(typeof e=="function")this._groups.forEach(r=>r.forEach(e));else{const r=this._getGroup(e);r&&n&&r.forEach(n)}}has(e){return this._groups.has(dP(e))}remove(e){if(typeof e!="string"&&i4(e)){for(const n of e)this.remove(n);return this}return this.has(e)?(lQ(this._getGroup(e)),this._groups.delete(dP(e)),this):this}removeAll(){return this._groups.forEach(lQ),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const n=[];return this._groups.set(dP(e),n),n}_getGroup(e){return this._groups.get(dP(e))}};function dP(t){return t||"_default_"}function lQ(t){for(const e of t)e instanceof q2?e.removeAll():e.remove()}function cQ(t){return t!=null&&(!!t.remove||t instanceof q2)}const Kde=Symbol("Accessor-beforeDestroy");function Mg(t){return t.__accessor__??null}function O6e(t,e){return t?.metadata?.[e]!=null}function jM(t,e,n){return n?s4(t,e,{policy:n,path:""}):s4(t,e,null)}function s4(t,e,n){return e?Object.keys(e).reduce((r,i)=>{const s=i;if(s==="__proto__")return r;let o=null,a="merge";if(n&&(o=n.path?`${n.path}.${i}`:i,a=n.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(r[s]))return r[s]=e[s],r;if(r[s]===void 0)return r[s]=Ze(e[s]),r;let l=r[s],c=e[s];if(l===c)return r;if(Array.isArray(c)||Array.isArray(r))l=l?Array.isArray(l)?r[s]=l.slice():r[s]=[l]:r[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(u=>{l.includes(u)||l.push(u)}));else if(c&&typeof c=="object")if(n){const u=n.path;n.path=o,r[s]=s4(l,c,n),n.path=u}else r[s]=s4(l,c,null);else r.hasOwnProperty(i)&&!e.hasOwnProperty(i)||(r[s]=c);return r},t||{}):t}function Yde(t){return Array.isArray(t)?t:t.split(".")}function uQ(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function L6e(t){if(Array.isArray(t)){const e=[];for(const n of t)e.push(...uQ(n));return e}return uQ(t)}function Xde(t,e,n,r){const i=L6e(e);if(i.length!==1){const s=i.map(o=>r(t,o,n));return rv(s)}return r(t,i[0],n)}function Zde(t,e){const n=t.endsWith("?")?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const i=parseInt(n,10);if(!isNaN(i))return Array.isArray(e)?e[i]:e.at(i)}const r=Mg(e);return O6e(r,n)?r.get(n):e[n]}function Jde(t,e,n){if(t==null)return t;const r=Zde(e[n],t);return!r&&n<e.length-1?void 0:n===e.length-1?r:Jde(r,e,n+1)}function QA(t,e,n=0){return typeof e!="string"||e.includes(".")?Jde(t,Yde(e),n):Zde(e,t)}function od(t,e){return QA(t,e)}function hQ(t,e){return QA(e,t)!==void 0}const Xl={INITIALIZING:0,CONSTRUCTING:1,CONSTRUCTED:2,DESTROYING:3,DESTROYED:4};function K2(t){let e=t.constructor.__accessorMetadata__;const n=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!n){e=Object.create(e);for(const r in e)e[r]=Ze(e[r]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function eI(t,e){const n=K2(t);let r=n[e];return r||(r=n[e]={}),r}function D6e(t,e){return jM(t,e,j6e)}const $6e=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function j6e(t){return $6e.test(t)?"replace":"merge"}let F6e=class{constructor(e,n){this._observers=e,this._observer=n}remove(){Jhe(this._observers,this._observer)}},Qde=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return V6e;this._observers==null&&(this._observers=[]);const n=this._observers;let r=!1,i=!1;const s=n.length;for(let o=0;o<s;++o){const a=n[o];if(a.destroyed)i=!0;else if(a===e){r=!0;break}}return r||(n.push(e),i&&this._removeDestroyedObservers()),new F6e(n,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const n=e.length;let r=0;for(let i=0;i<n;++i){for(;i+r<n&&e[i+r].destroyed;)++r;if(r>0){if(!(i+r<n))break;e[i]=e[i+r]}}e.length=n-r}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const n of e)n.onCommitted();this._observers=null}}};const V6e=qn(),ci={Dirty:1,Overridden:2,Computing:4,NonNullable:8,HasDefaultValue:16,DepTrackingInitialized:32,AutoTracked:64,ExplicitlyTracking:128};let Q5=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){this.accessed?.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const o4=new Q5,KE=[];let XS=o4;function tn(t){XS.onAccessed(t)}let FM=!1,VM=!1;function ap(t,e,n){if(FM)return SG(t,e,n);let r=null;return efe(t),r=e.call(n),tfe(),r}function z6e(t,e){return ap(o4,t,e)}function SG(t,e,n){const r=FM;FM=!0,efe(t);let i=null;try{i=e.call(n)}catch(s){VM&&St.getLogger("esri.core.accessorSupport.tracking").error(s)}return tfe(),FM=r,i}function efe(t){XS=t,KE.push(t)}function tfe(){const t=KE.length;if(t>1){const e=KE.pop();XS=KE[t-2],e.onTrackingEnd()}else if(t===1){const e=KE.pop();XS=o4,e.onTrackingEnd()}else XS=o4}function nfe(t,e){if(e.flags&ci.DepTrackingInitialized)return;e.flags|=ci.DepTrackingInitialized;const n=VM;VM=!1,e.flags&ci.AutoTracked?SG(e.trackingTarget,e.metadata.get,t):rfe(t,e),VM=n}const U6e=[];function rfe(t,e){e.flags&ci.ExplicitlyTracking||(e.flags|=ci.ExplicitlyTracking,SG(e.trackingTarget,()=>{const n=e.metadata.dependsOn||U6e;for(const r of n)if(typeof r!="string"||r.includes(".")){const i=Yde(r);for(let s=0,o=t;s<i.length&&o!=null&&typeof o=="object";++s)o=dQ(o,i[s],s!==i.length-1)}else dQ(t,r,!1)}),e.flags&=-129)}function dQ(t,e,n){const r=e.endsWith("?")?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const s=parseInt(r,10);if(!isNaN(s))return Array.isArray(t)?t[s]:t.at(s)}const i=Mg(t);if(i){const s=i.propertiesByName.get(r);s&&(tn(s),nfe(t,s))}return n?t[r]:void 0}let fQ=class extends Qde{constructor(e,n){super(),this.propertyName=e,this.metadata=n,this.trackingTarget=new Q5(this),this.flags=0,this.flags=ci.Dirty|(n.nonNullable?ci.NonNullable:0)|(n.hasOwnProperty("value")?ci.HasDefaultValue:0)|(n.get===void 0?ci.DepTrackingInitialized:0)|(n.dependsOn===void 0?ci.AutoTracked:0)}destroy(){this.flags&ci.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&tn(this);const n=e.store,r=this.propertyName,i=this.flags,s=n.get(r);if(i&ci.Computing||~i&ci.Dirty&&n.has(r))return s;this.flags|=ci.Computing;const o=e.host;let a;i&ci.AutoTracked?a=ap(this.trackingTarget,this.metadata.get,o):(rfe(o,this),a=this.metadata.get.call(o)),this.flags|=ci.DepTrackingInitialized,n.set(r,a,1);const l=n.get(r);return l===s?this.flags&=-2:z6e(this.commit,this),this.flags&=-5,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onInvalidated(){~this.flags&ci.Overridden&&(this.flags|=ci.Dirty);const e=this._observers;if(e&&e.length>0)for(const n of e)n.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const n=e.slice();for(const r of n)r.onCommitted()}}};const cAt=8;function TG(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"link-chart":return 6;case"user":return 7;default:return null}}function pF(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"link-chart";case 7:return"user"}}function G6e(t){return pF(t)}let B6e=class ife{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const n=new ife;return this._values.forEach((r,i)=>{e&&e.has(i)||n.set(i,Ze(r))}),n}get(e){return this._values.get(e)}originOf(){return 7}keys(){return[...this._values.keys()]}set(e,n){this._values.set(e,n)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}isAtOrigin(e,n){return this.has(e)}isBelowOrigin(e,n){return!this.has(e)}forEach(e){this._values.forEach(e)}};function c_(t,e,n){return t!==void 0}function pQ(t,e,n,r){return t!==void 0&&(!(n==null&&t.flags&ci.NonNullable)||(r.lifecycle,!1))}let W6e=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=Xl.INITIALIZING,this.store=new B6e,this.mutable=!0,this._origin=7;const n=this.host.constructor.__accessorMetadata__;for(const r in n){const i=new fQ(r,n[r]);this.propertiesByName.set(r,i)}this.metadata=n}initialize(){this.lifecycle=Xl.CONSTRUCTING}constructed(){this.lifecycle=Xl.CONSTRUCTED}destroy(){this.lifecycle=Xl.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==Xl.INITIALIZING}get(e){const n=this.propertiesByName.get(e);if(!c_(n))return;if(n.metadata.get)return n.getComputed(this);this.mutable&&tn(n);const r=this.store;return r.has(e)?r.get(e):n.metadata.value}originOf(e){const n=this.store.originOf(e);if(n===void 0){const r=this.propertiesByName.get(e);if(r!==void 0&&r.flags&ci.HasDefaultValue)return"defaults"}return pF(n)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const n=this.propertiesByName.get(e);if(c_(n))return this.store.has(e)?this.store.get(e):n.metadata.value}internalSet(e,n){const r=this.propertiesByName.get(e);c_(r)&&this._internalSet(r,n)}getDependsInfo(e,n,r){const i=this.propertiesByName.get(n);if(!c_(i))return"";const s=new Q5,o=ap(s,()=>i.metadata.get?.call(e));let a=`${r}${e.declaredClass.split(".").pop()}.${n}: ${o}
`;const l=s.accessed??new Set;if(l.size===0)return a;r+="  ";for(const c of l)c instanceof fQ&&(a+=`${r}${c.propertyName}: undefined
`);return a}setAtOrigin(e,n,r){const i=this.propertiesByName.get(e);if(c_(i))return this._setAtOrigin(i,n,r)}isOverridden(e){const n=this.propertiesByName.get(e);return n!==void 0&&!!(n.flags&ci.Overridden)}clearOrigin(e,n){const r=this.store,i=this.propertiesByName.get(e);if(!c_(i))return;const s=r.isAtOrigin(e,n)&&!(i.flags&ci.Overridden);r.delete(e,n),s&&i.notifyChange()}clearOverride(e){const n=this.propertiesByName.get(e);n&&n.flags&ci.Overridden&&(n.flags&=-3,n.notifyChange())}override(e,n){const r=this.propertiesByName.get(e);if(!pQ(r,e,n,this))return;const i=r.metadata.cast;if(i){const s=this._cast(i,n),{valid:o,value:a}=s;if(B6.release(s),!o)return;n=a}r.flags|=ci.Overridden,this._internalSet(r,n)}set(e,n){const r=this.propertiesByName.get(e);if(!pQ(r,e,n,this))return;const i=r.metadata.cast;if(i){const o=this._cast(i,n),{valid:a,value:l}=o;if(B6.release(o),!a)return;n=l}const s=r.metadata.set;s?s.call(this.host,n):this._internalSet(r,n)}setDefaultOrigin(e){this._origin=TG(e)}getDefaultOrigin(){return pF(this._origin)}notifyChange(e){const n=this.propertiesByName.get(e);n!==void 0&&n.notifyChange()}invalidate(e){const n=this.propertiesByName.get(e);n!==void 0&&n.invalidate()}commit(e){const n=this.propertiesByName.get(e);n!==void 0&&n.commit()}_internalSet(e,n){const r=this.lifecycle!==Xl.INITIALIZING?this._origin:0;this._setAtOrigin(e,n,r)}_setAtOrigin(e,n,r){const i=this.store,s=e.propertyName;if(i.isAtOrigin(s,r)&&cG(n,i.get(s))&&~e.flags&ci.Overridden)return;const o=i.isBelowOrigin(s,r)||i.isAtOrigin(s,r);o&&e.invalidate(),i.set(s,n,r),o&&e.commit(),nfe(this.host,e)}_cast(e,n){const r=B6.acquire();return r.valid=!0,r.value=n,e&&(r.value=e.call(this.host,n,r)),r}},H6e=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const B6=new H2(()=>new H6e);function a4(t,e,n){if(t&&e)if(typeof e=="object")for(const r of Object.getOwnPropertyNames(e))a4(t,r,e[r]);else{if(e.includes(".")){const i=e.split("."),s=i.splice(-1,1)[0];return void a4(od(t,i),s,n)}const r=t.__accessor__;r!=null&&q6e(e,r),t[e]=n}}function q6e(t,e){if(ve("esri-unknown-property-errors")&&!K6e(t,e))throw new Xe("set:unknown-property",Y6e(t,e))}function K6e(t,e){return e.metadata[t]!=null}function Y6e(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}let X6e;function Z6e(){return X6e}let sfe=class extends H2{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const n=super.acquire(...e);return this._set.delete(n),n}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const fP=[];function l4(t){fP.push(t),fP.length===1&&queueMicrotask(()=>{const e=fP.slice();fP.length=0;for(const n of e)n()})}let ZS=class{constructor(e,n=30){this.name=e,this._counter=0,this._samples=new Array(n)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,n)=>e-n)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,n)=>e+n,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};const c4=(t,e,n,r)=>{let i=e,s=e;const o=n>>>1,a=t[i-1];for(;s<=o;){s=i<<1,s<n&&r(t[s-1],t[s])<0&&++s;const l=t[s-1];if(r(l,a)<=0)break;t[i-1]=l,i=s}t[i-1]=a},ofe=(t,e)=>t<e?-1:t>e?1:0;function J6e(t,e,n,r){n===void 0&&(n=t.length),r===void 0&&(r=ofe);for(let s=n>>>1;s>e;s--)c4(t,s,n,r);const i=e+1;for(let s=n-1;s>e;s--){const o=t[e];t[e]=t[s],t[s]=o,c4(t,i,s,r)}}function*Q6e(t,e,n,r){n===void 0&&(n=t.length),r===void 0&&(r=ofe);for(let s=n>>>1;s>e;s--)c4(t,s,n,r),yield;const i=e+1;for(let s=n-1;s>e;s--){const o=t[e];t[e]=t[s],t[s]=o,c4(t,i,s,r),yield}}const e$e=1.5,t$e=1.1;let afe=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Yhe,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>mQ(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const n=new Array;for(let r=0;r<this._length;r++){const i=this.data[r];e(i)&&n.push(i)}return n}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,n){const r=this.data.indexOf(e,n);return r!==-1&&r<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let n=e;n<this._length;++n)this.data[n]=this._deallocator(this.data[n]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,n=e.length){for(let r=0;r<n;r++)this.data[this._length++]=e[r]}fill(e,n){for(let r=0;r<n;r++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,mQ(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const n=eF(this.data,e,this.length,this._hint);if(n!==-1)return this.data.splice(n,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(eF(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,n=e.length,r){this.length=QLe(this.data,e,this.length,n,this._hint,r),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,n){if(e>=this.length||n>=this.length||e===n)return;const r=this.data[e];this.data[e]=this.data[n],this.data[n]=r}sort(e){J6e(this.data,0,this.length,e)}iterableSort(e){return Q6e(this.data,0,this.length,e)}some(e,n){for(let r=0;r<this.length;++r)if(e.call(n,this.data[r],r,this.data))return!0;return!1}find(e,n){const{data:r,length:i}=this;for(let s=0;s<i;++s)if(e.call(n,r[s]))return r[s]}filterInPlace(e,n){let r=0;for(let i=0;i<this._length;++i){const s=this.data[i];e.call(n,s,i,this.data)&&(this.data[i]=this.data[r],this.data[r]=s,r++)}if(this._deallocator)for(let i=r;i<this._length;i++)this.data[i]=this._deallocator(this.data[i]);return this._length=r,this._shrink(),this}forAll(e,n){const{data:r,length:i}=this;for(let s=0;s<i;++s)e.call(n,r[s],s,r)}forEach(e,n){this.data.slice(0,this.length).forEach(e,n)}map(e,n){const r=new Array(this.length);for(let i=0;i<this.length;++i)r[i]=e.call(n,this.data[i],i,this.data);return r}reduce(e,n){let r=n;for(let i=0;i<this.length;++i)r=e(r,this.data[i],i,this.data);return r}has(e){const n=this.length,r=this.data;for(let i=0;i<n;++i)if(r[i]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function mQ(t){t.data.length>e$e*t.length&&(t.data.length=Math.floor(t.length*t$e))}function mAt(t){return t}function n$e(t){return 1e3*t}function gAt(t){return t}function yAt(t){return .001*t}let r$e=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},i$e=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},mF=0;const fE={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},gF=["prepare","preRender","render","postRender","update","finish"],yF=[],P1=new afe;let s$e=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,lfe()}};function o$e(){qy!=null&&(cancelAnimationFrame(qy),qy=requestAnimationFrame(kG))}function lfe(){qy==null&&(mF=performance.now(),qy=requestAnimationFrame(kG))}const u4={frameTasks:P1,willDispatch:!1,clearFrameTasks:a$e,dispatch:ufe,executeFrameTasks:l$e,reschedule:o$e};function Y2(t){const e=new i$e(t);return yF.push(e),u4.willDispatch||(u4.willDispatch=!0,l4(ufe)),e}function s2(t){const e=new r$e(t);return P1.push(e),lfe(),new s$e(e)}let qy=null;function a$e(t=!1){P1.forAll(e=>{e.removed=!0}),t&&cfe()}function kG(){const t=performance.now();qy=null,qy=P1.some(n=>!n.paused&&!n.removed)?requestAnimationFrame(kG):null,u4.executeFrameTasks(t)}function l$e(t){const e=t-mF;mF=t;const n=1e3/60,r=Math.max(0,e-n);fE.time=t,fE.frameDuration=n-r;for(let i=0;i<gF.length;i++){const s=performance.now(),o=gF[i];P1.forAll(a=>{a.paused||a.removed||(i===0&&a.ticks++,a.phases[o]&&(fE.elapsedFrameTime=performance.now()-t,fE.deltaTime=a.ticks===0?0:e,a.phases[o]?.call(a,fE)))}),d$e[i].push(performance.now()-s)}cfe(),f$e.push(performance.now()-t)}const pP=new afe;function cfe(){P1.forAll(t=>{t.removed&&pP.push(t)}),P1.removeUnorderedMany(pP.data,pP.length),pP.clear()}function ufe(){for(;yF.length;){const t=yF.shift();t.isActive&&t.callback()}u4.willDispatch=!1}function c$e(t=1,e){const n=uc(),r=()=>{ha(e)?n.reject(Tr()):t===0?n():(--t,l4(()=>r()))};return r(),n.promise}function u$e(t){return c$e(1,t)}async function h$e(t){await u$e(t),await new Promise(e=>requestAnimationFrame(()=>{t?.aborted||e()}))}const d$e=gF.map(t=>new ZS(t)),f$e=new ZS("total");function hfe(t,e){for(const n of t.values())if(e(n))return!0;return!1}function gQ(t,e){if(!e)return t;for(const n of e)n!=null&&t.add(n);return t}function wAt(t,e){return e!=null&&t.add(e),t}function AG(t,e){const n=new Set;return gQ(n,t),gQ(n,e),n}function p$e(t,e){const n=new Set;for(const r of e)t.has(r)&&n.add(r);return n}function bAt(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const n of t)if(!e.has(n))return!1;return!0}function EAt(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function m$e(t,e){const n=new Set(t);for(const r of e)n.delete(r);return n}function g$e(t,e){return m$e(AG(t,e),p$e(t,e))}let y$e=0;function zM(){return++y$e}let eO=class extends Q5{constructor(e){super(new v$e(e)),this._observer&&yQ.register(this,new WeakRef(this._observer),this)}destroy(){this._observer&&yQ.unregister(this._observer),this.accessed?.clear(),this.clear(),this._observer?.destroy()}},v$e=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=_$e}};const yQ=new FinalizationRegistry(t=>{t.deref()?.destroy()});function _$e(){}let Bx=!1;const h4=[];function dfe(t,e){let n=new eO(s),r=null,i=!1;function s(){if(!n||i)return;if(Bx)return void pfe(s);const a=r;n.clear(),Bx=!0,i=!0,r=ap(n,t),i=!1,Bx=!1,e(r,a),mfe()}function o(){n&&(n.destroy(),n=null,r=null)}return i=!0,r=ap(n,t),i=!1,qn(o)}function ffe(t,e){let n=new eO(i),r=null;function i(){e(r,o)}function s(){n&&(n.destroy(),n=null),r=null}function o(){return n?(n.clear(),r=ap(n,t),r):null}return o(),qn(s)}function x$e(t,e){let n=!1,r=!1;const i=!!e?.sync;let s=new eO(()=>{n||r||(r=!0,i?o():queueMicrotask(o))});function o(){r=!1,s&&!n&&(Bx?pfe(o):(s.clear(),Bx=!0,n=!0,ap(s,t),n=!1,Bx=!1,mfe()))}function a(){s&&(s.destroy(),s=null)}return n=!0,ap(s,t),n=!1,qn(a)}function pfe(t){h4.includes(t)||h4.unshift(t)}function mfe(){for(;h4.length;)h4.pop()()}var r1;let IG=(r1=class{constructor(){this.uid=zM(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,n,r,i,s){return this.pool.acquire(0,e,n,r,i,s,cG)}static acquireTracked(e,n,r,i){return this.pool.acquire(1,e,n,r,null,null,i)}notify(e,n){this.type===0?this.callback.call(this.target,e,n,this.path,this.target):this.callback.call(null,e,n,void 0,void 0)}acquire(e,n,r,i,s,o,a){this.uid=zM(),this.removed=!1,this.type=e,this.oldValue=n,this.callback=r,this.getValue=i,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=zM(),this.removed=!0}},r1.pool=new sfe(()=>new r1),r1);const UM=new Aa,Kf=new Set;let d4;function f4(t){Kf.delete(t),Kf.add(t),gfe()}function gfe(){d4||(d4=Y2(E$e))}function w$e(t){if(t.removed)return;const e=t.oldValue,n=t.getValue();t.equals(e,n)||(t.oldValue=n,t.notify(n,e))}function b$e(t){for(const e of Kf.values())e.target===t&&(e.removed=!0)}function E$e(){let t=10;for(;d4&&t--;){d4=null;const e=S$e(),n=UM.acquire();for(const r of e){const i=r.uid;w$e(r),i===r.uid&&r.removed&&n.push(r)}for(const r of Kf)r.removed&&(n.push(r),Kf.delete(r));for(const r of n)IG.pool.release(r);UM.release(n),UM.release(e),vF.forEach(r=>r())}}function S$e(){const t=UM.acquire();t.length=Kf.size;let e=0;for(const n of Kf)t[e]=n,++e;return Kf.clear(),t}const vF=new Set;function T$e(t){return vF.add(t),qn(()=>vF.delete(t))}function k$e(t,e,n){let r=Xde(t,e,n,(i,s,o)=>{let a,l,c=ffe(()=>QA(i,s),(u,h)=>{i.__accessor__?.lifecycle===Xl.DESTROYED||a&&a.uid!==l?r.remove():(a||(a=IG.acquireUntracked(u,o,h,i,s),l=a.uid),f4(a))});return qn(()=>{c.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,f4(a)),a=null),r=c=null})});return r}function A$e(t,e,n){const r=Xde(t,e,n,(i,s,o)=>{let a=!1;return dfe(()=>QA(i,s),(l,c)=>{i.__accessor__.lifecycle!==Xl.DESTROYED?a||(a=!0,cG(c,l)||o.call(i,l,c,s,i),a=!1):r.remove()})});return r}function I$e(t,e,n,r=!1){return t.__accessor__&&t.__accessor__.lifecycle!==Xl.DESTROYED?r?A$e(t,e,n):k$e(t,e,n):qn()}function R$e(t,e,n){let r,i,s=ffe(t,(o,a)=>{r&&r.uid!==i?s.remove():(r||(r=IG.acquireTracked(o,e,a,n),i=r.uid),f4(r))});return qn(()=>{s.remove(),r&&(r.uid!==i||r.removed||(r.removed=!0,f4(r)),r=null),s=null})}function P$e(t,e,n){let r=!1;return dfe(t,(i,s)=>{r||(r=!0,n(s,i)||e(i,s),r=!1)})}function M$e(t,e,n=!1,r=ade){return n?P$e(t,e,r):R$e(t,e,r)}function vQ(t){return hfe(Kf,e=>e.oldValue===t)}const Ky=()=>St.getLogger("esri.core.accessorSupport.ensureTypes");function C$e(t){if(t==null)return t;const e=new Date(t);return isNaN(e.getTime())?(Ky().error("Accessor#set",`Invalid date value: '${t}', falling back to current date`),new Date):e}function N$e(t){return t==null?t:!!t}function O$e(t){return t==null?t:t.toString()}function Zl(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function RG(t){return t==null?t:Math.round(parseFloat(t))}function L$e(t){return null}function D$e(t,e){return n=>{let r=t(n);return e.step!=null&&(r=Math.round(r/e.step)*e.step),e.min!=null&&(r=Math.max(e.min,r)),e.max!=null&&(r=Math.min(e.max,r)),r}}function yfe(t){return t?.constructor&&t.constructor.__accessorMetadata__!==void 0}function p4(t,e){return e!=null&&t&&!(e instanceof t)}function vfe(t){return t&&"isCollection"in t}function _Q(t){return t?.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function $$e(t,e){if(!e?.constructor||!vfe(e.constructor))return _F(t,e)?e:new t(e);const n=_Q(t.prototype.itemType),r=_Q(e.constructor.prototype.itemType);return n?r?n===r?e:n.prototype.isPrototypeOf(r.prototype)?new t(e):(_F(t,e),e):new t(e):e}function _F(t,e){return!!yfe(e)&&(Ky().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+nO(t)+"'"),!0)}function tO(t,e){return e==null?e:vfe(t)?$$e(t,e):p4(t,e)?_F(t,e)?e:new t(e):e}function nO(t){return t?.prototype?.declaredClass||"unknown"}const j$e=new WeakMap;function F$e(t){switch(t){case Number:return e=>Zl(e);case Or:return RG;case Boolean:return N$e;case String:return O$e;case Date:return C$e;case PG:return L$e;default:return XA(j$e,t,()=>tO.bind(null,t))}}function Fa(t,e){const n=F$e(t);return arguments.length===1?n:n(e)}function wk(t,e,n){return arguments.length===1?wk.bind(null,t):e&&(Array.isArray(e)?e.map(r=>t(r,n)):[t(e,n)])}function V$e(t,e){return arguments.length===1?wk(n=>Fa(t,n)):wk(n=>Fa(t,n),e)}function _fe(t,e,n){return e!==0&&Array.isArray(n)?n.map(r=>_fe(t,e-1,r)):t(n)}function m4(t,e,n){if(arguments.length===2)return s=>m4(t,e,s);if(!n)return n;n=_fe(t,e,n);let r=e,i=n;for(;r>0&&Array.isArray(i);)r--,i=i[0];if(i!==void 0)for(let s=0;s<r;s++)n=[n];return n}function z$e(t,e,n){return arguments.length===2?m4(r=>Fa(t,r),e):m4(r=>Fa(t,r),e,n)}function xfe(t){return!!Array.isArray(t)&&!t.some(e=>{const n=typeof e;return!(n==="string"||n==="number"||n==="function"&&t.length>1)})}function xF(t,e){if(arguments.length===2)return xF(t).call(null,e);const n=new Set,r=t.filter(a=>typeof a!="function"),i=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||n.add(a);let s=null,o=null;return(a,l)=>{if(a==null)return a;const c=typeof a,u=c==="string"||c==="number";return u&&(n.has(a)||i.some(h=>c==="string"&&h===String||c==="number"&&h===Number))||c==="object"&&i.some(h=>!p4(h,a))?a:(u&&r.length?(s||(s=r.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),Ky().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&i.length?(o||(o=i.map(h=>nO(h)).join(", ")),Ky().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Ky().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function Cg(t,e){if(arguments.length===2)return Cg(t).call(null,e);const n={},r=[],i=[];for(const l in t.typeMap){const c=t.typeMap[l];n[l]=Fa(c),r.push(nO(c)),i.push(l)}const s=()=>`'${r.join("', '")}'`,o=()=>`'${i.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!p4(t.base,l)||l==null)return l;const c=a(l)||t.defaultKeyValue,u=n[c];if(!u)return Ky().error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!p4(t.typeMap[c],l))return l;if(typeof t.key=="string"&&!yfe(l)){const h={};for(const f in l)f!==t.key&&(h[f]=l[f]);return u(h)}return u(l)}}let Or=class{},PG=class{};const IAt={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function U$e(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function wfe(t){switch(t.type){case"native":return Fa(t.value);case"array":return wk(wfe(t.value));case"one-of":return G$e(t);default:return null}}function G$e(t){let e=null;return(n,r)=>bF(n,t)?n:(e==null&&(e=wF(t)),Ky().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),r&&(r.valid=!1),null)}function wF(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Or:return"integer";case Date:return"date";case PG:return"null";default:return nO(t.value)}case"array":return`array of ${wF(t.value)}`;case"one-of":{const e=t.values.map(n=>wF(n));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function bF(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case Or:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case PG:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(n=>!bF(n,e.value));case"one-of":return e.values.some(n=>bF(t,n))}}function E(t={}){return(e,n)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${n}. Accessor does not support static properties.`);const r=Object.getOwnPropertyDescriptor(e,n),i=eI(e,n);r&&(r.get||r.set?(i.get=r.get||i.get,i.set=r.set||i.set):"value"in r&&("value"in t&&St.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${n}" on "${e.constructor.name}" already defined in the metadata`,t),i.value=t.value=r.value)),t.readOnly!=null&&(i.readOnly=t.readOnly);const s=t.aliasOf;if(s){const l=typeof s=="string"?s:s.source,c=typeof s=="string"?null:s.overridable===!0;let u;i.dependsOn=[l],i.get=function(){let h=od(this,l);if(typeof h=="function"){u||(u=l.split(".").slice(0,-1).join("."));const f=od(this,u);f&&(h=h.bind(f))}return h},i.readOnly||(i.set=c?function(h){this._override(n,h)}:function(h){a4(this,l,h)})}const o=t.type,a=t.types;if(!i.cast){let l;o?l=B$e(o):a&&(l=Array.isArray(a)?wk(Cg(a[0])):Cg(a)),t.cast=W$e(t.cast,l)}D6e(i,t),t.range&&(i.cast=D$e(i.cast,t.range))}}function MG(t,e,n){const r=eI(t,n);r.json||(r.json={});let i=r.json;return e!==void 0&&(i.origins||(i.origins={}),i.origins[e]||(i.origins[e]={}),i=i.origins[e]),i}function B$e(t){let e=0,n=t;if(U$e(t))return wfe(t);for(;Array.isArray(n)&&n.length===1&&typeof n[0]!="string"&&typeof n[0]!="number";)n=n[0],e++;const r=n;if(xfe(r))return e===0?xF(r):m4(xF(r),e);if(e===1)return V$e(r);if(e>1)return z$e(r,e);const i=t;return i.from?i.from:Fa(i)}function W$e(t,e){if(t||e)return t?e?(n,r)=>e(t(n,r),r):t:e}function H$e(t){if(t.json&&t.json.origins){const e=t.json.origins,n={"web-document":["web-scene","web-map"]};for(const r in n)if(e[r]){const i=e[r];n[r].forEach(s=>{e[s]=i}),delete e[r]}}}let Td=class extends dde{constructor(e,n,r){super(e,n,r)}};Td.prototype.type="warning";function bfe(t){return!!t&&t.prototype?.declaredClass&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}function q$e(t,e){return CG(t,"any",e?.origin)}function g4(t,e){return CG(t,"read",e?.origin)}function Efe(t,e){return CG(t,"write",e?.origin)}function CG(t,e,n){let r=t?.json;if(r?.origins&&n){let i;i=n==="link-chart"?r.origins[n]&&(e==="any"||e in r.origins[n])?r.origins[n]:r.origins["web-map"]:r.origins[n],i&&(e==="any"||e in i)&&(r=i)}return r}const EF=()=>St.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function xQ(t,e,n){t&&(!n&&!e.read||e.read?.reader||e.read?.enabled===!1||X$e(t)&&z2("read.reader",NG(t),e))}function NG(t){const e=t.ndimArray??0;if(e>1)return Y$e(t);if(e===1)return wQ(t);if("type"in t&&Tfe(t.type)){const n=t.type.prototype?.itemType?.Type,r=wQ(typeof n=="function"?{type:n}:{types:n});return(i,s,o)=>{const a=r(i,s,o);return a&&new t.type(a)}}return OG(t)}function OG(t){return"type"in t?K$e(t.type):Z$e(t.types)}function K$e(t){return t.prototype.read?(e,n,r)=>{if(e==null)return e;const i=typeof e;if(i!=="object")return void EF().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${i}'`);const s=new t;return s.read(e,r),s}:t.fromJSON}function Sfe(t,e,n,r){return r!==0&&Array.isArray(e)?e.map(i=>Sfe(t,i,n,r-1)):t(e,void 0,n)}function Y$e(t){const e=OG(t),n=Sfe.bind(null,e),r=t.ndimArray??0;return(i,s,o)=>{if(i==null)return i;i=n(i,o,r);let a=r,l=i;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let c=0;c<a;c++)i=[i];return i}}function wQ(t){const e=OG(t);return(n,r,i)=>{if(n==null)return n;if(Array.isArray(n)){const o=[];for(const a of n){const l=e(a,void 0,i);l!==void 0&&o.push(l)}return o}const s=e(n,void 0,i);return s!==void 0?[s]:void 0}}function Tfe(t){if(!bfe(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?LG(e.Type):kfe(e.Type))}function X$e(t){return"types"in t?kfe(t.types):LG(t.type)}function LG(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||Tfe(t))}function kfe(t){for(const e in t.typeMap)if(!LG(t.typeMap[e]))return!1;return!0}function Z$e(t){let e=null;const n=t.errorContext??"type",r=t.validate;return(i,s,o)=>{if(i==null)return i;const a=typeof i;if(a!=="object")return void EF().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=Q$e(t));const l=t.key;if(typeof l!="string")return;const c=i[J$e(l,e,o)],u=c?e[c]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!u){const f=`Type '${c||"unknown"}' is not supported`;return o?.messages&&i&&o.messages.push(new Td(`${n}:unsupported`,f,{definition:i,context:o})),void EF().error(f)}const h=new u;return h.read(i,o),r?r(h):h}}function J$e(t,e,n){const r=Object.values(e)[0],i=K2(r.prototype)[t],s=g4(i,n),o=s?.read?.source;return o&&typeof o=="string"?o:t}function Q$e(t){const e={};for(const n in t.typeMap){const r=t.typeMap[n],i=K2(r.prototype);if(typeof t.key=="function")continue;const s=i[t.key];if(!s)continue;if(s.json?.type&&Array.isArray(s.json.type)&&s.json.type.length===1&&typeof s.json.type[0]=="string"){e[s.json.type[0]]=r;continue}const o=s.json?.write;if(!o?.writer){e[n]=r;continue}const a=o.target,l=typeof a=="string"?a:t.key,c={};o.writer(n,c,l),c[l]&&(e[c[l]]=r)}return e}function e8e(t){if(t.json||(t.json={}),EQ(t.json),SQ(t.json),bQ(t.json),t.json.origins)for(const e in t.json.origins)EQ(t.json.origins[e]),SQ(t.json.origins[e]),bQ(t.json.origins[e]);return!0}function bQ(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function EQ(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function SQ(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function TQ(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const n=t?.ndimArray??0;t&&(n===1||"type"in t&&bfe(t.type))?e.write.writer=r8e:n>1?e.write.writer=i8e(n):e.types?Array.isArray(e.types)?e.write.writer=n8e(e.types[0]):e.write.writer=t8e(e.types):e.write.writer=bk}function t8e(t){return(e,n,r,i)=>e?Afe(e,t,i)?bk(e,n,r,i):void 0:bk(e,n,r,i)}function Afe(t,e,n){for(const r in e.typeMap)if(t instanceof e.typeMap[r])return!0;if(n?.messages){const r=e.errorContext??"type",i=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;n&&n.messages&&t&&n.messages.push(new Xe(`${r}:unsupported`,i,{definition:t,context:n})),St.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(i)}return!1}function n8e(t){return(e,n,r,i)=>!e||!Array.isArray(e)?bk(e,n,r,i):bk(e.filter(s=>Afe(s,t,i)),n,r,i)}function bk(t,e,n,r){z2(n,y4(t,r),e)}function y4(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?v4(t):t}function v4(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function r8e(t,e,n,r){let i;t===null?i=null:t&&typeof t.map=="function"?(i=t.map(s=>y4(s,r)),typeof i.toArray=="function"&&(i=i.toArray())):i=[y4(t,r)],z2(n,i,e)}function Ife(t,e,n){return n!==0&&Array.isArray(t)?t.map(r=>Ife(r,e,n-1)):y4(t,e)}function i8e(t){return(e,n,r,i)=>{let s;if(e===null)s=null;else{s=Ife(e,i,t);let o=t,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)s=[s]}z2(r,s,n)}}function s8e(t){const e=o8e(t);if(t.json.origins)for(const n in t.json.origins){const r=t.json.origins[n],i=r.types?a8e(r):e;xQ(i,r,!1),r.types&&!r.write&&t.json.write?.enabled&&(r.write={...t.json.write}),TQ(i,r)}xQ(e,t.json,!0),TQ(e,t.json)}function o8e(t){return t.json.types?SF(t.json):t.type?Rfe(t):SF(t)}function a8e(t){return t.type?Rfe(t):SF(t)}function Rfe(t){if(!t.type)return;let e=0,n=t.type;for(;Array.isArray(n)&&!xfe(n);)n=n[0],e++;return{type:n,ndimArray:e}}function SF(t){if(!t.types)return;let e=0,n=t.types;for(;Array.isArray(n);)n=n[0],e++;return{types:n,ndimArray:e}}function l8e(t){e8e(t)&&(H$e(t),s8e(t))}const W6=new Set,H6=new Set;function ue(t){return e=>{t??="esri.core.Accessor",e.prototype.declaredClass=t,u8e(e);const n=[],r=[];let i=e.prototype;for(;i;)i.hasOwnProperty("initialize")&&!W6.has(i.initialize)&&(W6.add(i.initialize),n.push(i.initialize)),i.hasOwnProperty("destroy")&&!H6.has(i.destroy)&&(H6.add(i.destroy),r.push(i.destroy)),i=Object.getPrototypeOf(i);W6.clear(),H6.clear();const s=class extends e{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(n.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=n.length-1;l>=0;l--)n[l].call(this)}}),r.length){let l=!1;const c=this[Kde];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){this.__accessor__.lifecycle=Xl.DESTROYING,l=!0,c.call(this);for(let u=0;u<r.length;u++)r[u].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};s.__accessorMetadata__=K2(e.prototype),s.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(s,"name",{value:o,configurable:!0}),s}}function c8e(t,e){return e.get==null?function(){const n=this.__accessor__,r=n.propertiesByName.get(t);if(r===void 0)return;n.mutable&&tn(r);const i=n.store;return i.has(t)?i.get(t):r.metadata.value}:function(){const n=this.__accessor__,r=n.propertiesByName.get(t);if(r!==void 0)return r.getComputed(n)}}function u8e(t){const e=t.prototype,n=K2(e),r={};for(const i of Object.getOwnPropertyNames(n)){const s=n[i];l8e(s),r[i]={enumerable:!0,configurable:!0,get:c8e(i,s),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&s.readOnly?kQ("read-only",i):a.lifecycle===Xl.CONSTRUCTED&&s.constructOnly?kQ("construct-only",i):void a.set(i,o)}else Object.defineProperty(this,i,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,r)}const kQ=(t,e)=>{St.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)};var AQ,IQ;function h8e(t){if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor?.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const tm=Symbol("Accessor-Handles"),q6=Symbol("Accessor-Initialized");var wg;let Kt=(wg=class{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:n,declaredClass:r,constructor:i}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const s=this;class o extends s{constructor(...l){super(...l),this.inherited=null,i&&i.apply(this,l)}}K2(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...c){const u=this.inherited;let h;this.inherited=function(...f){if(s.prototype[a])return s.prototype[a].apply(this,f)};try{h=l.apply(this,c)}catch(f){throw this.inherited=u,f}return this.inherited=u,h}:e[a]}for(const a in n){const l=h8e(n[a]);E(l)(o.prototype,a)}return ue(r)(o)}static freeze(e){return e instanceof wg?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof wg?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[AQ]=null,this[IQ]=!1,this.constructor===wg)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const n=new W6e(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:n}),e.length>0&&(n.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0])}postscript(){const e=this.__accessor__,n=e.ctorArgs;e.initialize(),n&&(this.set(n),e.ctorArgs=null),e.constructed(),this.initialize(),this[q6]=!0}initialize(){}[Kde](){this[tm]=Ci(this[tm])}destroy(){this.destroyed||(b$e(this),this.__accessor__.destroy(),Z6e()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[q6]}get destroyed(){return this.__accessor__?.lifecycle===Xl.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===Xl.DESTROYING||!1}commitProperty(e){od(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,n){return a4(this,e,n),this}watch(e,n,r){return qde(St.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),I$e(this,e,n,r)}addHandles(e,n){if(this.destroyed){const r=Array.isArray(e)?e:[e];for(const i of r)i.remove();return}(this[tm]??=new q2).add(e,n)}removeHandles(e){this[tm]?.remove(e)}removeAllHandles(){this[tm]?.removeAll()}removeHandlesReference(e){this[tm]?.removeReference(e)}hasHandles(e){return this[tm]?.has(e)===!0}_override(e,n){n===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,n)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,n){n==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,n)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,n){return this.__accessor__.internalSet(e,n),this}},AQ=tm,IQ=q6,wg);const rO=t=>{const e=t;class n extends e{constructor(){super(...arguments),this._listenersMap=null}clearEvents(){this._listenersMap?.clear(),this._listenersMap=null}destroy(){this.clearEvents()}emit(i,s){let o=this._listenersMap?.get(i);if(!o)return!1;let a=!1;for(const l of o.slice()){const c="deref"in l?l.deref():l;c?c?.call(this,s):a=!0}return a&&(o=o.filter(l=>!("deref"in l)||l.deref()!=null),this._listenersMap.set(i,o)),o.length>0}on(i,s){if(Array.isArray(i)){const a=i.map(l=>this.on(l,s));return rv(a)}if(i.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??=new Map;const o=this._listenersMap.get(i)||[];return o.push(s),this._listenersMap.set(i,o),qn(()=>{const a=this._listenersMap?.get(i),l=a?.indexOf(s)??-1;l>=0&&a.splice(l,1)})}once(i,s){const o=this.on(i,a=>{o.remove(),("deref"in s?s.deref():s)?.call(null,a)});return o}hasEventListener(i){const s=this._listenersMap?.get(i);return s!=null&&s.length>0}}return n},Pfe=rO(class{}),d8e=Pfe,tI=rO(Kt);function Mfe(t){return(e,n)=>{e[n]=t}}let nI=class extends Qde{notify(){const e=this._observers;if(e&&e.length>0){const n=e.slice();for(const r of n)r.onInvalidated(),r.onCommitted()}}};var cf;let f8e=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},p8e=class{constructor(e,n,r,i,s){this.target=e,this.added=n,this.removed=r,this.start=i,this.deleteCount=s}};const Sc=new H2(()=>new f8e,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function RQ(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function K6(t){return t?t instanceof Im?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Y6(t){if(t?.length)return t[0]}function m8e(t,e,n,r){const i=Math.min(t.length-n,e.length-r);let s=0;for(;s<i&&t[n+s]===e[r+s];)s++;return s}function Cfe(t,e,n,r){e&&e.forEach((i,s,o)=>{t.push(i),Cfe(t,n.call(r,i,s,o),n,r)})}const nm=new Set,rm=new Set,im=new Set,X6=new Map;let g8e=0,Im=cf=class extends tI{static ofType(t){if(!t)return cf;if(X6.has(t))return X6.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const r in t.typeMap){const i=t.typeMap[r].prototype.declaredClass;e?e+=` | ${i}`:e=i}let n=class extends cf{};return _([Mfe({Type:t,ensureType:typeof t=="function"?Fa(t):Cg(t)})],n.prototype,"itemType",void 0),n=_([ue(`esri.core.Collection<${e}>`)],n),X6.set(t,n),n}static isCollection(t){return t!=null&&t instanceof cf}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new nI,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:g8e++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof cf?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),super.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return tn(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,K6(t)),this._emitAfterChanges(1))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:super.hasEventListener(t))}on(t,e){if(this.destroyed)return qn();if(t==="change"){const n=this._chgListeners,r={removed:!1,callback:e};return n.push(r),this._notifications&&this._notifications.push({listeners:n.slice(),items:this._items.slice(),changes:[]}),qn(()=>{r.removed=!0,n.splice(n.indexOf(r),1)})}return super.on(t,e)}once(t,e){const n="deref"in e?()=>e.deref():()=>e,r=this.on(t,i=>{n()?.call(null,i),r.remove()});return r}add(t,e){if(tn(this._observable),this._emitBeforeChanges(1))return this;const n=this.getNextIndex(e??null);return this._splice(n,0,[t]),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(tn(this._observable),!t?.length)return this;if(this._emitBeforeChanges(1))return this;const n=this.getNextIndex(e);return this._splice(n,0,K6(t)),this._emitAfterChanges(1),this}at(t){if(tn(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._removeAllRaw();return this._emitAfterChanges(2),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return tn(this._observable),this._createNewInstance({items:this._items.map(Ze)})}concat(...t){tn(this._observable);const e=t.map(K6);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return;const n=this._splice(0,this.length),r=n.length;for(let i=0;i<r;i++)t.call(e,n[i],i,n);this._emitAfterChanges(2)}destroyAll(){this.drain(RQ)}destroyMany(t){const e=this.removeMany(t);return e.forEach(RQ),e}every(t,e){return tn(this._observable),this._items.every(t,e)}filter(t,e){tn(this._observable);const n=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:n})}find(t,e){return tn(this._observable),this._items.find(t,e)}findIndex(t,e){return tn(this._observable),this._items.findIndex(t,e)}flatten(t,e){tn(this._observable);const n=[];return Cfe(n,this,t,e),new cf(n)}forEach(t,e){return tn(this._observable),this._items.forEach(t,e)}getItemAt(t){return tn(this._observable),this._items[t]}getNextIndex(t){tn(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return tn(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return tn(this._observable),this._items.indexOf(t,e)}join(t=","){return tn(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return tn(this._observable),this._items.lastIndexOf(t,e)}map(t,e){tn(this._observable);const n=this._items.map(t,e);return new cf({items:n})}reorder(t,e=this.length-1){tn(this._observable);const n=this.indexOf(t);if(n!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),n!==e){if(this._emitBeforeChanges(4))return t;this._splice(n,1),this._splice(e,0,[t]),this._emitAfterChanges(4)}return t}}pop(){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Y6(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return tn(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,t),this._emitAfterChanges(1)),this.length}reduce(t,e){tn(this._observable);const n=this._items;return arguments.length===2?n.reduce(t,e):n.reduce(t)}reduceRight(t,e){tn(this._observable);const n=this._items;return arguments.length===2?n.reduceRight(t,e):n.reduceRight(t)}remove(t){return tn(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(tn(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Y6(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(tn(this._observable),!t?.length||this._emitBeforeChanges(2))return[];const e=t instanceof cf?t.toArray():t,n=this._items,r=[],i=e.length;for(let s=0;s<i;s++){const o=e[s],a=n.indexOf(o);if(a>-1){const l=1+m8e(e,n,s+1,a+1),c=this._splice(a,l);c&&c.length>0&&r.push.apply(r,c),s+=l-1}}return this._emitAfterChanges(2),r}reverse(){if(tn(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(4),this}shift(){if(tn(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Y6(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return tn(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return tn(this._observable),this._items.some(t,e)}sort(t){if(tn(this._observable),!this.length||this._emitBeforeChanges(4)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(4),this}_requiresSort(t=(e,n)=>e===n?0:e<n?-1:1){const e=this.length-1;for(let n=0;n<e;n++)if(t(this.items[n],this.items[n+1])>0)return!0;return!1}splice(t,e,...n){tn(this._observable),arguments.length===1&&(e=this.length),e??=0;const r=(e?2:0)|(n.length?1:0);if(this._emitBeforeChanges(r))return[];const i=this._splice(t,e,n)||[];return this._emitAfterChanges(r),i}toArray(){return tn(this._observable),this._items.slice()}toJSON(t){return tn(this._observable),this.toArray().map(e=>Z3(e)?e.toJSON(t):e)}toLocaleString(){return tn(this._observable),this._items.toLocaleString()}toString(){return tn(this._observable),this._items.toString()}unshift(...t){return tn(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,n){const r=this._items,i=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Y2(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=r.splice(t,e),this.hasEventListener("before-remove")){const a=Sc.acquire();a.target=this,a.cancellable=!0;for(let l=0,c=o.length;l<c;l++)s=o[l],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),r.splice(t,0,s),t+=1,l-=1,c-=1);Sc.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Sc.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let c=0;c<l;c++)a.reset(o[c]),this.emit("after-remove",a);Sc.release(a)}}if(n?.length){if(i){const u=[];for(const h of n){const f=i.ensureType(h);f==null&&h!=null||u.push(f)}n=u}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),c=t===this.length;if(a||l){const u=Sc.acquire();u.target=this,u.cancellable=!0;const h=Sc.acquire();h.target=this,h.cancellable=!1;for(const f of n)a?(u.reset(f),this.emit("before-add",u),u.defaultPrevented||(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),l&&(h.reset(f),this.emit("after-add",h)))):(c?r.push(f):r.splice(t++,0,f),this._set("length",r.length),h.reset(f),this.emit("after-add",h));Sc.release(h),Sc.release(u)}else{if(c)for(const u of n)r.push(u);else r.splice(t,0,...n);this._set("length",r.length)}}if((n?.length||o?.length)&&this._notifyChangeEvent(n,o),this.hasEventListener("after-splice")){const a=new p8e(this,n,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const n=Sc.acquire();n.target=this,n.cancellable=!0,n.type=t,this.emit("before-changes",n),e=n.defaultPrevented,Sc.release(n)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Sc.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Sc.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const n=e.changes;nm.clear(),rm.clear(),im.clear();for(const{added:l,removed:c}of n){if(l)if(im.size===0&&rm.size===0)for(const u of l)nm.add(u);else for(const u of l)rm.has(u)?(im.add(u),rm.delete(u)):im.has(u)||nm.add(u);if(c)if(im.size===0&&nm.size===0)for(const u of c)rm.add(u);else for(const u of c)nm.has(u)?nm.delete(u):(im.delete(u),rm.add(u))}const r=Aa.acquire();nm.forEach(l=>{r.push(l)});const i=Aa.acquire();rm.forEach(l=>{i.push(l)});const s=this._items,o=e.items,a=Aa.acquire();if(im.forEach(l=>{o.indexOf(l)!==s.indexOf(l)&&a.push(l)}),e.listeners&&(r.length||i.length||a.length)){const l={target:this,added:r,removed:i,moved:a},c=e.listeners.length;for(let u=0;u<c;u++){const h=e.listeners[u];h.removed||h.callback.call(this,l)}}Aa.release(r),Aa.release(i),Aa.release(a)}nm.clear(),rm.clear(),im.clear()}};_([E()],Im.prototype,"_updating",void 0),_([E()],Im.prototype,"length",void 0),_([E()],Im.prototype,"items",null),_([E({readOnly:!0})],Im.prototype,"updating",null),Im=cf=_([ue("esri.core.Collection")],Im);const Ot=Im;function fd(t,e,n=Ot){return e||(e=new n),e===t||e.destroyed||(e.removeAll(),y8e(t)?e.addMany(t):t&&e.add(t)),e}function Nfe(t){return t}function y8e(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}let v8e=class Ofe{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const n=new Ofe;return this._values.forEach((r,i)=>{e&&e.has(i)||n.set(i,Ze(r.value),r.origin)}),n}get(e,n){n=this._normalizeOrigin(n);const r=this._values.get(e);return n==null||r?.origin===n?r?.value:void 0}originOf(e){return this._values.get(e)?.origin??7}keys(e){e=this._normalizeOrigin(e);const n=[...this._values.keys()];return e==null?n:n.filter(r=>this._values.get(r)?.origin===e)}set(e,n,r){if((r=this._normalizeOrigin(r))===0){const i=this._values.get(e);if(i?.origin!=null&&i.origin>r)return}this._values.set(e,new _8e(n,r))}delete(e,n){(n=this._normalizeOrigin(n))!=null&&this._values.get(e)?.origin!==n||this._values.delete(e)}has(e,n){return(n=this._normalizeOrigin(n))!=null?this._values.get(e)?.origin===n:this._values.has(e)}isAtOrigin(e,n){return n=this._normalizeOrigin(n),this.has(e,n)&&this.originOf(e)===n}isBelowOrigin(e,n){return n=this._normalizeOrigin(n),!this.has(e)||this.originOf(e)<n}forEach(e){this._values.forEach(({value:n},r)=>e(n,r))}_normalizeOrigin(e){if(e!=null)return e===0?e:7}},_8e=class{constructor(e,n){this.value=e,this.origin=n}};function x8e(t,e,n){e.keys().forEach(i=>{n.set(i,e.get(i),0)});const r=t.metadata;Object.keys(r).forEach(i=>{t.internalGet(i)&&n.set(i,t.internalGet(i),0)})}function w8e(t,e,n){if(!t?.read||t.read.enabled===!1||!t.read.source)return!1;const r=t.read.source;if(typeof r=="string"){if(r===e||r.includes(".")&&r.startsWith(e)&&hQ(r,n))return!0}else for(const i of r)if(i===e||i.includes(".")&&i.startsWith(e)&&hQ(i,n))return!0;return!1}function b8e(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function E8e(t,e,n,r,i){let s=g4(e[n],i);b8e(s)&&(t[n]=!0);for(const o of Object.getOwnPropertyNames(e))s=g4(e[o],i),w8e(s,n,r)&&(t[o]=!0)}function S8e(t,e,n,r){const i=n.metadata,s=q$e(i[e],r),o=s?.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,r):o;a!==void 0&&n.set(e,a)}const Lfe={origin:"service"};function T8e(t,e,n=Lfe){if(!e||typeof e!="object")return;const r=Mg(t),i=r.metadata,s={};for(const o of Object.getOwnPropertyNames(e))E8e(s,i,o,e,n);r.setDefaultOrigin(n.origin);for(const o of Object.getOwnPropertyNames(s)){const a=g4(i[o],n).read,l=a?.source;let c;c=l&&typeof l=="string"?QA(e,l):e[o],a?.reader&&(c=a.reader.call(t,c,e,n)),c!==void 0&&r.set(o,c)}if(!n||!n.ignoreDefaults){r.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(i))s[o]||S8e(t,o,r,n)}r.setDefaultOrigin("user")}function OAt(t,e,n,r=Lfe){const i={...r,messages:[]};n(i),i.messages?.forEach(s=>{s.type!=="warning"||t.loaded?r?.messages&&r.messages.push(s):t.loadWarnings.push(s)})}function k8e(t,e,n,r,i){const s={};return e.write?.writer?.call(t,r,s,n,i),s}function Dfe(t,e,n,r,i,s){if(!r?.write)return!1;const o=od(t,n);if(!i&&r.write.overridePolicy){const a=r.write.overridePolicy.call(t,o,n,s??void 0);a!==void 0&&(i=a)}if(i||(i=r.write),!i||i.enabled===!1||i.layerContainerTypes&&s?.layerContainerType&&!i.layerContainerTypes.includes(s.layerContainerType))return!1;if((o===null&&!i.allowNull&&!i.writerEnsuresNonNull||o===void 0)&&i.isRequired){const a=new Xe("web-document-write:property-required",`Missing value for required property '${n}' on '${t.declaredClass}'`,{propertyName:n,target:t});return a&&s?.messages?s.messages.push(a):a&&!s&&St.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!i.allowNull&&!i.writerEnsuresNonNull||!i.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(n)===0)&&A8e(t,n,s,r,o)||!i.ignoreOrigin&&s?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(n)<TG(s.origin))}function A8e(t,e,n,r,i){const s=r.default;if(s===void 0)return!1;if(r.defaultEquals!=null)return r.defaultEquals(i);if(typeof s=="function"){if(Array.isArray(i)){const o=s.call(t,e,n??void 0);return B5(o,i)}return!1}return s===i}function LAt(t,e,n,r){const i=Mg(t),s=i.metadata,o=Efe(s[e],r);return!!o&&Dfe(t,i,e,o,n,r)}function I8e(t,e,n){if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return jM(e,t.toJSON(n));const r=Mg(t),i=r.metadata;for(const s in i){const o=Efe(i[s],n);if(!Dfe(t,r,s,o,void 0,n))continue;const a=od(t,s),l=k8e(t,o,o.write&&typeof o.write.target=="string"?o.write.target:s,a,n);Object.keys(l).length>0&&(e=jM(e,l),n?.resources?.pendingOperations?.length&&n.resources.pendingOperations.push(Promise.all(n.resources.pendingOperations).then(()=>jM(e,l,()=>"replace-arrays"))),n?.writtenProperties&&n.writtenProperties.push({target:t,propName:s,oldOrigin:G6e(r.store.originOf(s)),newOrigin:n.origin}))}return e}const Xg=t=>{const e=t;let n=class extends e{constructor(...r){super(...r);const i=Mg(this),s=i.store,o=new v8e;i.store=o,x8e(i,s,o)}read(r,i){T8e(this,r,i)}write(r,i){return I8e(this,r??{},i)}toJSON(r){return this.write({},r)}static fromJSON(r,i){return R8e.call(this,r,i)}};return n=_([ue("esri.core.JSONSupport")],n),n.prototype.toJSON.isDefaultToJSON=!0,n};function R8e(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const n=new this;return n.read(t,e),n}const qt=Xg(Kt);let P8e=class{constructor(){this._resolver=uc(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===1}isRejected(){return this._status===2}isFulfilled(){return this._status!==0}abort(){this._resolver.reject(Tr())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=uc(),n=[...this._resolvingPromises,e.promise],r=this._allPromise=Promise.all(n);r.then(()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve()},i=>{this.isFulfilled()||this._allPromise!==r||ya(i)||this._resolver.reject(i)}),e.resolve()}};const $fe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._promiseProps=new P8e,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,i){return this._promiseProps.promise.then(()=>this).then(r,i)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}addResolvingTask(r){r&&!this._promiseProps.isFulfilled()&&(this.addHandles(WDe(r)),this._promiseProps.addResolvingPromise(r.promise))}};return n=_([ue("esri.core.Promise")],n),n},DG=$fe(Kt),M8e="not-loaded",C8e="loading",N8e="failed",PQ="loaded",O8e=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(i=>{const s=this.load.bind(this);this.load=o=>{const a=new Promise((l,c)=>{const u=_G(o,c);this.destroyed&&c(new Xe("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(l,c).finally(()=>{u&&u.remove()})});if(this.loadStatus===M8e){this._set("loadStatus",C8e);const l=this._loadController=new AbortController;s({signal:l.signal})}return i(),a}})),this.when(()=>{this._set("loadStatus",PQ),this._loadController=null},i=>{this.destroyed||(this._set("loadStatus",N8e),this._set("loadError",i),this._loadController=null)})}destroy(){this._loadController&&(this._loadController=R1(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===PQ}get loadWarnings(){return this._get("loadWarnings")}load(r){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new Xe("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return _([E({readOnly:!0})],n.prototype,"loaded",null),_([E({readOnly:!0})],n.prototype,"loadError",void 0),_([E({clonable:!1})],n.prototype,"loadStatus",void 0),_([E({type:[Td],readOnly:!0})],n.prototype,"loadWarnings",null),n=_([ue("esri.core.Loadable")],n),n},rI=O8e(DG);function TF(t){return!(!t||!t.load)}function $At(t,e,n){return xG(t.map((r,i)=>e.apply(n,[r,i])))}async function L8e(t,e,n){return(await xG(t.map((r,i)=>e.apply(n,[r,i])))).map(r=>r.value)}function $G(t){return{ok:!0,value:t}}function jG(t){return{ok:!1,error:t}}function D8e(t){return t!=null&&t.ok===!0?t.value:null}function $8e(t){return t!=null&&t.ok===!1?t.error:null}async function jfe(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return $G(await t)}catch(e){return jG(e)}}async function jAt(t){try{return $G(await t)}catch(e){return Nde(e),jG(e)}}function iO(t,e){return new pm(t,e)}let pm=class extends Kt{get value(){return D8e(this._result)}get error(){return $8e(this._result)}get finished(){return this._result!=null}constructor(e,n){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=R1(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(i=>{this._result=$G(i),this._cleanup()},i=>{this._result=jG(i),this._cleanup()}),this._abortHandle=lu(n,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Qr(this._abortHandle),this._abortController=null}};_([E()],pm.prototype,"value",null),_([E()],pm.prototype,"error",null),_([E()],pm.prototype,"finished",null),_([E()],pm.prototype,"promise",void 0),_([E()],pm.prototype,"_result",void 0),pm=_([ue("esri.core.asyncUtils.ReactiveTask")],pm);async function Ffe(t,e){return await t.load(),j8e(t,e)}async function j8e(t,e){const n=[],r=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?r(...o):Ot.isCollection(o)?o.forEach(a=>r(a)):TF(o)&&n.push(o))};e(r);let i=null;if(await L8e(n,async s=>{const o=await jfe(F8e(s)?s.loadAll():s.load());o.ok!==!1||i||(i=o)}),i)throw i.error;return t}function F8e(t){return"loadAll"in t&&typeof t.loadAll=="function"}function Xn(t,e,n){let r,i;return e===void 0?(i=t,r=[void 0]):typeof e!="string"?(i=t,r=[void 0],n=e):(i=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;for(const l of r){const c=MG(s,l,i);c.write&&typeof c.write=="object"||(c.write={}),n&&(c.write.target=n),c.write.writer=a[o]}}}let Gs=class{constructor(e,n={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=n,this.apiValues=[],this.jsonValues=[],this._apiToJSON=V8e(e),this.apiValues=MQ(this._apiToJSON),this.jsonValues=MQ(this._jsonToAPI),this.read=r=>this.fromJSON(r),this.write=(r,i,s)=>{const o=this.toJSON(r);o!==void 0&&z2(s,o,i)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const n=this._apiToJSON[e];return this._options.useNumericKeys?+n:n}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function V8e(t){const e={};for(const n in t)e[t[n]]=n;return e}function MQ(t){const e=[];for(const n in t)e.push(n);return e.sort(),e}function kl(){return function(t,e){return new Gs(t,{ignoreUnknown:!0,...e})}}let FG=class{constructor(e,n,r,i,s,o){this.semiMajorAxis=e,this.flattening=n,this.outerAtmosphereRimWidth=r,this.atmosphereHeight=i,this.scaleHeight=s;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const ts=new FG(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),pd=new FG(3396190,1/169.8944472236118,23e4,6e4,.111),Ng=new FG(1737400,0,0,0,0);function Ui(t){if(!Qn.assetsPath)throw St.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Xe("assets:path-not-set","config.assetsPath is not set");return KA(Qn.assetsPath,t)}let Z6,pe=null;function Vfe(){return!!pe}function z8e(){return!!ve("esri-wasm")}function U8e(){return Z6||(Z6=xe(async()=>{const{default:t}=await import("./pe-wasm-B87Q3u4k.js");return{default:t}},[]).then(({default:t})=>t({locateFile:e=>Ui(`esri/geometry/support/${e}`)})).then(t=>{Hfe(t)}),Z6)}const GM={geogToProj(t,e,n){pe.ensureCache.prepare();const r=M1(n),i=n===r,s=pe.ensureFloat64(r),o=pe._pe_geog_to_proj(pe.getPointer(t),e,s);return o&&Og(n,e,s,i),o},projGeog(t,e,n,r){switch(r){case Oi.PE_TRANSFORM_P_TO_G:return GM.projToGeog(t,e,n);case Oi.PE_TRANSFORM_G_TO_P:return GM.geogToProj(t,e,n)}return 0},projToGeog:(t,e,n)=>GM.projToGeogCenter(t,e,n,0),projToGeogCenter(t,e,n,r){pe.ensureCache.prepare();const i=M1(n),s=n===i,o=pe.ensureFloat64(i),a=pe._pe_proj_to_geog_center(pe.getPointer(t),e,o,r);return a&&Og(n,e,o,s),a}};let Oi=class hr{static init(){hr.PE_BUFFER_MAX=pe.PeDefs.prototype.PE_BUFFER_MAX,hr.PE_NAME_MAX=pe.PeDefs.prototype.PE_NAME_MAX,hr.PE_MGRS_MAX=pe.PeDefs.prototype.PE_MGRS_MAX,hr.PE_USNG_MAX=pe.PeDefs.prototype.PE_USNG_MAX,hr.PE_DD_MAX=pe.PeDefs.prototype.PE_DD_MAX,hr.PE_DDM_MAX=pe.PeDefs.prototype.PE_DDM_MAX,hr.PE_DMS_MAX=pe.PeDefs.prototype.PE_DMS_MAX,hr.PE_UTM_MAX=pe.PeDefs.prototype.PE_UTM_MAX,hr.PE_PARM_MAX=pe.PeDefs.prototype.PE_PARM_MAX,hr.PE_TYPE_NONE=pe.PeDefs.prototype.PE_TYPE_NONE,hr.PE_TYPE_GEOGCS=pe.PeDefs.prototype.PE_TYPE_GEOGCS,hr.PE_TYPE_PROJCS=pe.PeDefs.prototype.PE_TYPE_PROJCS,hr.PE_TYPE_GEOGTRAN=pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,hr.PE_TYPE_COORDSYS=pe.PeDefs.prototype.PE_TYPE_COORDSYS,hr.PE_TYPE_UNIT=pe.PeDefs.prototype.PE_TYPE_UNIT,hr.PE_TYPE_LINUNIT=pe.PeDefs.prototype.PE_TYPE_LINUNIT,hr.PE_STR_OPTS_NONE=pe.PeDefs.prototype.PE_STR_OPTS_NONE,hr.PE_STR_AUTH_NONE=pe.PeDefs.prototype.PE_STR_AUTH_NONE,hr.PE_STR_AUTH_TOP=pe.PeDefs.prototype.PE_STR_AUTH_TOP,hr.PE_STR_NAME_CANON=pe.PeDefs.prototype.PE_STR_NAME_CANON,hr.PE_STR_FMT_WKT=pe.PeDefs.prototype.PE_STR_FMT_WKT,hr.PE_STR_FMT_WKT2=pe.PeDefs.prototype.PE_STR_FMT_WKT2,hr.PE_PARM_X0=pe.PeDefs.prototype.PE_PARM_X0,hr.PE_PARM_ND=pe.PeDefs.prototype.PE_PARM_ND,hr.PE_TRANSFORM_1_TO_2=pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,hr.PE_TRANSFORM_2_TO_1=pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,hr.PE_TRANSFORM_P_TO_G=pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,hr.PE_TRANSFORM_G_TO_P=pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,hr.PE_HORIZON_RECT=pe.PeDefs.prototype.PE_HORIZON_RECT,hr.PE_HORIZON_POLY=pe.PeDefs.prototype.PE_HORIZON_POLY,hr.PE_HORIZON_LINE=pe.PeDefs.prototype.PE_HORIZON_LINE,hr.PE_HORIZON_DELTA=pe.PeDefs.prototype.PE_HORIZON_DELTA}},zfe=null;const CQ={},NQ={},OQ=t=>{const e=t.getType();switch(e){case Oi.PE_TYPE_GEOGCS:t=pe.castObject(t,pe.PeGeogcs);break;case Oi.PE_TYPE_PROJCS:t=pe.castObject(t,pe.PeProjcs);break;case Oi.PE_TYPE_GEOGTRAN:t=pe.castObject(t,pe.PeGeogtran);break;default:e&Oi.PE_TYPE_UNIT&&(t=pe.castObject(t,pe.PeUnit))}return t},D_={initialize(){pe.PeFactory.prototype.initialize(null)},coordsys:t=>D_.factoryByType(Oi.PE_TYPE_COORDSYS,t),factoryByType(t,e){let n=null,r=CQ[t];if(r||(r={},CQ[t]=r),r.hasOwnProperty(String(e))&&(n=r[e],pe.compare(n,pe.NULL)&&(n=null)),!n){const i=pe.PeFactory.prototype.factoryByType(t,e);pe.compare(i,pe.NULL)||(n=OQ(i),r[e]=n)}return n},fromString(t,e){let n=null,r=NQ[t];if(r||(r={},NQ[t]=r),r.hasOwnProperty(e)&&(n=r[e],pe.compare(n,pe.NULL)&&(n=null)),!n){const i=pe.PeFactory.prototype.fromString(t,e);pe.compare(i,pe.NULL)||(n=OQ(i),r[e]=n)}return n},geogcs:t=>D_.factoryByType(Oi.PE_TYPE_GEOGCS,t),geogtran:t=>D_.factoryByType(Oi.PE_TYPE_GEOGTRAN,t),getCode:t=>pe.PeFactory.prototype.getCode(t),projcs:t=>D_.factoryByType(Oi.PE_TYPE_PROJCS,t),unit:t=>D_.factoryByType(Oi.PE_TYPE_UNIT,t)};let LQ,Ufe=null;const VG={PE_GTLIST_OPTS_COMMON:0,init(){VG.PE_GTLIST_OPTS_COMMON=pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,LQ=pe._pe_getPeGTlistExtendedEntrySize()},getGTlist(t,e,n,r,i,s){let o=null;const a=new pe.PeInteger(s);try{const l=pe.PeGTlistExtended.prototype.getGTlist(t,e,n,r,i,a);if((s=a.val)&&(o=[l],s>1)){const c=pe.getPointer(l);for(let u=1;u<s;u++)o.push(pe.wrapPointer(c+LQ*u,pe.PeGTlistExtendedEntry))}}finally{pe.destroy(a)}return o}},G8e={destroy(t){if(t?.length){for(const e of t)ju(e),e.getEntries().forEach(n=>{ju(n);const r=n.getGeogtran();ju(r),r.getParameters().forEach(ju),[r.getGeogcs1(),r.getGeogcs2()].forEach(i=>{ju(i);const s=i.getDatum();ju(s),ju(s.getSpheroid()),ju(i.getPrimem()),ju(i.getUnit())})});pe.PeGTlistExtendedEntry.prototype.Delete(t[0])}}},B8e={geogToGeog(t,e,n,r,i){pe.ensureCache.prepare();const s=M1(n),o=n===s,a=pe.ensureFloat64(s);let l=0;r&&(l=pe.ensureFloat64(r));const c=pe._pe_geog_to_geog(pe.getPointer(t),e,a,l,i);return c&&Og(n,e,a,o),c}},W8e={geodesicCoordinate(t,e,n,r,i,s,o,a){pe.PeLineType.prototype.geodesic_coordinate(t,e,n,r,i,s,o,a)},geodeticCoordinate(t,e,n,r,i,s,o,a,l){pe.PeLineType.prototype.geodetic_coordinate(t,e,n,r,i,s,o,a,l)},geodeticDistance(t,e,n,r,i,s,o,a,l,c){pe.PeLineType.prototype.geodetic_distance(t,e,n,r,i,s,o,a,l,c)},greatEllipticDistance(t,e,n,r,i,s,o,a,l){pe.PeLineType.prototype.great_elliptic_distance(t,e,n,r,i,s,o,a,l)}},H8e={phiToEta:(t,e)=>pe.PeMath.prototype.phi_to_eta(t,e),etaToPhi:(t,e)=>pe.PeMath.prototype.eta_to_phi(t,e),phiToPhig:(t,e)=>pe.PeMath.prototype.phi_to_phig(t,e),q:(t,e,n)=>pe.PeMath.prototype.q(t,e,n),q90:(t,e)=>pe.PeMath.prototype.q90(t,e)},J6=(t,e,n,r,i,s)=>{let o,a;switch(pe.ensureCache.prepare(),t){case"dd":o=pe._pe_geog_to_dd,a=Oi.PE_DD_MAX;break;case"ddm":o=pe._pe_geog_to_ddm,a=Oi.PE_DDM_MAX;break;case"dms":o=pe._pe_geog_to_dms,a=Oi.PE_DMS_MAX}let l=0;e&&(l=pe.getPointer(e));const c=M1(r),u=pe.ensureFloat64(c),h=sO(n,a),f=o(l,n,u,i,pe.ensureInt32(h));if(f)for(let g=0;g<n;g++)s[g]=pe.UTF8ToString(h[g]);return f},Q6=(t,e,n,r,i)=>{let s;switch(pe.ensureCache.prepare(),t){case"dd":s=pe._pe_dd_to_geog;break;case"ddm":s=pe._pe_ddm_to_geog;break;case"dms":s=pe._pe_dms_to_geog}let o=0;e&&(o=pe.getPointer(e));const a=r.map(h=>pe.ensureString(h)),l=pe.ensureInt32(a),c=pe.ensureFloat64(new Array(2*n)),u=s(o,n,l,c);return u&&Og(i,n,c),u},q8e={geogToDms:(t,e,n,r,i)=>J6("dms",t,e,n,r,i),dmsToGeog:(t,e,n,r)=>Q6("dms",t,e,n,r),geogToDdm:(t,e,n,r,i)=>J6("ddm",t,e,n,r,i),ddmToGeog:(t,e,n,r)=>Q6("ddm",t,e,n,r),geogToDd:(t,e,n,r,i)=>J6("dd",t,e,n,r,i),ddToGeog:(t,e,n,r)=>Q6("dd",t,e,n,r)};let Gfe=class $_{static init(){$_.PE_MGRS_STYLE_NEW=pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,$_.PE_MGRS_STYLE_OLD=pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,$_.PE_MGRS_STYLE_AUTO=pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,$_.PE_MGRS_180_ZONE_1_PLUS=pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,$_.PE_MGRS_ADD_SPACES=pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,n,r,i,s,o,a){pe.ensureCache.prepare();let l=0;e&&(l=pe.getPointer(e));const c=M1(r),u=pe.ensureFloat64(c),h=sO(n,Oi.PE_MGRS_MAX),f=pe.ensureInt32(h),g=pe._pe_geog_to_mgrs_extended(l,n,u,i,s,o,f);if(g)for(let v=0;v<n;v++)a[v]=pe.UTF8ToString(h[v]);return g}static mgrsToGeogExtended(e,n,r,i,s){pe.ensureCache.prepare();let o=0;e&&(o=pe.getPointer(e));const a=r.map(h=>pe.ensureString(h)),l=pe.ensureInt32(a),c=pe.ensureFloat64(new Array(2*n)),u=pe._pe_mgrs_to_geog_extended(o,n,l,i,c);return u&&Og(s,n,c),u}};const K8e={geogToUsng(t,e,n,r,i,s,o){pe.ensureCache.prepare();let a=0;t&&(a=pe.getPointer(t));const l=M1(n),c=pe.ensureFloat64(l),u=sO(e,Oi.PE_MGRS_MAX),h=pe.ensureInt32(u),f=pe._pe_geog_to_usng(a,e,c,r,i,s,h);if(f)for(let g=0;g<e;g++)o[g]=pe.UTF8ToString(u[g]);return f},usngToGeog(t,e,n,r){pe.ensureCache.prepare();let i=0;t&&(i=pe.getPointer(t));const s=n.map(c=>pe.ensureString(c)),o=pe.ensureInt32(s),a=pe.ensureFloat64(new Array(2*e)),l=pe._pe_usng_to_geog(i,e,o,a);return l&&Og(r,e,a),l}};let Bfe=class BM{static init(){BM.PE_UTM_OPTS_NONE=pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,BM.PE_UTM_OPTS_ADD_SPACES=pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,BM.PE_UTM_OPTS_NS=pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,n,r,i,s){pe.ensureCache.prepare();let o=0;e&&(o=pe.getPointer(e));const a=M1(r),l=pe.ensureFloat64(a),c=sO(n,Oi.PE_UTM_MAX),u=pe.ensureInt32(c),h=pe._pe_geog_to_utm(o,n,l,i,u);if(h)for(let f=0;f<n;f++)s[f]=pe.UTF8ToString(c[f]);return h}static utmToGeog(e,n,r,i,s){pe.ensureCache.prepare();let o=0;e&&(o=pe.getPointer(e));const a=r.map(h=>pe.ensureString(h)),l=pe.ensureInt32(a),c=pe.ensureFloat64(new Array(2*n)),u=pe._pe_utm_to_geog(o,n,l,i,c);return u&&Og(s,n,c),u}};var sl;let Wfe=(sl=class{static init(){sl.PE_PCSINFO_OPTION_NONE=pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,sl.PE_PCSINFO_OPTION_DOMAIN=pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,sl.PE_POLE_OUTSIDE_BOUNDARY=pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,sl.PE_POLE_POINT=pe.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,n=sl.PE_PCSINFO_OPTION_DOMAIN){let r=null,i=null;return sl.cache.has(e)&&(i=sl.cache.get(e),i[n]&&(r=i[n])),r||(r=pe.PePCSInfo.prototype.generate(e,n),i||(i=[],sl.cache.set(e,i)),i[n]=r),r}},sl.cache=new Map,sl);const Y8e={versionString:()=>pe.PeVersion.prototype.version_string()};function Hfe(t){function e(s,o,a){s[o]=a(s[o])}pe=t,Oi.init(),VG.init(),Gfe.init(),Bfe.init(),Wfe.init(),zfe=class extends pe.PeDouble{constructor(s=NaN){super(s)}destroy(){pe.destroy(this)}[Symbol.dispose](){this.destroy()}},Ufe=class extends pe.PeGCSExtent{destroy(){pe.destroy(this)}[Symbol.dispose](){this.destroy()}};const n=[pe.PeAngunit,pe.PeDatum,pe.PeGeogcs,pe.PeGeogtran,pe.PeObject,pe.PeParameter,pe.PePrimem,pe.PeProjcs,pe.PeSpheroid,pe.PeUnit];for(const s of n)e(s.prototype,"getName",o=>function(){return o.call(this,new Array(Oi.PE_NAME_MAX))});for(const s of[pe.PeGeogtran,pe.PeProjcs])e(s.prototype,"getParameters",o=>function(){const a=new Array(Oi.PE_PARM_MAX);let l=o.call(this);for(let c=0;c<a.length;c++){const u=pe.getValue(l,"*");a[c]=u?pe.wrapPointer(u,pe.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(pe.PeHorizon.prototype,"getCoord",s=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return Og(l,a,s.call(this),o),l}),e(pe.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=pe._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=s.call(this);if(!pe.compare(l,pe.NULL)){a=[l];const c=this.getSteps();if(c>1){const u=pe.getPointer(l);for(let h=1;h<c;h++)a.push(pe.wrapPointer(u+o*h,pe.PeGTlistExtendedGTs))}}return a}});const r=pe._pe_getPeHorizonSize(),i=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const l=s.call(this);if(!pe.compare(l,pe.NULL)){a=[l];const c=l.getNump();if(c>1){const u=pe.getPointer(l);for(let h=1;h<c;h++)a.push(pe.wrapPointer(u+r*h,pe.PeHorizon))}}return o.set(s,a),a};e(pe.PeProjcs.prototype,"horizonGcsGenerate",i),e(pe.PeProjcs.prototype,"horizonPcsGenerate",i),pe.PeObject.prototype.toString=function(s=Oi.PE_STR_OPTS_NONE){pe.ensureCache.prepare();const o=pe.getPointer(this),a=pe.ensureInt8(new Array(Oi.PE_BUFFER_MAX));return pe.UTF8ToString(pe._pe_object_to_string_ext(o,s,a))},pe.PeGeogcs.prototype.destroy=function(){this.Delete(),ju(this),this.ptr=0},pe.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},pe.PeProjcs.prototype.destroy=function(){this.Delete(),ju(this),this.ptr=0},pe.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function ju(t){if(!t)return;const e=pe.getClass(t);if(!e)return;const n=pe.getCache(e);if(!n)return;const r=pe.getPointer(t);r&&delete n[r]}function sO(t,e){const n=[],r=new Array(e);for(let i=0;i<t;i++)n.push(pe.ensureInt8(r));return n}function M1(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function Og(t,e,n,r=!1){if(r)for(let i=0;i<2*e;i++)t[i]=pe.getValue(n+i*Float64Array.BYTES_PER_ELEMENT,"double");else{const i=t.length===0;for(let s=0;s<e;s++)i&&(t[s]=new Array(2)),t[s][0]=pe.getValue(n,"double"),t[s][1]=pe.getValue(n+Float64Array.BYTES_PER_ELEMENT,"double"),n+=2*Float64Array.BYTES_PER_ELEMENT}}const UAt=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:GM,PeDefs:Oi,get PeDouble(){return zfe},PeFactory:D_,get PeGCSExtent(){return Ufe},PeGTTransformations:B8e,PeGTlistExtended:VG,PeGTlistExtendedEntry:G8e,PeLineType:W8e,PeMath:H8e,PeNotationDms:q8e,PeNotationMgrs:Gfe,PeNotationUsng:K8e,PeNotationUtm:Bfe,PePCSInfo:Wfe,PeVersion:Y8e,_init:Hfe,get _pe(){return pe},isLoaded:Vfe,isSupported:z8e,load:U8e},Symbol.toStringTag,{value:"Module"}));let y;const H={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10641:0,10665:0,10674:0,10744:0,10745:0,10759:0,10773:0,10802:0,10820:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,65061:2,65062:2,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(y=2e3;y<=2045;y++)H[y]=0;for(y=2056;y<=2065;y++)H[y]=0;for(y=2067;y<=2135;y++)H[y]=0;for(y=2137;y<=2154;y++)H[y]=0;for(y=2161;y<=2170;y++)H[y]=0;for(y=2172;y<=2193;y++)H[y]=0;for(y=2195;y<=2198;y++)H[y]=0;for(y=2200;y<=2203;y++)H[y]=0;for(y=2205;y<=2217;y++)H[y]=0;for(y=2222;y<=2224;y++)H[y]=1;for(y=2225;y<=2250;y++)H[y]=2;for(y=2251;y<=2253;y++)H[y]=1;for(y=2257;y<=2264;y++)H[y]=2;for(y=2274;y<=2279;y++)H[y]=2;for(y=2280;y<=2282;y++)H[y]=1;for(y=2283;y<=2289;y++)H[y]=2;for(y=2290;y<=2292;y++)H[y]=0;for(y=2308;y<=2313;y++)H[y]=0;for(y=2315;y<=2491;y++)H[y]=0;for(y=2494;y<=2866;y++)H[y]=0;for(y=2867;y<=2869;y++)H[y]=1;for(y=2870;y<=2888;y++)H[y]=2;for(y=2891;y<=2895;y++)H[y]=2;for(y=2896;y<=2898;y++)H[y]=1;for(y=2902;y<=2908;y++)H[y]=2;for(y=2915;y<=2920;y++)H[y]=2;for(y=2921;y<=2923;y++)H[y]=1;for(y=2924;y<=2930;y++)H[y]=2;for(y=2931;y<=2962;y++)H[y]=0;for(y=2964;y<=2968;y++)H[y]=2;for(y=2969;y<=2973;y++)H[y]=0;for(y=2975;y<=2991;y++)H[y]=0;for(y=2995;y<=3051;y++)H[y]=0;for(y=3054;y<=3079;y++)H[y]=0;for(y=3081;y<=3088;y++)H[y]=0;for(y=3092;y<=3101;y++)H[y]=0;for(y=3106;y<=3138;y++)H[y]=0;for(y=3146;y<=3151;y++)H[y]=0;for(y=3153;y<=3166;y++)H[y]=0;for(y=3168;y<=3172;y++)H[y]=0;for(y=3174;y<=3203;y++)H[y]=0;for(y=3294;y<=3358;y++)H[y]=0;for(y=3367;y<=3403;y++)H[y]=0;for(y=3408;y<=3416;y++)H[y]=0;for(y=3417;y<=3438;y++)H[y]=2;for(y=3441;y<=3446;y++)H[y]=2;for(y=3447;y<=3450;y++)H[y]=0;for(y=3451;y<=3459;y++)H[y]=2;for(y=3460;y<=3478;y++)H[y]=0;for(y=3554;y<=3559;y++)H[y]=0;for(y=3560;y<=3570;y++)H[y]=2;for(y=3571;y<=3581;y++)H[y]=0;for(y=3594;y<=3597;y++)H[y]=0;for(y=3601;y<=3604;y++)H[y]=0;for(y=3637;y<=3639;y++)H[y]=0;for(y=3665;y<=3667;y++)H[y]=0;for(y=3693;y<=3695;y++)H[y]=0;for(y=3701;y<=3727;y++)H[y]=0;for(y=3728;y<=3739;y++)H[y]=2;for(y=3740;y<=3751;y++)H[y]=0;for(y=3753;y<=3760;y++)H[y]=2;for(y=3761;y<=3773;y++)H[y]=0;for(y=3775;y<=3777;y++)H[y]=0;for(y=3779;y<=3781;y++)H[y]=0;for(y=3783;y<=3785;y++)H[y]=0;for(y=3788;y<=3791;y++)H[y]=0;for(y=3797;y<=3802;y++)H[y]=0;for(y=3814;y<=3816;y++)H[y]=0;for(y=3825;y<=3829;y++)H[y]=0;for(y=3832;y<=3841;y++)H[y]=0;for(y=3844;y<=3852;y++)H[y]=0;for(y=3873;y<=3885;y++)H[y]=0;for(y=3890;y<=3893;y++)H[y]=0;for(y=3907;y<=3912;y++)H[y]=0;for(y=3942;y<=3950;y++)H[y]=0;for(y=3968;y<=3970;y++)H[y]=0;for(y=3973;y<=3976;y++)H[y]=0;for(y=3986;y<=3989;y++)H[y]=0;for(y=3994;y<=3997;y++)H[y]=0;for(y=4048;y<=4051;y++)H[y]=0;for(y=4056;y<=4063;y++)H[y]=0;for(y=4093;y<=4096;y++)H[y]=0;for(y=4390;y<=4398;y++)H[y]=0;for(y=4399;y<=4413;y++)H[y]=2;for(y=4418;y<=4433;y++)H[y]=2;for(y=4455;y<=4457;y++)H[y]=2;for(y=4484;y<=4489;y++)H[y]=0;for(y=4491;y<=4554;y++)H[y]=0;for(y=4568;y<=4589;y++)H[y]=0;for(y=4652;y<=4656;y++)H[y]=0;for(y=4766;y<=4800;y++)H[y]=0;for(y=5014;y<=5016;y++)H[y]=0;for(y=5069;y<=5072;y++)H[y]=0;for(y=5105;y<=5130;y++)H[y]=0;for(y=5167;y<=5188;y++)H[y]=0;for(y=5253;y<=5259;y++)H[y]=0;for(y=5269;y<=5275;y++)H[y]=0;for(y=5292;y<=5311;y++)H[y]=0;for(y=5329;y<=5331;y++)H[y]=0;for(y=5343;y<=5349;y++)H[y]=0;for(y=5355;y<=5357;y++)H[y]=0;for(y=5387;y<=5389;y++)H[y]=0;for(y=5459;y<=5463;y++)H[y]=0;for(y=5479;y<=5482;y++)H[y]=0;for(y=5518;y<=5520;y++)H[y]=0;for(y=5530;y<=5539;y++)H[y]=0;for(y=5550;y<=5552;y++)H[y]=0;for(y=5562;y<=5583;y++)H[y]=0;for(y=5623;y<=5625;y++)H[y]=2;for(y=5631;y<=5639;y++)H[y]=0;for(y=5649;y<=5653;y++)H[y]=0;for(y=5663;y<=5680;y++)H[y]=0;for(y=5682;y<=5685;y++)H[y]=0;for(y=5875;y<=5877;y++)H[y]=0;for(y=5896;y<=5899;y++)H[y]=0;for(y=5921;y<=5940;y++)H[y]=0;for(y=6050;y<=6125;y++)H[y]=0;for(y=6244;y<=6275;y++)H[y]=0;for(y=6328;y<=6348;y++)H[y]=0;for(y=6350;y<=6356;y++)H[y]=0;for(y=6366;y<=6372;y++)H[y]=0;for(y=6381;y<=6387;y++)H[y]=0;for(y=6393;y<=6404;y++)H[y]=0;for(y=6480;y<=6483;y++)H[y]=0;for(y=6511;y<=6514;y++)H[y]=0;for(y=6579;y<=6581;y++)H[y]=0;for(y=6619;y<=6624;y++)H[y]=0;for(y=6625;y<=6627;y++)H[y]=2;for(y=6628;y<=6632;y++)H[y]=0;for(y=6634;y<=6637;y++)H[y]=0;for(y=6669;y<=6692;y++)H[y]=0;for(y=6707;y<=6709;y++)H[y]=0;for(y=6720;y<=6723;y++)H[y]=0;for(y=6732;y<=6738;y++)H[y]=0;for(y=6931;y<=6933;y++)H[y]=0;for(y=6956;y<=6959;y++)H[y]=0;for(y=7005;y<=7007;y++)H[y]=0;for(y=7057;y<=7070;y++)H[y]=2;for(y=7074;y<=7082;y++)H[y]=0;for(y=7109;y<=7118;y++)H[y]=0;for(y=7119;y<=7127;y++)H[y]=1;for(y=7374;y<=7376;y++)H[y]=0;for(y=7528;y<=7586;y++)H[y]=0;for(y=7587;y<=7645;y++)H[y]=2;for(y=7692;y<=7696;y++)H[y]=0;for(y=7755;y<=7787;y++)H[y]=0;for(y=7791;y<=7795;y++)H[y]=0;for(y=7799;y<=7801;y++)H[y]=0;for(y=7803;y<=7805;y++)H[y]=0;for(y=7825;y<=7831;y++)H[y]=0;for(y=7845;y<=7859;y++)H[y]=0;for(y=8013;y<=8032;y++)H[y]=0;for(y=8065;y<=8068;y++)H[y]=1;for(y=8518;y<=8529;y++)H[y]=2;for(y=8533;y<=8536;y++)H[y]=2;for(y=8538;y<=8540;y++)H[y]=2;for(y=8677;y<=8679;y++)H[y]=0;for(y=8836;y<=8840;y++)H[y]=0;for(y=8857;y<=8859;y++)H[y]=0;for(y=8908;y<=8910;y++)H[y]=0;for(y=9154;y<=9159;y++)H[y]=0;for(y=9205;y<=9218;y++)H[y]=0;for(y=9271;y<=9273;y++)H[y]=0;for(y=9295;y<=9297;y++)H[y]=0;for(y=9356;y<=9360;y++)H[y]=0;for(y=9404;y<=9407;y++)H[y]=0;for(y=9476;y<=9482;y++)H[y]=0;for(y=9487;y<=9494;y++)H[y]=0;for(y=9697;y<=9699;y++)H[y]=0;for(y=9821;y<=9865;y++)H[y]=0;for(y=10285;y<=10291;y++)H[y]=0;for(y=10314;y<=10317;y++)H[y]=0;for(y=10448;y<=10465;y++)H[y]=0;for(y=10726;y<=10729;y++)H[y]=0;for(y=10731;y<=10733;y++)H[y]=0;for(y=11114;y<=11118;y++)H[y]=0;for(y=20004;y<=20032;y++)H[y]=0;for(y=20047;y<=20049;y++)H[y]=0;for(y=20062;y<=20092;y++)H[y]=0;for(y=20135;y<=20138;y++)H[y]=0;for(y=20248;y<=20258;y++)H[y]=0;for(y=20348;y<=20358;y++)H[y]=0;for(y=20436;y<=20440;y++)H[y]=0;for(y=20822;y<=20824;y++)H[y]=0;for(y=20904;y<=20932;y++)H[y]=0;for(y=20934;y<=20936;y++)H[y]=0;for(y=21004;y<=21032;y++)H[y]=0;for(y=21035;y<=21037;y++)H[y]=0;for(y=21095;y<=21097;y++)H[y]=0;for(y=21148;y<=21150;y++)H[y]=0;for(y=21207;y<=21264;y++)H[y]=0;for(y=21307;y<=21364;y++)H[y]=0;for(y=21413;y<=21423;y++)H[y]=0;for(y=21453;y<=21463;y++)H[y]=0;for(y=21473;y<=21483;y++)H[y]=0;for(y=21780;y<=21782;y++)H[y]=0;for(y=21891;y<=21894;y++)H[y]=0;for(y=21896;y<=21899;y++)H[y]=0;for(y=22171;y<=22177;y++)H[y]=0;for(y=22181;y<=22187;y++)H[y]=0;for(y=22191;y<=22197;y++)H[y]=0;for(y=22207;y<=22222;y++)H[y]=0;for(y=22229;y<=22232;y++)H[y]=0;for(y=22234;y<=22236;y++)H[y]=0;for(y=22243;y<=22250;y++)H[y]=0;for(y=22262;y<=22265;y++)H[y]=0;for(y=22307;y<=22322;y++)H[y]=0;for(y=22348;y<=22357;y++)H[y]=0;for(y=22407;y<=22422;y++)H[y]=0;for(y=22462;y<=22465;y++)H[y]=0;for(y=22521;y<=22525;y++)H[y]=0;for(y=22607;y<=22622;y++)H[y]=0;for(y=22641;y<=22646;y++)H[y]=0;for(y=22648;y<=22657;y++)H[y]=0;for(y=22707;y<=22722;y++)H[y]=0;for(y=22762;y<=22765;y++)H[y]=0;for(y=22807;y<=22822;y++)H[y]=0;for(y=22991;y<=22994;y++)H[y]=0;for(y=23028;y<=23038;y++)H[y]=0;for(y=23301;y<=23333;y++)H[y]=2;for(y=23830;y<=23853;y++)H[y]=0;for(y=23866;y<=23872;y++)H[y]=0;for(y=23877;y<=23884;y++)H[y]=0;for(y=23886;y<=23894;y++)H[y]=0;for(y=23946;y<=23948;y++)H[y]=0;for(y=24311;y<=24313;y++)H[y]=0;for(y=24342;y<=24347;y++)H[y]=0;for(y=24370;y<=24374;y++)H[y]=10;for(y=24375;y<=24381;y++)H[y]=0;for(y=24718;y<=24721;y++)H[y]=0;for(y=24817;y<=24821;y++)H[y]=0;for(y=24877;y<=24882;y++)H[y]=0;for(y=24891;y<=24893;y++)H[y]=0;for(y=25391;y<=25395;y++)H[y]=0;for(y=25828;y<=25838;y++)H[y]=0;for(y=26191;y<=26195;y++)H[y]=0;for(y=26391;y<=26393;y++)H[y]=0;for(y=26701;y<=26722;y++)H[y]=0;for(y=26729;y<=26799;y++)H[y]=2;for(y=26801;y<=26803;y++)H[y]=2;for(y=26811;y<=26813;y++)H[y]=2;for(y=26847;y<=26870;y++)H[y]=2;for(y=26891;y<=26899;y++)H[y]=0;for(y=26901;y<=26923;y++)H[y]=0;for(y=26929;y<=26946;y++)H[y]=0;for(y=26948;y<=26998;y++)H[y]=0;for(y=27037;y<=27040;y++)H[y]=0;for(y=27205;y<=27232;y++)H[y]=0;for(y=27258;y<=27260;y++)H[y]=0;for(y=27391;y<=27398;y++)H[y]=0;for(y=27561;y<=27564;y++)H[y]=0;for(y=27571;y<=27574;y++)H[y]=0;for(y=27581;y<=27584;y++)H[y]=0;for(y=27591;y<=27594;y++)H[y]=0;for(y=27700;y<=27707;y++)H[y]=0;for(y=28191;y<=28193;y++)H[y]=0;for(y=28348;y<=28358;y++)H[y]=0;for(y=28402;y<=28432;y++)H[y]=0;for(y=28462;y<=28492;y++)H[y]=0;for(y=29118;y<=29122;y++)H[y]=0;for(y=29168;y<=29172;y++)H[y]=0;for(y=29177;y<=29185;y++)H[y]=0;for(y=29187;y<=29195;y++)H[y]=0;for(y=29900;y<=29903;y++)H[y]=0;for(y=30161;y<=30179;y++)H[y]=0;for(y=30491;y<=30494;y++)H[y]=0;for(y=30729;y<=30732;y++)H[y]=0;for(y=31251;y<=31259;y++)H[y]=0;for(y=31265;y<=31268;y++)H[y]=0;for(y=31275;y<=31279;y++)H[y]=0;for(y=31281;y<=31297;y++)H[y]=0;for(y=31461;y<=31469;y++)H[y]=0;for(y=31491;y<=31495;y++)H[y]=0;for(y=31917;y<=31922;y++)H[y]=0;for(y=31965;y<=32e3;y++)H[y]=0;for(y=32001;y<=32003;y++)H[y]=2;for(y=32005;y<=32031;y++)H[y]=2;for(y=32033;y<=32060;y++)H[y]=2;for(y=32064;y<=32067;y++)H[y]=2;for(y=32074;y<=32077;y++)H[y]=2;for(y=32081;y<=32086;y++)H[y]=0;for(y=32107;y<=32130;y++)H[y]=0;for(y=32133;y<=32159;y++)H[y]=0;for(y=32164;y<=32167;y++)H[y]=2;for(y=32180;y<=32199;y++)H[y]=0;for(y=32201;y<=32260;y++)H[y]=0;for(y=32301;y<=32360;y++)H[y]=0;for(y=32401;y<=32460;y++)H[y]=0;for(y=32501;y<=32560;y++)H[y]=0;for(y=32601;y<=32662;y++)H[y]=0;for(y=32664;y<=32667;y++)H[y]=2;for(y=32701;y<=32761;y++)H[y]=0;for(y=53001;y<=53004;y++)H[y]=0;for(y=53008;y<=53019;y++)H[y]=0;for(y=53021;y<=53032;y++)H[y]=0;for(y=53034;y<=53037;y++)H[y]=0;for(y=53042;y<=53046;y++)H[y]=0;for(y=53074;y<=53080;y++)H[y]=0;for(y=54001;y<=54004;y++)H[y]=0;for(y=54008;y<=54019;y++)H[y]=0;for(y=54021;y<=54032;y++)H[y]=0;for(y=54034;y<=54037;y++)H[y]=0;for(y=54042;y<=54046;y++)H[y]=0;for(y=54048;y<=54053;y++)H[y]=0;for(y=54074;y<=54080;y++)H[y]=0;for(y=54090;y<=54096;y++)H[y]=0;for(y=54098;y<=54101;y++)H[y]=0;for(y=65161;y<=65163;y++)H[y]=0;for(y=102001;y<=102040;y++)H[y]=0;for(y=102042;y<=102063;y++)H[y]=0;for(y=102065;y<=102067;y++)H[y]=0;for(y=102070;y<=102117;y++)H[y]=0;for(y=102122;y<=102216;y++)H[y]=0;for(y=102221;y<=102377;y++)H[y]=0;for(y=102382;y<=102388;y++)H[y]=0;for(y=102389;y<=102398;y++)H[y]=2;for(y=102399;y<=102444;y++)H[y]=0;for(y=102445;y<=102447;y++)H[y]=2;for(y=102448;y<=102458;y++)H[y]=0;for(y=102459;y<=102468;y++)H[y]=2;for(y=102469;y<=102499;y++)H[y]=0;for(y=102500;y<=102519;y++)H[y]=1;for(y=102520;y<=102524;y++)H[y]=0;for(y=102525;y<=102529;y++)H[y]=2;for(y=102530;y<=102588;y++)H[y]=0;for(y=102590;y<=102598;y++)H[y]=0;for(y=102601;y<=102603;y++)H[y]=0;for(y=102605;y<=102628;y++)H[y]=0;for(y=102629;y<=102646;y++)H[y]=2;for(y=102648;y<=102700;y++)H[y]=2;for(y=102701;y<=102703;y++)H[y]=0;for(y=102707;y<=102730;y++)H[y]=2;for(y=102733;y<=102758;y++)H[y]=2;for(y=102767;y<=102900;y++)H[y]=0;for(y=102901;y<=102933;y++)H[y]=2;for(y=102934;y<=102950;y++)H[y]=13;for(y=102951;y<=102963;y++)H[y]=0;for(y=102965;y<=102969;y++)H[y]=0;for(y=102971;y<=102973;y++)H[y]=0;for(y=102975;y<=102989;y++)H[y]=0;for(y=102990;y<=102992;y++)H[y]=1;for(y=102997;y<=103002;y++)H[y]=0;for(y=103003;y<=103008;y++)H[y]=2;for(y=103009;y<=103011;y++)H[y]=0;for(y=103012;y<=103014;y++)H[y]=2;for(y=103019;y<=103021;y++)H[y]=0;for(y=103022;y<=103024;y++)H[y]=2;for(y=103029;y<=103031;y++)H[y]=0;for(y=103032;y<=103034;y++)H[y]=2;for(y=103065;y<=103068;y++)H[y]=0;for(y=103074;y<=103076;y++)H[y]=0;for(y=103077;y<=103079;y++)H[y]=1;for(y=103080;y<=103082;y++)H[y]=0;for(y=103083;y<=103085;y++)H[y]=2;for(y=103090;y<=103093;y++)H[y]=0;for(y=103097;y<=103099;y++)H[y]=0;for(y=103100;y<=103102;y++)H[y]=2;for(y=103107;y<=103109;y++)H[y]=0;for(y=103110;y<=103112;y++)H[y]=2;for(y=103113;y<=103116;y++)H[y]=0;for(y=103117;y<=103120;y++)H[y]=2;for(y=103153;y<=103157;y++)H[y]=0;for(y=103158;y<=103162;y++)H[y]=2;for(y=103163;y<=103165;y++)H[y]=0;for(y=103166;y<=103168;y++)H[y]=1;for(y=103169;y<=103171;y++)H[y]=2;for(y=103186;y<=103188;y++)H[y]=0;for(y=103189;y<=103191;y++)H[y]=2;for(y=103192;y<=103195;y++)H[y]=0;for(y=103196;y<=103199;y++)H[y]=2;for(y=103200;y<=103224;y++)H[y]=0;for(y=103225;y<=103227;y++)H[y]=1;for(y=103232;y<=103237;y++)H[y]=0;for(y=103238;y<=103243;y++)H[y]=2;for(y=103244;y<=103246;y++)H[y]=0;for(y=103247;y<=103249;y++)H[y]=2;for(y=103254;y<=103256;y++)H[y]=0;for(y=103257;y<=103259;y++)H[y]=2;for(y=103264;y<=103266;y++)H[y]=0;for(y=103267;y<=103269;y++)H[y]=2;for(y=103300;y<=103375;y++)H[y]=0;for(y=103381;y<=103383;y++)H[y]=0;for(y=103384;y<=103386;y++)H[y]=1;for(y=103387;y<=103389;y++)H[y]=0;for(y=103390;y<=103392;y++)H[y]=2;for(y=103397;y<=103399;y++)H[y]=0;for(y=103400;y<=103471;y++)H[y]=2;for(y=103476;y<=103478;y++)H[y]=0;for(y=103479;y<=103481;y++)H[y]=2;for(y=103486;y<=103488;y++)H[y]=0;for(y=103489;y<=103491;y++)H[y]=2;for(y=103492;y<=103495;y++)H[y]=0;for(y=103496;y<=103499;y++)H[y]=2;for(y=103528;y<=103543;y++)H[y]=0;for(y=103544;y<=103548;y++)H[y]=2;for(y=103549;y<=103551;y++)H[y]=0;for(y=103552;y<=103554;y++)H[y]=1;for(y=103555;y<=103557;y++)H[y]=2;for(y=103558;y<=103560;y++)H[y]=0;for(y=103571;y<=103573;y++)H[y]=0;for(y=103574;y<=103576;y++)H[y]=2;for(y=103577;y<=103580;y++)H[y]=0;for(y=103581;y<=103583;y++)H[y]=2;for(y=103595;y<=103694;y++)H[y]=0;for(y=103696;y<=103699;y++)H[y]=0;for(y=103700;y<=103793;y++)H[y]=2;for(y=103794;y<=103890;y++)H[y]=0;for(y=103891;y<=103896;y++)H[y]=2;for(y=103900;y<=103971;y++)H[y]=2;for(y=103972;y<=103977;y++)H[y]=0;for(y=112e3;y<=112101;y++)H[y]=0;const qfe=[102100,102113,3857,3785,900913],X8e=[104905,104971],Z8e=[104903],J8e=[4326,...qfe,...X8e,...Z8e],Ek=[-20037508342788905e-9,20037508342788905e-9],kF=[-20037508342787e-6,20037508342787e-6],e$={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:Ek,origin:kF,dx:1e-5},Kfe={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Ek,origin:kF,dx:1e-5},102100:e$,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:Ek,origin:kF,dx:1e-5},3857:e$,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:e$,104903:{wkTemplate:'GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400,0,AUTHORITY["ESRI","107903"]],AUTHORITY["ESRI","106903"]],PRIMEM["Reference_Meridian",0,AUTHORITY["ESRI","108900"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["ESRI","104903"]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function uo(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const n=t.wkid,r=e.wkid;if(n!=null||r!=null){if(n===r||kd(t)&&kd(e))return!0;const o=t.latestWkid;if(o!=null&&r===o)return!0;const a=e.latestWkid;return a!=null&&n===a}let i,s;return t.wkt2&&e.wkt2?(i=t.wkt2,s=e.wkt2):t.wkt&&e.wkt&&(i=t.wkt,s=e.wkt),!(!i||!s)&&i.toUpperCase()===s.toUpperCase()}function La(t){const e=t?.wkid;return e!=null&&e>=2e3&&Kfe[e]||null}function Yfe(t){if(!t)return;const{wkid:e,vcsWkid:n}=t;if(e)return n?JSON.stringify({wkid:e,vcsWkid:n}):String(e);const r=t.wkt||t.wkt2;return JSON.stringify(r?n?{wkt:r,vcsWkid:n}:{wkt:r}:{})}function X2(t){if(!rc(t))return!1;const{wkid:e}=t;if(e)return H[e]==null;const n=t.wkt2||t.wkt;return!!n&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(n)}function Q8e(t){return!(Xfe(t)||Zfe(t))}function C1(t){return t?.wkid===4326}function GAt(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function DQ(t){return t?.wkid===4490}function kd(t){const e=t?.wkid;return e!=null&&e>=2e3&&qfe.includes(e)}function eje(t){return t?.wkid===32662}function oO(t){return t===104971||t===104905}function Xfe(t){return oO(t?.wkid)}function aO(t){return t===104903}function Zfe(t){return aO(t?.wkid)}function tje(t){const e=t?.wkid;return e!=null&&e>=2e3&&J8e.includes(e)}function rc(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const Jfe={wkid:4326,wkt:ude(Kfe[4326].wkTemplate,{Central_Meridian:"0.0"})},Qfe={wkid:102100,latestWkid:3857},nje={wkid:32662};function zG(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const rje=zG(ts),UG=zG(pd),GG=zG(Ng),ije={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${ts.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},sje=UG.wkt.toUpperCase(),oje=GG.wkt.toUpperCase();function aje(t){if(t!=null&&rc(t)){const e=t.wkid,n=t.wkt2??t.wkt;if(oO(e))return pd;const r=n?.toUpperCase();if(n&&r===sje)return pd;if(aO(e)||r&&r===oje)return Ng}return ts}function BAt(t){return oO(t)?pd:aO(t)?Ng:ts}function _4(t){return uo(t,rje)}function Lg(t){return _4(t)||uo(t,UG)||uo(t,GG)}const WAt=39.37,lje=ts.radius*Math.PI/200,epe=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,o2=H,tpe=/UNIT\[([^\]]+)]/i,cje=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),uje=kl()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),ku=t=>t*t,sm=t=>t*t*t,Sk={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:ku(.001)},"square-centimeters":{inBaseUnits:ku(.01)},"square-decimeters":{inBaseUnits:ku(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:ku(1e3)},"square-inches":{inBaseUnits:ku(.0254)},"square-feet":{inBaseUnits:ku(.3048)},"square-yards":{inBaseUnits:ku(.9144)},"square-miles":{inBaseUnits:ku(1609.344)},"square-nautical-miles":{inBaseUnits:ku(1852)},"square-us-feet":{inBaseUnits:ku(1200/3937)},acres:{inBaseUnits:.0015625*ku(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*sm(.001)},"cubic-centimeters":{inBaseUnits:1e3*sm(.01)},"cubic-decimeters":{inBaseUnits:1e3*sm(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*sm(1e3)},"cubic-inches":{inBaseUnits:1e3*sm(.0254)},"cubic-feet":{inBaseUnits:1e3*sm(.3048)},"cubic-yards":{inBaseUnits:1e3*sm(.9144)},"cubic-miles":{inBaseUnits:1e3*sm(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},hje=(()=>{const t={};for(const e in Sk)for(const n in Sk[e].units)t[n]=e;return t})();function dje(t,e,n){return t*Sk[n].units[e].inBaseUnits}function fje(t,e,n){return t/Sk[n].units[e].inBaseUnits}const pje=["inches","feet","yards","miles","nautical-miles","us-feet","millimeters","centimeters","decimeters","meters","kilometers"],mje=["metric","imperial"],npe=[...mje,...pje],gje=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function AF(t){const e=hje[t];if(!e)throw new Error("unknown type");return e}function $Q(t,e=null){return e=e||AF(t),Sk[e].baseUnit===t}function lh(t,e,n){if(e===n)return t;const r=AF(e);if(r!==AF(n))throw new Error("incompatible units");const i=$Q(e,r)?t:dje(t,e,r);return $Q(n,r)?i:fje(i,n,r)}function HAt(t,e,n,r=!1){if(!r&&X2(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const i=iv(e);return i!==n&&(t=i?lh(t,i,n):lh(t*=Dd(e),"meters",n)),t}function qAt(t,e,n,r=!1){if(!r&&X2(n))throw new Error("Unable to convert from a linear unit to an angular unit.");const i=iv(n);return e!==i&&(t=i?lh(t,e,i):lh(t,e,"meters")/Dd(n)),t}function yje(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function KAt(t){return yje(t)}function YAt(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function XAt(t,e,n){switch(n){case"metric":return vje(t,e);case"imperial":return xje(t,e);default:return n}}function ZAt(t,e,n){switch(n){case"metric":return _je(t,e);case"imperial":return wje(t,e);default:return n}}function vje(t,e){const n=lh(t,e,"meters");return Math.abs(n)<3e3?"meters":"kilometers"}function _je(t,e){const n=lh(t,e,"meters");return Math.abs(n)<1e5?"meters":"kilometers"}function xje(t,e){const n=lh(t,e,"feet");return Math.abs(n)<1e3?"feet":"miles"}function wje(t,e){const n=lh(t,e,"feet");return Math.abs(n)<1e5?"feet":"miles"}function JAt(t,e){const n=lh(t,e,"square-meters");return Math.abs(n)<3e6?"square-meters":"square-kilometers"}function QAt(t,e){const n=lh(t,e,"square-feet");return Math.abs(n)<1e6?"square-feet":"square-miles"}function eIt(t,e,n){return lh(t,e,"meters")/(n*Math.PI/180)}function BG(t){return uje.fromJSON(t.toLowerCase())||null}function jQ(t){if(t!=null&&!Q8e(t))return 1;const e=Dd(t);return e>1e5?1:e}function rpe(t){return Dd(t)>=aje(t).metersPerDegree?"meters":iv(t)}function Dd(t,e=ts.metersPerDegree){return bje(t,!0)??e}function bje(t,e=!1){const n=t?.wkid??null,r=t?.wkt2??t?.wkt??null;let i=null;if(n){if(oO(n))return pd.metersPerDegree;if(aO(n))return Ng.metersPerDegree;i=o2.values[o2[n]],!i&&e&&cje.has(n)&&(i=lje)}else r&&(ope(r)?i=FQ(epe.exec(r),i):spe(r)&&(i=FQ(tpe.exec(r),i)));return i}function tIt(t){return X2(t)?1:Dd(t)}function FQ(t,e){return t?.[1]?ipe(t[1]):e}function ipe(t){return parseFloat(t.split(",")[1])}function iv(t){const e=t?.wkid??null,n=t?.wkt2??t?.wkt??null;let r=null;if(e)r=o2.units[o2[e]];else if(n){const i=ope(n)?epe:spe(n)?tpe:null;if(i){const s=i.exec(n);s?.[1]&&(r=Sje(s[1]))}}return r!=null?BG(r):null}function nIt(t){const e=iv(t);return e!=null&&npe.includes(e)?e:null}function rIt(t){const e=rpe(t);return e!=null&&npe.includes(e)?e:null}function iIt(t){const e=iv(t);return e==null?null:gje.get(e)}function spe(t){return/^GEOCCS/i.test(t)}function ope(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const Eje=1e-7;function Sje(t){let n=/[\\"']([^\\"']+)/.exec(t)?.[1];if(!n||!BG(n)){const r=ipe(t);n=null;const i=o2.values;for(let s=0;s<i.length;++s)if(Math.abs(r-i[s])<Eje){n=o2.units[s];break}}return n}function sIt(t){const e=iv(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const Tje={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},kje={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},Aje={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},oIt=kl()(Tje),aIt=kl()(kje),lIt=kl()(Aje);var Dh,ed;let Bt=(ed=class extends qt{static fromJSON(e){if(!e)return null;if(e?.wkid===102100)return Dh.WebMercator;if(e?.wkid===4326)return Dh.WGS84;const n=new Dh;return n.read(e),n}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return C1(this)}get isWebMercator(){return kd(this)}get isGeographic(){return X2(this)}get isWrappable(){return tje(this)}get metersPerUnit(){return Dd(this)}get unit(){return iv(this)||(this.isGeographic?"degrees":null)}writeWkt(e,n){this.wkid||(n.wkt=e)}clone(){if(this===Dh.WGS84)return new Dh(Jfe);if(this===Dh.WebMercator)return new Dh(Qfe);const e=new Dh;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=Ze(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:n,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:i}=e.imageCoordinateSystem,s=this.imageCoordinateSystem;return n==null||i?JSON.stringify(s)===JSON.stringify(e.imageCoordinateSystem):r?s.id===n&&s.referenceServiceName===r:s.id===n}return uo(this,e)}toJSON(e){return this.write(void 0,e)}},Dh=ed,ed.GCS_NAD_1927=null,ed.WGS84=null,ed.WebMercator=null,ed.PlateCarree=null,ed);_([E({readOnly:!0})],Bt.prototype,"isWGS84",null),_([E({readOnly:!0})],Bt.prototype,"isWebMercator",null),_([E({readOnly:!0})],Bt.prototype,"isGeographic",null),_([E({readOnly:!0})],Bt.prototype,"isWrappable",null),_([E({type:Or,json:{write:!0}})],Bt.prototype,"latestWkid",void 0),_([E({readOnly:!0})],Bt.prototype,"metersPerUnit",null),_([E({readOnly:!0})],Bt.prototype,"unit",null),_([E({type:Or,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],Bt.prototype,"wkid",void 0),_([E({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],Bt.prototype,"wkt",void 0),_([Xn("wkt"),Xn("web-scene","wkt")],Bt.prototype,"writeWkt",null),_([E({type:String,json:{write:!1}})],Bt.prototype,"wkt2",void 0),_([E({type:Or,json:{write:!0}})],Bt.prototype,"vcsWkid",void 0),_([E({type:Or,json:{write:!0}})],Bt.prototype,"latestVcsWkid",void 0),_([E()],Bt.prototype,"imageCoordinateSystem",void 0),Bt=Dh=_([ue("esri.geometry.SpatialReference")],Bt),Bt.prototype.toJSON.isDefaultToJSON=!0,Bt.GCS_NAD_1927=Kt.freeze(new Bt({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),Bt.WGS84=Kt.freeze(new Bt(Jfe)),Bt.WebMercator=Kt.freeze(new Bt(Qfe)),Bt.PlateCarree=Kt.freeze(new Bt(nje));function sr(t,e,n){let r,i;return e===void 0||Array.isArray(e)?(i=t,n=e,r=[void 0]):(i=e,r=Array.isArray(t)?t:[t]),(s,o)=>{const a=s.constructor.prototype;r.forEach(l=>{const c=MG(s,l,i);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],n&&(c.read.source=(c.read.source||[]).concat(n))})}}let Ds=class extends qt{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Bt.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,n){if(e instanceof Bt)return e;if(e!=null){const r=new Bt;return r.read(e,n),r}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,n){this.cache[e]=n}};_([E()],Ds.prototype,"type",void 0),_([E({readOnly:!0})],Ds.prototype,"cache",null),_([E({readOnly:!0})],Ds.prototype,"extent",null),_([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ds.prototype,"hasM",void 0),_([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Ds.prototype,"hasZ",void 0),_([E({type:Bt,json:{write:!0},value:Bt.WGS84})],Ds.prototype,"spatialReference",void 0),_([sr("spatialReference")],Ds.prototype,"readSpatialReference",null),Ds=_([ue("esri.geometry.Geometry")],Ds);const Ije=Object.prototype.toString;function Rje(t){const e="__accessorMetadata__"in t?Fa(t):t;return function(...n){if(n.push(e),typeof n[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return Pje.apply(this,n)}}function Pje(t,e,n,r){eI(t,e).cast=r}function Mje(t){return(e,n)=>{eI(e,t).cast=e[n]}}function zs(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&Ije.call(t[0])==="[object Function]"?Rje(t[0]):t.length===1&&typeof t[0]=="string"?Mje(t[0]):void 0}function a2(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new Xe("internal:mesh","Mesh geometries are not supported for this operation")}function Cje(t){t.forEach(a2)}const Nje=57.29577951308232,Oje=.017453292519943;function VQ(t){return t*Nje}function zQ(t){return t*Oje}function uIt(t){return Math.PI/2-2*Math.atan(Math.exp(-t/ts.radius))}function IF(t){return t.wkid!=null||t.wkt!=null}const t$=[0,0];function x4(t,e,n,r,i){const s=t,o=i;if(o.spatialReference=n,"x"in s&&"x"in o)[o.x,o.y]=e(s.x,s.y,t$,r);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=e(s.xmin,s.ymin,t$,r),[o.xmax,o.ymax]=e(s.xmax,s.ymax,t$,r);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,l=[];let c;for(let u=0;u<a.length;u++){const h=a[u];c=[],l.push(c);for(let f=0;f<h.length;f++)c.push(e(h[f][0],h[f][1],[0,0],r)),h[f].length>2&&c[f].push(h[f][2]),h[f].length>3&&c[f].push(h[f][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in s&&"points"in o){const a=s.points,l=[];for(let c=0;c<a.length;c++)l[c]=e(a[c][0],a[c][1],[0,0],r),a[c].length>2&&l[c].push(a[c][2]),a[c].length>3&&l[c].push(a[c][3]);o.points=l}return i}function WM(t,e){const n=t&&(IF(t)?t:t.spatialReference),r=e&&(IF(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!n||!r)&&(!!uo(r,n)||kd(r)&&C1(n)||kd(n)&&C1(r))}function lO(t,e){if(t==null)return null;const n=t.spatialReference,r=e&&(IF(e)?e:e.spatialReference);return WM(n,r)?uo(n,r)?Ze(t):kd(r)?x4(t,fx,Bt.WebMercator,!1,Ze(t)):C1(r)?x4(t,cO,Bt.WGS84,!1,Ze(t)):null:null}function fx(t,e,n=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const r=zQ(e);return n[0]=zQ(t)*ts.radius,n[1]=ts.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),n}function cO(t,e,n=[0,0],r=!1){if(t===Ek[0])n[0]=-180;else if(t===Ek[1])n[0]=180;else{const i=VQ(t/ts.radius);n[0]=r?i:i-360*Math.floor((i+180)/360)}return n[1]=VQ(Math.PI/2-2*Math.atan(Math.exp(-e/ts.radius))),n}function Yy(t,e=!1,n=Ze(t)){return a2(t),a2(n),x4(t,fx,Bt.WebMercator,e,n)}function YE(t,e=!1,n=Ze(t)){return a2(t),a2(n),x4(t,cO,Bt.WGS84,e,n)}function ape(t,e){const n=t.x-e.x,r=t.y-e.y,i=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(n*n+r*r+i*i)}function Lje(t){return lpe(t,cpe)?.[0]??null}function Dje(t){return lpe(t,cpe)?.[1]??null}function lpe({x:t,y:e,spatialReference:n},r=[0,0]){if(n){if(kd(n))return cO(t,e,r);if(X2(n))return r[0]=t,r[1]=e,r}return null}const cpe=[0,0];var HM;const n$=[0,0];function UQ(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let Jt=HM=class extends Ds{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const n=t._get("spatialReference");e._set("spatialReference",Kt.isFrozen(n)?n:n.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,n,r,i){let s;if(Array.isArray(t))s=t,i=e,t=s[0],e=s[1],n=s[2],r=s[3];else if(t&&typeof t=="object"){if(s=t,t=s.x!=null?s.x:s.longitude,e=s.y!=null?s.y:s.latitude,n=s.z,r=s.m,(i=s.spatialReference)&&i.declaredClass!=="esri.geometry.SpatialReference"&&(i=new Bt(i)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)St.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)St.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&i?.isWebMercator){const a=fx(s.longitude,s.latitude,n$);t=a[0],e=a[1]}}}else UQ(n)?(i=n,n=null):UQ(r)&&(i=r,r=null);const o={x:t,y:e};return o.x==null&&o.y!=null?St.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&St.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),i!=null&&(o.spatialReference=i),n!=null&&(o.z=n),r!=null&&(o.m=r),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return Dje(this)}set latitude(t){const{spatialReference:e,x:n}=this;t!=null&&e&&(e.isWebMercator?this._set("y",fx(n,t,n$)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return Lje(this)}set longitude(t){const{y:e,spatialReference:n}=this;t!=null&&n&&(n.isWebMercator?this._set("x",fx(t,e,n$)[0]):n.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,n){e[n]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new HM;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return HM.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:n,z:r,m:i,spatialReference:s}=this,{z:o,m:a}=t;let{x:l,y:c,spatialReference:u}=t;if(!s.equals(u))if(s.isWebMercator&&u.isWGS84)[l,c]=fx(l,c),u=s;else{if(!s.isWGS84||!u.isWebMercator)return!1;[l,c]=cO(l,c),u=s}return e===l&&n===c&&r===o&&i===a&&s.wkid===u.wkid}offset(t,e,n){return this.x+=t,this.y+=e,n!=null&&(this.z=(this.z??0)+n),this}normalize(){if(!this.spatialReference)return this;const t=La(this.spatialReference);if(!t)return this;let e=this.x;const[n,r]=t.valid,i=2*r;let s;return e>r?(s=Math.ceil(Math.abs(e-r)/i),e-=s*i):e<n&&(s=Math.ceil(Math.abs(e-n)/i),e+=s*i),this._set("x",e),this}distance(t){return ape(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};_([E({readOnly:!0})],Jt.prototype,"cache",null),_([E({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Jt.prototype,"hasM",null),_([E({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Jt.prototype,"hasZ",null),_([E({type:Number})],Jt.prototype,"latitude",null),_([E({type:Number})],Jt.prototype,"longitude",null),_([E({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),zs(t=>isNaN(t)?t:Zl(t))],Jt.prototype,"x",void 0),_([Xn("x")],Jt.prototype,"writeX",null),_([sr("x")],Jt.prototype,"readX",null),_([E({type:Number,json:{write:!0}})],Jt.prototype,"y",void 0),_([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Jt.prototype,"z",void 0),_([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Jt.prototype,"m",void 0),Jt=HM=_([ue("esri.geometry.Point")],Jt),Jt.prototype.toJSON.isDefaultToJSON=!0;const r$=[0,0];function iI(t,e){return e!=null&&ba(t,e.x,e.y,e.z)}function hIt(t,e){if(!e.points?.length)return!1;for(const n of e.points)if(!l2(t,n))return!1;return!0}function $je(t,e){const{xmin:n,ymin:r,zmin:i,xmax:s,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?ba(t,n,r,i)&&ba(t,n,o,i)&&ba(t,s,o,i)&&ba(t,s,r,i)&&ba(t,n,r,a)&&ba(t,n,o,a)&&ba(t,s,o,a)&&ba(t,s,r,a):ba(t,n,r)&&ba(t,n,o)&&ba(t,s,o)&&ba(t,s,r)}function l2(t,e){return ba(t,e[0],e[1])}function jje(t,e){return ba(t,e[0],e[1],e[2])}function ba(t,e,n,r){return e>=t.xmin&&e<=t.xmax&&n>=t.ymin&&n<=t.ymax&&(r==null||!t.hasZ||r>=t.zmin&&r<=t.zmax)}function WG(t,e){return r$[1]=e.y,r$[0]=e.x,Fje(t,r$)}function Fje(t,e){return HG(t.rings,e)}function HG(t,e){if(!t||t.length<1)return!1;if(Vje(t))return GQ(!1,t,e);let n=!1;for(let r=0,i=t.length;r<i;r++)n=GQ(n,t[r],e);return n}function Vje(t){return!Array.isArray(t[0][0])}function GQ(t,e,n){const[r,i]=n;let s=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[c,u]=e[a],[h,f]=e[o];(u<i&&f>=i||f<i&&u>=i)&&c+(i-u)/(f-u)*(h-c)<r&&(s=!s)}return s}function zje(t,e){return iI(t,e)}function Uje(t,e){const n=t.hasZ&&e.hasZ;let r,i,s;if(t.xmin<=e.xmin){if(r=e.xmin,t.xmax<r)return!1}else if(r=t.xmin,e.xmax<r)return!1;if(t.ymin<=e.ymin){if(i=e.ymin,t.ymax<i)return!1}else if(i=t.ymin,e.ymax<i)return!1;if(n&&e.hasZ){if(t.zmin<=e.zmin){if(s=e.zmin,t.zmax<s)return!1}else if(s=t.zmin,e.zmax<s)return!1}return!0}function Gje(t,e){const{points:n,hasZ:r}=e,i=r?jje:l2;for(const s of n)if(i(t,s))return!0;return!1}const N1=[0,0],O1=[0,0],L1=[0,0],D1=[0,0],Bje=[N1,O1,L1,D1],upe=[[L1,N1],[N1,O1],[O1,D1],[D1,L1]];function Wje(t,e){return Hje(t,e.rings)}function Hje(t,e){N1[0]=t.xmin,N1[1]=t.ymax,O1[0]=t.xmax,O1[1]=t.ymax,L1[0]=t.xmin,L1[1]=t.ymin,D1[0]=t.xmax,D1[1]=t.ymin;for(const n of Bje)if(HG(e,n))return!0;for(const n of e){if(!n.length)continue;let r=n[0];if(l2(t,r))return!0;for(let i=1;i<n.length;i++){const s=n[i];if(l2(t,s)||hpe(r,s,upe))return!0;r=s}}return!1}function qje(t,e){N1[0]=t.xmin,N1[1]=t.ymax,O1[0]=t.xmax,O1[1]=t.ymax,L1[0]=t.xmin,L1[1]=t.ymin,D1[0]=t.xmax,D1[1]=t.ymin;const n=e.paths;for(const r of n){if(!n.length)continue;let i=r[0];if(l2(t,i))return!0;for(let s=1;s<r.length;s++){const o=r[s];if(l2(t,o)||hpe(i,o,upe))return!0;i=o}}return!1}const Ys=[0,0];function Kje(t){for(let e=0;e<t.length;e++){const n=t[e];for(let i=0;i<n.length-1;i++){const s=n[i],o=n[i+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const c=t[a][l],u=t[a][l+1];if(RF(s,o,c,u,Ys)&&!(Ys[0]===s[0]&&Ys[1]===s[1]||Ys[0]===c[0]&&Ys[1]===c[1]||Ys[0]===o[0]&&Ys[1]===o[1]||Ys[0]===u[0]&&Ys[1]===u[1]))return!0}}const r=n.length;if(!(r<=4))for(let i=0;i<r-3;i++){let s=r-1;i===0&&(s=r-2);const o=n[i],a=n[i+1];for(let l=i+2;l<s;l++){const c=n[l],u=n[l+1];if(RF(o,a,c,u,Ys)&&!(Ys[0]===o[0]&&Ys[1]===o[1]||Ys[0]===c[0]&&Ys[1]===c[1]||Ys[0]===a[0]&&Ys[1]===a[1]||Ys[0]===u[0]&&Ys[1]===u[1]))return!0}}}return!1}function hpe(t,e,n){for(let r=0;r<n.length;r++)if(RF(t,e,n[r][0],n[r][1]))return!0;return!1}function RF(t,e,n,r,i){const[s,o]=t,[a,l]=e,[c,u]=n,[h,f]=r,g=h-c,v=s-c,x=a-s,b=f-u,T=o-u,A=l-o,I=b*x-g*A;if(I===0)return!1;const R=(g*T-b*v)/I,C=(x*T-A*v)/I;return R>=0&&R<=1&&C>=0&&C<=1&&(i&&(i[0]=s+R*(a-s),i[1]=o+R*(l-o)),!0)}function Yje(t){switch(t){case"esriGeometryEnvelope":case"extent":return Uje;case"esriGeometryMultipoint":case"multipoint":return Gje;case"esriGeometryPoint":case"point":return zje;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return Wje;case"esriGeometryPolyline":case"polyline":return qje}}var Ou;function Xje(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function om(t,e,n){return e==null?n:n==null?e:t(e,n)}let Dn=Ou=class extends Ds{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,n,r,i){return Xje(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Bt.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:n,ymax:r,spatialReference:i??Bt.WGS84}}static fromPoint(t){return new Ou({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Jt({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Ou;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,n=t.spatialReference;return e&&n&&!e.equals(n)&&WM(e,n)&&(t=e.isWebMercator?Yy(t):YE(t,!0)),t.type==="point"?iI(this,t):t.type==="extent"&&$je(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,n=t.spatialReference;return e&&n&&!e.equals(n)&&WM(e,n)&&(t=e.isWebMercator?Yy(t):YE(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),n=this.width*e,r=this.height*e;if(this.xmin+=n,this.ymin+=r,this.xmax-=n,this.ymax-=r,this.hasZ){const i=(this.zmax-this.zmin)*e;this.zmin+=i,this.zmax-=i}if(this.hasM){const i=(this.mmax-this.mmin)*e;this.mmin+=i,this.mmax-=i}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,n=t.spatialReference;return e&&n&&!uo(e,n)&&WM(e,n)&&(t=e.isWebMercator?Yy(t):YE(t,!0)),Yje(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,n){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,n!=null&&(this.zmin+=n,this.zmax+=n),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=om(Math.min,this.zmin,t.zmin),this.zmax=om(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=om(Math.min,this.mmin,t.mmin),this.mmax=om(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=om(Math.max,this.zmin,t.zmin),this.zmax=om(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=om(Math.max,this.mmin,t.mmin),this.mmax=om(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=La(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,n=this._getCM(t);if(n){const r=e.isWebMercator?YE(n):n;this.xmin-=n.x,this.xmax-=n.x,e.isWebMercator||(r.x=i$(r.x,t).x),this.spatialReference=new Bt(ude((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:r.x}))}return this}_getCM(t){let e=null;const[n,r]=t.valid,i=this.xmin,s=this.xmax;return i>=n&&i<=r&&s>=n&&s<=r||(e=this.center),e}_normalize(t,e,n){const r=this.spatialReference;if(!r)return this;const i=n??La(r);if(i==null)return this;const s=this._getParts(i).map(l=>l.extent);if(s.length<2)return s[0]||this;if(s.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return s;let o=!0,a=!0;return s.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:s.map(l=>{const c=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const u=(l.zmax-l.zmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}if(a){const u=(l.mmax-l.mmin)/2;for(let h=0;h<c.length;h++)c[h].push(u)}return c}),hasZ:o,hasM:a,spatialReference:r}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:o}=this,a=this.width,l=this.xmin,c=this.xmax;let u;t=t||La(o);const[h,f]=t.valid;u=i$(this.xmin,t);const g=u.x,v=u.frameId;u=i$(this.xmax,t);const x=u.x,b=u.frameId,T=g===x&&a>0;if(a>2*f){const A=new Ou(l<c?g:x,i,f,s,o),I=new Ou(h,i,l<c?x:g,s,o),R=new Ou(0,i,f,s,o),C=new Ou(h,i,0,s,o),V=[],M=[];A.contains(R)&&V.push(v),A.contains(C)&&M.push(v),I.contains(R)&&V.push(b),I.contains(C)&&M.push(b);for(let N=v+1;N<b;N++)V.push(N),M.push(N);e.push({extent:A,frameIds:[v]},{extent:I,frameIds:[b]},{extent:R,frameIds:V},{extent:C,frameIds:M})}else g>x||T?e.push({extent:new Ou(g,i,f,s,o),frameIds:[v]},{extent:new Ou(h,i,x,s,o),frameIds:[b]}):e.push({extent:new Ou(g,i,x,s,o),frameIds:[v]});this.cache._parts=e}const n=this.hasZ,r=this.hasM;if(n||r){const i={};n&&(i.zmin=this.zmin,i.zmax=this.zmax),r&&(i.mmin=this.mmin,i.mmax=this.mmax);for(let s=0;s<e.length;s++)e[s].extent.set(i)}return e}};function i$(t,e){const[n,r]=e.valid,i=2*r;let s,o=0;return t>r?(s=Math.ceil(Math.abs(t-r)/i),t-=s*i,o=s):t<n&&(s=Math.ceil(Math.abs(t-n)/i),t+=s*i,o=-s),{x:t,frameId:o}}_([E({readOnly:!0})],Dn.prototype,"cache",null),_([E({readOnly:!0})],Dn.prototype,"center",null),_([E({readOnly:!0})],Dn.prototype,"extent",null),_([E({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Dn.prototype,"hasM",null),_([E({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Dn.prototype,"hasZ",null),_([E({readOnly:!0})],Dn.prototype,"height",null),_([E({readOnly:!0})],Dn.prototype,"width",null),_([E({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Dn.prototype,"xmin",void 0),_([E({type:Number,json:{write:!0}})],Dn.prototype,"ymin",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Dn.prototype,"mmin",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Dn.prototype,"zmin",void 0),_([E({type:Number,json:{write:!0}})],Dn.prototype,"xmax",void 0),_([E({type:Number,json:{write:!0}})],Dn.prototype,"ymax",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},read:t=>t??void 0,write:{overridePolicy(){return{enabled:this.hasM}}}}})],Dn.prototype,"mmax",void 0),_([E({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Dn.prototype,"zmax",void 0),Dn=Ou=_([ue("esri.geometry.Extent")],Dn),Dn.prototype.toJSON.isDefaultToJSON=!0;let JS;const Zje=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,PF=globalThis.document?.documentElement;function dpe(){const t=PF?.getAttribute("lang"),e=globalThis.navigator?.language;return Zje??t??e??"en"}function eu(){return JS===void 0&&(JS=dpe()),JS}const Jje=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function qG(t=eu()){return ppe(t)?.language}function fpe(t=eu()){const e=ppe(t);return e?.language&&e?.extlang?t.replace(`${e.language}-`,""):t}function ppe(t=eu()){return Jje.exec(t)?.groups}const qM=[];function mpe(t){return qM.push(t),qn(()=>{qM.splice(qM.indexOf(t),1)})}const KM=[];function KG(t){return KM.push(t),qn(()=>KM.splice(KM.indexOf(t),1))}function BQ(){const t=dpe();JS!==t&&([...KM].forEach(e=>e(t)),JS=t,[...qM].forEach(e=>e(t)))}globalThis.addEventListener?.("languagechange",BQ),PF&&new MutationObserver(()=>{BQ()}).observe(PF,{attributeFilter:["lang"]});let mP;function Qje(t){return mP&&!mP.destroyed||(mP=t()),mP}var MF;const eFe=new Gs({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let as=MF=class extends Kt{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new MF({categories:this.categories?Ze(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let n=[];this.categories&&(n=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let r="";if(this.extent){const o=lO(this.extent,Bt.WGS84);o!=null&&(r=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let i=this.query;!this.disableExtraQuery&&t.extraQuery&&(i="("+i+")"+t.extraQuery);const s={categories:n,bbox:r,q:i,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>eFe.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...e,...s}}}};_([E()],as.prototype,"categories",void 0),_([E()],as.prototype,"disableExtraQuery",void 0),_([E({type:Dn})],as.prototype,"extent",void 0),_([E()],as.prototype,"filter",void 0),_([E()],as.prototype,"num",void 0),_([E()],as.prototype,"query",void 0),_([E()],as.prototype,"sortField",void 0),_([E()],as.prototype,"sortOrder",null),_([E()],as.prototype,"start",void 0),as=MF=_([ue("esri.portal.PortalQueryParams")],as);var CF;let zi=CF=class extends qt{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e&&this.portal?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.portal?.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const n=e.categorySchema||[];return n.some(r=>r.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):n})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Xe("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new CF({sourceJSON:t});return e.read(t),e}queryItems(t,e){let n=Fa(as,t);const r=this.portal;return parseFloat(r.currentVersion)>5?(n=n||new as,r.queryPortal(`/content/groups/${this.id}/search`,n,"PortalItem",e)):(n=n?n.clone():new as,n.query="group:"+this.id+(n.query?" "+n.query:""),r.queryItems(n,e))}_fetchCategorySchemaSet(t,e){const n=this.portal;return n.fetchSelf(n.authMode,!0,e).then(r=>{const i=r.contentCategorySetsGroupQuery;if(i){const s=new as({disableExtraQuery:!0,num:1,query:i});return n.queryGroups(s,e)}throw new Xe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(r=>{if(r.total){const i=r.results[0],s=new as({num:1,query:`typekeywords:"${t}"`});return i.queryItems(s,e)}throw new Xe("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(r=>r.total?r.results[0].fetchData("json",e).then(i=>{const s=i?.categorySchema;return s?.length?s:[]}):[])}};_([E()],zi.prototype,"access",void 0),_([E({type:Date})],zi.prototype,"created",void 0),_([E()],zi.prototype,"description",void 0),_([E()],zi.prototype,"id",void 0),_([E()],zi.prototype,"isInvitationOnly",void 0),_([E({type:Date})],zi.prototype,"modified",void 0),_([E()],zi.prototype,"owner",void 0),_([E()],zi.prototype,"portal",void 0),_([E()],zi.prototype,"snippet",void 0),_([E()],zi.prototype,"sortField",void 0),_([E()],zi.prototype,"sortOrder",void 0),_([E()],zi.prototype,"sourceJSON",void 0),_([E()],zi.prototype,"tags",void 0),_([E()],zi.prototype,"thumbnail",void 0),_([E({readOnly:!0})],zi.prototype,"thumbnailUrl",null),_([E()],zi.prototype,"title",void 0),_([E({readOnly:!0})],zi.prototype,"url",null),zi=CF=_([ue("esri.portal.PortalGroup")],zi);let U0=class extends Kt{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};_([E()],U0.prototype,"nextQueryParams",void 0),_([E()],U0.prototype,"queryParams",void 0),_([E()],U0.prototype,"results",void 0),_([E()],U0.prototype,"total",void 0),U0=_([ue("esri.portal.PortalQueryResult")],U0);let uf=class extends qt{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const e=this.portal?.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Xe("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};_([E({type:Date})],uf.prototype,"created",void 0),_([E()],uf.prototype,"id",void 0),_([E()],uf.prototype,"portal",void 0),_([E()],uf.prototype,"title",void 0),_([E({readOnly:!0})],uf.prototype,"url",null),_([E()],uf.prototype,"username",void 0),uf=_([ue("esri.portal.PortalFolder")],uf);var NF;let $r=NF=class extends qt{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.id=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.portal?.restUrl;return t?`${t}/content/users/${this.id}`:null}get url(){const t=this.portal?.restUrl;return t?`${t}/community/users/${this.id}`:null}addItem(t){const e=t&&t.item,n=t?.data,r=t?.folder,i={method:"post"};e&&(i.query=e.createPostQuery(),n!=null&&(typeof n=="string"?i.query.text=n:typeof n=="object"&&(i.query.text=JSON.stringify(n))));let s=this.userContentUrl;return r&&(s+="/"+(typeof r=="string"?r:r.id)),this.portal.request(s+"/addItem",i).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let n=this.userContentUrl;t.ownerFolder&&(n+="/"+t.ownerFolder);const r=e?{permanentDelete:!0}:{};await this.portal.request(n+`/items/${t.id}/delete`,{method:"post",query:r}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const n=this.userContentUrl+"/deleteItems",r=[],i=t.map(s=>s.id);if(i.length){const s={method:"post",query:{items:i.join(","),permanentDelete:e}},o=await this.portal.request(n,s);for(const a of o.results){const l=t.find(h=>a.itemId===h.id),c=a.success;let u=null;c?(l.id=null,l.portal=null):a.error&&(u=new Xe("portal:delete-item-failed",a.error.message,a.error)),r.push({item:l,success:c,error:u})}}return r}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let n;return n=e&&e.folders?e.folders.map(r=>{const i=uf.fromJSON(r);return i.portal=this.portal,i}):[],n})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(n=>{const r=zi.fromJSON(n);return r.portal=this.portal,r}):[],e})}async fetchItems(t){t??={};let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:n}=await xe(()=>Promise.resolve().then(()=>gpe),void 0),r={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},i=await this.portal.request(e,{query:r});let s;return i?.items?(s=i.items.map(o=>{const a=n.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(s.map(o=>o.load())),{items:s,nextStart:i.nextStart,total:i.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new zi({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Xe("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const n=this.userContentUrl,r=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(n+`/items/${t.id}/restore`,{method:"post",query:r})}toJSON(){throw new Xe("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new NF({sourceJSON:t});return e.read(t),e}};_([E()],$r.prototype,"access",void 0),_([E({type:Date})],$r.prototype,"created",void 0),_([E()],$r.prototype,"culture",void 0),_([E()],$r.prototype,"description",void 0),_([E()],$r.prototype,"email",void 0),_([E()],$r.prototype,"favGroupId",void 0),_([E()],$r.prototype,"fullName",void 0),_([E()],$r.prototype,"id",void 0),_([E({type:Date})],$r.prototype,"modified",void 0),_([E()],$r.prototype,"orgId",void 0),_([E()],$r.prototype,"portal",void 0),_([E()],$r.prototype,"preferredView",void 0),_([E()],$r.prototype,"privileges",void 0),_([E()],$r.prototype,"region",void 0),_([E()],$r.prototype,"role",void 0),_([E()],$r.prototype,"roleId",void 0),_([E()],$r.prototype,"sourceJSON",void 0),_([E()],$r.prototype,"thumbnail",void 0),_([E({readOnly:!0})],$r.prototype,"thumbnailUrl",null),_([E()],$r.prototype,"units",void 0),_([E({readOnly:!0})],$r.prototype,"userContentUrl",null),_([E({readOnly:!0})],$r.prototype,"url",null),_([E()],$r.prototype,"username",void 0),_([E()],$r.prototype,"userLicenseTypeId",void 0),_([E()],$r.prototype,"userType",void 0),$r=NF=_([ue("esri.portal.PortalUser")],$r);var jl;let pE;const WQ={PortalGroup:()=>Promise.resolve({default:zi}),PortalItem:()=>xe(()=>Promise.resolve().then(()=>gpe),void 0),PortalUser:()=>Promise.resolve({default:$r})};var td;let it=(td=class extends Xg(rI){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.g3DTilesGalleryGroupQuery=null,this.g3dTilesEnabled=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Qn.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){HQ.unregister(this),this.defaultBasemap=Ci(this.defaultBasemap),this.defaultDevBasemap=Ci(this.defaultDevBasemap),this.defaultVectorBasemap=Ci(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Qr(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const n of e)Qn.request.trustedServers.includes(n)||Qn.request.trustedServers.push(n);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=this.user?.orgId,n=!e||this.canSearchPublic;return this.id&&!n?` AND orgid:${this.id}`:null}get hasAPIKey(){return a6e(this.restUrl)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get loaded(){return super.loaded}get restUrl(){let e=this.url;if(e){const n=e.indexOf("/sharing");e=n>0?e.slice(0,n):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,n=this.thumbnail;return e&&n?this._normalizeSSL(e+"/portals/self/resources/"+n):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let n=null;return e&&(n=$r.fromJSON(e),n.portal=this),n}load(e){const n=xe(async()=>{const{default:r}=await Promise.resolve().then(()=>Z7e);return{default:r}},void 0).then(({default:r})=>{hi(e),pE=r}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(r=>{if(!this.hasAPIKey&&Kr){const i=Kr;this.credential=i.findCredential(this.restUrl),this.credential||this.authMode!==jl.AUTH_MODE_AUTO&&this.authMode!==jl.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=i.on("credential-create",tFe(new WeakRef(this))),HQ.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(n),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),n=(await xe(async()=>{const{default:r}=await import("./ElevationLayer-C6_a7YOj.js");return{default:r}},__vite__mapDeps([87,2,88,89,90,35,36,49,54,5,6,7,8,59,60,91]))).default;return e?e.map(r=>new n({id:r.id,url:r.url})):[]}async fetchBasemaps(e,n){const r=await this._fetchBasemaps(e,n);if(n?.include3d===!0&&this.use3dBasemaps!==!1){const i=await this._fetchBasemaps3D(e,n);r.unshift(...i)}return r}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const n=new as;n.query=this.default3DBasemapQuery,n.disableExtraQuery=!0;const r=(await this.queryItems(n,e)).results.find(i=>i.type==="Web Scene");return r?new pE({portalItem:r}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(n=>n.categorySchema):ha(e)?Promise.reject(Tr()):Promise.resolve([])}async fetchClassificationSchema(e){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",e).then(n=>n.classificationSchema):null}fetchFeaturedGroups(e){const n=this.featuredGroups,r=new as({num:100,sortField:"title"});if(n?.length){const i=[];for(const s of n)i.push(`(title:"${s.title}" AND owner:${s.owner})`);return r.query=i.join(" OR "),this.queryGroups(r,e).then(s=>s.results)}return ha(e)?Promise.reject(Tr()):Promise.resolve([])}fetchRegions(e){const n=this.user?.culture||this.culture||eu();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:n}})}fetchSettings(e){const n=this.user?.culture||this.culture||eu();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:n}})}static getDefault(){return Qje(()=>new jl)}queryGroups(e,n){return this.queryPortal("/community/groups",e,"PortalGroup",n)}queryItems(e,n){return this.queryPortal("/search",e,"PortalItem",n)}queryUsers(e,n){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",n)}fetchSelf(e=this.authMode,n=!1,r){const i=this.restUrl+"/portals/self",s={authMode:e,query:{culture:eu().toLowerCase()},withCredentials:!0,...r};return s.authMode==="auto"&&(s.authMode="no-prompt"),n&&(s.query.default=!0),this.request(i,s)}queryPortal(e,n,r,i){const s=Fa(as,n),o=a=>this.request(this.restUrl+e,{...s.toRequestOptions(this),...i}).then(l=>{const c=s.clone();return c.start=l.nextStart,new U0({nextQueryParams:c,queryParams:s,total:l.total,results:jl._resultsToTypedArray(a,{portal:this},l,i)})}).then(l=>Promise.all(l.results.map(c=>typeof c.when=="function"?c.when():l)).then(()=>l,c=>(Nde(c),l)));return r&&WQ[r]?WQ[r]().then(({default:a})=>(hi(i),o(a))):o()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new Xe("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===jl.AUTH_MODE_ANONYMOUS||this.authMode===jl.AUTH_MODE_NO_PROMPT&&!Kr)return Promise.reject(new Xe("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=n=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(n||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=n,this.fetchSelf("immediate"))):this.user&&this.credential===n?null:(this.credential=n,this.fetchSelf("immediate"))).then(r=>{r&&(this.sourceJSON=r,this.read(r))});return Kr?Kr.getCredential(this.restUrl,{prompt:this.authMode!==jl.AUTH_MODE_NO_PROMPT}).then(n=>e(n)):e(this.credential)}normalizeUrl(e){const n=this.credential?.token;return this._normalizeSSL(n?e+(e.includes("?")?"&":"?")+"token="+n:e)}requestToTypedArray(e,n,r){return this.request(e,n).then(i=>{const s=jl._resultsToTypedArray(r,{portal:this},i);return Promise.all(s.map(o=>typeof o.when=="function"?o.when():i)).then(()=>s,()=>s)})}request(e,n={}){const r={f:"json",...n.query},{authMode:i=this.authMode===jl.AUTH_MODE_ANONYMOUS||this.authMode===jl.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:s=null,cacheBust:o=!1,method:a="auto",responseType:l="json",signal:c}=n,u={authMode:i,body:s,cacheBust:o,method:a,query:r,responseType:l,timeout:0,signal:c};return n.withCredentials&&(u.withCredentials=!0),Ji(this._normalizeSSL(e),u).then(h=>h.data)}toJSON(){throw new Xe("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new jl({sourceJSON:e})}_getHelperService(e){const n=this.helperServices?.[e];if(!n)throw new Xe("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return n}async _fetchBasemaps(e,n){const r=new as;r.query=e||(cF()?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const i=await this.queryGroups(r,n);if(!i.total)return[];const s=i.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=s.sortField||"name",r.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(r,n);return o.total?o.results.filter(a=>a.type==="Web Map").map(a=>new pE({portalItem:a})):[]}async _fetchBasemaps3D(e,n){const r=e||this.basemapGalleryGroupQuery3D;if(!r)return[];if(cF())return[];const i=new as({query:r,disableExtraQuery:!0}),s=await this.queryGroups(i,n);if(!s.total)return[];const o=s.results[0];i.num=100,i.query='type:"Web Scene"',i.sortField=o.sortField||"name",i.sortOrder=o.sortOrder||"desc";const a=await o.queryItems(i,n);return a.total?a.results.filter(l=>l.type==="Web Scene").map(l=>new pE({portalItem:l})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const n=pE.fromJSON(e);return n.portalItem={portal:this},n}return null}static _resultsToTypedArray(e,n,r,i){let s;if(r){const o=i!=null?i.signal:null;s=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||n)&&(s=s.map(a=>{const l=Object.assign(e?e.fromJSON(a):a,n);return typeof l.load=="function"&&l.load(o),l}))}else s=[];return s}},jl=td,td.AUTH_MODE_ANONYMOUS="anonymous",td.AUTH_MODE_AUTO="auto",td.AUTH_MODE_IMMEDIATE="immediate",td.AUTH_MODE_NO_PROMPT="no-prompt",td);_([E()],it.prototype,"access",void 0),_([E()],it.prototype,"allSSL",void 0),_([E()],it.prototype,"authMode",void 0),_([E()],it.prototype,"authorizedCrossOriginDomains",void 0),_([sr("authorizedCrossOriginDomains")],it.prototype,"readAuthorizedCrossOriginDomains",null),_([E()],it.prototype,"basemapGalleryGroupQuery",void 0),_([E({json:{name:"3DBasemapGalleryGroupQuery"}})],it.prototype,"basemapGalleryGroupQuery3D",void 0),_([E({json:{name:"g3DTilesGalleryGroupQuery"}})],it.prototype,"g3DTilesGalleryGroupQuery",void 0),_([E({json:{name:"g3dTilesEnabled"}})],it.prototype,"g3dTilesEnabled",void 0),_([E()],it.prototype,"bingKey",void 0),_([E()],it.prototype,"canListApps",void 0),_([E()],it.prototype,"canListData",void 0),_([E()],it.prototype,"canListPreProvisionedItems",void 0),_([E()],it.prototype,"canProvisionDirectPurchase",void 0),_([E()],it.prototype,"canSearchPublic",void 0),_([E()],it.prototype,"canShareBingPublic",void 0),_([E()],it.prototype,"canSharePublic",void 0),_([E()],it.prototype,"canSignInArcGIS",void 0),_([E()],it.prototype,"canSignInIDP",void 0),_([E()],it.prototype,"colorSetsGroupQuery",void 0),_([E()],it.prototype,"commentsEnabled",void 0),_([E({type:Date})],it.prototype,"created",void 0),_([E()],it.prototype,"credential",void 0),_([E()],it.prototype,"culture",void 0),_([E()],it.prototype,"currentVersion",void 0),_([E()],it.prototype,"customBaseUrl",void 0),_([E()],it.prototype,"default3DBasemapQuery",void 0),_([E()],it.prototype,"defaultBasemap",void 0),_([sr("defaultBasemap")],it.prototype,"readDefaultBasemap",null),_([E()],it.prototype,"defaultDevBasemap",void 0),_([sr("defaultDevBasemap")],it.prototype,"readDefaultDevBasemap",null),_([E({type:Dn})],it.prototype,"defaultExtent",void 0),_([E()],it.prototype,"defaultVectorBasemap",void 0),_([sr("defaultVectorBasemap")],it.prototype,"readDefaultVectorBasemap",null),_([E()],it.prototype,"description",void 0),_([E()],it.prototype,"devBasemapGalleryGroupQuery",void 0),_([E()],it.prototype,"eueiEnabled",void 0),_([E({readOnly:!0})],it.prototype,"extraQuery",null),_([E()],it.prototype,"featuredGroups",void 0),_([E()],it.prototype,"featuredItemsGroupQuery",void 0),_([E()],it.prototype,"galleryTemplatesGroupQuery",void 0),_([E()],it.prototype,"layoutGroupQuery",void 0),_([E()],it.prototype,"livingAtlasGroupQuery",void 0),_([E({readOnly:!0})],it.prototype,"hasAPIKey",null),_([E()],it.prototype,"hasCategorySchema",void 0),_([E()],it.prototype,"hasClassificationSchema",void 0),_([E()],it.prototype,"helpBase",void 0),_([E()],it.prototype,"helperServices",void 0),_([E()],it.prototype,"helpMap",void 0),_([E()],it.prototype,"homePageFeaturedContent",void 0),_([E()],it.prototype,"homePageFeaturedContentCount",void 0),_([E()],it.prototype,"httpPort",void 0),_([E()],it.prototype,"httpsPort",void 0),_([E()],it.prototype,"id",void 0),_([E()],it.prototype,"ipCntryCode",void 0),_([E({readOnly:!0})],it.prototype,"isOrganization",null),_([E()],it.prototype,"isPortal",void 0),_([E()],it.prototype,"isReadOnly",void 0),_([E({readOnly:!0})],it.prototype,"itemPageUrl",null),_([E()],it.prototype,"layerTemplatesGroupQuery",void 0),_([E()],it.prototype,"maxTokenExpirationMinutes",void 0),_([E({type:Date})],it.prototype,"modified",void 0),_([E()],it.prototype,"name",void 0),_([E()],it.prototype,"portalHostname",void 0),_([E()],it.prototype,"portalMode",void 0),_([E()],it.prototype,"portalProperties",void 0),_([E()],it.prototype,"region",void 0),_([E()],it.prototype,"recycleBinEnabled",void 0),_([E({readOnly:!0})],it.prototype,"restUrl",null),_([E()],it.prototype,"rotatorPanels",void 0),_([E()],it.prototype,"showHomePageDescription",void 0),_([E()],it.prototype,"sourceJSON",void 0),_([E()],it.prototype,"staticImagesUrl",void 0),_([E({json:{name:"2DStylesGroupQuery"}})],it.prototype,"stylesGroupQuery2d",void 0),_([E({json:{name:"stylesGroupQuery"}})],it.prototype,"stylesGroupQuery3d",void 0),_([E()],it.prototype,"supportsHostedServices",void 0),_([E()],it.prototype,"symbolSetsGroupQuery",void 0),_([E()],it.prototype,"templatesGroupQuery",void 0),_([E()],it.prototype,"thumbnail",void 0),_([E({readOnly:!0})],it.prototype,"thumbnailUrl",null),_([E()],it.prototype,"units",void 0),_([E()],it.prototype,"url",void 0),_([E()],it.prototype,"urlKey",void 0),_([sr("urlKey")],it.prototype,"readUrlKey",null),_([E()],it.prototype,"user",void 0),_([sr("user")],it.prototype,"readUser",null),_([E()],it.prototype,"use3dBasemaps",void 0),_([E()],it.prototype,"useDefault3dBasemap",void 0),_([E()],it.prototype,"useStandardizedQuery",void 0),_([E()],it.prototype,"useVectorBasemaps",void 0),_([E()],it.prototype,"vectorBasemapGalleryGroupQuery",void 0),it=jl=_([ue("esri.portal.Portal")],it);const HQ=new FinalizationRegistry(t=>{t.remove()});function tFe(t){const e=Kr;return()=>{const n=t.deref();n&&e.findCredential(n.restUrl)&&n.signIn().catch(()=>{})}}let hf=class extends Kt{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e?.portalItem&&e.path?{...e,path:qQ(e.path,e.portalItem)}:e}set path(e){e!=null&&yl(e)?St.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return qQ(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",n){const r=this.cdnUrl;if(r==null)throw new Xe("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:e,query:{token:this.portalItem.apiKey,_ts:n?.cacheBust?Date.now():null},signal:n?.signal})}async update(e,n){const{addOrUpdateResources:r}=await xe(()=>import("./resourceUtils-D8hznvUM.js"),[]);return await r(this.portalItem,[{resource:this,content:e,compress:n?.compress,access:n?.access}],"update",n),this}hasPath(){return this.path!=null}};function qQ(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&yl(t)&&(t=mG(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}_([E()],hf.prototype,"portalItem",void 0),_([E({type:String,value:null})],hf.prototype,"path",null),_([zs("path")],hf.prototype,"_castPath",null),_([E({type:String,readOnly:!0})],hf.prototype,"url",null),_([E({type:String,readOnly:!0})],hf.prototype,"cdnUrl",null),_([E({type:String,readOnly:!0})],hf.prototype,"itemRelativeUrl",null),hf=_([ue("esri.portal.PortalItemResource")],hf);let Ry=class extends Kt{constructor(e){super(e),this.created=null,this.rating=null}};_([E({type:Date})],Ry.prototype,"created",void 0),_([E()],Ry.prototype,"rating",void 0),Ry=_([ue("esri.portal.PortalRating")],Ry);var G0;const nFe=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Knowledge Graph Layer","Map Service","Media Layer","Scene Service","Stream Service","Video Service","Vector Tile Service","WCS","WFS","WMS","WMTS"]),rFe=new Set(["KML","GeoJson","CSV"]);let vn=G0=class extends Xg(rI){static from(t){return tO(G0,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let n=t;return t==="Feature Service"||t==="Feature Collection"?n=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?n=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?n="Scene Layer":t==="Video Service"?n="Video Layer":t==="Scene Package"?n="Scene Layer Package":t==="Stream Service"?n="Feature Layer":t==="Geoprocessing Service"?n=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?n="GeoEnrichment Service":t==="Geocoding Service"?n="Locator":t==="Microsoft Powerpoint"?n="Microsoft PowerPoint":t==="GeoJson"?n="GeoJSON":t==="Globe Service"?n="Globe Layer":t==="Vector Tile Service"?n="Tile Layer":t==="netCDF"?n="NetCDF":t==="Map Service"?n=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t?.toLowerCase().includes("add in")?n=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?n="Big Data File Share":t==="Compact Tile Package"?n="Tile Package (tpkx)":t==="Raster function template"?n="Raster Function Template":t==="OGCFeatureServer"?n="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?n="Instant App":t==="Insights Page"?n="Insights Report":t==="Excalibur Imagery Project"?n="Excalibur Project":t==="3DTiles Service"?n="3D tiles layer":t==="3DTiles Package"&&(n="3D tiles package"),n}readExtent(t){return t&&t.length?new Dn(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type?.toLowerCase()||"",e=this.typeKeywords||[],n="esri/images/portal/",r="16";let i,s=!1,o=!1,a=!1,l=!1,c=!1,u=!1,h=!1,f=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(s=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),c=e.includes("Spatiotemporal"),u=e.includes("UtilityNetwork"),i=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":c?"spatiotemporal":u?"utilitynetwork":s?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(c=e.includes("Spatiotemporal"),h=e.includes("Relational"),i=c||h?"mapimages":s||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):i=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":e.includes("GaussianSplat")?"gaussiansplatlayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?i="maps":t==="web scene"?i=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?i="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?i="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?i="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?i="datafiles":t==="360 vr experience"?i="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?i="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?i="addindesktop":t==="pdf"?i="pdf":t==="microsoft word"?i="word":t==="microsoft excel"?i="excel":t==="microsoft powerpoint"?i="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?i="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?i="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?i="layersgray":t==="analysis model"?i="analysismodel":t==="scene package"?i="scenepackage":t==="3dtiles package"?i="3dtileslayerpackage":t==="3dtiles service"?i="3dtileslayer":t==="mobile scene package"?i="mobilescenepackage":t==="tile package"||t==="compact tile package"?i="tilepackage":t==="task file"?i="taskfile":t==="report template"?i="report-template":t==="statistical data collection"?i="statisticaldatacollection":t==="insights workbook"?i="workbook":t==="insights model"?i="insightsmodel":t==="insights page"?i="insightspage":t==="insights theme"?i="insightstheme":t==="hub initiative"?i="hubinitiative":t==="hub page"?i="hubpage":t==="hub site application"?i="hubsite":t==="hub event"?i="hubevent":t==="hub project"?i="hubproject":t==="relational database connection"?i="relationaldatabaseconnection":t==="big data file share"?i="datastorecollection":t==="image collection"?i="imagecollection":t==="desktop style"?i="desktopstyle":t==="style"?i=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?i="dashboard":t==="raster function template"?i="rasterprocessingtemplate":t==="vector tile package"?i="vectortilepackage":t==="ortho mapping project"?i="orthomappingproject":t==="ortho mapping template"?i="orthomappingtemplate":t==="solution"?i="solutions":t==="geopackage"?i="geopackage":t==="deep learning package"?i="deeplearningpackage":t==="real time analytic"?i="realtimeanalytics":t==="reality mapping project"?i="realitymappingproject":t==="big data analytic"?i="bigdataanalytics":t==="feed"?i="feed":t==="excalibur imagery project"?i="excaliburimageryproject":t==="notebook"?i="notebook":t==="storymap"?i="storymap":t==="survey123 add in"?i="survey123addin":t==="mission"?i="mission":t==="mission report"?i="missionreport":t==="mission template"?i="missiontemplate":t==="quickcapture project"?i="quickcaptureproject":t==="pro report"?i="proreport":t==="pro report template"?i="proreporttemplate":t==="urban model"?i="urbanmodel":t==="urban project"?i="urbanproject":t==="web experience"?i="experiencebuilder":t==="web experience template"?i="webexperiencetemplate":t==="experience builder widget"?i="experiencebuilderwidget":t==="experience builder widget package"?i="experiencebuilderwidgetpackage":t==="workflow"?i="workflow":t==="kernel gateway connection"?i="kernelgatewayconnection":t==="insights script"?i="insightsscript":t==="hub initiative template"?i="hubinitiativetemplate":t==="storymap theme"?i="storymaptheme":t==="knowledge graph"?i="knowledgegraph":t==="knowledge graph layer"?i="knowledgegraphlayer":t==="knowledge studio project"?i="knowledgestudio":t==="native application"?i="nativeapp":t==="native application installer"?i="nativeappinstaller":t==="web link chart"?i="linkchart":t==="knowledge graph web investigation"?i="investigation":t==="ogcfeatureserver"?i="features":t==="pro presentation"?i="propresentation":t==="pro project"?i="proproject":t==="insights workbook package"?i="insightsworkbookpackage":t==="apache parquet"?i="apacheparquet":t==="notebook code snippet library"?i="notebookcodesnippets":t==="suitability model"?i="suitabilitymodel":t==="esri classifier definition"?i="classifierdefinition":t==="esri classification schema"?i="classificationschema":t==="insights data engineering workbook"?i="dataengineeringworkbook":t==="insights data engineering model"?i="dataengineeringmodel":t==="deep learning studio project"?i="deeplearningproject":t==="discussion"?i="discussion":t==="allsource project"?i="allsourceproject":t==="api key"?i="apikey":t==="data pipeline"?i="datapipelines":t==="group layer"?(f=e.includes("Map"),i=f?"layergroup2d":"layergroup"):i=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":t==="xr experience"?"xrexperience":"maps",i?Ui(n+i+r+".png"):null}get isLayer(){return this.type!=null&&nFe.has(this.type)}get itemCdnUrl(){return wG(this.itemUrl)}get itemPageUrl(){const t=this.portal?.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){const t=this.portal?.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get loaded(){return super.loaded}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal?.normalizeUrl(`${t}/info/${e}?f=json`)??null:null}get userItemUrl(){const t=this.portal?.restUrl;if(!t)return null;const e=this.owner||this.portal?.user?.id;return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=it.getDefault()),n=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(r=>{this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(n),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},n=t instanceof Ry?t.rating:t;return n==null||isNaN(n)||typeof t!="number"||(e.query.rating=n),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new Ry({rating:n,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:Ze(this.applicationProxies),avgRating:this.avgRating,categories:Ze(this.categories),classification:Ze(this.classification),created:Ze(this.created),culture:this.culture,description:this.description,extent:Ze(this.extent),groupCategories:Ze(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:Ze(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:Ze(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:Ze(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Ze(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new G0({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){const t=this.toJSON();for(const e of["tags","typeKeywords","categories"])t[e]=t[e]?.join(", ");for(const e of["extent","classification"]){const n=t[e];n&&(t[e]=JSON.stringify(n))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new Ry(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},G0)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t?.data,n={method:"post"};n.query=this.createPostQuery();for(const r in n.query)n.query[r]===null&&(n.query[r]="");return n.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?n.query.text=e:typeof e=="object"&&(n.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,n).then(()=>this.reload())}):Promise.reject(new Xe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new Xe("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:n}=this;await e.signIn();const{copyResources:r,folder:i,tags:s,title:o}=t||{},a={method:"post",query:{copyPrivateResources:r==="all",folder:typeof i=="string"?i:i?.id,includeResources:!!r,tags:s?.join(","),title:o}},{itemId:l}=await e.request(`${n}/copy`,a);return new G0({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,n=t.filename,r={method:"post"};if(typeof e=="string")nv(e)?r.query={data:e}:r.query={url:Bc(e)},n!=null&&(r.query.filename=n);else{const i=new FormData;n!=null?i.append("file",e,n):i.append("file",e),r.body=i}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then(()=>this.reload())}):Promise.reject(new Xe("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:n}=await xe(()=>import("./resourceUtils-D8hznvUM.js"),[]);return n(this,t,e)}async addResource(t,e,n){const{addOrUpdateResources:r}=await xe(()=>import("./resourceUtils-D8hznvUM.js"),[]);return t.portalItem=this,await r(this,[{resource:t,content:e,compress:n?.compress,access:n?.access}],"add",n),t}async removeResource(t,e){const{removeResource:n}=await xe(()=>import("./resourceUtils-D8hznvUM.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Xe("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return n(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await xe(()=>import("./resourceUtils-D8hznvUM.js"),[]);return e(this,t)}resourceFromPath(t){return new hf({portalItem:this,path:t})}toJSON(){const t=this.extent,e={accessInformation:this.accessInformation,categories:Ze(this.categories),classification:Ze(this.classification),created:this.created?.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:Ze(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:Ze(this.typeKeywords),url:this.url};return rDe(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new G0({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};_([E({type:["private","shared","org","public"]})],vn.prototype,"access",void 0),_([E()],vn.prototype,"accessInformation",void 0),_([E({type:String})],vn.prototype,"apiKey",void 0),_([E({json:{read:{source:"appProxies"}}})],vn.prototype,"applicationProxies",void 0),_([E()],vn.prototype,"avgRating",void 0),_([E()],vn.prototype,"categories",void 0),_([E()],vn.prototype,"classification",void 0),_([E({type:Date})],vn.prototype,"created",void 0),_([E()],vn.prototype,"culture",void 0),_([E()],vn.prototype,"description",void 0),_([E({readOnly:!0})],vn.prototype,"displayName",null),_([E({type:Dn})],vn.prototype,"extent",void 0),_([sr("extent")],vn.prototype,"readExtent",null),_([E()],vn.prototype,"groupCategories",void 0),_([E({readOnly:!0})],vn.prototype,"iconUrl",null),_([E()],vn.prototype,"id",void 0),_([E({readOnly:!0})],vn.prototype,"isLayer",null),_([E({type:Boolean,readOnly:!0})],vn.prototype,"isOrgItem",void 0),_([E()],vn.prototype,"itemControl",void 0),_([E({readOnly:!0})],vn.prototype,"itemPageUrl",null),_([E({readOnly:!0})],vn.prototype,"itemUrl",null),_([E()],vn.prototype,"licenseInfo",void 0),_([E({type:Date})],vn.prototype,"modified",void 0),_([E()],vn.prototype,"name",void 0),_([E()],vn.prototype,"numComments",void 0),_([E()],vn.prototype,"numRatings",void 0),_([E()],vn.prototype,"numViews",void 0),_([E()],vn.prototype,"owner",void 0),_([E()],vn.prototype,"ownerFolder",void 0),_([E({type:it})],vn.prototype,"portal",void 0),_([E()],vn.prototype,"screenshots",void 0),_([E()],vn.prototype,"size",void 0),_([E()],vn.prototype,"snippet",void 0),_([E()],vn.prototype,"sourceJSON",void 0),_([E({type:String})],vn.prototype,"sourceUrl",void 0),_([E({type:String})],vn.prototype,"spatialReference",void 0),_([E()],vn.prototype,"tags",void 0),_([E()],vn.prototype,"thumbnail",void 0),_([E({readOnly:!0})],vn.prototype,"thumbnailUrl",null),_([E()],vn.prototype,"title",void 0),_([E()],vn.prototype,"type",void 0),_([E()],vn.prototype,"typeKeywords",void 0),_([E({type:String,json:{read(t,e){if(rFe.has(e.type)){const n=this.portal?.restUrl;t||=n&&this.id?`${n}/content/items/${this.id}/data`:null}return t}}})],vn.prototype,"url",void 0),_([E({readOnly:!0})],vn.prototype,"userItemUrl",null),vn=G0=_([ue("esri.portal.PortalItem")],vn);const gpe=Object.freeze(Object.defineProperty({__proto__:null,get default(){return vn}},Symbol.toStringTag,{value:"Module"})),ype={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function iFe(t){return t in ype}function KQ(t){if(iFe(t)){const e=ype[t];return e===!0?t:e}return null}const XE=[],Wx=new Map;function YQ(t){for(const e of Wx.keys())xpe(t.pattern,e)&&Wx.delete(e)}function sFe(t){return XE.includes(t)||(YQ(t),XE.unshift(t)),qn(()=>{const e=XE.indexOf(t);e>-1&&(XE.splice(e,1),YQ(t))})}async function vpe(t){const e=eu();Wx.has(t)||Wx.set(t,oFe(t,e));const n=Wx.get(t);return n&&await aFe.add(n),n}function _pe(t){const e=qG(t);return e?KQ(t)??KQ(e):null}async function oFe(t,e){const n=[];for(const r of XE)if(xpe(r.pattern,t))try{return await r.fetchMessageBundle(t,e)}catch(i){n.push(i)}throw n.length?new Xe("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:n}):new Xe("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function xpe(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}KG(()=>{Wx.clear()});const aFe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=uc())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function lFe(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,n=await vpe("esri/t9n/basemaps");return n[t]||n[e]}const OF={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-hillshade",url:"https://services.arcgisonline.com/ArcGIS/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1},{id:"terrain-base",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/33064a20de0c48d2bb61efa8faca93a8/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Terrain Base"},{id:"terrain-reference",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/14fbc125ccc9488888b014db09f35f67/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Reference Reference",isReference:!0}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/94329802cbfa44a18f423e6f1a0b875c/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Ui("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Ui("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Ui("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Ui("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Ui("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Trees_v1/SceneServer",itemId:"9d3d89d42cfe4e2c9d108a2f0d518406",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Open3D_Buildings_v1/SceneServer",itemId:"cd33b09dde0a419c986ca1a78a5fc06d",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Ui("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/Esri3D_Buildings_v1/SceneServer",itemId:"b8fec5af7dfe4866b1b8ac2d2800f282",layerType:"ArcGISSceneServiceLayer"}]}},Ad="system",YG="unknown",Tk="UTC",cFe=Intl.DateTimeFormat().resolvedOptions().timeZone,XQ=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class sv extends Error{}class uFe extends sv{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class hFe extends sv{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class dFe extends sv{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class px extends sv{}class wpe extends sv{constructor(e){super(`Invalid unit ${e}`)}}class Qo extends sv{}class am extends sv{constructor(){super("Zone is an abstract class")}}const Rt="numeric",ch="short",oc="long",w4={year:Rt,month:Rt,day:Rt},bpe={year:Rt,month:ch,day:Rt},fFe={year:Rt,month:ch,day:Rt,weekday:ch},Epe={year:Rt,month:oc,day:Rt},Spe={year:Rt,month:oc,day:Rt,weekday:oc},Tpe={hour:Rt,minute:Rt},kpe={hour:Rt,minute:Rt,second:Rt},Ape={hour:Rt,minute:Rt,second:Rt,timeZoneName:ch},Ipe={hour:Rt,minute:Rt,second:Rt,timeZoneName:oc},Rpe={hour:Rt,minute:Rt,hourCycle:"h23"},Ppe={hour:Rt,minute:Rt,second:Rt,hourCycle:"h23"},Mpe={hour:Rt,minute:Rt,second:Rt,hourCycle:"h23",timeZoneName:ch},Cpe={hour:Rt,minute:Rt,second:Rt,hourCycle:"h23",timeZoneName:oc},Npe={year:Rt,month:Rt,day:Rt,hour:Rt,minute:Rt},Ope={year:Rt,month:Rt,day:Rt,hour:Rt,minute:Rt,second:Rt},Lpe={year:Rt,month:ch,day:Rt,hour:Rt,minute:Rt},Dpe={year:Rt,month:ch,day:Rt,hour:Rt,minute:Rt,second:Rt},pFe={year:Rt,month:ch,day:Rt,weekday:ch,hour:Rt,minute:Rt},$pe={year:Rt,month:oc,day:Rt,hour:Rt,minute:Rt,timeZoneName:ch},jpe={year:Rt,month:oc,day:Rt,hour:Rt,minute:Rt,second:Rt,timeZoneName:ch},Fpe={year:Rt,month:oc,day:Rt,weekday:oc,hour:Rt,minute:Rt,timeZoneName:oc},Vpe={year:Rt,month:oc,day:Rt,weekday:oc,hour:Rt,minute:Rt,second:Rt,timeZoneName:oc};class sI{get type(){throw new am}get name(){throw new am}get ianaName(){return this.name}get isUniversal(){throw new am}offsetName(e,n){throw new am}formatOffset(e,n){throw new am}offset(e){throw new am}equals(e){throw new am}get isValid(){throw new am}}let s$=null;class uO extends sI{static get instance(){return s$===null&&(s$=new uO),s$}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return Zpe(e,n,r)}formatOffset(e,n){return QS(this.offset(e),n)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}const LF=new Map;function mFe(t){let e=LF.get(t);return e===void 0&&(e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),LF.set(t,e)),e}const gFe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function yFe(t,e){const n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,i,s,o,a,l,c,u]=r;return[o,i,s,a,l,c,u]}function vFe(t,e){const n=t.formatToParts(e),r=[];for(let i=0;i<n.length;i++){const{type:s,value:o}=n[i],a=gFe[s];s==="era"?r[a]=o:Sn(a)||(r[a]=parseInt(o,10))}return r}const o$=new Map;class uh extends sI{static create(e){let n=o$.get(e);return n===void 0&&o$.set(e,n=new uh(e)),n}static resetCache(){o$.clear(),LF.clear()}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=uh.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return Zpe(e,n,r,this.name)}formatOffset(e,n){return QS(this.offset(e),n)}offset(e){if(!this.valid)return NaN;const n=new Date(e);if(isNaN(n))return NaN;const r=mFe(this.name);let[i,s,o,a,l,c,u]=r.formatToParts?vFe(r,n):yFe(r,n);a==="BC"&&(i=-Math.abs(i)+1);const f=dO({year:i,month:s,day:o,hour:l===24?0:l,minute:c,second:u,millisecond:0});let g=+n;const v=g%1e3;return g-=v>=0?v:1e3+v,(f-g)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let ZQ={};function _Fe(t,e={}){const n=JSON.stringify([t,e]);let r=ZQ[n];return r||(r=new Intl.ListFormat(t,e),ZQ[n]=r),r}const DF=new Map;function $F(t,e={}){const n=JSON.stringify([t,e]);let r=DF.get(n);return r===void 0&&(r=new Intl.DateTimeFormat(t,e),DF.set(n,r)),r}const jF=new Map;function xFe(t,e={}){const n=JSON.stringify([t,e]);let r=jF.get(n);return r===void 0&&(r=new Intl.NumberFormat(t,e),jF.set(n,r)),r}const FF=new Map;function wFe(t,e={}){const{base:n,...r}=e,i=JSON.stringify([t,r]);let s=FF.get(i);return s===void 0&&(s=new Intl.RelativeTimeFormat(t,e),FF.set(i,s)),s}let ZE=null;function bFe(){return ZE||(ZE=new Intl.DateTimeFormat().resolvedOptions().locale,ZE)}const VF=new Map;function zpe(t){let e=VF.get(t);return e===void 0&&(e=new Intl.DateTimeFormat(t).resolvedOptions(),VF.set(t,e)),e}const zF=new Map;function EFe(t){let e=zF.get(t);if(!e){const n=new Intl.Locale(t);e="getWeekInfo"in n?n.getWeekInfo():n.weekInfo,"minimalDays"in e||(e={...Upe,...e}),zF.set(t,e)}return e}function SFe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const n=t.indexOf("-u-");if(n===-1)return[t];{let r,i;try{r=$F(t).resolvedOptions(),i=t}catch{const l=t.substring(0,n);r=$F(l).resolvedOptions(),i=l}const{numberingSystem:s,calendar:o}=r;return[i,s,o]}}function TFe(t,e,n){return(n||e)&&(t.includes("-u-")||(t+="-u"),n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`)),t}function kFe(t){const e=[];for(let n=1;n<=12;n++){const r=hn.utc(2009,n,1);e.push(t(r))}return e}function AFe(t){const e=[];for(let n=1;n<=7;n++){const r=hn.utc(2016,11,13+n);e.push(t(r))}return e}function gP(t,e,n,r){const i=t.listingMode();return i==="error"?null:i==="en"?n(e):r(e)}function IFe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||zpe(t.locale).numberingSystem==="latn"}class RFe{constructor(e,n,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;const{padTo:i,floor:s,...o}=r;if(!n||Object.keys(o).length>0){const a={useGrouping:!1,...r};r.padTo>0&&(a.minimumIntegerDigits=r.padTo),this.inf=xFe(e,a)}}format(e){if(this.inf){const n=this.floor?Math.floor(e):e;return this.inf.format(n)}else{const n=this.floor?Math.floor(e):eB(e,3);return _s(n,this.padTo)}}}class PFe{constructor(e,n,r){this.opts=r,this.originalZone=void 0;let i;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&uh.create(a).valid?(i=a,this.dt=e):(i="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,i=e.zone.name):(i="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const s={...this.opts};s.timeZone=s.timeZone||i,this.dtf=$F(n,s)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(n=>{if(n.type==="timeZoneName"){const r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...n,value:r}}else return n}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class MFe{constructor(e,n,r){this.opts={style:"long",...r},!n&&Ype()&&(this.rtf=wFe(e,r))}format(e,n){return this.rtf?this.rtf.format(e,n):QFe(n,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,n){return this.rtf?this.rtf.formatToParts(e,n):[]}}const Upe={firstDay:1,minimalDays:4,weekend:[6,7]};class Cr{static fromOpts(e){return Cr.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,n,r,i,s=!1){const o=e||Hi.defaultLocale,a=o||(s?"en-US":bFe()),l=n||Hi.defaultNumberingSystem,c=r||Hi.defaultOutputCalendar,u=GF(i)||Hi.defaultWeekSettings;return new Cr(a,l,c,u,o)}static resetCache(){ZE=null,DF.clear(),jF.clear(),FF.clear(),VF.clear(),zF.clear()}static fromObject({locale:e,numberingSystem:n,outputCalendar:r,weekSettings:i}={}){return Cr.create(e,n,r,i)}constructor(e,n,r,i,s){const[o,a,l]=SFe(e);this.locale=o,this.numberingSystem=n||a||null,this.outputCalendar=r||l||null,this.weekSettings=i,this.intl=TFe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=IFe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),n=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&n?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:Cr.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,GF(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,n=!1){return gP(this,e,eme,()=>{const r=this.intl==="ja"||this.intl.startsWith("ja-");n&=!r;const i=n?{month:e,day:"numeric"}:{month:e},s=n?"format":"standalone";if(!this.monthsCache[s][e]){const o=r?a=>this.dtFormatter(a,i).format():a=>this.extract(a,i,"month");this.monthsCache[s][e]=kFe(o)}return this.monthsCache[s][e]})}weekdays(e,n=!1){return gP(this,e,rme,()=>{const r=n?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=n?"format":"standalone";return this.weekdaysCache[i][e]||(this.weekdaysCache[i][e]=AFe(s=>this.extract(s,r,"weekday"))),this.weekdaysCache[i][e]})}meridiems(){return gP(this,void 0,()=>ime,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[hn.utc(2016,11,13,9),hn.utc(2016,11,13,19)].map(n=>this.extract(n,e,"dayperiod"))}return this.meridiemCache})}eras(e){return gP(this,e,sme,()=>{const n={era:e};return this.eraCache[e]||(this.eraCache[e]=[hn.utc(-40,1,1),hn.utc(2017,1,1)].map(r=>this.extract(r,n,"era"))),this.eraCache[e]})}extract(e,n,r){const i=this.dtFormatter(e,n),s=i.formatToParts(),o=s.find(a=>a.type.toLowerCase()===r);return o?o.value:null}numberFormatter(e={}){return new RFe(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,n={}){return new PFe(e,this.intl,n)}relFormatter(e={}){return new MFe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return _Fe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||zpe(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Xpe()?EFe(this.locale):Upe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let a$=null;class aa extends sI{static get utcInstance(){return a$===null&&(a$=new aa(0)),a$}static instance(e){return e===0?aa.utcInstance:new aa(e)}static parseSpecifier(e){if(e){const n=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new aa(fO(n[1],n[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${QS(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${QS(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,n){return QS(this.fixed,n)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class CFe extends sI{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function jm(t,e){if(Sn(t)||t===null)return e;if(t instanceof sI)return t;if(jFe(t)){const n=t.toLowerCase();return n==="default"?e:n==="local"||n==="system"?uO.instance:n==="utc"||n==="gmt"?aa.utcInstance:aa.parseSpecifier(n)||uh.create(t)}else return mg(t)?aa.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new CFe(t)}const XG={arab:"[-]",arabext:"[-]",bali:"[-]",beng:"[-]",deva:"[-]",fullwide:"[-]",gujr:"[-]",hanidec:"[|||||||||]",khmr:"[-]",knda:"[-]",laoo:"[-]",limb:"[-]",mlym:"[-]",mong:"[-]",mymr:"[-]",orya:"[-]",tamldec:"[-]",telu:"[-]",thai:"[-]",tibt:"[-]",latn:"\\d"},JQ={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},NFe=XG.hanidec.replace(/[\[|\]]/g,"").split("");function OFe(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(t[n].search(XG.hanidec)!==-1)e+=NFe.indexOf(t[n]);else for(const i in JQ){const[s,o]=JQ[i];r>=s&&r<=o&&(e+=r-s)}}return parseInt(e,10)}else return e}const UF=new Map;function LFe(){UF.clear()}function Au({numberingSystem:t},e=""){const n=t||"latn";let r=UF.get(n);r===void 0&&(r=new Map,UF.set(n,r));let i=r.get(e);return i===void 0&&(i=new RegExp(`${XG[n]}${e}`),r.set(e,i)),i}let QQ=()=>Date.now(),eee="system",tee=null,nee=null,ree=null,iee=60,see,oee=null,Hi=class{static get now(){return QQ}static set now(e){QQ=e}static set defaultZone(e){eee=e}static get defaultZone(){return jm(eee,uO.instance)}static get defaultLocale(){return tee}static set defaultLocale(e){tee=e}static get defaultNumberingSystem(){return nee}static set defaultNumberingSystem(e){nee=e}static get defaultOutputCalendar(){return ree}static set defaultOutputCalendar(e){ree=e}static get defaultWeekSettings(){return oee}static set defaultWeekSettings(e){oee=GF(e)}static get twoDigitCutoffYear(){return iee}static set twoDigitCutoffYear(e){iee=e%100}static get throwOnInvalid(){return see}static set throwOnInvalid(e){see=e}static resetCaches(){Cr.resetCache(),uh.resetCache(),hn.resetCache(),LFe()}};class Zu{constructor(e,n){this.reason=e,this.explanation=n}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Gpe=[0,31,59,90,120,151,181,212,243,273,304,334],Bpe=[0,31,60,91,121,152,182,213,244,274,305,335];function Xc(t,e){return new Zu("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function ZG(t,e,n){const r=new Date(Date.UTC(t,e-1,n));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);const i=r.getUTCDay();return i===0?7:i}function Wpe(t,e,n){return n+(oI(t)?Bpe:Gpe)[e-1]}function Hpe(t,e){const n=oI(t)?Bpe:Gpe,r=n.findIndex(s=>s<e),i=e-n[r];return{month:r+1,day:i}}function JG(t,e){return(t-e+7)%7+1}function b4(t,e=4,n=1){const{year:r,month:i,day:s}=t,o=Wpe(r,i,s),a=JG(ZG(r,i,s),n);let l=Math.floor((o-a+14-e)/7),c;return l<1?(c=r-1,l=kk(c,e,n)):l>kk(r,e,n)?(c=r+1,l=1):c=r,{weekYear:c,weekNumber:l,weekday:a,...pO(t)}}function aee(t,e=4,n=1){const{weekYear:r,weekNumber:i,weekday:s}=t,o=JG(ZG(r,1,e),n),a=Hx(r);let l=i*7+s-o-7+e,c;l<1?(c=r-1,l+=Hx(c)):l>a?(c=r+1,l-=Hx(r)):c=r;const{month:u,day:h}=Hpe(c,l);return{year:c,month:u,day:h,...pO(t)}}function l$(t){const{year:e,month:n,day:r}=t,i=Wpe(e,n,r);return{year:e,ordinal:i,...pO(t)}}function lee(t){const{year:e,ordinal:n}=t,{month:r,day:i}=Hpe(e,n);return{year:e,month:r,day:i,...pO(t)}}function cee(t,e){if(!Sn(t.localWeekday)||!Sn(t.localWeekNumber)||!Sn(t.localWeekYear)){if(!Sn(t.weekday)||!Sn(t.weekNumber)||!Sn(t.weekYear))throw new px("Cannot mix locale-based week fields with ISO-based week fields");return Sn(t.localWeekday)||(t.weekday=t.localWeekday),Sn(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Sn(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function DFe(t,e=4,n=1){const r=hO(t.weekYear),i=Zc(t.weekNumber,1,kk(t.weekYear,e,n)),s=Zc(t.weekday,1,7);return r?i?s?!1:Xc("weekday",t.weekday):Xc("week",t.weekNumber):Xc("weekYear",t.weekYear)}function $Fe(t){const e=hO(t.year),n=Zc(t.ordinal,1,Hx(t.year));return e?n?!1:Xc("ordinal",t.ordinal):Xc("year",t.year)}function qpe(t){const e=hO(t.year),n=Zc(t.month,1,12),r=Zc(t.day,1,E4(t.year,t.month));return e?n?r?!1:Xc("day",t.day):Xc("month",t.month):Xc("year",t.year)}function Kpe(t){const{hour:e,minute:n,second:r,millisecond:i}=t,s=Zc(e,0,23)||e===24&&n===0&&r===0&&i===0,o=Zc(n,0,59),a=Zc(r,0,59),l=Zc(i,0,999);return s?o?a?l?!1:Xc("millisecond",i):Xc("second",r):Xc("minute",n):Xc("hour",e)}function Sn(t){return typeof t>"u"}function mg(t){return typeof t=="number"}function hO(t){return typeof t=="number"&&t%1===0}function jFe(t){return typeof t=="string"}function FFe(t){return Object.prototype.toString.call(t)==="[object Date]"}function Ype(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Xpe(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function VFe(t){return Array.isArray(t)?t:[t]}function uee(t,e,n){if(t.length!==0)return t.reduce((r,i)=>{const s=[e(i),i];return r&&n(r[0],s[0])===r[0]?r:s},null)[1]}function zFe(t,e){return e.reduce((n,r)=>(n[r]=t[r],n),{})}function c2(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function GF(t){if(t==null)return null;if(typeof t!="object")throw new Qo("Week settings must be an object");if(!Zc(t.firstDay,1,7)||!Zc(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Zc(e,1,7)))throw new Qo("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Zc(t,e,n){return hO(t)&&t>=e&&t<=n}function UFe(t,e){return t-e*Math.floor(t/e)}function _s(t,e=2){const n=t<0;let r;return n?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function Rm(t){if(!(Sn(t)||t===null||t===""))return parseInt(t,10)}function k0(t){if(!(Sn(t)||t===null||t===""))return parseFloat(t)}function QG(t){if(!(Sn(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function eB(t,e,n="round"){const r=10**e;switch(n){case"expand":return t>0?Math.ceil(t*r)/r:Math.floor(t*r)/r;case"trunc":return Math.trunc(t*r)/r;case"round":return Math.round(t*r)/r;case"floor":return Math.floor(t*r)/r;case"ceil":return Math.ceil(t*r)/r;default:throw new RangeError(`Value rounding ${n} is out of range`)}}function oI(t){return t%4===0&&(t%100!==0||t%400===0)}function Hx(t){return oI(t)?366:365}function E4(t,e){const n=UFe(e-1,12)+1,r=t+(e-n)/12;return n===2?oI(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function dO(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function hee(t,e,n){return-JG(ZG(t,1,e),n)+e-1}function kk(t,e=4,n=1){const r=hee(t,e,n),i=hee(t+1,e,n);return(Hx(t)-r+i)/7}function BF(t){return t>99?t:t>Hi.twoDigitCutoffYear?1900+t:2e3+t}function Zpe(t,e,n,r=null){const i=new Date(t),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(s.timeZone=r);const o={timeZoneName:e,...s},a=new Intl.DateTimeFormat(n,o).formatToParts(i).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function fO(t,e){let n=parseInt(t,10);Number.isNaN(n)&&(n=0);const r=parseInt(e,10)||0,i=n<0||Object.is(n,-0)?-r:r;return n*60+i}function Jpe(t){const e=Number(t);if(typeof t=="boolean"||t===""||!Number.isFinite(e))throw new Qo(`Invalid unit value ${t}`);return e}function S4(t,e){const n={};for(const r in t)if(c2(t,r)){const i=t[r];if(i==null)continue;n[e(r)]=Jpe(i)}return n}function QS(t,e){const n=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),i=t>=0?"+":"-";switch(e){case"short":return`${i}${_s(n,2)}:${_s(r,2)}`;case"narrow":return`${i}${n}${r>0?`:${r}`:""}`;case"techie":return`${i}${_s(n,2)}${_s(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function pO(t){return zFe(t,["hour","minute","second","millisecond"])}const GFe=["January","February","March","April","May","June","July","August","September","October","November","December"],Qpe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],BFe=["J","F","M","A","M","J","J","A","S","O","N","D"];function eme(t){switch(t){case"narrow":return[...BFe];case"short":return[...Qpe];case"long":return[...GFe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const tme=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],nme=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],WFe=["M","T","W","T","F","S","S"];function rme(t){switch(t){case"narrow":return[...WFe];case"short":return[...nme];case"long":return[...tme];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const ime=["AM","PM"],HFe=["Before Christ","Anno Domini"],qFe=["BC","AD"],KFe=["B","A"];function sme(t){switch(t){case"narrow":return[...KFe];case"short":return[...qFe];case"long":return[...HFe];default:return null}}function YFe(t){return ime[t.hour<12?0:1]}function XFe(t,e){return rme(e)[t.weekday-1]}function ZFe(t,e){return eme(e)[t.month-1]}function JFe(t,e){return sme(e)[t.year<0?0:1]}function QFe(t,e,n="always",r=!1){const i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(t)===-1;if(n==="auto"&&s){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${i[t][0]}`;case-1:return h?"yesterday":`last ${i[t][0]}`;case 0:return h?"today":`this ${i[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=i[t],u=r?l?c[1]:c[2]||c[1]:l?i[t][0]:t;return o?`${a} ${u} ago`:`in ${a} ${u}`}function dee(t,e){let n="";for(const r of t)r.literal?n+=r.val:n+=e(r.val);return n}const e9e={D:w4,DD:bpe,DDD:Epe,DDDD:Spe,t:Tpe,tt:kpe,ttt:Ape,tttt:Ipe,T:Rpe,TT:Ppe,TTT:Mpe,TTTT:Cpe,f:Npe,ff:Lpe,fff:$pe,ffff:Fpe,F:Ope,FF:Dpe,FFF:jpe,FFFF:Vpe};class sa{static create(e,n={}){return new sa(e,n)}static parseFormat(e){let n=null,r="",i=!1;const s=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?((r.length>0||i)&&s.push({literal:i||/^\s+$/.test(r),val:r===""?"'":r}),n=null,r="",i=!i):i||a===n?r+=a:(r.length>0&&s.push({literal:/^\s+$/.test(r),val:r}),r=a,n=a)}return r.length>0&&s.push({literal:i||/^\s+$/.test(r),val:r}),s}static macroTokenToFormatOpts(e){return e9e[e]}constructor(e,n){this.opts=n,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,n){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...n}).format()}dtFormatter(e,n={}){return this.loc.dtFormatter(e,{...this.opts,...n})}formatDateTime(e,n){return this.dtFormatter(e,n).format()}formatDateTimeParts(e,n){return this.dtFormatter(e,n).formatToParts()}formatInterval(e,n){return this.dtFormatter(e.start,n).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,n){return this.dtFormatter(e,n).resolvedOptions()}num(e,n=0,r=void 0){if(this.opts.forceSimple)return _s(e,n);const i={...this.opts};return n>0&&(i.padTo=n),r&&(i.signDisplay=r),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,n){const r=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(g,v)=>this.loc.extract(e,g,v),o=g=>e.isOffsetFixed&&e.offset===0&&g.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,g.format):"",a=()=>r?YFe(e):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(g,v)=>r?ZFe(e,g):s(v?{month:g}:{month:g,day:"numeric"},"month"),c=(g,v)=>r?XFe(e,g):s(v?{weekday:g}:{weekday:g,month:"long",day:"numeric"},"weekday"),u=g=>{const v=sa.macroTokenToFormatOpts(g);return v?this.formatWithSystemDefault(e,v):g},h=g=>r?JFe(e,g):s({era:g},"era"),f=g=>{switch(g){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return i?s({day:"numeric"},"day"):this.num(e.day);case"dd":return i?s({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return i?s({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?s({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return i?s({month:"numeric"},"month"):this.num(e.month);case"MM":return i?s({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return i?s({year:"numeric"},"year"):this.num(e.year);case"yy":return i?s({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?s({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?s({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(g)}};return dee(sa.parseFormat(n),f)}formatDurationFromString(e,n){const r=this.opts.signMode==="negativeLargestOnly"?-1:1,i=u=>{switch(u[0]){case"S":return"milliseconds";case"s":return"seconds";case"m":return"minutes";case"h":return"hours";case"d":return"days";case"w":return"weeks";case"M":return"months";case"y":return"years";default:return null}},s=(u,h)=>f=>{const g=i(f);if(g){const v=h.isNegativeDuration&&g!==h.largestUnit?r:1;let x;return this.opts.signMode==="negativeLargestOnly"&&g!==h.largestUnit?x="never":this.opts.signMode==="all"?x="always":x="auto",this.num(u.get(g)*v,f.length,x)}else return f},o=sa.parseFormat(n),a=o.reduce((u,{literal:h,val:f})=>h?u:u.concat(f),[]),l=e.shiftTo(...a.map(i).filter(u=>u)),c={isNegativeDuration:l<0,largestUnit:Object.keys(l.values)[0]};return dee(o,s(l,c))}}const ome=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Z2(...t){const e=t.reduce((n,r)=>n+r.source,"");return RegExp(`^${e}$`)}function J2(...t){return e=>t.reduce(([n,r,i],s)=>{const[o,a,l]=s(e,i);return[{...n,...o},a||r,l]},[{},null,1]).slice(0,2)}function Q2(t,...e){if(t==null)return[null,null];for(const[n,r]of e){const i=n.exec(t);if(i)return r(i)}return[null,null]}function ame(...t){return(e,n)=>{const r={};let i;for(i=0;i<t.length;i++)r[t[i]]=Rm(e[n+i]);return[r,null,n+i]}}const lme=/(?:([Zz])|([+-]\d\d)(?::?(\d\d))?)/,t9e=`(?:${lme.source}?(?:\\[(${ome.source})\\])?)?`,tB=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,cme=RegExp(`${tB.source}${t9e}`),nB=RegExp(`(?:[Tt]${cme.source})?`),n9e=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,r9e=/(\d{4})-?W(\d\d)(?:-?(\d))?/,i9e=/(\d{4})-?(\d{3})/,s9e=ame("weekYear","weekNumber","weekDay"),o9e=ame("year","ordinal"),a9e=/(\d{4})-(\d\d)-(\d\d)/,ume=RegExp(`${tB.source} ?(?:${lme.source}|(${ome.source}))?`),l9e=RegExp(`(?: ${ume.source})?`);function qx(t,e,n){const r=t[e];return Sn(r)?n:Rm(r)}function c9e(t,e){return[{year:qx(t,e),month:qx(t,e+1,1),day:qx(t,e+2,1)},null,e+3]}function eb(t,e){return[{hours:qx(t,e,0),minutes:qx(t,e+1,0),seconds:qx(t,e+2,0),milliseconds:QG(t[e+3])},null,e+4]}function aI(t,e){const n=!t[e]&&!t[e+1],r=fO(t[e+1],t[e+2]),i=n?null:aa.instance(r);return[{},i,e+3]}function lI(t,e){const n=t[e]?uh.create(t[e]):null;return[{},n,e+1]}const u9e=RegExp(`^T?${tB.source}$`),h9e=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function d9e(t){const[e,n,r,i,s,o,a,l,c]=t,u=e[0]==="-",h=l&&l[0]==="-",f=(g,v=!1)=>g!==void 0&&(v||g&&u)?-g:g;return[{years:f(k0(n)),months:f(k0(r)),weeks:f(k0(i)),days:f(k0(s)),hours:f(k0(o)),minutes:f(k0(a)),seconds:f(k0(l),l==="-0"),milliseconds:f(QG(c),h)}]}const f9e={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function rB(t,e,n,r,i,s,o){const a={year:e.length===2?BF(Rm(e)):Rm(e),month:Qpe.indexOf(n)+1,day:Rm(r),hour:Rm(i),minute:Rm(s)};return o&&(a.second=Rm(o)),t&&(a.weekday=t.length>3?tme.indexOf(t)+1:nme.indexOf(t)+1),a}const p9e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function m9e(t){const[,e,n,r,i,s,o,a,l,c,u,h]=t,f=rB(e,i,r,n,s,o,a);let g;return l?g=f9e[l]:c?g=0:g=fO(u,h),[f,new aa(g)]}function g9e(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const y9e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,v9e=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,_9e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function fee(t){const[,e,n,r,i,s,o,a]=t;return[rB(e,i,r,n,s,o,a),aa.utcInstance]}function x9e(t){const[,e,n,r,i,s,o,a]=t;return[rB(e,a,n,r,i,s,o),aa.utcInstance]}const w9e=Z2(n9e,nB),b9e=Z2(r9e,nB),E9e=Z2(i9e,nB),S9e=Z2(cme),hme=J2(c9e,eb,aI,lI),T9e=J2(s9e,eb,aI,lI),k9e=J2(o9e,eb,aI,lI),A9e=J2(eb,aI,lI);function I9e(t){return Q2(t,[w9e,hme],[b9e,T9e],[E9e,k9e],[S9e,A9e])}function R9e(t){return Q2(g9e(t),[p9e,m9e])}function P9e(t){return Q2(t,[y9e,fee],[v9e,fee],[_9e,x9e])}function M9e(t){return Q2(t,[h9e,d9e])}const C9e=J2(eb);function N9e(t){return Q2(t,[u9e,C9e])}const O9e=Z2(a9e,l9e),L9e=Z2(ume),D9e=J2(eb,aI,lI);function $9e(t){return Q2(t,[O9e,hme],[L9e,D9e])}const pee="Invalid Duration",dme={weeks:{days:7,hours:168,minutes:10080,seconds:10080*60,milliseconds:10080*60*1e3},days:{hours:24,minutes:1440,seconds:1440*60,milliseconds:1440*60*1e3},hours:{minutes:60,seconds:3600,milliseconds:3600*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},j9e={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:2184*60,seconds:2184*60*60,milliseconds:2184*60*60*1e3},months:{weeks:4,days:30,hours:720,minutes:720*60,seconds:720*60*60,milliseconds:720*60*60*1e3},...dme},Tc=146097/400,u_=146097/4800,F9e={years:{quarters:4,months:12,weeks:Tc/7,days:Tc,hours:Tc*24,minutes:Tc*24*60,seconds:Tc*24*60*60,milliseconds:Tc*24*60*60*1e3},quarters:{months:3,weeks:Tc/28,days:Tc/4,hours:Tc*24/4,minutes:Tc*24*60/4,seconds:Tc*24*60*60/4,milliseconds:Tc*24*60*60*1e3/4},months:{weeks:u_/7,days:u_,hours:u_*24,minutes:u_*24*60,seconds:u_*24*60*60,milliseconds:u_*24*60*60*1e3},...dme},Py=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],V9e=Py.slice(0).reverse();function ef(t,e,n=!1){const r={values:n?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new dr(r)}function fme(t,e){let n=e.milliseconds??0;for(const r of V9e.slice(1))e[r]&&(n+=e[r]*t[r].milliseconds);return n}function mee(t,e){const n=fme(t,e)<0?-1:1;Py.reduceRight((r,i)=>{if(Sn(e[i]))return r;if(r){const s=e[r]*n,o=t[i][r],a=Math.floor(s/o);e[i]+=a*n,e[r]-=a*o*n}return i},null),Py.reduce((r,i)=>{if(Sn(e[i]))return r;if(r){const s=e[r]%1;e[r]-=s,e[i]+=s*t[r][i]}return i},null)}function gee(t){const e={};for(const[n,r]of Object.entries(t))r!==0&&(e[n]=r);return e}class dr{constructor(e){const n=e.conversionAccuracy==="longterm"||!1;let r=n?F9e:j9e;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||Cr.create(),this.conversionAccuracy=n?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,n){return dr.fromObject({milliseconds:e},n)}static fromObject(e,n={}){if(e==null||typeof e!="object")throw new Qo(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new dr({values:S4(e,dr.normalizeUnit),loc:Cr.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})}static fromDurationLike(e){if(mg(e))return dr.fromMillis(e);if(dr.isDuration(e))return e;if(typeof e=="object")return dr.fromObject(e);throw new Qo(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,n){const[r]=M9e(e);return r?dr.fromObject(r,n):dr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,n){const[r]=N9e(e);return r?dr.fromObject(r,n):dr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,n=null){if(!e)throw new Qo("need to specify a reason the Duration is invalid");const r=e instanceof Zu?e:new Zu(e,n);if(Hi.throwOnInvalid)throw new dFe(r);return new dr({invalid:r})}static normalizeUnit(e){const n={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!n)throw new wpe(e);return n}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,n={}){const r={...n,floor:n.round!==!1&&n.floor!==!1};return this.isValid?sa.create(this.loc,r).formatDurationFromString(this,e):pee}toHuman(e={}){if(!this.isValid)return pee;const n=e.showZeros!==!1,r=Py.map(i=>{const s=this.values[i];return Sn(s)||s===0&&!n?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(s)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=eB(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const n=this.toMillis();return n<0||n>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},hn.fromMillis(n,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?fme(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e),r={};for(const i of Py)(c2(n.values,i)||c2(this.values,i))&&(r[i]=n.get(i)+this.get(i));return ef(this,{values:r},!0)}minus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e);return this.plus(n.negate())}mapUnits(e){if(!this.isValid)return this;const n={};for(const r of Object.keys(this.values))n[r]=Jpe(e(this.values[r],r));return ef(this,{values:n},!0)}get(e){return this[dr.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const n={...this.values,...S4(e,dr.normalizeUnit)};return ef(this,{values:n})}reconfigure({locale:e,numberingSystem:n,conversionAccuracy:r,matrix:i}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:n}),matrix:i,conversionAccuracy:r};return ef(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return mee(this.matrix,e),ef(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=gee(this.normalize().shiftToAll().toObject());return ef(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>dr.normalizeUnit(o));const n={},r={},i=this.toObject();let s;for(const o of Py)if(e.indexOf(o)>=0){s=o;let a=0;for(const c in r)a+=this.matrix[c][o]*r[c],r[c]=0;mg(i[o])&&(a+=i[o]);const l=Math.trunc(a);n[o]=l,r[o]=(a*1e3-l*1e3)/1e3}else mg(i[o])&&(r[o]=i[o]);for(const o in r)r[o]!==0&&(n[s]+=o===s?r[o]:r[o]/this.matrix[s][o]);return mee(this.matrix,n),ef(this,{values:n},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const n of Object.keys(this.values))e[n]=this.values[n]===0?0:-this.values[n];return ef(this,{values:e},!0)}removeZeros(){if(!this.isValid)return this;const e=gee(this.values);return ef(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function n(r,i){return r===void 0||r===0?i===void 0||i===0:r===i}for(const r of Py)if(!n(this.values[r],e.values[r]))return!1;return!0}}const h_="Invalid Interval";function z9e(t,e){return!t||!t.isValid?Gi.invalid("missing or invalid start"):!e||!e.isValid?Gi.invalid("missing or invalid end"):e<t?Gi.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Gi{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,n=null){if(!e)throw new Qo("need to specify a reason the Interval is invalid");const r=e instanceof Zu?e:new Zu(e,n);if(Hi.throwOnInvalid)throw new hFe(r);return new Gi({invalid:r})}static fromDateTimes(e,n){const r=mE(e),i=mE(n),s=z9e(r,i);return s??new Gi({start:r,end:i})}static after(e,n){const r=dr.fromDurationLike(n),i=mE(e);return Gi.fromDateTimes(i,i.plus(r))}static before(e,n){const r=dr.fromDurationLike(n),i=mE(e);return Gi.fromDateTimes(i.minus(r),i)}static fromISO(e,n){const[r,i]=(e||"").split("/",2);if(r&&i){let s,o;try{s=hn.fromISO(r,n),o=s.isValid}catch{o=!1}let a,l;try{a=hn.fromISO(i,n),l=a.isValid}catch{l=!1}if(o&&l)return Gi.fromDateTimes(s,a);if(o){const c=dr.fromISO(i,n);if(c.isValid)return Gi.after(s,c)}else if(l){const c=dr.fromISO(r,n);if(c.isValid)return Gi.before(a,c)}}return Gi.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",n){if(!this.isValid)return NaN;const r=this.start.startOf(e,n);let i;return n?.useLocaleWeeks?i=this.end.reconfigure({locale:r.locale}):i=this.end,i=i.startOf(e,n),Math.floor(i.diff(r,e).get(e))+(i.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:n}={}){return this.isValid?Gi.fromDateTimes(e||this.s,n||this.e):this}splitAt(...e){if(!this.isValid)return[];const n=e.map(mE).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),r=[];let{s:i}=this,s=0;for(;i<this.e;){const o=n[s]||this.e,a=+o>+this.e?this.e:o;r.push(Gi.fromDateTimes(i,a)),i=a,s+=1}return r}splitBy(e){const n=dr.fromDurationLike(e);if(!this.isValid||!n.isValid||n.as("milliseconds")===0)return[];let{s:r}=this,i=1,s;const o=[];for(;r<this.e;){const a=this.start.plus(n.mapUnits(l=>l*i));s=+a>+this.e?this.e:a,o.push(Gi.fromDateTimes(r,s)),r=s,i+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const n=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return n>=r?null:Gi.fromDateTimes(n,r)}union(e){if(!this.isValid)return this;const n=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return Gi.fromDateTimes(n,r)}static merge(e){const[n,r]=e.sort((i,s)=>i.s-s.s).reduce(([i,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[i,s.union(o)]:[i.concat([s]),o]:[i,o],[[],null]);return r&&n.push(r),n}static xor(e){let n=null,r=0;const i=[],s=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((l,c)=>l.time-c.time);for(const l of a)r+=l.type==="s"?1:-1,r===1?n=l.time:(n&&+n!=+l.time&&i.push(Gi.fromDateTimes(n,l.time)),n=null);return Gi.merge(i)}difference(...e){return Gi.xor([this].concat(e)).map(n=>this.intersection(n)).filter(n=>n&&!n.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()}  ${this.e.toISO()})`:h_}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=w4,n={}){return this.isValid?sa.create(this.s.loc.clone(n),e).formatInterval(this):h_}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:h_}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:h_}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:h_}toFormat(e,{separator:n="  "}={}){return this.isValid?`${this.s.toFormat(e)}${n}${this.e.toFormat(e)}`:h_}toDuration(e,n){return this.isValid?this.e.diff(this.s,e,n):dr.invalid(this.invalidReason)}mapEndpoints(e){return Gi.fromDateTimes(e(this.s),e(this.e))}}let yP=class{static hasDST(e=Hi.defaultZone){const n=hn.now().setZone(e).set({month:12});return!e.isUniversal&&n.offset!==n.set({month:6}).offset}static isValidIANAZone(e){return uh.isValidZone(e)}static normalizeZone(e){return jm(e,Hi.defaultZone)}static getStartOfWeek({locale:e=null,locObj:n=null}={}){return(n||Cr.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:n=null}={}){return(n||Cr.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:n=null}={}){return(n||Cr.create(e)).getWeekendDays().slice()}static months(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Cr.create(n,r,s)).months(e)}static monthsFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:s="gregory"}={}){return(i||Cr.create(n,r,s)).months(e,!0)}static weekdays(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Cr.create(n,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||Cr.create(n,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return Cr.create(e).meridiems()}static eras(e="short",{locale:n=null}={}){return Cr.create(n,null,"gregory").eras(e)}static features(){return{relative:Ype(),localeWeek:Xpe()}}};function yee(t,e){const n=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(e)-n(t);return Math.floor(dr.fromMillis(r).as("days"))}function U9e(t,e,n){const r=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{const u=yee(l,c);return(u-u%7)/7}],["days",yee]],i={},s=t;let o,a;for(const[l,c]of r)n.indexOf(l)>=0&&(o=l,i[l]=c(t,e),a=s.plus(i),a>e?(i[l]--,t=s.plus(i),t>e&&(a=t,i[l]--,t=s.plus(i))):t=a);return[t,i,a,o]}function G9e(t,e,n,r){let[i,s,o,a]=U9e(t,e,n);const l=e-i,c=n.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);c.length===0&&(o<e&&(o=i.plus({[a]:1})),o!==i&&(s[a]=(s[a]||0)+l/(o-i)));const u=dr.fromObject(s,r);return c.length>0?dr.fromMillis(l,r).shiftTo(...c).plus(u):u}const B9e="missing Intl.DateTimeFormat.formatToParts support";function _r(t,e=n=>n){return{regex:t,deser:([n])=>e(OFe(n))}}const W9e="",pme=`[ ${W9e}]`,mme=new RegExp(pme,"g");function H9e(t){return t.replace(/\./g,"\\.?").replace(mme,pme)}function vee(t){return t.replace(/\./g,"").replace(mme," ").toLowerCase()}function Iu(t,e){return t===null?null:{regex:RegExp(t.map(H9e).join("|")),deser:([n])=>t.findIndex(r=>vee(n)===vee(r))+e}}function _ee(t,e){return{regex:t,deser:([,n,r])=>fO(n,r),groups:e}}function vP(t){return{regex:t,deser:([e])=>e}}function q9e(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function K9e(t,e){const n=Au(e),r=Au(e,"{2}"),i=Au(e,"{3}"),s=Au(e,"{4}"),o=Au(e,"{6}"),a=Au(e,"{1,2}"),l=Au(e,"{1,3}"),c=Au(e,"{1,6}"),u=Au(e,"{1,9}"),h=Au(e,"{2,4}"),f=Au(e,"{4,6}"),g=b=>({regex:RegExp(q9e(b.val)),deser:([T])=>T,literal:!0}),x=(b=>{if(t.literal)return g(b);switch(b.val){case"G":return Iu(e.eras("short"),0);case"GG":return Iu(e.eras("long"),0);case"y":return _r(c);case"yy":return _r(h,BF);case"yyyy":return _r(s);case"yyyyy":return _r(f);case"yyyyyy":return _r(o);case"M":return _r(a);case"MM":return _r(r);case"MMM":return Iu(e.months("short",!0),1);case"MMMM":return Iu(e.months("long",!0),1);case"L":return _r(a);case"LL":return _r(r);case"LLL":return Iu(e.months("short",!1),1);case"LLLL":return Iu(e.months("long",!1),1);case"d":return _r(a);case"dd":return _r(r);case"o":return _r(l);case"ooo":return _r(i);case"HH":return _r(r);case"H":return _r(a);case"hh":return _r(r);case"h":return _r(a);case"mm":return _r(r);case"m":return _r(a);case"q":return _r(a);case"qq":return _r(r);case"s":return _r(a);case"ss":return _r(r);case"S":return _r(l);case"SSS":return _r(i);case"u":return vP(u);case"uu":return vP(a);case"uuu":return _r(n);case"a":return Iu(e.meridiems(),0);case"kkkk":return _r(s);case"kk":return _r(h,BF);case"W":return _r(a);case"WW":return _r(r);case"E":case"c":return _r(n);case"EEE":return Iu(e.weekdays("short",!1),1);case"EEEE":return Iu(e.weekdays("long",!1),1);case"ccc":return Iu(e.weekdays("short",!0),1);case"cccc":return Iu(e.weekdays("long",!0),1);case"Z":case"ZZ":return _ee(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return _ee(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return vP(/[a-z_+-/]{1,256}?/i);case" ":return vP(/[^\S\n\r]/);default:return g(b)}})(t)||{invalidReason:B9e};return x.token=t,x}const Y9e={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function X9e(t,e,n){const{type:r,value:i}=t;if(r==="literal"){const l=/^\s+$/.test(i);return{literal:!l,val:l?" ":i}}const s=e[r];let o=r;r==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=n.hour12?"hour12":"hour24");let a=Y9e[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function Z9e(t){return[`^${t.map(n=>n.regex).reduce((n,r)=>`${n}(${r.source})`,"")}$`,t]}function J9e(t,e,n){const r=t.match(e);if(r){const i={};let s=1;for(const o in n)if(c2(n,o)){const a=n[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(r.slice(s,s+l))),s+=l}return[r,i]}else return[r,{}]}function Q9e(t){const e=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let n=null,r;return Sn(t.z)||(n=uh.create(t.z)),Sn(t.Z)||(n||(n=new aa(t.Z)),r=t.Z),Sn(t.q)||(t.M=(t.q-1)*3+1),Sn(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Sn(t.u)||(t.S=QG(t.u)),[Object.keys(t).reduce((s,o)=>{const a=e(o);return a&&(s[a]=t[o]),s},{}),n,r]}let c$=null;function e7e(){return c$||(c$=hn.fromMillis(1555555555555)),c$}function t7e(t,e){if(t.literal)return t;const n=sa.macroTokenToFormatOpts(t.val),r=_me(n,e);return r==null||r.includes(void 0)?t:r}function gme(t,e){return Array.prototype.concat(...t.map(n=>t7e(n,e)))}class yme{constructor(e,n){if(this.locale=e,this.format=n,this.tokens=gme(sa.parseFormat(n),e),this.units=this.tokens.map(r=>K9e(r,e)),this.disqualifyingUnit=this.units.find(r=>r.invalidReason),!this.disqualifyingUnit){const[r,i]=Z9e(this.units);this.regex=RegExp(r,"i"),this.handlers=i}}explainFromTokens(e){if(this.isValid){const[n,r]=J9e(e,this.regex,this.handlers),[i,s,o]=r?Q9e(r):[null,null,void 0];if(c2(r,"a")&&c2(r,"H"))throw new px("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:n,matches:r,result:i,zone:s,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function vme(t,e,n){return new yme(t,n).explainFromTokens(e)}function n7e(t,e,n){const{result:r,zone:i,specificOffset:s,invalidReason:o}=vme(t,e,n);return[r,i,s,o]}function _me(t,e){if(!t)return null;const r=sa.create(e,t).dtFormatter(e7e()),i=r.formatToParts(),s=r.resolvedOptions();return i.map(o=>X9e(o,t,s))}const u$="Invalid DateTime",xee=864e13;function JE(t){return new Zu("unsupported zone",`the zone "${t.name}" is not supported`)}function h$(t){return t.weekData===null&&(t.weekData=b4(t.c)),t.weekData}function d$(t){return t.localWeekData===null&&(t.localWeekData=b4(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function A0(t,e){const n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new hn({...n,...e,old:n})}function xme(t,e,n){let r=t-e*60*1e3;const i=n.offset(r);if(e===i)return[r,e];r-=(i-e)*60*1e3;const s=n.offset(r);return i===s?[r,i]:[t-Math.min(i,s)*60*1e3,Math.max(i,s)]}function _P(t,e){t+=e*60*1e3;const n=new Date(t);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function YM(t,e,n){return xme(dO(t),e,n)}function wee(t,e){const n=t.o,r=t.c.year+Math.trunc(e.years),i=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,s={...t.c,year:r,month:i,day:Math.min(t.c.day,E4(r,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=dr.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=dO(s);let[l,c]=xme(a,n,t.zone);return o!==0&&(l+=o,c=t.zone.offset(l)),{ts:l,o:c}}function d_(t,e,n,r,i,s){const{setZone:o,zone:a}=n;if(t&&Object.keys(t).length!==0||e){const l=e||a,c=hn.fromObject(t,{...n,zone:l,specificOffset:s});return o?c:c.setZone(a)}else return hn.invalid(new Zu("unparsable",`the input "${i}" can't be parsed as ${r}`))}function xP(t,e,n=!0){return t.isValid?sa.create(Cr.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(t,e):null}function f$(t,e,n){const r=t.c.year>9999||t.c.year<0;let i="";if(r&&t.c.year>=0&&(i+="+"),i+=_s(t.c.year,r?6:4),n==="year")return i;if(e){if(i+="-",i+=_s(t.c.month),n==="month")return i;i+="-"}else if(i+=_s(t.c.month),n==="month")return i;return i+=_s(t.c.day),i}function bee(t,e,n,r,i,s,o){let a=!n||t.c.millisecond!==0||t.c.second!==0,l="";switch(o){case"day":case"month":case"year":break;default:if(l+=_s(t.c.hour),o==="hour")break;if(e){if(l+=":",l+=_s(t.c.minute),o==="minute")break;a&&(l+=":",l+=_s(t.c.second))}else{if(l+=_s(t.c.minute),o==="minute")break;a&&(l+=_s(t.c.second))}if(o==="second")break;a&&(!r||t.c.millisecond!==0)&&(l+=".",l+=_s(t.c.millisecond,3))}return i&&(t.isOffsetFixed&&t.offset===0&&!s?l+="Z":t.o<0?(l+="-",l+=_s(Math.trunc(-t.o/60)),l+=":",l+=_s(Math.trunc(-t.o%60))):(l+="+",l+=_s(Math.trunc(t.o/60)),l+=":",l+=_s(Math.trunc(t.o%60)))),s&&(l+="["+t.zone.ianaName+"]"),l}const wme={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},r7e={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},i7e={ordinal:1,hour:0,minute:0,second:0,millisecond:0},XM=["year","month","day","hour","minute","second","millisecond"],s7e=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],o7e=["year","ordinal","hour","minute","second","millisecond"];function ZM(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new wpe(t);return e}function Eee(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return ZM(t)}}function a7e(t){if(QE===void 0&&(QE=Hi.now()),t.type!=="iana")return t.offset(QE);const e=t.name;let n=WF.get(e);return n===void 0&&(n=t.offset(QE),WF.set(e,n)),n}function See(t,e){const n=jm(e.zone,Hi.defaultZone);if(!n.isValid)return hn.invalid(JE(n));const r=Cr.fromObject(e);let i,s;if(Sn(t.year))i=Hi.now();else{for(const l of XM)Sn(t[l])&&(t[l]=wme[l]);const o=qpe(t)||Kpe(t);if(o)return hn.invalid(o);const a=a7e(n);[i,s]=YM(t,a,n)}return new hn({ts:i,zone:n,loc:r,o:s})}function Tee(t,e,n){const r=Sn(n.round)?!0:n.round,i=Sn(n.rounding)?"trunc":n.rounding,s=(a,l)=>(a=eB(a,r||n.calendary?0:2,n.calendary?"round":i),e.loc.clone(n).relFormatter(n).format(a,l)),o=a=>n.calendary?e.hasSame(t,a)?0:e.startOf(a).diff(t.startOf(a),a).get(a):e.diff(t,a).get(a);if(n.unit)return s(o(n.unit),n.unit);for(const a of n.units){const l=o(a);if(Math.abs(l)>=1)return s(l,a)}return s(t>e?-0:0,n.units[n.units.length-1])}function kee(t){let e={},n;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],n=Array.from(t).slice(0,t.length-1)):n=Array.from(t),[e,n]}let QE;const WF=new Map;class hn{constructor(e){const n=e.zone||Hi.defaultZone;let r=e.invalid||(Number.isNaN(e.ts)?new Zu("invalid input"):null)||(n.isValid?null:JE(n));this.ts=Sn(e.ts)?Hi.now():e.ts;let i=null,s=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(n))[i,s]=[e.old.c,e.old.o];else{const a=mg(e.o)&&!e.old?e.o:n.offset(this.ts);i=_P(this.ts,a),r=Number.isNaN(i.year)?new Zu("invalid input"):null,i=r?null:i,s=r?null:a}this._zone=n,this.loc=e.loc||Cr.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=i,this.o=s,this.isLuxonDateTime=!0}static now(){return new hn({})}static local(){const[e,n]=kee(arguments),[r,i,s,o,a,l,c]=n;return See({year:r,month:i,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static utc(){const[e,n]=kee(arguments),[r,i,s,o,a,l,c]=n;return e.zone=aa.utcInstance,See({year:r,month:i,day:s,hour:o,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,n={}){const r=FFe(e)?e.valueOf():NaN;if(Number.isNaN(r))return hn.invalid("invalid input");const i=jm(n.zone,Hi.defaultZone);return i.isValid?new hn({ts:r,zone:i,loc:Cr.fromObject(n)}):hn.invalid(JE(i))}static fromMillis(e,n={}){if(mg(e))return e<-xee||e>xee?hn.invalid("Timestamp out of range"):new hn({ts:e,zone:jm(n.zone,Hi.defaultZone),loc:Cr.fromObject(n)});throw new Qo(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,n={}){if(mg(e))return new hn({ts:e*1e3,zone:jm(n.zone,Hi.defaultZone),loc:Cr.fromObject(n)});throw new Qo("fromSeconds requires a numerical input")}static fromObject(e,n={}){e=e||{};const r=jm(n.zone,Hi.defaultZone);if(!r.isValid)return hn.invalid(JE(r));const i=Cr.fromObject(n),s=S4(e,Eee),{minDaysInFirstWeek:o,startOfWeek:a}=cee(s,i),l=Hi.now(),c=Sn(n.specificOffset)?r.offset(l):n.specificOffset,u=!Sn(s.ordinal),h=!Sn(s.year),f=!Sn(s.month)||!Sn(s.day),g=h||f,v=s.weekYear||s.weekNumber;if((g||u)&&v)throw new px("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(f&&u)throw new px("Can't mix ordinal dates with month/day");const x=v||s.weekday&&!g;let b,T,A=_P(l,c);x?(b=s7e,T=r7e,A=b4(A,o,a)):u?(b=o7e,T=i7e,A=l$(A)):(b=XM,T=wme);let I=!1;for(const F of b){const L=s[F];Sn(L)?I?s[F]=T[F]:s[F]=A[F]:I=!0}const R=x?DFe(s,o,a):u?$Fe(s):qpe(s),C=R||Kpe(s);if(C)return hn.invalid(C);const V=x?aee(s,o,a):u?lee(s):s,[M,N]=YM(V,c,r),O=new hn({ts:M,zone:r,o:N,loc:i});return s.weekday&&g&&e.weekday!==O.weekday?hn.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${O.toISO()}`):O.isValid?O:hn.invalid(O.invalid)}static fromISO(e,n={}){const[r,i]=I9e(e);return d_(r,i,n,"ISO 8601",e)}static fromRFC2822(e,n={}){const[r,i]=R9e(e);return d_(r,i,n,"RFC 2822",e)}static fromHTTP(e,n={}){const[r,i]=P9e(e);return d_(r,i,n,"HTTP",n)}static fromFormat(e,n,r={}){if(Sn(e)||Sn(n))throw new Qo("fromFormat requires an input string and a format");const{locale:i=null,numberingSystem:s=null}=r,o=Cr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0}),[a,l,c,u]=n7e(o,e,n);return u?hn.invalid(u):d_(a,l,r,`format ${n}`,e,c)}static fromString(e,n,r={}){return hn.fromFormat(e,n,r)}static fromSQL(e,n={}){const[r,i]=$9e(e);return d_(r,i,n,"SQL",e)}static invalid(e,n=null){if(!e)throw new Qo("need to specify a reason the DateTime is invalid");const r=e instanceof Zu?e:new Zu(e,n);if(Hi.throwOnInvalid)throw new uFe(r);return new hn({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,n={}){const r=_me(e,Cr.fromObject(n));return r?r.map(i=>i?i.val:null).join(""):null}static expandFormat(e,n={}){return gme(sa.parseFormat(e),Cr.fromObject(n)).map(i=>i.val).join("")}static resetCache(){QE=void 0,WF.clear()}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?h$(this).weekYear:NaN}get weekNumber(){return this.isValid?h$(this).weekNumber:NaN}get weekday(){return this.isValid?h$(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?d$(this).weekday:NaN}get localWeekNumber(){return this.isValid?d$(this).weekNumber:NaN}get localWeekYear(){return this.isValid?d$(this).weekYear:NaN}get ordinal(){return this.isValid?l$(this.c).ordinal:NaN}get monthShort(){return this.isValid?yP.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?yP.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?yP.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?yP.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,n=6e4,r=dO(this.c),i=this.zone.offset(r-e),s=this.zone.offset(r+e),o=this.zone.offset(r-i*n),a=this.zone.offset(r-s*n);if(o===a)return[this];const l=r-o*n,c=r-a*n,u=_P(l,o),h=_P(c,a);return u.hour===h.hour&&u.minute===h.minute&&u.second===h.second&&u.millisecond===h.millisecond?[A0(this,{ts:l}),A0(this,{ts:c})]:[this]}get isInLeapYear(){return oI(this.year)}get daysInMonth(){return E4(this.year,this.month)}get daysInYear(){return this.isValid?Hx(this.year):NaN}get weeksInWeekYear(){return this.isValid?kk(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?kk(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:n,numberingSystem:r,calendar:i}=sa.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:n,numberingSystem:r,outputCalendar:i}}toUTC(e=0,n={}){return this.setZone(aa.instance(e),n)}toLocal(){return this.setZone(Hi.defaultZone)}setZone(e,{keepLocalTime:n=!1,keepCalendarTime:r=!1}={}){if(e=jm(e,Hi.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(n||r){const s=e.offset(this.ts),o=this.toObject();[i]=YM(o,s,e)}return A0(this,{ts:i,zone:e})}else return hn.invalid(JE(e))}reconfigure({locale:e,numberingSystem:n,outputCalendar:r}={}){const i=this.loc.clone({locale:e,numberingSystem:n,outputCalendar:r});return A0(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const n=S4(e,Eee),{minDaysInFirstWeek:r,startOfWeek:i}=cee(n,this.loc),s=!Sn(n.weekYear)||!Sn(n.weekNumber)||!Sn(n.weekday),o=!Sn(n.ordinal),a=!Sn(n.year),l=!Sn(n.month)||!Sn(n.day),c=a||l,u=n.weekYear||n.weekNumber;if((c||o)&&u)throw new px("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new px("Can't mix ordinal dates with month/day");let h;s?h=aee({...b4(this.c,r,i),...n},r,i):Sn(n.ordinal)?(h={...this.toObject(),...n},Sn(n.day)&&(h.day=Math.min(E4(h.year,h.month),h.day))):h=lee({...l$(this.c),...n});const[f,g]=YM(h,this.o,this.zone);return A0(this,{ts:f,o:g})}plus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e);return A0(this,wee(this,n))}minus(e){if(!this.isValid)return this;const n=dr.fromDurationLike(e).negate();return A0(this,wee(this,n))}startOf(e,{useLocaleWeeks:n=!1}={}){if(!this.isValid)return this;const r={},i=dr.normalizeUnit(e);switch(i){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break}if(i==="weeks")if(n){const s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(r.weekNumber=this.weekNumber-1),r.weekday=s}else r.weekday=1;if(i==="quarters"){const s=Math.ceil(this.month/3);r.month=(s-1)*3+1}return this.set(r)}endOf(e,n){return this.isValid?this.plus({[e]:1}).startOf(e,n).minus(1):this}toFormat(e,n={}){return this.isValid?sa.create(this.loc.redefaultToEN(n)).formatDateTimeFromString(this,e):u$}toLocaleString(e=w4,n={}){return this.isValid?sa.create(this.loc.clone(n),e).formatDateTime(this):u$}toLocaleParts(e={}){return this.isValid?sa.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:n=!1,suppressMilliseconds:r=!1,includeOffset:i=!0,extendedZone:s=!1,precision:o="milliseconds"}={}){if(!this.isValid)return null;o=ZM(o);const a=e==="extended";let l=f$(this,a,o);return XM.indexOf(o)>=3&&(l+="T"),l+=bee(this,a,n,r,i,s,o),l}toISODate({format:e="extended",precision:n="day"}={}){return this.isValid?f$(this,e==="extended",ZM(n)):null}toISOWeekDate(){return xP(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:n=!1,includeOffset:r=!0,includePrefix:i=!1,extendedZone:s=!1,format:o="extended",precision:a="milliseconds"}={}){return this.isValid?(a=ZM(a),(i&&XM.indexOf(a)>=3?"T":"")+bee(this,o==="extended",n,e,r,s,a)):null}toRFC2822(){return xP(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return xP(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?f$(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:n=!1,includeOffsetSpace:r=!0}={}){let i="HH:mm:ss.SSS";return(n||e)&&(r&&(i+=" "),n?i+="z":e&&(i+="ZZ")),xP(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():u$}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const n={...this.c};return e.includeConfig&&(n.outputCalendar=this.outputCalendar,n.numberingSystem=this.loc.numberingSystem,n.locale=this.loc.locale),n}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,n="milliseconds",r={}){if(!this.isValid||!e.isValid)return dr.invalid("created by diffing an invalid DateTime");const i={locale:this.locale,numberingSystem:this.numberingSystem,...r},s=VFe(n).map(dr.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,c=G9e(a,l,s,i);return o?c.negate():c}diffNow(e="milliseconds",n={}){return this.diff(hn.now(),e,n)}until(e){return this.isValid?Gi.fromDateTimes(this,e):this}hasSame(e,n,r){if(!this.isValid)return!1;const i=e.valueOf(),s=this.setZone(e.zone,{keepLocalTime:!0});return s.startOf(n,r)<=i&&i<=s.endOf(n,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const n=e.base||hn.fromObject({},{zone:this.zone}),r=e.padding?this<n?-e.padding:e.padding:0;let i=["years","months","days","hours","minutes","seconds"],s=e.unit;return Array.isArray(e.unit)&&(i=e.unit,s=void 0),Tee(n,this.plus(r),{...e,numeric:"always",units:i,unit:s})}toRelativeCalendar(e={}){return this.isValid?Tee(e.base||hn.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(hn.isDateTime))throw new Qo("min requires all arguments be DateTimes");return uee(e,n=>n.valueOf(),Math.min)}static max(...e){if(!e.every(hn.isDateTime))throw new Qo("max requires all arguments be DateTimes");return uee(e,n=>n.valueOf(),Math.max)}static fromFormatExplain(e,n,r={}){const{locale:i=null,numberingSystem:s=null}=r,o=Cr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});return vme(o,e,n)}static fromStringExplain(e,n,r={}){return hn.fromFormatExplain(e,n,r)}static buildFormatParser(e,n={}){const{locale:r=null,numberingSystem:i=null}=n,s=Cr.fromOpts({locale:r,numberingSystem:i,defaultToEN:!0});return new yme(s,e)}static fromFormatParser(e,n,r={}){if(Sn(e)||Sn(n))throw new Qo("fromFormatParser requires an input string and a format parser");const{locale:i=null,numberingSystem:s=null}=r,o=Cr.fromOpts({locale:i,numberingSystem:s,defaultToEN:!0});if(!o.equals(n.locale))throw new Qo(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${n.locale}`);const{result:a,zone:l,specificOffset:c,invalidReason:u}=n.explainFromTokens(e);return u?hn.invalid(u):d_(a,l,r,`format ${n.format}`,e,c)}static get DATE_SHORT(){return w4}static get DATE_MED(){return bpe}static get DATE_MED_WITH_WEEKDAY(){return fFe}static get DATE_FULL(){return Epe}static get DATE_HUGE(){return Spe}static get TIME_SIMPLE(){return Tpe}static get TIME_WITH_SECONDS(){return kpe}static get TIME_WITH_SHORT_OFFSET(){return Ape}static get TIME_WITH_LONG_OFFSET(){return Ipe}static get TIME_24_SIMPLE(){return Rpe}static get TIME_24_WITH_SECONDS(){return Ppe}static get TIME_24_WITH_SHORT_OFFSET(){return Mpe}static get TIME_24_WITH_LONG_OFFSET(){return Cpe}static get DATETIME_SHORT(){return Npe}static get DATETIME_SHORT_WITH_SECONDS(){return Ope}static get DATETIME_MED(){return Lpe}static get DATETIME_MED_WITH_SECONDS(){return Dpe}static get DATETIME_MED_WITH_WEEKDAY(){return pFe}static get DATETIME_FULL(){return $pe}static get DATETIME_FULL_WITH_SECONDS(){return jpe}static get DATETIME_HUGE(){return Fpe}static get DATETIME_HUGE_WITH_SECONDS(){return Vpe}}function mE(t){if(hn.isDateTime(t))return t;if(t&&t.valueOf&&mg(t.valueOf()))return hn.fromJSDate(t);if(t&&typeof t=="object")return hn.fromObject(t);throw new Qo(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const l7e="shortOffset";function c7e(t){return"timeZoneIANA"in t}function u7e(t){return t.startsWith("UTC")}function vIt(t,e=!1){return{json:{read:{source:t,reader:(n,r)=>r[t]?h7e(r[t]):null},write:!!e&&{allowNull:!0,writer(n,r){r[t]=n?d7e(n):null}}}}}function h7e(t,e=Ad){return t?c7e(t)?t.timeZoneIANA:f7e(t,e):e}function d7e(t){return{timeZoneIANA:t}}function f7e(t,e=Ad){if(!t||!XQ.has(t.timeZone))return e;const n=XQ.get(t.timeZone);return u7e(t.timeZone)||t.respectsDaylightSaving?n:p7e(n)}function p7e(t){const e=hn.local().setZone(t),n=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return n===0?"Etc/UTC":`Etc/GMT${aa.instance(-n).formatOffset(0,"narrow")}`}function _It(t,e,n,r,i){if(e&&i==="date")return{timeZone:Tk,timeZoneName:void 0};const s=r.hour,o=n===YG;return{timeZone:o?i==="timestamp-offset"?void 0:t??Tk:n,timeZoneName:o&&s?l7e:void 0}}function m7e(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),n=new Set(Intl.supportedValuesOf("timeZone").map(r=>r.toLowerCase()));return t===Ad||t===YG||e.has(t.toLowerCase())||n.has(t.toLowerCase())}const g7e={dateStyle:void 0,year:void 0,month:void 0,day:void 0,weekday:void 0},y7e={timeStyle:void 0,hour12:void 0,hourCycle:void 0,hour:void 0,minute:void 0,second:void 0},bme={timeZone:Tk},Nh={year:"numeric",month:"numeric",day:"numeric"},gE={year:"numeric",month:"long",day:"numeric"},yE={year:"numeric",month:"short",day:"numeric"},vE={year:"numeric",month:"long",weekday:"long",day:"numeric"},Pm={hour:"numeric",minute:"numeric"},B0={...Pm,second:"numeric"},Eme={hourCycle:"h23"},_E={...Pm,...Eme},xE={...B0,...Eme},Sme={"short-date":Nh,"short-date-short-time":{...Nh,...Pm},"short-date-short-time-24":{...Nh,..._E},"short-date-long-time":{...Nh,...B0},"short-date-long-time-24":{...Nh,...xE},"short-date-le":Nh,"short-date-le-short-time":{...Nh,...Pm},"short-date-le-short-time-24":{...Nh,..._E},"short-date-le-long-time":{...Nh,...B0},"short-date-le-long-time-24":{...Nh,...xE},"long-month-day-year":gE,"long-month-day-year-short-time":{...gE,...Pm},"long-month-day-year-short-time-24":{...gE,..._E},"long-month-day-year-long-time":{...gE,...B0},"long-month-day-year-long-time-24":{...gE,...xE},"day-short-month-year":yE,"day-short-month-year-short-time":{...yE,...Pm},"day-short-month-year-short-time-24":{...yE,..._E},"day-short-month-year-long-time":{...yE,...B0},"day-short-month-year-long-time-24":{...yE,...xE},"long-date":vE,"long-date-short-time":{...vE,...Pm},"long-date-short-time-24":{...vE,..._E},"long-date-long-time":{...vE,...B0},"long-date-long-time-24":{...vE,...xE},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Pm,"long-time":B0},v7e=kl()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Tme={ar:"ar-u-nu-latn-ca-gregory",nn:"no-NN"},_7e=new Intl.DateTimeFormat("bs",{month:"long"}).formatToParts(new Date(2025,2)),x7e=_7e.find(({type:t})=>t==="month")?.value.toLowerCase();function kme(){const t=qG();return(t&&Tme[t])??fpe()}x7e!=="mart"&&(Tme.bs="sr-Latn-CS");let HF=new WeakMap;const mO=Sme["short-date-short-time"];function w7e(t){let e=HF.get(t);if(!e){const n=kme(),r=sB(t.timeZone??Ad),i={...t,timeZone:r};e=new Intl.DateTimeFormat(n,i),HF.set(t,e)}return e}function xIt(t){return Sme[t]}function wIt(t){const{dateStyle:e,timeStyle:n,hour12:r,year:i,month:s}=t,o={};return e?o.dateStyle=e:i&&(o.year=i,o.month=s||void 0),n&&!o.year&&(o.timeStyle=n,o.hour12=r==="auto"?void 0:r==="always"),o}function iB(t,e=mO){return w7e(e).format(t)}function bIt(t,e=mO){return iB(new Date(t),{...e,...bme,...y7e})}function EIt(t,e=mO){return iB(new Date(`1970-01-01T${t}Z`),{...e,...bme,...g7e})}function SIt(t,e=mO){if(e.timeZone)return iB(new Date(t),e);const n=hn.fromISO(t,{setZone:!0}),r=n.offset===0?Tk:e.timeZone,i={...e,timeZone:r};return n.toLocaleString(i,{locale:kme()})}function sB(t){switch(t){case Ad:return cFe;case YG:return Tk;default:return t}}KG(()=>{HF=new WeakMap});const b7e={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let JM=new WeakMap,Ame={};function qF(t){const e=t||Ame;if(!JM.has(e)){const n=qG(),r=n&&b7e[n]||fpe();JM.set(e,new Intl.NumberFormat(r,t))}return JM.get(e)}function TIt(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function kIt(t){const{minimumFractionDigits:e,maximumFractionDigits:n,useGrouping:r}=t;return{minimumFractionDigits:e,maximumFractionDigits:n,useGrouping:r==="auto"?"auto":r==="always"}}function AIt(t,e){return Object.is(t,-0)&&(t=0),qF(e).format(t)}function IIt(t,e=eu()){if(!t)return null;let n=Aee.get(e);if(!n){const r=qF().formatToParts(12345.6),i=[...qF({useGrouping:!1}).format(9876543210)].reverse(),s=new Map(i.map((h,f)=>[h,f])),o=new RegExp(`[${r.find(h=>h.type==="group")?.value}]`,"g"),a=new RegExp(`[${r.find(h=>h.type==="decimal")?.value}]`),l=new RegExp(`[${i.join("")}]`,"g"),c=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,u=/[-\u2212\u2013\u2014\u2015]/g;n=h=>{if((h=h.trim().replaceAll(o,"").replace(a,".").replace(l,g=>String(s.get(g))).replaceAll(c,"").replaceAll(u,"-"))==="")return null;const f=Number(h);return isNaN(f)?null:f},Aee.set(e,n)}return n(t)}KG(()=>{JM=new WeakMap,Ame={}});const Aee=new Map;async function E7e(t,e,n,r){const i=e.exec(n);if(!i)throw new Xe("esri-intl:invalid-bundle",`Bundle id "${n}" is not compatible with the pattern "${e}"`);const s=i[1]?`${i[1]}/`:"",o=i[2],a=_pe(r),l=`${s}${o}.json`,c=a?`${s}${o}_${a}.json`:l;let u;try{u=await Iee(t(c))}catch(h){if(c===l)throw new Xe("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:h});try{u=await Iee(t(l))}catch(f){throw new Xe("intl:unknown-bundle",`Bundle "${n}" cannot be loaded`,{error:f})}}return u}async function Iee(t){if(Ree.fetchBundleAsset!=null)return Ree.fetchBundleAsset(t);const e=await Ji(t,{responseType:"text"});return JSON.parse(e.data)}let S7e=class{constructor({base:e="",pattern:n,location:r=new URL(window.location.href)}){let i;i=typeof r=="string"?s=>new URL(s,new URL(r,window.location.href)).href:r instanceof URL?s=>new URL(s,r).href:r,this.pattern=typeof n=="string"?new RegExp(`^${n}`):n,this.getAssetUrl=i,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,n){return E7e(this.getAssetUrl,this.matcher,e,n)}};function T7e(t){return new S7e(t)}const Ree={};sFe(T7e({pattern:"esri/",location:Ui}));let df=class extends Kt{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let n=e==="local"||e==="global"?e:_pe(e??eu())??"global";return n=n==="no"?"nb":n,n}};_([E()],df.prototype,"apiKey",void 0),_([E()],df.prototype,"id",void 0),_([E()],df.prototype,"language",void 0),_([E()],df.prototype,"places",void 0),_([E()],df.prototype,"serviceUrl",void 0),_([E()],df.prototype,"worldview",void 0),df=_([ue("esri.support.BasemapStyle")],df);const k7e=df,Ime=Symbol("BasemapInstance");function MIt(t){return t!=null&&typeof t=="object"&&Ime in t}function dn(t,e,n={}){return oB(t,e,n,Rme)}function hc(t,e,n={}){return oB(t,e,n,Pme)}function oB(t,e,n={},r){let i=null;const s=n.once?(o,a)=>{r(o)&&(Qr(i),e(o,a))}:(o,a)=>{r(o)&&e(o,a)};if(i=M$e(t,s,n.sync,n.equals),n.initial){const o=t();s(o,o)}return i}function $1(t,e,n,r={}){let i=null,s=null,o=null;function a(){i&&s&&(s.remove(),r.onListenerRemove?.(i),i=null,s=null)}function l(u){r.once&&r.once&&Qr(o),n(u)}const c=dn(t,(u,h)=>{a(),X5(u)&&(i=u,s=B2(u,e,l),r.onListenerAdd?.(u))},{sync:r.sync,initial:!0});return o=qn(()=>{c.remove(),a()}),o}function aB(t,e){return A7e(t,Pme,e)}function A7e(t,e,n){if(ha(n))return Promise.reject(Tr());const r=t();if(e?.(r))return Promise.resolve(r);let i=null;function s(){i=Qr(i)}return new Promise((o,a)=>{i=rv([lu(n,()=>{s(),a(Tr())}),oB(t,l=>{s(),o(l)},{sync:!1,once:!0},e??Rme)])})}function Rme(t){return!0}function Pme(t){return!!t}function CIt(t,e,n={}){let r=!1;const i=dn(t,(s,o)=>{r||e(s,o)},n);return{remove(){i.remove()},pause(){r=!0},resume(){r=!1}}}const Dg={sync:!0},fa={initial:!0},ea={sync:!0,initial:!0};let Mme=0;const lB=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Mme++})}};return n=_([ue("esri.core.Identifiable")],n),n},cB=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Mme++})}};return n=_([ue("esri.core.Identifiable.NumericIdentifiable")],n),n};lB(class{});async function I7e(t){const e="portalItem"in t?t:{portalItem:t},{fromItem:n}=await xe(async()=>{const{fromItem:r}=await import("./portalLayers-CtvrwNpE.js");return{fromItem:r}},__vite__mapDeps([92,93,94,95,96,60]));try{return await n(e)}catch(r){const i=e?.portalItem,s=i?.id||"unset",o=i?.portal?.url||Qn.portalUrl;throw St.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+s+"')",r),r}}const Pee={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function p$(t,e,n,r=Ad){const i=new uh(sB(r)),s=hn.fromJSDate(t,{zone:i}),o=n==="decades"||n==="centuries"?"year":Cme(n);return n==="decades"&&(e*=10),n==="centuries"&&(e*=100),s.plus({[o]:e}).toJSDate()}function NIt(t,e,n="milliseconds"){const r=t.getTime(),i=R7e(e,n,"milliseconds");return new Date(r+i)}function Mee(t,e,n=Ad){const r=new uh(sB(n)),i=hn.fromJSDate(t,{zone:r});if(e==="decades"||e==="centuries"){const o=i.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const s=Cme(e);return i.startOf(s).toJSDate()}function R7e(t,e,n){return t===0?0:t*Pee[e]/Pee[n]}function OIt(t,e){return t&&e?t.intersection(e):t||e}function Cme(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Ac,pw;let Ea=(pw=class extends qt{static get allTime(){return Cee}static get empty(){return P7e}static fromArray(e){return new Ac({start:e[0]!=null?new Date(e[0]):e[0],end:e[1]!=null?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,n){return n.end!=null?new Date(n.end):null}writeEnd(e,n){n.end=e?.getTime()??null}get isAllTime(){return this.equals(Ac.allTime)}get isEmpty(){return this.equals(Ac.empty)}readStart(e,n){return n.start!=null?new Date(n.start):null}writeStart(e,n){n.start=e?.getTime()??null}clone(){return new Ac({end:this.end,start:this.start})}equals(e){if(!e)return!1;const n=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,i=e.start?.getTime()??e.start,s=e.end?.getTime()??e.end;return n===i&&r===s}expandTo(e,n=Ad){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=Mee(r,e,n));let i=this.end;if(i){const s=Mee(i,e,n);i=i.getTime()===s.getTime()?s:p$(s,1,e,n)}return new Ac({start:r,end:i})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return Ac.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const n=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,i=e.start?.getTime()??-1/0,s=e.end?.getTime()??1/0;let o,a;return i>=n&&i<=r?o=i:n>=i&&n<=s&&(o=n),r>=i&&r<=s?a=r:s>=n&&s<=r&&(a=s),o==null||a==null||isNaN(o)||isNaN(a)?Ac.empty:new Ac({start:o===-1/0?null:new Date(o),end:a===1/0?null:new Date(a)})}offset(e,n,r=Ad){if(this.isEmpty||this.isAllTime)return this.clone();const i=new Ac,{start:s,end:o}=this;return s!=null&&(i.start=p$(s,e,n,r)),o!=null&&(i.end=p$(o,e,n,r)),i}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return Cee.clone();const n=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new Ac({start:n,end:r})}},Ac=pw,pw);_([E({type:Date,json:{write:{allowNull:!0}}})],Ea.prototype,"end",void 0),_([sr("end")],Ea.prototype,"readEnd",null),_([Xn("end")],Ea.prototype,"writeEnd",null),_([E({readOnly:!0,json:{read:!1}})],Ea.prototype,"isAllTime",null),_([E({readOnly:!0,json:{read:!1}})],Ea.prototype,"isEmpty",null),_([E({type:Date,json:{write:{allowNull:!0}}})],Ea.prototype,"start",void 0),_([sr("start")],Ea.prototype,"readStart",null),_([Xn("start")],Ea.prototype,"writeStart",null),Ea=Ac=_([ue("esri.time.TimeExtent")],Ea);const Cee=new Ea,P7e=new Ea({start:void 0,end:void 0});let M7e=0,gi=class extends rO(lB(rI)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Dn(-180,-90,180,90,Bt.WGS84),this.id=Date.now().toString(16)+"-layer-"+M7e++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Bt.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const n=typeof e=="string"?{url:e}:e;return(await xe(async()=>{const{fromUrl:r}=await import("./arcgisLayers-D892sJnm.js");return{fromUrl:r}},__vite__mapDeps([97,93,94,96]))).fromUrl(n)}static fromPortalItem(e){return I7e(e)}initialize(){this.when().catch(e=>{ya(e)||St.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return this.attributionDataUrl!=null}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return ja(this.url)}createLayerView(e,n){return Promise.reject(new Xe("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Ji(e,{query:{f:"json"},responseType:"json"})).data;throw new Xe("layer:no-attribution-data","Layer does not have attribution data")}};_([E({type:String})],gi.prototype,"attributionDataUrl",void 0),_([E({readOnly:!0})],gi.prototype,"effectiveVisible",null),_([E({type:Dn})],gi.prototype,"fullExtent",void 0),_([E({readOnly:!0})],gi.prototype,"hasAttributionData",null),_([E({type:String,clonable:!1})],gi.prototype,"id",void 0),_([E({type:Boolean,nonNullable:!0})],gi.prototype,"legendEnabled",void 0),_([E({type:["show","hide","hide-children"]})],gi.prototype,"listMode",void 0),_([E({type:Number,range:{min:0,max:1},nonNullable:!0})],gi.prototype,"opacity",void 0),_([E({clonable:!1})],gi.prototype,"parent",void 0),_([E({readOnly:!0})],gi.prototype,"parsedUrl",null),_([E({type:Boolean,readOnly:!0})],gi.prototype,"persistenceEnabled",void 0),_([E({type:Boolean})],gi.prototype,"popupEnabled",void 0),_([E({type:Boolean})],gi.prototype,"attributionVisible",void 0),_([E({type:Bt})],gi.prototype,"spatialReference",void 0),_([E({type:String})],gi.prototype,"title",void 0),_([E({readOnly:!0,json:{read:!1}})],gi.prototype,"type",void 0),_([E()],gi.prototype,"url",void 0),_([E({type:Ea})],gi.prototype,"visibilityTimeExtent",void 0),_([E({type:Boolean,nonNullable:!0})],gi.prototype,"visible",void 0),gi=_([ue("esri.layers.Layer")],gi);const wP=new WeakMap;function Nme(t){return!t.destroyed&&(wP.has(t)||t.addHandles([dn(()=>{const{parent:e}=t;return!!(e&&e instanceof gi)&&(e.type==="catalog-dynamic-group"||Nme(e))},e=>wP.set(t,e),ea),qn(()=>wP.delete(t))]),wP.get(t))}function C7e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function DIt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="graphics"}function N7e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="map-image"}function O7e(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph"&&"layers"in t}function $It(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="knowledge-graph-sublayer"}function Nee(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function j_(t){return t?.type==="subtype-sublayer"}const jIt={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function FIt(t){const e=t?.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function VIt(t){return t.type==="integrated-mesh"||t.type==="integrated-mesh-3dtiles"}function gO(t){return t?.type==="feature"&&!t.url&&t.source?.type==="memory"}function zIt(t){const e=t?.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&t?.source?.type==="feature-layer"}function L7e(t){return t?.type==="feature"&&t.source?.type==="feature-layer"}function UIt(t){return C7e(t)&&L7e(t)}async function GIt(t,e){const n=Kr?.findServerInfo(t);if(n?.currentVersion!=null)return n.owningSystemUrl||null;const r=t.toLowerCase().indexOf("/rest/services");if(r===-1)return null;const i=`${t.slice(0,r)}/rest/info`,s=e!=null?e.signal:null,{data:o}=await Ji(i,{query:{f:"json"},responseType:"json",signal:s});return o?.owningSystemUrl||null}function D7e(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function $7e(t){return D7e(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function j7e(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}function F7e(t){return!!j7e(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}function V7e(t,e){return null}function BIt(t){return null}function z7e(t){return!t||t.type==="Feature Service"&&!t.sourceUrl}function WIt(t,e){!e||!z7e(t)||V7e(t.url)}const U7e=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),G7e=new Set(["integrated-mesh-3dtiles"]),Ome=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","parquet","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),B7e=new Set([...Ome,"link-chart"]);function W7e(t){switch(t.layerContainerType){case"basemap-base-layers":return U7e;case"basemap-ground-layers":return G7e;case"operational-layers":return t.origin==="link-chart"?B7e:Ome;default:return null}}function H7e(t,e){if(e.restrictedWebMapWriting){const n=W7e(e);return n==null||n.has(t.type)&&!gO(t)}return!0}function q7e(t,e){if(e)if(gO(t)){const n=q5("featureCollection.layers",e),r=n?.[0]?.layerDefinition;r&&Oee(t,r)}else t.type!=="group"&&Oee(t,e)}function Oee(t,e){"maxScale"in t&&(e.maxScale=v4(t.maxScale)??void 0),"minScale"in t&&(e.minScale=v4(t.minScale)??void 0)}function K7e(t,e){if(q7e(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=v4(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(gO(t)){const n=e.featureCollection;n&&(n.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function m$(t,e,n){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return n?.messages&&n.messages.push(new Xe("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(gO(t)&&!t.isTable)e=t.resourceInfo;else if(H7e(t,n)){const r={};return t.write(r,n)?r:null}return e!=null&&K7e(t,e=Ze(e)),e}var Lee,F_,i1;let qa=(i1=class extends Xg(rI){constructor(e){super(e),this[Lee]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+F_.idCounter++,this.baseLayers=new Ot,this.referenceLayers=new Ot,this.groundLayers=new Ot;const n=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this,a.type!=="elevation"&&a.type!=="integrated-mesh-3dtiles"||St.getLogger(this).error(`Layer '${a.title}, id:${a.id}' of type '${a.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=a=>{const{parent:l}=a;l&&l!==this&&"remove"in l&&l.remove?.(a),a.parent=this},i=a=>{const l=a.item;return l.parent===this?(St.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' already a ground layer, second add will be ignored.`),void a.preventDefault()):l.type!=="integrated-mesh-3dtiles"&&l.type!=="integrated-mesh"?(St.getLogger(this).error(`Layer '${l.title}, id:${l.id}' of type '${l.type}' is not supported as a ground layer and will therefore be ignored.`),void a.preventDefault()):void 0},s=a=>{a.parent=null},o=a=>{a.parent===this&&(a.parent=null)};this.addHandles([this.baseLayers.on("after-add",a=>n(a.item)),this.baseLayers.on("after-remove",a=>s(a.item)),this.referenceLayers.on("after-add",a=>n(a.item)),this.referenceLayers.on("after-remove",a=>s(a.item)),this.groundLayers.on("before-add",i),this.groundLayers.on("after-add",a=>r(a.item)),this.groundLayers.on("after-remove",a=>o(a.item))])}initialize(){this.when().catch(e=>{St.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const i of e)i.destroyed||i.destroy();const n=this.groundLayers.toArray();for(const i of n)i.destroyed||i.destroy();const r=this.referenceLayers.toArray();for(const i of r)i.destroyed||i.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=Ci(this.portalItem)}removeChildLayer(e){for(const n of[this.baseLayers,this.referenceLayers,this.groundLayers])n.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",fd(e,this._get("baseLayers")))}_writeBaseLayers(e,n,r){const i=[];e&&(r={...r,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(s=>{const o=m$(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&i.push(o)}),this.referenceLayers.forEach(s=>{const o=m$(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&(s.type!=="scene"&&(o.isReference=!0),i.push(o))})),n.baseMapLayers=i}set groundLayers(e){this._set("groundLayers",fd(e,this._get("groundLayers")))}_writeGroundLayers(e,n,r){const i=[];e&&(r={...r,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(s=>{const o=m$(s,r.webmap?r.webmap.getLayerJSONFromResourceInfo(s):null,r);o!=null&&i.push(o)}),i.length>0&&(n.groundLayers=i))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",fd(e,this._get("referenceLayers")))}writeTitle(e,n){n.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Ffe(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(n=>YS(n)?n.clone():n),groundLayers:this.groundLayers.map(n=>YS(n)?n.clone():n),referenceLayers:this.referenceLayers.map(n=>YS(n)?n.clone():n)};return this.loaded&&(e.loadStatus="loaded"),new F_({resourceInfo:this.resourceInfo}).set(e)}read(e,n){this.resourceInfo||this._set("resourceInfo",{data:e,context:n}),super.read(e,n)}write(e,n){return e=e||{},n?.origin||(n={origin:"web-map",...n}),super.write(e,n),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(r=>{const i=Ze(r);return i.url&&Sd(i.url)&&(i.url=`https:${i.url}`),i.templateUrl&&Sd(i.templateUrl)&&(i.templateUrl=`https:${i.templateUrl}`),i})),e}async _loadFromSource(e){const{resourceInfo:n,portalItem:r,style:i}=this;hi(e);const s=[];if(n){const o=n.context?n.context.url:null;if(s.push(this._loadLayersFromJSON(n.data,o,e)),n.data.id&&!n.data.title){const a=n.data.id;s.push(lFe(a).then(l=>{l&&this.read({title:l},n.context)}))}}else r?s.push(this._loadFromItem(r,e)):i&&s.push(this._loadFromStylesService(i,e));await Promise.all(s)}async _loadLayersFromJSON(e,n,r){const i=this.resourceInfo?.context,s=this.portalItem?.portal||i?.portal||null,o=X7e[i?.origin||""]??"web-map",{populateOperationalLayers:a}=await xe(async()=>{const{populateOperationalLayers:c}=await import("./layersCreator-DuwMtlel.js");return{populateOperationalLayers:c}},__vite__mapDeps([98,95,94,93,96,92,60,99])),l=[];if(hi(r),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const c={context:{...i,origin:o,url:n,portal:s,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},u=g=>o==="web-scene"&&g.layerType==="ArcGISSceneServiceLayer"||g.isReference,h=a(this.baseLayers,e.baseMapLayers.filter(g=>!u(g)),c);l.push(h);const f=a(this.referenceLayers,e.baseMapLayers.filter(u),c);l.push(f)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const c={context:{...i,origin:o,url:n,portal:s,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},u=a(this.groundLayers,e.groundLayers,c);l.push(u)}await Promise.allSettled(l)}async _loadFromItem(e,n){const r=await e.load(n),i=await r.fetchData("json",n),s=ja(e.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:Y7e[e.type||""]??"web-map",portal:e.portal||it.getDefault(),url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||it.getDefault(),url:s}),this._loadLayersFromJSON(this.resourceInfo.data,s,n)}async _loadFromStylesService(e,n){const r=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,i=`${r}/styles/${e.id}/self`,s=`${r}/webmaps/${e.id}`,o=e.apiKey??Qn.apiKeys.basemapStyles,[a,l]=await Promise.all([(await Ji(i,{query:{token:o},signal:n?.signal})).data,(await Ji(s,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:n?.signal})).data]);this.thumbnailUrl??=a.thumbnailUrl;const c=ja(s);if(this._set("resourceInfo",{data:l.baseMap??{},context:{origin:"web-map",url:c}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:l.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,c,n),o)for(const u of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in u&&(u.apiKey=o)}static fromId(e){const n=OF[e];return n?n.itemId?new F_({portalItem:{id:n.itemId,portal:{url:"https://www.arcgis.com"}}}):F_.fromJSON(n,n.is3d?{origin:"web-scene",portal:new it({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}},Lee=Ime,F_=i1,i1.idCounter=0,i1);_([E({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,n,r){this._writeBaseLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Ot}},writer(t,e,n,r){this._writeBaseLayers(t,e,r)}}}}}})],qa.prototype,"baseLayers",null),_([E({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(t,e,n,r){this._writeGroundLayers(t,e,r)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:Ot}},writer(t,e,n,r){this._writeGroundLayers(t,e,r)}}}}}})],qa.prototype,"groundLayers",null),_([E({type:String,json:{origins:{"web-scene":{write:!0}}}})],qa.prototype,"id",void 0),_([E({type:vn})],qa.prototype,"portalItem",void 0),_([E()],qa.prototype,"referenceLayers",null),_([E({readOnly:!0})],qa.prototype,"resourceInfo",void 0),_([E({type:Bt})],qa.prototype,"spatialReference",void 0),_([E({type:k7e})],qa.prototype,"style",void 0),_([E()],qa.prototype,"thumbnailUrl",void 0),_([E({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],qa.prototype,"title",void 0),_([Xn("title")],qa.prototype,"writeTitle",null),qa=F_=_([ue("esri.Basemap")],qa);const Y7e={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},X7e={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},eT=qa,Z7e=Object.freeze(Object.defineProperty({__proto__:null,default:eT},Symbol.toStringTag,{value:"Module"})),T4={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function J7e(t){return!!T4[t]||!!T4[t.toLowerCase()]}function Lme(t){return T4[t]??T4[t.toLowerCase()]}function HIt(t){return[...Lme(t)]}function g$(t,e,n){n<0&&++n,n>1&&--n;const r=6*n;return r<1?t+(e-t)*r:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function Q7e(t,e,n,r=1){const i=(t%360+360)%360/360,s=n<=.5?n*(e+1):n+e-n*e,o=2*n-s;return[Math.round(255*g$(o,s,i+1/3)),Math.round(255*g$(o,s,i)),Math.round(255*g$(o,s,i-1/3)),r]}function qIt(t){const e=t.length>5,n=e?8:4,r=(1<<n)-1,i=e?1:17,s=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return s&&(l=o&r,o>>=n,a[3]=i*l/255),l=o&r,o>>=n,a[2]=i*l,l=o&r,o>>=n,a[1]=i*l,l=o&r,o>>=n,a[0]=i*l,a}function Dme(t){if(!t.startsWith("#")||isNaN(+`0x${t.slice(1)}`))return null;switch(t.length){case 4:case 5:{const e=parseInt(t.slice(1,2),16),n=parseInt(t.slice(2,3),16),r=parseInt(t.slice(3,4),16),i=t.length===4?15:parseInt(t.slice(4),16);return[e+16*e,n+16*n,r+16*r,(i+16*i)/255]}case 7:case 9:return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16),(t.length===7?255:parseInt(t.slice(7),16))/255];default:return null}}function $me(t){const e=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(e){const n=e[2].split(/\s*,\s*/),r=e[1];if(r==="rgb"&&n.length===3||r==="rgba"&&n.length===4){if(n[0].endsWith("%")){const i=n.map(s=>2.56*parseFloat(s));return n.length===4&&(i[3]=parseFloat(n[3])),Dee(i)}return Dee(n.map(i=>parseFloat(i)))}if(r==="hsl"&&n.length===3||r==="hsla"&&n.length===4)return Q7e(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3]??"1"))}return null}function Dee(t){return t[0]=Kx(t[0]),t[1]=Kx(t[1]),t[2]=Kx(t[2]),t[3]=t.length===4?Fme(t[3]):1,t}function jme(t){let e=J7e(t)?Lme(t):null;return e??=$me(t),e??=Dme(t),e}function KIt(t){const e=jme(t);return e!=null?[e[0]/255,e[1]/255,e[2]/255,e[3]]:null}function Fme(t){return Vme(t,0,1)}function Kx(t){return Math.round(Vme(t,0,255))}function Vme(t,e,n){return t=Number(t),isNaN(t)?n:t<e?e:t>n?n:t}const zme=2.2,eVe=1/zme;function YIt(t){return t**zme}function XIt(t){return t**eVe}const $ee=new Float32Array(1);function ZIt(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function cu(t,e,n){return Math.min(Math.max(t,e),n)}function JIt(t){return!(t&t-1)}function QIt(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function eS(t,e,n){return t+(e-t)*n}function eRt(t,e,n,r,i){return eS(r,i,(t-e)/(n-e))}function cI(t){return t*Math.PI/180}function Ume(t){return 180*t/Math.PI}function tRt(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function nRt(t){return Math.acos(cu(t,-1,1))}function tVe(t){return Math.asin(cu(t,-1,1))}function gg(t,e,n=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=n}function rRt(t,e,n=1e-6){return!gg(t,e,n)&&t>e}function iRt(t,e,n=1e-6){return!gg(t,e,n)&&t<e}function sRt(t,e,n=1e-6){return gg(t,e,n)||t>e}const k4=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function KF(t){return k4.setFloat64(0,t),k4.getBigInt64(0)}function nVe(t){return k4.setBigInt64(0,t),k4.getFloat64(0)}const QM=1000000n,rVe=Gme(1);function Gme(t){const e=KF(t=Math.abs(t)),n=nVe(e<=QM?QM:e-QM);return Math.abs(t-n)}function oRt(t,e,n=rVe){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(n!=null&&Gme(Math.min(Math.abs(t),Math.abs(e)))<n)return Math.abs(t-e)<=n;const r=KF(t),i=KF(e);return r<0!=i<0?!1:!((r<i?i-r:r-i)>QM)}function Bme(t,e,n=1e-6){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;const r=Math.abs(t-e),i=Math.abs(t),s=Math.abs(e);if(t===0||e===0||i<1e-12&&s<1e-12){if(r>.01*n)return!1}else if(r/(i+s)>n)return!1;return!0}function aRt(t){return Wme(Math.max(-jee,Math.min(t,jee)))}function Wme(t){return $ee[0]=t,$ee[0]}function lRt(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],r=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(gg(e,1)&&gg(n,1)&&gg(r,1))}function cRt(t,e){return(t%e+e)%e}const jee=Wme(34028234663852886e22);function uRt(t,e,n){if(n===void 0||+n==0)return Math[t](e);if(e=+e,n=+n,isNaN(e)||typeof n!="number"||n%1!=0)return NaN;let r=e.toString().split("e");return r=(e=Math[t](+(r[0]+"e"+(r[1]?+r[1]-n:-n)))).toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+n:n))}function bP(t){return cu(RG(t),0,255)}function EP(t,e){const n=t.toString(16).padStart(2,"0");return e?n.slice(0,1):n}let Kn=class Ic{static blendColors(e,n,r,i=new Ic){return i.r=Math.round(e.r+(n.r-e.r)*r),i.g=Math.round(e.g+(n.g-e.g)*r),i.b=Math.round(e.b+(n.b-e.b)*r),i.a=e.a+(n.a-e.a)*r,i._sanitize()}static fromRgb(e,n){const r=$me(e);return r?Ic.fromArray(r,n):null}static fromHex(e,n=new Ic){const r=Dme(e);return r?Ic.fromArray(r,n):null}static fromArray(e,n=new Ic){return n._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(n.a)&&(n.a=1),n._sanitize()}static fromString(e,n){const r=jme(e);return r?Ic.fromArray(r,n):null}static fromJSON(e){return e!=null?new Ic([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e,n){return e==null?null:(n??=[0,0,0,0],n[0]=e.r/255,n[1]=e.g/255,n[2]=e.b/255,n[3]=e.a!=null?e.a:1,n)}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Ic.fromString(e,this):Array.isArray(e)?Ic.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Ic||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const n=e?.capitalize??!1,r=e?.digits??6,i=r===3||r===4,s=r===4||r===8,o=`#${EP(this.r,i)}${EP(this.g,i)}${EP(this.b,i)}${s?EP(Math.round(255*this.a),i):""}`;return n?o.toUpperCase():o}toCss(e=!1){const n=this.r+", "+this.g+", "+this.b;return e?`rgba(${n}, ${this.a})`:`rgb(${n})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=0){const n=bP(this.r),r=bP(this.g),i=bP(this.b);return e===0||this.a!==1?[n,r,i,bP(255*this.a)]:[n,r,i]}clone(){return new Ic(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Kx(this.r),this.g=Kx(this.g),this.b=Kx(this.b),this.a=Fme(this.a),this}_set(e,n,r,i){this.r=e,this.g=n,this.b=r,this.a=i}};Kn.prototype.declaredClass="esri.Color";let Hu=class extends Ot{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(x$e(()=>this._refresh(),Dg))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections?.();if(e==null)return void this.removeAll();let n=0;for(const r of e)r!=null&&(n=this._processCollection(n,r));this.splice(n)}_createNewInstance(e){return new Ot(e)}_processCollection(e,n){if(!n)return e;const r=this.itemFilterFunction??(i=>!!i);for(const i of n)if(i){if(r(i)){const s=this.indexOf(i,e);s>=0?s!==e&&this.reorder(i,e):this.add(i,e),++e}if(this.getChildrenFunction){const s=this.getChildrenFunction(i);if(Array.isArray(s))for(const o of s)e=this._processCollection(e,o);else e=this._processCollection(e,s)}}return e}};_([E()],Hu.prototype,"getCollections",void 0),_([E()],Hu.prototype,"getChildrenFunction",void 0),_([E()],Hu.prototype,"itemFilterFunction",void 0),Hu=_([ue("esri.core.CollectionFlattener")],Hu);function pn(t,e={}){const n=t instanceof Gs?t:new Gs(t,e),{alwaysWriteDefaults:r,default:i,ignoreUnknown:s=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return E({type:s?n.apiValues:String,json:{type:n.jsonValues,default:i,name:o,read:!l&&{reader:n.read},write:{writer:n.write,alwaysWriteDefaults:r}},nonNullable:a,readOnly:l})}var YF;let eC=YF=class extends qt{constructor(t){super(t),this.type="none"}clone(){return new YF({type:this.type})}};_([pn({none:"none",stayAbove:"stay-above"}),E({json:{write:{isRequired:!0}}})],eC.prototype,"type",void 0),eC=YF=_([ue("esri.ground.NavigationConstraint")],eC);const Hme=Symbol("GroundInstance");function dRt(t){return t!=null&&typeof t=="object"&&Hme in t}function qme(t){const e=RG(100*(1-t));return Math.max(0,Math.min(e,100))}function Kme(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}var Fee,XF,Poe;let Rc=XF=(Poe=class extends Xg(rI){constructor(t){super(t),this[Fee]=!0,this.parent=null,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Ot;const e=r=>{const{parent:i}=r;i&&i!==this&&"remove"in i&&i.remove?.(r),r.parent=this,r.type!=="elevation"&&r.type!=="base-elevation"&&St.getLogger(this).error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},n=r=>{r.parent=null};this.addHandles([this.layers.on("after-add",r=>e(r.item)),this.layers.on("after-remove",r=>n(r.item))]),this.allLayers=new Hu({getCollections:()=>[this.layers,this.parent?.basemap?.groundLayers]})}removeChildLayer(t){this.layers.remove(t)}initialize(){this.when().catch(t=>{ya(t)||St.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}get integratedMeshGround(){const t=this.parent?.basemap?.groundLayers.at(0);return t?.replacesTerrain?t:null}destroy(){const t=this.layers.removeAll();for(const e of t)Ci(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get loaded(){return super.loaded}get layers(){return this._get("layers")}set layers(t){this._set("layers",fd(t,this._get("layers")))}writeLayers(t,e,n,r){const i=[];t&&(r={...r,layerContainerType:"ground"},t.forEach(s=>{if("write"in s){const o={};KLe(s)().write(o,r)&&i.push(o)}else r?.messages&&r.messages.push(new Xe("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=i}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return Ffe(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e?.signal});const{queryAll:n}=await xe(()=>import("./ElevationQuery-VdhXhyJu.js"),__vite__mapDeps([100,101]));return hi(e),n(this.layers.filter(Vee).toArray(),t,e)}async createElevationSampler(t,e){await this.load({signal:e?.signal});const{createSampler:n}=await xe(()=>import("./ElevationQuery-VdhXhyJu.js"),__vite__mapDeps([100,101]));return hi(e),n(this.layers.filter(Vee).toArray(),t,e)}clone(){const t={opacity:this.opacity,surfaceColor:Ze(this.surfaceColor),navigationConstraint:Ze(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new XF({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,n){const r=e?.origin||"web-scene",i=e?.portal||null,s=e?.url||null,{populateOperationalLayers:o}=await xe(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-DuwMtlel.js");return{populateOperationalLayers:l}},__vite__mapDeps([98,95,94,93,96,92,60,99]));hi(n);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:r,url:s,portal:i,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}},Fee=Hme,Poe);function Vee(t){return t&&"createElevationSampler"in t}_([E()],Rc.prototype,"parent",void 0),_([E()],Rc.prototype,"integratedMeshGround",null),_([E({json:{read:!1,write:{isRequired:!0}}})],Rc.prototype,"layers",null),_([E()],Rc.prototype,"allLayers",void 0),_([Xn("layers")],Rc.prototype,"writeLayers",null),_([E({readOnly:!0})],Rc.prototype,"resourceInfo",void 0),_([E({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Or,read:{reader:Kme,source:"transparency"},write:{writer:(t,e)=>{e.transparency=qme(t)},target:"transparency"}}})],Rc.prototype,"opacity",void 0),_([E({type:Kn,json:{type:[Or],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],Rc.prototype,"surfaceColor",void 0),_([E({type:eC,json:{write:!0}})],Rc.prototype,"navigationConstraint",void 0),Rc=XF=_([ue("esri.Ground")],Rc);const A4=Rc,iVe=Symbol("ClonableMixin"),ho=t=>{var i;var e;const n=t;let r=(i=class extends n{constructor(){super(...arguments),this[e]=!0}clone(s){const o=Mg(this);Cde(o,"unable to clone instance of non-accessor class");const a=o.metadata,l=o.store,c={},u=new Map;for(const f in a){const g=a[f],v=l?.originOf(f),x=g.clonable;if(g.readOnly||x===!1||v!==7&&v!==0&&v!==5&&v!==4)continue;const b=this[f];let T=null;if(typeof x=="function")T=x(b,s);else if(x==="reference")T=b;else if(T=nF(b,s),b!=null&&T==null)continue;v===0?u.set(f,T):c[f]=T}const h=new(Object.getPrototypeOf(this)).constructor(c);if(u.size){const f=Mg(h)?.store;if(f)for(const[g,v]of u)f.set(g,v,0)}return h}},e=iVe,i);return r=_([ue("esri.core.Clonable")],r),r},uB=ho(Kt),sVe="randomUUID"in crypto;function uI(){if(sVe)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=n=>t[n].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function fRt(){return`{${uI().toUpperCase()}}`}function pRt(){return`{${uI()}}`}function mRt(t){const e=t.toUpperCase();return t.startsWith("{")?e:`{${e}}`}const f_={Base64:0,Hex:1,String:2,Raw:3},Yx=8,Yme=(1<<Yx)-1;function Ym(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function oVe(t){const e=[];for(let n=0,r=t.length*Yx;n<r;n+=Yx)e[n>>5]|=(t.charCodeAt(n/Yx)&Yme)<<n%32;return e}function aVe(t){const e=[];for(let n=0,r=32*t.length;n<r;n+=Yx)e.push(String.fromCharCode(t[n>>5]>>>n%32&Yme));return e.join("")}function lVe(t){const e="0123456789abcdef",n=[];for(let r=0,i=4*t.length;r<i;r++)n.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return n.join("")}function cVe(t){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let i=0,s=4*t.length;i<s;i+=3){const o=(t[i>>2]>>i%4*8&255)<<16|(t[i+1>>2]>>(i+1)%4*8&255)<<8|t[i+2>>2]>>(i+2)%4*8&255;for(let a=0;a<4;a++)8*i+6*a>32*t.length?r.push("="):r.push(n.charAt(o>>6*(3-a)&63))}return r.join("")}function uVe(t,e){return t<<e|t>>>32-e}function yO(t,e,n,r,i,s){return Ym(uVe(Ym(Ym(e,t),Ym(r,s)),i),n)}function zo(t,e,n,r,i,s,o){return yO(e&n|~e&r,t,e,i,s,o)}function Uo(t,e,n,r,i,s,o){return yO(e&r|n&~r,t,e,i,s,o)}function Go(t,e,n,r,i,s,o){return yO(e^n^r,t,e,i,s,o)}function Bo(t,e,n,r,i,s,o){return yO(n^(e|~r),t,e,i,s,o)}function hVe(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const a=n,l=r,c=i,u=s;n=zo(n,r,i,s,t[o],7,-680876936),s=zo(s,n,r,i,t[o+1],12,-389564586),i=zo(i,s,n,r,t[o+2],17,606105819),r=zo(r,i,s,n,t[o+3],22,-1044525330),n=zo(n,r,i,s,t[o+4],7,-176418897),s=zo(s,n,r,i,t[o+5],12,1200080426),i=zo(i,s,n,r,t[o+6],17,-1473231341),r=zo(r,i,s,n,t[o+7],22,-45705983),n=zo(n,r,i,s,t[o+8],7,1770035416),s=zo(s,n,r,i,t[o+9],12,-1958414417),i=zo(i,s,n,r,t[o+10],17,-42063),r=zo(r,i,s,n,t[o+11],22,-1990404162),n=zo(n,r,i,s,t[o+12],7,1804603682),s=zo(s,n,r,i,t[o+13],12,-40341101),i=zo(i,s,n,r,t[o+14],17,-1502002290),r=zo(r,i,s,n,t[o+15],22,1236535329),n=Uo(n,r,i,s,t[o+1],5,-165796510),s=Uo(s,n,r,i,t[o+6],9,-1069501632),i=Uo(i,s,n,r,t[o+11],14,643717713),r=Uo(r,i,s,n,t[o],20,-373897302),n=Uo(n,r,i,s,t[o+5],5,-701558691),s=Uo(s,n,r,i,t[o+10],9,38016083),i=Uo(i,s,n,r,t[o+15],14,-660478335),r=Uo(r,i,s,n,t[o+4],20,-405537848),n=Uo(n,r,i,s,t[o+9],5,568446438),s=Uo(s,n,r,i,t[o+14],9,-1019803690),i=Uo(i,s,n,r,t[o+3],14,-187363961),r=Uo(r,i,s,n,t[o+8],20,1163531501),n=Uo(n,r,i,s,t[o+13],5,-1444681467),s=Uo(s,n,r,i,t[o+2],9,-51403784),i=Uo(i,s,n,r,t[o+7],14,1735328473),r=Uo(r,i,s,n,t[o+12],20,-1926607734),n=Go(n,r,i,s,t[o+5],4,-378558),s=Go(s,n,r,i,t[o+8],11,-2022574463),i=Go(i,s,n,r,t[o+11],16,1839030562),r=Go(r,i,s,n,t[o+14],23,-35309556),n=Go(n,r,i,s,t[o+1],4,-1530992060),s=Go(s,n,r,i,t[o+4],11,1272893353),i=Go(i,s,n,r,t[o+7],16,-155497632),r=Go(r,i,s,n,t[o+10],23,-1094730640),n=Go(n,r,i,s,t[o+13],4,681279174),s=Go(s,n,r,i,t[o],11,-358537222),i=Go(i,s,n,r,t[o+3],16,-722521979),r=Go(r,i,s,n,t[o+6],23,76029189),n=Go(n,r,i,s,t[o+9],4,-640364487),s=Go(s,n,r,i,t[o+12],11,-421815835),i=Go(i,s,n,r,t[o+15],16,530742520),r=Go(r,i,s,n,t[o+2],23,-995338651),n=Bo(n,r,i,s,t[o],6,-198630844),s=Bo(s,n,r,i,t[o+7],10,1126891415),i=Bo(i,s,n,r,t[o+14],15,-1416354905),r=Bo(r,i,s,n,t[o+5],21,-57434055),n=Bo(n,r,i,s,t[o+12],6,1700485571),s=Bo(s,n,r,i,t[o+3],10,-1894986606),i=Bo(i,s,n,r,t[o+10],15,-1051523),r=Bo(r,i,s,n,t[o+1],21,-2054922799),n=Bo(n,r,i,s,t[o+8],6,1873313359),s=Bo(s,n,r,i,t[o+15],10,-30611744),i=Bo(i,s,n,r,t[o+6],15,-1560198380),r=Bo(r,i,s,n,t[o+13],21,1309151649),n=Bo(n,r,i,s,t[o+4],6,-145523070),s=Bo(s,n,r,i,t[o+11],10,-1120210379),i=Bo(i,s,n,r,t[o+2],15,718787259),r=Bo(r,i,s,n,t[o+9],21,-343485551),n=Ym(n,a),r=Ym(r,l),i=Ym(i,c),s=Ym(s,u)}return[n,r,i,s]}function dVe(t,e=f_.Hex){const n=e||f_.Base64,r=hVe(oVe(t),t.length*Yx);switch(n){case f_.Raw:return r;case f_.Hex:return lVe(r);case f_.String:return aVe(r);case f_.Base64:return cVe(r)}}function fVe(t){return t&&"getAtOrigin"in t&&"originOf"in t}function ZF(t){return hB[pVe(t)]||gVe}function pVe(t){return t.type==="json"?"application/json":t.type==="blob"?t.blob.type:mVe(t.url)}function mVe(t){const e=Tde(t);return JF[e]||Xme}const hB={},Xme="text/plain",gVe=hB[Xme],JF={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in JF)hB[JF[t]]=t;function yVe(t){const e=t?.origins??[void 0];return(n,r)=>{const i=vVe(t,n,r);for(const s of e){const o=MG(n,s,r);for(const a in i)o[a]=i[a]}}}function vVe(t,e,n){if(t?.type==="resource")return _Ve(t,e,n);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:r,write:i}=n6e;return{read:r,write:i}}}}function _Ve(t,e,n){const r=eI(e,n);return{type:String,read:(i,s,o)=>{const a=Z5(i,s,o);return r.type===String?a:typeof r.type=="function"?new r.type({url:a}):void 0},write:{isRequired:r.json?.write?.isRequired,writer(i,s,o,a){if(!a?.resources)return typeof i=="string"?void(s[o]=n2(i,a)):void(s[o]=i.write({},a));const l=bVe(i),c=n2(l,{...a,verifyItemRelativeUrls:a?.verifyItemRelativeUrls?{writtenUrls:a.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1),u=r.type!==String&&(!fVe(this)||a?.origin&&this.originIdOf(n)>TG(a.origin)),h={object:this,propertyName:n,value:i,targetUrl:c,dest:s,targetPropertyName:o,context:a,params:t};a?.portalItem&&c&&!yl(c)?u&&t?.contentAddressed?QF(h):u?xVe(h):wVe(h):a?.portalItem&&(c==null||Lde(c)!=null||YA(c)||u)?QF(h):s[o]=c}}}}function QF(t){const{targetUrl:e,params:n,value:r,context:i,dest:s,targetPropertyName:o}=t;if(!i.portalItem)return;const a=Dde(e),l=Jme(r,e,i);if(n?.contentAddressed&&l.type!=="json")return void i.messages?.push(new Xe("persistable:contentAddressingUnsupported",`Property "${o}" is trying to serializing a resource with content of type ${l.type} with content addressing. Content addressing is only supported for json resources.`,{content:l}));const c=n?.contentAddressed&&l.type==="json"?dVe(l.jsonString):a?.filename??uI(),u=KA(n?.prefix??a?.prefix,c),h=`${u}.${ZF(l)}`;if(n?.contentAddressed&&i.resources&&l.type==="json"){const v=i.resources.toKeep.find(({resource:x})=>x.path===h)??i.resources.toAdd.find(({resource:x})=>x.path===h);if(v)return void(s[o]=v.resource.itemRelativeUrl)}const f=i.portalItem.resourceFromPath(h);YA(e)&&i.resources&&i.resources.pendingOperations.push(RDe(e).then(v=>{f.path=`${u}.${ZF({type:"blob",blob:v})}`,s[o]=f.itemRelativeUrl}).catch(()=>{}));const g=n?.compress??!1;i.resources&&Zme({...t,resource:f,content:l,compress:g,updates:i.resources.toAdd}),s[o]=f.itemRelativeUrl}function xVe(t){const{context:e,targetUrl:n,params:r,value:i,dest:s,targetPropertyName:o}=t;if(!e.portalItem)return;const a=e.portalItem.resourceFromPath(n),l=Jme(i,n,e),c=ZF(l),u=Tde(a.path),h=r?.compress??!1;c===u?(e.resources&&Zme({...t,resource:a,content:l,compress:h,updates:e.resources.toUpdate}),s[o]=n):QF(t)}function wVe({context:t,targetUrl:e,dest:n,targetPropertyName:r}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),n[r]=e)}function Zme({object:t,propertyName:e,updates:n,resource:r,content:i,compress:s}){const o=a=>{EVe(t,e,a)};n.push({resource:r,content:i,compress:s,finish:o})}function Jme(t,e,n){return typeof t=="string"?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(n))}}function bVe(t){return t==null?null:typeof t=="string"?t:t.url}function EVe(t,e,n){typeof t[e]=="string"?t[e]=n.url:t[e].url=n.url}let tC=class extends ho(qt){constructor(e){super(e),this.color=null}};_([E({type:Kn,json:{type:[Or],write:!0}})],tC.prototype,"color",void 0),tC=_([ue("esri.effects.FocusAreaOutline")],tC);const SVe=tC;function yRt(t){const e=[];for(t.reset();t.nextPath();){const n=[];for(;t.nextPoint();)n.push([t.x,t.y]);e.push(n)}return t.reset(),e}function TVe(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}function vRt(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,n=t.hasM;if(t.type==="point")return n&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:n?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.map(r=>[r]);if(t.type==="extent"){const r=t.clone().normalize();if(!r)return null;let i=!1,s=!1;return r.forEach(o=>{o.hasZ&&(i=!0),o.hasM&&(s=!0)}),r.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(s&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a})}return null}function vO(t,e){const n=e[0]-t[0],r=e[1]-t[1];if(t.length>2&&e.length>2){const i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}return Math.sqrt(n*n+r*r)}function Qme(t,e,n){const r=t[0]+n*(e[0]-t[0]),i=t[1]+n*(e[1]-t[1]);return t.length>2&&e.length>2?[r,i,t[2]+n*(e[2]-t[2])]:[r,i]}function kVe(t,e,n,r){return AVe(t,e,n[r],n[r+1])}function AVe(t,e,n,r){const[i,s]=e,[o,a]=n,[l,c]=r,u=l-o,h=c-a,f=u*u+h*h,g=(i-o)*u+(s-a)*h,v=Math.min(1,Math.max(0,g/f));return t[0]=o+u*v,t[1]=a+h*v,t}function _Rt(t,e,n,r,i,s){let o=n,a=r,l=i-o,c=s-a;if(l!==0||c!==0){const u=((t-o)*l+(e-a)*c)/(l*l+c*c);u>1?(o=i,a=s):u>0&&(o+=l*u,a+=c*u)}return l=t-o,c=e-a,l*l+c*c}function ege(t,e){return Qme(t,e,.5)}function xRt(t){const e=t.length;let n=0;for(let r=0;r<e-1;++r)n+=vO(t[r],t[r+1]);return n}function wRt(t,e){if(e<=0)return t[0];const n=t.length;let r=0;for(let i=0;i<n-1;++i){const s=vO(t[i],t[i+1]);if(e-r<s){const o=(e-r)/s;return Qme(t[i],t[i+1],o)}r+=s}return t[n-1]}function tge(t,e=0,n=1){let r=0;const i=t.length;let s=t[0];for(let o=1;o<i;o++){const a=t[o];r+=(a[e]-s[e])*(a[n]+s[n]),s=a}if(nge(t)){const o=t[0];r+=(o[e]-s[e])*(o[n]+s[n])}return r>=0}function nge(t){const e=t.length;return e>0&&!B5(t[0],t[e-1])}function bRt(t){"rings"in t&&(IVe(t),RVe(t))}function IVe(t){if("rings"in t)for(const e of t.rings)nge(e)&&e.push(e[0].slice())}function RVe(t){if(!("rings"in t)||t.rings.length===0||tge(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function ERt(t){return t.type!=="polygon"&&t.type!=="polyline"||PVe(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function PVe(t,e){const n=La(e);if(!n)return;const r=n.valid[0],i=n.valid[1],s=i-r;for(const o of t){let a=1/0,l=-1/0;for(const u of o){const h=MVe(u[0],r,i);a=Math.min(a,h),l=Math.max(l,h),u[0]=h}const c=l-a;s-c<c&&o.forEach(u=>{u[0]<0&&(u[0]+=s)})}}function MVe(t,e,n){const r=n-e;return t<e?n-(e-t)%r:t>n?e+(t-e)%r:t}function SRt(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[n,r]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return n.length===r.length&&n.every((i,s)=>i.length===r[s].length)}function TRt(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function CVe(t){return OVe(t.rings,t.hasZ??!1)}function NVe(t){const e=CVe(t);if(!e)return null;const{hasZ:n,spatialReference:r}=t,[i,s,o]=e;return isNaN(i)||isNaN(s)||n&&isNaN(o)?null:{x:i,y:s,z:n?o:void 0,spatialReference:r}}function OVe(t,e){if(!t?.length)return null;const n=[],r=[],i=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=t.length;s<o;s++){const a=rge(t[s],e,i);a&&r.push(a)}if(r.sort((s,o)=>{let a=s[2]-o[2];return a===0&&e&&(a=s[4]-o[4]),a}),r.length&&(n[0]=r[0][0],n[1]=r[0][1],e&&(n[2]=r[0][3]),(n[0]<i[0]||n[0]>i[1]||n[1]<i[2]||n[1]>i[3]||e&&(n[2]<i[4]||n[2]>i[5]))&&(n.length=0)),!n.length){const s=t[0]&&t[0].length?LVe(t[0],e):null;if(!s)return null;n[0]=s[0],n[1]=s[1],e&&s.length>2&&(n[2]=s[2])}return n}function rge(t,e,n){let r=0,i=0,s=0,o=0,a=0;const l=t.length?t[0][0]:0,c=t.length?t[0][1]:0,u=t.length&&e?t[0][2]:0;for(let f=0;f<t.length;f++){const g=t[f],v=t[(f+1)%t.length],[x,b,T]=g,A=x-l,I=b-c,[R,C,V]=v,M=R-l,N=C-c,O=A*N-M*I;if(o+=O,r+=(A+M)*O,i+=(I+N)*O,e&&g.length>2&&v.length>2){const F=T-u,L=V-u,B=A*L-M*F;s+=(F+L)*B,a+=B}x<n[0]&&(n[0]=x),x>n[1]&&(n[1]=x),b<n[2]&&(n[2]=b),b>n[3]&&(n[3]=b),e&&(T<n[4]&&(n[4]=T),T>n[5]&&(n[5]=T))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[r/(6*o)+l,i/(6*o)+c,o];return e&&(n[4]===n[5]||a===0?(h[3]=(n[4]+n[5])/2,h[4]=0):(h[3]=s/(6*a)+u,h[4]=a)),h}function kRt(t,e){let n=0,r=0,i=0;t.nextPoint();const s=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const c=[t.x,t.y],[u,h]=l,f=u-s,g=h-o,[v,x]=c,b=v-s,T=x-o,A=f*T-b*g;i+=A,n+=(f+b)*A,r+=(g+T)*A,u<e[0]&&(e[0]=u),u>e[1]&&(e[1]=u),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}return i>0&&(i*=-1),i?(i*=.5,[n/(6*i)+s,r/(6*i)+o,i]):null}function LVe(t,e){const n=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let i=0,s=0,o=0,a=0;for(let l=0,c=t.length;l<c-1;l++){const u=t[l],h=t[l+1];if(u&&h){n[0]=u[0],n[1]=u[1],r[0]=h[0],r[1]=h[1],e&&u.length>2&&h.length>2&&(n[2]=u[2],r[2]=h[2]);const f=vO(n,r);if(f){i+=f;const g=ege(u,h);s+=f*g[0],o+=f*g[1],e&&g.length>2&&(a+=f*g[2])}}}return i>0?e?[s/i,o/i,a/i]:[s/i,o/i]:t.length?t[0]:null}function DVe(t){const{hasZ:e,totalSize:n}=t;if(n===0)return null;const r=[],i=[],s=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=rge(TVe(t),t.hasZ,s);o&&i.push(o)}if(i.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],e&&(r[2]=i[0][3]),(r[0]<s[0]||r[0]>s[1]||r[1]<s[2]||r[1]>s[3]||e&&(r[2]<s[4]||r[2]>s[5]))&&(r.length=0)),!r.length){t.reset(),t.nextPath();const o=t.pathSize?$Ve(t):null;if(!o)return null;r[0]=o[0],r[1]=o[1],e&&o.length>2&&(r[2]=o[2])}return r}function $Ve(t){const{hasZ:e}=t,n=e?[0,0,0]:[0,0],r=e?[0,0,0]:[0,0];let i=0,s=0,o=0,a=0;if(t.nextPoint()){let l=t.x,c=t.y,u=t.z;for(;t.nextPoint();){const h=t.x,f=t.y,g=t.z;n[0]=l,n[1]=c,r[0]=h,r[1]=f,e&&(n[2]=u,r[2]=g);const v=vO(n,r);if(v){i+=v;const x=ege(n,r);s+=v*x[0],o+=v*x[1],e&&x.length>2&&(a+=v*x[2])}l=h,c=f,u=g}}return i>0?e?[s/i,o/i,a/i]:[s/i,o/i]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const jVe=1e-6;function ARt(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<jVe){const i=DVe(t);return i?[i[0],i[1]]:null}const n=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)VVe(n,r,t);return n[0]*=1/e,n[1]*=1/e,n[0]+=r[0],n[1]+=r[1],n}const FVe=1/3;function VVe(t,e,n){if(!t||!n||n.pathSize<3)return null;n.nextPoint();const r=n.x,i=n.y;n.nextPoint();let s,o=n.x-r,a=n.y-i,l=0,c=0;for(;n.nextPoint();)l=n.x-r,c=n.y-i,s=.5*FVe*(l*a-c*o),t[0]+=s*(o+l),t[1]+=s*(a+c),o=l,a=c;const u=n.getCurrentRingArea(),h=[r,i];return h[0]-=e[0],h[1]-=e[1],h[0]*=u,h[1]*=u,t[0]+=h[0],t[1]+=h[1],t}function pl(t=HVe){return[t[0],t[1],t[2],t[3]]}function ige(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function zVe(t,e,n,r,i=pl()){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function IRt(t,e=pl()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function UVe(t,e,n=new Dn){return n.xmin=t[0],n.ymin=t[1],n.xmax=t[2],n.ymax=t[3],n.spatialReference=e,n}function Wc(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function GVe(t,e){e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e)}function BVe(t,e){e<t[1]&&(t[1]=e),e>t[3]&&(t[3]=e)}function RRt(t,e,n){if(e!=null)if("length"in e)t9(e)?(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.max(t[2],e[0]),n[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":n[0]=Math.min(t[0],e.xmin),n[1]=Math.min(t[1],e.ymin),n[2]=Math.max(t[2],e.xmax),n[3]=Math.max(t[3],e.ymax);break;case"point":n[0]=Math.min(t[0],e.x),n[1]=Math.min(t[1],e.y),n[2]=Math.max(t[2],e.x),n[3]=Math.max(t[3],e.y)}else ige(n,t)}function PRt(t,e,n=t){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3];for(let l=0;l<r;l++){const c=e[l];i=Math.min(i,c[0]),s=Math.min(s,c[1]),o=Math.max(o,c[0]),a=Math.max(a,c[1])}return n[0]=i,n[1]=s,n[2]=o,n[3]=a,n}function MRt(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function dB(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function fB(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function CRt(t){return dB(t)*fB(t)}function NRt(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function ORt(t){const e=dB(t),n=fB(t);return Math.sqrt(e*e+n*n)}function LRt(t,e){return!!t&&e9(t,e.x,e.y)}function e9(t,e,n){return e>=t[0]&&n>=t[1]&&e<=t[2]&&n<=t[3]}function DRt(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function $Rt(t,e,n){return Math.max(e[0],t[0])-n<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-n<=Math.min(e[3],t[3])}function WVe(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function jRt(t,e,n,r){return r??=t,r[0]=t[0]+e,r[1]=t[1]+n,r[2]=t[2]+e,r[3]=t[3]+n,r}function FRt(t){return t?ige(t,zee):pl(zee)}function t9(t){return t!=null&&t.length===4}function VRt(t,e){return t9(t)&&t9(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const zee=[1/0,1/0,-1/0,-1/0],HVe=[0,0,0,0];let pB=1e-6;function vl(){return pB}function qVe(t){pB=t}const mB=Math.random,KVe=Math.PI/180,YVe=180/Math.PI;function gB(t){return t*KVe}function XVe(t){return t*YVe}function ZVe(t,e){return Math.abs(t-e)<=pB*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:mB,equals:ZVe,getEpsilon:vl,setEpsilon:qVe,toDegree:XVe,toRadian:gB},Symbol.toStringTag,{value:"Module"}));function Xx(t,e){return t[0]=e[0],t[1]=e[1],t}function to(t,e,n){return t[0]=e,t[1]=n,t}function sge(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ak(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function oge(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function age(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function JVe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function QVe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function eze(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function tze(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function nze(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function hI(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function rze(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function _O(t,e){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function Ik(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function I4(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function lge(t){const e=t[0],n=t[1];return e*e+n*n}function cge(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ize(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function n9(t,e){const n=e[0],r=e[1];let i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t}function uge(t,e){return t[0]*e[0]+t[1]*e[1]}function hge(t,e,n){const r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function sze(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function oze(t,e=1){const n=2*mB()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function aze(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function Xh(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function nC(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function lze(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function cze(t,e,n,r){const i=e[0]-n[0],s=e[1]-n[1],o=Math.sin(r),a=Math.cos(r);return t[0]=i*a-s*o+n[0],t[1]=i*o+s*a+n[1],t}function uze(t,e){const n=t[0],r=t[1],i=e[0],s=e[1];let o=n*n+r*r;o>0&&(o=1/Math.sqrt(o));let a=i*i+s*s;a>0&&(a=1/Math.sqrt(a));const l=(n*i+r*s)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function hze(t){return"vec2("+t[0]+", "+t[1]+")"}function dze(t,e){return t[0]===e[0]&&t[1]===e[1]}function fze(t,e){const n=t[0],r=t[1],i=e[0],s=e[1],o=vl();return Math.abs(n-i)<=o*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=o*Math.max(1,Math.abs(r),Math.abs(s))}function pze(t,e,n,r,i){let s=e[0]-n[0],o=e[1]-n[1];const a=(r[0]*s+r[1]*o)*(i-1);return s=r[0]*a,o=r[1]*a,t[0]=e[0]+s,t[1]=e[1]+o,t}const mze=I4,yB=Ak,gze=oge,yze=age,vze=_O,_ze=Ik,xze=lge;Object.freeze(Object.defineProperty({__proto__:null,add:sge,angle:uze,ceil:JVe,copy:Xx,cross:hge,dist:vze,distance:_O,div:yze,divide:age,dot:uge,equals:fze,exactEquals:dze,floor:QVe,inverse:ize,len:mze,length:I4,lerp:sze,max:tze,min:eze,mul:gze,multiply:oge,negate:cge,normalize:n9,projectAndScale:pze,random:oze,rotate:cze,round:nze,scale:hI,scaleAndAdd:rze,set:to,sqrDist:_ze,sqrLen:xze,squaredDistance:Ik,squaredLength:lge,str:hze,sub:yB,subtract:Ak,transformMat2:aze,transformMat2d:Xh,transformMat3:nC,transformMat4:lze},Symbol.toStringTag,{value:"Module"}));function Pf(t,e,n,r){return t[0]=e[0]*(1-r)+n[0]*r,t[1]=e[1]*(1-r)+n[1]*r,t}function Ca(t,e){return Ik(t,e)}function zRt(t,e,n){const r=Ca(e,n);if(r===0)return Ca(e,t);const i=(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0]);return i*i/r}function wze(t,e,n,r,i){const[s,o]=e,[a,l]=n,[c,u]=r,[h,f]=i,g=(s-a)*(u-f)-(o-l)*(c-h);if(g===0)return null;const v=(s*l-o*a)*(c-h)-(s-a)*(c*f-u*h),x=(s*l-o*a)*(u-f)-(o-l)*(c*f-u*h);return t[0]=v/g,t[1]=x/g,t}const Ju=2*Math.PI;function Xy(t,e){const n=Math.atan2(t,e);return n<0?n+Ju:n}function dge(t){return Math.abs(t)%Ju}function Uee(t){const e=dge(t);return e<Math.PI?e:Ju-e}function xO(t,e){return{min:Math.min(t,e),max:Math.max(t,e)}}function fge(t,e,n,r){if(gg(dge(t-e),0))return n?[t,t]:[t,r?t-Ju:t+Ju];const[i,s]=r?[t-Ju,t]:[t,t+Ju];return[t,dI({min:i,max:s},e)]}function dI({min:t,max:e},n){let r;return r=e-n,r>=Ju?(r-=r%Ju,n+r):(r=n-t,r>=Ju?(r-=r%Ju,n-r):n)}function bze(t,e){const n=dI(t,e);return n>t.min&&n<t.max?n:Uee(n-t.min)<Uee(n-t.max)?t.min:t.max}function pge(t,e,n,r=10){return e.map(i=>{let s=i;for(let o=0;o<r;o++){const[a,l,c,u,h,f]=n(s),g=t[0]-a,v=t[1]-l,x=-c,b=-u;s+=-(2*g*x+2*v*b)/(2*x*x+2*g*-h+2*b*b+2*v*-f||1e-6)}return s})}const Eze=[0,0];function mge(t){const e=1-t,n=e*e,r=t*t;return[n*e,3*t*n,3*r*e,r*t]}function r9(t,e,n,r,i){const[s,o,a,l]=mge(i);return[t[0]*s+e[0]*o+n[0]*a+r[0]*l,t[1]*s+e[1]*o+n[1]*a+r[1]*l]}function Gee(t,e,n,r,i){const[s,o,a,l]=mge(i);return t*s+e*o+n*a+r*l}function URt(t,e,n){const r=t,[i,s,o]=e.b;return r9(r,s,o,i,n)}function Sze(t,e,n){const r=t,[i,s,o]=e.b,a=Pf([0,0],r,s,n),l=Pf(Eze,s,o,n),c=Pf([0,0],o,i,n),u=Pf([0,0],a,l,n),h=Pf([0,0],l,c,n);return[{b:[Pf([],u,h,n),a,u]},{b:[[...i],h,c]}]}function GRt(t,e,n){const r=t,[i,s,o]=e.b,a=pge(n,[.1,.5,.9],h=>{const f=1-h,[g,v]=r9(r,s,o,i,h);return[g,v,3*f*f*(s[0]-r[0])+6*f*h*(o[0]-s[0])+3*h*h*(i[0]-o[0]),3*f*f*(s[1]-r[1])+6*f*h*(o[1]-s[1])+3*h*h*(i[1]-o[1]),6*f*(o[0]-2*s[0]+r[0])+6*h*(i[0]-2*o[0]+s[0]),6*f*(o[1]-2*s[1]+r[1])+6*h*(i[1]-2*o[1]+s[1])]}).map(h=>Math.min(1,Math.max(0,h)));a.push(0,1);let l=1/0;const c=a.map(h=>{const f=r9(r,s,o,i,h),[g,v]=f,x=n[0]-g,b=n[1]-v,T=Math.sqrt(x*x+b*b);return l=Math.min(T,l),{t:h,curvePoint:f,distance:T}}),u=[];for(const h of c){const{t:f,distance:g}=h;Bme(g,l)&&!u.some(({t:v})=>gg(v,f))&&u.push(h)}return u}function Tze(t,e,n){const r=e,[i,s,o]=n.b;if(Wc(t,r),Wc(t,i),e9(t,s[0],s[1])&&e9(t,o[0],o[1]))return t;for(const a of Bee(r[0],s[0],o[0],i[0]))a>0&&a<1&&GVe(t,Gee(r[0],s[0],o[0],i[0],a));for(const a of Bee(r[1],s[1],o[1],i[1]))a>0&&a<1&&BVe(t,Gee(r[1],s[1],o[1],i[1],a));return t}function Bee(t,e,n,r){const i=3*(3*(e-n)-t+r),s=6*(t-2*e+n),o=3*(e-t);if(i===0)return s!==0?[-o/s]:[];const a=Math.sqrt(s*s-4*i*o);return[(-s+a)/(2*i),(-s-a)/(2*i)]}function BRt(t,e,n){let i=0,s=[e];for(let o=0;o<16;o++){let a=t;const l=[];for(const u of s)l.push(...Sze(a,u,.5)),a=u.b[0];s=l,a=t,i=0;let c=0;for(const u of s){const[h,f,g]=u.b,v=Math.sqrt(Ca(a,h));i+=(v+(Math.sqrt(Ca(a,f))+Math.sqrt(Ca(f,g))+Math.sqrt(Ca(g,h))))/2,c+=v,a=h}if(i-c<n)return i}return i}function kze(t,e,n){const[r,i]=t,[s,o]=e,[a,l]=n,[c,u]=[s-r,o-i];let h=c*(a-r)+u*(l-i);h/=c**2+u**2,h=cu(h,0,1);const f=Pf([0,0],t,e,h);return{t:h,curvePoint:f,distance:Math.sqrt(Ca(f,n))}}let gge=class{constructor(e,n,r,i,s,o){this.cx=e,this.cy=n,this.radius=r,this.thetaStart=i,this.thetaEnd=s,this.isInvalid=o}get startPoint(){const{cx:e,cy:n,radius:r,thetaStart:i}=this;return[e+r*Math.cos(i),n+r*Math.sin(i)]}get endPoint(){const{cx:e,cy:n,radius:r,thetaEnd:i}=this;return[e+r*Math.cos(i),n+r*Math.sin(i)]}};function R4(t,e){const{cx:n,cy:r,radius:i}=t;return[n+i*Math.cos(e),r+i*Math.sin(e)]}function rC(t,e){if(t.isInvalid)return Pf([0,0],t.startPoint,t.endPoint,e);const{thetaStart:n,thetaEnd:r}=t;return R4(t,n*(1-e)+r*e)}function HRt(t,e){if(t.isInvalid)return kze(t.startPoint,t.endPoint,e);const{cx:n,cy:r,thetaStart:i,thetaEnd:s}=t,[o,a]=e,l=bze(xO(i,s),Math.atan2(a-r,o-n)),c=R4(t,l);return{t:(l-i)/(s-i),curvePoint:c,distance:Math.sqrt(Ca(e,c))}}function Wee(t,e){if(e.isInvalid)return Wc(t,e.startPoint),Wc(t,e.endPoint),t;const{cx:n,cy:r,radius:i,thetaStart:s,thetaEnd:o}=e;Wc(t,R4(e,s)),Wc(t,R4(e,o));const a=xO(s,o),l=Math.PI/2;let c=0;for(const u of[[n+i,r],[n,r+i],[n-i,r],[n,r-i]])c=dI(a,c),c>a.min&&c<a.max&&Wc(t,u),c+=l;return t}function qRt(t){if(t.isInvalid)return 2*t.radius;const{radius:e,thetaStart:n,thetaEnd:r}=t;return e*Math.abs(r-n)}function Aze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Ize(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Zx(t,e,n,r,i,s,o,a,l,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t}function yge(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function vge(t,e){if(t===e){const n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function _ge(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l;let v=n*h+r*f+i*g;return v?(v=1/v,t[0]=h*v,t[1]=(-u*r+i*c)*v,t[2]=(a*r-i*o)*v,t[3]=f*v,t[4]=(u*n-i*l)*v,t[5]=(-a*n+i*s)*v,t[6]=g*v,t[7]=(-c*n+r*l)*v,t[8]=(o*n-r*s)*v,t):null}function Rze(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-a*c,t[1]=i*c-r*u,t[2]=r*a-i*o,t[3]=a*l-s*u,t[4]=n*u-i*l,t[5]=i*s-n*a,t[6]=s*c-o*l,t[7]=r*l-n*c,t[8]=n*o-r*s,t}function iC(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*(c*s-o*l)+n*(-c*i+o*a)+r*(l*i-s*a)}function Rk(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],g=n[1],v=n[2],x=n[3],b=n[4],T=n[5],A=n[6],I=n[7],R=n[8];return t[0]=f*r+g*o+v*c,t[1]=f*i+g*a+v*u,t[2]=f*s+g*l+v*h,t[3]=x*r+b*o+T*c,t[4]=x*i+b*a+T*u,t[5]=x*s+b*l+T*h,t[6]=A*r+I*o+R*c,t[7]=A*i+I*a+R*u,t[8]=A*s+I*l+R*h,t}function i9(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=n[0],g=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=f*r+g*o+c,t[7]=f*i+g*a+u,t[8]=f*s+g*l+h,t}function xge(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=Math.sin(n),g=Math.cos(n);return t[0]=g*r+f*o,t[1]=g*i+f*a,t[2]=g*s+f*l,t[3]=g*o-f*r,t[4]=g*a-f*i,t[5]=g*l-f*s,t[6]=c,t[7]=u,t[8]=h,t}function Pze(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function Mze(t,e,n){const r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t}function Cze(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Nze(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Oze(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lze(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Dze(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,g=i*a,v=i*l,x=s*o,b=s*a,T=s*l;return t[0]=1-h-v,t[3]=u-T,t[6]=f+b,t[1]=u+T,t[4]=1-c-v,t[7]=g-x,t[2]=f-b,t[5]=g+x,t[8]=1-c-h,t}function $ze(t,e){const n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10],h=u*o-a*c,f=-u*s+a*l,g=c*s-o*l,v=n*h+r*f+i*g;if(!v)return null;const x=1/v;return t[0]=h*x,t[1]=(-u*r+i*c)*x,t[2]=(a*r-i*o)*x,t[3]=f*x,t[4]=(u*n-i*l)*x,t[5]=(-a*n+i*s)*x,t[6]=g*x,t[7]=(-c*n+r*l)*x,t[8]=(o*n-r*s)*x,t}function jze(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],v=e[12],x=e[13],b=e[14],T=e[15],A=n*a-r*o,I=n*l-i*o,R=n*c-s*o,C=r*l-i*a,V=r*c-s*a,M=i*c-s*l,N=u*x-h*v,O=u*b-f*v,F=u*T-g*v,L=h*b-f*x,B=h*T-g*x,U=f*T-g*b;let de=A*U-I*B+R*L+C*F-V*O+M*N;return de?(de=1/de,t[0]=(a*U-l*B+c*L)*de,t[1]=(l*F-o*U-c*O)*de,t[2]=(o*B-a*F+c*N)*de,t[3]=(i*B-r*U-s*L)*de,t[4]=(n*U-i*F+s*O)*de,t[5]=(r*F-n*B-s*N)*de,t[6]=(x*M-b*V+T*C)*de,t[7]=(b*R-v*M-T*I)*de,t[8]=(v*V-x*R+T*A)*de,t):null}function Fze(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Vze(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function zze(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function Uze(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function wge(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Gze(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Bze(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Wze(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Hze(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=e[0],f=e[1],g=e[2],v=e[3],x=e[4],b=e[5],T=e[6],A=e[7],I=e[8],R=vl();return Math.abs(n-h)<=R*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-f)<=R*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-g)<=R*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(s-v)<=R*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(o-x)<=R*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-b)<=R*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(l-T)<=R*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-A)<=R*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(u-I)<=R*Math.max(1,Math.abs(u),Math.abs(I))}function qze(t){const e=vl(),n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(i*i+a*a+u*u))<=e}const Kze=Rk,Yze=wge;Object.freeze(Object.defineProperty({__proto__:null,add:Uze,adjoint:Rze,copy:Ize,determinant:iC,equals:Hze,exactEquals:Wze,frob:zze,fromMat2d:Lze,fromMat4:Aze,fromQuat:Dze,fromRotation:Nze,fromScaling:Oze,fromTranslation:Cze,identity:yge,invert:_ge,isOrthoNormal:qze,mul:Kze,multiply:Rk,multiplyScalar:Gze,multiplyScalarAndAdd:Bze,normalFromMat4:jze,normalFromMat4Legacy:$ze,projection:Fze,rotate:xge,scale:Pze,scaleByVec2:Mze,set:Zx,str:Vze,sub:Yze,subtract:wge,translate:i9,transpose:vge},Symbol.toStringTag,{value:"Module"}));function ov(){return[1,0,0,0,1,0,0,0,1]}function Xze(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}function Zze(t,e,n,r,i,s,o,a,l){return[t,e,n,r,i,s,o,a,l]}const Jze=ov();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Jze,clone:Xze,create:ov,fromValues:Zze},Symbol.toStringTag,{value:"Module"}));const p_=ov();function Qze(t,e,n){const[r,i]=t,[s,o]=e,[a,l]=n;Zx(p_,r,s,a,i,o,l,1,1,1);const c=iC(p_),u=4*c/(Ca(t,e)+Ca(e,n)+Ca(n,t));if(!isFinite(u)||Math.abs(u)<1e-8)return null;const h=r**2+i**2,f=s**2+o**2,g=a**2+l**2;Zx(p_,h,f,g,i,o,l,1,1,1);const v=iC(p_);return Zx(p_,h,f,g,r,s,a,1,1,1),[v/c*.5,iC(p_)/c*-.5]}function bge(t,e){const[n,r]=e.c,i=Qze(t,r,n),s=i==null,o=i??Pf([],t,n,.5),[a,l]=t,[c,u]=r,[h,f]=n,[g,v]=o,x=a-g,b=l-v,T=Math.sqrt(x*x+b*b),A=Xy(l-v,a-g),I=Xy(u-v,c-g);let R=Xy(f-v,h-g);return(I-A)*(R-I)<0&&(R+=2*Math.sign(A-R)*Math.PI),new gge(g,v,T,A,R,s)}function KRt(t,e,n){const r=rC(t,n/2),i=rC(t,n),s=rC(t,(n+1)/2);return[{c:[i,r]},{c:[[...e.c[0]],s]}]}function YRt(t,e){const[n]=e.c,{cx:r,cy:i,thetaStart:s,thetaEnd:o,radius:a,isInvalid:l}=bge(t,e);return{a:[n,[r,i],Math.abs(o-s)<Math.PI?1:0,s>o?1:0,l?s:0,a,l?0:1]}}function XRt(t){return"curveRings"in t&&!!t.curveRings?.length||"curvePaths"in t&&!!t.curvePaths?.length}function ZRt(t){return"curveRings"in t?t.curveRings:t.curvePaths}function vB(t){return"b"in t}function _B(t){return"c"in t}function wO(t){return Array.isArray(t)}function JRt(t){return"a"in t}function Ege(t){return"a"in t&&t.a.length===4}function eUe(t){return"a"in t&&t.a.length===7}function y$(t){return wO(t)?t:vB(t)?t.b[0]:_B(t)?t.c[0]:t.a[0]}function tUe(t){if(vB(t)){const[e,n,r]=t.b;return{b:[[...e],[...n],[...r]]}}if(_B(t)){const[e,n]=t.c;return{c:[[...e],[...n]]}}if(wO(t))return[...t];if(Ege(t)){const[e,n,r,i]=t.a;return{a:[[...e],[...n],r,i]}}if(eUe(t)){const[e,n,r,i,s,o,a]=t.a;return{a:[[...e],[...n],r,i,s,o,a]}}return t}function nUe(t,e){const[n,r,i,s]=e.a,[o,a]=t,[l,c]=n,[u,h]=r,f=o-u,g=a-h,v=Math.sqrt(f*f+g*g),x=l-u,b=c-h,T=Math.sqrt(x*x+b*b),A=v===0||T===0||!Bme(v,T),I=v,[R,C]=fge(Xy(a-h,o-u),Math.atan2(c-h,l-u),i,s);return new gge(u,h,I,R,C,A)}function QRt(t,e,n){const{cx:r,cy:i,thetaStart:s,thetaEnd:o}=t,[a,l,c,u]=e.a,h=s*(1-n)+o*n;return[{a:[rC(t,n),[r,i],Math.abs(h-s)<Math.PI?1:0,u]},{a:[[...a],[r,i],Math.abs(o-h)<Math.PI?1:0,u]}]}let rUe=class{constructor(e,n,r,i,s,o,a,l,c){this.cx=e,this.cy=n,this.a=r,this.b=i,this.cosR=s,this.sinR=o,this.u1=a,this.u2=l,this.isInvalid=c}};function xB(t,e){const[n,r,i,s,o,a,l]=e.a,[c,u]=t,[h,f]=n,[g,v]=r,x=a*l,b=Math.cos(o),T=Math.sin(o),[A,I]=fge(Xy(1/x*(u-v)*b-1/x*(c-g)*T,1/a*(u-v)*T+1/a*(c-g)*b),Math.atan2(1/x*(f-v)*b-1/x*(h-g)*T,1/a*(f-v)*T+1/a*(h-g)*b),i,s);return new rUe(g,v,a,x,b,T,A,I,a===0||x===0)}function Pk(t,e){const{a:n,b:r,cosR:i,sinR:s,cx:o,cy:a}=t,l=Math.cos(e),c=Math.sin(e);return[n*l*i-r*c*s+o,n*l*s+r*c*i+a]}function V_(t,e){const{u1:n,u2:r}=t;return Pk(t,n*(1-e)+r*e)}function tPt(t,e,n){if(n<0||n>1)return[];if(n===0||n===1)return[tUe(e)];const[r,[i,s],o,a,l,c,u]=e.a,{u1:h,u2:f}=t,g=h*(1-n)+f*n;return[{a:[[...V_(t,n)],[i,s],Math.abs(g-h)<Math.PI?1:0,a,l,c,u]},{a:[[...r],[i,s],Math.abs(f-g)<Math.PI?1:0,a,l,c,u]}]}function nPt(t,e){const{a:n,b:r,cosR:i,sinR:s,u1:o,u2:a}=t,l=Math.PI/6,c=pge(e,[1*l,2*l,4*l,5*l,7*l,8*l,10*l,11*l],x=>{const b=Math.cos(x),T=Math.sin(x),[A,I]=Pk(t,x);return[A,I,-n*i*T-r*s*b,-n*s*T+r*i*b,-n*i*b+r*s*T,-n*s*b-r*i*T]}),u=xO(o,a),h=new Set(c.map(x=>dI(u,x)).filter(x=>x>u.min&&x<u.max));h.add(o),h.add(a);let f,g,v=1/0;for(const x of h){const b=Pk(t,x),[T,A]=b,I=e[0]-T,R=e[1]-A,C=I*I+R*R;C<v&&(f=(x-o)/(a-o),g=b,v=C)}return{t:f,curvePoint:g,distance:Math.sqrt(v)}}function iUe(t,e,n){const r=xB(e,n),{a:i,b:s,u1:o,u2:a,cosR:l,sinR:c,isInvalid:u}=r,h=n.a[0];if(Wc(t,e),Wc(t,h),u)return t;const f=Math.atan2(-s*c,i*l),g=f+Math.PI,v=Math.atan2(s*l,i*c),x=v+Math.PI,b=xO(o,a);for(const T of[f,g,v,x].map(A=>dI(b,A)))T>b.min&&T<b.max&&Wc(t,Pk(r,T));return t}function rPt(t,e,n){const[r,i,s,o,a,l,c]=e.a,u=xB(t,e),{u1:h,u2:f,isInvalid:g}=u,v=f-h;if(g)return Math.sqrt(Ca(t,r));const x=14,b=[0,0];let T=0,A=[V_(u,0),V_(u,.25),V_(u,.5),V_(u,.75),V_(u,1)];for(let I=0;I<x;I++){const R=A.length-1,C=v/(2*R),V=[];for(let N=0;N<R;N++)V.push(A[N]),V.push(Pk(u,h+(2*N+1)*C));V.push(A[A.length-1]),A=V,T=0;let M=0;for(let N=1;N<A.length;N++){const O=A[N-1],F=A[N];if(T+=Math.sqrt(Ca(O,F)),N>1){const L=A[N-2],B=wze(b,L,O,i,F);M+=B?Math.sqrt(Ca(O,B)):Math.abs(F[0]-O[0])+Math.abs(F[1]-O[1])}else M+=T}if(M-T<n)return T}return T}const Hee=ov(),SP=ov(),qee=ov(),lm=ov();function iPt(t,e,n){const[r,i,s,o,a,l,c]=e.a,u=xB(t,e),{cosR:h,sinR:f,a:g,b:v,cx:x,cy:b}=u,T=nC([0,0],r,n),A=nC([0,0],i,n),I=n[0]*n[4]<0?1-o:o;{const R=g*g*f*f+v*v*h*h,C=2*(v*v-g*g)*f*h,V=g*g*h*h+v*v*f*f,M=-2*R*x-C*b,N=-C*x-2*V*b;Zx(Hee,R,C/2,M/2,C/2,V,N/2,M/2,N/2,R*x*x+C*x*b+V*b*b-g*g*v*v)}if(_ge(SP,n),SP==null){const R=nC([0,0],t,n);return{a:[T,A,s,o,Xy(T[1],T[0]),Math.sqrt(Ca(T,R))/2,0]}}vge(qee,SP),Rk(lm,Rk(lm,qee,Hee),SP);{const R=lm[0],C=2*lm[1],V=lm[4],M=2*lm[2],N=2*lm[5],O=C*C-4*R*V,F=2*(R*N*N+V*M*M-C*M*N+O*lm[8]),L=Math.sqrt((R-V)**2+C*C),B=-Math.sqrt(F*(R+V+L))/O,U=-Math.sqrt(F*(R+V-L))/O;return{a:[T,A,s,I,.5*Xy(-C,V-R),B,U/B]}}}function sUe(t,e,n){if(wO(n))return Wc(t,e),Wc(t,n),t;if(vB(n))return Tze(t,e,n);if(_B(n)){const r=bge(e,n);return Wee(t,r)}if(Ege(n)){const r=nUe(e,n);return Wee(t,r)}return iUe(t,e,n)}function Sge(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function Tge(t){return t.points!==void 0}function kge(t){return t.x!==void 0&&t.y!==void 0}function Age(t){return t.paths!==void 0}function Ige(t){return t.rings!==void 0}function Rge(t){function e(n,r){return n==null?r:r==null?n:t(n,r)}return e}const Xm=Rge(Math.min),Zm=Rge(Math.max);function sPt(t,e){return Age(e)?u2(t,e.curvePaths??e.paths,!1,!1)??t:Ige(e)?u2(t,e.curveRings??e.rings,!1,!1)??t:Tge(e)?wB(t,e.points,!1,!1,!1,!1):Sge(e)?Pge(t,e):(kge(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function oPt(t){let e,n,r,i;for(t.reset(),e=r=1/0,n=i=-1/0;t.nextPath();){const s=oUe(t);e=Math.min(s[0],e),r=Math.min(s[1],r),n=Math.max(s[2],n),i=Math.max(s[3],i)}return pl([e,r,n,i])}function oUe(t){let e,n,r,i;for(e=r=1/0,n=i=-1/0;t.nextPoint();)e=Math.min(t.x,e),r=Math.min(t.y,r),n=Math.max(t.x,n),i=Math.max(t.y,i);return pl([e,r,n,i])}function aPt(t,e){return Age(e)?u2(t,e.curvePaths??e.paths,!0,!1)??t:Ige(e)?u2(t,e.curveRings??e.rings,!0,!1)??t:Tge(e)?wB(t,e.points,!0,!1,!0,!1):Sge(e)?Pge(t,e,!0,!1,!0,!1):(kge(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function u2(t,e,n,r){const i=n?3:2;if(!e.length||!e[0].length)return null;let s,o,a,l,[c,u]=y$(e[0][0]),h=c,f=u;for(let g=0;g<e.length;g++){const v=e[g];for(let x=0;x<v.length;x++){const b=y$(v[x]),[T,A]=b;if(c=Xm(c,T),u=Xm(u,A),h=Zm(h,T),f=Zm(f,A),n&&b.length>2){const V=b[2];s=Xm(s,V),o=Zm(o,V)}if(r&&b.length>i){const V=b[i];a=Xm(s,V),l=Zm(o,V)}const I=v[x];if(wO(I)||x<1)continue;const R=y$(v[x-1]),C=zVe(c,u,h,f);[c,u,h,f]=sUe(C,R,I)}}return n?r?(t[0]=c,t[1]=u,t[2]=s,t[3]=a,t[4]=h,t[5]=f,t[6]=o,t[7]=l,t.length=8,t):(t[0]=c,t[1]=u,t[2]=s,t[3]=h,t[4]=f,t[5]=o,t.length=6,t):r?(t[0]=c,t[1]=u,t[2]=a,t[3]=h,t[4]=f,t[5]=l,t.length=6,t):(t[0]=c,t[1]=u,t[2]=h,t[3]=f,t.length=4,t)}function Pge(t,e,n,r,i,s){const o=e.xmin,a=e.xmax,l=e.ymin,c=e.ymax;let u=e.zmin,h=e.zmax,f=e.mmin,g=e.mmax;return i?(u=u||0,h=h||0,s?(f=f||0,g=g||0,t[0]=o,t[1]=l,t[2]=u,t[3]=f,t[4]=a,t[5]=c,t[6]=h,t[7]=g,t):(t[0]=o,t[1]=l,t[2]=u,t[3]=a,t[4]=c,t[5]=h,t)):s?(f=f||0,g=g||0,t[0]=o,t[1]=l,t[2]=f,t[3]=a,t[4]=c,t[5]=g,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=c,t)}function wB(t,e,n,r,i,s){const o=n?3:2,a=r&&s,l=n&&i;if(!e.length||!e[0].length)return null;let c,u,h,f,[g,v]=e[0],[x,b]=e[0];for(let T=0;T<e.length;T++){const A=e[T],[I,R]=A;if(g=Xm(g,I),v=Xm(v,R),x=Zm(x,I),b=Zm(b,R),l&&A.length>2){const C=A[2];c=Xm(c,C),u=Zm(u,C)}if(a&&A.length>o){const C=A[o];h=Xm(c,C),f=Zm(u,C)}}return i?(c=c||0,u=u||0,s?(h=h||0,f=f||0,t[0]=g,t[1]=v,t[2]=c,t[3]=h,t[4]=x,t[5]=b,t[6]=u,t[7]=f,t):(t[0]=g,t[1]=v,t[2]=c,t[3]=x,t[4]=b,t[5]=u,t)):s?(h=h||0,f=f||0,t[0]=g,t[1]=v,t[2]=h,t[3]=x,t[4]=b,t[5]=f,t):(t[0]=g,t[1]=v,t[2]=x,t[3]=b,t)}function aUe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function lUe(t){return t.points!==void 0}function cUe(t){return t.x!==void 0&&t.y!==void 0}function uUe(t){return t.paths!==void 0}function hUe(t){return t.rings!==void 0}const bB=[];function Mge(t,e,n,r){return{xmin:t,ymin:e,xmax:n,ymax:r}}function Cge(t,e,n,r,i,s){return{xmin:t,ymin:e,zmin:n,xmax:r,ymax:i,zmax:s}}function Nge(t,e,n,r,i,s){return{xmin:t,ymin:e,mmin:n,xmax:r,ymax:i,mmax:s}}function Oge(t,e,n,r,i,s,o,a){return{xmin:t,ymin:e,zmin:n,mmin:r,xmax:i,ymax:s,zmax:o,mmax:a}}function EB(t,e=!1,n=!1){return e?n?Oge(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Cge(t[0],t[1],t[2],t[3],t[4],t[5]):n?Nge(t[0],t[1],t[2],t[3],t[4],t[5]):Mge(t[0],t[1],t[2],t[3])}function lPt(t){return t?aUe(t)?t:cUe(t)?dUe(t):hUe(t)?Dge(t):uUe(t)?$ge(t):lUe(t)?Lge(t):null:null}function Lge(t){const{hasZ:e,hasM:n,points:r}=t,i=wB(bB,r,e??!1,n??!1,e??!1,n??!1);return i?EB(i,e,n):null}function dUe(t){const{x:e,y:n,z:r,m:i}=t,s=i!=null;return r!=null?s?Oge(e,n,r,i,e,n,r,i):Cge(e,n,r,e,n,r):s?Nge(e,n,i,e,n,i):Mge(e,n,e,n)}function Dge(t){const{hasZ:e,hasM:n,rings:r,curveRings:i}=t,s=u2(bB,i??r,e??!1,n??!1);return s?EB(s,e,n):null}function $ge(t){const{hasZ:e,hasM:n,paths:r,curvePaths:i}=t,s=u2(bB,i??r,e??!1,n??!1);return s?EB(s,e,n):null}function h2(t,e,n=!1){let{hasM:r,hasZ:i}=t;Array.isArray(e)?e.length!==4||r||i?e.length===3&&n&&!r?(i=!0,r=!1):e.length===3&&r&&i&&(r=!1,i=!1):(r=!0,i=!0):(i=!i&&e.hasZ&&(!r||e.hasM),r=!r&&e.hasM&&(!i||e.hasZ)),t.hasZ=i,t.hasM=r}var sC;function Kee(t){return!Array.isArray(t[0])}function fUe(t){return typeof t[0]?.[0]=="number"}function pUe(t){if(!t)return;let{rings:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],fUe(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,rings:e,spatialReference:i}}let yi=sC=class extends Ds{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:n}=t;let r=!1,i=!1;for(const o of e)o.hasZ&&(r=!0),o.hasM&&(i=!0);const s={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(r&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(l)}if(i&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(l)}return a}),spatialReference:n};return r&&(s.hasZ=!0),i&&(s.hasM=!0),new sC(s)}constructor(t){super(pUe(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){fF(St.getLogger(this),"centroid",{replacement:"Please use centroidOperator.execute() instead.",version:"4.34",warnOnce:!0});const t=NVe(this);return t?Jt.fromJSON(t):null}writeCurveRings(t,e){e.curveRings=Ze(t)}get extent(){const t=Dge(this),{spatialReference:e}=this;return t?new Dn({...t,spatialReference:e}):null}get isSelfIntersecting(){return fF(St.getLogger(this),"isSelfIntersecting",{replacement:"Please use simplifyOperator.isSimple() instead.",version:"4.33",warnOnce:!0}),Kje(this.rings)}writeRings(t,e){e.rings=Ze(this.rings)}addRing(t){if(!t)return;const e=this.rings,n=e.length;if(Kee(t)){const r=[];for(let i=0,s=t.length;i<s;i++)r[i]=t[i].toArray();e[n]=r}else e[n]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new sC;return t.spatialReference=this.spatialReference,t.rings=Ze(this.rings),t.curveRings=Ze(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,n=t.spatialReference;if(e!=null!=(n!=null)||e!=null&&n!=null&&!e.equals(n)||this.rings.length!==t.rings.length)return!1;const r=([i,s,o,a],[l,c,u,h])=>i===l&&s===c&&(o==null&&u==null||o===u)&&(a==null&&h==null||a===h);for(let i=0;i<this.rings.length;i++){const s=this.rings[i],o=t.rings[i];if(!B5(s,o,r))return!1}return!0}contains(t){if(!t)return!1;const e=lO(t,this.spatialReference);return WG(this,e??t)}isClockwise(t){const e=Kee(t)?t.map(n=>this.hasZ?this.hasM?[n.x,n.y,n.z,n.m]:[n.x,n.y,n.z]:[n.x,n.y]):t;return tge(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const n=this.rings[t][e],r=this.hasZ,i=this.hasM;return r&&!i?new Jt(n[0],n[1],n[2],void 0,this.spatialReference):i&&!r?new Jt(n[0],n[1],void 0,n[2],this.spatialReference):r&&i?new Jt(n[0],n[1],n[2],n[3],this.spatialReference):new Jt(n[0],n[1],this.spatialReference)}insertPoint(t,e,n){return this._validateInputs(t,e,!0)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.rings[t].splice(e,0,n),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const n=new Jt(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),n}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],n=this.spatialReference,r=e.map(i=>new Jt(i,n));return this.notifyChange("rings"),r}setPoint(t,e,n){return this._validateInputs(t,e)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.rings[t][e]=n,this.notifyChange("rings"),this):this}_validateInputs(t,e,n=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const r=this.rings[t];if(n&&(e<0||e>r.length)||!n&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};_([E({readOnly:!0})],yi.prototype,"cache",null),_([E({readOnly:!0})],yi.prototype,"centroid",null),_([E({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],yi.prototype,"curveRings",void 0),_([Xn("curveRings")],yi.prototype,"writeCurveRings",null),_([E({readOnly:!0})],yi.prototype,"extent",null),_([E({readOnly:!0})],yi.prototype,"isSelfIntersecting",null),_([E({type:[[[Number]]],json:{write:{isRequired:!0}}})],yi.prototype,"rings",void 0),_([Xn("rings")],yi.prototype,"writeRings",null),yi=sC=_([ue("esri.geometry.Polygon")],yi),yi.prototype.toJSON.isDefaultToJSON=!0;function Zg(){return[0,0,0]}function mUe(t){return[t[0],t[1],t[2]]}function tb(t,e,n){return[t,e,n]}function gUe(t,e,n){return[t,e,n]}function yUe(t,e=Zg()){const n=Math.min(3,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function jge(){return Zg()}function Fge(){return tb(1,1,1)}function Vge(){return tb(1,0,0)}function zge(){return tb(0,1,0)}function Uge(){return tb(0,0,1)}const vUe=jge(),_Ue=Fge(),xUe=Vge(),wUe=zge(),bUe=Uge();Object.freeze(Object.defineProperty({__proto__:null,ONES:_Ue,UNIT_X:xUe,UNIT_Y:wUe,UNIT_Z:bUe,ZEROS:vUe,clone:mUe,create:Zg,freeze:gUe,fromArray:yUe,fromValues:tb,ones:Fge,unitX:Vge,unitY:zge,unitZ:Uge,zeros:jge},Symbol.toStringTag,{value:"Module"}));var s9;function EUe(t){if(!t)return;let{points:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],e?.at(0)?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,points:e,spatialReference:i}}let Gu=s9=class extends Ds{constructor(t){super(EUe(t)),this.points=[],this.type="multipoint"}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=Lge(this);return t?new Dn({...t,spatialReference:this.spatialReference}):null}writePoints(t,e){e.points=Ze(this.points)}clone(){const{points:t,spatialReference:e,hasM:n,hasZ:r}=this;return new s9({points:Ze(t),spatialReference:e.clone(),hasM:n,hasZ:r})}addPoint(t){return h2(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],n={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(n.z=e[2],r=3),this.hasM&&(n.m=e[r]),new Jt(n)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Jt(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(h2(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};_([E({readOnly:!0})],Gu.prototype,"cache",null),_([E({readOnly:!0})],Gu.prototype,"extent",null),_([E({type:[[Number]],json:{write:{isRequired:!0}}})],Gu.prototype,"points",void 0),_([Xn("points")],Gu.prototype,"writePoints",null),Gu=s9=_([ue("esri.geometry.Multipoint")],Gu),Gu.prototype.toJSON.isDefaultToJSON=!0;var o9;function SUe(t){return!Array.isArray(t[0])}function TUe(t){return typeof t[0]?.[0]=="number"}function kUe(t){if(!t)return;let{paths:e,hasM:n,hasZ:r,spatialReference:i}=t;switch(e??=[],TUe(e)&&(e=[e]),e[0]?.[0]?.length){case 4:r??=!0,n??=!0;break;case 3:r??=n!==!0,n??=!r;break;default:r??=!1,n??=!1}return i??=Bt.WGS84,{...t,hasM:n,hasZ:r,paths:e,spatialReference:i}}let xs=o9=class extends Ds{constructor(t){super(kUe(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=Ze(t)}get extent(){const t=$ge(this),{spatialReference:e}=this;return t?new Dn({...t,spatialReference:e}):null}writePaths(t,e){e.paths=Ze(this.paths)}addPath(t){if(!t)return;const e=this.paths,n=e.length;if(SUe(t)){const r=[];for(let i=0,s=t.length;i<s;i++)r[i]=t[i].toArray();e[n]=r}else e[n]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new o9;return t.spatialReference=this.spatialReference,t.paths=Ze(this.paths),t.curvePaths=Ze(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const n=this.paths[t][e],r=this.hasZ,i=this.hasM;return r&&!i?new Jt(n[0],n[1],n[2],void 0,this.spatialReference):i&&!r?new Jt(n[0],n[1],void 0,n[2],this.spatialReference):r&&i?new Jt(n[0],n[1],n[2],n[3],this.spatialReference):new Jt(n[0],n[1],this.spatialReference)}insertPoint(t,e,n){return this._validateInputs(t,e,!0)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.paths[t].splice(e,0,n),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],n=this.spatialReference,r=e.map(i=>new Jt(i,n));return this.notifyChange("paths"),r}removePoint(t,e){if(!this._validateInputs(t,e))return null;const n=new Jt(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),n}setPoint(t,e,n){return this._validateInputs(t,e)?(h2(this,n),Array.isArray(n)||(n=n.toArray()),this.paths[t][e]=n,this.notifyChange("paths"),this):this}_validateInputs(t,e,n=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const r=this.paths[t];if(n&&(e<0||e>r.length)||!n&&(e<0||e>=r.length))return!1}return!0}toJSON(t){return this.write({},t)}};_([E({readOnly:!0})],xs.prototype,"cache",null),_([E({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],xs.prototype,"curvePaths",void 0),_([Xn("curvePaths")],xs.prototype,"writeCurvePaths",null),_([E({readOnly:!0})],xs.prototype,"extent",null),_([E({type:[[[Number]]],json:{write:{isRequired:!0}}})],xs.prototype,"paths",void 0),_([Xn("paths")],xs.prototype,"writePaths",null),xs=o9=_([ue("esri.geometry.Polyline")],xs),xs.prototype.toJSON.isDefaultToJSON=!0;var a9;let z_=a9=class extends Kt{constructor(t){super(t),this.isInverse=!1,this.wkt=null,this.wkid=null}getInverse(){return new a9({isInverse:!this.isInverse,wkid:this.wkid,wkt:this.wkt})}};_([E()],z_.prototype,"isInverse",void 0),_([E()],z_.prototype,"wkt",void 0),_([E()],z_.prototype,"wkid",void 0),z_=a9=_([ue("esri.geometry.operators.support.GeographicTransformationStep")],z_);var l9;let tT=l9=class extends Kt{constructor(t){super(t),this.steps=[]}getInverse(){const t=new l9;for(let e=this.steps.length-1;e>=0;e--){const n=this.steps[e];t.steps.push(n.getInverse())}return t}};_([E({type:[z_],nonNullable:!0})],tT.prototype,"steps",void 0),tT=l9=_([ue("esri.geometry.operators.support.GeographicTransformation")],tT);const cPt=Math.PI/180,uPt=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,cm=ts.radius,Ru=ts.eccentricitySquared,AUe={a1:cm*Ru,a2:cm*Ru*cm*Ru,a3:cm*Ru*Ru/2,a4:cm*Ru*cm*Ru*2.5,a5:cm*Ru+cm*Ru*Ru/2,a6:1-Ru},hPt={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:ts.radius,f:ts.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:Ng.radius,f:Ng.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:pd.radius,f:pd.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:pd.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}},IUe={2:{5:li,7:null,9:null,10:li,1:rT,6:null,8:null,0:null,3:Jx,11:Qx,2:li,4:nw},5:{5:li,7:null,9:null,10:li,1:rT,6:null,8:null,0:null,3:Jx,11:Qx,2:li,4:nw},7:{5:null,7:li,9:null,10:li,1:null,6:Zee,8:null,0:null,3:null,11:null,2:null,4:null},9:{5:null,7:null,9:li,10:li,1:null,6:null,8:Xee,0:null,3:null,11:null,2:null,4:null},3:{5:nT,7:null,9:null,10:nT,1:PUe,6:null,8:null,0:null,3:li,11:NUe,2:nT,4:MUe},4:{5:rw,7:null,9:null,10:rw,1:UUe,6:null,8:null,0:null,3:GUe,11:OUe,2:rw,4:li},1:{5:tw,7:null,9:null,10:tw,1:li,6:null,8:null,0:null,3:FUe,11:LUe,2:tw,4:VUe},6:{5:null,7:Qee,9:null,10:Qee,1:null,6:li,8:null,0:null,3:null,11:null,2:null,4:null},8:{5:null,7:null,9:Jee,10:Jee,1:null,6:null,8:li,0:null,3:null,11:null,2:null,4:null},0:{5:null,7:null,9:null,10:null,1:null,6:null,8:null,0:li,3:null,11:null,2:null,4:null},10:{5:li,7:li,9:li,10:li,1:rT,6:Zee,8:Xee,0:null,3:Jx,11:Qx,2:li,4:nw},11:{5:ew,7:null,9:null,10:ew,1:DUe,6:null,8:null,0:null,3:$Ue,11:li,2:ew,4:jUe}};function Gge(t,e){return RUe(t,e)?.projector}function RUe(t,e){if(t==null||e==null)return null;if(tf.source.spatialReference===t&&tf.dest.spatialReference===e)return tf;const n=Yee(t,tf.source),r=Yee(e,tf.dest);return n===0&&r===0?uo(t,e)?tf.projector=li:tf.projector=null:tf.projector=IUe[n][r],tf}function Yee(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Dd(t,1)),_4(t)?e.spatialReferenceId=1:C1(t)?e.spatialReferenceId=2:kd(t)?e.spatialReferenceId=3:eje(t)?e.spatialReferenceId=11:t.wkt===ije.wkt?e.spatialReferenceId=4:t.wkid===4490?e.spatialReferenceId=5:t.wkt===UG.wkt?e.spatialReferenceId=6:t.wkt===GG.wkt?e.spatialReferenceId=8:Xfe(t)?e.spatialReferenceId=7:Zfe(t)?e.spatialReferenceId=9:e.spatialReferenceId=0):0}function li(t,e,n,r){t!==n&&(n[r++]=t[e++],n[r++]=t[e++],n[r]=t[e])}function nT(t,e,n,r){n[r]=f2*(t[e]/Zy),n[r+1]=f2*(Bge-2*Math.atan(Math.exp(-t[e+1]/Zy))),n[r+2]=t[e+2]}function PUe(t,e,n,r){const i=t[e]/Zy,s=Bge-2*Math.atan(Math.exp(-t[e+1]/Zy)),o=Zy+t[e+2],a=Math.cos(s)*o;n[r]=Math.cos(i)*a,n[r+1]=Math.sin(i)*a,n[r+2]=Math.sin(s)*o}function MUe(t,e,n,r){nT(t,e,n,r),nw(n,r,n,r)}function CUe(t,e,n,r,i){const s=.4999999*Math.PI,o=cu(d2*t[e+1],-s,s),a=Math.sin(o);n[r++]=d2*t[e]*i.radius,n[r++]=i.halfSemiMajorAxis*Math.log((1+a)/(1-a)),n[r]=t[e+2]}function Jx(t,e,n,r){CUe(t,e,n,r,ts)}function Qx(t,e,n,r){n[r]=t[e]*ete,n[r+1]=t[e+1]*ete,n[r+2]=t[e+2]}function ew(t,e,n,r){n[r]=t[e]*tte,n[r+1]=t[e+1]*tte,n[r+2]=t[e+2]}function NUe(t,e,n,r){nT(t,e,n,r),Qx(n,r,n,r)}function OUe(t,e,n,r){rw(t,e,n,r),Qx(n,r,n,r)}function LUe(t,e,n,r){tw(t,e,n,r),Qx(n,r,n,r)}function DUe(t,e,n,r){ew(t,e,n,r),rT(n,r,n,r)}function $Ue(t,e,n,r){ew(t,e,n,r),Jx(n,r,n,r)}function jUe(t,e,n,r){ew(t,e,n,r),nw(n,r,n,r)}function SB(t,e,n,r,i){const s=i+t[e+2],o=d2*t[e+1],a=d2*t[e],l=Math.cos(o)*s;n[r]=Math.cos(a)*l,n[r+1]=Math.sin(a)*l,n[r+2]=Math.sin(o)*s}function Xee(t,e,n,r){SB(t,e,n,r,Ng.radius)}function Zee(t,e,n,r){SB(t,e,n,r,pd.radius)}function rT(t,e,n,r){SB(t,e,n,r,ts.radius)}function TB(t,e,n,r,i){const s=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(s*s+o*o+a*a),c=tVe(a/(l===0?1:l)),u=Math.atan2(o,s);n[r++]=f2*u,n[r++]=f2*c,n[r]=l-i}function Jee(t,e,n,r){TB(t,e,n,r,Ng.radius)}function Qee(t,e,n,r){TB(t,e,n,r,pd.radius)}function tw(t,e,n,r){TB(t,e,n,r,ts.radius)}function FUe(t,e,n,r){tw(t,e,n,r),Jx(n,r,n,r)}function VUe(t,e,n,r){tw(t,e,n,r),nw(n,r,n,r)}function zUe(t,e,n,r,i){const s=d2*t[e],o=d2*t[e+1],a=t[e+2],l=Math.sin(o),c=Math.cos(o),u=i.radius/Math.sqrt(1-i.eccentricitySquared*l*l);n[r++]=(u+a)*c*Math.cos(s),n[r++]=(u+a)*c*Math.sin(s),n[r++]=(u*(1-i.eccentricitySquared)+a)*l}function nw(t,e,n,r){zUe(t,e,n,r,ts)}function rw(t,e,n,r){const i=AUe,s=t[e],o=t[e+1],a=t[e+2];let l,c,u,h,f,g,v,x,b,T,A,I,R,C,V,M,N,O,F,L,B;l=Math.abs(a),c=s*s+o*o,u=Math.sqrt(c),h=c+a*a,f=Math.sqrt(h),L=Math.atan2(o,s),g=a*a/h,v=c/h,C=i.a2/f,V=i.a3-i.a4/f,v>.3?(x=l/f*(1+v*(i.a1+C+g*V)/f),F=Math.asin(x),T=x*x,b=Math.sqrt(1-T)):(b=u/f*(1-g*(i.a5-C-v*V)/f),F=Math.acos(b),T=1-b*b,x=Math.sqrt(T)),A=1-ts.eccentricitySquared*T,I=ts.radius/Math.sqrt(A),R=i.a6*I,C=u-I*b,V=l-R*x,N=b*C+x*V,M=b*V-x*C,O=M/(R/A+N),F+=O,B=N+M*O/2,a<0&&(F=-F),n[r++]=f2*L,n[r++]=f2*F,n[r]=B}function UUe(t,e,n,r){rw(t,e,n,r),rT(n,r,n,r)}function GUe(t,e,n,r){rw(t,e,n,r),Jx(n,r,n,r)}const tf={source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:li},d2=cI(1),f2=Ume(1),Bge=.5*Math.PI,Zy=ts.radius,ete=Zy*Math.PI/180,tte=180/(Zy*Math.PI);function fI(t,e,n,r,i,s,o=Math.floor(t.length/3)){const a=Gge(e,i);if(a==null)return!1;if(a===li){if(t===r&&n===s)return!0;const c=n+3*o;for(let u=n,h=s;u<c;u++,h++)r[h]=t[u];return!0}const l=n+3*o;for(let c=n,u=s;c<l;c+=3,u+=3)a(t,c,r,u);return!0}const dPt=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:fI},Symbol.toStringTag,{value:"Module"}));function nte(t,e,n,r,i,s){return TP[0]=t,TP[1]=e,TP[2]=n,fI(TP,r,0,i,s,0)}const TP=Zg();function BUe(t,e,n){if(e==null||n==null||n.vcsWkid||uo(e,n)||Lg(e)||Lg(n))return null;const r=jQ(e)/jQ(n);if(r===1)return null;switch(t){case"point":case"esriGeometryPoint":return i=>WUe(i,r);case"polyline":case"esriGeometryPolyline":return i=>qUe(i,r);case"polygon":case"esriGeometryPolygon":return i=>HUe(i,r);case"multipoint":case"esriGeometryMultipoint":return i=>KUe(i,r);case"extent":case"esriGeometryEnvelope":return i=>YUe(i,r);default:return null}}function WUe(t,e){t?.z!=null&&(t.z*=e)}function HUe(t,e){if(t)for(const n of t.rings)for(const r of n)r.length>2&&(r[2]*=e)}function qUe(t,e){if(t)for(const n of t.paths)for(const r of n)r.length>2&&(r[2]*=e)}function KUe(t,e){if(t)for(const n of t.points)n.length>2&&(n[2]*=e)}function YUe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let iT=null,Mk=null,Ck=null,p2=null,c9={};const kB=new nI;function _p(){return!!(Mk?.isLoaded()&&Ck?.isLoaded()&&p2?.isLoaded())}function Wge(){return!!_p()||(tn(kB),$g(),!1)}function Hge(t,e){return!t||!e||hh(t,e)||Wge()}function XUe(t,e){return!hh(t,e)&&!_p()}async function $g(t){iT==null&&(iT=Promise.all([xe(()=>import("./projectOperator-BLojbBpO.js"),__vite__mapDeps([102,103,104])).then(e=>(Mk=e,Mk.load())),xe(()=>import("./projectOperator-TFJA1aai.js"),__vite__mapDeps([105,103,104])).then(e=>(Ck=e,Ck.load())),xe(()=>import("./geographicTransformationUtils-C_QIxt2o.js"),[]).then(e=>(p2=e,p2.load()))])),await iT,hi(t),kB.notify()}function av(t,e,n){return Array.isArray(t)?t.length===0?[]:(Cje(t),u9(t,t[0].spatialReference,e,n)):(a2(t),u9([t],t.spatialReference,e,n)[0])}function u9(t,e,n,r){if(e==null||n==null)return t;if(hh(e,n,r))return t.map(i=>oC(i,e,n));if(r?.geographicTransformation==null&&_4(e))return t.map(i=>oC(i,e,Bt.WGS84)).map(i=>Nk(i,n));if(r?.geographicTransformation==null&&_4(n))return t.map(i=>Nk(i,Bt.WGS84)).map(i=>oC(i,Bt.WGS84,n));if(!_p())throw new Kge;if(!r?.geographicTransformation){if(r?.extendedParams)r={...r,geographicTransformation:p2.getTransformation(e,n,r.areaOfInterestExtent)||new tT};else if(!r?.areaOfInterestExtent){const i=ZUe(e,n);let s=c9[i];s||(s=p2.getTransformation(e,n)||new tT,c9[i]=s),r={geographicTransformation:s}}}return t[0].spatialReference||(t[0].spatialReference=e),t[0]instanceof Ds?Mk.executeMany(t,n,r):Ck.executeMany(t,n,r)}function ZUe(t,e){return[t.wkid?.toString()??"-1",t.wkt?.toString()??"",t.wkt2?.toString()??"",e.wkid?.toString()??"-1",e.wkt?.toString()??"",e.wkt2?.toString()??""].join()}function JUe(t,e){const n=qge([t],e);return n.pending!=null?{pending:n.pending,geometry:null}:n.geometries!=null?{pending:null,geometry:n.geometries[0]}:{pending:null,geometry:null}}function qge(t,e){if(!_p()){for(const n of t)if(n!=null&&!uo(n.spatialReference,e)&&rc(n.spatialReference)&&rc(e)&&!hh(n.spatialReference,e))return tn(kB),{pending:$g(),geometries:null}}return{pending:null,geometries:t.map(n=>n==null?null:uo(n.spatialReference,e)?n:rc(n.spatialReference)&&rc(e)?Nk(n,e):null)}}let Kge=class extends Xe{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function QUe(){iT=null,Mk=null,Ck=null,p2=null,c9={}}const eGe={get loadPromise(){return iT}};function Nk(t,e){try{const n=av(t,e);if(n==null)return null;"xmin"in t&&"xmin"in n&&(n.zmin=t.zmin,n.zmax=t.zmax);const r=BUe(n.type,t.spatialReference,e);return r?.(n),n}catch(n){if(!(n instanceof Kge))throw n;return null}}async function Yge(t,e,n){const r=t.spatialReference;return r!=null&&e!=null&&await Xge(r,e,null,n),Nk(t,e)}function hh(t,e,n){return!(n?.areaOfInterestExtent||n?.extendedParams||n?.geographicTransformation)&&(!!uo(t,e)||rc(t)&&rc(e)&&!!Gge(t,e))}function tGe(t,e){if(uo(t,e))return!0;if(!rc(t)||!rc(e))return!1;const n=C1(t)||kd(t)||DQ(t),r=C1(e)||kd(e)||DQ(e);return n&&r}async function Xge(t,e,n,r){if(_p())return QJ(r);if(Array.isArray(t)){for(const{source:i,dest:s,options:o}of t)if(i&&s&&!hh(i,s,o))return $g(r)}else if(t&&e&&!hh(t,e,n))return $g(r);return QJ(r)}function oC(t,e,n){return t?"x"in t?Zge(t,e,new Jt,n,0):"xmin"in t?n0e(t,e,new Dn,n,0):"rings"in t?t0e(t,e,new yi,n,0):"paths"in t?Qge(t,e,new xs,n,0):"points"in t?Jge(t,e,new Gu,n,0):null:null}function nGe(t,e,n=e.spatialReference,r=0){return n!=null&&t.spatialReference!=null&&Zge(t,t.spatialReference,e,n,r)!=null}function Zge(t,e,n,r,i){ta[0]=t.x,ta[1]=t.y;const s=t.z;return ta[2]=s!==void 0?s:i,fI(ta,e,0,ta,r,0)?(n.x=ta[0],n.y=ta[1],n.spatialReference=r,s!==void 0||Lg(r)?(n.z=ta[2],n.hasZ=!0):(n.z=void 0,n.hasZ=!1),t.m===void 0?(n.m=void 0,n.hasM=!1):(n.m=t.m,n.hasM=!0),n):null}function rGe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&Jge(t,t.spatialReference,e,n,r)!=null}function Jge(t,e,n,r,i){const{points:s,hasZ:o,hasM:a}=t,l=[],c=s.length,u=[];for(const f of s)u.push(f[0],f[1],o?f[2]:i);if(!fI(u,e,0,u,r,0,c))return null;const h=o||Lg(r);for(let f=0;f<c;++f){const g=3*f,v=u[g],x=u[g+1];h&&a?l.push([v,x,u[g+2],s[f][3]]):h?l.push([v,x,u[g+2]]):a?l.push([v,x,s[f][2]]):l.push([v,x])}return n.points=l,n.spatialReference=r,n.hasZ=o,n.hasM=a,n}function iGe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&Qge(t,t.spatialReference,e,n,r)!=null}function Qge(t,e,n,r,i){const{paths:s,hasZ:o,hasM:a}=t,l=[];if(!r0e(s,o??!1,a??!1,e,l,r,i))return null;const c=o||Lg(r);return n.paths=l,n.spatialReference=r,n.hasZ=c,n.hasM=a,n}function e0e(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&t0e(t,t.spatialReference,e,n,r)!=null}function t0e(t,e,n,r,i){const{rings:s,hasZ:o,hasM:a}=t,l=[];if(!r0e(s,o??!1,a??!1,e,l,r,i))return null;const c=o||Lg(r);return n.rings=l,n.spatialReference=r,n.hasZ=c,n.hasM=a,n}function sGe(t,e,n=e.spatialReference,r=0){return t.spatialReference!=null&&n!=null&&n0e(t,t.spatialReference,e,n,r)!=null}function n0e(t,e,n,r,i){const{xmin:s,ymin:o,xmax:a,ymax:l,hasZ:c,hasM:u}=t,h=c?t.zmin:i;if(!nte(s,o,h,e,ta,r))return null;const f=c||Lg(r);n.xmin=ta[0],n.ymin=ta[1],f&&(n.zmin=ta[2]);const g=c?t.zmax:i;return nte(a,l,g,e,ta,r)?(n.xmax=ta[0],n.ymax=ta[1],f&&(n.zmax=ta[2]),u&&(n.mmin=t.mmin,n.mmax=t.mmax),n.spatialReference=r,n):null}function r0e(t,e,n,r,i,s,o=0){const a=new Array;for(const u of t)for(const h of u)a.push(h[0],h[1],e?h[2]:o);if(!fI(a,r,0,a,s,0))return!1;let l=0;i.length=0;const c=e||Lg(s);for(const u of t){const h=new Array;for(const f of u)c&&n?h.push([a[l++],a[l++],a[l++],f[3]]):c?h.push([a[l++],a[l++],a[l++]]):n?(h.push([a[l++],a[l++],f[2]]),l++):(h.push([a[l++],a[l++]]),l++);i.push(h)}return!0}const ta=Zg(),pPt=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:hh,initializeProjection:Xge,isEqualBaseGCS:tGe,isLoaded:_p,isLoadedOrLoad:Wge,isLoadedOrLoadFor:Hge,load:$g,project:av,projectExtent:sGe,projectMany:u9,projectMultipoint:rGe,projectOrLoad:JUe,projectOrLoadMany:qge,projectPoint:nGe,projectPolygon:e0e,projectPolyline:iGe,projectWithZConversion:Yge,projectWithoutEngine:oC,requiresLoad:XUe,test:eGe,tryProjectWithZConversion:Nk,unload:QUe},Symbol.toStringTag,{value:"Module"}));var aC;let h9=aC=class extends Xg(Ot.ofType(yi)){constructor(t){super(t)}clone(){return new aC(this.items.map(t=>t.clone()))}write(t,e){return this.toJSON(e)}toJSON(t){const e=t?.layer?.spatialReference;return e?this.toArray().map(n=>{if(!e.equals(n.spatialReference)){if(!hh(n.spatialReference,e))return t?.messages?.push(new Td("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:t.layer.spatialReference,context:t})),null;const i=new yi;e0e(n,i,e),n=i}const r=n.toJSON(t);return delete r.spatialReference,r}).filter(n=>n!=null):this.toArray().map(n=>n.toJSON(t))}static fromJSON(t,e){const n=new aC;return t.forEach(r=>n.add(yi.fromJSON(r,e))),n}};h9=aC=_([ue("esri.layers.support.PolygonCollection")],h9);const sT=h9;let ff=class extends Xg(uB){constructor(e){super(e),this.id=`focusarea-${uI()}`,this.title=null,this.enabled=!0,this.outline=null,this.geometries=new sT}readGeometries(e,n,r){Array.isArray(e)?this.geometries=sT.fromJSON(e,r):r.origin!=="web-scene"&&r.origin!=="portal-item"||r.hooks?.onAfterLoad?.(()=>this._loadGeometries(W2(e,r),r))}async _loadGeometries(e,n){const r=await Ji(e,{responseType:"json"});this.geometries=sT.fromJSON(r.data,n)}};_([E({type:String,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),E()],ff.prototype,"id",void 0),_([E({type:String,json:{write:!0}})],ff.prototype,"title",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],ff.prototype,"enabled",void 0),_([E({type:SVe,json:{write:!0}})],ff.prototype,"outline",void 0),_([E({type:sT,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new sT(t.items.map(e=>e.clone()))}),yVe({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],ff.prototype,"geometries",void 0),_([sr(["web-scene","portal-item","service"],"geometries")],ff.prototype,"readGeometries",null),ff=_([ue("esri.effects.FocusArea")],ff);const oGe=ff;let tS=class extends Xg(uB){constructor(e){super(e),this.areas=new Ot,this.style="bright"}};_([E({type:Ot.ofType(oGe),nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}},clonable:t=>new Ot(t.items.map(e=>e.clone()))})],tS.prototype,"areas",void 0),_([E({type:["bright","dark"],nonNullable:!0,json:{write:!0}})],tS.prototype,"style",void 0),tS=_([ue("esri.effects.FocusAreas")],tS);const i0e=tS;function aGe(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function lGe(t){return!(!aGe(t)||!$7e(t)?.operations?.supportsEditing||"editingEnabled"in t&&!F7e(t)||Nme(t))}const cGe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,uGe="screenUtils.toPt: input not recognized!",s0e=96;function yPt(t){return t?t/72*s0e:0}function j1(t){return t?72*t/s0e:0}function wi(t){if(typeof t=="string"){const e=t.match(cGe);if(e){const n=Number(e[1]),r=e[3]&&e[3].toLowerCase(),i=t.startsWith("-"),s=r==="px"?j1(n):n;return i?-s:s}return console.warn(uGe),null}return t}function Fs(t=0,e=0){return{x:t,y:e}}function vPt(t){return t?Fs(t.x,t.y):null}function _Pt(t=0,e=0){return[t,e]}function xPt(t=0,e=0,n=0){return[t,e,n]}function wPt(t){return t}function bPt(t){return t}function EPt(t){return t}function SPt(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function o0e(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function hGe(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function dGe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x){const b=new Float32Array(16);return b[0]=t,b[1]=e,b[2]=n,b[3]=r,b[4]=i,b[5]=s,b[6]=o,b[7]=a,b[8]=l,b[9]=c,b[10]=u,b[11]=h,b[12]=f,b[13]=g,b[14]=v,b[15]=x,b}const fGe=o0e();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:fGe,clone:hGe,create:o0e,fromValues:dGe},Symbol.toStringTag,{value:"Module"}));function a0e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function pGe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x,b){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t[6]=a,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=g,t[13]=v,t[14]=x,t[15]=b,t}function bO(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mGe(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function gGe(t,e){return l0e(t,e)||bO(t),t}function l0e(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],v=e[12],x=e[13],b=e[14],T=e[15],A=n*a-r*o,I=n*l-i*o,R=n*c-s*o,C=r*l-i*a,V=r*c-s*a,M=i*c-s*l,N=u*x-h*v,O=u*b-f*v,F=u*T-g*v,L=h*b-f*x,B=h*T-g*x,U=f*T-g*b;let de=A*U-I*B+R*L+C*F-V*O+M*N;return de?(de=1/de,t[0]=(a*U-l*B+c*L)*de,t[1]=(i*B-r*U-s*L)*de,t[2]=(x*M-b*V+T*C)*de,t[3]=(f*V-h*M-g*C)*de,t[4]=(l*F-o*U-c*O)*de,t[5]=(n*U-i*F+s*O)*de,t[6]=(b*R-v*M-T*I)*de,t[7]=(u*M-f*R+g*I)*de,t[8]=(o*B-a*F+c*N)*de,t[9]=(r*F-n*B-s*N)*de,t[10]=(v*V-x*R+T*A)*de,t[11]=(h*R-u*V-g*A)*de,t[12]=(a*O-o*L-l*N)*de,t[13]=(n*L-r*O+i*N)*de,t[14]=(x*I-v*C-b*A)*de,t[15]=(u*C-h*I+f*A)*de,t):null}function yGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],g=e[11],v=e[12],x=e[13],b=e[14],T=e[15];return t[0]=a*(f*T-g*b)-h*(l*T-c*b)+x*(l*g-c*f),t[1]=-(r*(f*T-g*b)-h*(i*T-s*b)+x*(i*g-s*f)),t[2]=r*(l*T-c*b)-a*(i*T-s*b)+x*(i*c-s*l),t[3]=-(r*(l*g-c*f)-a*(i*g-s*f)+h*(i*c-s*l)),t[4]=-(o*(f*T-g*b)-u*(l*T-c*b)+v*(l*g-c*f)),t[5]=n*(f*T-g*b)-u*(i*T-s*b)+v*(i*g-s*f),t[6]=-(n*(l*T-c*b)-o*(i*T-s*b)+v*(i*c-s*l)),t[7]=n*(l*g-c*f)-o*(i*g-s*f)+u*(i*c-s*l),t[8]=o*(h*T-g*x)-u*(a*T-c*x)+v*(a*g-c*h),t[9]=-(n*(h*T-g*x)-u*(r*T-s*x)+v*(r*g-s*h)),t[10]=n*(a*T-c*x)-o*(r*T-s*x)+v*(r*c-s*a),t[11]=-(n*(a*g-c*h)-o*(r*g-s*h)+u*(r*c-s*a)),t[12]=-(o*(h*b-f*x)-u*(a*b-l*x)+v*(a*f-l*h)),t[13]=n*(h*b-f*x)-u*(r*b-i*x)+v*(r*f-i*h),t[14]=-(n*(a*b-l*x)-o*(r*b-i*x)+v*(r*l-i*a)),t[15]=n*(a*f-l*h)-o*(r*f-i*h)+u*(r*l-i*a),t}function vGe(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],g=t[12],v=t[13],x=t[14],b=t[15];return(e*o-n*s)*(h*b-f*x)-(e*a-r*s)*(u*b-f*v)+(e*l-i*s)*(u*x-h*v)+(n*a-r*o)*(c*b-f*g)-(n*l-i*o)*(c*x-h*g)+(r*l-i*a)*(c*v-u*g)}function c0e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],g=e[10],v=e[11],x=e[12],b=e[13],T=e[14],A=e[15];let I=n[0],R=n[1],C=n[2],V=n[3];return t[0]=I*r+R*a+C*h+V*x,t[1]=I*i+R*l+C*f+V*b,t[2]=I*s+R*c+C*g+V*T,t[3]=I*o+R*u+C*v+V*A,I=n[4],R=n[5],C=n[6],V=n[7],t[4]=I*r+R*a+C*h+V*x,t[5]=I*i+R*l+C*f+V*b,t[6]=I*s+R*c+C*g+V*T,t[7]=I*o+R*u+C*v+V*A,I=n[8],R=n[9],C=n[10],V=n[11],t[8]=I*r+R*a+C*h+V*x,t[9]=I*i+R*l+C*f+V*b,t[10]=I*s+R*c+C*g+V*T,t[11]=I*o+R*u+C*v+V*A,I=n[12],R=n[13],C=n[14],V=n[15],t[12]=I*r+R*a+C*h+V*x,t[13]=I*i+R*l+C*f+V*b,t[14]=I*s+R*c+C*g+V*T,t[15]=I*o+R*u+C*v+V*A,t}function _Ge(t,e,n){const r=n[0],i=n[1],s=n[2];if(e===t)t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15];else{const o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],g=e[7],v=e[8],x=e[9],b=e[10],T=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=g,t[8]=v,t[9]=x,t[10]=b,t[11]=T,t[12]=o*r+u*i+v*s+e[12],t[13]=a*r+h*i+x*s+e[13],t[14]=l*r+f*i+b*s+e[14],t[15]=c*r+g*i+T*s+e[15]}return t}function xGe(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function wGe(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o);if(a<=vl())return void a0e(t,e);a=1/a,i*=a,s*=a,o*=a;const l=Math.sin(n),c=Math.cos(n),u=1-c,h=e[0],f=e[1],g=e[2],v=e[3],x=e[4],b=e[5],T=e[6],A=e[7],I=e[8],R=e[9],C=e[10],V=e[11],M=i*i*u+c,N=s*i*u+o*l,O=o*i*u-s*l,F=i*s*u-o*l,L=s*s*u+c,B=o*s*u+i*l,U=i*o*u+s*l,de=s*o*u-i*l,me=o*o*u+c;t[0]=h*M+x*N+I*O,t[1]=f*M+b*N+R*O,t[2]=g*M+T*N+C*O,t[3]=v*M+A*N+V*O,t[4]=h*F+x*L+I*B,t[5]=f*F+b*L+R*B,t[6]=g*F+T*L+C*B,t[7]=v*F+A*L+V*B,t[8]=h*U+x*de+I*me,t[9]=f*U+b*de+R*me,t[10]=g*U+T*de+C*me,t[11]=v*U+A*de+V*me,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function bGe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+h*r,t[7]=l*i+f*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=h*i-a*r,t[11]=f*i-l*r,t}function EGe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-h*r,t[3]=l*i-f*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+h*i,t[11]=l*r+f*i,t}function SGe(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+h*r,t[3]=l*i+f*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=h*i-a*r,t[7]=f*i-l*r,t}function TGe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function kGe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function AGe(t,e,n){if(e===0)return bO(t);let r=n[0],i=n[1],s=n[2],o=Math.sqrt(r*r+i*i+s*s);if(o<=vl())return null;o=1/o,r*=o,i*=o,s*=o;const a=Math.sin(e),l=Math.cos(e),c=1-l;return t[0]=r*r*c+l,t[1]=i*r*c+s*a,t[2]=s*r*c-i*a,t[3]=0,t[4]=r*i*c-s*a,t[5]=i*i*c+l,t[6]=s*i*c+r*a,t[7]=0,t[8]=r*s*c+i*a,t[9]=i*s*c-r*a,t[10]=s*s*c+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function IGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function RGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function PGe(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function u0e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=r+r,l=i+i,c=s+s,u=r*a,h=r*l,f=r*c,g=i*l,v=i*c,x=s*c,b=o*a,T=o*l,A=o*c;return t[0]=1-(g+x),t[1]=h+A,t[2]=f-T,t[3]=0,t[4]=h-A,t[5]=1-(u+x),t[6]=v+b,t[7]=0,t[8]=f+T,t[9]=v-b,t[10]=1-(u+g),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function MGe(t,e){const n=CGe,r=-e[0],i=-e[1],s=-e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=r*r+i*i+s*s+o*o;return h>0?(n[0]=2*(a*o+u*r+l*s-c*i)/h,n[1]=2*(l*o+u*i+c*r-a*s)/h,n[2]=2*(c*o+u*s+a*i-l*r)/h):(n[0]=2*(a*o+u*r+l*s-c*i),n[1]=2*(l*o+u*i+c*r-a*s),n[2]=2*(c*o+u*s+a*i-l*r)),u0e(t,e,n),t}const CGe=Zg();function NGe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function OGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(l*l+c*c+u*u),t}function LGe(t,e){const n=e[0]+e[5]+e[10];let r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function DGe(t,e,n,r){const i=e[0],s=e[1],o=e[2],a=e[3],l=i+i,c=s+s,u=o+o,h=i*l,f=i*c,g=i*u,v=s*c,x=s*u,b=o*u,T=a*l,A=a*c,I=a*u,R=r[0],C=r[1],V=r[2];return t[0]=(1-(v+b))*R,t[1]=(f+I)*R,t[2]=(g-A)*R,t[3]=0,t[4]=(f-I)*C,t[5]=(1-(h+b))*C,t[6]=(x+T)*C,t[7]=0,t[8]=(g+A)*V,t[9]=(x-T)*V,t[10]=(1-(h+v))*V,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function $Ge(t,e,n,r,i){const s=e[0],o=e[1],a=e[2],l=e[3],c=s+s,u=o+o,h=a+a,f=s*c,g=s*u,v=s*h,x=o*u,b=o*h,T=a*h,A=l*c,I=l*u,R=l*h,C=r[0],V=r[1],M=r[2],N=i[0],O=i[1],F=i[2],L=(1-(x+T))*C,B=(g+R)*C,U=(v-I)*C,de=(g-R)*V,me=(1-(f+T))*V,ze=(b+A)*V,Le=(v+I)*M,fe=(b-A)*M,$e=(1-(f+x))*M;return t[0]=L,t[1]=B,t[2]=U,t[3]=0,t[4]=de,t[5]=me,t[6]=ze,t[7]=0,t[8]=Le,t[9]=fe,t[10]=$e,t[11]=0,t[12]=n[0]+N-(L*N+de*O+Le*F),t[13]=n[1]+O-(B*N+me*O+fe*F),t[14]=n[2]+F-(U*N+ze*O+$e*F),t[15]=1,t}function jGe(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,g=i*a,v=i*l,x=s*o,b=s*a,T=s*l;return t[0]=1-h-v,t[1]=u+T,t[2]=f-b,t[3]=0,t[4]=u-T,t[5]=1-c-v,t[6]=g+x,t[7]=0,t[8]=f+b,t[9]=g-x,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function FGe(t,e,n,r,i,s,o){const a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function VGe(t,e,n,r,i){const s=1/Math.tan(e/2);let o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function zGe(t,e,n,r){const i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(i+s);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(i-s)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function UGe(t,e,n,r,i,s,o){const a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}function GGe(t,e,n,r){const i=e[0],s=e[1],o=e[2];let a=i-n[0],l=s-n[1],c=o-n[2];const u=vl();if(Math.abs(a)<u&&Math.abs(l)<u&&Math.abs(c)<u)return void bO(t);let h=1/Math.sqrt(a*a+l*l+c*c);a*=h,l*=h,c*=h;const f=r[0],g=r[1],v=r[2];let x=g*c-v*l,b=v*a-f*c,T=f*l-g*a;h=Math.sqrt(x*x+b*b+T*T),h?(h=1/h,x*=h,b*=h,T*=h):(x=0,b=0,T=0);let A=l*T-c*b,I=c*x-a*T,R=a*b-l*x;h=Math.sqrt(A*A+I*I+R*R),h?(h=1/h,A*=h,I*=h,R*=h):(A=0,I=0,R=0),t[0]=x,t[1]=A,t[2]=a,t[3]=0,t[4]=b,t[5]=I,t[6]=l,t[7]=0,t[8]=T,t[9]=R,t[10]=c,t[11]=0,t[12]=-(x*i+b*s+T*o),t[13]=-(A*i+I*s+R*o),t[14]=-(a*i+l*s+c*o),t[15]=1}function BGe(t,e,n,r){const i=e[0],s=e[1],o=e[2],a=r[0],l=r[1],c=r[2];let u=i-n[0],h=s-n[1],f=o-n[2],g=u*u+h*h+f*f;g>0&&(g=1/Math.sqrt(g),u*=g,h*=g,f*=g);let v=l*f-c*h,x=c*u-a*f,b=a*h-l*u;return g=v*v+x*x+b*b,g>0&&(g=1/Math.sqrt(g),v*=g,x*=g,b*=g),t[0]=v,t[1]=x,t[2]=b,t[3]=0,t[4]=h*b-f*x,t[5]=f*v-u*b,t[6]=u*x-h*v,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=s,t[14]=o,t[15]=1,t}function WGe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function HGe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function qGe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function h0e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function KGe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function YGe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function XGe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ZGe(t,e){if(t===e)return!0;const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],f=t[10],g=t[11],v=t[12],x=t[13],b=t[14],T=t[15],A=e[0],I=e[1],R=e[2],C=e[3],V=e[4],M=e[5],N=e[6],O=e[7],F=e[8],L=e[9],B=e[10],U=e[11],de=e[12],me=e[13],ze=e[14],Le=e[15],fe=vl();return Math.abs(n-A)<=fe*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(r-I)<=fe*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(i-R)<=fe*Math.max(1,Math.abs(i),Math.abs(R))&&Math.abs(s-C)<=fe*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(o-V)<=fe*Math.max(1,Math.abs(o),Math.abs(V))&&Math.abs(a-M)<=fe*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(l-N)<=fe*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(c-O)<=fe*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(u-F)<=fe*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(h-L)<=fe*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(f-B)<=fe*Math.max(1,Math.abs(f),Math.abs(B))&&Math.abs(g-U)<=fe*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(v-de)<=fe*Math.max(1,Math.abs(v),Math.abs(de))&&Math.abs(x-me)<=fe*Math.max(1,Math.abs(x),Math.abs(me))&&Math.abs(b-ze)<=fe*Math.max(1,Math.abs(b),Math.abs(ze))&&Math.abs(T-Le)<=fe*Math.max(1,Math.abs(T),Math.abs(Le))}function JGe(t){const e=vl(),n=t[0],r=t[1],i=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(r*r+o*o+c*c))<=e&&Math.abs(1-(i*i+a*a+u*u))<=e}function QGe(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const eBe=c0e,tBe=h0e;Object.freeze(Object.defineProperty({__proto__:null,add:qGe,adjoint:yGe,copy:a0e,determinant:vGe,equals:ZGe,exactEquals:XGe,frob:HGe,fromQuat:jGe,fromQuat2:MGe,fromRotation:AGe,fromRotationTranslation:u0e,fromRotationTranslationScale:DGe,fromRotationTranslationScaleOrigin:$Ge,fromScaling:kGe,fromTranslation:TGe,fromXRotation:IGe,fromYRotation:RGe,fromZRotation:PGe,frustum:FGe,getRotation:LGe,getScale:OGe,getTranslation:NGe,hasIdentityRotation:QGe,identity:bO,invert:l0e,invertOrIdentity:gGe,isOrthoNormal:JGe,lookAt:GGe,mul:eBe,multiply:c0e,multiplyScalar:KGe,multiplyScalarAndAdd:YGe,ortho:UGe,perspective:VGe,perspectiveFromFieldOfView:zGe,rotate:wGe,rotateX:bGe,rotateY:EGe,rotateZ:SGe,scale:xGe,set:pGe,str:WGe,sub:tBe,subtract:h0e,targetTo:BGe,translate:_Ge,transpose:mGe},Symbol.toStringTag,{value:"Module"}));const v$=()=>St.getLogger("esri.support.basemapUtils");function nBe(){return{}}function rBe(t){for(const e in t){const n=t[e];n&&!n.destroyed&&n.destroy(),delete t[e]}}function iBe(t,e){let n;if(typeof t=="string"){const r=t in OF,i=!r&&t.includes("/");if(!r&&!i){if(cF())v$().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const s=Object.entries(OF).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");v$().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${s}`)}return null}e&&(n=e[t]),n||(n=r?eT.fromId(t):new eT({style:{id:t}}),e&&(e[t]=n))}else n=Fa(eT,t);return n?.destroyed&&(v$().warn("The provided basemap is already destroyed",{basemap:n}),n=null),n}function sBe(t){return new Hu({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const n=[];return"tables"in e&&n.push(e.tables),"layers"in e&&n.push(e.layers),n},itemFilterFunction:e=>{const n=e.parent;return!!n&&"tables"in n&&n.tables.includes(e)}})}function kP(t){for(const e of t.values())e?.destroy();t.clear()}const rte={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function oBe(t){let e=null;if(typeof t=="string")if(t in rte){const n=rte[t];e=new A4({resourceInfo:{data:{layers:[n]}}})}else St.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=Fa(A4,t);return e}function d9(t,e,n){let r,i;if(t)for(let s=0,o=t.length;s<o;s++){if(r=t.at(s),r?.[e]===n)return r;if(r?.type==="group"&&(i=d9(r.layers,e,n),i))return i}}const aBe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.layers=new Ot;const i=a=>{a.parent&&a.removeFromParent()},s=a=>{a.parent=this,this.layerAdded(a),a.type!=="elevation"&&a.type!=="base-elevation"||St.getLogger(this).error(`Layer 'title:${a.title}, id:${a.id}' of type '${a.type}' is not supported as an operational layer and will therefore be ignored.`)},o=a=>{a.parent=null,this.layerRemoved(a)};this.addHandles([this.layers.on("before-add",a=>{if(a.item===this)return a.preventDefault(),void St.getLogger(this).error("#add()","Cannot add layer to itself.");i(a.item)}),this.layers.on("after-add",a=>s(a.item)),this.layers.on("after-remove",a=>o(a.item))])}destroy(){const r=this.layers.toArray();for(const i of r)i.destroy();this.layers.destroy()}removeChildLayer(r){this.layers.remove(r),super.removeChildLayer?.(r)}set layers(r){this._set("layers",fd(r,this._get("layers")))}add(r,i){const s=this.layers;if(i=s.getNextIndex(i),r instanceof gi){const o=r;o.parent===this?this.reorder(o,i):s.add(o,i)}else da(r)?r.then(o=>{this.destroyed||this.add(o,i)}):St.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(r,i){const s=this.layers;let o=s.getNextIndex(i);r.slice().forEach(a=>{a.parent!==this?(s.add(a,o),o+=1):this.reorder(a,o)})}findLayerById(r){return d9(this.layers,"id",r)}findLayerByUid(r){return d9(this.layers,"uid",r)}remove(r){return this.layers.remove(r)}removeMany(r){return this.layers.removeMany(r)}removeAll(){return this.layers.removeAll()}reorder(r,i){return this.layers.reorder(r,i)}layerAdded(r){}layerRemoved(r){}};return _([E()],n.prototype,"layers",null),n=_([ue("esri.support.LayersMixin")],n),n},lBe=new Set(["feature","subtype-group"]);function f9(t,e,n){if(t)for(let r=0,i=t.length;r<i;r++){const s=t.at(r);if(s[e]===n)return s;if(s?.type==="group"){const o=f9(s.tables,e,n);if(o)return o}}}const cBe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.tables=new Ot,this.addHandles([this.tables.on("after-add",i=>{const s=i.item;s.parent&&s.parent!==this&&s.removeFromParent(),s.parent=this,lBe.has(s.type)||St.getLogger(this).error(`Layer 'title:${s.title}, id:${s.id}' of type '${s.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",i=>{i.item.parent=null})])}destroy(){const r=this.tables.toArray();for(const i of r)i.destroy();this.tables.destroy()}removeChildLayer(r){this.tables.remove(r),super.removeChildLayer?.(r)}set tables(r){this._set("tables",fd(r,this._get("tables")))}findTableById(r){return f9(this.tables,"id",r)}findTableByUid(r){return f9(this.tables,"uid",r)}};return _([E()],n.prototype,"tables",null),n=_([ue("esri.support.TablesMixin")],n),n};let Pc=class extends cBe(aBe(tI)){constructor(e){super(e),this.allLayers=new Hu({getCollections:()=>[this.basemap?.baseLayers,this.basemap?.groundLayers,this.ground?.layers,this.layers,this.basemap?.referenceLayers],getChildrenFunction:n=>"layers"in n?n.layers:null}),this.focusAreas=new i0e,this.allTables=sBe(this),this.basemap=null,this.editableLayers=new Hu({getCollections:()=>[this.allLayers],itemFilterFunction:lGe}),this.ground=new A4,this._basemapCache=nBe(),this.addHandles(hc(()=>this.ground,(n,r)=>{r?.parent===this&&(r.parent=null),n.parent=this},{sync:!0}))}destroy(){rBe(this._basemapCache),this._basemapCache=null,this.focusAreas.destroy(),this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=Ci(this.basemap),Ci(this.ground),this._set("ground",null)}castBasemap(e){return iBe(e,this._basemapCache)}castGround(e){return oBe(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(n=>n.id===e)}findTableById(e){return this.allTables.find(n=>n.id===e)}};_([E({readOnly:!0,dependsOn:[]})],Pc.prototype,"allLayers",void 0),_([E({type:i0e,nonNullable:!0,json:{write:{overridePolicy:t=>({enabled:t.areas.length>0,ignoreOrigin:!0})}}})],Pc.prototype,"focusAreas",void 0),_([E({readOnly:!0})],Pc.prototype,"allTables",void 0),_([E({type:eT,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Pc.prototype,"basemap",void 0),_([zs("basemap")],Pc.prototype,"castBasemap",null),_([E({readOnly:!0})],Pc.prototype,"editableLayers",void 0),_([E({type:A4,nonNullable:!0})],Pc.prototype,"ground",void 0),_([zs("ground")],Pc.prototype,"castGround",null),_([E()],Pc.prototype,"undoRedo",void 0),Pc=_([ue("esri.Map")],Pc);const d0e=Pc;let W0=class extends uB{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"row",void 0),_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"column",void 0),_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"rows",void 0),_([E({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],W0.prototype,"columns",void 0),W0=_([ue("esri.CameraLayout")],W0);const f0e=W0;let EO=class{constructor(e,n){this.min=e,this.max=n,this.range=n-e}normalize(e,n=0,r=!1){return ite(this.range,this.min,this.max,e,n,r)}clamp(e,n=0){return cu(e-n,this.min,this.max)+n}monotonic(e,n,r){return e<n?n:n+p9(this.range,e-n,r)}minimalMonotonic(e,n,r){return ite(this.range,e,e+this.range,n,r)}center(e,n,r){return n=this.monotonic(e,n,r),this.normalize((e+n)/2,r)}diff(e,n,r){return this.monotonic(e,n,r)-e}shortestSignedDiff(e,n){e=this.normalize(e);const r=(n=this.normalize(n))-e,i=n<e?this.minimalMonotonic(e,n)-e:n-this.minimalMonotonic(n,e);return Math.abs(r)<Math.abs(i)?r:i}contains(e,n,r){return n=this.minimalMonotonic(e,n),(r=this.minimalMonotonic(e,r))>e&&r<n}};function ite(t,e,n,r,i=0,s=!1){return(r-=i)<e?r+=p9(t,e-r):r>n&&(r-=p9(t,r-n)),s&&r===n&&(r=e),r+i}function p9(t,e,n=0){return Math.ceil((e-n)/t)*t+n}const IPt=new EO(0,2*Math.PI),RPt=new EO(-Math.PI,Math.PI),uBe=new EO(0,360);let $h=class extends ho(qt){constructor(...e){super(...e),this.position=new Jt([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new f0e}normalizeCtorArgs(e,n,r,i){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return n!=null&&(s.heading=n),r!=null&&(s.tilt=r),i!=null&&(s.fov=i),s}return e}writePosition(e,n,r,i){const s=e.clone();s.x=Zl(e.x||0),s.y=Zl(e.y||0),s.z=e.hasZ?Zl(e.z||0):e.z,n[r]=s.write({},i)}readPosition(e,n){const r=new Jt;return r.read(e,n),r.x=Zl(r.x||0),r.y=Zl(r.y||0),r.z=r.hasZ?Zl(r.z||0):r.z,r}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};_([E({type:Jt,json:{write:{isRequired:!0}}})],$h.prototype,"position",void 0),_([Xn("position")],$h.prototype,"writePosition",null),_([sr("position")],$h.prototype,"readPosition",null),_([E({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),zs(t=>uBe.normalize(Zl(t)))],$h.prototype,"heading",void 0),_([E({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),zs(t=>cu(Zl(t),-180,180))],$h.prototype,"tilt",void 0),_([E({type:Number,nonNullable:!0,json:{default:55,write:!0}}),zs(t=>cu(Zl(t,55),1,170))],$h.prototype,"fov",void 0),_([E({type:f0e,nonNullable:!0,json:{read:!1,write:!1}})],$h.prototype,"layout",void 0),$h=_([ue("esri.Camera")],$h);const hBe=$h;function p0e(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function m0e(t){return t.points!==void 0}function g0e(t){return t.x!==void 0&&t.y!==void 0}function y0e(t){return t.paths!==void 0||t.curvePaths!==void 0}function AB(t){return t.rings!==void 0||t.curveRings!==void 0}function m2(t){return t==null?null:t instanceof Ds?t:g0e(t)?Jt.fromJSON(t):y0e(t)?xs.fromJSON(t):AB(t)?yi.fromJSON(t):m0e(t)?Gu.fromJSON(t):p0e(t)?Dn.fromJSON(t):null}function IB(t){return t?g0e(t)?"esriGeometryPoint":y0e(t)?"esriGeometryPolyline":AB(t)?"esriGeometryPolygon":p0e(t)?"esriGeometryEnvelope":m0e(t)?"esriGeometryMultipoint":null:null}const dBe={esriGeometryPoint:Jt,esriGeometryPolyline:xs,esriGeometryPolygon:yi,esriGeometryEnvelope:Dn,esriGeometryMultipoint:Gu,esriGeometryMultiPatch:yi};function fBe(t){return t&&dBe[t]||null}const pBe=kl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),MPt=kl()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),RB={base:Ds,key:"type",typeMap:{extent:Dn,multipoint:Gu,point:Jt,polyline:xs,polygon:yi}};function CPt(t){return t.type==="point"}function NPt(t){return t.type==="multipoint"}function OPt(t){return t.type==="polygon"}function LPt(t){return t.type==="polyline"}var m9;let mm=m9=class extends qt{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new m9({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};_([E({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:_$}}}}})],mm.prototype,"rotation",void 0),_([zs("rotation")],mm.prototype,"castRotation",null),_([E({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:_$}}}}})],mm.prototype,"scale",void 0),_([E({types:RB,json:{read:m2,write:!0,origins:{"web-scene":{read:m2,write:{overridePolicy:_$}}}}})],mm.prototype,"targetGeometry",void 0),_([E({type:hBe,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],mm.prototype,"camera",void 0),mm=m9=_([ue("esri.Viewpoint")],mm);const tu=mm;function _$(){return{enabled:!this.camera}}let Ok=class{constructor(e=n=>n.values().next().value){this._peeker=e,this._observable=new nI,this._items=new Set}get length(){return tn(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return tn(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const n=this.length;return this._items.forEach(r=>{e(r)||this._items.delete(r)}),n!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){tn(this._observable),yield*this._items}};const v0e=new FinalizationRegistry(t=>{t.close()});function mBe(t,e){v0e.register(t,e,e)}function gBe(t){v0e.unregister(t)}function _0e(t,e){return new Proxy({},{get:(n,r,i)=>(...s)=>{let o,a;const l=s[s.length-1];return yBe(l)&&(o=l.signal,a=l.transferList,s.pop()),t.apply(e?`${e}.${r.toString()}`:r.toString(),s,{transferList:a,signal:o})}})}function yBe(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const vBe={statsWorker:()=>xe(()=>import("./statsWorker-CE_NTb9P.js"),__vite__mapDeps([106,107,108,109,29,30,110,111,37])),geometryEngineWorker:()=>xe(()=>import("./geometryEngineWorker-BkMQzpX8.js"),__vite__mapDeps([112,113,114,26])),arcadeGeometryOperatorsWorker:()=>xe(()=>import("./operatorsWorker-COKtWLMa.js"),[]),CSVSourceWorker:()=>xe(()=>import("./CSVSourceWorker-DoqYCXnD.js"),__vite__mapDeps([115,116,50,49,117,118,51,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,133,134,135,19])),EdgeProcessingWorker:()=>xe(()=>import("./EdgeProcessingWorker-CH8kmGf6.js"),__vite__mapDeps([136,137,138,139,29,30,140,141,142,143,144,145,146])),ElevationSamplerWorker:()=>xe(()=>import("./ElevationSamplerWorker-CYZCpJBA.js"),__vite__mapDeps([147,120,148,149,150,151,152,153,154,139,29,30,155])),FeatureServiceSnappingSourceWorker:()=>xe(()=>import("./FeatureServiceSnappingSourceWorker-DHy1nXEO.js"),__vite__mapDeps([156,117,118,50,49,51,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,7,8,157,47,48,46,52])),GaussianSplatSortWorker:()=>xe(()=>import("./GaussianSplatSortWorker-CkystscD.js"),[]),GeoJSONSourceWorker:()=>xe(()=>import("./GeoJSONSourceWorker-aTkS9puX.js"),__vite__mapDeps([158,118,50,49,51,117,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,159,116,135,19,160])),LercWorker:()=>xe(()=>import("./LercWorker-BMKtRBmE.js"),[]),MemorySourceWorker:()=>xe(()=>import("./MemorySourceWorker-BiiyIMCp.js"),__vite__mapDeps([161,118,50,49,51,162,117,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,135,19,160,116])),PBFDecoderWorker:()=>xe(()=>import("./PBFDecoderWorker-DqUUN6he.js"),__vite__mapDeps([163,164,49,118,50,51,47,48])),FeaturePipelineWorker:()=>xe(()=>import("./FeaturePipelineWorker-DKcLqKMn.js"),__vite__mapDeps([165,22,166,167,168,141,169,170,127,128,40,39,171,50,49,118,51,172,108,173,33,34,174,122,121,175,176,177,178,179,180,181,182,18,19,183,184,185,186,123,124,125,35,36,126,129,107,109,29,30,110,111,37,130,131,132,187,188,189,190,104,191,192,193,194,195,159,116,135,160,46,47,48,52,196,197])),PointCloudWorker:()=>xe(()=>import("./PointCloudWorker-Ddsj3Fe2.js"),__vite__mapDeps([198,199,200,29,201,202,20,14,203,204,30,150,151,205,206])),RasterWorker:()=>xe(()=>import("./RasterWorker-EnGGpVKf.js"),__vite__mapDeps([207,25,24,26,27,28,29,30,208,209,210,13,211,38])),SceneLayerSnappingSourceWorker:()=>xe(()=>import("./SceneLayerSnappingSourceWorker-pRh7CP_i.js"),__vite__mapDeps([212,213,214,30,206,200,215,216,29,205,139,143,144,145,138,140,141,142,146])),SceneLayerWorker:()=>xe(()=>import("./SceneLayerWorker-D2smY9OK.js"),__vite__mapDeps([217,148,154,218,152])),WFSSourceWorker:()=>xe(()=>import("./WFSSourceWorker-B5-SS-W7.js"),__vite__mapDeps([219,118,50,49,51,117,119,120,121,122,123,124,125,35,36,126,127,128,40,129,108,107,109,29,30,110,111,37,130,131,132,39,159,116,160,220,221])),WorkerTileHandler:()=>xe(()=>import("./WorkerTileHandler-7yAqIO--.js"),__vite__mapDeps([222,181,223,182,224,48,49,184,225,226,142,141,28,29,30,227,180])),Lyr3DWorker:()=>xe(()=>import("./Lyr3DWorker-cZB6xN22.js"),[]),Feature3DPipelineWorker:()=>xe(()=>import("./Feature3DPipelineWorker-BpN3NLA0.js"),__vite__mapDeps([228,124,118,50,49,51,125,35,36,126,127,128,40,121,122,129,108,107,109,29,30,110,111,37,130,131,132,39,229,230,11,12,13,14,15,8,16,17,18,19,20,176,170,33,34,231,21,22,23,232,153,148,218,152,233,201,234,145,139,235,214,206,200,213,236,237,216,205,204,199,150,151,142,141,138,140,238,239,240,241,242,243,244,245,246,247,120,46,47,48,52,248])),TextureCompressionWorker:()=>xe(()=>import("./TextureCompressionWorker-gRReLtiq.js"),[]),FlowWorker:()=>xe(()=>import("./FlowWorker-BvjtECDI.js"),__vite__mapDeps([249,38])),ParquetSourceWorker:()=>xe(()=>import("./ParquetSourceWorker-DSYsPE4q.js"),__vite__mapDeps([250,186,124,118,50,49,51,125,35,36,126,127,128,40,121,122,129,108,107,109,29,30,110,111,37,130,131,132,39,135,19,251,134,189,171,172,188,187])),PanoramicMeshWorker:()=>xe(()=>import("./PanoramicMeshWorker-C-bCIqBr.js"),__vite__mapDeps([252,25]))},x0e="worker:port-closed",Yf={HANDSHAKE:0,OPEN:1,OPENED:2,RESPONSE:3,INVOKE:4,ABORT:5,CLOSE:6,OPEN_PORT:7,ON:8};let _Be=0;function w0e(){return _Be++}function xBe(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function P4(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function b0e(t,e,n,r){if(e.type===Yf.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==Yf.INVOKE&&e.type!==Yf.RESPONSE)return void t.postMessage(e);let i;xBe(n)?(i=ste(n.transferList),e.data=n.result):(i=ste(r),e.data=n),i?t.postMessage(e,i):t.postMessage(e)}function Lk(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function ste(t){if(!t?.length)return null;if(ve("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(n=>!wBe(n));return e.length?e:null}function wBe(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"}async function $Pt(t){try{return await t}catch(e){const n=e?.name===x0e;if(!(ya(e)||n))throw e;return}}const{CLOSE:AP,ABORT:g9,INVOKE:ote,RESPONSE:wE,OPEN_PORT:ate,ON:lte}=Yf,bBe=2;let EBe=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===g9?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}};var zc;let g2=(zc=class{static connect(e,n){const r=new MessageChannel;let i;i=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const s=new zc(r.port1,{channel:r,client:i,schedule:n});return typeof i=="object"&&"remoteClient"in i&&(i.remoteClient=s),zc.clients.set(s,i),r.port2}static loadWorker(e){const n=vBe[e];return n?n():Promise.resolve(null)}constructor(e,n,r,i){this._port=e,this._jobQueue=r,this._lowPriorityJobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new EBe(s=>this._onInvokeMessage(s)),this._client=n.client,this._onMessage=this._onMessage.bind(this),this._channel=n.channel,this._schedule=n.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:AP}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,n,r){return this.apply(e,[n],r)}apply(e,n,r){const i=r?.signal,s=r?.transferList;if(!this._port)return Promise.reject(new Xe(x0e,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:n}));const o=w0e();return new Promise((a,l)=>{if(ha(i))return this._processWork(),void l(Tr());const c=lu(i,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),Qr(h.abortHandle),this._post({type:g9,jobId:o}),l(Tr()))}),u={resolve:a,reject:l,abortHandle:c,debugInfo:e};this._outJobs.set(o,u),this._post({type:ote,jobId:o,methodName:e,abortable:i!=null},n,s)})}createInvokeProxy(e){return _0e(this,e)}on(e,n){const r=new MessageChannel;function i(s){n(s.data)}return this._port.postMessage({type:lte,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",i),r.port1.start(),qn(()=>{r.port1.postMessage({type:AP}),r.port1.close(),r.port1.removeEventListener("message",i)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:ate,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=bBe)return;const e=this._jobQueue?.pop()??this._lowPriorityJobQueue?.pop();if(!e)return;const{methodName:n,data:r,invokeOptions:i,resolver:s}=e;this.apply(n,r,i).then(o=>s.resolve(o)).catch(o=>s.reject(o))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{Qr(e.abortHandle),e.reject(Tr(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null,this._onMessage=null,this._channel=null,this._jobQueue=void 0,this._invokeQueue=void 0,this._lowPriorityJobQueue=void 0}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,n){const r=Lk(e);if(r)switch(r.type){case wE:this._onResponseMessage(r);break;case ote:n?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case g9:this._onAbortMessage(r);break;case AP:this._onCloseMessage();break;case ate:this._onOpenPortMessage(r);break;case lte:this._onOnMessage(r)}}_onAbortMessage(e){const n=this._inJobs,r=e.jobId,i=n.get(r);this._invokeQueue.push(e),i&&(i.controller&&i.controller.abort(),n.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&zc.clients.get(this)===e&&e.destroy(),zc.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:n,jobId:r,data:i=[],abortable:s}=e,o=s?new AbortController:null,a=this._inJobs;let l,c=this._client,u=c[n];try{if(!u&&n&&n.includes(".")){const h=n.split(".");for(let f=0;f<h.length-1;f++)c=c[h[f]],u=c[h[f+1]]}if(typeof u!="function")throw new TypeError(`${n} is not a function`);i.push({client:this,signal:o?o.signal:null}),l=u.apply(c,i)}catch(h){return void this._post({type:wE,jobId:r,error:P4(h)})}da(l)?(a.set(r,{controller:o,promise:l}),l.then(h=>{a.has(r)&&(a.delete(r),this._post({type:wE,jobId:r},h))},h=>{a.has(r)&&(a.delete(r),ya(h)||this._post({type:wE,jobId:r,error:P4(h||{message:`Error encountered at method ${n}`})}))})):this._post({type:wE,jobId:r},l)}_onOpenPortMessage(e){new zc(e.port,{client:this._client})}_onOnMessage(e){const{port:n}=e,r=this._client.on(e.eventType,s=>{n.postMessage(s)}),i=B2(e.port,"message",s=>{Lk(s)?.type===AP&&(i.remove(),r.remove(),n.close())})}_onResponseMessage(e){const{jobId:n,error:r,data:i}=e,s=this._outJobs;if(!s.has(n))return;const o=s.get(n);s.delete(n),this._processWork(),Qr(o.abortHandle),r?o.reject(Xe.fromJSON(JSON.parse(r))):o.resolve(i)}_post(e,n,r){return b0e(this._port,e,n,r)}},zc.kernelInfo={buildDate:Ade,fullVersion:vG,revision:Ide},zc.clients=new Map,zc),SBe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Ok,this._ongoingLowPriorityJobsQueue=new Ok}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,n){return new Promise((r,i)=>{let s=!0;const o=a=>{hi(n.signal),s&&(s=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];da(l)?this._clientPromises[a]=l.then(c=>(this._clients[a]=new g2(c,n,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),o(r),this._clients[a]),()=>(o(i),null)):(this._clients[a]=new g2(l,n,this._ongoingJobsQueue,this._ongoingLowPriorityJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(r))}})}broadcast(e,n,r){const i=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];i[s]=o.then(a=>a?.invoke(e,n,r))}return i}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(Tr(`Worker closing, aborting job calling '${e.methodName}'`));for(;e=this._ongoingLowPriorityJobsQueue.pop();)e.resolver.reject(Tr(`Worker closing, aborting job calling '${e.methodName}'`));for(const n of this._clientPromises)n.then(r=>r?.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,gBe(this)}invoke(e,n,r){return this.apply(e,[n],r)}apply(e,n,r){const i=uc();(r?.priority==="low"?this._ongoingLowPriorityJobsQueue:this._ongoingJobsQueue).push({methodName:e,data:n,invokeOptions:r,resolver:i});for(let s=0;s<this._clientPromises.length;s++){const o=this._clients[s];o?o.jobAdded():this._clientPromises[s].then(a=>a?.jobAdded())}return i.promise}createInvokeProxy(e){return _0e(this,e)}on(e,n){return Promise.all(this._clientPromises).then(()=>rv(this._clients.map(r=>r.on(e,n))))}openPorts(){return new Promise(e=>{const n=new Array(this._clientPromises.length);let r=n.length;for(let i=0;i<this._clientPromises.length;++i)this._clientPromises[i].then(s=>{s&&(n[i]=s.openPort()),--r===0&&e(n)})})}get test(){}};const TBe={async request(t,e){const n=t.options,r=n.responseType;n.signal=e?.signal,n.responseType=r==="native"||r==="native-request-init"?"native-request-init":r&&["blob","json","text"].includes(r)&&rF(t.url)?.after?r:"array-buffer";const i=await Ji(t.url,n),s={data:i.data,httpStatus:i.httpStatus,ssl:i.ssl};switch(i.requestOptions?.responseType){case"native-request-init":return delete s.data.signal,s;case"blob":s.data=await s.data.arrayBuffer();break;case"json":s.data=new TextEncoder().encode(JSON.stringify(s.data)).buffer;break;case"text":s.data=new TextEncoder().encode(s.data).buffer}return{result:s,transferList:[s.data]}}},cte={};function kBe(t){const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages?.slice()||[],paths:{...cte.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=cte.baseUrl),e}let ABe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(n=>{this[n]=(...r)=>e[n](...r)})}},lC=class{constructor(){this._dispatcher=new ABe,this._workerPostMessage({type:Yf.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){l4(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,n,r){this._dispatcher.addEventListener(e,n,r)}removeEventListener(e,n,r){this._dispatcher.removeEventListener(e,n,r)}_workerPostMessage(e){l4(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const n=Lk(e);if(n&&n.type===Yf.OPEN){const{modulePath:r,jobId:i}=n;let s=await g2.loadWorker(r);s||(s=await import(r));const o=g2.connect(s);this._workerPostMessage({type:Yf.OPENED,jobId:i,data:o})}}};const y9=()=>St.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:IBe}=Yf,RBe='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}).finally(()=>{t&&t.removeEventListener("abort",s)})}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://esriurl.com/using-local-assets.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||new Promise(e=>{require([o.modulePath],e)})).then(t)}):"System"in self&&"function"==typeof System.import?System.import(workerPath).then(e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath))).then(e=>e||System.import(o.modulePath)).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(e=>e||import(o.modulePath)).then(t)}):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let IP,RP;const ute="Failed to create Worker. Fallback to execute module in main thread";async function PBe(){if(!ve("esri-workers"))return hte(new lC);if(!IP&&!RP)try{const e=RBe.split("{CONFIGURATION}").join(MBe());IP=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){RP=e||{}}let t;if(IP)try{t=new Worker(IP,{name:"esri-worker-"+CBe++})}catch{y9().warn(ute,RP),t=new lC}else y9().warn(ute,RP),t=new lC;return hte(t)}async function hte(t){return new Promise(e=>{function n(i){const s=Lk(i);s&&s.type===IBe&&(t.removeEventListener("message",n),t.removeEventListener("error",r),e(t))}function r(i){i.preventDefault(),t.removeEventListener("message",n),t.removeEventListener("error",r),y9().warn("Failed to create Worker. Fallback to execute module in main thread",i),(t=new lC).addEventListener("message",n),t.addEventListener("error",r)}t.addEventListener("message",n),t.addEventListener("error",r)})}function MBe(){let t;if(Qn.default!=null){const i={...Qn};delete i.default,t=JSON.parse(JSON.stringify(i))}else t=JSON.parse(JSON.stringify(Qn));t.assetsPath=Bc(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?Bc(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=eu(),t.has={"esri-csp-restrictions":ve("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ve("esri-2d-update-debug"),"esri-2d-log-updating":ve("esri-2d-log-updating"),"featurelayer-pbf":ve("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":ve("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":ve("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ve("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ve("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":ve("featurelayer-query-max-depth"),"featurelayer-query-tile-max-features":ve("featurelayer-query-tile-max-features"),"featurelayer-query-tile-concurrency":ve("featurelayer-query-tile-concurrency"),"featurelayer-query-pausing-enabled":ve("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-concurrency":ve("featurelayer-snapshot-concurrency"),"featurelayer-snapshot-enabled":ve("featurelayer-snapshot-enabled"),"parquetlayer-full-query-feature-count":ve("parquetlayer-full-query-feature-count"),"esri-atomics":ve("esri-atomics"),"esri-shared-array-buffer":ve("esri-shared-array-buffer"),"esri-tiles-debug":ve("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ve("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ve("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=Bc(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=Bc(t.workers.workerPath):t.workers.workerPath=Bc(Ui("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Qn.workers.loaderConfig,n=kBe({baseUrl:e?.baseUrl,locale:eu(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e?.has},map:{...e?.map},paths:{...e?.paths},packages:e?.packages||[]});return JSON.stringify({esriConfig:t,loaderConfig:n,kernelInfo:{buildDate:Ade,fullVersion:vG,revision:Ide}})}let CBe=0;const{ABORT:dte,INVOKE:NBe,OPEN:OBe,OPENED:LBe,RESPONSE:bE}=Yf;let DBe=class E0e{static async create(e){const n=await PBe();return new E0e(n,e)}constructor(e,n){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=n,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",r=>{r.preventDefault(),St.getLogger("esri.core.workers.WorkerOwner").error(r)})}terminate(){this.worker.terminate()}async open(e,n={}){const{signal:r}=n,i=w0e();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:_G(r,()=>{this._outJobs.delete(i),this._post({type:dte,jobId:i})})};this._outJobs.set(i,a),this._post({type:OBe,jobId:i,modulePath:e})})}_onMessage(e){const n=Lk(e);if(n)switch(n.type){case LBe:this._onOpenedMessage(n);break;case bE:this._onResponseMessage(n);break;case dte:this._onAbortMessage(n);break;case NBe:this._onInvokeMessage(n)}}_onAbortMessage(e){const n=this._inJobs,r=e.jobId,i=n.get(r);i&&(i.controller&&i.controller.abort(),n.delete(r))}_onInvokeMessage(e){const{methodName:n,jobId:r,data:i,abortable:s}=e,o=s?new AbortController:null,a=this._inJobs,l=TBe[n];let c;try{if(typeof l!="function")throw new TypeError(`${n} is not a function`);c=l.call(null,i,{signal:o?o.signal:null})}catch(u){return void this._post({type:bE,jobId:r,error:P4(u)})}da(c)?(a.set(r,{controller:o,promise:c}),c.then(u=>{a.has(r)&&(a.delete(r),this._post({type:bE,jobId:r},u))},u=>{a.has(r)&&(a.delete(r),u||(u={message:"Error encountered at method"+n}),ya(u)||this._post({type:bE,jobId:r,error:P4(u||{message:`Error encountered at method ${n}`})}))})):this._post({type:bE,jobId:r},c)}_onOpenedMessage(e){const{jobId:n,data:r}=e,i=this._outJobs.get(n);i&&(this._outJobs.delete(n),Qr(i.abortHandle),i.resolve(r))}_onResponseMessage(e){const{jobId:n,error:r,data:i}=e,s=this._outJobs.get(n);s&&(this._outJobs.delete(n),Qr(s.abortHandle),r?s.reject(Xe.fromJSON(JSON.parse(r))):s.resolve(i))}_post(e,n,r){return b0e(this.worker,e,n,r)}};const fte=ve("host-browser")?Math.min(navigator.hardwareConcurrency-1,ve("workers-pool-size")??8):0;let My=ve("esri-mobile")?Math.min(fte,3):fte;My||(My=ve("safari")&&ve("mac")?7:2);let pte=0;const cC=[];function $Be(){S0e()}async function PP(t,e){const n=new SBe,{registryTarget:r,...i}=e;return await n.open(t,i),r&&mBe(r,n),n}async function UPt(t,e={}){if(typeof t!="string")throw new Xe("workers:undefined-module","modulePath is missing");let n=e.strategy||"distributed";if(ve("host-webworker")&&!ve("esri-workers")&&(n="local"),n==="local"){let r=await g2.loadWorker(t);r||(r=await import(t)),hi(e.signal);const i=e.client||r;return PP([g2.connect(r,e.schedule)],{...e,client:i})}if(await S0e(),hi(e.signal),n==="dedicated"){const r=pte++%My;return PP([await cC[r].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const r=Math.min(e.maxNumWorkers,My);if(r<My){const i=new Array(r);for(let s=0;s<r;++s){const o=pte++%My;i[s]=cC[o].open(t,e)}return PP(i,e)}}return PP(cC.map(r=>r.open(t,e)),e)}let MP=null;async function S0e(){if(MP)return MP;new AbortController;const t=[];for(let e=0;e<My;e++){const n=DBe.create(e).then(r=>(cC[e]=r,r));t.push(n)}return MP=Promise.all(t),MP}let oT=class extends Ot{constructor(e){super(e),this.addHandles([this.on("before-add",n=>{n.item==null&&n.preventDefault()}),this.on("after-add",n=>this._own(n.item)),this.on("after-remove",n=>this._release(n.item))])}get owner(){return this._get("owner")}set owner(e){this.destroyed||e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Ot.ofType(this.itemType.Type))(e):new Ot(e)}};function v9(t,e){return{type:t,cast:Nfe,set(n){const r=fd(n,this._get(e),t);r&&!r.destroyed&&(r.owner=this),this._set(e,r)}}}_([E()],oT.prototype,"owner",null),oT=_([ue("esri.core.support.OwningCollection")],oT);var _9,mw;let So=(mw=class extends qt{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new _9({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}},_9=mw,mw);_([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],So.prototype,"cols",void 0),_([E({type:Or,json:{write:!0}})],So.prototype,"level",void 0),_([E({type:String,json:{write:!0}})],So.prototype,"levelValue",void 0),_([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],So.prototype,"origin",void 0),_([E({type:Number,json:{write:!0}})],So.prototype,"resolution",void 0),_([E({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],So.prototype,"rows",void 0),_([E({type:Number,json:{write:!0}})],So.prototype,"scale",void 0),So=_9=_([ue("esri.layers.support.LOD")],So);let jBe=class T0e{constructor(e,n,r,i=pl()){this._level=e,this._row=n,this._col=r,this.extent=i}get id(){return this._id??=`${this.level}/${this.row}/${this.col}`,this._id}get level(){return this._level}set level(e){this._level=e,this._id=null}get row(){return this._row}set row(e){this._row=e,this._id=null}get col(){return this._col}set col(e){this._col=e,this._id=null}toJSON(){return{level:this._level,row:this._row,col:this._col,extent:this.extent}}static fromJSON(e){return new T0e(e.level,e.row,e.col,e.extent)}};var U_;const mte=new Gs({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});var gw;let xa=(gw=class extends qt{static create(e={}){const{resolutionFactor:n=1,scales:r,size:i=256,spatialReference:s=Bt.WebMercator,numLODs:o=24}=e;if(!rc(s)){const f=[];if(r)for(let g=0;g<r.length;g++){const v=r[g];f.push(new So({level:g,scale:v,resolution:v}))}else{let g=5e-4;for(let v=o-1;v>=0;v--)f.unshift(new So({level:v,scale:g,resolution:g})),g*=2}return new U_({dpi:96,lods:f,origin:new Jt(0,0,s),size:[i,i],spatialReference:s})}const a=La(s),l=e.origin?new Jt({x:e.origin.x,y:e.origin.y,spatialReference:s}):new Jt(a?{x:a.origin[0],y:a.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),c=96,u=1/(Dd(s)*39.37*c),h=[];if(r)for(let f=0;f<r.length;f++){const g=r[f],v=g*u;h.push(new So({level:f,scale:g,resolution:v}))}else{let f=X2(s)?512/i*5916575275917094e-7:256/i*591657527591555e-6;const g=Math.ceil(o/n);h.push(new So({level:0,scale:f,resolution:f*u}));for(let v=1;v<g;v++){const x=f/2**n,b=x*u;h.push(new So({level:v,scale:x,resolution:b})),f=x}}return new U_({dpi:c,lods:h,origin:l,size:[i,i],spatialReference:s})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:n}=this;if(e&&n){const r=La(e);return e.isWrappable&&!!r&&Math.abs(r.origin[0]-n.x)<=r.dx}return!1}readOrigin(e,n){return Jt.fromJSON({spatialReference:n.spatialReference,...e})}set lods(e){let n=0,r=0;const i=[],s=this._levelToLOD={};e&&(n=-1/0,r=1/0,e.forEach(o=>{i.push(o.scale),n=o.scale>n?o.scale:n,r=o.scale<r?o.scale:r,s[o.level]=o})),this._set("scales",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,n){return[n.cols,n.rows]}writeSize(e,n){n.cols=e[0],n.rows=e[1]}zoomToScale(e){const n=this.scales;if(e<=0)return n[0];if(e>=n.length-1)return n[n.length-1];const r=Math.floor(e),i=r+1;return n[r]/(n[r]/n[i])**(e-r)}scaleToZoom(e){const n=this.scales,r=n.length-1;let i=0;for(;i<r;i++){const s=n[i],o=n[i+1];if(s<=e)return i;if(o===e)return i+1;if(s>e&&o<e)return i+Math.log(s/e)/Math.log(s/o)}return i}tileAt(e,n,r,i){const s=this.lodAt(e);if(!s)return null;let o,a;if(typeof n=="number")o=n,a=r;else if(uo(n.spatialReference,this.spatialReference))o=n.x,a=n.y,i=r;else{const u=lO(n,this.spatialReference);if(u==null)return null;o=u.x,a=u.y,i=r}const l=s.resolution*this.size[0],c=s.resolution*this.size[1];return i??=new jBe(0,0,0),i.level=e,i.row=Math.floor((this.origin.y-a)/c+.001),i.col=Math.floor((o-this.origin.x)/l+.001),this.updateTileInfo(i),i}updateTileInfo(e,n=0){if(!("extent"in e))return!1;let r=this.lodAt(e.level);if(!r&&n===1){const a=this.lods[this.lods.length-1];a.level<e.level&&(r=a)}if(!r)return!1;const i=e.level-r.level,s=r.resolution*this.size[0]/2**i,o=r.resolution*this.size[1]/2**i;return e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+o,!0}upsampleTile(e){const n=this._upsampleLevels[e.level];return!(!n||n.parentLevel===-1)&&(e.level=n.parentLevel,e.row=Math.floor(e.row/n.factor+.001),e.col=Math.floor(e.col/n.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,n){const r=this.lodAt(n.level);if(r==null)return null;const{resolution:i}=r,s=i*this.size[0],o=i*this.size[1];return e[0]=this.origin.x+n.col*s,e[1]=this.origin.y-(n.row+1)*o,e[2]=e[0]+s,e[3]=e[1]+o,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return U_.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||this.size[0]===256&&e===512)return null;const n=(this.size[0]===512&&e===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&n===0)return this;const r=[],i=this.lods.length-n;for(let s=0;s<i;s++){const o=s+n,{scale:a,resolution:l}=o>=0?this.lods[o]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};r.push(new So({level:s,scale:a,resolution:l}))}return new U_({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:r})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let n=null;for(let r=0;r<e.length;r++){const i=e[r];this._upsampleLevels[i.level]={parentLevel:n?n.level:-1,factor:n?n.resolution/i.resolution:0},n=i}}},U_=gw,gw);_([E({type:Number,json:{write:!0}})],xa.prototype,"compressionQuality",void 0),_([E({type:Number,json:{write:!0}})],xa.prototype,"dpi",void 0),_([E({type:String,json:{read:mte.read,write:mte.write,origins:{"web-scene":{read:!1,write:!1}}}})],xa.prototype,"format",void 0),_([E({readOnly:!0})],xa.prototype,"isWrappable",null),_([E({type:Jt,json:{write:!0}})],xa.prototype,"origin",void 0),_([sr("origin")],xa.prototype,"readOrigin",null),_([E({type:[So],value:null,json:{write:!0}})],xa.prototype,"lods",null),_([E({readOnly:!0})],xa.prototype,"scales",void 0),_([E({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],xa.prototype,"size",void 0),_([sr("size",["rows","cols"])],xa.prototype,"readSize",null),_([Xn("size",{cols:{type:Or},rows:{type:Or}})],xa.prototype,"writeSize",null),_([E({type:Bt,json:{write:!0}})],xa.prototype,"spatialReference",void 0),xa=U_=_([ue("esri.layers.support.TileInfo")],xa);let y2=class extends oT{constructor(e){super(e),this.addHandles(this.on("before-add",n=>{n.item!=null&&n.item.parent===this.owner&&(St.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),n.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};y2=_([ue("esri.support.AnalysesCollection")],y2);const uC={widthBreakpoint:{getValue(t){const e=t.viewSize[0],n=t.breakpoints,r=this.values;return e<=n.xsmall?r.xsmall:e<=n.small?r.small:e<=n.medium?r.medium:e<=n.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],n=t.breakpoints,r=this.values;return e<=n.xsmall?r.xsmall:e<=n.small?r.small:e<=n.medium?r.medium:e<=n.large?r.large:r.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,n=e[0],r=e[1],i=this.values;return r>=n?i.portrait:i.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},x$={xsmall:544,small:768,medium:992,large:1200};function FBe(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function w$(t,e){return e?uC[t].valueToClassName[e].split(" "):[]}const VBe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=x$}initialize(){this.addHandles(dn(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),fa))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(r){if(r!==this._get("breakpoints")){if(!FBe(r)){const i=JSON.stringify(x$,null,2);console.warn("provided breakpoints are not valid, using defaults:"+i),r=x$}this._set("breakpoints",{...r})}}_updateClassNames(){if(!this.container)return;const r=Aa.acquire(),i=Aa.acquire();let s,o=!1;for(s in uC){const a=this[s],l=uC[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==l&&(o=!0,this[s]=l,w$(s,a).forEach(c=>i.push(c)),w$(s,l).forEach(c=>r.push(c)))}o&&(this._applyClassNameChanges(r,i),Aa.release(r),Aa.release(i))}_applyClassNameChanges(r,i){const s=this.container;s&&(i.forEach(o=>s.classList.remove(o)),r.forEach(o=>s.classList.add(o)))}_removeActiveClassNames(){const r=this.container;if(!r)return;let i;for(i in uC)w$(i,this[i]).forEach(s=>r.classList.remove(s))}};return _([E()],n.prototype,"breakpoints",null),_([E()],n.prototype,"orientation",void 0),_([E()],n.prototype,"widthBreakpoint",void 0),_([E()],n.prototype,"heightBreakpoint",void 0),n=_([ue("esri.views.BreakpointsOwner")],n),n};function PB(t){return typeof t=="string"?document.getElementById(t):t??null}function gte(t,e){for(;;){const n=t.firstChild;if(!n)break;e.appendChild(n)}}let Jy=class extends Kt{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,n,r={}){return this._installWatch(e,n,r,dn)}addWhen(e,n,r={}){return this._installWatch(e,n,r,hc)}addOnCollectionChange(e,n,{initial:r=!1,final:i=!1}={}){const s=++this._handleId;return this.addHandles([$1(e,"after-changes",this._createSyncUpdatingCallback(),Dg),$1(e,"change",n,{onListenerAdd:r?o=>n({added:o.toArray(),removed:[]}):void 0,onListenerRemove:i?o=>n({added:[],removed:o.toArray()}):void 0})],s),qn(()=>this.removeHandles(s))}addPromise(e){if(e==null)return e;const n=++this._handleId;this.addHandles(qn(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(CP)||this._set("updating",!1))}),n),this._pendingPromises.add(e),this._set("updating",!0);const r=()=>this.removeHandles(n);return e.then(r,r),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,n,r={},i){const s=++this._handleId;r.sync||this._installSyncUpdatingWatch(e,s);const o=i(e,n,r);return this.addHandles(o,s),qn(()=>this.removeHandles(s))}_installSyncUpdatingWatch(e,n){const r=this._createSyncUpdatingCallback(),i=dn(e,r,{sync:!0,equals:()=>!1});return this.addHandles(i,n),i}_createSyncUpdatingCallback(){return()=>{this.removeHandles(CP),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Y2(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(CP))}),CP)}}};_([E({readOnly:!0})],Jy.prototype,"updating",void 0),Jy=_([ue("esri.core.support.UpdatingHandles")],Jy);const CP=-42;var M4=function(){return M4=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},M4.apply(this,arguments)},x9={exports:{}},$i={},w9={exports:{}},lv={};function k0e(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function zBe(t,e,n){}function UBe(t,e,n){}var GBe=/javascript\s*\:/img;function BBe(t,e){return GBe.test(e)?"":e}lv.whiteList=k0e();lv.getDefaultWhiteList=k0e;lv.onAttr=zBe;lv.onIgnoreAttr=UBe;lv.safeAttrValue=BBe;var WBe={indexOf:function(t,e){var n,r;if(Array.prototype.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},forEach:function(t,e,n){var r,i;if(Array.prototype.forEach)return t.forEach(e,n);for(r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},EE=WBe;function HBe(t,e){t=EE.trimRight(t),t[t.length-1]!==";"&&(t+=";");var n=t.length,r=!1,i=0,s=0,o="";function a(){if(!r){var u=EE.trim(t.slice(i,s)),h=u.indexOf(":");if(h!==-1){var f=EE.trim(u.slice(0,h)),g=EE.trim(u.slice(h+1));if(f){var v=e(i,o.length,f,g,u);v&&(o+=v+"; ")}}}i=s+1}for(;s<n;s++){var l=t[s];if(l==="/"&&t[s+1]==="*"){var c=t.indexOf("*/",s+2);if(c===-1)break;s=c+1,i=s+1,r=!1}else l==="("?r=!0:l===")"?r=!1:l===";"?r||a():l===`
`&&a()}return EE.trim(o)}var qBe=HBe,NP=lv,KBe=qBe;function yte(t){return t==null}function YBe(t){var e={};for(var n in t)e[n]=t[n];return e}function A0e(t){t=YBe(t||{}),t.whiteList=t.whiteList||NP.whiteList,t.onAttr=t.onAttr||NP.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||NP.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||NP.safeAttrValue,this.options=t}A0e.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,n=e.options,r=n.whiteList,i=n.onAttr,s=n.onIgnoreAttr,o=n.safeAttrValue,a=KBe(t,function(l,c,u,h,f){var g=r[u],v=!1;if(g===!0?v=g:typeof g=="function"?v=g(h):g instanceof RegExp&&(v=g.test(h)),v!==!0&&(v=!1),h=o(u,h),!!h){var x={position:c,sourcePosition:l,source:f,isWhite:v};if(v){var b=i(u,h,x);return yte(b)?u+":"+h:b}else{var b=s(u,h,x);if(!yte(b))return b}}});return a};var XBe=A0e;(function(t,e){var n=lv,r=XBe;function i(o,a){var l=new r(a);return l.process(o)}e=t.exports=i,e.FilterCSS=r;for(var s in n)e[s]=n[s]})(w9,w9.exports);var MB=w9.exports,CB={indexOf:function(t,e){var n,r;if(Array.prototype.indexOf)return t.indexOf(e);for(n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},forEach:function(t,e,n){var r,i;if(Array.prototype.forEach)return t.forEach(e,n);for(r=0,i=t.length;r<i;r++)e.call(n,t[r],r,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,n=e.exec(t);return n?n.index:-1}},ZBe=MB.FilterCSS,JBe=MB.getDefaultWhiteList,C4=CB;function I0e(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var R0e=new ZBe;function QBe(t,e,n){}function eWe(t,e,n){}function tWe(t,e,n){}function nWe(t,e,n){}function P0e(t){return t.replace(iWe,"&lt;").replace(sWe,"&gt;")}function rWe(t,e,n,r){if(n=D0e(n),e==="href"||e==="src"){if(n=C4.trim(n),n==="#")return"#";if(!(n.substr(0,7)==="http://"||n.substr(0,8)==="https://"||n.substr(0,7)==="mailto:"||n.substr(0,4)==="tel:"||n.substr(0,11)==="data:image/"||n.substr(0,6)==="ftp://"||n.substr(0,2)==="./"||n.substr(0,3)==="../"||n[0]==="#"||n[0]==="/"))return""}else if(e==="background"){if(OP.lastIndex=0,OP.test(n))return""}else if(e==="style"){if(vte.lastIndex=0,vte.test(n)||(_te.lastIndex=0,_te.test(n)&&(OP.lastIndex=0,OP.test(n))))return"";r!==!1&&(r=r||R0e,n=r.process(n))}return n=$0e(n),n}var iWe=/</g,sWe=/>/g,oWe=/"/g,aWe=/&quot;/g,lWe=/&#([a-zA-Z0-9]*);?/gim,cWe=/&colon;?/gim,uWe=/&newline;?/gim,OP=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,vte=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,_te=/u\s*r\s*l\s*\(.*/gi;function M0e(t){return t.replace(oWe,"&quot;")}function C0e(t){return t.replace(aWe,'"')}function N0e(t){return t.replace(lWe,function(n,r){return r[0]==="x"||r[0]==="X"?String.fromCharCode(parseInt(r.substr(1),16)):String.fromCharCode(parseInt(r,10))})}function O0e(t){return t.replace(cWe,":").replace(uWe," ")}function L0e(t){for(var e="",n=0,r=t.length;n<r;n++)e+=t.charCodeAt(n)<32?" ":t.charAt(n);return C4.trim(e)}function D0e(t){return t=C0e(t),t=N0e(t),t=O0e(t),t=L0e(t),t}function $0e(t){return t=M0e(t),t=P0e(t),t}function hWe(){return""}function dWe(t,e){typeof e!="function"&&(e=function(){});var n=!Array.isArray(t);function r(o){return n?!0:C4.indexOf(t,o)!==-1}var i=[],s=!1;return{onIgnoreTag:function(o,a,l){if(r(o))if(l.isClosing){var c="[/removed]",u=l.position+c.length;return i.push([s!==!1?s:l.position,u]),s=!1,c}else return s||(s=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return C4.forEach(i,function(c){a+=o.slice(l,c[0]),l=c[1]}),a+=o.slice(l),a}}}function fWe(t){for(var e="",n=0;n<t.length;){var r=t.indexOf("<!--",n);if(r===-1){e+=t.slice(n);break}e+=t.slice(n,r);var i=t.indexOf("-->",r);if(i===-1)break;n=i+3}return e}function pWe(t){var e=t.split("");return e=e.filter(function(n){var r=n.charCodeAt(0);return r===127?!1:r<=31?r===10||r===13:!0}),e.join("")}$i.whiteList=I0e();$i.getDefaultWhiteList=I0e;$i.onTag=QBe;$i.onIgnoreTag=eWe;$i.onTagAttr=tWe;$i.onIgnoreTagAttr=nWe;$i.safeAttrValue=rWe;$i.escapeHtml=P0e;$i.escapeQuote=M0e;$i.unescapeQuote=C0e;$i.escapeHtmlEntities=N0e;$i.escapeDangerHtml5Entities=O0e;$i.clearNonPrintableCharacter=L0e;$i.friendlyAttrValue=D0e;$i.escapeAttrValue=$0e;$i.onIgnoreTagStripAll=hWe;$i.StripTagBody=dWe;$i.stripCommentTag=fWe;$i.stripBlankChar=pWe;$i.cssFilter=R0e;$i.getDefaultCSSWhiteList=JBe;var SO={},Mm=CB;function mWe(t){var e=Mm.spaceIndex(t),n;return e===-1?n=t.slice(1,-1):n=t.slice(1,e+1),n=Mm.trim(n).toLowerCase(),n.slice(0,1)==="/"&&(n=n.slice(1)),n.slice(-1)==="/"&&(n=n.slice(0,-1)),n}function gWe(t){return t.slice(0,2)==="</"}function yWe(t,e,n){var r="",i=0,s=!1,o=!1,a=0,l=t.length,c="",u="";e:for(a=0;a<l;a++){var h=t.charAt(a);if(s===!1){if(h==="<"){s=a;continue}}else if(o===!1){if(h==="<"){r+=n(t.slice(i,a)),s=a,i=a;continue}if(h===">"){r+=n(t.slice(i,s)),u=t.slice(s,a+1),c=mWe(u),r+=e(s,r.length,c,u,gWe(u)),i=a+1,s=!1;continue}if(h==='"'||h==="'")for(var f=1,g=t.charAt(a-f);g.trim()===""||g==="=";){if(g==="="){o=h;continue e}g=t.charAt(a-++f)}}else if(h===o){o=!1;continue}}return i<t.length&&(r+=n(t.substr(i))),r}var vWe=/[^a-zA-Z0-9\\_:.-]/gim;function _We(t,e){var n=0,r=0,i=[],s=!1,o=t.length;function a(f,g){if(f=Mm.trim(f),f=f.replace(vWe,"").toLowerCase(),!(f.length<1)){var v=e(f,g||"");v&&i.push(v)}}for(var l=0;l<o;l++){var c=t.charAt(l),u,h;if(s===!1&&c==="="){s=t.slice(n,l),n=l+1,r=t.charAt(n)==='"'||t.charAt(n)==="'"?n:wWe(t,l+1);continue}if(s!==!1&&l===r){if(h=t.indexOf(c,l+1),h===-1)break;u=Mm.trim(t.slice(r+1,h)),a(s,u),s=!1,l=h,n=l+1;continue}if(/\s|\n|\t/.test(c))if(t=t.replace(/\s|\n|\t/g," "),s===!1)if(h=xWe(t,l),h===-1){u=Mm.trim(t.slice(n,l)),a(u),s=!1,n=l+1;continue}else{l=h-1;continue}else if(h=bWe(t,l-1),h===-1){u=Mm.trim(t.slice(n,l)),u=xte(u),a(s,u),s=!1,n=l+1;continue}else continue}return n<t.length&&(s===!1?a(t.slice(n)):a(s,xte(Mm.trim(t.slice(n))))),Mm.trim(i.join(" "))}function xWe(t,e){for(;e<t.length;e++){var n=t[e];if(n!==" ")return n==="="?e:-1}}function wWe(t,e){for(;e<t.length;e++){var n=t[e];if(n!==" ")return n==="'"||n==='"'?e:-1}}function bWe(t,e){for(;e>0;e--){var n=t[e];if(n!==" ")return n==="="?e:-1}}function EWe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function xte(t){return EWe(t)?t.substr(1,t.length-2):t}SO.parseTag=yWe;SO.parseAttr=_We;var SWe=MB.FilterCSS,zu=$i,j0e=SO,TWe=j0e.parseTag,kWe=j0e.parseAttr,hC=CB;function LP(t){return t==null}function AWe(t){var e=hC.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=hC.trim(t.slice(e+1,-1));var n=t[t.length-1]==="/";return n&&(t=hC.trim(t.slice(0,-1))),{html:t,closing:n}}function IWe(t){var e={};for(var n in t)e[n]=t[n];return e}function RWe(t){var e={};for(var n in t)Array.isArray(t[n])?e[n.toLowerCase()]=t[n].map(function(r){return r.toLowerCase()}):e[n.toLowerCase()]=t[n];return e}function F0e(t){t=IWe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=zu.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=RWe(t.whiteList||t.allowList):t.whiteList=zu.whiteList,t.onTag=t.onTag||zu.onTag,t.onTagAttr=t.onTagAttr||zu.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||zu.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||zu.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||zu.safeAttrValue,t.escapeHtml=t.escapeHtml||zu.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new SWe(t.css))}F0e.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,n=e.options,r=n.whiteList,i=n.onTag,s=n.onIgnoreTag,o=n.onTagAttr,a=n.onIgnoreTagAttr,l=n.safeAttrValue,c=n.escapeHtml,u=e.cssFilter;n.stripBlankChar&&(t=zu.stripBlankChar(t)),n.allowCommentTag||(t=zu.stripCommentTag(t));var h=!1;n.stripIgnoreTagBody&&(h=zu.StripTagBody(n.stripIgnoreTagBody,s),s=h.onIgnoreTag);var f=TWe(t,function(g,v,x,b,T){var A={sourcePosition:g,position:v,isClosing:T,isWhite:Object.prototype.hasOwnProperty.call(r,x)},I=i(x,b,A);if(!LP(I))return I;if(A.isWhite){if(A.isClosing)return"</"+x+">";var R=AWe(b),C=r[x],V=kWe(R.html,function(M,N){var O=hC.indexOf(C,M)!==-1,F=o(x,M,N,O);return LP(F)?O?(N=l(x,M,N,u),N?M+'="'+N+'"':M):(F=a(x,M,N,O),LP(F)?void 0:F):F});return b="<"+x,V&&(b+=" "+V),R.closing&&(b+=" /"),b+=">",b}else return I=s(x,b,A),LP(I)?c(b):I},c);return h&&(f=h.remove(f)),f};var PWe=F0e;(function(t,e){var n=$i,r=SO,i=PWe;function s(a,l){var c=new i(l);return c.process(a)}e=t.exports=s,e.filterXSS=s,e.FilterXSS=i,(function(){for(var a in n)e[a]=n[a];for(var l in r)e[l]=r[l]})();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(x9,x9.exports);var m_=x9.exports,MWe=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},V0e=(function(){function t(e,n){var r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=M4(M4({},m_.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,l){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?r.sanitizeUrl(a):m_.safeAttrValue(s,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var i;e&&!n?i=e:e&&n?(i=Object.create(this.arcgisFilterOptions),i.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(s){if(s==="whiteList")i.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,e.whiteList||{}]);else if(s==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return i.css.whiteList[a]=o[a]})}else i[s]=e[s]})):(i=Object.create(this.arcgisFilterOptions),i.whiteList=this.arcgisWhiteList,i.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=i,this._xssFilter=new m_.FilterXSS(i)}return t.prototype.sanitize=function(e,n){switch(n===void 0&&(n={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,n);default:return n.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,n){var r=(n??{}).isProtocolRequired,i=r===void 0?!0:r,s=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||l?m_.escapeAttrValue(e):!s&&!i?m_.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,n,r,i){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,n,r,i):m_.safeAttrValue(e,n,r,i)},t.prototype.validate=function(e,n){n===void 0&&(n={});var r=this.sanitize(e,n);return{isValid:e===r,sanitized:r}},t.prototype.encodeHTML=function(e){var n=this;return String(e).replace(/[&<>"'\/]/g,function(r){return n._entityMap[r]})},t.prototype.encodeAttrValue=function(e){var n=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(r,i){return n.test(r)?r:"&#x".concat(Number(e.charCodeAt(i)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var n={};return e.forEach(function(r){Object.keys(r).forEach(function(i){Array.isArray(r[i])&&Array.isArray(n[i])?n[i]=n[i].concat(r[i]):n[i]=r[i]})}),n},t.prototype._iterateOverObject=function(e,n){var r=this;n===void 0&&(n={});try{var i=!1,s=void 0;if(Array.isArray(e))s=e.reduce(function(a,l){var c=r.validate(l,n);return c.isValid?a.concat([l]):(i=!0,a.concat([c.sanitized]))},[]);else if(MWe(e)){var o=Object.keys(e);s=o.reduce(function(a,l){var c=e[l],u=r.validate(c,n);return u.isValid?a[l]=c:(i=!0,a[l]=u.sanitized),a},{})}else return n.allowUndefined&&typeof e>"u"?void 0:null;return i?s:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t})();const CWe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],NWe=CWe.reduce((t,e)=>(t[e]=[],t),{}),OWe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],z0e=new V0e({whiteList:NWe,onTagAttr:(t,e,n)=>{const r=`${e}="${n}"`;if(OWe.includes(e))return r},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),HPt=new V0e({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:t=>t},!1),U0e="http://www.w3.org/",TO=`${U0e}2000/svg`,G0e=`${U0e}1999/xlink`;let wte=[],NB=(t,e)=>{let n={};return Object.keys(t).forEach(r=>{n[r]=t[r]}),e&&Object.keys(e).forEach(r=>{n[r]=e[r]}),n},OB=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),B0e=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},LWe=(t,e,n)=>{if(e.vnodeSelector!==""){for(let r=n;r<t.length;r++)if(OB(t[r],e))return r}return-1},b$=(t,e,n,r)=>{let i=t[e];if(i.vnodeSelector==="")return;let s=i.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(OB(a,i))throw new Error(`${n.vnodeSelector} had a ${i.vnodeSelector} child ${r==="added"?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},DWe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},b9=[],E9=!1,W0e=t=>{(t.children||[]).forEach(W0e),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},bte=()=>{E9=!1,b9.forEach(W0e),b9.length=0},Ete=t=>{b9.push(t),E9||(E9=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(bte,{timeout:16}):setTimeout(bte,16))},Ste=t=>{let e=t.domNode;if(t.properties){let n=t.properties.exitAnimation;if(n)return e.style.pointerEvents="none",void n(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),Ete(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),Ete(t))},$We=(t,e,n)=>{if(!e)return;let r=n.eventHandlerInterceptor,i=Object.keys(e),s=i.length;for(let o=0;o<s;o++){let a=i[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")T9(t,l,!0);else if(a==="classes"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h];l[f]&&t.classList.add(f)}}else if(a==="styles"){let c=Object.keys(l),u=c.length;for(let h=0;h<u;h++){let f=c[h],g=l[f];g&&(B0e(g),n.styleApplyer(t,f,g))}}else if(a!=="key"&&l!=null){let c=typeof l;c==="function"?(a.lastIndexOf("on",0)===0&&(r&&(l=r(a,l,t,e)),a==="oninput"&&(function(){let u=l;l=function(h){u.apply(this,[h]),h.target["oninput-value"]=h.target.value}})()),t[a]=l):n.namespace===TO?a==="href"?t.setAttributeNS(G0e,a,l):t.setAttribute(a,l):c==="string"&&a!=="value"?a==="innerHTML"?t[a]=z0e.sanitize(l):S9(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function S9(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let N4,jWe=(t,e,n)=>{if(e)for(let r of e)aT(r,t,void 0,n)},H0e=(t,e,n)=>{jWe(t,e.children,n),e.text&&(t.textContent=e.text),$We(t,e.properties,n),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,n,e.vnodeSelector,e.properties,e.children])},aT=(t,e,n,r)=>{let i,s=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")i=t.domNode=a.createTextNode(t.text),n!==void 0?e.insertBefore(i,n):e.appendChild(i);else{for(let l=0;l<=o.length;++l){let c=o.charAt(l);if(l===o.length||c==="."||c==="#"){let u=o.charAt(s-1),h=o.slice(s,l);u==="."?i.classList.add(h):u==="#"?i.id=h:(h==="svg"&&(r=NB(r,{namespace:TO})),r.namespace!==void 0?i=t.domNode=a.createElementNS(r.namespace,h):(i=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&i.setAttribute("type",t.properties.type)),n!==void 0?e.insertBefore(i,n):i.parentNode!==e&&e.appendChild(i)),s=l+1}}H0e(i,t,r)}},T9=(t,e,n)=>{e&&e.split(" ").forEach(r=>{r&&t.classList.toggle(r,n)})},FWe=(t,e,n,r)=>{if(!n)return;let i=!1,s=Object.keys(n),o=s.length;for(let a=0;a<o;a++){let l=s[a],c=n[l],u=e[l];if(l==="class")u!==c&&(T9(t,u,!1),T9(t,c,!0));else if(l==="classes"){let h=t.classList,f=Object.keys(c),g=f.length;for(let v=0;v<g;v++){let x=f[v],b=!!c[x];b!==!!u[x]&&(i=!0,b?h.add(x):h.remove(x))}}else if(l==="styles"){let h=Object.keys(c),f=h.length;for(let g=0;g<f;g++){let v=h[g],x=c[v];x!==u[v]&&(i=!0,x?(B0e(x),r.styleApplyer(t,v,x)):r.styleApplyer(t,v,""))}}else if(c||typeof u!="string"||(c=""),l!=="value"||S9(t)){if(c!==u){let h=typeof c;h==="function"&&r.eventHandlerInterceptor||(r.namespace===TO?l==="href"?t.setAttributeNS(G0e,l,c):t.setAttribute(l,c):h==="string"?l==="innerHTML"?t[l]=z0e.sanitize(c):l==="role"&&c===""?t.removeAttribute(l):S9(t)&&l in t?t[l]=c:t.setAttribute(l,c):t[l]!==c&&(t[l]=c),i=!0)}}else{let h=t[l];h!==c&&(t["oninput-value"]?h===t["oninput-value"]:c!==u)&&(t[l]=c,t["oninput-value"]=void 0),c!==u&&(i=!0)}}return i},VWe=(t,e,n,r,i)=>{if(n===r)return!1;r=r||wte;let s,o=(n=n||wte).length,a=r.length,l=0,c=0,u=!1;for(;c<a;){let h=l<o?n[l]:void 0,f=r[c];if(h!==void 0&&OB(h,f))u=N4(h,f,i)||u,l++;else{let g=LWe(n,f,l+1);if(g>=0){for(s=l;s<g;s++)Ste(n[s]),b$(n,s,t,"removed");u=N4(n[g],f,i)||u,l=g+1}else aT(f,e,l<o?n[l].domNode:void 0,i),DWe(f),b$(r,c,t,"added")}c++}if(o>l)for(s=l;s<o;s++)Ste(n[s]),b$(n,s,t,"removed");return u};N4=(t,e,n)=>{let r=t.domNode,i=!1;if(t===e)return!1;let s=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=r.ownerDocument.createTextNode(e.text);return r.parentNode.replaceChild(o,r),e.domNode=o,i=!0,i}e.domNode=r}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(n=NB(n,{namespace:TO})),t.text!==e.text&&(s=!0,e.text===void 0?r.removeChild(r.firstChild):r.textContent=e.text),e.domNode=r,s=VWe(e,r,t.children,e.children,n)||s,s=FWe(r,t.properties,e.properties,n)||s,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[r,n,e.vnodeSelector,e.properties,e.children]);return s&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(r,e.properties,t.properties),i};let DP=(t,e)=>({getLastRender:()=>t,update:n=>{if(t.vnodeSelector!==n.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=t;t=n,N4(r,n,e)},domNode:t.domNode});const zWe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,n)=>{e.charAt(0)==="-"?t.style.setProperty(e,n):t.style[e]=n}};let nS=t=>NB(zWe,t),Jm={append:(t,e,n)=>(n=nS(n),aT(e,t,void 0,n),DP(e,n)),insertBefore:(t,e,n)=>(n=nS(n),aT(e,t.parentNode,t,n),DP(e,n)),merge:(t,e,n)=>(n=nS(n),e.domNode=t,H0e(t,e,n),DP(e,n)),replace:(t,e,n)=>(n=nS(n),aT(e,t.parentNode,t,n),t.parentNode.removeChild(t),DP(e,n))},q0e,UWe=(t,e)=>{let n=[];for(;t&&t!==e;)n.push(t),t=t.parentNode;return n};q0e=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let GWe=(t,e)=>{let n=t;return e.forEach(r=>{n=n&&n.children?q0e(n.children,i=>i.domNode===r):void 0}),n},BWe=(t,e,n)=>{let r=function(i){n("domEvent",i);let s=e(),o=UWe(i.currentTarget,s.domNode);o.reverse();let a,l=GWe(s.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${i.type}`].apply(l.properties.bind||this,arguments)),n("domEventProcessed",i),a};return(i,s,o,a)=>r},Tte=t=>{let e,n,r=nS(t),i=r.performanceLogger,s=!0,o=!1,a=[],l=[],c=(h,f,g)=>{let v,x=()=>v;r.eventHandlerInterceptor=BWe(e,x,i),v=h(f,g(),r),a.push(v),l.push(g)},u=()=>{if(n=void 0,s){s=!1,i("renderStart",void 0);for(let h=0;h<a.length;h++){let f=l[h]();i("rendered",void 0),a[h].update(f),i("patched",void 0)}i("renderDone",void 0),s=!0}};return e={renderNow:u,scheduleRender:()=>{n||o||(n=requestAnimationFrame(u))},stop:()=>{n&&(cancelAnimationFrame(n),n=void 0),o=!0},resume:()=>{o=!1,s=!0,e.scheduleRender()},append:(h,f)=>{c(Jm.append,h,f)},insertBefore:(h,f)=>{c(Jm.insertBefore,h,f)},merge:(h,f)=>{c(Jm.merge,h,f)},replace:(h,f)=>{c(Jm.replace,h,f)},detach:h=>{for(let f=0;f<l.length;f++)if(l[f]===h)return l.splice(f,1),a.splice(f,1)[0];throw new Error("renderFunction was not found")}},e},gm=class extends Kt{constructor(){super(...arguments),this.items=new Ot,this._watchUpdatingTracking=new Jy,this._callbacks=new Map,this._projector=Tte(),this._hiddenProjector=Tte()}get needsRender(){return this.items.length>0}get updating(){return this._watchUpdatingTracking?.updating??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,n=>{for(const r of n.added){const i=()=>r.render();this._callbacks.set(r,i),this._projector.append(this.surface,i)}for(const r of n.removed){const i=this._projector.detach(this._callbacks.get(r));this.surface.removeChild(i.domNode),this._callbacks.delete(r)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const n=this._hiddenSurface,r=this._hiddenProjector;let i;const s=()=>(i=e.render(),i);r.append(n,s),r.renderNow();const o={left:0,top:0,right:0,bottom:0};if(i?.domNode){const a=i.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(r.detach(s);n.firstChild;)n.removeChild(n.firstChild);return o}overlaps(e,n){const r=this.computeBoundingRect(e),i=this.computeBoundingRect(n);return Math.max(r.left,i.left)<=Math.min(r.right,i.right)&&Math.max(r.top,i.top)<=Math.min(r.bottom,i.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,n){const r=!!n?.disableDecorations;if(!this.items.some(s=>s.visible&&!(r&&s.isDecoration)))return;const i=e.getContext("2d");i.save(),i.font=this._fontString(),this.items.forEach(s=>{r&&s.isDecoration||(i.save(),s.renderCanvas(i),i.restore())}),i.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};_([E({readOnly:!0})],gm.prototype,"surface",void 0),_([E({readOnly:!0})],gm.prototype,"items",void 0),_([E({readOnly:!0})],gm.prototype,"needsRender",null),_([E({readOnly:!0})],gm.prototype,"_watchUpdatingTracking",void 0),_([E({readOnly:!0})],gm.prototype,"updating",null),gm=_([ue("esri.views.overlay.ViewOverlay")],gm);const kte=gm,E$=[0,0];function WWe(t){const e=(t.ownerDocument||window.document).defaultView,n=t.getBoundingClientRect();return E$[0]=n.left+(e?.pageXOffset??0),E$[1]=n.top+(e?.pageYOffset??0),E$}function Ate(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function HWe(t){const e=document.createElement("div");return t.appendChild(e),e}const g_=16,SE=750,qWe=512,KWe=2,YWe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this._freqInfo={freq:g_,time:SE},this._overlayRenderTaskHandle=null,this.aria={},this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([dn(()=>this.cursor,i=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",i)}),dn(()=>this.navigating,i=>{const{surface:s}=this;s&&s.setAttribute("data-navigating",i.toString())}),dn(()=>[this.aria,this.surface],()=>this._updateAria(),{initial:!0})])}initialize(){const r=this;this.addHandles([dn(()=>this.ui,(i,s)=>this._handleUIChange(i,s),fa),r.on("focus",()=>this.notifyChange("focused")),r.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui?.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(r){const i=this._get("container"),s=PB(r);if(s||typeof r!="string"||St.getLogger(this).error("#container",`element with id '${r}' not found`),i===s)return;if(this._stopMeasuring(),i&&(i.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Ate(this.root),this._set("root",null)),this.userContent&&(gte(this.userContent,i),Ate(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",gte(s,o),s.appendChild(o),this._set("userContent",o);const a=document.createElement("div");a.className="esri-view-root",s.insertBefore(a,s.firstChild),this._set("root",a);const l=document.createElement("div");l.className="esri-view-surface",l.setAttribute("role","application"),l.tabIndex=0,a.appendChild(l),this._set("surface",l);const c=new kte;a.appendChild(c.surface),this._set("overlay",c),this.addHandles(dn(()=>c.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=s2({render:()=>this.overlay?.render()}):this._overlayRenderTaskHandle=Qr(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",s),this._startMeasuring()}get focused(){const r=document.activeElement===this.surface;return document.hasFocus()&&r}get size(){return[this.width,this.height]}set ui(r){const i=this._get("ui");i!==r&&i?.destroy(),this._set("ui",r)}blur(){this.surface?.blur()}focus(){this.surface?.focus()}pageToContainer(r,i,s){const o=this.position;return r-=o?o[0]:0,i-=o?o[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}containerToPage(r,i,s){const o=this.position;return r+=o?o[0]:0,i+=o?o[1]:0,s?(s[0]=r,s[1]=i):s=[r,i],s}_updateAria(){const{surface:r,aria:i}=this;r&&(r.ariaLabelledByElements=i?.labelledByElements??null,r.ariaDescribedByElements=i?.describedByElements??null,r.ariaLabel=i?.label??null,r.ariaDescription=i?.description??null)}_handleUIChange(r,i){this.removeHandles("ui"),i&&i!==r&&i.destroy(),r&&(r.view=this,this.addHandles(dn(()=>this.root,s=>{r.container=s?HWe(s):null},fa),"ui")),this._set("ui",r)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const r=this._freqInfo;r.freq=g_,r.time=SE;const i=s2({prepare:a=>{const l=this._measure(),c=this._freqInfo;if(c.time+=a.deltaTime,l&&(c.freq=g_,this._get("resizing")||this._set("resizing",!0)),c.time<c.freq)return;c.time=0;const u=this._position();c.freq=u||l?g_:Math.min(SE,c.freq*KWe),!l&&c.freq>=qWe&&(i.pause(),this._get("resizing")&&this._set("resizing",!1))}}),s=new ResizeObserver(a=>{r.freq=g_,r.time=SE,i.resume()});this.container!=null&&s.observe(this.container);const o=qn(()=>s.disconnect());this.addHandles([B2(window,"resize",()=>{r.freq=g_,r.time=SE,i.resume()}),o,i],"measuring"),this._measure(),this._position()}_measure(){const r=this.container,i=r?r.clientWidth:0,s=r?r.clientHeight:0;if(i===0||s===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,a=this.height;return i===o&&s===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",i),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:a,width:i,height:s}),!0)}_position(){const r=this.container,i=this.position,s=r&&WWe(r);return!!s&&(!i||s[0]!==i[0]||s[1]!==i[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return _([E()],n.prototype,"aria",void 0),_([E()],n.prototype,"container",null),_([E({readOnly:!0})],n.prototype,"focused",null),_([E({readOnly:!0})],n.prototype,"height",void 0),_([E()],n.prototype,"messagesCommon",void 0),_([E({type:kte})],n.prototype,"overlay",void 0),_([E({readOnly:!0})],n.prototype,"position",void 0),_([E({readOnly:!0})],n.prototype,"resizing",void 0),_([E({readOnly:!0})],n.prototype,"root",void 0),_([E({value:null,readOnly:!0})],n.prototype,"size",null),_([E({readOnly:!0})],n.prototype,"surface",void 0),_([E({readOnly:!0})],n.prototype,"suspended",void 0),_([E({nonNullable:!0})],n.prototype,"ui",null),_([E({readOnly:!0})],n.prototype,"userContent",void 0),_([E({readOnly:!0})],n.prototype,"width",void 0),_([E()],n.prototype,"widthBreakpoint",void 0),n=_([ue("esri.views.DOMContainer")],n),n},$P="popup",Ite="manual";function md(t){return t!=null&&"open"in t&&"declaredClass"in t}function lp(t){return!!t&&t.tagName.toLowerCase()==="arcgis-popup"&&"open"in t}function XWe(t,e,n){const[r,i,s]=e;if(n){const[o,a,l]=n;o&&md(a)&&(a.view=null,o.remove(a,$P),a!==i&&i&&a.destroy()),o&&l&&lp(l)&&(l.view=null,o.remove(l,$P),l!==s&&s&&l.remove())}r&&md(i)&&(i.view=t,r.add(i,{key:$P,position:Ite,internal:!0})),r&&s&&lp(s)&&(s.view=t,r.add(s,{key:$P,position:Ite,internal:!0}))}async function ZWe(t,e){const{popup:n,popupElement:r}=t;md(n)?await jP(n,null,e):r&&lp(r)?await jP(null,r,e):e?.defer(async()=>{await t.setupPopup();const{popup:i,popupElement:s}=t;md(i)&&!t.destroyed&&t.ready&&t.popupEnabled?await jP(i,null,e):s&&lp(s)&&await jP(null,s,e)})}function JWe(t,e){const{popup:n,popupElement:r}=t;if(md(n))return n.open(e);r&&lp(r)&&r.open(e)}function QWe(t,e){md(t)&&t.close(),e&&lp(e)&&(e.visible=!1)}async function jP(t,e,n){if(md(t)){const r=await t.viewModel.handleViewClick(n);return void(r?.promises?.length?t.open(r):t.visible&&t.close())}if(e&&lp(e)){const r=await e.handleViewClick(n);r?.promises?.length?e.open(r):e.visible&&(e.visible=!1)}}const K0e=ve("mac")?"Meta":"Control",eHe=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),tHe=t=>eHe.has(t);let nHe=class{constructor(e,n=[]){this.eventType=e,this.keyModifiers=n}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const n=e.modifiers;for(const r of this.keyModifiers)if(!n.has(r))return!1;return!0}},Ws=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const n=this._incoming[e];for(const r of n)this._incomingEventMatches.push(r.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(n=>this._handleEvent(n)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,n,r){let i;typeof n=="function"?(r=n,i=[]):i=n||[];const s=typeof e=="string"?new nHe(e,i):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=u=>{const h=this._incoming[u.match.eventType];if(h){const f=h.indexOf(u);h.splice(f,1),o(),this._manager&&this._manager.updateDependencies()}},l=new rHe(s,r,{onPause:a,onRemove:a,onResume:u=>{const h=this._incoming[u.match.eventType];h&&!h.includes(u)&&(h.push(u),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const n=new iHe(e,{onEmit:(r,i,s,o)=>{this._manager?.emit(r.eventType,i,s,o)},onRemove:r=>{delete this._outgoing[r.eventType],this._manager?.updateDependencies()}});return this._outgoing[e]=n,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),n}startCapturingPointer(e){this._manager?.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager?.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager?.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){const n=this._incoming[e.type];if(n){for(const r of n)if(r.match.matches(e)&&(r.callback?.(e),e.shouldStopPropagation()))break}}},rHe=class{constructor(e,n,r){this.match=e,this._callback=n,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},iHe=class{constructor(e,n){this.eventType=e,this._removed=!1,this._handler=n}emit(e,n,r){this._removed||this._handler.onEmit(this,e,n,r)}remove(){this._removed=!0,this._handler.onRemove(this)}},sHe=class extends Ws{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this._id=null,this.registerIncoming("pointer-move",n=>this._update(n.data))}_update(e){const n=e.native.pointerType==="touch"?"touch":"mouse",{x:r,y:i,native:{pointerId:s}}=e;n===this._value&&this._x===r&&this._y===i&&this._id===s||(this._value=n,this._x=r,this._y=i,this._id=s,this._onChange(s,n,r,i))}},oHe=class{constructor(e,n){this._observable=new nI,this._value=e,this._equalityFunction=n}get value(){return tn(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function v2(t,e=ade){return new oHe(t,e)}let aHe=class extends Ws{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=v2(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},lHe=class{constructor(e,n){this._owner=n,this._properties={},this._afterDispatchHandle=null;for(const r in e){const i=e[r],s=new sfe(i,void 0,void 0,2,2);this._properties[r]={pool:s,acquired:[]}}this._afterDispatchHandle=T$e(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const n=this._properties[e];for(const r of n.acquired)vQ(r)||n.pool.release(r);n.pool.destroy(),n.pool=null,n.acquired=null}this._properties=null,this._owner=null}get(e){const n=this._owner._get(e),r=this._properties[e];let i=r.pool.acquire();for(r.acquired.push(i);i===n;)i=r.pool.acquire(),r.acquired.push(i);return gfe(),i}_release(){for(const e in this._properties){const n=this._properties[e];let r=0;for(const i of n.acquired)vQ(i)?n.acquired[r++]=i:n.pool.release(i);n.acquired.length=r}}},cHe=class{constructor(){this.id=0,this.type="mouse",this.location=Fs()}},Lu=class extends Kt{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=K0e,this._propertiesPool=new lHe({latestPointerInfo:()=>new cHe},this),this._latestPointerInfo=void 0,this._paused=!1,this._testTimestamp=void 0}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const n of e)this.uninstallHandlers(n);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get latestPointerInfo(){return this._latestPointerInfo}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,n,r=Xf.INTERNAL){if(this._nameToGroup[e]||n.length===0)return;const i={name:e,handlers:n.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=i;for(let s=i.handlers.length-1;s>=0;s--){const o=i.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,c,u,h)=>{this._emitInputEvent(o.priorityIndex+1,a,l,c,h,u)},setPointerCapture:(a,l)=>{this._setPointerCapture(i,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const n=this._nameToGroup[e];n?(n.handlers.forEach(r=>{r.removed=!0,r.uninstallCallback?.()}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):St.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,n=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const i=this._handlers[r];i.priorityIndex=r,this._handlersPriority.push(i)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let s=i.handler.hasSideEffects;if(!s){for(const o of i.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}}if(s)for(const o of i.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)tHe(a)||n.add(a)}i.active=s}this._sourceEvents=e,this._keyModifiers=n,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,n,r,i){const s=this._latestPointerInfo;if(s==null||s.id!==e||s.type!==n||s.location.x!==r||s.location.y!==i){const o=this._propertiesPool.get("latestPointerInfo");o.id=e,o.type=n,o.location.x=r,o.location.y=i,this._latestPointerInfo=o}}_onEventReceived(e,n){if(e==="pointer-capture-lost"){const s=n;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,n);const r=this._testTimestamp??n.native?.timestamp,i=n.native?.cancelable;this._emitInputEventFromSource(e,n,r,i)}_updateKeyModifiers(e,n){if(!n)return;let r=!1;const i=()=>{r||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),r=!0)},s=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(i(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(i(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=n.key;this._keyModifiers.has(a)&&s(a,e==="key-down")}const o=n.native;s("Alt",!!o?.altKey),s("Control",!!o?.ctrlKey),s("Ctrl",!!o?.ctrlKey),s("Shift",!!o?.shiftKey),s("Meta",!!o?.metaKey),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new sHe((e,n,r,i)=>this._setLatestPointer(e,n,r,i)),this._multiTouchHandler=new aHe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Xf.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Xf.INTERNAL)}_setPointerCapture(e,n,r,i){const s=e.name+"-"+n.priorityIndex,o=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,o),i?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,n,r,i){this._emitInputEvent(0,e,n,r,i)}_emitInputEvent(e,n,r,i,s,o){const a=i??this._currentPropagation?.timestamp??performance.now(),l=s??!1,c={event:new uHe(n,r,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new Ok,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:n,priorityIndex:r}=e.events.pop(),i=n.data?.eventId;if(!(i!=null&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&e.currentHandler.eventCallback?.(n),n.shouldStopPropagation()){i!=null&&this._stoppedPropagationEventIds.add(i);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const n=new Ok;n.push(e);const r=this._currentPropagation;if(r){for(;r.events.length;)n.push(r.events.pop());r.events=n,r.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,n){if(e.handler.hasSideEffects!==n.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==n.groupPriority)return e.groupPriority>n.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const i of n.handler.incomingEventMatches){if(r.eventType!==i.eventType)continue;const s=r.keyModifiers.filter(o=>i.keyModifiers.includes(o));if(s.length===r.keyModifiers.length!=(s.length===i.keyModifiers.length))return r.keyModifiers.length>i.keyModifiers.length?-1:1}return e.priorityIndex>n.priorityIndex?-1:1}_sortHandlersPriority(e){const n=[];for(const r of e){let i=0;for(;i<n.length&&this._compareHandlerPriority(r,n[i])>=0;)i++;n.splice(i,0,r)}return n}get test(){}};_([E({readOnly:!0})],Lu.prototype,"hasPendingInputs",null),_([E({constructOnly:!0})],Lu.prototype,"eventSource",void 0),_([E({constructOnly:!0})],Lu.prototype,"recognizers",void 0),_([E()],Lu.prototype,"multiTouchActive",null),_([E()],Lu.prototype,"_latestPointerInfo",void 0),_([E()],Lu.prototype,"latestPointerInfo",null),_([E()],Lu.prototype,"_paused",void 0),_([E({readOnly:!0})],Lu.prototype,"updating",null),Lu=_([ue("esri.views.input.InputManager")],Lu);let uHe=class{constructor(e,n,r,i,s){this.type=e,this.data=n,this.timestamp=r,this.modifiers=i,this.cancelable=s,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return!!(1&this._propagationState)}defer(e){this._propagationState|=2;const n=(r,i)=>{this._propagationState&=-3;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),i)throw r;return r};return(typeof e=="function"?e():e).then(r=>n(r,!1),r=>n(r,!0))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};const Xf={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},hHe=t=>{const e=t;let n=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([dn(()=>[this.ui,this.popup,this.popupElement],([r,i,s],o)=>{const[a,l,c]=o??[];XWe(this,[r,i,s],[a,l,c])},ea),this.on("click",r=>{this.popup&&this.popupEnabled&&(r.pointerType!=="mouse"||r.button===0)&&ZWe(this,r)},Xf.WIDGET)]),aB(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>xe(()=>import("./Popup-D5Rm4-mH.js").then(r=>r.P),__vite__mapDeps([253,254,86,255,256,257,258,231,12,13,14,15,8,16,17,18,19,21,22,20,23,132,173,259,110,31,32,33,34,35,36,230,11,176,39,40,170,127,128,109,29,30,53,46,47,48,49,50,51,52,43,260,4,261,262,2,6,263,3,264,265,54,55,56,57,58,266,267,194,268,269,270,271,272,5,7,273,274,275,276,277,60,278,279,229,280,281,59,61,62,63,64,282,283,284,285,286,65,99,67,175,287,288,289,290])))}destroy(){this.destroyed||this.closePopup()}async openPopup(r){if(md(this.popup))return this.popup.open(r);if(this.popupElement&&lp(this.popupElement))this.popupElement.open(r).catch(()=>{});else try{if(await this.setupPopup(),!this.popup)return void St.getLogger(this).error(new Xe("view:null-popup","Popup is null and can't be opened"));JWe(this,r)}catch{}}closePopup(){this._popupSetupTask?.abort(),QWe(this.popup,this.popupElement)}async fetchPopupFeatures(r,i){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(r,i),i)}async setupPopup(){if(this._popupSetupTask?.abort(),this.popup&&!md(this.popup))return this._popupSetupTask=iO(async r=>{if(!this.popupEnabled||!lp(this.popupElement))if(this.dependencies.popup&&typeof this.dependencies.popup=="function")await this.dependencies.popup(),hi(r),customElements.get("arcgis-popup")||St.getLogger(this).error(new Xe("view:undefined-popup-element","`arcgis-popup` custom element is undefined and can't be opened")),this.popupElement=document.createElement("arcgis-popup");else{const{default:i}=await xe(()=>import("./Popup-D5Rm4-mH.js").then(o=>o.P),__vite__mapDeps([253,254,86,255,256,257,258,231,12,13,14,15,8,16,17,18,19,21,22,20,23,132,173,259,110,31,32,33,34,35,36,230,11,176,39,40,170,127,128,109,29,30,53,46,47,48,49,50,51,52,43,260,4,261,262,2,6,263,3,264,265,54,55,56,57,58,266,267,194,268,269,270,271,272,5,7,273,274,275,276,277,60,278,279,229,280,281,59,61,62,63,64,282,283,284,285,286,65,99,67,175,287,288,289,290]));if(hi(r),!this.popup||md(this.popup))return;const s=this.popup;if("open"in s||"close"in s){const{open:o,close:a,...l}=s;this.popup=new i({...l})}else this.popup=new i(s)}}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:r,hits:i},s){const o=[],a=[];let l=!1;const c=QDe(s,ve("popup-view-fetch-timeout")??fHe),u=g=>{const v=new dHe(g);return a.push(v),o.push(v.promise),v},h=g=>{const v=a.at(-1);return v&&v.layerView===g&&!l?v:u(g)};for(const g of i)"graphic"in g?(h(g.layerView).graphics.push(g.graphic),l=!1):(o.push(g.layerView.fetchPopupFeaturesAtLocation(g.mapPoint,c)),l=!0);a.forEach(g=>g.resolve(c));const f=JDe(o).then(g=>g.filter(v=>!!v).flat());return{pendingFeatures:o,allGraphicsPromise:f,location:r}}async _getPopupHits(r,i){const{hits:s,location:o}=await this.popupHitTest(r);hi(i);const a=[];for(const l of s)if("graphic"in l){if(this._isValidPopupGraphic(l.graphic,i)){const c=this._isValidPopupGraphicsLayerView(l.layerView)?l.layerView:void 0;a.push({graphic:l.graphic,layerView:c})}}else this._isValidPopupLocationLayerView(l.layerView)&&a.push({mapPoint:l.mapPoint,layerView:l.layerView});return{hits:a,location:o}}_isValidPopupGraphic(r,i){return r&&!!r.getEffectivePopupTemplate(i?.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(r){return!r||(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesFromGraphics"in r}_isValidPopupLocationLayerView(r){return(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesAtLocation"in r}};return _([E()],n.prototype,"popup",void 0),_([E()],n.prototype,"popupElement",void 0),_([E()],n.prototype,"popupEnabled",void 0),n=_([ue("esri.views.PopupView")],n),n};let dHe=class{constructor(e){this.layerView=e,this._resolver=uc(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:n,graphics:r,_resolver:i}=this;if(!n)return i.resolve(r),i.promise;let s;return n.fetchPopupFeaturesFromGraphics(r,e).catch(o=>(s=o,null)).then(o=>{o?i.resolve(o):i.reject(s)}),i.promise}};const fHe=5e3;var rS;const O4=kl()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),Y0e=O4.jsonValues.slice();tF(Y0e,"orthometric");const lT=kl()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let Qa=rS=class extends qt{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,n){return O4.write(t,e,n)}readHeightModel(t,e,n){return O4.read(t)||(n?.messages&&n.messages.push(pHe(t,{context:n})),null)}readHeightUnit(t,e,n){return lT.read(t)||(n?.messages&&n.messages.push(Rte(t,{context:n})),null)}readHeightUnitService(t,e,n){return BG(t)||lT.read(t)||(n?.messages&&n.messages.push(Rte(t,{context:n})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new rS({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const n=rpe(e);return new rS({heightModel:t.heightModel,heightUnit:n??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new rS;return e.read(t,{origin:"web-scene"}),e}};function Rte(t,e){return new Td("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function pHe(t,e){return new Td("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}_([E({type:O4.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:Y0e,default:"ellipsoidal",write:{isRequired:!0}}}}})],Qa.prototype,"heightModel",void 0),_([Xn("web-scene","heightModel")],Qa.prototype,"writeHeightModel",null),_([sr(["web-scene","service"],"heightModel")],Qa.prototype,"readHeightModel",null),_([E({type:lT.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:lT.jsonValues,write:{writer:lT.write,isRequired:!0}}}}})],Qa.prototype,"heightUnit",void 0),_([sr("web-scene","heightUnit")],Qa.prototype,"readHeightUnit",null),_([sr("service","heightUnit")],Qa.prototype,"readHeightUnitService",null),_([E({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],Qa.prototype,"vertCRS",void 0),_([sr("service","vertCRS",["vertCRS","ellipsoid","geoid"])],Qa.prototype,"readVertCRS",null),Qa=rS=_([ue("esri.geometry.HeightModelInfo")],Qa);let S$;async function mHe(){return S$==null&&(S$=xe(()=>import("./WhereClauseCache-DwQoYZKV.js"),__vite__mapDeps([125,35,36,126,127,128,40])).then(t=>new t.WhereClauseCache(500,500))),S$}async function gHe(t,e){const n=await mHe(),r=n.get(t,e);if(r==null)throw n.getError(t,e);return r}function oMt(t,e){return t||=null,e||=null,t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function aMt(t,e){return t||=null,e||=null,t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function lMt(t,e){return e.length===0?null:`${t} IN (${yHe(e)})`}function yHe(t){return t.map(e=>typeof e=="string"?vHe(e):e).join(",")}function vHe(t){return`'${t.replaceAll("'","''")}'`}function cMt(t){return typeof t=="number"}function uMt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function hMt(t){return typeof t=="boolean"}function pI(t){return typeof t=="string"||t instanceof String}function _He(t){return t==null||pI(t)}function dMt(t){return Array.isArray(t)}function fMt(t){return t?.declaredClass==="esri.Graphic"}function pMt(t){return t instanceof Date}const xHe="HH:mm",wHe="HH:mm:ss",bHe="HH:mm:ss.SSS",EHe=[bHe,wHe,xHe,"TT"],SHe="yyyy-MM-dd";function Pte(t){if(!t||!pI(t))return null;const e=hn.fromFormat(t,SHe);return e.isValid?e:null}function Mte(t){return t&&pI(t)?XDe(EHe,e=>{const n=hn.fromFormat(t,e);return n.isValid?n:null})??null:null}function Cte(t){if(!t||!pI(t))return null;const e=hn.fromISO(t);return e.isValid?e:null}const X0e=new Set(["integer","small-integer","long","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"]);function THe(t){return t!=null&&X0e.has(t.type)}function Z0e(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function J0e(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function Q0e(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const kHe=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);AG(X0e,kHe);function mMt(t,e){const n=t?.domain;if(!n||n.type!=="range")return;const r="range"in n?n.range[0]:n.minValue,i="range"in n?n.range[1]:n.maxValue,s=THe(t);return Z0e(t)||Q0e(t)||J0e(t)?{...AHe(t,i,r),isInteger:s}:{min:r!=null&&typeof r=="number"?r:null,max:i!=null&&typeof i=="number"?i:null,rawMin:r,rawMax:i,isInteger:s}}function AHe(t,e,n){return Z0e(t)?{min:Pte(n)?.toMillis(),max:Pte(e)?.toMillis(),rawMin:n,rawMax:e}:Q0e(t)?{min:Mte(n)?.toMillis(),max:Mte(e)?.toMillis(),rawMin:n,rawMax:e}:J0e(t)?{min:Cte(n)?.toMillis(),max:Cte(e)?.toMillis(),rawMin:n,rawMax:e}:{max:null,min:null}}function IHe(t){if(!t)return;const e=t.match(RHe);return e?.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const RHe=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-z_][a-z0-9_]*))$/i;function gMt(t){return t.match(PHe)?.[1]?.replaceAll("\\'","'")??null}const PHe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let T$;function MHe(){return T$||(T$=(async()=>{const[t,e,n]=await Promise.all([xe(()=>import("./arcadeUtils-MMI13dR4.js"),__vite__mapDeps([291,292,293,128,294,127,40,295,260,133,296,118,50,49,51,39,297,298,126,175,299,4,261,42])),xe(()=>import("./batchExec-SntlGFeP.js"),__vite__mapDeps([300,186])),xe(()=>import("./aiServices-7vzuR2YL.js").then(r=>r.a),__vite__mapDeps([297,40,294,127,128,295,260,133,298,293]))]);return{arcade:t.arcade,arcadeUtils:t,batchExec:e,aiServices:n,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel,Pixel:t.Pixel}})()),T$}const CHe=/^([0-9_])/,NHe=/[^a-z0-9_\u0080-\uffff]+/gi;function yMt(t){return t==null?null:t.trim().replaceAll(NHe,"_").replace(CHe,"F$1")||null}const OHe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],LHe=["field","normalizationField"];function vMt(t,e){if(t!=null&&e!=null){for(const n of Array.isArray(t)?t:[t])if(Nte(OHe,n,e),"visualVariables"in n&&n.visualVariables)for(const r of n.visualVariables)Nte(LHe,r,e)}}function Nte(t,e,n){if(t)for(const r of t){const i=q5(r,e),s=i&&typeof i!="function"&&n.get(i);s&&z2(r,s.name,e)}}function _Mt(t,e){if(t!=null&&e?.fields?.length)if("startField"in t){const n=e.get(t.startField),r=e.get(t.endField);t.startField=n?.name??null,t.endField=r?.name??null}else{const n=e.get(t.startTimeField),r=e.get(t.endTimeField);t.startTimeField=n?.name??null,t.endTimeField=r?.name??null}}const k$=new Set;function LB(t,e){return t&&e?(k$.clear(),Dk(k$,t,e),Array.from(k$).sort()):[]}function Dk(t,e,n){if(n)if(e?.fields?.length)if(n.includes("*"))for(const{name:r}of e.fields)t.add(r);else for(const r of n)$k(t,e,r);else{if(n.includes("*"))return t.clear(),void t.add("*");for(const r of n)r!=null&&t.add(r)}}function $k(t,e,n){if(typeof n=="string")if(e){const r=e.get(n);r&&t.add(r.name)}else t.add(n)}function xMt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(n=>n.name):e}function wMt(t,e,n=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const r=LB(t,e);return r.length/t.fields.length>=n?["*"]:r}async function F1(t,e,n,r){if(!r)return;const i=IHe(r);if(i)$k(t,e,i);else{const{arcadeUtils:s}=await MHe(),o=s.extractFieldNames(r,n?.partitions??e?.fields?.map(a=>a.name));for(const a of o)$k(t,n?.index??e,a)}}async function DB(t,e,n){if(n&&n!=="1=1"){const r=await gHe(n,e);if(!r.isStandardized)throw new Xe("fieldUtils:collectFilterFields","Where clause is not standardized",{where:n});Dk(t,e,r.fieldNames)}}function bMt({displayField:t,fields:e}){return t||(e?.length?DHe(e):null)}function DHe(t){return A$(t,"name-or-title")||A$(t,"unique-identifier")||A$(t,"type-or-category")||$He(t)}function $He(t){for(const e of t){if(!e?.name)continue;const n=e.name.toLowerCase();if(n.includes("name")||n.includes("title"))return e.name}return null}function A$(t,e){for(const n of t)if(n?.valueType&&n.valueType===e)return n.name;return null}async function EMt(t,e){if(!e)return;const n=e.elevationInfo?.featureExpressionInfo;return n?n.collectRequiredFields(t,e.fieldsIndex):void 0}function jHe(t,e,n){n.onStatisticExpression?F1(t,e,null,n.onStatisticExpression.expression):t.add(n.onStatisticField)}async function SMt(t,e,n){if(!e||!n||!("fields"in n))return;const r=[],i=n.popupTemplate;r.push(eye(t,e,i)),n.fields&&r.push(...n.fields.map(async s=>jHe(t,e.fieldsIndex,s))),await Promise.all(r)}async function TMt(t,e){const{fieldsIndex:n,trackInfo:r}=e;if(!e||!r||!n)return;const i=[r.latestObservations.renderer?.collectRequiredFields(t,n),r.previousObservations.renderer?.collectRequiredFields(t,n),r.trackLines.renderer?.collectRequiredFields(t,n)];r.popupTemplate&&i.push(eye(t,e,r.popupTemplate));for(const s of[r.latestObservations.labelingInfo,r.previousObservations.labelingInfo,r.trackLines.labelingInfo])if(s)for(const o of s)i.push(rye(t,n,o));await Promise.all(i)}async function eye(t,e,n){const r=[];n?.expressionInfos&&r.push(...n.expressionInfos.map(s=>F1(t,e.fieldsIndex,null,s.expression)));const i=n?.content;if(Array.isArray(i))for(const s of i)s.type==="expression"&&s.expressionInfo&&r.push(F1(t,e.fieldsIndex,null,s.expressionInfo.expression));await Promise.all(r)}async function kMt(t,e,n){e&&(e.timeInfo&&n?.timeExtent&&Dk(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&Dk(t,e.fieldsIndex,[e.floorInfo.floorField]),n?.where!=null&&await DB(t,e.fieldsIndex,n.where))}async function AMt(t,e,n){e&&n&&await Promise.all(n.map(r=>FHe(t,e,r)))}async function FHe(t,e,n){e&&n&&(n.valueExpression?await F1(t,e.fieldsIndex,null,n.valueExpression):n.field&&$k(t,e.fieldsIndex,n.field))}function IMt(t){return t?LB(t.fieldsIndex,tye(t)):[]}function VHe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?LB(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function RMt(t,e,n){if(!e||!n)return;const r=e.fieldsIndex;await Promise.all(n.filters.map(i=>DB(t,r,i.where)))}const zHe=new Set(["oid","global-id","guid"]),UHe=new Set(["oid","global-id"]),GHe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/objectid/i,/^perimeter_/i,/_perimeter$/i,/_i$/i];function BHe(t){const e=new Set;nye(t).forEach(r=>e.add(r)),VHe(t).forEach(r=>e.add(r.toLowerCase()));const n=t&&"infoFor3D"in t?t.infoFor3D:void 0;return n&&(Object.values(n.assetMapFieldRoles).forEach(r=>e.add(r.toLowerCase())),Object.values(n.transformFieldRoles).forEach(r=>e.add(r.toLowerCase()))),Array.from(e)}function tye(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:n,creatorField:r,editDateField:i,editorField:s}=e;return[n,r,i,s].filter(Boolean)}function nye(t){return tye(t).map(e=>e.toLowerCase())}function PMt(t,e){return t.editable&&!zHe.has(t.type)&&!nye(e).includes(t.name?.toLowerCase()??"")}function MMt(t,e){const n=t.name?.toLowerCase()??"";return!(e?.objectIdField!=null&&n===e.objectIdField.toLowerCase()||e?.globalIdField!=null&&n===e.globalIdField.toLowerCase()||BHe(e).includes(n)||UHe.has(t.type)||GHe.some(r=>r.test(n)))}async function CMt(t,e){const{labelingInfo:n,fieldsIndex:r}=e;n?.length&&await Promise.all(n.map(i=>rye(t,r,i)))}async function rye(t,e,n){if(!n)return;const r=n.getLabelExpression(),i=n.where;if(r.type==="arcade")await F1(t,e,null,r.expression);else{const s=r.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{$k(t,e,o.slice(1,-1))})}await DB(t,e,i)}function NMt(t){const e=t.defaultValue;return e!==void 0&&sye(t,e)?e:t.nullable?null:void 0}function OMt(t){const e=typeof t=="string"?{type:t}:t;return eqe(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function iye(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function WHe(t){return t===null||iye(t)}function HHe(t){return t===null||Number.isInteger(t)}function qHe(){return!0}function sye(t,e){let n;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":n=t.nullable?HHe:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":n=t.nullable?WHe:iye;break;case"string":case"esriFieldTypeString":n=t.nullable?_He:pI;break;default:n=qHe}return arguments.length===1?n:n(e)}const KHe=["integer","small-integer","big-integer","long"],YHe=["single","double"],XHe=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeLong","esriFieldTypeBigInteger"],ZHe=["esriFieldTypeSingle","esriFieldTypeDouble"],oye=new Set([...KHe,...XHe]),JHe=new Set([...YHe,...ZHe]),QHe=AG(oye,JHe);function LMt(t){return t!=null&&oye.has(t.type)}function aye(t){return t!=null&&QHe.has(t.type)}function eqe(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function tqe(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function nqe(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function rqe(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function iqe(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function DMt(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function $Mt(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function jMt(t,e){return sqe(t,e)===null}function FMt(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function sqe(t,e){return t==null||t.nullable&&e===null?null:sye(t,e)?aye(t)&&!oqe(t.type,Number(e))?"numeric-range-validation-error::out-of-range":null:"type-validation-error::invalid-type"}function oqe(t,e){const n=typeof t=="string"?lye(t):t;if(!n)return!1;const r=n.min,i=n.max;return n.isInteger?Number.isInteger(e)&&e>=r&&e<=i:e>=r&&e<=i}function lye(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return aqe;case"esriFieldTypeInteger":case"esriFieldTypeLong":case"integer":case"long":return lqe;case"esriFieldTypeBigInteger":case"big-integer":return cqe;case"esriFieldTypeSingle":case"single":return uqe;case"esriFieldTypeDouble":case"double":return hqe}}const aqe={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},lqe={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},cqe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},FP=(2-2**-23)*2**127,uqe={min:-FP,max:FP,isInteger:!1,rawMin:-FP,rawMax:FP},hqe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function VMt(t,e,n){switch(t){case"domain-validation-error::invalid-coded-value":return`Value ${n} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"domain-validation-error::value-out-of-range":return`Value ${n} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case"type-validation-error::invalid-type":return`Value ${n} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case"numeric-range-validation-error::out-of-range":{const{min:r,max:i}=lye(e.type);return`Value ${n} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${r} to ${i}`}}}function zMt(t,e){return!dqe(t,e,null)}function dqe(t,e,n){if(!t?.attributes||!e)return!0;const r=new Set(Object.keys(t.attributes));let i=!1;for(const s of e)if(!r.has(s)&&(i=!0,n==null))break;return i}function UMt(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function fqe(t){const e=t?.match(/{[^}]+}/g);return e?e.map(n=>n.slice(1,-1).split(":")[0].trim()):[]}let dC=class extends qt{constructor(e){super(e),this.type=null}};_([E({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],dC.prototype,"type",void 0),dC=_([ue("esri.popup.content.Content")],dC);const xp=dC,VP=new Gs({asc:"ascending",desc:"descending"});let iS=class extends ho(qt){constructor(e){super(e),this.field=null,this.order="ascending"}};_([E({type:String,json:{write:!0}})],iS.prototype,"field",void 0),_([E({type:VP.apiValues,json:{type:VP.jsonValues,read:VP.read,write:VP.write}})],iS.prototype,"order",void 0),iS=_([ue("esri.popup.support.AttachmentsOrderByInfo")],iS);const pqe=iS;let jh=class extends ho(xp){constructor(e){super(e),this.attachmentKeywords=null,this.attachmentTypes=null,this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};_([E({type:[String],json:{write:!0}})],jh.prototype,"attachmentKeywords",void 0),_([E({type:[["application","audio","image","model","text","video"]],json:{write:!0}})],jh.prototype,"attachmentTypes",void 0),_([E({type:String,json:{write:!0}})],jh.prototype,"description",void 0),_([E({type:["auto","preview","list"],json:{write:!0}})],jh.prototype,"displayType",void 0),_([E({type:[pqe],json:{write:!0}})],jh.prototype,"orderByFields",void 0),_([E({type:String,json:{write:!0}})],jh.prototype,"title",void 0),_([E({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],jh.prototype,"type",void 0),jh=_([ue("esri.popup.content.AttachmentsContent")],jh);const jk=jh;var k9;let H0=k9=class extends xp{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new k9({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?Ze(this.outFields):null})}};_([E()],H0.prototype,"creator",void 0),_([E()],H0.prototype,"destroyer",void 0),_([E()],H0.prototype,"outFields",void 0),_([E({type:["custom"],readOnly:!0})],H0.prototype,"type",void 0),H0=k9=_([ue("esri.popup.content.CustomContent")],H0);const mqe=H0;var A9;let G_=A9=class extends qt{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new A9({title:this.title,expression:this.expression})}};_([E({type:String,json:{write:!0}})],G_.prototype,"title",void 0),_([E({type:String,json:{write:!0}})],G_.prototype,"expression",void 0),_([E({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],G_.prototype,"returnType",void 0),G_=A9=_([ue("esri.popup.ElementExpressionInfo")],G_);const gqe=G_;var I9;let sS=I9=class extends xp{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){return new I9({expressionInfo:this.expressionInfo?.clone()})}};_([E({type:gqe,json:{write:!0}})],sS.prototype,"expressionInfo",void 0),_([E({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],sS.prototype,"type",void 0),sS=I9=_([ue("esri.popup.content.ExpressionContent")],sS);const kO=sS;let fC=class extends ho(qt){constructor(e){super(e),this.type=null}};_([E({type:["date-time","number"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],fC.prototype,"type",void 0),fC=_([ue("esri.layers.support.FieldFormat")],fC);const $B=fC,cye="auto";let pf=class extends $B{constructor(e){super(e),this.dateStyle=null,this.hour12=cye,this.month=null,this.timeStyle=null,this.type="date-time",this.year=null}};_([E({type:["full","long","medium","short"],json:{write:!0}})],pf.prototype,"dateStyle",void 0),_([E({type:["always","auto","never"],nonNullable:!0,json:{default:cye,write:!0}})],pf.prototype,"hour12",void 0),_([E({type:["long","short"],json:{write:!0}})],pf.prototype,"month",void 0),_([E({type:["full","long","medium","short"],json:{write:!0}})],pf.prototype,"timeStyle",void 0),_([E({type:["date-time"]})],pf.prototype,"type",void 0),_([E({type:["numeric"],json:{write:!0}})],pf.prototype,"year",void 0),pf=_([ue("esri.layers.support.DateTimeFieldFormat")],pf);const Qy=pf,Ote={min:0,max:20},uye=2,hye=0,dye="decimal",fye="auto";let ym=class extends $B{constructor(e){super(e),this.maximumFractionDigits=uye,this.minimumFractionDigits=hye,this.style=dye,this.type="number",this.useGrouping=fye}};_([E({type:Or,nonNullable:!0,range:Ote,json:{default:uye,write:!0}})],ym.prototype,"maximumFractionDigits",void 0),_([E({type:Or,nonNullable:!0,range:Ote,json:{default:hye,write:!0}})],ym.prototype,"minimumFractionDigits",void 0),_([E({type:["decimal"],nonNullable:!0,json:{default:dye,write:!0}})],ym.prototype,"style",void 0),_([E({type:["number"]})],ym.prototype,"type",void 0),_([E({type:["always","auto","never"],nonNullable:!0,json:{default:fye,write:!0}})],ym.prototype,"useGrouping",void 0),ym=_([ue("esri.layers.support.NumberFieldFormat")],ym);const L4=ym;let B_=class extends ho(qt){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};_([pn(v7e)],B_.prototype,"dateFormat",void 0),_([E({type:Boolean,json:{write:!0}})],B_.prototype,"digitSeparator",void 0),_([E({type:Or,json:{write:!0}})],B_.prototype,"places",void 0),B_=_([ue("esri.popup.support.FieldInfoFormat")],B_);const nb=B_,yqe={base:$B,key:"type",errorContext:"field-configuration-field-format",typeMap:{"date-time":Qy,number:L4}};function XMt(t,e){const{format:n}=t;return e&&AO(e)?n?pye(n,e):pC(e,{hour12:"always",useGrouping:"always"}):null}function pye(t,e){const{dateFormat:n}=t;if(!e)return n?Dte(t):Lte(t);if(!AO(e))return;const r={hour12:"always"};switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return mye(t);case"single":case"double":return Lte(t);case"date":case"timestamp-offset":return n?Dte(t):pC(e,r);case"date-only":return n?vqe(t):pC(e);case"time-only":return n?_qe(t):pC(e,r)}}function AO(t){return aye(t)||tqe(t)||nqe(t)||iqe(t)||rqe(t)}function mye(t){return new L4({useGrouping:t.digitSeparator?"always":"never"})}function Lte(t){const e=mye(t),{places:n}=t;return e.minimumFractionDigits=n??0,e.maximumFractionDigits=n??2,e}function Dte(t){return new Qy({dateStyle:gye(t),year:xye(t),month:vye(t),timeStyle:_ye(t),hour12:yye(t)})}function vqe(t){return new Qy({dateStyle:gye(t),year:xye(t),month:vye(t)})}function _qe(t){return new Qy({timeStyle:_ye(t),hour12:yye(t)})}function gye(t){const{dateFormat:e}=t;return e?e.startsWith("short-date")?"short":e.startsWith("day-short-month-year")?"medium":e.startsWith("long-month-day-year")?"long":e.startsWith("long-date")?"full":null:null}function yye(t){return t.dateFormat?.endsWith("-24")?"never":"always"}function vye(t){switch(t.dateFormat){case"short-month-year":return"short";case"long-month-year":return"long";default:return null}}function _ye(t){const{dateFormat:e}=t;return e?e.includes("short-time")?"short":e.includes("long-time")?"medium":null:null}function xye(t){switch(t.dateFormat){case"short-month-year":case"long-month-year":case"year":return"numeric";default:return null}}function xqe(t,e){const n=t.type==="number",r=t.type==="date-time";if(!e)return n?$te(t):r?jte(t):null;if(AO(e))switch(e.type){case"integer":case"small-integer":case"big-integer":case"long":return n?wye(t):null;case"single":case"double":return n?$te(t):null;case"date":case"timestamp-offset":return r?jte(t):null;case"date-only":return r?wqe(t):null;case"time-only":return r?bqe(t):null}}function wye(t){return new nb({digitSeparator:t.useGrouping!=="never"})}function $te(t){const e=wye(t);return e.places=t.maximumFractionDigits,e}function jte(t){let e;const n=bye(t),r=Eye(t),i=t.hour12==="never"?"24":null,s=t.year==="numeric"?"year":null,o=Sye(t);return n&&r&&i?e=`${n}-${r}-${i}`:n&&r?e=`${n}-${r}`:n?e=n:s&&o?e=`${o}-${s}`:s&&(e=s),e?new nb({dateFormat:e}):null}function wqe(t){let e;const n=bye(t),r=t.year==="numeric"?"year":null,i=Sye(t);return n?e=n:r&&i?e=`${i}-${r}`:r&&(e=r),e?new nb({dateFormat:e}):null}function bqe(t){let e;const n=Eye(t),r=t.hour12==="never"?"24":null;return n&&r?e=`short-date-${n}-${r}`:n&&(e=`short-date-${n}`),e?new nb({dateFormat:e}):null}function bye(t){switch(t.dateStyle){case"short":return"short-date";case"medium":return"day-short-month-year";case"long":return"long-month-day-year";case"full":return"long-date";default:return}}function Eye(t){return t.timeStyle&&(t.timeStyle==="short"?"short-time":"long-time")}function Sye(t){switch(t.month){case"short":return"short-month";case"long":return"long-month";default:return}}function pC(t,e){if(!AO(t))return;const n=e?.useGrouping??"auto",r=e?.hour12??"auto";switch(t.type){case"integer":case"small-integer":case"big-integer":case"long":return new L4({minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:n});case"single":case"double":return new L4({minimumFractionDigits:0,maximumFractionDigits:2,useGrouping:n});case"date":case"timestamp-offset":return new Qy({dateStyle:"short",timeStyle:"short",hour12:r});case"date-only":return new Qy({dateStyle:"short"});case"time-only":return new Qy({timeStyle:"short",hour12:r})}}let Fl=class extends ho(qt){constructor(e){super(e),this.fieldName=null,this.isEditable=!0,this.label=null,this.statisticType=null,this.stringFieldOption="text-box",this.tooltip=null,this.visible=!0}set fieldFormat(e){this._set("fieldFormat",e),this._set("format",e?xqe(e):null)}set format(e){this._set("format",e),this._set("fieldFormat",e?pye(e):null)}readFormat(e,n){if(!n.fieldFormat)return e?nb.fromJSON(e):null}clone(){const e=super.clone();return e._set("format",this.format?.clone()),e._set("fieldFormat",this.fieldFormat?.clone()),e}};_([E({value:null,clonable:!1,types:yqe,json:{write:{overridePolicy(t,e,n){const{fieldName:r}=this;return{enabled:!!r&&!r.startsWith("expression/")&&!r.startsWith("relationships/")&&!!n?.writeFieldFormat}}}}})],Fl.prototype,"fieldFormat",null),_([E({type:String,json:{write:!0}})],Fl.prototype,"fieldName",void 0),_([E({value:null,clonable:!1,type:nb,json:{write:!0}})],Fl.prototype,"format",null),_([sr("format")],Fl.prototype,"readFormat",null),_([E({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Fl.prototype,"isEditable",void 0),_([E({type:String,json:{write:!0}})],Fl.prototype,"label",void 0),_([E({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Fl.prototype,"statisticType",void 0),_([pn(new Gs({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Fl.prototype,"stringFieldOption",void 0),_([E({type:String,json:{write:!0}})],Fl.prototype,"tooltip",void 0),_([E({type:Boolean,json:{write:!0}})],Fl.prototype,"visible",void 0),Fl=_([ue("esri.popup.FieldInfo")],Fl);const Tye=Fl;var R9;let vm=R9=class extends xp{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}clone(){return new R9(Ze({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};_([E({type:Object,json:{write:!0}})],vm.prototype,"attributes",void 0),_([E({type:String,json:{write:!0}})],vm.prototype,"description",void 0),_([E({type:[Tye],json:{write:!0}})],vm.prototype,"fieldInfos",void 0),_([E({type:String,json:{write:!0}})],vm.prototype,"title",void 0),_([E({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],vm.prototype,"type",void 0),vm=R9=_([ue("esri.popup.content.FieldsContent")],vm);const Fk=vm;let q0=class extends qt{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};_([E({type:String,json:{write:!0}})],q0.prototype,"altText",void 0),_([E({type:String,json:{write:!0}})],q0.prototype,"caption",void 0),_([E({type:String,json:{write:!0}})],q0.prototype,"title",void 0),_([E({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],q0.prototype,"type",void 0),q0=_([ue("esri.popup.content.mixins.MediaInfo")],q0);const jB=q0;var P9;let K0=P9=class extends Kt{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new P9({color:this.color?.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};_([E()],K0.prototype,"color",void 0),_([E()],K0.prototype,"fieldName",void 0),_([E()],K0.prototype,"tooltip",void 0),_([E()],K0.prototype,"value",void 0),K0=P9=_([ue("esri.popup.content.support.ChartMediaInfoValueSeries")],K0);const Eqe=K0;var M9;let _m=M9=class extends qt{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new M9({colors:Ze(this.colors),fields:Ze(this.fields),normalizeField:this.normalizeField,series:Ze(this.series),tooltipField:this.tooltipField})}};_([E({type:[Kn],json:{type:[[Or]],write:!0}})],_m.prototype,"colors",void 0),_([E({type:[String],json:{write:{isRequired:!0}}})],_m.prototype,"fields",void 0),_([E({type:String,json:{write:!0}})],_m.prototype,"normalizeField",void 0),_([E({type:[Eqe],json:{read:!1}})],_m.prototype,"series",void 0),_([E({type:String,json:{write:!0}})],_m.prototype,"tooltipField",void 0),_m=M9=_([ue("esri.popup.content.support.ChartMediaInfoValue")],_m);const Sqe=_m;let oS=class extends jB{constructor(e){super(e),this.type=null,this.value=void 0}};_([E({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],oS.prototype,"type",void 0),_([E({type:Sqe,json:{write:{isRequired:!0}}})],oS.prototype,"value",void 0),oS=_([ue("esri.popup.content.mixins.ChartMediaInfo")],oS);const IO=oS,RO=kl()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var C9;let mC=C9=class extends IO{constructor(t){super(t),this.type="bar-chart"}clone(){return new C9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:RO.write,isRequired:!0}}})],mC.prototype,"type",void 0),mC=C9=_([ue("esri.popup.content.BarChartMediaInfo")],mC);const kye=mC;var N9;let gC=N9=class extends IO{constructor(t){super(t),this.type="column-chart"}clone(){return new N9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:RO.write,isRequired:!0}}})],gC.prototype,"type",void 0),gC=N9=_([ue("esri.popup.content.ColumnChartMediaInfo")],gC);const Aye=gC;var O9;let aS=O9=class extends qt{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new O9({linkURL:this.linkURL,sourceURL:this.sourceURL})}};_([E({type:String,json:{write:!0}})],aS.prototype,"linkURL",void 0),_([E({type:String,json:{write:{isRequired:!0}}})],aS.prototype,"sourceURL",void 0),aS=O9=_([ue("esri.popup.content.support.ImageMediaInfoValue")],aS);const Tqe=aS;var L9;let W_=L9=class extends jB{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){return new L9({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?.clone()})}};_([E({type:Number,json:{write:!0}})],W_.prototype,"refreshInterval",void 0),_([E({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],W_.prototype,"type",void 0),_([E({type:Tqe,json:{write:{isRequired:!0}}})],W_.prototype,"value",void 0),W_=L9=_([ue("esri.popup.content.ImageMediaInfo")],W_);const Iye=W_;var D9;let yC=D9=class extends IO{constructor(t){super(t),this.type="line-chart"}clone(){return new D9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:RO.write,isRequired:!0}}})],yC.prototype,"type",void 0),yC=D9=_([ue("esri.popup.content.LineChartMediaInfo")],yC);const Rye=yC;var $9;let vC=$9=class extends IO{constructor(t){super(t),this.type="pie-chart"}clone(){return new $9({altText:this.altText,title:this.title,caption:this.caption,value:this.value?.clone()})}};_([E({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:RO.write,isRequired:!0}}})],vC.prototype,"type",void 0),vC=$9=_([ue("esri.popup.content.PieChartMediaInfo")],vC);const Pye=vC,j9={base:jB,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":kye,"column-chart":Aye,"line-chart":Rye,"pie-chart":Pye,image:Iye}};var F9;let Du=F9=class extends xp{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?Iye.fromJSON(e):e.type==="barchart"?kye.fromJSON(e):e.type==="columnchart"?Aye.fromJSON(e):e.type==="linechart"?Rye.fromJSON(e):e.type==="piechart"?Pye.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(n=>n.toJSON())}clone(){return new F9(Ze({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};_([E()],Du.prototype,"activeMediaInfoIndex",void 0),_([E({type:Object,json:{write:!0}})],Du.prototype,"attributes",void 0),_([E({type:String,json:{write:!0}})],Du.prototype,"description",void 0),_([E({types:[j9]})],Du.prototype,"mediaInfos",void 0),_([sr("mediaInfos")],Du.prototype,"readMediaInfos",null),_([Xn("mediaInfos")],Du.prototype,"writeMediaInfos",null),_([E({type:String,json:{write:!0}})],Du.prototype,"title",void 0),_([E({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Du.prototype,"type",void 0),Du=F9=_([ue("esri.popup.content.MediaContent")],Du);const Vk=Du;var V9;let lS=V9=class extends qt{constructor(t){super(t),this.field=null,this.order=null}clone(){return new V9({field:this.field,order:this.order})}};_([E({type:String,json:{write:!0}})],lS.prototype,"field",void 0),_([E({type:["asc","desc"],json:{write:!0}})],lS.prototype,"order",void 0),lS=V9=_([ue("esri.popup.support.RelatedRecordsInfoFieldOrder")],lS);const Mye=lS;let Fh=class extends ho(xp){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};_([E({type:String,json:{write:!0}})],Fh.prototype,"description",void 0),_([E({type:Number,json:{type:Or,write:!0}})],Fh.prototype,"displayCount",void 0),_([E({type:["list"],json:{write:{isRequired:!0}}})],Fh.prototype,"displayType",void 0),_([E({type:[Mye],json:{write:!0}})],Fh.prototype,"orderByFields",void 0),_([E({type:Number,json:{type:Or,write:{isRequired:!0}}})],Fh.prototype,"relationshipId",void 0),_([E({type:String,json:{write:!0}})],Fh.prototype,"title",void 0),_([E({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Fh.prototype,"type",void 0),Fh=_([ue("esri.popup.content.RelationshipContent")],Fh);const zk=Fh;var z9;let cS=z9=class extends xp{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new z9({text:this.text})}};_([E({type:String,json:{write:!0}})],cS.prototype,"text",void 0),_([E({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],cS.prototype,"type",void 0),cS=z9=_([ue("esri.popup.content.TextContent")],cS);const Uk=cS;let mf=class extends ho(qt){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};_([E({type:String,json:{write:!0}})],mf.prototype,"title",void 0),_([E({type:String,json:{write:!0}})],mf.prototype,"description",void 0),_([E({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],mf.prototype,"type",void 0),_([E({type:Number,json:{type:Or,write:!0}})],mf.prototype,"associatedNetworkSourceId",void 0),_([E({type:Number,json:{type:Or,write:!0}})],mf.prototype,"associatedAssetGroup",void 0),_([E({type:Number,json:{type:Or,write:!0}})],mf.prototype,"associatedAssetType",void 0),mf=_([ue("esri.popup.support.UtilityNetworkAssociationType")],mf);const kqe=mf;let xm=class extends ho(xp){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};_([E({type:String,json:{write:!0}})],xm.prototype,"description",void 0),_([E({type:Number,json:{type:Or,write:!0}})],xm.prototype,"displayCount",void 0),_([E({type:String,json:{write:!0}})],xm.prototype,"title",void 0),_([E({type:[kqe],json:{write:!0}})],xm.prototype,"associationTypes",void 0),_([pn({utilityNetworkAssociations:"utility-network-associations"})],xm.prototype,"type",void 0),xm=_([ue("esri.popup.content.UtilityNetworkAssociationsContent")],xm);const FB=xm,Aqe={base:null,key:"type",typeMap:{attachment:jk,media:Vk,text:Uk,expression:kO,field:Fk,relationship:zk,utilityNetworkAssociations:FB}},Iqe={base:null,key:"type",typeMap:{attachment:jk,media:Vk,text:Uk,expression:kO,field:Fk,relationship:zk}};var U9;let Y0=U9=class extends qt{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new U9({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};_([E({type:String,json:{write:!0}})],Y0.prototype,"name",void 0),_([E({type:String,json:{write:!0}})],Y0.prototype,"title",void 0),_([E({type:String,json:{write:!0}})],Y0.prototype,"expression",void 0),_([E({type:["string","number"],json:{write:!0}})],Y0.prototype,"returnType",void 0),Y0=U9=_([ue("esri.popup.ExpressionInfo")],Y0);const Rqe=Y0;var G9;let uS=G9=class extends qt{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new G9({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};_([E({type:Boolean,json:{write:!0}})],uS.prototype,"returnTopmostRaster",void 0),_([E({type:Boolean,json:{write:!0}})],uS.prototype,"showNoDataRecords",void 0),uS=G9=_([ue("esri.popup.LayerOptions")],uS);const Pqe=uS;var B9;let hS=B9=class extends qt{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new B9({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?Ze(this.orderByFields):null})}};_([E({type:Boolean,json:{write:!0}})],hS.prototype,"showRelatedRecords",void 0),_([E({type:[Mye],json:{write:!0}})],hS.prototype,"orderByFields",void 0),hS=B9=_([ue("esri.popup.RelatedRecordsInfo")],hS);const Fte=hS;var W9;let Mc=W9=class extends lB(Kt){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new W9({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};_([E()],Mc.prototype,"active",void 0),_([E()],Mc.prototype,"className",void 0),_([E()],Mc.prototype,"disabled",void 0),_([E()],Mc.prototype,"icon",void 0),_([E()],Mc.prototype,"id",void 0),_([E()],Mc.prototype,"indicator",void 0),_([E()],Mc.prototype,"title",void 0),_([E()],Mc.prototype,"type",void 0),_([E()],Mc.prototype,"visible",void 0),Mc=W9=_([ue("esri.support.actions.ActionBase")],Mc);const VB=Mc;var H9;let _C=H9=class extends VB{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new H9({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};_([E()],_C.prototype,"image",void 0),_C=H9=_([ue("esri.support.actions.ActionButton")],_C);const Mqe=_C;var q9;let dS=q9=class extends VB{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new q9({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};_([E()],dS.prototype,"image",void 0),_([E()],dS.prototype,"value",void 0),dS=q9=_([ue("esri.support.actions.ActionToggle")],dS);const Cqe=dS,TE="relationships/",Vte="expression/",Nqe=Ot.ofType({key:"type",defaultKeyValue:"button",base:VB,typeMap:{button:Mqe,toggle:Cqe}}),Oqe={base:xp,key:"type",typeMap:{media:Vk,custom:mqe,text:Uk,attachments:jk,fields:Fk,expression:kO,relationship:zk,utilityNetworkAssociations:FB}},Cye=new Set(["attachments","fields","media","text","expression","relationship"]),Lqe=new Set([...Cye,"utility-network-associations"]);let ms=class extends ho(qt){constructor(e){super(e),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(n=>Cg(Oqe,n)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||da(e)?e:(St.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,n){const{popupElements:r}=n;return Array.isArray(r)&&r.length>0?this._readPopupInfoElements(n.description,n.mediaInfos,r):this._readPopupInfo(n)}writeWebSceneContent(e,n,r,i){this._writePopupTemplateContent(e,n,i)}writeWebMapContent(e,n,r,i){this._writePopupTemplateContent(e,n,i)}writeFieldInfos(e,n,r,i){const{content:s}=this,o=Array.isArray(s)?s:null,{writeFieldFormat:a,...l}=i||{};if(e){const c=o?o.filter(h=>h.type==="fields"):[],u=c.length&&c.every(h=>h.fieldInfos?.length);n.fieldInfos=e.filter(Boolean).map(h=>{const f=h.toJSON(l);return u&&(f.visible=!1),f})}if(o)for(const c of o)c.type==="fields"&&this._writeFieldsContent(c,n,l)}writeLayerOptions(e,n,r,i){n[r]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(i)}writeTitle(e,n){n.title=e||""}async collectRequiredFields(e,n,r){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(e,n,r,[...i,...this._getContentExpressionInfos(this.content,i)]),Dk(e,n,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e,n){const r=new Set;return await this.collectRequiredFields(r,e,n),[...r].sort()}_writePopupTemplateContent(e,n,r){typeof e!="string"?Array.isArray(e)&&(n.popupElements=e.filter(i=>r?.origin==="web-scene"?Cye.has(i.type):Lqe.has(i.type)).map(i=>i?.toJSON(r)),n.popupElements.forEach(i=>{i.type==="attachments"?this._writeAttachmentContent(n):i.type==="media"?this._writeMediaContent(i,n):i.type==="text"?this._writeTextContent(i,n):i.type==="relationship"&&this._writeRelationshipContent(i,n)})):n.description=e}_writeFieldsContent(e,n,r){const i=e.fieldInfos;if(!Array.isArray(i)||!i.length)return;const s=n.fieldInfos;if(Array.isArray(s))for(const o of i){const a=s.find(l=>l.fieldName?.toLowerCase()===o.fieldName?.toLowerCase());a?a.visible=!0:s.push(o.toJSON(r))}else n.fieldInfos=i.map(o=>o.toJSON(r))}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,n){const r=e.orderByFields?.map(s=>this._toFieldOrderJSON(s,e.relationshipId))||[],i=[...n.relatedRecordsInfo?.orderByFields||[],...r];n.relatedRecordsInfo={showRelatedRecords:!0,...i?.length&&{orderByFields:i}}}_writeTextContent(e,n){!n.description&&e.text&&(n.description=e.text)}_writeMediaContent(e,n){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const r=Ze(e.mediaInfos);Array.isArray(n.mediaInfos)?n.mediaInfos=[...n.mediaInfos,...r]:n.mediaInfos=r}_readPopupInfoElements(e,n,r){const i={description:!1,mediaInfos:!1};return r.map(s=>s.type==="media"?(s.mediaInfos||!n||i.mediaInfos||(s.mediaInfos=n,i.mediaInfos=!0),Vk.fromJSON(s)):s.type==="text"?(s.text||!e||i.description||(s.text=e,i.description=!0),Uk.fromJSON(s)):s.type==="attachments"?jk.fromJSON(s):s.type==="fields"?Fk.fromJSON(s):s.type==="expression"?kO.fromJSON(s):s.type==="relationship"?zk.fromJSON(s):s.type==="utilityNetworkAssociations"?FB.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:n,order:r}=e;if(!n?.startsWith(TE))return null;const i=n.replace(TE,"").split("/");if(i.length!==2)return null;const s=parseInt(i[0],10),o=i[1];return!Number.isNaN(s)&&o?zk.fromJSON({relationshipId:s,orderByFields:[{field:o,order:r}]}):null}_toFieldOrderJSON(e,n){const{order:r,field:i}=e;return{field:`${TE}${n}/${i}`,order:r}}_readPopupInfo({description:e,mediaInfos:n,showAttachments:r,relatedRecordsInfo:i={showRelatedRecords:!1}}){const s=[];e?s.push(new Uk({text:e})):s.push(new Fk),Array.isArray(n)&&n.length&&s.push(Vk.fromJSON({mediaInfos:n})),r&&s.push(jk.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=i;return o&&a?.length&&a.forEach(l=>{const c=this._toRelationshipContent(l);c&&s.push(c)}),s.length?s:e}_getContentElementFields(e){const n=e?.type;if(n==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(n==="custom")return e.outFields||[];if(n==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(n==="media"){const r=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...r.reduce((i,s)=>[...i,...this._getMediaInfoFields(s)],[])]}return n==="text"?this._extractFieldNames(e.text):n==="relationship"||n==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:n,title:r,value:i}=e,s=i||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:c,linkURL:u}=s,h=[...this._extractFieldNames(r),...this._extractFieldNames(n),...this._extractFieldNames(c),...this._extractFieldNames(u),...o??[]];return a&&h.push(a),l&&h.push(l),h}_getContentExpressionInfos(e,n){return Array.isArray(e)?e.reduce((r,i)=>[...r,...i.type==="expression"&&i.expressionInfo?[i.expressionInfo]:[]],n):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((n,r)=>[...n,...this._getContentElementFields(r)],[]):[]}async _collectExpressionInfoFields(e,n,r,i){i&&await Promise.all(i.map(s=>F1(e,n,r,s.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:n,visible:r})=>!(r!==void 0&&!r||!n||n.startsWith(TE)||n.startsWith(Vte))).map(n=>n.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((n,r)=>[...n,...this._getActionFields(r)],[]):[]}_getActionFields(e){const{className:n,title:r,type:i}=e,s=i==="button"||i==="toggle"?e.image:"";return[...this._extractFieldNames(r),...this._extractFieldNames(n),...this._extractFieldNames(s)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return fqe(e).filter(n=>!(n.startsWith(TE)||n.startsWith(Vte)))}};_([E({type:Nqe})],ms.prototype,"actions",void 0),_([E()],ms.prototype,"content",void 0),_([zs("content")],ms.prototype,"castContent",null),_([sr("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],ms.prototype,"readContent",null),_([Xn("web-scene","content",{popupElements:{type:Ot.ofType(Iqe)},showAttachments:{type:Boolean},mediaInfos:{type:Ot.ofType(j9)},description:{type:String},relatedRecordsInfo:{type:Fte}})],ms.prototype,"writeWebSceneContent",null),_([Xn("content",{popupElements:{type:Ot.ofType(Aqe)},showAttachments:{type:Boolean},mediaInfos:{type:Ot.ofType(j9)},description:{type:String},relatedRecordsInfo:{type:Fte}})],ms.prototype,"writeWebMapContent",null),_([E({type:[Rqe],json:{write:!0}})],ms.prototype,"expressionInfos",void 0),_([E({type:[Tye]})],ms.prototype,"fieldInfos",void 0),_([Xn("fieldInfos")],ms.prototype,"writeFieldInfos",null),_([E({type:Pqe})],ms.prototype,"layerOptions",void 0),_([Xn("layerOptions")],ms.prototype,"writeLayerOptions",null),_([E({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],ms.prototype,"lastEditInfoEnabled",void 0),_([E()],ms.prototype,"outFields",void 0),_([E()],ms.prototype,"overwriteActions",void 0),_([E()],ms.prototype,"returnGeometry",void 0),_([E({json:{type:String}})],ms.prototype,"title",void 0),_([Xn("title")],ms.prototype,"writeTitle",null),ms=_([ue("esri.PopupTemplate")],ms);const Dqe=ms,Nye=Symbol("idFieldsProviderSymbol");function $qe(t){return!!t&&Nye in t}function zte(t){return $qe(t)?t[Nye]:void 0}const Oye=Symbol("popupProvider");function iCt(t){return typeof t=="object"&&t!==null&&"popupEnabled"in t&&"popupTemplate"in t}function jqe(t){return!!t&&Oye in t}function Fqe(t){return jqe(t)?t[Oye]:null}function sCt(t,e){switch(e.type){case"object-id":case"unique-id-simple":return t.attributes[e.fieldName];case"unique-id-composite":{const n=[];for(const r of e.fieldNames)n.push(t.attributes[r]??null);return JSON.stringify(n)}}}function Ute(t,e){if("uniqueIdFields"in e&&e.uniqueIdFields?.length){if(e.uniqueIdFields.length===1)return t.attributes?.[e.uniqueIdFields[0]];const n=e.uniqueIdFields.map(r=>t.attributes?.[r]);return JSON.stringify(n)}return"objectIdField"in e&&e.objectIdField?t.attributes?.[e.objectIdField]:null}const Gte=new Gs({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let Vqe=0,us=class extends qt{constructor(e){super(e),this.id="sym"+Vqe++,this.type=null,this.color=new Kn([0,0,0,1])}readColor(e){return e?.[0]!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,n){}hash(){return JSON.stringify(this.toJSON())}clone(){}};_([E({type:Gte.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:Gte.write,isRequired:!0}}})],us.prototype,"type",void 0),_([E({type:Kn,json:{write:{allowNull:!0}}})],us.prototype,"color",void 0),_([sr("color")],us.prototype,"readColor",null),us=_([ue("esri.symbols.Symbol")],us);var K9;let ol=K9=class extends us{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){if(this.data?.type==="CIMSymbolReference"){const n=this.data.primitiveOverrides;if(n){const r=n.map(i=>{const s=i.valueExpressionInfo;return s?F1(t,e,null,s.expression):null});await Promise.all(r)}}}clone(){return new K9({data:Ze(this.data)})}hash(){return hde(JSON.stringify(this.data)).toString()}};_([E({json:{write:!1}})],ol.prototype,"color",void 0),_([E({json:{write:!0}})],ol.prototype,"data",void 0),_([sr("data",["symbol"])],ol.prototype,"readData",null),_([Xn("data",{})],ol.prototype,"writeData",null),_([pn({CIMSymbolReference:"cim"},{readOnly:!0})],ol.prototype,"type",void 0),ol=K9=_([ue("esri.symbols.CIMSymbol")],ol);let Pa=class extends qt{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,n,r){e||(n[r]=e)}};_([E({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],Pa.prototype,"enabled",void 0),_([Xn("enabled")],Pa.prototype,"writeEnabled",null),_([E({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],Pa.prototype,"type",void 0),Pa=_([ue("esri.symbols.Symbol3DLayer")],Pa);function zqe(t,e){const n=e.transparency!=null?Kme(e.transparency):1,r=e.color;return r&&Array.isArray(r)?new Kn([r[0]||0,r[1]||0,r[2]||0,n]):null}function Uqe(t,e){e.color=t.toJSON().slice(0,3);const n=qme(t.a);n!==0&&(e.transparency=n)}function Jg(t){return{type:Kn,nonNullable:t?.nonNullable,json:{type:[Or],default:null,read:{source:["color","transparency"],reader:zqe},write:{target:{color:{type:[Or],isRequired:t?.colorRequiredOnWrite},transparency:{type:Or}},writer:Uqe}}}}const Id={type:Number,cast:wi,json:{write:!0}};function lCt(t){return t==="emissive"?0:1}let X0=class extends qt{constructor(e){super(e),this.color=new Kn([0,0,0,1]),this.extensionLength=0,this.size=j1(1)}clone(){}cloneProperties(){return{color:Ze(this.color),size:this.size,extensionLength:this.extensionLength}}};_([E({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],X0.prototype,"type",void 0),_([E(Jg({colorRequiredOnWrite:!0}))],X0.prototype,"color",void 0),_([E({...Id,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],X0.prototype,"extensionLength",void 0),_([E(Id)],X0.prototype,"size",void 0),X0=_([ue("esri.symbols.edges.Edges3D")],X0);const zB=X0;var Y9;let xC=Y9=class extends zB{constructor(t){super(t),this.type="sketch"}clone(){return new Y9(this.cloneProperties())}};_([pn({sketch:"sketch"},{readOnly:!0})],xC.prototype,"type",void 0),xC=Y9=_([ue("esri.symbols.edges.SketchEdges3D")],xC);const Gqe=xC;var X9;let wC=X9=class extends zB{constructor(t){super(t),this.type="solid"}clone(){return new X9(this.cloneProperties())}};_([pn({solid:"solid"},{readOnly:!0})],wC.prototype,"type",void 0),wC=X9=_([ue("esri.symbols.edges.SolidEdges3D")],wC);const Bqe=wC,Lye={types:{key:"type",base:zB,typeMap:{solid:Bqe,sketch:Gqe}},json:{write:!0}};var Z9;let mx=Z9=class extends qt{constructor(){super(...arguments),this.strength=null,this.source="emissive"}clone(){const t={strength:this.strength,source:this.source};return new Z9(t)}};_([E({json:{write:!1}})],mx.prototype,"strength",void 0),_([E({json:{write:!1}})],mx.prototype,"source",void 0),mx=Z9=_([ue("esri.symbols.support.Symbol3DEmissive")],mx);var J9;let ic=J9=class extends qt{constructor(t){super(t),this.color=null,this.emissive=new mx({source:"emissive"})}clone(){const t={color:this.color?.clone()??null,emissive:this.emissive?.clone()??null};return new J9(t)}};_([E(Jg())],ic.prototype,"color",void 0),_([E({type:mx,json:{write:!1}})],ic.prototype,"emissive",void 0),ic=J9=_([ue("esri.symbols.support.Symbol3DMaterial")],ic);var Q9,yw;let Ef=(yw=class extends Pa{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new Q9({edges:this.edges?.clone(),enabled:this.enabled,material:this.material?.clone(),castShadows:this.castShadows,size:this.size})}},Q9=yw,yw);_([pn({Extrude:"extrude"},{readOnly:!0})],Ef.prototype,"type",void 0),_([E({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Ef.prototype,"size",void 0),_([E({type:ic,json:{write:!0}})],Ef.prototype,"material",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Ef.prototype,"castShadows",void 0),_([E(Lye)],Ef.prototype,"edges",void 0),Ef=Q9=_([ue("esri.symbols.ExtrudeSymbol3DLayer")],Ef);let cT=class extends qt{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};_([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],cT.prototype,"type",void 0),cT=_([ue("esri.symbols.patterns.LinePattern3D")],cT);const Wqe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var e7;const Hqe=kl()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Cy=e7=class extends cT{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new e7(t)}};_([E({type:["style"],json:{write:{isRequired:!0}}})],Cy.prototype,"type",void 0),_([pn(Hqe),E({type:Wqe,json:{write:{isRequired:!0}}})],Cy.prototype,"style",void 0),Cy=e7=_([ue("esri.symbols.patterns.LineStylePattern3D")],Cy);let uT=class extends qt{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};_([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],uT.prototype,"type",void 0),uT=_([ue("esri.symbols.patterns.Pattern3D")],uT);const qqe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var t7;let gx=t7=class extends uT{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new t7({style:this.style})}};_([E({type:["style"],json:{write:{isRequired:!0}}})],gx.prototype,"type",void 0),_([E({type:qqe,json:{read:!0,write:{isRequired:!0}}})],gx.prototype,"style",void 0),gx=t7=_([ue("esri.symbols.patterns.StylePattern3D")],gx);const Kqe={types:{key:"type",base:uT,typeMap:{style:gx}},json:{write:!0}},Dye={types:{key:"type",base:cT,typeMap:{style:Cy}},json:{write:!0}},hT=new Kn("white"),Yqe=new Kn([255,255,255,0]);function Xqe(t){return t.r===0&&t.g===0&&t.b===0}var n7;let dT=n7=class extends ic{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:this.color?.clone()??null,colorMixMode:this.colorMixMode,emissive:this.emissive?.clone()??null};return new n7(t)}};_([pn({multiply:"multiply",replace:"replace",tint:"tint"})],dT.prototype,"colorMixMode",void 0),dT=n7=_([ue("esri.symbols.support.Symbol3DFillMaterial")],dT);function UB(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Zqe(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function Jqe(t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x){return[t,e,n,r,i,s,o,a,l,c,u,h,f,g,v,x]}const Qqe=UB();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:Qqe,clone:Zqe,create:UB,fromValues:Jqe},Symbol.toStringTag,{value:"Module"}));function eKe(t){return t<=rde?new Array(t).fill(0):new Float64Array(t)}function dCt(t){return(nDe(t)?t.byteLength/8:t.length)<=rde?Array.from(t):new Float64Array(t)}function fCt(t,e,n){return Array.isArray(t)?t.slice(e,e+n):t.subarray(e,e+n)}function pCt(t){return[...t]}function mCt(t){const e=UB();for(let n=0;n<16;++n)e[n]=t[n];return e}function mI(t=iKe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function GB(t,e,n,r,i,s,o=mI()){return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=s,o}function gCt(t,e=mI()){return tKe(t,0,t.length/3,e)}function tKe(t,e,n,r=mI()){return $ye(r,r7),nKe(r,t,e,n),r}function yCt(t,e=eKe(24)){const[n,r,i,s,o,a]=t;return e[0]=n,e[1]=r,e[2]=i,e[3]=n,e[4]=r,e[5]=a,e[6]=n,e[7]=o,e[8]=i,e[9]=n,e[10]=o,e[11]=a,e[12]=s,e[13]=r,e[14]=i,e[15]=s,e[16]=r,e[17]=a,e[18]=s,e[19]=o,e[20]=i,e[21]=s,e[22]=o,e[23]=a,e}function vCt(t,e){const n=isFinite(t[2])||isFinite(t[5]);return new Dn(n?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function _Ct(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function xCt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function wCt(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function nKe(t,e,n=0,r=e.length/3){let i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];for(let u=0;u<r;u++)i=Math.min(i,e[n+3*u]),s=Math.min(s,e[n+3*u+1]),o=Math.min(o,e[n+3*u+2]),a=Math.max(a,e[n+3*u]),l=Math.max(l,e[n+3*u+1]),c=Math.max(c,e[n+3*u+2]);t[0]=i,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function bCt(t,e,n){const r=e.length;let i=t[0],s=t[1],o=t[2],a=t[3],l=t[4],c=t[5];if(n)for(let u=0;u<r;u++){const h=e[u];i=Math.min(i,h[0]),s=Math.min(s,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),l=Math.max(l,h[1]),c=Math.max(c,h[2])}else for(let u=0;u<r;u++){const h=e[u];i=Math.min(i,h[0]),s=Math.min(s,h[1]),a=Math.max(a,h[0]),l=Math.max(l,h[1])}t[0]=i,t[1]=s,t[2]=o,t[3]=a,t[4]=l,t[5]=c}function ECt(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function gI(t){return t[0]>=t[3]?0:t[3]-t[0]}function yI(t){return t[1]>=t[4]?0:t[4]-t[1]}function vI(t){return t[2]>=t[5]?0:t[5]-t[2]}function SCt(t){const e=gI(t),n=vI(t),r=yI(t);return Math.sqrt(e*e+n*n+r*r)}function TCt(t,e=[0,0,0]){return e[0]=t[0]+gI(t)/2,e[1]=t[1]+yI(t)/2,e[2]=t[2]+vI(t)/2,e}function kCt(t,e=[0,0,0]){return e[0]=gI(t),e[1]=yI(t),e[2]=vI(t),e}function ACt(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function rKe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function ICt(t,e){return e==null||rKe(t,e)}function RCt(t,e,n,r,i=t){return i[0]=t[0]+e,i[1]=t[1]+n,i[2]=t[2]+r,i[3]=t[3]+e,i[4]=t[4]+n,i[5]=t[5]+r,i}function PCt(t,e,n=t){const r=t[0]+gI(t)/2,i=t[1]+yI(t)/2,s=t[2]+vI(t)/2;return n[0]=r+(t[0]-r)*e,n[1]=i+(t[1]-i)*e,n[2]=s+(t[2]-s)*e,n[3]=r+(t[3]-r)*e,n[4]=i+(t[4]-i)*e,n[5]=s+(t[5]-s)*e,n}function MCt(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function CCt(t,e,n=t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n!==t&&(n[3]=t[3],n[4]=t[4],n[5]=t[5]),n}function NCt(t,e,n=t){return n[3]=e[0],n[4]=e[1],n[5]=e[2],n!==t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),t}function $ye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function OCt(t){return t?$ye(t,r7):mI(r7)}function LCt(t,e=pl()){return e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function DCt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function $Ct(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=Number.NEGATIVE_INFINITY,t[3]=r,t[4]=i,t[5]=Number.POSITIVE_INFINITY,t}function Bte(t){return t.length===6}function jCt(t){return gI(t)===0&&yI(t)===0&&vI(t)===0}function FCt(t,e,n){if(t==null||e==null)return t===e;if(!Bte(t)||!Bte(e))return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}const r7=[1/0,1/0,1/0,-1/0,-1/0,-1/0],iKe=[0,0,0,0,0,0];mI();function VCt(t,{isPrimitive:e,width:n,depth:r,height:i}){const s=e?10:1;if(n==null&&i==null&&r==null)return[s*t[0],s*t[1],s*t[2]];const o=tb(n,r,i);let a;for(let l=0;l<3;l++){const c=o[l];if(c!=null){a=c/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const sKe=GB(-.5,-.5,-.5,.5,.5,.5),oKe=GB(-.5,-.5,0,.5,.5,1),aKe=GB(-.5,-.5,0,.5,.5,.5);function zCt(t){switch(t){case"sphere":case"cube":case"diamond":return sKe;case"cylinder":case"cone":case"inverted-cone":return oKe;case"tetrahedron":return aKe;default:return}}const BB=["butt","square","round"],lKe=[...BB,"none"],jye=["miter","bevel","round"];var i7;let Z0=i7=class extends qt{constructor(t){super(t),this.color=new Kn([0,0,0,1]),this.size=j1(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new i7(t)}};_([E(Jg({colorRequiredOnWrite:!0}))],Z0.prototype,"color",void 0),_([E({...Id,json:{write:{isRequired:!0}}})],Z0.prototype,"size",void 0),_([E(Dye)],Z0.prototype,"pattern",void 0),_([E({type:BB,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Z0.prototype,"patternCap",void 0),Z0=i7=_([ue("esri.symbols.support.Symbol3DOutline")],Z0);var bC,vw;let Wl=(vw=class extends Pa{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new bC(e)}static fromSimpleFillSymbol(e){const n=e.outline&&e.outline.style&&e.outline.style!=="solid"?new Cy({style:e.outline.style}):null,r={size:e.outline?.width??0,color:(e.outline?.color??hT).clone(),pattern:n};return n&&e.outline?.cap&&(r.patternCap=e.outline.cap),new bC({material:new dT({color:(e.color??Yqe).clone()}),pattern:e.style&&e.style!=="solid"?new gx({style:e.style}):null,outline:r})}},bC=vw,vw);_([pn({Fill:"fill"},{readOnly:!0})],Wl.prototype,"type",void 0),_([E({type:dT,json:{write:!0}})],Wl.prototype,"material",void 0),_([E(Kqe)],Wl.prototype,"pattern",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Wl.prototype,"castShadows",void 0),_([E({type:Z0,json:{write:!0}})],Wl.prototype,"outline",void 0),_([E(Lye)],Wl.prototype,"edges",void 0),Wl=bC=_([ue("esri.symbols.FillSymbol3DLayer")],Wl);var s7;const cKe=kl()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let J0=s7=class extends qt{constructor(t){super(t)}readHref(t,e,n){return t?W2(t,n):e.dataURI}writeHref(t,e,n,r){t&&(nv(t)?e.dataURI=t:(e.href=n2(t,r),yl(e.href)&&(e.href=pg(e.href))))}clone(){return new s7({href:this.href,primitive:this.primitive})}equals(t){return t.primitive===this.primitive&&t.href===this.href}};_([E({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],J0.prototype,"href",void 0),_([sr("href")],J0.prototype,"readHref",null),_([Xn("href",{href:{type:String},dataURI:{type:String}})],J0.prototype,"writeHref",null),_([pn(cKe)],J0.prototype,"primitive",void 0),J0=s7=_([ue("esri.symbols.support.IconSymbol3DLayerResource")],J0);const UCt="circle";let EC=class extends ho(qt){constructor(e){super(e),this.mode="hidden"}equals(e){return this.mode===e.mode}};_([E({type:["adaptive","hidden","visible"],json:{write:{isRequired:!0}}})],EC.prototype,"mode",void 0),EC=_([ue("esri.symbols.support.OccludedVisibility")],EC);const Fye=EC;var o7;let yx=o7=class extends Kt{constructor(t){super(t),this.x=0,this.y=0}clone(){return new o7({x:this.x,y:this.y})}equals(t){return t.x===this.x&&t.y===this.y}};_([E({type:Number})],yx.prototype,"x",void 0),_([E({type:Number})],yx.prototype,"y",void 0),yx=o7=_([ue("esri.symbols.support.Symbol3DAnchorPosition2D")],yx);var a7;let fS=a7=class extends qt{constructor(t){super(t),this.color=new Kn([0,0,0,1]),this.size=j1(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new a7(t)}equals(t){return t.size===this.size&&(this.color==null?t.color==null:this.color.equals(t.color))}};_([E(Jg({colorRequiredOnWrite:!0}))],fS.prototype,"color",void 0),_([E({...Id,json:{write:{isRequired:!0}}})],fS.prototype,"size",void 0),fS=a7=_([ue("esri.symbols.support.Symbol3DIconOutline")],fS);var H_,_w;let Js=(_w=class extends Pa{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0,this.occludedVisibility=null}clone(){return new H_({anchor:this.anchor,anchorPosition:Ze(this.anchorPosition),enabled:this.enabled,material:Ze(this.material),outline:Ze(this.outline),resource:Ze(this.resource),angle:this.angle,size:this.size,occludedVisibility:Ze(this.occludedVisibility)})}static fromSimpleMarkerSymbol(e){const n=e.color||hT,r=Wte(e),i=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||hT).clone()}:null;return new H_({size:e.size,angle:e.angle,resource:{primitive:hKe(()=>St.getLogger(this.prototype),e.style)},material:{color:n},outline:i,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const n=!e.color||Xqe(e.color)?hT:e.color,r=Wte(e);return new H_({size:e.width<=e.height?e.height:e.width,angle:e.angle,resource:{href:e.url},material:{color:n.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new H_({resource:{href:bde({mediaType:"application/json",data:JSON.stringify(e.data)})}})}},H_=_w,_w);function Wte(t){const e="width"in t?t.width:t.size,n="height"in t?t.height:t.size,r=Hte(t.xoffset),i=Hte(t.yoffset);return(r||i)&&e&&n?{x:-r/e,y:i/n}:null}function Hte(t){return isFinite(t)?t:0}_([E({type:ic,json:{write:!0}})],Js.prototype,"material",void 0),_([E({type:J0,json:{write:!0}})],Js.prototype,"resource",void 0),_([pn({Icon:"icon"},{readOnly:!0})],Js.prototype,"type",void 0),_([E({...Id,json:{write:{isRequired:!0}}})],Js.prototype,"size",void 0),_([pn({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],Js.prototype,"anchor",void 0),_([E({type:yx,json:{type:[Number],read:{reader:t=>new yx({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Js.prototype,"anchorPosition",void 0),_([E({type:fS,json:{write:!0}})],Js.prototype,"outline",void 0),_([E({type:Number,json:{write:!0,default:0}})],Js.prototype,"angle",void 0),_([E({type:Fye})],Js.prototype,"occludedVisibility",void 0),Js=H_=_([ue("esri.symbols.IconSymbol3DLayer")],Js);const uKe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function hKe(t,e){return uKe[e]||(t().warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const dKe=["begin","end","begin-end"],Vye=["arrow","circle","square","diamond","cross","x"];let Mf=class extends ho(qt){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};_([E({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],Mf.prototype,"type",void 0),_([E({type:dKe,json:{default:"begin-end",write:!0}})],Mf.prototype,"placement",void 0),_([E({type:Vye,json:{default:"arrow",write:!0}})],Mf.prototype,"style",void 0),_([E({type:Kn,json:{type:[Or],default:null,write:!0}})],Mf.prototype,"color",void 0),Mf=_([ue("esri.symbols.LineStyleMarker3D")],Mf);var SC,xw;let nl=(xw=class extends Pa{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=j1(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new SC(e)}static fromSimpleLineSymbol(e){const n={enabled:!0,size:e.width??j1(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style?new Cy({style:e.style}):null,material:new ic({color:(e.color||hT).clone()}),marker:e.marker?new Mf({placement:e.marker.placement,style:e.marker.style,color:e.marker.color?.clone()??null}):null};return new SC(n)}},SC=xw,xw);_([E({type:ic,json:{write:!0}})],nl.prototype,"material",void 0),_([pn({Line:"line"},{readOnly:!0})],nl.prototype,"type",void 0),_([E({type:jye,json:{write:!0,default:"miter"}})],nl.prototype,"join",void 0),_([E({type:BB,json:{write:!0,default:"butt"}})],nl.prototype,"cap",void 0),_([E({...Id,json:{write:{isRequired:!0}}})],nl.prototype,"size",void 0),_([E(Dye)],nl.prototype,"pattern",void 0),_([E({types:{key:"type",base:Mf,typeMap:{style:Mf}},json:{write:!0}})],nl.prototype,"marker",void 0),nl=SC=_([ue("esri.symbols.LineSymbol3DLayer")],nl);var l7;const fKe=kl()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let pS=l7=class extends qt{clone(){return new l7({href:this.href,primitive:this.primitive})}};_([E({type:String,json:{read:Z5,write:r2}})],pS.prototype,"href",void 0),_([pn(fKe)],pS.prototype,"primitive",void 0),pS=l7=_([ue("esri.symbols.support.ObjectSymbol3DLayerResource")],pS);const WCt="sphere";var c7;let gy=c7=class extends Kt{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new c7({x:this.x,y:this.y,z:this.z})}};_([E({type:Number})],gy.prototype,"x",void 0),_([E({type:Number})],gy.prototype,"y",void 0),_([E({type:Number})],gy.prototype,"z",void 0),gy=c7=_([ue("esri.symbols.support.Symbol3DAnchorPosition3D")],gy);var u7,ww;let Zs=(ww=class extends Pa{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new u7({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition?.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:this.material?.clone()??null,castShadows:this.castShadows,resource:this.resource?.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}},u7=ww,ww);_([E({type:ic,json:{write:!0}})],Zs.prototype,"material",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Zs.prototype,"castShadows",void 0),_([E({type:pS,json:{write:!0}})],Zs.prototype,"resource",void 0),_([pn({Object:"object"},{readOnly:!0})],Zs.prototype,"type",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"width",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"height",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"depth",void 0),_([pn({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],Zs.prototype,"anchor",void 0),_([E({type:gy,json:{type:[Number],read:{reader:t=>new gy({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Zs.prototype,"anchorPosition",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"heading",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"tilt",void 0),_([E({type:Number,json:{write:!0}})],Zs.prototype,"roll",void 0),_([E({readOnly:!0})],Zs.prototype,"isPrimitive",null),Zs=u7=_([ue("esri.symbols.ObjectSymbol3DLayer")],Zs);var h7,bw;let xo=(bw=class extends Pa{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,n){return e??(n.height==null&&n.size!=null?n.size:void 0)}readHeight(e,n){return e??(n.width==null&&n.size!=null?n.size:void 0)}clone(){return new h7({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}},h7=bw,bw);_([E({type:ic,json:{write:!0}})],xo.prototype,"material",void 0),_([E({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],xo.prototype,"castShadows",void 0),_([pn({Path:"path"},{readOnly:!0})],xo.prototype,"type",void 0),_([E({type:["circle","quad"],nonNullable:!0,json:{write:!0,default:"circle"}})],xo.prototype,"profile",void 0),_([E({type:jye,nonNullable:!0,json:{write:!0,default:"miter"}})],xo.prototype,"join",void 0),_([E({type:lKe,nonNullable:!0,json:{write:!0,default:"butt"}})],xo.prototype,"cap",void 0),_([E({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],xo.prototype,"width",void 0),_([sr("width",["width","size","height"])],xo.prototype,"readWidth",null),_([E({type:Number,json:{write:!0}})],xo.prototype,"height",void 0),_([sr("height",["height","size","width"])],xo.prototype,"readHeight",null),_([E({type:["center","bottom","top"],nonNullable:!0,json:{write:!0,default:"center"}})],xo.prototype,"anchor",void 0),_([E({type:["heading","all"],nonNullable:!0,json:{write:!0,default:"all"}})],xo.prototype,"profileRotation",void 0),xo=h7=_([ue("esri.symbols.PathSymbol3DLayer")],xo);const pKe=["none","underline","line-through"],mKe=["normal","italic","oblique"],gKe=["normal","lighter","bold","bolder"],zye={type:Number,cast:t=>{const e=Zl(t);return e===0?1:cu(e,.1,4)},nonNullable:!0},yKe=["left","right","center"],vKe=["baseline","top","middle","bottom"],Uye={type:yKe,nonNullable:!0},Gye={type:vKe,nonNullable:!0},HCt=8;var d7;let $c=d7=class extends qt{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return wi(t)}clone(){return new d7({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};_([E({type:pKe,json:{default:"none",write:!0}})],$c.prototype,"decoration",void 0),_([E({type:String,json:{write:!0}})],$c.prototype,"family",void 0),_([E({type:Number,json:{write:{overridePolicy:(t,e,n)=>({enabled:!n||!n.textSymbol3D})}}})],$c.prototype,"size",void 0),_([zs("size")],$c.prototype,"castSize",null),_([E({type:mKe,json:{default:"normal",write:!0}})],$c.prototype,"style",void 0),_([E({type:gKe,json:{default:"normal",write:!0}})],$c.prototype,"weight",void 0),$c=d7=_([ue("esri.symbols.Font")],$c);var f7;let vx=f7=class extends qt{constructor(){super(...arguments),this.color=new Kn([0,0,0,1]),this.size=0}clone(){const t={color:Ze(this.color),size:this.size};return new f7(t)}};_([E(Jg())],vx.prototype,"color",void 0),_([E(Id)],vx.prototype,"size",void 0),vx=f7=_([ue("esri.symbols.support.Symbol3DHalo")],vx);let fT=class extends ho(qt){constructor(e){super(e),this.color=null}};_([E(Jg())],fT.prototype,"color",void 0),fT=_([ue("esri.symbols.support.Symbol3DTextBackground")],fT);var TC,Ew;let vs=(Ew=class extends Pa{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline",this.occludedVisibility=null}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,n,r,i){const s={...i,textSymbol3D:!0};n.font=e.write({},s),delete n.font.size}get size(){return this._userSize!=null?this._userSize:this.font?.size!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new TC({enabled:this.enabled,font:Ze(this.font),halo:Ze(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:Ze(this.background),occludedVisibility:Ze(this.occludedVisibility)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new TC({font:e.font!=null?e.font.clone():new $c,halo:_Ke(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new ic({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new fT({color:e.backgroundColor.clone()}):null})}},TC=Ew,Ew);function _Ke(t,e){return t&&e!=null&&e>0?new vx({color:Ze(t),size:e}):null}_([E({type:$c,json:{write:!0}})],vs.prototype,"font",null),_([Xn("font")],vs.prototype,"writeFont",null),_([E({type:vx,json:{write:!0}})],vs.prototype,"halo",void 0),_([E({...Uye,json:{default:"center",write:!0}})],vs.prototype,"horizontalAlignment",void 0),_([E({...zye,json:{default:1,write:!0}})],vs.prototype,"lineHeight",void 0),_([E({type:ic,json:{write:!0}})],vs.prototype,"material",void 0),_([E({type:fT,json:{write:!0}})],vs.prototype,"background",void 0),_([E(Id)],vs.prototype,"size",null),_([E({type:String,json:{write:!0}})],vs.prototype,"text",void 0),_([pn({Text:"text"},{readOnly:!0})],vs.prototype,"type",void 0),_([E({...Gye,json:{default:"baseline",write:!0}})],vs.prototype,"verticalAlignment",void 0),_([E({type:Fye})],vs.prototype,"occludedVisibility",void 0),vs=TC=_([ue("esri.symbols.TextSymbol3DLayer")],vs);var p7,Sw;let Sf=(Sw=class extends Pa{constructor(e){super(e),this.color=m7.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new p7({color:this.color.clone(),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}},p7=Sw,Sw);_([E({type:Kn,nonNullable:!0,json:{type:[Or],write:(t,e,n)=>e[n]=t.toArray(1),default:()=>m7.clone(),defaultEquals:t=>t.toCss(!0)===m7.toCss(!0)}})],Sf.prototype,"color",void 0),_([pn({Water:"water"},{readOnly:!0})],Sf.prototype,"type",void 0),_([E({type:["small","medium","large"],json:{write:!0,default:"medium"}})],Sf.prototype,"waterbodySize",void 0),_([E({type:Number,json:{write:!0,default:null}})],Sf.prototype,"waveDirection",void 0),_([E({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],Sf.prototype,"waveStrength",void 0),Sf=p7=_([ue("esri.symbols.WaterSymbol3DLayer")],Sf);const m7=new Kn([0,119,190]);var g7;let Cf=g7=class extends Kt{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new g7({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};_([E({type:String})],Cf.prototype,"name",void 0),_([E({type:String})],Cf.prototype,"styleUrl",void 0),_([E({type:String})],Cf.prototype,"styleName",void 0),_([E({type:it})],Cf.prototype,"portal",void 0),Cf=g7=_([ue("esri.symbols.support.StyleOrigin")],Cf);var y7;let pT=y7=class extends Kt{constructor(){super(...arguments),this.url=""}clone(){return new y7({url:this.url})}};_([E({type:String})],pT.prototype,"url",void 0),pT=y7=_([ue("esri.symbols.support.Thumbnail")],pT);const Bye={icon:Js,object:Zs,line:nl,path:xo,fill:Wl,extrude:Ef,text:vs,water:Sf},xKe=Ot.ofType({base:Pa,key:"type",typeMap:Bye,errorContext:"symbol-layer"});let rl=class extends us{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const n=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,r=n?.type,i=r||Ot;this._set("symbolLayers",new i)}get color(){return null}set color(e){this.constructed&&St.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){fd(e,this._get("symbolLayers"))}readStyleOrigin(e,n,r){if(e.styleUrl&&e.name){const i=W2(e.styleUrl,r);return new Cf({styleUrl:i,name:e.name})}if(e.styleName&&e.name)return new Cf({portal:r?.portal||it.getDefault(),styleName:e.styleName,name:e.name});r?.messages&&r.messages.push(new Td("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:r,definition:e}))}writeStyleOrigin(e,n,r,i){if(e.styleUrl&&e.name){let s=n2(e.styleUrl,i);yl(s)&&(s=pg(s)),n.styleOrigin={styleUrl:s,name:e.name}}else e.styleName&&e.name&&(e.portal&&i?.portal&&!TDe(e.portal.restUrl,i.portal.restUrl)?i?.messages&&i.messages.push(new Td("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):n.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof Pa||e&&Bye[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};_([E({json:{read:!1,write:!1}})],rl.prototype,"color",null),_([E({type:xKe,nonNullable:!0,json:{write:!0}}),zs(Nfe)],rl.prototype,"symbolLayers",null),_([E({type:Cf})],rl.prototype,"styleOrigin",void 0),_([sr("styleOrigin")],rl.prototype,"readStyleOrigin",null),_([Xn("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],rl.prototype,"writeStyleOrigin",null),_([E({type:pT,json:{read:!1}})],rl.prototype,"thumbnail",void 0),_([E({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],rl.prototype,"type",void 0),rl=_([ue("esri.symbols.Symbol3D")],rl);let _x=class extends qt{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};_([E({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],_x.prototype,"type",void 0),_([E({readOnly:!0})],_x.prototype,"visible",void 0),_x=_([ue("esri.symbols.callouts.Callout3D")],_x);var v7;let kC=v7=class extends qt{constructor(t){super(t),this.color=new Kn("white")}clone(){return new v7({color:Ze(this.color)})}};_([E(Jg({colorRequiredOnWrite:!0}))],kC.prototype,"color",void 0),kC=v7=_([ue("esri.symbols.callouts.LineCallout3DBorder")],kC);const wKe=kC;var _7;let Tf=_7=class extends _x{constructor(t){super(t),this.type="line",this.color=new Kn([0,0,0,1]),this.size=j1(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new _7({color:Ze(this.color),size:this.size,border:Ze(this.border)})}};_([pn({line:"line"})],Tf.prototype,"type",void 0),_([E(Jg({colorRequiredOnWrite:!0}))],Tf.prototype,"color",void 0),_([E({...Id,json:{write:{isRequired:!0}}})],Tf.prototype,"size",void 0),_([E({type:wKe,json:{write:!0}})],Tf.prototype,"border",void 0),_([E({readOnly:!0})],Tf.prototype,"visible",null),Tf=_7=_([ue("esri.symbols.callouts.LineCallout3D")],Tf);function WB(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function Wye(t){return!t||!t.supportsCallout||!t.supportsCallout()?!1:!!t.callout?.visible&&!!WB(t)}function XCt(t){return t.type==="point-3d"||t.type==="label-3d"}function ZCt(t){return t.horizontalAlignment==="center"}const Hye={types:{key:"type",base:_x,typeMap:{line:Tf}},json:{write:!0}};var x7;let Fm=x7=class extends qt{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new x7({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};_([E({...Id,json:{write:{isRequired:!0}}})],Fm.prototype,"screenLength",void 0),_([E({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Fm.prototype,"minWorldLength",void 0),_([E({type:Number,json:{write:!0}})],Fm.prototype,"maxWorldLength",void 0),Fm=x7=_([ue("esri.symbols.support.Symbol3DVerticalOffset")],Fm);var AC;const qye=Ot.ofType({base:null,key:"type",typeMap:{text:vs}});let Kh=AC=class extends rl{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new qye,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Wye(this)}hasVisibleVerticalOffset(){return WB(this)}clone(){return new AC({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail),callout:Ze(this.callout),verticalOffset:Ze(this.verticalOffset)})}static fromTextSymbol(t){return new AC({symbolLayers:new Ot([vs.fromTextSymbol(t)])})}};_([E({type:Fm,json:{write:!0}})],Kh.prototype,"verticalOffset",void 0),_([E(Hye)],Kh.prototype,"callout",void 0),_([E({json:{read:!1,write:!1}})],Kh.prototype,"styleOrigin",void 0),_([E({type:qye})],Kh.prototype,"symbolLayers",void 0),_([pn({LabelSymbol3D:"label-3d"},{readOnly:!0})],Kh.prototype,"type",void 0),Kh=AC=_([ue("esri.symbols.LabelSymbol3D")],Kh);var IC;const Kye=Ot.ofType({base:null,key:"type",typeMap:{line:nl,path:xo}}),bKe=Ot.ofType({base:null,key:"type",typeMap:{line:nl,path:xo}});let Qm=IC=class extends rl{constructor(t){super(t),this.symbolLayers=new Kye,this.type="line-3d"}clone(){return new IC({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleLineSymbol(t){return new IC({symbolLayers:new Ot([nl.fromSimpleLineSymbol(t)])})}};_([E({type:Kye,json:{type:bKe}})],Qm.prototype,"symbolLayers",void 0),_([pn({LineSymbol3D:"line-3d"},{readOnly:!0})],Qm.prototype,"type",void 0),Qm=IC=_([ue("esri.symbols.LineSymbol3D")],Qm);var RC;const Yye=Ot.ofType({base:null,key:"type",typeMap:{fill:Wl}});let Ny=RC=class extends rl{constructor(t){super(t),this.symbolLayers=new Yye,this.type="mesh-3d"}clone(){return new RC({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleFillSymbol(t){return new RC({symbolLayers:new Ot([Wl.fromSimpleFillSymbol(t)])})}};_([E({type:Yye})],Ny.prototype,"symbolLayers",void 0),_([pn({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Ny.prototype,"type",void 0),Ny=RC=_([ue("esri.symbols.MeshSymbol3D")],Ny);let mS=class extends us{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};_([pn({esriSLS:"simple-line"},{readOnly:!0})],mS.prototype,"type",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],mS.prototype,"width",void 0),mS=_([ue("esri.symbols.LineSymbol")],mS);var w7;let Vh=w7=class extends qt{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,n,r){e[n]=r?.origin==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t?.[0]!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,n,r){r?.origin==="web-map"||(e[n]=t)}clone(){return new w7({color:Ze(this.color),placement:this.placement,style:this.style})}hash(){return`${this.placement}.${this.color?.hash()}.${this.style}`}};_([E({type:["begin","end","begin-end"],json:{write:!0}})],Vh.prototype,"placement",void 0),_([pn({"line-marker":"line-marker"},{readOnly:!0}),E({json:{origins:{"web-map":{write:!1}}}})],Vh.prototype,"type",void 0),_([E({type:Vye})],Vh.prototype,"style",void 0),_([Xn("style")],Vh.prototype,"writeStyle",null),_([E({type:Kn,value:null,json:{write:{allowNull:!0}}})],Vh.prototype,"color",null),_([sr("color")],Vh.prototype,"readColor",null),_([Xn("color")],Vh.prototype,"writeColor",null),Vh=w7=_([ue("esri.symbols.LineSymbolMarker")],Vh);const EKe=Vh;var b7;const I$=new Gs({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Sa=b7=class extends mS{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,n,r,i,s){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),n!=null&&(o.width=wi(n)),r!=null&&(o.cap=r),i!=null&&(o.join=i),s!=null&&(o.miterLimit=wi(s)),o}clone(){return new b7({color:Ze(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:this.marker?.clone()})}hash(){return`${super.hash()}.${this.color?.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${this.marker?.hash()}`}};_([pn({esriSLS:"simple-line"},{readOnly:!0})],Sa.prototype,"type",void 0),_([E({type:I$.apiValues,json:{read:I$.read,write:I$.write}})],Sa.prototype,"style",void 0),_([E({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,n)=>({enabled:t!=="round"&&n?.origin==null})}}})],Sa.prototype,"cap",void 0),_([E({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,n)=>({enabled:t!=="round"&&n?.origin==null})}}})],Sa.prototype,"join",void 0),_([E({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":EKe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Sa.prototype,"marker",void 0),_([E({type:Number,json:{read:!1,write:!1}})],Sa.prototype,"miterLimit",void 0),Sa=b7=_([ue("esri.symbols.SimpleLineSymbol")],Sa);let xx=class extends us{constructor(e){super(e),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline?.hash()}`}};_([E({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Sa}},json:{default:null,write:!0}})],xx.prototype,"outline",void 0),_([E({type:["simple-fill","picture-fill"],readOnly:!0})],xx.prototype,"type",void 0),xx=_([ue("esri.symbols.FillSymbol")],xx);function SKe(t,e,n){return e.imageData?bde({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):Xye(e.url,n)}function Xye(t,e){if(!yl(t)){const n=kKe(e);if(n)return KA(n,"images",t)}return W2(t,e)}function TKe(t,e,n,r){if(nv(t)){const i=t2(t);if(!i)return;e.contentType=i.mediaType,e.imageData=i.data,n&&n.imageData===e.imageData&&n.url&&r2(n.url,e,"url",r)}else r2(t,e,"url",r)}const Zye={json:{read:{source:["imageData","url"],reader:SKe},write:{writer(t,e,n,r){TKe(t,e,this.source,r)}}}},Jye={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,n){const r={};return e.imageData&&(r.imageData=e.imageData),e.contentType&&(r.contentType=e.contentType),e.url&&(r.url=Xye(e.url,n)),r}}}};function kKe(t){if(!t)return null;const{origin:e,layer:n}=t;if(e!=="service"&&e!=="portal-item")return null;const r=n?.type;return r==="feature"||r==="stream"?n.parsedUrl?.path:r==="map-image"||r==="tile"?t.url?.path:null}var E7;let Za=E7=class extends xx{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,n,r){if(t&&typeof t!="string"&&t.imageData==null)return t;const i={};return t&&(i.url=t),e&&(i.outline=e),n!=null&&(i.width=wi(n)),r!=null&&(i.height=wi(r)),i}clone(){const t=new E7({color:Ze(this.color),height:this.height,outline:Ze(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",Ze(this.source)),t}hash(){return`${super.hash()}.${this.color?.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};_([pn({esriPFS:"picture-fill"},{readOnly:!0})],Za.prototype,"type",void 0),_([E(Zye)],Za.prototype,"url",void 0),_([E({type:Number,json:{write:!0}})],Za.prototype,"xscale",void 0),_([E({type:Number,json:{write:!0}})],Za.prototype,"yscale",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Za.prototype,"width",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Za.prototype,"height",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Za.prototype,"xoffset",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Za.prototype,"yoffset",void 0),_([E(Jye)],Za.prototype,"source",void 0),Za=E7=_([ue("esri.symbols.PictureFillSymbol")],Za);let kf=class extends us{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};_([E({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],kf.prototype,"angle",void 0),_([E({type:["simple-marker","picture-marker"],readOnly:!0})],kf.prototype,"type",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],kf.prototype,"xoffset",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],kf.prototype,"yoffset",void 0),_([E({cast:t=>t==="auto"?t:Zl(wi(t)),json:{write:!0}})],kf.prototype,"size",void 0),kf=_([ue("esri.symbols.MarkerSymbol")],kf);var S7;let el=S7=class extends kf{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string"&&t.imageData==null)return t;const r={};return t&&(r.url=t),e!=null&&(r.width=wi(e)),n!=null&&(r.height=wi(n)),r}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new S7({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",Ze(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};_([E({json:{write:!1}})],el.prototype,"color",void 0),_([pn({esriPMS:"picture-marker"},{readOnly:!0})],el.prototype,"type",void 0),_([E(Zye)],el.prototype,"url",void 0),_([E(Jye)],el.prototype,"source",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],el.prototype,"height",void 0),_([sr("height",["height","size"])],el.prototype,"readHeight",null),_([E({type:Number,cast:wi,json:{write:!0}})],el.prototype,"width",void 0),_([E({json:{write:!1}})],el.prototype,"size",void 0),el=S7=_([ue("esri.symbols.PictureMarkerSymbol")],el);var Q0;const Qye=Ot.ofType({base:null,key:"type",typeMap:{icon:Js,object:Zs,text:vs}});let Zh=Q0=class extends rl{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Qye,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Wye(this)}hasVisibleVerticalOffset(){return WB(this)}clone(){return new Q0({verticalOffset:Ze(this.verticalOffset),callout:Ze(this.callout),styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new Q0({symbolLayers:new Ot([Js.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new Q0({symbolLayers:new Ot([Js.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){if(t.data?.symbol?.type!=="CIMPointSymbol")return null;const n=t.data.symbol;return new Q0(n?.callout?{symbolLayers:new Ot([Js.fromCIMSymbol(t)]),callout:new Tf({size:.5,color:new Kn([0,0,0])}),verticalOffset:new Fm({screenLength:40})}:{symbolLayers:new Ot([Js.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new Q0({symbolLayers:new Ot([vs.fromTextSymbol(t)])})}};_([E({type:Fm,json:{write:!0}})],Zh.prototype,"verticalOffset",void 0),_([E(Hye)],Zh.prototype,"callout",void 0),_([E({type:Qye,json:{origins:{"web-scene":{write:!0}}}})],Zh.prototype,"symbolLayers",void 0),_([pn({PointSymbol3D:"point-3d"},{readOnly:!0})],Zh.prototype,"type",void 0),Zh=Q0=_([ue("esri.symbols.PointSymbol3D")],Zh);var gS;const e1e=Ot.ofType({base:null,key:"type",typeMap:{extrude:Ef,fill:Wl,icon:Js,line:nl,object:Zs,text:vs,water:Sf}});let eg=gS=class extends rl{constructor(t){super(t),this.symbolLayers=new e1e,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&Pg(St.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&Pg(St.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles($1(()=>this.symbolLayers,"after-add",({item:e})=>t(e),Dg))}clone(){return new gS({styleOrigin:Ze(this.styleOrigin),symbolLayers:Ze(this.symbolLayers),thumbnail:Ze(this.thumbnail)})}static fromJSON(t){const e=new gS;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const n=e.symbolLayers.at(0),r=e.symbolLayers.at(1);!r.enabled||t.symbolLayers?.[1]&&t.symbolLayers[1].enable===!1||(n.outline={size:r.size,color:r.material!=null?r.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new gS({symbolLayers:new Ot([Wl.fromSimpleFillSymbol(t)])})}};_([E({type:e1e,json:{write:!0}})],eg.prototype,"symbolLayers",void 0),_([pn({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],eg.prototype,"type",void 0),eg=gS=_([ue("esri.symbols.PolygonSymbol3D")],eg);var T7;const R$=new Gs({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Nf=T7=class extends xx{constructor(...t){super(...t),this.color=new Kn([0,0,0,.25]),this.outline=new Sa,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.style=t),e&&(r.outline=e),n&&(r.color=n),r}clone(){return new T7({color:Ze(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};_([E()],Nf.prototype,"color",void 0),_([E()],Nf.prototype,"outline",void 0),_([pn({esriSFS:"simple-fill"},{readOnly:!0})],Nf.prototype,"type",void 0),_([E({type:R$.apiValues,json:{read:R$.read,write:R$.write}})],Nf.prototype,"style",void 0),Nf=T7=_([ue("esri.symbols.SimpleFillSymbol")],Nf);var k7;const P$=new Gs({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Gl=k7=class extends kf{constructor(...t){super(...t),this.color=new Kn([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Sa}normalizeCtorArgs(t,e,n,r){if(t&&typeof t!="string")return t;const i={};return t&&(i.style=t),e!=null&&(i.size=wi(e)),n&&(i.outline=n),r&&(i.color=r),i}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new k7({angle:this.angle,color:Ze(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${this.outline?.hash()}`}};_([E()],Gl.prototype,"color",void 0),_([Xn("color")],Gl.prototype,"writeColor",null),_([pn({esriSMS:"simple-marker"},{readOnly:!0})],Gl.prototype,"type",void 0),_([E()],Gl.prototype,"size",void 0),_([E({type:P$.apiValues,json:{read:P$.read,write:P$.write}})],Gl.prototype,"style",void 0),_([E({type:String,json:{write:!0}})],Gl.prototype,"path",null),_([E({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Sa}},json:{default:null,write:!0}})],Gl.prototype,"outline",void 0),Gl=k7=_([ue("esri.symbols.SimpleMarkerSymbol")],Gl);var A7;let Hr=A7=class extends us{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new $c,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,n){if(t&&typeof t!="string")return t;const r={};return t&&(r.text=t),e&&(r.font=e),n&&(r.color=n),r}writeLineWidth(t,e,n,r){r&&typeof r!="string"?r.origin:e[n]=t}castLineWidth(t){return wi(t)}writeLineHeight(t,e,n,r){r&&typeof r!="string"?r.origin:e[n]=t}clone(){return new A7({angle:this.angle,backgroundColor:Ze(this.backgroundColor),borderLineColor:Ze(this.borderLineColor),borderLineSize:this.borderLineSize,color:Ze(this.color),font:this.font&&this.font.clone(),haloColor:Ze(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor?.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color?.hash()}.${this.font&&this.font.hash()}.${this.haloColor?.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};_([E({type:Kn,json:{write:!0}})],Hr.prototype,"backgroundColor",void 0),_([E({type:Kn,json:{write:!0}})],Hr.prototype,"borderLineColor",void 0),_([E({type:Number,json:{write:!0},cast:wi})],Hr.prototype,"borderLineSize",void 0),_([E({type:$c,json:{write:!0}})],Hr.prototype,"font",void 0),_([E({...Uye,json:{write:!0}})],Hr.prototype,"horizontalAlignment",void 0),_([E({type:Boolean,json:{write:!0}})],Hr.prototype,"kerning",void 0),_([E({type:Kn,json:{write:!0}})],Hr.prototype,"haloColor",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Hr.prototype,"haloSize",void 0),_([E({type:Boolean,json:{write:!0}})],Hr.prototype,"rightToLeft",void 0),_([E({type:Boolean,json:{write:!0}})],Hr.prototype,"rotated",void 0),_([E({type:String,json:{write:!0}})],Hr.prototype,"text",void 0),_([pn({esriTS:"text"},{readOnly:!0})],Hr.prototype,"type",void 0),_([E({...Gye,json:{write:!0}})],Hr.prototype,"verticalAlignment",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Hr.prototype,"xoffset",void 0),_([E({type:Number,cast:wi,json:{write:!0}})],Hr.prototype,"yoffset",void 0),_([E({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Hr.prototype,"angle",void 0),_([E({type:Number,json:{write:!0}})],Hr.prototype,"width",void 0),_([E({type:Number})],Hr.prototype,"lineWidth",void 0),_([Xn("lineWidth")],Hr.prototype,"writeLineWidth",null),_([zs("lineWidth")],Hr.prototype,"castLineWidth",null),_([E(zye)],Hr.prototype,"lineHeight",void 0),_([Xn("lineHeight")],Hr.prototype,"writeLineHeight",null),Hr=A7=_([ue("esri.symbols.TextSymbol")],Hr);var I7;let tl=I7=class extends us{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:it.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e?.portal,super.read(t,e)}clone(){return new I7({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol(t)}async fetchCIMSymbol(t){qde(St.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const e=await this._fetchSymbol({...t,acceptedFormats:["cim"]});if(e?.type!=="cim")throw new Xe("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,n=e?this._fetchCacheKey:null;if(e!=null){const o=n&&e.get(n);if(o)return o.clone()}const{resolveWebStyleSymbol:r}=await xe(()=>import("./webStyleSymbolUtils-CyXyxgZg.js"),__vite__mapDeps([301,302,16,17,18,19,23]));hi(t);const i=r(this,{portal:this.portal},t);i.catch(o=>{St.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const s=await i;return e?.set(n,s.clone()),s}};_([E({json:{write:!1}})],tl.prototype,"color",void 0),_([E({type:String,json:{write:!0}})],tl.prototype,"styleName",void 0),_([E({type:it,json:{write:!1}})],tl.prototype,"portal",void 0),_([E({type:String,json:{read:Z5,write:r2}})],tl.prototype,"styleUrl",void 0),_([E({type:pT,json:{read:!1}})],tl.prototype,"thumbnail",void 0),_([E({type:String,json:{write:!0}})],tl.prototype,"name",void 0),_([pn({styleSymbolReference:"web-style"},{readOnly:!0})],tl.prototype,"type",void 0),_([E()],tl.prototype,"_fetchCacheKey",null),tl=I7=_([ue("esri.symbols.WebStyleSymbol")],tl);function t3t(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function n3t(t){switch(t?.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const HB={base:us,key:"type",typeMap:{"simple-fill":Nf,"picture-fill":Za,"picture-marker":el,"simple-line":Sa,"simple-marker":Gl,text:Hr,"label-3d":Kh,"line-3d":Qm,"mesh-3d":Ny,"point-3d":Zh,"polygon-3d":eg,"web-style":tl,cim:ol},errorContext:"symbol"},r3t={base:us,key:"type",typeMap:{"picture-marker":el,"simple-marker":Gl,"point-3d":Zh,cim:ol},errorContext:"symbol"},i3t={base:us,key:"type",typeMap:{"simple-line":Sa,"line-3d":Qm,cim:ol},errorContext:"symbol"},s3t={base:us,key:"type",typeMap:{"simple-fill":Nf,"picture-fill":Za,"polygon-3d":eg,cim:ol},errorContext:"symbol"},o3t={base:us,key:"type",typeMap:{"picture-marker":el,"simple-marker":Gl,text:Hr,"web-style":tl,cim:ol},errorContext:"symbol"},a3t=NG({types:HB}),l3t={base:us,key:"type",typeMap:{"simple-fill":Nf,"picture-fill":Za,"picture-marker":el,"simple-line":Sa,"simple-marker":Gl,text:Hr,"line-3d":Qm,"mesh-3d":Ny,"point-3d":Zh,"polygon-3d":eg,"web-style":tl,cim:ol},errorContext:"symbol"},c3t={base:us,key:"type",typeMap:{text:Hr,"label-3d":Kh},errorContext:"symbol"},u3t={base:us,key:"type",typeMap:{"line-3d":Qm,"mesh-3d":Ny,"point-3d":Zh,"polygon-3d":eg,"web-style":tl,cim:ol},errorContext:"symbol"},h3t={base:us,key:"type",typeMap:{"label-3d":Kh},errorContext:"symbol"},d3t=Cg(HB);var R7;function AKe(t){if(!t)return null;const e={};for(const n in t){const r=m2(t[n]);r&&(e[n]=r)}return Object.keys(e).length!==0?e:null}function IKe(t){if(t==null)return null;const e={};for(const n in t){const r=t[n];r&&(e[n]=r.toJSON())}return Object.keys(e).length!==0?e:null}var Tw;let Yo=(Tw=class extends ho(qt){constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:zM(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&C6e(St.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const n=this._get("aggregateGeometries");JSON.stringify(n)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const n=this._get("attributes");n!==e&&(this._set("attributes",e),this._notifyLayer("attributes",n,e))}set geometry(e){const n=this._get("geometry");n!==e&&(this._set("geometry",e),e?.type!=="mesh"&&this._notifyLayer("geometry",n,e))}set popupTemplate(e){const n=this._get("popupTemplate");n!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",n,e))}set symbol(e){const n=this._get("symbol");n!==e&&(this._set("symbol",e),this._notifyLayer("symbol",n,e))}get version(){return this._version}set visible(e){const n=this._get("visible");n!==e&&(this._set("visible",e),this._notifyLayer("visible",n,e))}cloneShallow(){return new R7({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const n=Fqe(this.origin);if(n)return n.popupTemplate??(e?n.defaultPopupTemplate:null)??null;const r=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[r,this.sourceLayer,this.layer])if(i&&typeof i=="object"){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(e&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,n){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=n,this._notifyLayer("attributes",r,n,e)}else this.attributes={[e]:n}}getObjectId(){const e=zte(this.origin);if(e)return Ute(this,e);const n=this.sourceLayer??this.layer;return n?Ute(this,n):null}getGlobalId(){const e=zte(this.origin);if(e?.globalIdField)return this.getAttribute(e.globalIdField);const n=this.sourceLayer??this.layer;return n&&"globalIdField"in n&&n.globalIdField?this.getAttribute(n.globalIdField):null}toJSON(){return{aggregateGeometries:IKe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:Z3(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:n}=this;if(n?.type==="mesh"){const r={origin:n.origin,transform:n.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,n,r,i){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:n,newValue:r};e==="origin-transform"&&(s.action=i),e==="attributes"&&(s.attributeName=i),this.layer.graphicChanged(s)}_watchMeshGeometryChanges(){this.addHandles([hc(()=>this.geometry?.type==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:n})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===n||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=n,this.notifyMeshTransformChanged())}),hc(()=>this.geometry?.type==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;e?.type==="mesh"&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,n)=>e===n,sync:!0})])}},R7=Tw,Tw);_([E({value:null,json:{read:AKe}})],Yo.prototype,"aggregateGeometries",null),_([E({value:null})],Yo.prototype,"attributes",null),_([E({value:null,types:RB,json:{read:m2}})],Yo.prototype,"geometry",null),_([E({type:Boolean})],Yo.prototype,"isAggregate",void 0),_([E({clonable:!1})],Yo.prototype,"layer",void 0),_([E({clonable:"reference"})],Yo.prototype,"origin",void 0),_([E({type:Dqe,value:null})],Yo.prototype,"popupTemplate",null),_([E({clonable:"reference"})],Yo.prototype,"sourceLayer",void 0),_([E({value:null,types:HB})],Yo.prototype,"symbol",null),_([E({clonable:!1,json:{read:!1,write:!1}})],Yo.prototype,"_version",void 0),_([E({type:Boolean,value:!0})],Yo.prototype,"visible",null),Yo=R7=_([ue("esri.Graphic")],Yo);let mT=class extends oT{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};_([Mfe({Type:Yo,ensureType:Fa(Yo)})],mT.prototype,"itemType",void 0),mT=_([ue("esri.support.GraphicsCollection")],mT);let gf=class extends Kt{constructor(e){super(e),this.view=null,this.baseLayerViews=new Ot,this.groundLayerViews=new Ot,this.referenceLayerViews=new Ot,this._loadingHandle=dn(()=>this.view?.map?.basemap,n=>{n&&n.load().catch(()=>{})},fa)}destroy(){this._set("view",null),this._loadingHandle=Qr(this._loadingHandle),this.baseLayerViews.destroyAll(),this.groundLayerViews.destroyAll(),this.referenceLayerViews.destroyAll()}get suspended(){return this.view?.suspended??!0}get updating(){return this.view?.suspended?!1:!!this.view?.map?.basemap?.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.groundLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};_([E({constructOnly:!0})],gf.prototype,"view",void 0),_([E({readOnly:!0})],gf.prototype,"baseLayerViews",void 0),_([E({readOnly:!0})],gf.prototype,"groundLayerViews",void 0),_([E({readOnly:!0})],gf.prototype,"referenceLayerViews",void 0),_([E({readOnly:!0})],gf.prototype,"suspended",null),_([E({type:Boolean,readOnly:!0})],gf.prototype,"updating",null),gf=_([ue("esri.views.BasemapView")],gf);const RKe=gf;let Vl=class extends Kt{constructor(e){super(e),this.factor=1.5,this.offset=Fs(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};_([E({type:Number})],Vl.prototype,"factor",void 0),_([E({nonNullable:!0})],Vl.prototype,"offset",void 0),_([E()],Vl.prototype,"position",void 0),_([E({type:Number,range:{min:0}})],Vl.prototype,"size",void 0),_([E()],Vl.prototype,"maskUrl",void 0),_([E()],Vl.prototype,"maskEnabled",void 0),_([E()],Vl.prototype,"overlayUrl",void 0),_([E()],Vl.prototype,"overlayEnabled",void 0),_([E({readOnly:!0})],Vl.prototype,"version",null),_([E({type:Boolean})],Vl.prototype,"visible",void 0),Vl=_([ue("esri.views.Magnifier")],Vl);const t1e=Vl;let iw=class{constructor(e){this._observable=new nI,this._map=new Map(e)}get size(){return tn(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const n=this._map.delete(e);return n&&this._observable.notify(),n}entries(){return tn(this._observable),this._map.entries()}forEach(e,n){tn(this._observable),this._map.forEach((r,i)=>e.call(n,r,i,this),n)}get(e){return tn(this._observable),this._map.get(e)}has(e){return tn(this._observable),this._map.has(e)}keys(){return tn(this._observable),this._map.keys()}set(e,n){return this._map.set(e,n),this._observable.notify(),this}values(){return tn(this._observable),this._map.values()}[Symbol.iterator](){return tn(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var P7;let yS=P7=class extends qt{constructor(t){super(t),this.name=null,this.code=null}clone(){return new P7({name:this.name,code:this.code})}};_([E({type:String,json:{write:{isRequired:!0}}})],yS.prototype,"name",void 0),_([E({type:[String,Number],json:{write:{isRequired:!0}}})],yS.prototype,"code",void 0),yS=P7=_([ue("esri.layers.support.CodedValue")],yS);const PKe=new Gs({inherited:"inherited",codedValue:"coded-value",range:"range"});let tg=class extends qt{constructor(e){super(e),this.name=null,this.type=null}};_([E({type:String,json:{write:!0}})],tg.prototype,"name",void 0),_([pn(PKe),E({json:{write:{isRequired:!0}}})],tg.prototype,"type",void 0),tg=_([ue("esri.layers.support.Domain")],tg);var M7,kw;let wx=(kw=class extends tg{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let n=null;if(this.codedValues){const r=String(e);this.codedValues.some(i=>(String(i.code)===r&&(n=i.name),!!n))}return n}clone(){return new M7({codedValues:Ze(this.codedValues),name:this.name})}},M7=kw,kw);_([E({type:[yS],json:{write:{isRequired:!0}}})],wx.prototype,"codedValues",void 0),_([pn({codedValue:"coded-value"})],wx.prototype,"type",void 0),wx=M7=_([ue("esri.layers.support.CodedValueDomain")],wx);var C7,Aw;let gT=(Aw=class extends tg{constructor(e){super(e),this.type="inherited"}clone(){return new C7}},C7=Aw,Aw);_([pn({inherited:"inherited"})],gT.prototype,"type",void 0),gT=C7=_([ue("esri.layers.support.InheritedDomain")],gT);var N7,Iw;let yy=(Iw=class extends tg{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new N7({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}},N7=Iw,Iw);_([E({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,n){e[n]=[this.minValue||0,t]},isRequired:!0}}})],yy.prototype,"maxValue",void 0),_([E({json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range?.[0]},write:{target:"range",writer(t,e,n){e[n]=[t,this.maxValue||0]},isRequired:!0}}})],yy.prototype,"minValue",void 0),_([pn({range:"range"})],yy.prototype,"type",void 0),yy=N7=_([ue("esri.layers.support.RangeDomain")],yy);const MKe={key:"type",base:tg,typeMap:{range:yy,"coded-value":wx,inherited:gT}};function CKe(t){if(!t?.type)return null;switch(t.type){case"range":return yy.fromJSON(t);case"codedValue":return wx.fromJSON(t);case"inherited":return gT.fromJSON(t)}return null}const NKe=new Gs({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var O7;const OKe=new Gs({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});var Rw;let Wo=(Rw=class extends qt{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:n}){let r=null;try{r=n?JSON.parse(n):null}catch{}return r?.value??null}readValueType(e,{description:n}){let r=null;try{r=n?JSON.parse(n):null}catch{}return r?OKe.fromJSON(r.fieldValueType):null}clone(){return new O7({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}},O7=Rw,Rw);_([E({type:String,json:{write:!0}})],Wo.prototype,"alias",void 0),_([E({type:[String,Number],json:{write:{allowNull:!0}}})],Wo.prototype,"defaultValue",void 0),_([E()],Wo.prototype,"description",void 0),_([sr("description")],Wo.prototype,"readDescription",null),_([E({types:MKe,json:{read:{reader:CKe},write:!0}})],Wo.prototype,"domain",void 0),_([E({type:Boolean,json:{write:!0}})],Wo.prototype,"editable",void 0),_([E({type:Or,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Wo.prototype,"length",void 0),_([E({type:String,json:{write:!0}})],Wo.prototype,"name",void 0),_([E({type:Boolean,json:{write:!0}})],Wo.prototype,"nullable",void 0),_([pn(NKe)],Wo.prototype,"type",void 0),_([E()],Wo.prototype,"valueType",void 0),_([sr("valueType",["description"])],Wo.prototype,"readValueType",null),_([E({type:Boolean,json:{read:!1}})],Wo.prototype,"visible",void 0),Wo=O7=_([ue("esri.layers.support.Field")],Wo);var L7;let q_=L7=class extends qt{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new L7({mapLayerId:t,gdbVersion:e})}};_([pn({mapLayer:"map-layer"}),E({json:{write:{isRequired:!0}}})],q_.prototype,"type",void 0),_([E({type:Or,json:{write:{isRequired:!0}}})],q_.prototype,"mapLayerId",void 0),_([E({type:String,json:{write:!0}})],q_.prototype,"gdbVersion",void 0),q_=L7=_([ue("esri.layers.support.source.MapLayerSource")],q_);var D7;let yf=D7=class extends qt{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:n,spatialReference:r,geometryType:i}=this,s={workspaceId:t,query:e,oidFields:n,spatialReference:r?.clone()??void 0,geometryType:i};return new D7(s)}};_([pn({queryTable:"query-table"}),E({json:{write:{isRequired:!0}}})],yf.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],yf.prototype,"workspaceId",void 0),_([E({type:String,json:{write:!0}})],yf.prototype,"query",void 0),_([E({type:String,json:{write:!0}})],yf.prototype,"oidFields",void 0),_([E({type:Bt,json:{write:!0}})],yf.prototype,"spatialReference",void 0),_([pn(pBe)],yf.prototype,"geometryType",void 0),yf=D7=_([ue("esri.layers.support.source.QueryTableDataSource")],yf);var $7;let K_=$7=class extends qt{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new $7({workspaceId:t,dataSourceName:e})}};_([pn({raster:"raster"}),E({json:{write:{isRequired:!0}}})],K_.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],K_.prototype,"dataSourceName",void 0),_([E({type:String,json:{write:!0}})],K_.prototype,"workspaceId",void 0),K_=$7=_([ue("esri.layers.support.source.RasterDataSource")],K_);var j7;let ey=j7=class extends qt{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:n}=this;return new j7({workspaceId:t,gdbVersion:e,dataSourceName:n})}};_([pn({table:"table"}),E({json:{write:{isRequired:!0}}})],ey.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],ey.prototype,"workspaceId",void 0),_([E({type:String,json:{write:!0}})],ey.prototype,"gdbVersion",void 0),_([E({type:String,json:{write:!0}})],ey.prototype,"dataSourceName",void 0),ey=j7=_([ue("esri.layers.support.source.TableDataSource")],ey);var F7,V7;const LKe=kl()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let zl=F7=class extends qt{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,n){return qte()(t,e,n)}castLeftTableSource(t){return Cg(z7(),t)}readRightTableSource(t,e,n){return qte()(t,e,n)}castRightTableSource(t){return Cg(z7(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:n,rightTableSource:r,joinType:i}=this,s={leftTableKey:t,rightTableKey:e,leftTableSource:n?.clone()??void 0,rightTableSource:r?.clone()??void 0,joinType:i};return new F7(s)}};_([pn({joinTable:"join-table"}),E({json:{write:{isRequired:!0}}})],zl.prototype,"type",void 0),_([E({type:String,json:{write:!0}})],zl.prototype,"leftTableKey",void 0),_([E({type:String,json:{write:!0}})],zl.prototype,"rightTableKey",void 0),_([E({json:{write:!0}})],zl.prototype,"leftTableSource",void 0),_([sr("leftTableSource")],zl.prototype,"readLeftTableSource",null),_([zs("leftTableSource")],zl.prototype,"castLeftTableSource",null),_([E({json:{write:!0}})],zl.prototype,"rightTableSource",void 0),_([sr("rightTableSource")],zl.prototype,"readRightTableSource",null),_([zs("rightTableSource")],zl.prototype,"castRightTableSource",null),_([pn(LKe)],zl.prototype,"joinType",void 0),zl=F7=_([ue("esri.layers.support.source.JoinTableDataSource")],zl);let M$=null;function qte(){return M$||(M$=NG({types:z7()})),M$}let C$=null;function z7(){return C$||(C$={key:"type",base:null,typeMap:{"data-layer":Af,"map-layer":q_}}),C$}const DKe={key:"type",base:null,typeMap:{"join-table":zl,"query-table":yf,raster:K_,table:ey}};var Pw;let Af=(Pw=class extends qt{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:n}=this;return new V7({fields:e,dataSource:n})}},V7=Pw,Pw);_([pn({dataLayer:"data-layer"}),E({json:{write:{isRequired:!0}}})],Af.prototype,"type",void 0),_([E({type:[Wo],json:{write:!0}})],Af.prototype,"fields",void 0),_([E({types:DKe,json:{write:!0}})],Af.prototype,"dataSource",void 0),Af=V7=_([ue("esri.layers.support.source.DataLayerSource")],Af),Af.from=Fa(Af);let ty=class extends ho(qt){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};_([E({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],ty.prototype,"onFields",void 0),_([E({type:String,json:{write:!0}})],ty.prototype,"operator",void 0),_([E({type:String,json:{write:!0}})],ty.prototype,"searchTerm",void 0),_([E({type:String,json:{write:!0}})],ty.prototype,"searchType",void 0),ty=_([ue("esri.rest.support.FullTextSearch")],ty);const $Ke=ty;var U7;const Kte=new Gs({upperLeft:"upper-left",lowerLeft:"lower-left"});let Cm=U7=class extends qt{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new U7(Ze({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};_([E({type:Dn,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Cm.prototype,"extent",void 0),_([E({type:["view","edit"],json:{write:!0}})],Cm.prototype,"mode",void 0),_([E({type:String,json:{read:Kte.read,write:Kte.write}})],Cm.prototype,"originPosition",void 0),_([E({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Cm.prototype,"tolerance",void 0),Cm=U7=_([ue("esri.rest.support.QuantizationParameters")],Cm);const jKe=t=>{const e=t;let n=class extends e{};return n=_([ue("esri.rest.support.QueryMixin")],n),n},FKe=new Gs({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var G7;const Yte=new Gs({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let $u=G7=class extends qt{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=Ze(t))}clone(){return new G7({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Ze(this.statisticParameters)})}};_([E({type:Number,json:{write:!0}})],$u.prototype,"maxPointCount",void 0),_([E({type:Number,json:{write:!0}})],$u.prototype,"maxRecordCount",void 0),_([E({type:Number,json:{write:!0}})],$u.prototype,"maxVertexCount",void 0),_([E({type:String,json:{write:!0}})],$u.prototype,"onStatisticField",void 0),_([E({type:String,json:{write:!0}})],$u.prototype,"outStatisticFieldName",void 0),_([E({type:String,json:{read:{source:"statisticType",reader:Yte.read},write:{target:"statisticType",writer:Yte.write}}})],$u.prototype,"statisticType",void 0),_([E({type:Object})],$u.prototype,"statisticParameters",void 0),_([Xn("statisticParameters")],$u.prototype,"writeStatisticParameters",null),$u=G7=_([ue("esri.rest.support.StatisticDefinition")],$u);var PC;const VKe=new Gs({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});var s1;let en=(s1=class extends jKe(qt){static from(e){return tO(PC,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,n){n.historicMoment=e&&e.getTime()}writeParameterValues(e,n){if(e){const r={};for(const i in e){const s=e[i];Array.isArray(s)?r[i]=s.map(o=>o instanceof Date?o.getTime():o):s instanceof Date?r[i]=s.getTime():r[i]=s}n.parameterValues=r}}writeStart(e,n){n.resultOffset=this.start,n.resultRecordCount=this.num||10,n.where="1=1"}writeWhere(e,n){n.where=e||"1=1"}clone(){return new PC(Ze({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}},PC=s1,s1.MAX_MAX_RECORD_COUNT_FACTOR=5,s1);_([E({json:{write:!0}})],en.prototype,"aggregateIds",void 0),_([E({type:Boolean,json:{write:!0}})],en.prototype,"cacheHint",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"compactGeometryEnabled",void 0),_([E({json:{write:!0}})],en.prototype,"datumTransformation",void 0),_([zs("datumTransformation")],en.prototype,"castDatumTransformation",null),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"defaultSpatialReferenceEnabled",void 0),_([E({type:Number,json:{write:!0}})],en.prototype,"distance",void 0),_([E({type:Af,json:{write:!0}})],en.prototype,"dynamicDataSource",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"formatOf3DObjects",void 0),_([E({type:[$Ke],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],en.prototype,"fullText",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"gdbVersion",void 0),_([E({types:RB,json:{read:m2,write:!0}})],en.prototype,"geometry",void 0),_([E({type:Number,json:{write:!0}})],en.prototype,"geometryPrecision",void 0),_([E({type:[String],json:{write:!0}})],en.prototype,"groupByFieldsForStatistics",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"having",void 0),_([E({type:Date})],en.prototype,"historicMoment",void 0),_([Xn("historicMoment")],en.prototype,"writeHistoricMoment",null),_([E({type:Number,json:{write:!0}})],en.prototype,"maxAllowableOffset",void 0),_([E({type:Number,cast:t=>t<1?1:t>en.MAX_MAX_RECORD_COUNT_FACTOR?en.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],en.prototype,"maxRecordCountFactor",void 0),_([E({type:["xyFootprint"],json:{write:!0}})],en.prototype,"multipatchOption",void 0),_([E({type:Number,json:{read:{source:"resultRecordCount"}}})],en.prototype,"num",void 0),_([E({json:{write:!0}})],en.prototype,"objectIds",void 0),_([E({type:[String],json:{write:!0}})],en.prototype,"orderByFields",void 0),_([E({type:[String],json:{write:!0}})],en.prototype,"outFields",void 0),_([E({type:Bt,json:{name:"outSR",write:!0}})],en.prototype,"outSpatialReference",void 0),_([E({type:[$u],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],en.prototype,"outStatistics",void 0),_([E({json:{write:!0}})],en.prototype,"parameterValues",void 0),_([Xn("parameterValues")],en.prototype,"writeParameterValues",null),_([E({type:Jt,json:{write:!0}})],en.prototype,"pixelSize",void 0),_([E({type:Cm,json:{write:!0}})],en.prototype,"quantizationParameters",void 0),_([E({type:[Object],json:{write:!0}})],en.prototype,"rangeValues",void 0),_([E({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],en.prototype,"relationParameter",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"resultType",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnCentroid",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnDistinctValues",void 0),_([E({type:Boolean,json:{default:!0,write:!0}})],en.prototype,"returnExceededLimitFeatures",void 0),_([E({type:Boolean,json:{write:!0}})],en.prototype,"returnGeometry",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnQueryGeometry",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"returnM",void 0),_([E({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],en.prototype,"returnZ",void 0),_([E({type:Boolean,json:{write:!0}})],en.prototype,"returnTrueCurves",void 0),_([E({type:Bt,json:{write:!0}})],en.prototype,"sourceSpatialReference",void 0),_([pn(FKe,{ignoreUnknown:!1,name:"spatialRel"})],en.prototype,"spatialRelationship",void 0),_([E({type:Number,json:{read:{source:"resultOffset"}}})],en.prototype,"start",void 0),_([Xn("start"),Xn("num")],en.prototype,"writeStart",null),_([E({type:String,json:{write:!0}})],en.prototype,"sqlFormat",void 0),_([E({type:String,json:{write:!0}})],en.prototype,"text",void 0),_([E({type:Ea,json:{write:!0}})],en.prototype,"timeExtent",void 0),_([E({type:Boolean,json:{default:!1,write:!0}})],en.prototype,"timeReferenceUnknownClient",void 0),_([pn(VKe,{ignoreUnknown:!1}),E({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],en.prototype,"units",void 0),_([E({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],en.prototype,"where",void 0),_([Xn("where")],en.prototype,"writeWhere",null),en=PC=_([ue("esri.rest.support.Query")],en);function um(t){return!(t==null||typeof t!="object"||!("createQuery"in t)||!t.createQuery)}let Cc=class extends tI{constructor(e){super(e),this._selectionMap=new iw,this._sources=new Ot,this._trashCan=[],this._layerEditHandles=new Ot,this._vizTaskId=0,this.view=null,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([dn(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),dn(()=>this.view,e=>{e?.when().then(()=>this.syncSources())},fa),$1(()=>this.sources,"change",e=>{const n=this._selectionMap,r=[];for(const i of e.removed){const s=n.get(i);s&&(n.delete(i),s.highlightHandle?.remove(),r.push({layer:i,selection:[],added:[],removed:[...s.selection]}))}this._refreshListeners(),r.length&&this._onSelectionChange(r)},{onListenerAdd:()=>this._refreshListeners()})])}destroy(){this.clear(),this._layerEditHandles.drain(Qr)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[n,r]=e;return{layer:n,selection:[...r.selection]}})}get count(){let e=0;for(const n of this._selectionMap.values())e+=n.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){fd(e,this._sources)}syncSources(){const e=new Set,n=this.view?.map;if(!n)return;const r=i=>{O7e(i)?(i.layers?.forEach(r),i.tables?.forEach(r)):N7e(i)?(i.sublayers?.forEach(r),i.subtables?.forEach(r)):Nee(i)?i.sublayers?.forEach(r):um(i)&&e.add(i)};n.allLayers.forEach(r),n.allTables.forEach(r),this.sources=[...e]}async getSelectedFeatures(e,n={},r="layerView"){const{view:i,selections:s}=this;if(!i&&r==="layerView")return St.getLogger(this).warn("Cannot query layer views without a view."),[];const o=(e?.length?s.filter(a=>e.includes(a.layer)):s).map(async a=>{const{layer:l,selection:c}=a;if(!c.length)return;const u=j_(l)?l.parent:l;if(u!=null){if(i&&r==="layerView"&&!Xte(u)&&Zte(u)){const h=await i.whenLayerView(u).catch(()=>null);if(h)return Jte(h,c,n)}return Jte(u,c,n)}}).filter(e2);return(await Promise.all(o)).filter(e2)}updateSelection(e){const n=new Map;for(const[s,o]of this._selectionMap)n.set(s,[...o.selection]);let r=!1;const i=e.current.concat(e.added);for(const s of i){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(um(o)||j_(o))&&a!==null){const l=XA(n,o,()=>[]);l.includes(a)||(l.push(a),r=!0)}}for(const s of e.removed){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(um(o)||j_(o))&&a!==null){const l=n.get(o),c=l?.indexOf(a);c!==void 0&&c>=0&&(l?.splice(c,1),r=!0)}}if(r){const{_selectionMap:s,_trashCan:o}=this,a=[];for(const[l,c]of n){const u=s.get(l);u!==void 0&&o.push(u),s.set(l,{selection:c}),a.push({layer:l,selection:c,...UJ(u!==void 0?u.selection:[],c)})}this._onSelectionChange(a)}}setSelection(e,n){this._setSelection(e,n)}getSelection(e){return this._selectionMap.get(e)?.selection}appendToSelection(e,n){const r=this._selectionMap.get(e),i=r!==void 0?[...r.selection]:[];for(const s of n)i.includes(s)||i.push(s);this._setSelection(e,i)}removeFromSelection(e,n){const r=this._selectionMap.get(e);if(!r)return;const i=[];for(const s of r.selection)n.includes(s)||i.push(s);this._setSelection(e,i)}toggleInSelection(e,n){const r=this._selectionMap.get(e);if(!r||r.selection.length===0)return void this._setSelection(e,n);const i=new Set(r.selection),s=new Set(n),o=g$e(i,s);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const n=[];for(const[r,i]of this._selectionMap.entries())n.push({layer:r,added:[],removed:[...i.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(n)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){for(this._vizTaskId++;this._trashCan.length>0;)this._trashCan.pop()?.highlightHandle?.remove();if(this.view==null)return;const{sources:e,view:n,_selectionMap:r,showHighlight:i}=this,s=this._vizTaskId;for(const o of e){const a=r.get(o),l=j_(o)?o.parent:o;if(l!=null&&Zte(l)){if(Xte(l))continue;n.whenLayerView(l).then(c=>{a?.highlightHandle?.remove(),a!=null&&i&&s===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&a.selection.length>0&&(a.highlightHandle=c.highlight(a.selection,this.highlightName))}).catch(()=>{a?.highlightHandle?.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(Qr);const e=new Set(this.sources.map(n=>j_(n)?n.parent:n));for(const n of e)um(n)&&"on"in n&&n.on&&this._layerEditHandles.push(n.on("edits",r=>this._onLayerEdit(r,n)))}_onLayerEdit(e,n){if(Nee(n))this._onParentLayerEdit(e,n);else if(e.deletedFeatures.length&&this._selectionMap.has(n)){const r=[];e.deletedFeatures.forEach(({error:i,objectId:s})=>{s!=null&&i==null&&r.push(s)}),this.removeFromSelection(n,r)}}_onParentLayerEdit(e,n){const{deletedFeatures:r,edits:i,updatedFeatures:s}=e;if(i?.updateFeatures?.forEach(o=>{const a=o.getObjectId()??o.attributes[n.objectIdField];if(a==null||s.find(u=>u.objectId===a)?.error)return;const l=n.findSublayerForFeature(o);if(!um(l))return;const c=n.sublayers.find(u=>!(!um(u)||!this.getSelection(u)?.includes(a)));um(c)&&c!==l&&(this.removeFromSelection(c,[a]),this.appendToSelection(l,[a]))}),r.length){const o=[];r.forEach(({error:a,objectId:l})=>{l!=null&&a==null&&o.push(l)}),n.sublayers.forEach(a=>{um(a)&&this._selectionMap.has(a)&&this.removeFromSelection(a,o)})}}_setSelection(e,n){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const r=this._selectionMap.get(e);if(r===void 0||!UKe(r,{selection:n})){r!==void 0&&this._trashCan.push(r),this._selectionMap.set(e,{selection:[...n]});const i={layer:e,selection:[...n],...UJ(r!==void 0?r.selection:[],n)};this._onSelectionChange([i])}}};_([E()],Cc.prototype,"_selectionMap",void 0),_([E()],Cc.prototype,"_sources",void 0),_([E({readOnly:!0,nonNullable:!0})],Cc.prototype,"selections",null),_([E({readOnly:!0,nonNullable:!0})],Cc.prototype,"count",null),_([E()],Cc.prototype,"view",void 0),_([E({readOnly:!0,nonNullable:!0})],Cc.prototype,"hasSelection",null),_([E()],Cc.prototype,"showHighlight",void 0),_([E()],Cc.prototype,"sources",null),_([E()],Cc.prototype,"highlightName",void 0),Cc=_([ue("esri.views.SelectionManager")],Cc);const Xte=t=>j_(t)?t.parent?.isTable===!0:t.isTable,zKe=t=>t.layer!==void 0,Zte=t=>t?.when!==void 0,UKe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const n=[...t.selection],r=[...e.selection];if(n.length!==r.length)return!1;n.sort(),r.sort();for(let i=0;i<n.length;i++)if(n[i]!==r[i])return!1}return!0},Jte=async(t,e,n={})=>{let r;if(zKe(t)){const i=t;r=i===void 0?null:await i.queryFeatures(new en({...n,objectIds:e})).then(s=>({data:s,layer:t.layer}))}else{const i=t;r=i===void 0?null:await i.queryFeatures(new en({...n,objectIds:e})).then(s=>({data:s,layer:i}))}return r},GKe=Cc;let vS=class extends ho(Kt){constructor(e){super(e),this.accentColor=new Kn([255,127,0]),this.textColor=new Kn([255,255,255])}};_([E({type:Kn,nonNullable:!0})],vS.prototype,"accentColor",void 0),_([E({type:Kn,nonNullable:!0})],vS.prototype,"textColor",void 0),vS=_([ue("esri.views.Theme")],vS);const B7=vS,n1e=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],r1e={};function i1e(t){return!!r1e[t]}function BKe(t){for(const e of t)if(!i1e(e))return!1;return!0}n1e.forEach(t=>{r1e[t]=!0});let s1e=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:n,priority:r},i)=>this.inputManager?.installHandlers(i,[n],r))}disconnect(){this.inputManager&&this._handlers.forEach((e,n)=>this.inputManager?.uninstallHandlers(n)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,n,r,i){const s=Array.isArray(e)?e:e.split(",");if(!BKe(s))return s.some(i1e)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(n)?a=n:(o=n,a=[]),typeof r=="function"?o=r:i=r,i=i??Xf.DEFAULT;const l=this._createUniqueGroupName(),c=new WKe(this.view,s,a,o);this._handlers.set(l,{handler:c,priority:i});for(const u of s){const h=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,h+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],i),qn(()=>this._removeHandler(l,s))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,n){if(this._handlers.has(e)){this._handlers.delete(e);for(const r of n){const i=this._handlerCounts.get(r);i===void 0||(i===1?this._handlerCounts.delete(r):this._handlerCounts.set(r,i-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},WKe=class extends Ws{constructor(e,n,r,i){super(!0),this._latestDragStart=void 0,this.view=e;for(const s of n)switch(s){case"click":this.registerIncoming("click",r,o=>i(KKe(e,o)));break;case"double-click":this.registerIncoming("double-click",r,o=>i(YKe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",r,o=>i(XKe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",r,o=>i(ZKe(e,o)));break;case"hold":this.registerIncoming("hold",r,o=>i(JKe(e,o)));break;case"drag":this.registerIncoming("drag",r,o=>{const a=this._wrapDrag(o);a&&i(a)});break;case"key-down":this.registerIncoming("key-down",r,o=>i(QKe(o)));break;case"key-up":this.registerIncoming("key-up",r,o=>i(eYe(o)));break;case"pointer-down":this.registerIncoming("pointer-down",r,o=>i(kE(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",r,o=>i(kE(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",r,o=>i(kE(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",r,o=>i(tYe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",r,o=>i(nYe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",r,o=>i(kE(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",r,o=>i(kE(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",r,o=>{i(rYe(o))});break;case"focus":this.registerIncoming("focus",r,o=>{i(HKe(o))});break;case"blur":this.registerIncoming("blur",r,o=>{i(qKe(o))})}}_wrapDrag(e){const n=e.data,{x:r,y:i}=n.center,{action:s,pointerType:o,button:a}=n;if(s==="start"&&(this._latestDragStart=n),!this._latestDragStart)return;const l=n.pointer.native,c=n.buttons,{cancelable:u,timestamp:h}=e,f={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:r,y:i,origin:f,pointerType:o,button:a,buttons:c,radius:n.radius,angle:Ume(n.angle),native:l,timestamp:h,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:g=>e.defer(g),preventDefault:()=>e.preventDefault()}}};function HKe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function qKe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),defer:e=>t.defer(e),preventDefault:()=>t.preventDefault()}}function KKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:u,screenPoint:Fs(s,o),mapPoint:_I(t,s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function YKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:u,mapPoint:_I(t,s,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),defer:h=>e.defer(h),preventDefault:()=>e.preventDefault()}}function XKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-click",pointerId:c,pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:h,mapPoint:_I(t,s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function ZKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a,eventId:l}=e.data,c=a.pointerId,{cancelable:u,timestamp:h}=e;return{type:"immediate-double-click",pointerId:c,pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:h,mapPoint:_I(t,s,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),defer:f=>e.defer(f),preventDefault:()=>e.preventDefault()}}function JKe(t,e){const{pointerType:n,button:r,buttons:i,x:s,y:o,native:a}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:n,button:r,buttons:i,x:s,y:o,native:a,timestamp:c,mapPoint:_I(t,s,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),defer:u=>e.defer(u),preventDefault:()=>e.preventDefault()}}function _I(t,e,n){return t.toMap(Fs(e,n),{exclude:[]})}function QKe(t){const{key:e,repeat:n,native:r}=t.data,{cancelable:i,timestamp:s}=t;return{type:"key-down",key:e,repeat:n,native:r,timestamp:s,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:o=>t.defer(o),preventDefault:()=>t.preventDefault()}}function eYe(t){const{key:e,native:n}=t.data,{cancelable:r,timestamp:i}=t;return{type:"key-up",key:e,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),defer:s=>t.defer(s),preventDefault:()=>t.preventDefault()}}function kE(t,e){const{x:n,y:r,button:i,buttons:s,native:o,eventId:a}=t.data,l=o.pointerId,c=o.pointerType,{cancelable:u,timestamp:h}=t;return{type:e,x:n,y:r,pointerId:l,pointerType:c,button:i,buttons:s,native:o,timestamp:h,eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),defer:f=>t.defer(f),preventDefault:()=>t.preventDefault()}}function tYe(t){const{x:e,y:n,buttons:r,native:i,eventId:s}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,c=t.data.action,u={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:f}=t;return{type:"pointer-drag",x:e,y:n,pointerId:a,pointerType:l,button:o,buttons:r,action:c,origin:u,native:i,timestamp:f,eventId:s,cancelable:h,stopPropagation:()=>t.stopPropagation(),defer:g=>t.defer(g),preventDefault:()=>t.preventDefault()}}function nYe(t){const{cancelable:e,data:n,timestamp:r}=t,{x:i,y:s,deltaY:o,native:a}=n;return{type:"mouse-wheel",x:i,y:s,deltaY:o,native:a,timestamp:r,cancelable:e,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}function rYe(t){const{action:e,state:n,device:r}=t.data,{cancelable:i,timestamp:s}=t,{buttons:o,axes:a}=n;return{type:"gamepad",device:r,timestamp:s,action:e,buttons:o,axes:a,cancelable:i,stopPropagation:()=>t.stopPropagation(),defer:l=>t.defer(l),preventDefault:()=>t.preventDefault()}}const iYe="z",sYe="r",o1e={cancel:"Escape",complete:"Enter"},E3t={...o1e,redo:sYe,undo:iYe,center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},S3t={toggle:"Control"},T3t={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},k3t={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:K0e,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0}};let A3t=class{constructor(){this._bindings=new Map}add(e,n){return this.addToggle(e,r=>{r.type==="key-down"&&n(r)})}addToggle(e,n){const r=oYe.fromDefinition(e,n),i=XA(this._bindings,r.key,()=>[]);return i.push(r),qn(()=>Jhe(i,r))}register(e,n=Xf.WIDGET){return rv([e.on("key-down",r=>this.dispatch(e.inputManager,r),n),e.on("key-up",r=>this.dispatch(e.inputManager,r),n)])}dispatch(e,n){const r=n.key,i=this._bindings.get(r);if(i)for(const s of i)s.process(e,n)}},oYe=class W7{constructor(e,n,r,i,s){this.key=e,this.modifiers=n,this.repeats=r,this.continuePropagation=i,this.callback=s}process(e,n){if(!(n.key!==this.key||"repeat"in n&&n.repeat&&!this.repeats)){for(const r of this.modifiers)if(!e.isModifierKeyDown(r))return;this.continuePropagation||n.stopPropagation(),this.callback(n)}}static fromDefinition(e,n){if(typeof e=="string")return new W7(e,[],!1,!1,n);const{key:r,modifier:i,repeats:s,continuePropagation:o}=e;return new W7(r,i?Array.isArray(i)?i:[i]:[],!!s,!!o,n)}};function aYe(t){return[t.on("before-add",e=>{const n=e.item;if(n==null||t.includes(n))return St.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();n.onAdd()}),t.on("after-remove",e=>{const n=e.item;n.active&&(n.view.activeTool=null),n.destroy()})]}function H7(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function lYe(t){return t.type==="key-down"&&t.key===o1e.cancel}function zh(t){return Fs(t.x,t.y)}function a1e(t,e){const n=(t instanceof HTMLElement?t:t.surface)?.getBoundingClientRect();return n?Fs(e.clientX-n.left,e.clientY-n.top):Fs(0,0)}function l1e(t,e){return e instanceof Event?a1e(t,e):zh(e)}function c1e(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let MC=class extends Kt{constructor(){super(...arguments),this._pointerLocations=new Map,this._hoveredManipulators=new iw,this._grabbedManipulators=new iw,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1}get cursor(){return this._cursorFromMap(this._grabbedManipulators,"grabbing")??this._cursorFromMap(this._hoveredManipulators,"pointer")}get hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,n){const r=()=>e.stopPropagation();switch(e.type){case"pointer-move":Qte(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(r(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!ene(e))break;const i=zh(e),s=y_(i,e.pointerType,n.tools);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,n),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:i,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&n.activeTool==null&&(this._revertToNullActiveTool=!0,n.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:i}),r());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,n);break;case"pointer-drag":{if(!ene(e))break;const i=this._grabbedManipulators.get(e.pointerId),s=i?.manipulator,o=i?.tool;if(s==null||o==null)break;const a=zh(e);a.x=cu(a.x,0,n.view.width),a.y=cu(a.y,0,n.view.height);const l=i.start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:a}):s.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,n)}r();break}case"immediate-click":{const i=zh(e),s=y_(i,e.pointerType,n.tools);if(!cYe(e)){for(const c of n.tools)if((s==null||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}if(s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:r}),N$(o,r);break}case"click":{const i=zh(e),s=y_(i,e.pointerType,n.tools),o=s?.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a}),r();break}case"double-click":{const i=zh(e),s=y_(i,e.pointerType,n.tools),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),N$(o,r);break}case"immediate-double-click":{const i=zh(e),s=y_(i,e.pointerType,n.tools),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:i,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:r}),e.pointerType==="mouse"&&N$(o,r);break}}this._onFocusChange(n.tools)}_releaseManipulatorBeforeDragging(e,n,r){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:n.pointerType,screenPoint:zh(n)}),this._grabbedManipulators.forEach(({manipulator:i},s)=>{i===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorRelease(r.setActiveTool)}_handlePointerEnd(e,n){const r=this._grabbedManipulators.get(e.pointerId)?.manipulator;r!=null&&r.grabbing&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:zh(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(n.setActiveTool))}_onFocusChange(e){this._updateFocusedManipulatorTools(e)}_updateFocusedManipulatorTools(e){const n=new Set,r=new Set;this._grabbedManipulators.forEach(({tool:i})=>n.add(i)),this._hoveredManipulators.forEach(({tool:i})=>r.add(i));for(const i of e){i.hasGrabbedManipulators=n.has(i),i.hasHoveredManipulators=r.has(i);const s=this._grabbedManipulators.values(),o=N6e(s,({tool:a})=>a===i);i.firstGrabbedManipulator=o!=null?o.manipulator:null}}clearPointers(e,{tools:n,setActiveTool:r},i=!0,s){const o=(a,l)=>a===e&&(s==null||s===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:c},u)=>{o(a,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),i&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},c)=>{o(a,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorRelease(r),this._onFocusChange(n)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((n,r)=>{this._updateHoveredStateForPointerAtScreenPosition(Fs(n.x,n.y),r,n.pointerType,e)})}handleHoverEvent(e,n){const r=e.type;r!=="pointer-up"&&r!=="immediate-click"&&r!=="pointer-move"||!Qte(e.pointerType)||(r!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(zh(e),e.pointerId,e.pointerType,n))}_updateHoveredStateForPointerAtScreenPosition(e,n,r,i){let s=y_(e,r,i);const o=this._hoveredManipulators.get(n)?.manipulator;s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(n,s)):this._hoveredManipulators.delete(n),this._onFocusChange(i))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:n},r)=>{e===r&&(this._hoveredManipulators.delete(e),n.hovering=!1)})}_cursorFromMap(e,n){if(!e?.size)return null;for(const{manipulator:r}of e.values())if(r?.interactive){if(r.grabbing&&r.grabCursor)return r.grabCursor;if(r.cursor)return r.cursor}return n}};function y_(t,e,n){for(const r of n){if(r.manipulators==null||!H7(r))continue;const i=r.manipulators.intersect(t,e);if(i!=null)return{tool:r,manipulator:i}}return null}function Qte(t){return t==="mouse"}function ene(t){return t.pointerType!=="mouse"||t.button===0}function cYe(t){return!!t.native.shiftKey}function N$(t,e){t?.consumesClicks&&e()}_([E()],MC.prototype,"cursor",null),MC=_([ue("esri.views.interactive.ToolViewManagerManipulatorState")],MC);const tne="attached",O$="tools",uYe=1e3;let Uh=class extends Kt{constructor(e){super(e),this._updatingHandles=new Jy,this._clock=G2,this._manipulatorState=new MC,this.tools=new Ot,this._interacting=!1,this._interactingTimeout=uYe,this._interactingTimeoutHandle=null}initialize(){this.addHandles([this.view.on(n1e,e=>{this._handleInputEvent(e)},Xf.TOOL),...aYe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy(),this._manipulatorState.destroy()}get _manipulatorStateEventArgs(){return{tools:this.tools,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void St.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const n=this.activeTool;this._set("activeTool",e),n?.deactivate(),e?.activate(),this._removeIncompleteTools(e);for(const r of this.tools){this._updateToolEditableFlag(r);const i=H7(r);this.activeTool!=null&&i||this._manipulatorState.clearPointers(r,this._manipulatorStateEventArgs,!i)}}get cursor(){const e=this._manipulatorState.cursor;if(e!=null)return e;for(const n of this.tools)if(n.visible&&n.cursor!=null)return n.cursor;return null}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Qr(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){this.view.type==="3d"?this.addHandles([dn(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>this._forEachManipulator(e=>e.onViewChange())),this.view.elevationProvider.on("elevation-change",e=>this._forEachManipulator(n=>n.onElevationChange(e)))],tne):this.addHandles(dn(()=>this.view.extent,()=>this._forEachManipulator(e=>e.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(tne),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){for(const n of this.tools)n.manipulators&&n.manipulators.forEach(({manipulator:r})=>e(r,n))}_handleInputEvent(e){let n=!1;const r={...e,stopPropagation:()=>{n=!0,e.stopPropagation()}};if(this.activeTool!=null)this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(r);else for(const i of this.tools)!n&&i.visible&&i.handleInputEvent(r);!n&&lYe(e)&&this.activeTool&&(e.stopPropagation(),e.preventDefault(),this.activeTool.cancel(),this.activeTool=null),this._manipulatorState.handleInputEvent(r,this._manipulatorStateEventArgs),n||this.activeTool==null||this.activeTool.handleInputEventAfter(r),this._manipulatorState.handleHoverEvent(r,this.tools),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(O$);for(const e of this.tools){if(e instanceof Kt){const n=dn(()=>[e.cursor,e.visible,e.editable],()=>{H7(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs)});this.addHandles(n,O$)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",n=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,n.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)})],O$)}this._manipulatorState.updateHoveredStateFromKnownPointers(this.tools)}_updateToolEditableFlag(e){e.setEditableFlag?.(1,this.activeTool==null||e===this.activeTool)}_removeIncompleteTools(e){this.tools.filter(n=>(e==null||n!==e)&&!n.created&&n.removeIncompleteOnCancel).forEach(n=>{this.tools.remove(n)})}get test(){}};_([E({constructOnly:!0,nonNullable:!0})],Uh.prototype,"view",void 0),_([E({value:null})],Uh.prototype,"activeTool",null),_([E({readOnly:!0,type:Ot})],Uh.prototype,"tools",void 0),_([E()],Uh.prototype,"cursor",null),_([E({readOnly:!0})],Uh.prototype,"updating",null),_([E()],Uh.prototype,"_interacting",void 0),_([E({readOnly:!0})],Uh.prototype,"interacting",null),Uh=_([ue("esri.views.ToolViewManager")],Uh);const hYe=new Kn("cyan"),dYe=1,fYe=.25,pYe=new Kn("black"),mYe=.4,gYe=.2,M3t=.25,u1e="default",yYe="temporary",vYe=new Kn("yellow");var q7;let Ul=q7=class extends Kt{constructor(t){super(t),this.name=u1e,this.color=hYe.clone(),this.haloColor=null,this.haloOpacity=dYe,this.fillOpacity=fYe,this.shadowColor=pYe.clone(),this.shadowOpacity=mYe,this.shadowDifference=gYe,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){return new q7({...this,color:this.color.clone(),haloColor:this.haloColor?.clone(),shadowColor:this.shadowColor?.clone()})}assignFrom(t){this.color=t.color.clone(),this.haloColor=t.haloColor?.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};_([E({type:String,constructOnly:!0,nonNullable:!0})],Ul.prototype,"name",void 0),_([E({type:Kn,nonNullable:!0})],Ul.prototype,"color",void 0),_([E({type:Kn})],Ul.prototype,"haloColor",void 0),_([E({nonNullable:!0})],Ul.prototype,"haloOpacity",void 0),_([E({nonNullable:!0})],Ul.prototype,"fillOpacity",void 0),_([E({type:Kn,nonNullable:!0})],Ul.prototype,"shadowColor",void 0),_([E({nonNullable:!0})],Ul.prototype,"shadowOpacity",void 0),_([E({nonNullable:!0})],Ul.prototype,"shadowDifference",void 0),_([E({nonNullable:!0})],Ul.prototype,"haloWidth",void 0),_([E({nonNullable:!0})],Ul.prototype,"haloBlur",void 0),Ul=q7=_([ue("esri.views.support.HighlightOptions")],Ul);const yg=Ul;function _Ye(){return new(Ot.ofType(yg))([new yg({name:u1e}),new yg({name:yYe,color:vYe})])}let Y_=class extends Kt{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":xYe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return wYe[this.deviceType]}};_([E({nonNullable:!0,readOnly:!0})],Y_.prototype,"nativeIndex",void 0),_([E({type:String,readOnly:!0})],Y_.prototype,"deviceType",null),_([E({type:Number,readOnly:!0})],Y_.prototype,"axisThreshold",null),Y_=_([ue("esri.views.input.gamepad.GamepadInputDevice")],Y_);const qB=Y_,xYe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),wYe={standard:.15,spacemouse:.025,unknown:0};let _S=class extends Kt{constructor(e){super(e),this.devices=new Ot,this.enabledFocusMode="document"}};_([E({type:Ot.ofType(qB),readOnly:!0})],_S.prototype,"devices",void 0),_([E({type:["document","view","none"]})],_S.prototype,"enabledFocusMode",void 0),_S=_([ue("esri.views.input.gamepad.GamepadSettings")],_S);const bYe=_S;let CC=class extends Kt{constructor(){super(...arguments),this.gamepad=new bYe}};_([E({readOnly:!0})],CC.prototype,"gamepad",void 0),CC=_([ue("esri.views.input.Input")],CC);const EYe=CC,L$=()=>E({type:["pan","rotate","zoom","none"],nonNullable:!0});let ny=class extends Kt{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};_([L$()],ny.prototype,"dragPrimary",void 0),_([L$()],ny.prototype,"dragSecondary",void 0),_([L$()],ny.prototype,"dragTertiary",void 0),_([E({type:["zoom","none"],nonNullable:!0})],ny.prototype,"mouseWheel",void 0),ny=_([ue("esri.views.navigation.NavigationActionMap")],ny);const KB=ny;let wm=class extends Kt{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};_([E({type:Boolean,nonNullable:!0})],wm.prototype,"enabled",void 0),_([E({type:qB})],wm.prototype,"device",void 0),_([E({type:["pan","zoom"],nonNullable:!0})],wm.prototype,"mode",void 0),_([E({type:["forward-down","forward-up"],nonNullable:!0})],wm.prototype,"tiltDirection",void 0),_([E({type:Number,nonNullable:!0})],wm.prototype,"velocityFactor",void 0),wm=_([ue("esri.views.navigation.gamepad.GamepadSettings")],wm);const h1e=wm;let bm=class extends Kt{constructor(e){super(e),this.actionMap=new KB,this.browserTouchPanEnabled=!0,this.gamepad=new h1e,this.momentumEnabled=!0}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){fF(St.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};_([E({type:KB,nonNullable:!0})],bm.prototype,"actionMap",void 0),_([E({type:Boolean})],bm.prototype,"browserTouchPanEnabled",void 0),_([E({type:h1e,nonNullable:!0})],bm.prototype,"gamepad",void 0),_([E({type:Boolean})],bm.prototype,"momentumEnabled",void 0),_([E({type:Boolean})],bm.prototype,"mouseWheelZoomEnabled",null),bm=_([ue("esri.views.navigation.Navigation")],bm);const PO=bm;function j3t(t,e,n){const r=d1e(t),i=e,s=SYe(r,i,n);if(r){const o=Qa.deriveUnitFromSR(r,t.spatialReference).heightUnit;if(!n&&o!==r.heightUnit){const a=new Xe("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new Xe("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r,error:a})}}if(!TYe(t)||s===4)return new Xe("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:r});switch(s){case 1:{const o=r?.heightUnit||"unknown",a=i?.heightUnit||"unknown",l=new Xe("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}case 2:{const o=r?.heightModel||"unknown",a=i?.heightModel||"unknown",l=new Xe("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}case 3:{const o=r?.vertCRS||"unknown",a=i?.vertCRS||"unknown",l=new Xe("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new Xe("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:r,sceneHeightModelInfo:i,error:l})}}return null}function SYe(t,e,n){if(!nne(t)||!nne(e))return 4;if(t==null||e==null)return 0;if(!n&&t.heightUnit!==e.heightUnit)return 1;if(t.heightModel!==e.heightModel)return 2;switch(t.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return t.vertCRS===e.vertCRS?0:3;default:return 4}}function nne(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function TYe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!m1e(t)}function d1e(t){if(t.type==="integrated-mesh-3dtiles"||t.type==="gaussian-splat")return null;const e=t.url?JA(t.url):void 0;return!(t.spatialReference?.vcsWkid==null&&e!=null&&e.serverType==="ImageServer")&&f1e(t)&&t.heightModelInfo?t.heightModelInfo:m1e(t)?Qa.deriveUnitFromSR(AYe,t.spatialReference):null}function f1e(t){return"heightModelInfo"in t}function p1e(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function m1e(t){return p1e(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):g1e(t)}function kYe(t){return t.layers!=null||g1e(t)||p1e(t)||f1e(t)}function g1e(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"gaussian-splat":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const AYe=new Qa({heightModel:"gravity-related-height"});let K7,D$=null;async function IYe(t){D$||(D$=xe(()=>import("./geometryServiceUtils-CGkANAD2.js"),__vite__mapDeps([303,304])).then(e=>K7=e)),await D$,hi(t)}async function y1e(t,e,n,r){if(!t)return null;const i=t.spatialReference;return _p()||hh(i,e)?av(t,e):K7?K7.projectGeometry(t,e,n,r):(await Promise.race([IYe(r),$g(r)]),y1e(t,e,n,r))}async function F3t(t,e){try{return t?.spatialReference?await Yge(t,e):null}catch{return null}}let Wr=class extends Kt{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=R1(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){const e=this.map?.(),n=[];return this.priorityCollection!=null&&n.push(this.priorityCollection),n.push({parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers},{parent:e?.ground,layers:e?.ground?.layers},{parent:e?.basemap,layers:e?.basemap?.referenceLayers}),n}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,r=>{const i=this._getSupportedSpatialReferences(r);if(i.length>0){const s=this._narrowDownSpatialReferenceCandidates(e,i);s!=null&&(e=s)}return e?.length===1})&&e?.length!==1)return{updating:!0};const n=this._pickSpatialReferenceCandidate(e);return{spatialReference:n?.spatialReference??null,viewingMode:n?.viewingMode??null,updating:!1}}get _tileInfoTask(){if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=this.map?.(),n=this.spatialReference;if(!n)return{updating:this._spatialReferenceTask.updating};let r;const i=this._collectLayers([{parent:e?.basemap,layers:e?.basemap?.baseLayers},{parent:e?.basemap,layers:e?.basemap?.groundLayers},{layers:e?.layers}],s=>!(!("tileInfo"in s)||!s.tileInfo?.spatialReference.equals(n))&&(r=s,!0),s=>"tileInfo"in s);return r?{tileInfo:r.tileInfo,updating:!1}:{updating:i}}get _heightModelInfoTask(){if(!this.required.heightModelInfo||this.suspended&&this._get("_heightModelInfoTask")?.heightModelInfo)return this._get("_heightModelInfoTask")??{updating:!1};let e={};const n=this._collectLayers(this.mapCollections,r=>{const i=d1e(r);return!!i&&(e={heightModelInfo:i,vcsWkid:r.spatialReference?.vcsWkid,latestVcsWkid:r.spatialReference?.latestVcsWkid},!0)},r=>kYe(r));return{...e,updating:n}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],n=this._collectLayers(this.mapCollections,r=>{const i="fullExtents"in r&&r.fullExtents||(r.fullExtent!=null?[r.fullExtent]:[]),s=this.requiresExtentInSpatialReference?null:i[0],o=i.find(a=>a.spatialReference.equals(this.spatialReference))??s;if(o)return e.push({extent:o,layer:r}),!0;if(this._getSupportedSpatialReferences(r).length>0)for(const a of i)e.push({extent:a,layer:r});return!1});return{candidates:e,updating:n}}get _extentTask(){const{candidates:e,updating:n}=this._extentCandidatesTask;if(n)return{updating:n};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const r=this._pickExtentCandidate(e),i=this.spatialReference;return r.extent.equals(this._projectExtentTask.input)&&i.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=R1(this._projectExtentTask.task)),this._projectExtentTask={input:r.extent.clone(),output:null,spatialReference:i.clone(),task:iO(async s=>{try{const o=await y1e(r.extent,i,"portalItem"in r.layer?r.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(ha(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,n){if(e==null)return n;const r=new Array;for(const i of e)for(const s of n){if(!i.spatialReference.equals(s.spatialReference))continue;const o=PYe(i.viewingMode,s.viewingMode);if(o!==!1){r.push({spatialReference:i.spatialReference,viewingMode:o});break}}return r.length>0?r:null}_pickSpatialReferenceCandidate(e){const n=this.defaultSpatialReference;return e==null||e.length<1?n?{spatialReference:n,viewingMode:null}:null:(n!=null&&e.length>1&&e.some(({spatialReference:r})=>r.equals(n))&&(e=e.filter(({spatialReference:r})=>r.equals(n))),e.length>1&&e.some(({viewingMode:r})=>r!==2)&&(e=e.filter(({viewingMode:r})=>r!==2)),e[0])}_getSupportedSpatialReferences(e){const n="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(n.length===0)return[];const r=[];for(const i of n){const s=this.getSpatialReferenceSupport(i,e);if(s!=null){const o=s.constraints??[{spatialReference:i,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||r.push({spatialReference:a,viewingMode:l})}}return r}_pickExtentCandidate(e){const n=this.spatialReference;return e.find(({extent:r})=>n.equals(r.spatialReference))||e[0]}_collectLayers(e,n,r=()=>!0){switch(this._loadMaybe(this.map?.())){case"loading":return!0;case"failed":return!1}const i=new RYe(r,n);for(const s of e)if(this._collectCollection(s,i),i.done||i.preloading===this.sourcePreloadCount)break;return i.updating}_collectCollection(e,n){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return n.updating=!0,void++n.preloading;case"failed":return}for(const r of e.layers)if((r.type!=="graphics"||!r.internal)&&n.layerFilter(r)){switch(this._loadMaybe(r)){case"failed":continue;case"loading":n.updating=!0,++n.preloading;break;case"loaded":if(n.updating||(n.done=n.pushLayer(r)),n.done||n.preloading===this.sourcePreloadCount)break;"layers"in r&&this._collectCollection({layers:r.layers},n)}if(n.done||n.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(n=>{ya(n)}),"loading"):e.loadStatus:"loaded"}};_([E()],Wr.prototype,"required",void 0),_([E({constructOnly:!0})],Wr.prototype,"map",void 0),_([E({constructOnly:!0})],Wr.prototype,"getSpatialReferenceSupport",void 0),_([E()],Wr.prototype,"defaultSpatialReference",void 0),_([E()],Wr.prototype,"userSpatialReference",void 0),_([E()],Wr.prototype,"sourcePreloadCount",void 0),_([E()],Wr.prototype,"priorityCollection",void 0),_([E()],Wr.prototype,"requiresExtentInSpatialReference",void 0),_([E()],Wr.prototype,"suspended",void 0),_([E({readOnly:!0})],Wr.prototype,"ready",null),_([E({readOnly:!0})],Wr.prototype,"heightModelInfoReady",null),_([E({readOnly:!0})],Wr.prototype,"spatialReference",null),_([E({readOnly:!0})],Wr.prototype,"extent",null),_([E({readOnly:!0})],Wr.prototype,"heightModelInfo",null),_([E({readOnly:!0})],Wr.prototype,"vcsWkid",null),_([E({readOnly:!0})],Wr.prototype,"latestVcsWkid",null),_([E({readOnly:!0})],Wr.prototype,"viewingMode",null),_([E({readOnly:!0})],Wr.prototype,"tileInfo",null),_([E({readOnly:!0})],Wr.prototype,"mapCollections",null),_([E({readOnly:!0})],Wr.prototype,"_spatialReferenceTask",null),_([E({readOnly:!0})],Wr.prototype,"_tileInfoTask",null),_([E({readOnly:!0})],Wr.prototype,"_heightModelInfoTask",null),_([E({readOnly:!0})],Wr.prototype,"_extentCandidatesTask",null),_([E()],Wr.prototype,"_extentTask",null),_([E()],Wr.prototype,"_projectExtentTask",void 0),Wr=_([ue("esri.views.support.DefaultsFromMap")],Wr);let RYe=class{constructor(e,n){this.layerFilter=e,this.pushLayer=n,this.preloading=-1,this.updating=!1,this.done=!1}};function PYe(t,e){return t!=null?e!=null?t===e&&t:t:e}function MYe(t){return"tryRecycleWith"in t}let CYe=class{constructor(e,n,r){this.layer=e,this.view=n,this.layerViewImporter=r,this._controller=new AbortController,this._started=!1,this.done=!1,this._deferred=uc(),this.promise=this._deferred.promise,lu(this._controller.signal,()=>{this._recycleController?.abort();const i=new Xe("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred?.reject(i)})}tryRecycle(e){if(!this.done||!this.layerView||!MYe(this.layerView))return null;this._recycleController?.abort(),this._recycleController=new AbortController;const n=this.layer.type,r=this._recycleController.signal;for(let i=0;i<e.length;i++){const s=e[i];if(s.type!==n)continue;const o=this.layerView.tryRecycleWith(s,{signal:r});if(o){e.splice(i,1),this.layer=s;const a=this.layerView,l=a.view;return this.promise=o.then(()=>(hi(r),s.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),s.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:n,view:r}=this;n.emit("layerview-destroy",{view:r,layerView:e}),r.emit("layerview-destroy",{layer:n,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null,this.promise=null,this._deferred=null}async start(){const{view:e}=this;if(this._started||!e.map)return;this._started=!0;const{_controller:{signal:n},layer:r}=this;this._map=e.map;try{let i,s;if(await r.load({signal:n}),r.prefetchResources&&await r.prefetchResources({signal:n}),NYe(r))i=await r.createLayerView(e,{signal:n});else{if(!this.layerViewImporter.hasLayerViewModule(r))throw new Xe("layer:view-not-supported","No layerview implementation was found");const l=await this.layerViewImporter.importLayerView(r);hi(n),i="default"in l?new l.default({layer:r,view:e}):new l({layer:r,view:e})}const o=()=>{s=Qr(s),i.destroyed||i.destroy(),this.done=!0};s=lu(n,o),hi(n);try{await i.when()}catch(l){throw o(),l}if(!this._map?.allLayers?.includes(r))return o(),void this._deferred?.reject(new Xe("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=i,r.emit("layerview-create",{view:e,layerView:i}),e.emit("layerview-create",{layer:r,layerView:i}),this.done=!0,this._deferred?.resolve(i)}catch(i){r.emit("layerview-create-error",{view:e,error:i}),e.emit("layerview-create-error",{layer:r,error:i}),this.done=!0,this._deferred?.reject(new Xe("layerview:create-error","layerview creation failed",{layer:r,error:i}))}}};function NYe(t){return t.createLayerView!==gi.prototype.createLayerView}function OYe(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let Ka=class extends Kt{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Jy,this.supportsGround=!0,this._preloadLayerViewModules=()=>{const n=this.view.map?.allLayers;if(n)for(const r of n)this.layerViewFilter?.(r)!==!1&&this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=uc(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Y2(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{if(this.destroyed)return;const{map:n}=this.view;if(!n)return void this.clear();if(this._map!==n&&(this.clear(),this._map=n),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const r=new Set,i=[],s=this.view.ready,o=u=>{if(u!=null){for(const h of u)if(h){if(this.layerViewFilter?.(h)===!1)continue;r.add(h);const f=this._layerLayerViewInfoMap.get(h);f&&s?f.start():f||this._recyclingInfoMap.has(h)||i.push(h),"layers"in h&&h.layers&&o(h.layers)}}};for(const u of this._rootCollectionNames)o(od(this,u));const a=new Array,l=u=>{const h=u.tryRecycle(i);h?(this._recyclingInfoMap.set(u.layer,u),this.notifyChange("updating"),h.then(()=>{this._recyclingInfoMap.delete(u.layer),this._layerLayerViewInfoMap.set(u.layer,u),this._reschedule(),this.notifyChange("updating")}).catch(f=>{ya(f)||(this._recyclingInfoMap.delete(u.layer),u.destroy(),this._reschedule(),this.notifyChange("updating"))})):a.push(u)};for(const u of this._layerLayerViewInfoMap.values())r.has(u.layer)||(this._layerLayerViewInfoMap.delete(u.layer),l(u));for(const u of this._recyclingInfoMap.values())r.has(u.layer)||(this._recyclingInfoMap.delete(u.layer),l(u));for(const u of i)this._createLayerView(u);this._refreshCollections(),a.forEach(u=>u.destroy());const c=[n?.ground?.layers,n?.basemap?.baseLayers,n?.basemap?.groundLayers,n?.basemap?.referenceLayers,n?.layers].filter(u=>!!u);r.forEach(u=>"layers"in u&&c.push(u.layers)),this.addHandles(c.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null},this._layersToLayerViews=new Map(e.layerviewMapping)}initialize(){this.addHandles([$1(()=>this.view?.map?.allLayers,"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),dn(()=>{const e=this.view,n=e?.map;return[n?.basemap,n?.ground,n?.layers,e?.ready]},()=>this._reschedule(),ea)]),this._preloadLayerViewModules(),this._reschedule()}clearHandles(){this._watchUpdatingTracking.removeAll()}destroy(){this.clear(),kP(this._recyclingInfoMap),kP(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Tr()),this._workPromise=null)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||GDe(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const n of this._layerLayerViewInfoMap.values())n.done||++e;return e}clear(){this.destroyed||(this._clearCollections(),kP(this._layerLayerViewInfoMap),kP(this._recyclingInfoMap))}async whenLayerView(e){await this._reschedule();const n=this._layerLayerViewInfoMap.get(e)?.promise;if(!n){const r=this._recyclingInfoMap.get(e)?.promise;if(!r)throw new Xe("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return r}return n}isCreatingLayerViewsForLayer(e,n){this.commitProperty("updatingRemaining");const r=this._layerLayerViewInfoMap.get(e);if(!r?.done)return!0;const i=r.layerView;return!(!i||!n||i.parent===n)||!!(r.done&&i&&"layers"in e&&e.layers?.length)&&e.layers.some(s=>this.isCreatingLayerViewsForLayer(s,i))}_refreshCollections(){for(const[e,n]of this._layersToLayerViews)this._populateLayerViewsOwners(od(this,e),od(this,n),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_clearCollections(){for(const e of this._layersToLayerViews.values())od(this,e)?.removeAll()}_populateLayerViewsOwners(e,n,r){if(!e||!n)return void n?.removeAll();let i=0;for(const s of e){const o=this._layerLayerViewInfoMap.get(s);if(!o?.layerView)continue;const{layerView:a}=o;a.layer=s,a.parent=r,n.at(i)!==a&&n.splice(i,0,a),"layers"in s&&OYe(a)&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),++i}i<n.length&&n.splice(i)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const n=new CYe(e,this.view,this.layerViewImporter);n.promise?.then(()=>this._refreshCollections(),r=>{r&&(ya(r)||r.name==="cancelled:layerview-create")||St.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:r}),this.destroyed||this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,n),this.view.ready&&n.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};_([E()],Ka.prototype,"_workPromise",void 0),_([E({readOnly:!0})],Ka.prototype,"_watchUpdatingTracking",void 0),_([E({readOnly:!0})],Ka.prototype,"_layersToLayerViews",void 0),_([E({constructOnly:!0})],Ka.prototype,"layerviewMapping",void 0),_([E({readOnly:!0})],Ka.prototype,"_rootCollectionNames",null),_([E({constructOnly:!0})],Ka.prototype,"layerViewFilter",void 0),_([E()],Ka.prototype,"layerViewImporter",void 0),_([E()],Ka.prototype,"supportsGround",void 0),_([E({readOnly:!0})],Ka.prototype,"updating",null),_([E({readOnly:!0})],Ka.prototype,"updatingRemaining",null),_([E({constructOnly:!0})],Ka.prototype,"view",void 0),Ka=_([ue("esri.views.support.LayerViewManager")],Ka);const LYe=Ka;let X_=class extends Kt{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};_([E()],X_.prototype,"featureTitleFields",void 0),_([E()],X_.prototype,"utilityNetworkFields",void 0),_([E()],X_.prototype,"globalIdField",void 0),X_=_([ue("esri.views.support.RequiredFieldsOptions")],X_);const DYe=X_;var Z_,bg;let Lt=(bg=class extends rO(DG){constructor(e){super(e),this._userSpatialReference=null,this.handles=new q2,this.updatingHandles=new Jy,this.allLayerViews=new Hu({getCollections:()=>this.layerviewCollections,getChildrenFunction:jYe}),this.analyses=new y2,this.basemapView=null,this.dependencies={popup:void 0},this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new mT,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Ot,this.magnifier=new t1e,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this._lowPriorityCursorHandles=new Ot,this._highPriorityCursorHandles=new Ot,this.input=new EYe,this.navigation=new PO,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new s1e(this),this.persistableViewModels=new Ot,this.requiredFieldsOptions=new DYe,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(dn(()=>this.preconditionsReady,n=>{const r=this.ready;if(n?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,Z_.views.add(this)):(this._lockedSpatialReference=null,Z_.views.remove(this)),this.notifyChange("spatialReference"),!n&&r)this.toolViewManager?.detach(),this.analysisViewManager?.detach(),this.layerViewManager?.clear(),this._teardown();else if(n&&!r){try{this._startup()}catch(i){return void queueMicrotask(()=>{this.fatalError=new Xe("view:startup-error","View._startup failed",i)})}this.analysisViewManager?.attach(),this.toolViewManager.attach()}},Dg))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this._validateWithErrorDisplay()]).then(()=>(this._isValid=!0,aB(()=>this.ready)))),this.basemapView=new RKe({view:this}),this.layerViewManager=new LYe({view:this,layerViewFilter:e=>this.layerViewFilter?.(e)??!0,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},layerviewMapping:this._layerToLayerviewMapping}),this.toolViewManager=new Uh({view:this}),this.selectionManager=new GKe({view:this}),this.addHandles([hc(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{St.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),dn(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},ea),dn(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},Dg),dn(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},ea)])}get _layerToLayerviewMapping(){return Z_._layerToLayerview}destroy(){this.destroyed||(Z_.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Ci(this.graphics),this.analyses=Ci(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.analysisViewManager=Ci(this.analysisViewManager),this.toolViewManager=Ci(this.toolViewManager),this.layerViewManager=Ci(this.layerViewManager),this.selectionManager=Ci(this.selectionManager),this.basemapView=Ci(this.basemapView),this.layerViews?.forEach(e=>e.destroy()),this.layerViews.length=0,this.invalidate(),this.handles.destroy(),this.map=Ci(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return St.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){return this.toolViewManager?.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get layerviewCollections(){return[this.basemapView?.baseLayerViews,this.basemapView?.groundLayerViews,this.layerViews,this.basemapView?.referenceLayerViews]}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Wr({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(e,n)=>this.getSpatialReferenceSupport(e,n),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??_Ye()}set highlights(e){this._set("highlights",fd(e,this._get("highlights"),Ot.ofType(yg)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){return!this.destroying&&!this.destroyed&&!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||TF(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!this.defaultsFromMap?.ready||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e?.destroyed&&(St.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),TF(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get readyState(){if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((this.defaultsFromMap?.ready??!1)&&!this.spatialReference){const e=!("loaded"in this.map)||this.map.loaded,n=this.map.ground.loaded,r=this.map.basemap?.loaded??!0;return e&&r&&n&&!this.map?.allLayers.length?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=iO(i=>Ode(ve("view-readyState-waiting-delay"),null,i)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),this._readyStateWaitingTask?.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=R1(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&this.defaultsFromMap?.required?.heightModelInfo){const n=e.clone();return n.vcsWkid=this.defaultsFromMap.vcsWkid,n.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,n}return e}set spatialReference(e){const n=!uo(e,this._get("spatialReference"));this._set("_userSpatialReference",e),n&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(e){this._userTimeExtent=e}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Ad}set timeZone(e){this._userTimeZone=e,m7e(e)||St.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){return this.toolViewManager?.tools}get initialExtent(){return this.defaultsFromMap?.extent}get cursor(){return this.toolViewManager?.cursor??this._highPriorityCursorHandles.at(-1)?.cursor??this._lowPriorityCursorHandles.at(-1)?.cursor??"default"}acquireCursor(e,n="low"){const r=n==="high"?this._highPriorityCursorHandles:this._lowPriorityCursorHandles,i={cursor:e},s=qn(()=>r.remove(i));return r.add(i),this.addHandles(s),s}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new B7}whenLayerView(e){return this.layerViewManager?.whenLayerView(e)??Promise.reject()}getDefaultSpatialReference(){return this.defaultsFromMap?.spatialReference}getDefaultHeightModelInfo(){return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??this.defaultsFromMap?.heightModelInfo??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}getSurface(){return null}importLayerView(e){throw new Xe("view:importLayerView-missing","importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport(e)!=null}when(e,n){return this.isResolved()&&!this.ready&&St.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,n)}forceReadyCycle(){this.ready&&(hc(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}on(e,n){return super.on(e,n)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}async _validateWithErrorDisplay(){try{await this.validate()}catch(e){const n=document.createElement("div");n.setAttribute("style","display: flex; flex-direction: column; gap: 8px; padding: 20px; height: 100%; justify-content: center; color: black; background: white; font-family: sans-serif;");const r=document.createElement("div");r.innerHTML="Unable to display map. WebGL2 support is required.",r.setAttribute("style","font-size: 24px; font-weight: bold;");const i=document.createElement("div");i.innerHTML="Ensure that your browser and hardware meet the minimum requirements.",i.setAttribute("style","font-size: 18px;");const s=document.createElement("a");s.innerHTML="https://esriurl.com/webgl-faq",s.target="_blank",s.setAttribute("style","font-size: 18px;"),s.href="https://esriurl.com/webgl-faq",n.appendChild(r),n.appendChild(i),n.appendChild(s);const o=this.getSurface();throw o&&o.appendChild(n),e}}},Z_=bg,bg._layerToLayerview=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.basemap.groundLayers","view.basemapView.groundLayerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"],["view.map.layers","view.layerViews"]],bg.views=new Ot,bg);_([E()],Lt.prototype,"_userSpatialReference",void 0),_([E()],Lt.prototype,"activeTool",null),_([E({readOnly:!0})],Lt.prototype,"allLayerViews",void 0),_([E({readOnly:!0})],Lt.prototype,"layerviewCollections",null),_([E(v9(y2,"analyses"))],Lt.prototype,"analyses",void 0),_([E()],Lt.prototype,"animation",null),_([E()],Lt.prototype,"basemapView",void 0),_([E()],Lt.prototype,"center",null),_([E()],Lt.prototype,"defaultsFromMapSettings",null),_([E()],Lt.prototype,"defaultsFromMap",null),_([E()],Lt.prototype,"dependencies",void 0),_([E()],Lt.prototype,"displayFilterEnabled",void 0),_([E({type:Dn})],Lt.prototype,"extent",null),_([E()],Lt.prototype,"fatalError",void 0),_([E(v9(mT,"graphics"))],Lt.prototype,"graphics",void 0),_([E({readOnly:!0,type:Qa})],Lt.prototype,"heightModelInfo",null),_([E({type:Ot.ofType(yg)})],Lt.prototype,"highlights",null),_([E({readOnly:!0})],Lt.prototype,"interacting",null),_([E({constructOnly:!0})],Lt.prototype,"layerViewFilter",void 0),_([E({readOnly:!0})],Lt.prototype,"navigating",null),_([E({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Lt.prototype,"preconditionsReady",null),_([E({readOnly:!0})],Lt.prototype,"typeSpecificPreconditionsReady",void 0),_([E({type:Ot,readOnly:!0})],Lt.prototype,"layerViews",void 0),_([E()],Lt.prototype,"resolution",null),_([E({type:t1e})],Lt.prototype,"magnifier",void 0),_([E({value:null,type:d0e})],Lt.prototype,"map",null),_([E()],Lt.prototype,"padding",void 0),_([E({readOnly:!0})],Lt.prototype,"ready",void 0),_([E()],Lt.prototype,"_readyStateWaitingTask",void 0),_([E({readOnly:!0})],Lt.prototype,"readyState",null),_([E({type:Bt})],Lt.prototype,"spatialReference",null),_([E()],Lt.prototype,"stationary",null),_([E({type:Ea})],Lt.prototype,"timeExtent",null),_([E({type:String,nonNullable:!0})],Lt.prototype,"timeZone",null),_([E()],Lt.prototype,"tools",null),_([E()],Lt.prototype,"toolViewManager",void 0),_([E({readOnly:!0})],Lt.prototype,"type",void 0),_([E({type:Number})],Lt.prototype,"scale",void 0),_([E({readOnly:!0})],Lt.prototype,"updating",void 0),_([E({readOnly:!0})],Lt.prototype,"initialExtentRequired",void 0),_([E({readOnly:!0})],Lt.prototype,"initialExtent",null),_([E()],Lt.prototype,"cursor",null),_([E({readOnly:!0})],Lt.prototype,"input",void 0),_([E({type:PO,nonNullable:!0})],Lt.prototype,"navigation",void 0),_([E()],Lt.prototype,"layerViewManager",void 0),_([E()],Lt.prototype,"analysisViewManager",void 0),_([E()],Lt.prototype,"selectionManager",void 0),_([E()],Lt.prototype,"width",void 0),_([E()],Lt.prototype,"height",void 0),_([E({readOnly:!0})],Lt.prototype,"resizing",void 0),_([E({value:null,readOnly:!0})],Lt.prototype,"size",null),_([E({readOnly:!0})],Lt.prototype,"suspended",void 0),_([E({readOnly:!0})],Lt.prototype,"viewEvents",void 0),_([E({readOnly:!0})],Lt.prototype,"persistableViewModels",void 0),_([E()],Lt.prototype,"_isValid",void 0),_([E()],Lt.prototype,"_readyCycleForced",void 0),_([E()],Lt.prototype,"_lockedSpatialReference",void 0),_([E()],Lt.prototype,"_userTimeZone",void 0),_([E()],Lt.prototype,"_lockedTimeZone",void 0),_([E()],Lt.prototype,"_userTimeExtent",void 0),_([E()],Lt.prototype,"_lockedTimeExtent",void 0),_([E({type:B7})],Lt.prototype,"theme",void 0),_([E({readOnly:!0,type:B7})],Lt.prototype,"effectiveTheme",null),Lt=Z_=_([ue("esri.views.View")],Lt);const $$=globalThis.$arcgis;$$&&!$$.views&&Object.defineProperty($$,"views",{configurable:!1,enumerable:!0,writable:!1,value:Lt.views});const $Ye=Lt;function jYe(t){return t.layerViews}function Di(){return[0,0]}function FYe(t){return[t[0],t[1]]}function xI(t,e){return[t,e]}function VYe(t,e){return[t,e]}function zYe(t,e=Di()){const n=Math.min(2,t.length);for(let r=0;r<n;++r)e[r]=t[r];return e}function v1e(){return Di()}function _1e(){return xI(1,1)}function x1e(){return xI(1,0)}function w1e(){return xI(0,1)}const UYe=v1e(),GYe=_1e(),BYe=x1e(),WYe=w1e();Object.freeze(Object.defineProperty({__proto__:null,ONES:GYe,UNIT_X:BYe,UNIT_Y:WYe,ZEROS:UYe,clone:FYe,create:Di,freeze:VYe,fromArray:zYe,fromValues:xI,ones:_1e,unitX:x1e,unitY:w1e,zeros:v1e},Symbol.toStringTag,{value:"Module"}));function HYe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function b1e(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function qYe(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function YB(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5];let l=n*s-r*i;return l?(l=1/l,t[0]=s*l,t[1]=-r*l,t[2]=-i*l,t[3]=n*l,t[4]=(i*a-s*o)*l,t[5]=(r*o-n*a)*l,t):null}function KYe(t){return t[0]*t[3]-t[1]*t[2]}function E1e(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1],h=n[2],f=n[3],g=n[4],v=n[5];return t[0]=r*c+s*u,t[1]=i*c+o*u,t[2]=r*h+s*f,t[3]=i*h+o*f,t[4]=r*g+s*v+a,t[5]=i*g+o*v+l,t}function wI(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*c,t[1]=i*u+o*c,t[2]=r*-c+s*u,t[3]=i*-c+o*u,t[4]=a,t[5]=l,t}function MO(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=r*c,t[1]=i*c,t[2]=s*u,t[3]=o*u,t[4]=a,t[5]=l,t}function _2(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=n[0],u=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=r*c+s*u+a,t[5]=i*c+o*u+l,t}function S1e(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function T1e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function XB(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function YYe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function XYe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function ZYe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function k1e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function JYe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function QYe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function eXe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function tXe(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],g=e[5],v=vl();return Math.abs(n-l)<=v*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=v*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=v*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-h)<=v*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(o-f)<=v*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-g)<=v*Math.max(1,Math.abs(a),Math.abs(g))}const nXe=E1e,rXe=k1e;Object.freeze(Object.defineProperty({__proto__:null,add:ZYe,copy:HYe,determinant:KYe,equals:tXe,exactEquals:eXe,frob:XYe,fromRotation:S1e,fromScaling:T1e,fromTranslation:XB,identity:b1e,invert:YB,mul:nXe,multiply:E1e,multiplyScalar:JYe,multiplyScalarAndAdd:QYe,rotate:wI,scale:MO,set:qYe,str:YYe,sub:rXe,subtract:k1e,translate:_2},Symbol.toStringTag,{value:"Module"}));function gd(){return[1,0,0,1,0,0]}function iXe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function sXe(t,e,n,r,i,s){return[t,e,n,r,i,s]}const oXe=gd();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:oXe,clone:iXe,create:gd,fromValues:sXe},Symbol.toStringTag,{value:"Module"}));const zP={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new xs({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Bt.WebMercator}),minus180Line:new xs({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Bt.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new xs({paths:[[[180,-180],[180,180]]],spatialReference:Bt.WGS84}),minus180Line:new xs({paths:[[[-180,-180],[-180,180]]],spatialReference:Bt.WGS84})}};function Oy(t,e){return Math.ceil((t-e)/(2*e))}function A1e(t,e){const n=yT(t);for(const r of n)for(const i of r)i[0]+=e;return t}function yT(t){return AB(t)?t.rings:t.paths}function W3t(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function aXe(t){return typeof t=="string"?ja(t):Ze(t)}function lXe(t,e,n){const r={};for(const i in t){if(i==="declaredClass")continue;const s=t[i];if(s!=null&&typeof s!="function")if(Array.isArray(s))r[i]=s.map(o=>lXe(o));else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(n?.[i]);r[i]=e?o:JSON.stringify(o)}else r[i]=e?s:JSON.stringify(s);else r[i]=s}return r}function cXe(t,e){return t?e&&EG(t)?e:bG(t)??Kr?.findCredential(t)?.token:null}async function H3t(t,e,n){const r=cXe(t,e);return r||(!Kr&&Qn.request.useIdentity&&await xe(()=>import("./IdentityManager-AGDxIlwi.js"),__vite__mapDeps([85,86])),(await Kr.getCredential(t,n))?.token)}async function uXe(t,e,n,r){const i=aXe(t),s=e[0].spatialReference,o={...r,responseType:"json",query:{...i.query,f:"json",sr:Yfe(s),target:JSON.stringify({geometryType:IB(e[0]),geometries:e}),cutter:JSON.stringify(n)}},a=await Ji(i.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map(u=>{const h=m2(u);return h.spatialReference=s,h})}}function hXe(t){return{geometryType:IB(t[0]),geometries:t.map(e=>e.toJSON())}}function dXe(t,e,n){const r=fBe(e);return t.map(i=>{const s=r.fromJSON(i);return s.spatialReference=n,s})}async function fXe(t,e,n){const r=typeof t=="string"?ja(t):t,i=e[0].spatialReference,s=IB(e[0]),o={...n,query:{...r.query,f:"json",sr:Yfe(i),geometries:JSON.stringify(hXe(e))}},{data:a}=await Ji(r.path+"/simplify",o);return dXe(a.geometries,s,i)}const I1e=()=>St.getLogger("esri.geometry.support.normalizeUtils");function pXe(t){return t.type==="polygon"}function mXe(t){return t[0].type==="polygon"}function gXe(t){return t[0].type==="polyline"}function rne(t){const e=[];let n=0,r=0;for(let i=0;i<t.length;i++){const s=t[i];let o=null;for(let a=0;a<s.length;a++)o=s[a],e.push(o),a===0?(n=o[0],r=n):(n=Math.min(n,o[0]),r=Math.max(r,o[0]));o&&e.push([(n+r)/2,0])}return e}function yXe(t,e){if(!(t instanceof xs||t instanceof yi)){const i="straightLineDensify: the input geometry is neither polyline nor polygon";throw I1e().error(i),new Xe("internal:geometry",i)}const n=yT(t),r=[];for(const i of n){const s=[];r.push(s),s.push([i[0][0],i[0][1]]);for(let o=0;o<i.length-1;o++){const a=i[o][0],l=i[o][1],c=i[o+1][0],u=i[o+1][1],h=Math.sqrt((c-a)*(c-a)+(u-l)*(u-l)),f=(u-l)/h,g=(c-a)/h,v=h/e;if(v>1){for(let A=1;A<=v-1;A++){const I=A*e,R=g*I+a,C=f*I+l;s.push([R,C])}const x=(h+Math.floor(v-1)*e)/2,b=g*x+a,T=f*x+l;s.push([b,T])}s.push([c,u])}}return pXe(t)?new yi({rings:r,spatialReference:t.spatialReference}):new xs({paths:r,spatialReference:t.spatialReference})}function ine(t,e,n){if(e){const r=yXe(t,1e6);t=YE(r,!0)}return n&&(t=A1e(t,n)),t}function sne(t,e,n){if(Array.isArray(t)){const r=t[0];if(r>e){const i=Oy(r,e);t[0]=r+i*(-2*e)}else if(r<n){const i=Oy(r,n);t[0]=r+i*(-2*n)}}else{const r=t.x;if(r>e){const i=Oy(r,e);t=t.clone().offset(i*(-2*e),0)}else if(r<n){const i=Oy(r,n);t=t.clone().offset(i*(-2*n),0)}}return t}function vXe(t,e){let n=-1;for(let r=0;r<e.cutIndexes.length;r++){const i=e.cutIndexes[r],s=e.geometries[r],o=yT(s);for(let a=0;a<o.length;a++){const l=o[a];l.some(c=>{if(c[0]<180)return!0;{let u=0;for(let f=0;f<l.length;f++){const g=l[f][0];u=g>u?g:u}u=Number(u.toFixed(9));const h=-360*Oy(u,180);for(let f=0;f<l.length;f++){const g=s.getPoint(a,f);s.setPoint(a,f,g.clone().offset(h,0))}return!0}})}if(i===n){if(mXe(t))for(const a of yT(s))t[i]=t[i].addRing(a);else if(gXe(t))for(const a of yT(s))t[i]=t[i].addPath(a)}else n=i,t[i]=s}return t}async function _Xe(t,e,n){if(!Array.isArray(t))return _Xe([t],e);e&&typeof e!="string"&&I1e().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const r=typeof e=="string"?e:e?.url??Qn.geometryServiceUrl;let i,s,o,a,l,c,u,h,f=0;const g=[],v=[];for(const R of t)if(R!=null)if(i||(i=R.spatialReference,s=La(i),o=i.isWebMercator,c=o?102100:4326,a=zP[c].maxX,l=zP[c].minX,u=zP[c].plus180Line,h=zP[c].minus180Line),s)if(R.type==="mesh")v.push(R);else if(R.type==="point")v.push(sne(R.clone(),a,l));else if(R.type==="multipoint"){const C=R.clone();C.points=C.points.map(V=>sne(V,a,l)),v.push(C)}else if(R.type==="extent"){const C=R.clone()._normalize(!1,!1,s);v.push(C.rings?new yi(C):C)}else if(R.extent){const C=R.extent,V=Oy(C.xmin,l)*(2*a);let M=V===0?R.clone():A1e(R.clone(),V);C.offset(V,0);let{xmin:N,xmax:O}=C;N=Number(N.toFixed(9)),O=Number(O.toFixed(9)),C.intersects(u)&&O!==a?(f=O>f?O:f,M=ine(M,o),g.push(M),v.push("cut")):C.intersects(h)&&N!==l?(f=O*(2*a)>f?O*(2*a):f,M=ine(M,o,360),g.push(M),v.push("cut")):v.push(M)}else v.push(R.clone());else v.push(R);else v.push(R);let x=Oy(f,a),b=-90;const T=x,A=new xs;for(;x>0;){const R=360*x-180;A.addPath([[R,b],[R,-1*b]]),b*=-1,x--}if(g.length>0&&T>0){const R=vXe(g,await uXe(r,g,A,n)),C=[],V=[];for(let O=0;O<v.length;O++){const F=v[O];if(F!=="cut")V.push(F);else{const L=R.shift(),B=t[O];B!=null&&B.type==="polygon"&&B.rings&&B.rings.length>1&&L.rings.length>=B.rings.length?(C.push(L),V.push("simplify")):V.push(o?Yy(L):L)}}if(!C.length)return V;const M=await fXe(r,C,n),N=[];for(let O=0;O<V.length;O++){const F=V[O];F!=="simplify"?N.push(F):N.push(o?Yy(M.shift()):M.shift())}return N}const I=[];for(let R=0;R<v.length;R++){const C=v[R];if(C!=="cut")I.push(C);else{const V=g.shift();I.push(o===!0?Yy(V):V)}}return I}function xXe(t){if(!t)return null;const e=t.extent;if(!e)return null;const n=t.spatialReference&&La(t.spatialReference);if(!n)return e;const[r,i]=n.valid,s=2*i,{width:o}=e;let a,{xmin:l,xmax:c}=e;if([l,c]=[c,l],t.type==="extent"||o===0||o<=i||o>s||l<r||c>i)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=rne(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=rne(t.paths);break;case"multipoint":a=t.points}const u=e.clone();for(let h=0;h<a.length;h++){let f=a[h][0];f<0?(f+=i,c=Math.max(f,c)):(f-=i,l=Math.min(f,l))}return u.xmin=l,u.xmax=c,u.width<o?(u.xmin-=i,u.xmax-=i,u):e}function ZB(t,e,n){const r=La(n);if(r==null)return t;const[i,s]=r.valid,o=2*s;let a=0,l=0;e>s?a=Math.ceil(Math.abs(e-s)/o):e<i&&(a=-Math.ceil(Math.abs(e-i)/o)),t>s?l=Math.ceil(Math.abs(t-s)/o):t<i&&(l=-Math.ceil(Math.abs(t-i)/o));let c=t+(a-l)*o;const u=c-e;return u>s?c-=o:u<i&&(c+=o),c}function q3t(t,e){return JB(e)?.normalize(t)??t}function JB(t){const e=La(t);if(e==null)return null;const[n,r]=e.valid;return new EO(n,r)}const K3t=JB(Bt.WGS84);JB(Bt.WebMercator);const R1e=96,P1e=39.37,wXe=180/Math.PI;function M1e(t){return t.wkid?t:t.spatialReference||Bt.WGS84}function QB(t,e){return e.type?to(t,e.x,e.y):Xx(t,e)}function C1e(t){return Dd(t)}function CO(t,e,n=0){let r=t.width,i=t.height;if(n!==0){const a=cI(n),l=Math.abs(Math.cos(a)),c=Math.abs(Math.sin(a));r=t.width*l+t.height*c,i=t.width*c+t.height*l}const s=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(r/s,i/o)*RXe(t.spatialReference)}async function xS(t,e,n,r){let i,s;if(!t||Array.isArray(t)&&!t.length)return null;if(Ot.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const a=t.every(u=>"attributes"in u),l=t.some(u=>!u.geometry);let c=t;if(a&&l&&e&&e.allLayerViews){const u=new Map;for(const v of t){const x=v.layer,b=u.get(x)||[],T=v.attributes[x.objectIdField];T!=null&&b.push(T),u.set(x,b)}const h=[];u.forEach((v,x)=>{const b=e.allLayerViews?.find(T=>T.layer.id===x.id);if(b&&"queryFeatures"in b){const T=x.createQuery();T.objectIds=v,T.returnGeometry=!0,h.push(b.queryFeatures(T))}});const f=await Promise.all(h),g=[];for(const v of f)if(v&&v.features&&v.features.length)for(const x of v.features)x.geometry!=null&&g.push(x.geometry);c=g}for(const u of c)r=await xS(u,e,n,r);return r}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")i=new Jt(t);else if(t instanceof Ds)i=t;else if("geometry"in t){if(t.geometry)i=t.geometry;else if(t.layer){const a=t.layer,l=e.allLayerViews?.find(c=>c.layer.id===a.id);if(l&&"queryFeatures"in l){const c=a.createQuery();c.objectIds=[t.attributes[a.objectIdField]],c.returnGeometry=!0,i=(await l.queryFeatures(c))?.features?.[0]?.geometry}}}if(i==null)return null;switch(i.type){case"point":s=new Dn({xmin:i.x,ymin:i.y,xmax:i.x,ymax:i.y,spatialReference:i.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=xXe(i);break;default:s=i.extent}if(!s)return null;_p()||hh(s.spatialReference,n)||await $g();const o=av(s,n);if(!o)return null;if(r){const a=o.center,l=a.clone();l.x=ZB(a.x,r.center.x,n),l.x!==a.x&&o.centerAt(l),r=r.union(o)}else r=o;return r}function bXe(t){if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&t.layer?.minScale!=null&&t.layer.maxScale!=null){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every(e=>"layer"in e)){let e=0,n=0;for(const r of t){const i=r.layer;i?.minScale&&i.maxScale&&(e=i.minScale<e?i.minScale:e,n=i.maxScale>n?i.maxScale:n)}return e&&n?{min:e,max:n}:null}}}function one(t,e){const n=M1e(t);return uo(n,e)||n.imageCoordinateSystem||e.imageCoordinateSystem?t:av(t,e)}async function EXe(t,e){if(!t||!e)return new tu({targetGeometry:new Jt,scale:0,rotation:0});let n=e.spatialReference;const{constraints:r,padding:i,viewpoint:s,size:o}=e,a=[i?o[0]-i.left-i.right:o[0],i?o[1]-i.top-i.bottom:o[1]];let l=null;t instanceof tu?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let c=null;l?.targetGeometry?c=l.targetGeometry:t instanceof Dn?c=t:t instanceof Ds?c=await xS(t,e,n):t&&(c=await xS(t.center,e,n)||await xS(t.target,e,n)||await xS(t,e,n)),!c&&s?.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),n||(n=M1e(e.spatialReference||e.extent||c)),_p()||uo(c.spatialReference,n)||hh(c.spatialReference,n)||await $g();const u=one(c,n),h="center"in u?u.center:u;e.pickClosestTarget!==!1&&h.type==="point"&&s.targetGeometry?.type==="point"&&(h.x=ZB(h.x,s.targetGeometry.x,h.spatialReference));let f=0;l?f=l.rotation:t.hasOwnProperty("rotation")?f=t.rotation:s&&(f=s.rotation);let g=0;g=l?.targetGeometry!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&r&&r.effectiveLODs?r.zoomToScale(t.zoom):Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0?s.scale:CO(one(c.extent,n),a,f);const v=bXe(t.target??t);v&&(v.min&&v.min<g?g=v.min:v.max&&v.max>g&&(g=v.max));let x=new tu({targetGeometry:h,scale:g,rotation:f});return r&&(x=r.fit(x),r.constrainByGeometry(x),r.rotationEnabled||(x.rotation=s.rotation)),x}function la(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function SXe(t,e,n){return n?to(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):hI(t,e,.5)}const TXe=(function(){const t=Di();return function(e,n,r){const i=n.targetGeometry;QB(t,i);const s=.5*rb(n);return e.xmin=t[0]-s*r[0],e.ymin=t[1]-s*r[1],e.xmax=t[0]+s*r[0],e.ymax=t[1]+s*r[1],e.spatialReference=i.spatialReference,e}})();function kXe(t,e,n,r,i){return Y7(t,e,n.center),t.scale=CO(n,r),i?.constraints?.constrain(t),t}function AXe(t,e,n,r){return nW(t,e,n,r),YB(t,t)}const N1e=(function(){const t=Di();return function(e,n,r){return yB(e,PXe(e,n),SXe(t,n,r))}})(),IXe=(function(){const t=gd(),e=Di();return function(n,r,i,s){const o=rb(r),a=eW(r);return to(e,o,o),T1e(t,e),wI(t,t,a),_2(t,t,N1e(e,i,s)),_2(t,t,[0,s.top-s.bottom]),to(n,t[4],t[5])}})();function rb(t){return t.scale*O1e(t.targetGeometry?.spatialReference)}function O1e(t){return rc(t)?1/(C1e(t)*P1e*R1e):1}function eW(t){return gB(t.rotation)||0}function RXe(t){return rc(t)?C1e(t)*P1e*R1e:1}function PXe(t,e){return hI(t,e,.5)}const tW=(function(){const t=Di(),e=Di(),n=Di();return function(r,i,s,o,a,l){return cge(t,i),hI(e,s,.5*l),to(n,1/o*l,-1/o*l),XB(r,e),a&&wI(r,r,a),MO(r,r,n),_2(r,r,t),r}})(),nW=(function(){const t=Di();return function(e,n,r,i){const s=rb(n),o=eW(n);return QB(t,n.targetGeometry),tW(e,t,r,s,o,i)}})(),MXe=(function(){const t=Di();return function(e,n,r,i){const s=rb(n);return QB(t,n.targetGeometry),tW(e,t,r,s,0,i)}})();function L1e(t){const e=La(t);return e?e.valid[1]-e.valid[0]:0}function CXe(t,e){return Math.round(L1e(t)/e)}const NXe=(function(){const t=Di(),e=Di(),n=[0,0,0];return function(r,i,s){Ak(t,r,i),n9(t,t),Ak(e,r,s),n9(e,e),hge(n,t,e);let o=Math.acos(uge(t,e)/(I4(t)*I4(e)))*wXe;return n[2]<0&&(o=-o),isNaN(o)&&(o=0),o}})(),OXe=(function(){const t=Di();return function(e,n,r,i){const s=e.targetGeometry;return la(e,n),IXe(t,n,r,i),s.x+=t[0],s.y+=t[1],e}})(),Y7=function(t,e,n){la(t,e);const r=t.targetGeometry;return r.x=n.x,r.y=n.y,r.spatialReference=n.spatialReference,t},LXe=(function(){const t=Di();return function(e,n,r,i,s){s||(s="center"),yB(t,r,i),hI(t,t,.5);const o=t[0],a=t[1];switch(s){case"center":to(t,0,0);break;case"left":to(t,-o,0);break;case"top":to(t,0,a);break;case"right":to(t,o,0);break;case"bottom":to(t,0,-a);break;case"top-left":to(t,-o,a);break;case"bottom-left":to(t,-o,-a);break;case"top-right":to(t,o,a);break;case"bottom-right":to(t,o,-a)}return NO(e,n,t),e}})();function Y3t(t,e,n){return la(t,e),t.rotation+=n,t}function DXe(t,e,n){return la(t,e),t.rotation=n,t}const $Xe=(function(){const t=Di();return function(e,n,r,i,s){return la(e,n),isNaN(r)||r===0||($1e(t,i,n,s),e.scale=n.scale*r,j1e(t,t,e,s),NO(e,e,to(t,t[0]-i[0],i[1]-t[1]))),e}})();function ane(t,e,n){return la(t,e),t.scale=n,t}const D1e=(function(){const t=Di();return function(e,n,r,i,s,o){return la(e,n),isNaN(r)||r===0||($1e(t,s,n,o),e.scale=n.scale*r,e.rotation+=i,j1e(t,t,e,o),NO(e,e,to(t,t[0]-s[0],s[1]-t[1]))),e}})(),X3t=(function(){const t=Di(),e=Di();return function(n,r,i,s,o,a,l){return N1e(e,a,l),sge(t,o,e),s?D1e(n,r,i,s,t,a):$Xe(n,r,i,t,a)}})(),$1e=(function(){const t=gd();return function(e,n,r,i){return Xh(e,n,AXe(t,r,i,1))}})(),j1e=(function(){const t=gd();return function(e,n,r,i){return Xh(e,n,nW(t,r,i,1))}})(),NO=(function(){const t=Di(),e=gd();return function(n,r,i){la(n,r);const s=rb(r),o=n.targetGeometry;return S1e(e,eW(r)),MO(e,e,xI(s,s)),Xh(t,i,e),o.x+=t[0],o.y+=t[1],n}})();function F1e(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function jXe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function FXe(t,e,n,r,i,s){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o[4]=i,o[5]=s,o}function V1e(t,e,n,r){const i=e[r],s=e[r+1];t[r]=n[0]*i+n[2]*s+n[4],t[r+1]=n[1]*i+n[3]*s+n[5]}function VXe(t,e,n,r=0,i=0,s=2){const o=i||e.length/s;for(let a=r;a<o;a++)V1e(t,e,n,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:jXe,create:F1e,fromValues:FXe,transform:V1e,transformMany:VXe},Symbol.toStringTag,{value:"Module"}));function NC(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function zXe(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function UXe(t,e,n,r,i,s,o,a,l){const c=new Float32Array(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=s,c[6]=o,c[7]=a,c[8]=l,c}Object.freeze(Object.defineProperty({__proto__:null,clone:zXe,create:NC,fromValues:UXe},Symbol.toStringTag,{value:"Module"}));function z1e(){return new Float32Array(2)}function GXe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function x2(t,e){const n=new Float32Array(2);return n[0]=t,n[1]=e,n}function U1e(){return z1e()}function G1e(){return x2(1,1)}function B1e(){return x2(1,0)}function W1e(){return x2(0,1)}const BXe=U1e(),WXe=G1e(),HXe=B1e(),qXe=W1e();Object.freeze(Object.defineProperty({__proto__:null,ONES:WXe,UNIT_X:HXe,UNIT_Y:qXe,ZEROS:BXe,clone:GXe,create:z1e,fromValues:x2,ones:G1e,unitX:B1e,unitY:W1e,zeros:U1e},Symbol.toStringTag,{value:"Module"}));function KXe(t){return t instanceof Float32Array&&t.length>=2}function YXe(t){return Array.isArray(t)&&t.length>=2}function j$(t){return KXe(t)||YXe(t)}var X7;const nf=[0,0];let vf=X7=class extends qt{constructor(t){super(t),this._viewpoint2D={center:Di(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Dn,this.id=0,this.inverseTransform=gd(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=gd(),this.transformNoRotation=gd(),this.displayMat3=NC(),this.displayViewMat3=NC(),this.viewMat3=NC(),this.viewMat2d=F1e(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,n=t.targetGeometry;e.center[0]=n.x,e.center[1]=n.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=n.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,n=this.viewpoint;return n&&e?(this.viewpoint=la(n,t.viewpoint),this._set("size",Xx(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new X7({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,n){return j$(e)?Xh(t,e,this.inverseTransform):(nf[0]=e,nf[1]=n,Xh(t,nf,this.inverseTransform))}toScreen(t,e,n){return j$(e)?Xh(t,e,this.transform):(nf[0]=e,nf[1]=n,Xh(t,nf,this.transform))}toScreenNoRotation(t,e,n){return j$(e)?Xh(t,e,this.transformNoRotation):(nf[0]=e,nf[1]=n,Xh(t,nf,this.transformNoRotation))}wrapMapCoordinate(t,e){Xx(t,e);const[n]=e,[r]=this.center,{extent:i,spatialReference:s}=this;let{xmin:o,xmax:a}=i;if(s.isWrappable){const l=L1e(s)/2;o=Math.max(o,r-l),a=Math.min(a,r+l)}return(n<o||n>a)&&(t[0]=ZB(n,r,s)),t}getScreenTransform(t,e){const{center:n}=this._viewpoint2D,r=this._get("pixelRatio")||1,i=this._get("size");return tW(t,n,i,e,0,r),t}_update(){const{center:t,spatialReference:e,scale:n,rotation:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,s=this._get("size"),o=new tu({targetGeometry:new Jt(t[0],t[1],e),scale:n,rotation:r});if(this._set("viewpoint",o),!s||!e||!n)return;this.resolution=rb(o),this.rotation=r,this.scale=n,this.spatialReference=e,Xx(this.center,t);const a=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;Zx(this.displayMat3,a,0,0,0,l,0,-1,1,1);const c=yge(this.viewMat3),u=x2(s[0]/2,s[1]/2),h=x2(-s[0]/2,-s[1]/2),f=gB(r);i9(c,c,u),xge(c,c,f),i9(c,c,h),Rk(this.displayViewMat3,this.displayMat3,c);const g=XB(this.viewMat2d,u);return wI(g,g,f),_2(g,g,h),TXe(this.extent,o,s),nW(this.transform,o,s,i),YB(this.inverseTransform,this.transform),MXe(this.transformNoRotation,o,s,i),this.worldScreenWidth=CXe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};_([E({readOnly:!0})],vf.prototype,"id",void 0),_([E({value:1,json:{write:!0}})],vf.prototype,"pixelRatio",null),_([E({json:{write:!0}})],vf.prototype,"size",null),_([E()],vf.prototype,"spatialReference",void 0),_([E({type:tu,json:{write:!0}})],vf.prototype,"viewpoint",null),_([E({readOnly:!0})],vf.prototype,"visibleArea",null),vf=X7=_([ue("esri.views.2d.ViewState")],vf);const lne=vf;var Z7,J7;let Of=Z7=class extends Kt{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Z7({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};_([E()],Of.prototype,"left",void 0),_([E()],Of.prototype,"top",void 0),_([E()],Of.prototype,"right",void 0),_([E()],Of.prototype,"bottom",void 0),Of=Z7=_([ue("esri.views.2d.PaddedViewState.Padding")],Of);let J_=J7=class extends lne{constructor(...t){super(...t),this.paddedViewState=new lne,this._updateContent=(()=>{const e=Di();return()=>{const n=this._get("size"),r=this._get("padding");if(!n||!r)return;const i=this.paddedViewState;to(e,r.left+r.right,r.top+r.bottom),Ak(e,n,e),Xx(i.size,e);const s=i.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(dn(()=>[this.size,this.padding],()=>this._updateContent(),Dg)),this.padding=new Of,this.size=[0,0]}set padding(t){this._set("padding",t||new Of)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const n=this._get("padding");n&&(e=OXe(t.clone(),t,this._get("size"),n));const{targetGeometry:r,rotation:i,scale:s}=e,{x:o,y:a,spatialReference:l}=r,c=this._viewpoint2D;c.center[0]=o,c.center[1]=a,c.rotation=i,c.scale=s,c.spatialReference=l,this._update()}}clone(){return new J7({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};_([E()],J_.prototype,"paddedViewState",void 0),_([E({type:Of})],J_.prototype,"padding",null),_([E()],J_.prototype,"viewpoint",null),J_=J7=_([ue("esri.views.2d.PaddedViewState")],J_);const rW=J_;let wS=class extends Kt{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};_([E()],wS.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),_([E()],wS.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),wS=_([ue("esri.views.support.debugFlags")],wS);const XXe=new wS,H1e=Symbol("Yield");let ZXe=class{constructor(){this._tasks=new Array,this._numPendingTasks=v2(0),this._readyToRun=v2(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get readyToRun(){return this._readyToRun.value}_updateReadyToRun(){this._readyToRun.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return H1e;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,n,r){return this._addTask((i,s)=>new une(i,s,e,n,r),Array.prototype.push)}unshift(e,n,r){return this._addTask((i,s)=>new une(i,s,e,n,r),Array.prototype.unshift)}pushGenerator(e,n,r){return this._addTask((i,s)=>new JXe(i,s,e,n,r),Array.prototype.push)}_process(e){if(this._tasks.length===0)return!1;const n=this._tasks.shift();this._updateReadyToRun();try{if(ha(n.signal))this._cancelTask(n,Tr());else switch(n.type){case 0:this._processSimple(n,e);break;case 1:this._processGenerator(n,e);break;case 2:this._processIterator(n,e);break;default:}}catch(r){n.reject(r)}return!0}cancelAll(){const e=Tr();for(const n of this._tasks)this._cancelTask(n,e);this._tasks.length=0,this._updateReadyToRun()}_cancelTask(e,n){if(e.abortCallback){const r=e.abortCallback(n);e.type===2&&e.iterator.return&&cne(e.iterator.return()),da(r)?r.then(e.resolve,e.reject):e.resolve(r)}else e.type===2&&e.iterator.throw&&cne(e.iterator.throw(n)),e.reject(n)}_onIteratorResult(e,n){n.done?e.resolve(n.value):(this._tasks.unshift(e),this._updateReadyToRun())}_processSimple(e,n){const r=e.callback(n);da(r)?r.then(e.resolve,e.reject):e.resolve(r)}_processGenerator(e,n){const r=e.generatorFunction(n),i=new QXe(e.resolve,e.reject,r,e.signal,e.abortCallback);this._processIterator(i,n)}_processIterator(e,n){const r=e.iterator.next(n);da(r)?r.then(i=>this._onIteratorResult(e,i),e.reject):this._onIteratorResult(e,r)}_addTask(e,n){return new Promise((r,i)=>{const s=e(r,i);n.call(this._tasks,s),++this._numPendingTasks.value,this._updateReadyToRun()}).finally(()=>--this._numPendingTasks.value)}};function cne(t){da(t)?t.then(F$,F$):F$(t)}function F$(t){ya(t)||t instanceof Error||t instanceof Xe||t!=null&&typeof t=="object"&&"done"in t&&t.done||St.getLogger("esri.layers.support.PromiseQueue").warn("Generator iterator was aborted, but it is not done.")}let iW=class{constructor(e,n,r=void 0,i=void 0){this.resolve=e,this.reject=n,this.signal=r,this.abortCallback=i}},une=class extends iW{constructor(e,n,r,i,s){super(e,n,i,s),this.callback=r,this.type=0}},JXe=class extends iW{constructor(e,n,r,i,s){super(e,n,i,s),this.generatorFunction=r,this.type=1}},QXe=class extends iW{constructor(e,n,r,i,s){super(e,n,i,s),this.iterator=r,this.type=2}};function eZe(){return new sZe}const Cn={RESOURCE_CONTROLLER_IMMEDIATE:"immediate",RESOURCE_CONTROLLER:"schedule",SLIDE:"slide",STREAM_DATA_LOADER:"stream loader",ELEVATION_QUERY:"elevation query",TERRAIN_SURFACE:"terrain",SURFACE_GEOMETRY_UPDATES:"surface geometry updates",LOD_RENDERER:"LoD renderer",GRAPHICS_CORE:"Graphics3D",I3S_CONTROLLER:"I3S",POINT_CLOUD_LAYER:"point cloud",FEATURE_TILE_FETCHER:"feature fetcher",STREAM_CONTROLLER:"stream controller",OVERLAY:"overlay",OVERLAY_RENDERER:"overlay renderer",STAGE:"stage",GRAPHICS_DECONFLICTOR:"graphics deconflictor",FILTER_VISIBILITY:"Graphics3D filter visibility",SCALE_VISIBILITY:"Graphics3D scale visibility",FRUSTUM_VISIBILITY:"Graphics3D frustum visibility",POINT_OF_INTEREST_FREQUENT:"POI frequent",POINT_OF_INTEREST_INFREQUENT:"POI infrequent",LABELER:"labeler",FEATURE_QUERY_ENGINE:"feature query",FEATURE_TILE_TREE:"feature tile tree",FEATURE_TILE_TREE_ACTIVE:"fast feature tile tree",ELEVATION_ALIGNMENT:"elevation alignment",ELEVATION_ALIGNMENT_SCENE:"elevation alignment scene",TEXT_TEXTURE_ATLAS:"text texture atlas",TEXTURE_UNLOAD:"texture unload",LINE_OF_SIGHT_TOOL:"line of sight tool",LINE_OF_SIGHT_TOOL_INTERACTIVE:"interactive line of sight tool",ELEVATION_PROFILE:"elevation profile",SNAPPING:"snapping",SHADOW_ACCUMULATOR:"shadow accumulator",CLOUDS_GENERATOR:"clouds generator",FLOW_GENERATOR:"flow generator",MAPVIEW_FETCH_QUEUE:"mapview fetch queue",MAPVIEW_LAYERVIEW_UPDATE:"mapview layerview update",MAPVIEW_VECTOR_TILE_PARSING_QUEUE:"mapview vector tile parsing queue",NONE:0,TEST_PRIO:1},Dc=0,hne=new Map([[Cn.RESOURCE_CONTROLLER_IMMEDIATE,Dc],[Cn.RESOURCE_CONTROLLER,4],[Cn.SLIDE,Dc],[Cn.STREAM_DATA_LOADER,Dc],[Cn.ELEVATION_QUERY,Dc],[Cn.TERRAIN_SURFACE,1],[Cn.SURFACE_GEOMETRY_UPDATES,1],[Cn.LOD_RENDERER,2],[Cn.GRAPHICS_CORE,2],[Cn.I3S_CONTROLLER,2],[Cn.POINT_CLOUD_LAYER,2],[Cn.FEATURE_TILE_FETCHER,2],[Cn.STREAM_CONTROLLER,2],[Cn.CLOUDS_GENERATOR,2],[Cn.OVERLAY,4],[Cn.OVERLAY_RENDERER,4],[Cn.STAGE,4],[Cn.GRAPHICS_DECONFLICTOR,4],[Cn.FILTER_VISIBILITY,4],[Cn.SCALE_VISIBILITY,4],[Cn.FRUSTUM_VISIBILITY,4],[Cn.POINT_OF_INTEREST_FREQUENT,6],[Cn.POINT_OF_INTEREST_INFREQUENT,30],[Cn.LABELER,8],[Cn.FEATURE_QUERY_ENGINE,8],[Cn.FEATURE_TILE_TREE,16],[Cn.FEATURE_TILE_TREE_ACTIVE,Dc],[Cn.ELEVATION_ALIGNMENT,12],[Cn.ELEVATION_ALIGNMENT_SCENE,14],[Cn.TEXT_TEXTURE_ATLAS,12],[Cn.TEXTURE_UNLOAD,12],[Cn.LINE_OF_SIGHT_TOOL,16],[Cn.LINE_OF_SIGHT_TOOL_INTERACTIVE,Dc],[Cn.SNAPPING,Dc],[Cn.SHADOW_ACCUMULATOR,30],[Cn.FLOW_GENERATOR,12],[Cn.MAPVIEW_FETCH_QUEUE,Dc],[Cn.MAPVIEW_LAYERVIEW_UPDATE,2],[Cn.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,Dc]]);function dne(t){return hne.has(t)?hne.get(t):typeof t=="number"?t:1}const tZe=6.5,fne=1,nZe=30,rZe=1e3/30,iZe=100,pne=.9;let sZe=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=v2(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new ZS("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new q1e,this.state=1,this._tasks=new Array,this._runQueue=new Array,this._load=0,this._forceTask=!1,this._debug=!1,this._debugHandle=dn(()=>XXe.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,fa);for(const e of Object.keys(Cn))this.performanceInfo.tasks.set(Cn[e],new ZS(String(Cn[e])))}destroy(){this._tasks.forEach(e=>e.remove()),this._tasks.length=0,this._runQueue.length=0,Qr(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(e,n){const r=new oZe(this,e,n);return this._tasks.push(r),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new ZS(e)),r}get load(){return this._load}frame(e){if(this._startFrameTaskTimes(),this._updateBudget(e)){const n=this._budget.now();return this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-n),!0}return this._recordFrameTaskTimes(0),!1}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let n=tZe,r=e.frameDuration,i=fne;switch(this.state){case 2:n=0,r=Math.max(iZe,e.frameDuration),i=nZe;break;case 1:r=Math.max(rZe,e.frameDuration)}return r=r-e.elapsedFrameTime-n,this.state!==2&&r<fne&&!this._forceTask?(this._forceTask=!0,!1):(r=Math.max(r,i),this._budget.reset(r),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0),this._budget.madeProgress()}removeTask(e){tF(this._tasks,e),tF(this._runQueue,e),this._updatingChanged()}_updateTask(e){this._tasks.forEach(n=>{n.name===e&&n.setPriority(e)})}_getState(e){if(this._runQueue.some(r=>r.name===e))return"s";let n="i";return this._tasks.forEach(r=>{r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?n="r":n!=="r"&&(n="w"))}),n}_getRuntime(e){let n=0;return this._tasks.forEach(r=>{r.name===e&&(n+=r.runtime)}),n}_resetRuntimes(){this._tasks.forEach(e=>e.runtime=0)}_getRunning(){const e=new Map;if(this._tasks.forEach(r=>{r.needsUpdate&&e.set(r.name,(e.get(r.name)||0)+1)}),e.size===0)return null;let n="";return e.forEach((r,i)=>{n+=r>1?` ${r}x ${i}`:` ${i}`}),n}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((n,r)=>r.needsUpdate?++n:n,0);this._load=this._load*pne+e*(1-pne)}_schedule(){for(eDe(this._runQueue,e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)),this._tasks.forEach(e=>{e.basePriority===Dc&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});this._runQueue.length===0;){let e=!1,n=0;if(this._tasks.forEach(r=>{r.needsUpdate&&r.schedulePriority!==0&&r.basePriority!==Dc&&r.blockFrame!==this._frameNumber&&(e=!0,n=Math.max(n,r.basePriority),r.schedulePriority===1?(r.schedulePriority=0,this._runQueue.push(r)):--r.schedulePriority)}),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const e=this._budget.now(),n=this._runQueue.pop();this._budget.resetProgress();try{n.task.runTask(this._budget)===H1e&&(n.blockFrame=this._frameNumber)}catch(i){St.getLogger("esri.views.support.Scheduler").error(`Exception in task "${n.name}"`,i),n.blockFrame=this._frameNumber}!this._budget.hasProgressed&&n.blockFrame!==this._frameNumber&&n.needsUpdate&&(n.name,n.blockFrame=this._frameNumber),n.schedulePriority=n.basePriority;const r=this._budget.now()-e;if(n.runtime+=r,this._frameTaskTimes.set(n.priority,this._frameTaskTimes.get(n.priority)+r),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(Cn))this._frameTaskTimes.set(Cn[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((n,r)=>this.performanceInfo.tasks.get(r).push(n)),this.performanceInfo.total.push(e)}get test(){return this._test}},oZe=class{get task(){return this._task.value}get readyToRun(){return this._queue.readyToRun}get updating(){return this._queue.updating}constructor(e,n,r){this._scheduler=e,this.name=n,this.blockFrame=0,this.runtime=0,this._queue=new ZXe,this._handles=new q2,this._basePriority=dne(n),this.schedulePriority=this._basePriority,this._task=v2(r??this._queue),this._handles.add(hc(()=>this.task.readyToRun,i=>e.taskRunningChanged(i)))}remove(){this.processQueue(vT),this._scheduler.removeTask(this),this.schedule=V$.schedule,this.reschedule=V$.reschedule,this.scheduleGenerator=V$.scheduleGenerator,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const n=dne(e);this._basePriority!==Dc&&this.schedulePriority===0||(this.schedulePriority=n),this._basePriority=n}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.readyToRun||!this.task.destroyed&&this.task.readyToRun}schedule(e,n,r){return this._queue.push(e,n,r)}reschedule(e,n,r){return this._queue.unshift(e,n,r)}scheduleGenerator(e,n,r){return this._queue.pushGenerator(e,n,r)}processQueue(e){return this._queue.runTask(e)}},q1e=class{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(e()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}};const vT=new q1e;vT.enabled=!1;let aZe=class{remove(){}processQueue(){}schedule(e,n,r){try{if(ha(n)){const i=Tr();return r?Promise.resolve(r(i)):Promise.reject(i)}return aF(e(vT))}catch(i){return Promise.reject(i)}}reschedule(e,n,r){return this.schedule(e,n,r)}async scheduleGenerator(e,n,r){if(ha(n)){const s=Tr();if(r)return r(s);throw s}const i=e(vT);for(;;){const s=i.next(vT),o=da(s)?await s:s;if(ha(n)){const a=Tr();if(r){const c=r(a),u=i.return(null);return da(u)&&await e4(u),c}const l=i.throw(a);throw da(l)&&await e4(l),a}if(o.done)return o.value}}};const V$=new aZe;let lZe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=eZe(),this._schedulerHandle=hc(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),this.view.animation?.target==null||da(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=n=>{if(this._updateRequested=!1,this.view?.destroyed)return;const{allLayerViews:r,graphicsView:i,labelManager:s,state:{id:o}}=this.view;r?.forEach(this._updateLayerView,this),s!=null&&(s.lastUpdateId!==o&&(s.viewChange(),s.lastUpdateId=o),s.updateRequested&&s.processUpdate(this._updateParameters)),i!=null&&(i.lastUpdateId!==o&&(i.viewChange(),i.lastUpdateId=o),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore?.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=0:this.view.interacting?this._scheduler.state=1:this._scheduler.state=2,this._scheduler.frame(n)||this._updateRequested||this._scheduler.state!==2||this._frameTaskHandle?.pause()}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new rW,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=dn(()=>e.stationary,n=>{this.stationary=n,this.requestFrame()}),this._frameTaskHandle=s2(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle?.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){if(!e.attached)return void this.requestUpdate();const n=this.view.state,r=e.lastUpdateId;r!=null&&(this.stationary||e.moving)||(e.moving=!0),r!==n.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=n.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews?.forEach(this._updateLayerView,this)}};function cZe(t,e){const{spatialReference:n}=e,r=[e.x,e.y];let i,s,o,a;const l=[0,0],c=uZe(t);for(let f=0;f<c.length;f++){const g=c[f];for(let v=0;v<g.length-1;v++){kVe(l,r,g,v);const x=_O(r,l);(i==null||x<i)&&(i=x,s=[...l],o=f,a=v)}}if(i==null||!s||o==null||a==null)throw new Xe("nearest-coordinate:failed","Failed to find the nearest coordinate");const[u,h]=s;return{coordinate:new Jt({x:u,y:h,spatialReference:n}),distance:i}}function uZe(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var Q7;let vy=Q7=class extends cB(Kt){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return av(this.geometry,this.spatialReference)}catch(t){return St.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const n=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?iI(this.normalizedGeometry,n):WG(this.normalizedGeometry,n))return t;const{coordinate:r}=cZe(this.normalizedGeometry,n);return r&&(t.targetGeometry=r),t}clone(){return new Q7({geometry:this.geometry?.clone(),spatialReference:this.spatialReference?.clone()})}};_([E({constructOnly:!0})],vy.prototype,"geometry",void 0),_([E({readOnly:!0})],vy.prototype,"normalizedGeometry",null),_([E({constructOnly:!0})],vy.prototype,"spatialReference",void 0),vy=Q7=_([ue("esri.views.2d.constraints.GeometryConstraint")],vy);var eV;let bS=eV=class extends cB(Kt){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new eV({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};_([E()],bS.prototype,"enabled",void 0),_([E()],bS.prototype,"rotationEnabled",void 0),bS=eV=_([ue("esri.views.2d.constraints.RotationConstraint")],bS);const K1e=bS;var tV;let Ya=tV=class extends cB(Kt){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:n,maxScale:r,minZoom:i,maxZoom:s}=this,o=-1,a=-1,l=!1,c=!1;if(n!==0&&r!==0&&n<r&&([n,r]=[r,n]),!e?.length)return this._set("effectiveMinScale",n),void this._set("effectiveMaxScale",r);e=e.map(u=>u.clone()),e.sort((u,h)=>h.scale-u.scale),e.forEach((u,h)=>u.level=h);for(const u of e)!l&&n>0&&n>=u.scale&&(o=u.level,l=!0),!c&&r>0&&r>=u.scale&&(a=t?t.level:-1,c=!0),t=u;i===-1&&(i=n===0?0:o),s===-1&&(s=r===0?e.length-1:a),i=Math.max(i,0),i=Math.min(i,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),i>s&&([i,s]=[s,i]),n=e[i].scale,r=e[s].scale,e.splice(0,i),e.splice(s-i+1),e.forEach((u,h)=>{this._lodByScale[u.scale]=u,this._scales[h]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",i),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",n),this._set("effectiveMaxScale",r)}constrain(t,e){if(e&&t.scale===e.scale)return t;const n=this.effectiveMinScale,r=this.effectiveMaxScale,i=t.targetGeometry,s=e&&e.targetGeometry,o=r!==0&&t.scale<r,a=n!==0&&t.scale>n;if(o||a){const l=a?n:r;if(e&&s){const c=(l-e.scale)/(t.scale-e.scale);i.x=s.x+(i.x-s.x)*c,i.y=s.y+(i.y-s.y)*c}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),n=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(n>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const n=Math.floor(t),r=Math.ceil(t);return e[n]+(t-n)*(e[r]-e[n])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let n,r;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let i=0;i<e.length-1;i++){if(n=e[i],r=e[i+1],r===t)return i+this.effectiveMinZoom+1;if(n>t&&r<t)return i+this.effectiveMinZoom+1-(t-r)/(n-r)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const n=Math.round(this.scaleToZoom(t));return this.zoomToScale(n+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const n=Math.round(this.scaleToZoom(t));return this.zoomToScale(n-1)}clone(){return new tV({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,n)=>Math.abs(n-t)<=Math.abs(e-t)?n:e,this._scales[0])),this._lodByScale[t].scale}};_([E({readOnly:!0})],Ya.prototype,"effectiveLODs",void 0),_([E({readOnly:!0})],Ya.prototype,"effectiveMinZoom",void 0),_([E({readOnly:!0})],Ya.prototype,"effectiveMaxZoom",void 0),_([E({readOnly:!0})],Ya.prototype,"effectiveMinScale",void 0),_([E({readOnly:!0})],Ya.prototype,"effectiveMaxScale",void 0),_([E()],Ya.prototype,"lods",void 0),_([E()],Ya.prototype,"minZoom",void 0),_([E()],Ya.prototype,"maxZoom",void 0),_([E()],Ya.prototype,"minScale",void 0),_([E()],Ya.prototype,"maxScale",void 0),_([E()],Ya.prototype,"snapToZoom",void 0),Ya=tV=_([ue("esri.views.2d.constraints.ZoomConstraint")],Ya);const Y1e=Ya,hZe={base:null,key:"type",typeMap:{extent:Dn,polygon:yi}};let Vi=class extends Kt{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Ot}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){return`${this._zoom?.uid}/${this._rotation?.uid}/${this._geometry?.uid}`}get _geometry(){const e=this._get("_geometry");return e&&this.geometry===e.geometry&&this.view?.constraintsInfo.spatialReference===e.spatialReference?e:new vy({geometry:this.geometry,spatialReference:this.view?.constraintsInfo.spatialReference})}get _rotation(){return new K1e({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),n=this.lods||this.view?.constraintsInfo.lods,r=this.minZoom,i=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===n&&e.minZoom===r&&e.maxZoom===i&&e.minScale===s&&e.maxScale===o&&e.snapToZoom===a?e:new Y1e({lods:n,minZoom:r,maxZoom:i,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(e){const n=this.effectiveMaxScale;return n===0||e>=n}canZoomOutTo(e){const n=this.effectiveMinScale;return n===0||e<=n}constrain(e,n){return this._zoom.constrain(e,n),this._rotation.constrain(e,n),this._geometry.constrain(e,n),this.customConstraints.forEach(r=>r.constrain(e,n)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(n=>n.applyPanConstraint?.(e)),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};_([E({readOnly:!0})],Vi.prototype,"effectiveLODs",null),_([E({readOnly:!0})],Vi.prototype,"effectiveMinScale",null),_([E({readOnly:!0})],Vi.prototype,"effectiveMaxScale",null),_([E({readOnly:!0})],Vi.prototype,"effectiveMinZoom",null),_([E({readOnly:!0})],Vi.prototype,"effectiveMaxZoom",null),_([E({types:hZe,value:null})],Vi.prototype,"geometry",null),_([E({type:[So]})],Vi.prototype,"lods",void 0),_([E()],Vi.prototype,"minScale",void 0),_([E()],Vi.prototype,"maxScale",void 0),_([E()],Vi.prototype,"minZoom",void 0),_([E()],Vi.prototype,"maxZoom",void 0),_([E()],Vi.prototype,"rotationEnabled",void 0),_([E()],Vi.prototype,"snapToZoom",void 0),_([E({type:Ot})],Vi.prototype,"customConstraints",void 0),_([E()],Vi.prototype,"view",void 0),_([E({readOnly:!0})],Vi.prototype,"version",null),_([E({type:vy,readOnly:!0})],Vi.prototype,"_geometry",null),_([E({type:K1e})],Vi.prototype,"_rotation",null),_([E({readOnly:!0,type:Y1e})],Vi.prototype,"_zoom",null),Vi=_([ue("esri.views.2d.MapViewConstraints")],Vi);const mne=Vi;let Ho=class extends Kt{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([dn(()=>this.constraints?.version,n=>{this.constraints&&n&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},Dg)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:n}=this.state.paddedViewState;return this.state.commitProperty("id"),new Jt({x:e[0],y:e[1],spatialReference:n})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let n;try{n=this._project(e,this.state.spatialReference)}catch(i){return void St.getLogger(this).error(new Xe("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:i}))}const r=this.viewpoint;Y7(r,r,n),this.viewpoint=r}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void St.getLogger(this).error(new Xe("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let n;try{n=this._project(e,this.state.spatialReference)}catch(i){return void St.getLogger(this).error(new Xe("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:i}))}const r=this.viewpoint;kXe(r,r,n,this.state.size,{constraints:this.constraints}),this.viewpoint=r}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const n=this.viewpoint;DXe(n,n,e),this.viewpoint=n}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const r=this._get("extent");return void(r&&(this._set("extent",void 0),this._set("center",r.center)))}const n=this.viewpoint;ane(n,n,e),this.viewpoint=n}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let n,r;try{n=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?r=new Xe("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(r=new Xe("mapview:invalid-viewpoint","geometry not defined"))}catch(s){r=new Xe("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(r)return void St.getLogger(this).error(r);this._scaleBeforeChangingSpatialReference=null;const i=new tu({targetGeometry:new Jt,scale:0,rotation:0});la(i,n),this.constraints?.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this._set("viewpoint",i)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){return this.ready?this.constraints?.scaleToZoom(this.scale)??-1:this._get("zoom")}set zoom(e){if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const n=this.constraints?.zoomToScale(e)??0;if(!n)return void this._set("zoom",-1);const r=this.viewpoint;ane(r,r,n),this.viewpoint=r,this._set("zoom",this.constraints?.scaleToZoom(this.scale)??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:n,constraints:r}=this,i=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),c=this._get("zoom"),u=c!=null&&r!=null&&r.zoomToScale(c)||void 0;let h,f,g;const v=l?.rotation,x=l?.targetGeometry;x?.type==="extent"?h=x:x?.type==="point"&&(f=x,g=l?.scale);const b=s??h;return{center:i??f??b?.center,rotation:a??v,scale:(o??u??g??(b&&CO(b,[e[0]-n.left-n.right,e[1]-n.top-n.bottom])))||void 0}}startup(e,n,r,i){const s=e.targetGeometry;try{this._project(e,r)}catch(o){St.getLogger(this).warn(new Td("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:r,error:o})),e.targetGeometry=i||new Jt({x:0,y:0,spatialReference:r})}this.constraints?.fit(e),this._set("state",new rW({padding:this.padding,size:n,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,n],spatialReference:r,rotation:i,scale:s}=this.state.paddedViewState,o=new Jt({x:e,y:n,spatialReference:r});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",i),this._set("scale",s),this._set("state",null)}changeSpatialReference(e){const n=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=n.scale;else{const l=n.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,n.viewpoint=l}const r=n.clone(),[i,s]=n.center;let o=null;try{o=this._project(new Jt({x:i,y:s,spatialReference:n.spatialReference}),e)}catch(l){Vfe()||St.getLogger(this).warn(new Td("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o?.toJSON(),spatialReference:e,error:l}))}o||(o=new Jt({x:0,y:0,spatialReference:e}));const a=Y7(new tu({targetGeometry:new Jt,scale:0,rotation:0}),n.viewpoint,o);r.viewpoint=a;try{const c=[n.size[0]/2,n.size[1]/2],u=[c[0]+20,c[1]],h=n.toMap([0,0],u),{x:f,y:g}=this._project(new Jt({x:h[0],y:h[1],spatialReference:n.spatialReference}),e);h[0]=f,h[1]=g,r.toScreen(h,h);const v=NXe(c,h,u),x=Math.hypot(h[0]-c[0],h[1]-c[1])/20;!Number.isFinite(x)||Math.abs(x)>4?(a.rotation=0,a.targetGeometry=new Jt({x:0,y:0,spatialReference:e})):(a.scale*=x,a.scale>ve("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(v)?v:0)}catch{}this._get("constraints")?.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,n){if(!this.ready)return;const r=this.state;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.slice();r.size=[e,n],LXe(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints?.constrain(i,void 0)??i,this.state.viewpoint=i}toMap(e){if(!this.ready)return null;const n=[0,0],[r,i]=this.state.toMap(n,[e.x,e.y]),s=this.state.spatialReference;return new Jt({x:r,y:i,spatialReference:s})}toScreen(e,n){if(!this.ready)return null;const r=this._project(e,this.state.spatialReference),i=[r.x,r.y];return n?.pickClosestTarget===!1||this.state.paddedViewState.wrapMapCoordinate(i,i),this.state.toScreen(i,i),Fs(i[0],i[1])}_project(e,n){const r=e?.targetGeometry||e;if(!n)return e;if(!r)return null;if(n.imageCoordinateSystem||r.spatialReference?.imageCoordinateSystem||uo(n,r.spatialReference))return e;const i=av(r,n);if(!i)throw new Xe("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:r,spatialReference:n});return dZe(e)?(e.targetGeometry=i,e):i}};function dZe(t){return t?.declaredClass==="esri.Viewpoint"}_([E({type:Jt})],Ho.prototype,"center",null),_([E()],Ho.prototype,"constraints",void 0),_([E({type:Dn})],Ho.prototype,"extent",null),_([E({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],Ho.prototype,"padding",null),_([E()],Ho.prototype,"ready",void 0),_([E()],Ho.prototype,"resizeAlign",void 0),_([E({readOnly:!0})],Ho.prototype,"resolution",null),_([E({type:Number})],Ho.prototype,"rotation",null),_([E({type:Number})],Ho.prototype,"scale",null),_([E({readOnly:!0})],Ho.prototype,"state",void 0),_([E({type:tu})],Ho.prototype,"viewpoint",null),_([E({readOnly:!0})],Ho.prototype,"visibleArea",null),_([E()],Ho.prototype,"zoom",null),Ho=_([ue("esri.views.2d.ViewStateManager")],Ho);const gne=160;let ES=class extends Kt{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=gne&&this.clear()},gne))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};_([E()],ES.prototype,"_timer",void 0),_([E()],ES.prototype,"stationary",null),ES=_([ue("esri.views.2d.support.StationaryManager")],ES);const fZe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.fullOpacity=1,this.stateManager=new Ho({constraints:new mne({view:this})}),this.stationaryManager=new ES,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new lZe(this),this.viewEvents=new s1e(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([dn(()=>this.viewpoint,()=>this.stationaryManager.flip(),Dg)])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){return this.stateManager?.extent??null}set extent(r){this.stateManager.extent=r}get state(){return this.stateManager.state}get interacting(){return!1}get stationary(){return!this.animation&&this.stationaryManager.stationary}set animation(r){const i=this._get("animation");if(r===i)return;if(i&&i.stop(),r!==this.animationManager.animation&&this.animationManager.stop(),!r||r.isFulfilled())return void this._set("animation",null);this._set("animation",r);const s=()=>{this.destroyed||r===this._get("animation")&&(this._set("animation",null),this.frameTask?.requestFrame())};r.when(s,s)}get constraints(){return this.stateManager?.constraints}set constraints(r){r.view=this;const i=this.stateManager.constraints;this.stateManager.constraints=r,i?.destroy()}get padding(){return this.stateManager?.padding}set padding(r){this.stateManager&&(this.stateManager.padding=r)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(r){this.stateManager.resizeAlign=r}get rotation(){return this.stateManager.rotation??0}set rotation(r){const{rotationEnabled:i}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=r,this.constraints.rotationEnabled=i}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(r){this.stateManager.viewpoint=r,this.frameTask.requestFrame()}};return _([E({readOnly:!0})],n.prototype,"animationManager",void 0),_([E({readOnly:!0})],n.prototype,"fullOpacity",void 0),_([E()],n.prototype,"stateManager",void 0),_([E()],n.prototype,"constraintsInfo",null),_([E()],n.prototype,"extent",null),_([E({readOnly:!0})],n.prototype,"state",null),_([E({readOnly:!0})],n.prototype,"mapViewNavigation",void 0),_([E()],n.prototype,"renderingOptions",void 0),_([E({readOnly:!0})],n.prototype,"interacting",null),_([E()],n.prototype,"stationary",null),_([E()],n.prototype,"animation",null),_([E({type:mne})],n.prototype,"constraints",null),_([E()],n.prototype,"padding",null),_([E()],n.prototype,"resizeAlign",null),_([E()],n.prototype,"rotation",null),_([E({readOnly:!0})],n.prototype,"viewEvents",void 0),_([E({type:tu})],n.prototype,"viewpoint",null),n=_([ue("esri.views.Viewport2DBaseMixin")],n),n},pZe=()=>Qn.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;var Mw;let Q_=(Mw=class extends DG{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=uc(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),this._resolver?.reject(new Xe("view:animation-stopped","ViewAnimation stopped")))}finish(){this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),this._resolver?.resolve())}update(e,n){n||(n=da(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",n)}},Mw.state={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"},Mw);_([E({readOnly:!0})],Q_.prototype,"done",null),_([E({readOnly:!0,type:String})],Q_.prototype,"state",void 0),_([E()],Q_.prototype,"target",void 0),Q_=_([ue("esri.views.ViewAnimation")],Q_);const nV=Q_;let OC=class extends Kt{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,n){if(!e)return void St.getLogger(this).error("#goTo()","target cannot be null or undefined");const r=new nV;this.view.animation=r,await aB(()=>this.view.ready,n);const i={...n,animate:n?.animate??(!pZe()&&this.view.animationsEnabled),animationMode:n?.animationMode??"auto"},{extent:s,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:u,allLayerViews:h}=this.view,f=EXe(e,{extent:s,spatialReference:o,size:a,viewpoint:l,constraints:c,padding:u,allLayerViews:h,pickClosestTarget:n?.pickClosestTarget??!0});return r?.update(f),this._gotoTask={},i.animate?this._gotoAnimated(f,i):this._gotoImmediate(f,i)}_gotoImmediate(e,n){const r=this._gotoTask,i=this.view.animation,s=e.then(o=>{if(hi(n),r!==this._gotoTask)throw new Xe("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=i.target=o,i.finish()});return this._cancellableGoTo(r,i,s,n)}_gotoAnimated(e,n){const r=this._gotoTask,i=this.view.animation;if(!i)return Promise.resolve();const s=e.then(o=>{if(hi(n),r!==this._gotoTask)throw new Xe("view:goto-interrupted","Goto was interrupted");return i.update(o),this.view.animationManager.animate(i,this.view.viewpoint,n),i.when().then(()=>{},()=>{})});return this._cancellableGoTo(r,i,s,n)}_cancellableGoTo(e,n,r,i){const s=()=>e===this._gotoTask;return ZDe(r,i).finally(()=>{s()&&(n.done||n.stop())})}};_([E({constructOnly:!0})],OC.prototype,"view",void 0),OC=_([ue("esri.views.2d.GoToManager")],OC);function X1e(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function Z1e(t,e){return e.some(n=>X1e(t,n))}function yne(t,{dragPrimary:e,dragSecondary:n,dragTertiary:r}){return[{key:"primary",value:e},{key:"secondary",value:n},{key:"tertiary",value:r}].filter(i=>i.value===t).map(i=>i.key)}let vne=class extends Ws{constructor(e,n){super(!0),this._view=e,this.registerIncoming("double-click",n,r=>this._handleDoubleClick(r,n))}_handleDoubleClick(e,n){X1e(e.data,"primary")&&(e.stopPropagation(),n?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},mZe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.pointerType=n,this.registerIncoming("double-tap-drag",r,i=>this._handleDoubleTapDrag(i))}_handleDoubleTapDrag(e){const{data:n}=e,{pointerType:r}=n;if(r!==this.pointerType)return;e.stopPropagation();const{action:i,delta:s}=n,{view:o}=this,{mapViewNavigation:a}=o;switch(i){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;a.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=o,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void a.end();const h=l.snapScale(this._currentScale),f=(s.y>0?Math.max(h,l.snapToPreviousScale(this._startScale)):Math.min(h,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(f).then(()=>{a.end()});break}}}},OO=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const n=e.data,r=n.pointers.size;switch(n.action){case"start":this._currentCount=r,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=r,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){this._startEvent=e,this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){this._callbacks.condition?.(this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},gZe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.pointerActions=n,this.registerIncoming("drag",r,i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new OO({start:(n,r)=>{this.view.mapViewNavigation.pan.begin(this.view,r.data),r.stopPropagation()},update:(n,r)=>{this.view.mapViewNavigation.pan.update(this.view,r.data),r.stopPropagation()},end:(n,r)=>{this.view.mapViewNavigation.pan.end(this.view,r.data),r.stopPropagation()},condition:(n,r)=>n===1&&Z1e(r.data,this.pointerActions)})}_handleDrag(e){const n=this.view.mapViewNavigation;n.pinch.zoomMomentum||n.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},yZe=class extends Ws{constructor(e,n,r){super(!0),this._view=e,this.pointerActions=n;const i=this._view.mapViewNavigation;this._dragEventSeparator=new OO({start:(s,o)=>{i.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{i.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{i.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&Z1e(o.data,this.pointerActions)}),this.registerIncoming("drag",r,s=>this._dragEventSeparator.handle(s))}};function J1e(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function vZe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function _Ze(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function xZe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Q1e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function eve(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function tve(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function wZe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function bZe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function EZe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function SZe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function TZe(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function kZe(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function AZe(t,e=0,n=1){return t[0]=Math.min(Math.max(t[0],e),n),t[1]=Math.min(Math.max(t[1],e),n),t[2]=Math.min(Math.max(t[2],e),n),t}function IZe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function nve(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function RZe(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function rve(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function ive(t,e){const n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function sve(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function PZe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function MZe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function rV(t,e){const n=e[0],r=e[1],i=e[2];let s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function ove(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function CZe(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function NZe(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2],c=i*l-s*a,u=s*o-r*l,h=r*a-i*o,f=Math.sqrt(c*c+u*u+h*h);return t[0]=c/f,t[1]=u/f,t[2]=h/f,t}function OZe(t,e,n,r){const i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function LZe(t,e,n,r,i,s){const o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return t[0]=e[0]*a+n[0]*l+r[0]*c+i[0]*u,t[1]=e[1]*a+n[1]*l+r[1]*c+i[1]*u,t[2]=e[2]*a+n[2]*l+r[2]*c+i[2]*u,t}function DZe(t,e,n,r,i,s){const o=1-s,a=o*o,l=s*s,c=a*o,u=3*s*a,h=3*l*o,f=l*s;return t[0]=e[0]*c+n[0]*u+r[0]*h+i[0]*f,t[1]=e[1]*c+n[1]*u+r[1]*h+i[1]*f,t[2]=e[2]*c+n[2]*u+r[2]*h+i[2]*f,t}function $Ze(t,e=1){const n=mB,r=2*n()*Math.PI,i=2*n()-1,s=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*s,t[1]=Math.sin(r)*s,t[2]=i*e,t}function jZe(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12],t[1]=n[1]*r+n[5]*i+n[9]*s+n[13],t[2]=n[2]*r+n[6]*i+n[10]*s+n[14],t}function FZe(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function VZe(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2],u=i*c-s*l,h=s*a-r*c,f=r*l-i*a,g=i*f-s*h,v=s*u-r*f,x=r*h-i*u,b=2*o;return t[0]=a+u*b+2*g,t[1]=l+h*b+2*v,t[2]=c+f*b+2*x,t}function zZe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function UZe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function GZe(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function BZe(t,e){rV(_ne,t),rV(xne,e);const n=ove(_ne,xne);return n>1?0:n<-1?Math.PI:Math.acos(n)}const _ne=Zg(),xne=Zg();function WZe(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function HZe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function qZe(t,e){if(t===e)return!0;const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=vl();return Math.abs(n-s)<=l*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=l*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=l*Math.max(1,Math.abs(i),Math.abs(a))}function KZe(t,e,n){const r=n[0]-e[0],i=n[1]-e[1],s=n[2]-e[2];let o=r*r+i*i+s*s;return o>0?(o=1/Math.sqrt(o),t[0]=r*o,t[1]=i*o,t[2]=s*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const YZe=Q1e,XZe=eve,ZZe=tve,JZe=rve,QZe=ive,eJe=J1e,tJe=sve;Object.freeze(Object.defineProperty({__proto__:null,abs:EZe,add:xZe,angle:BZe,bezier:DZe,ceil:wZe,clamp:AZe,copy:vZe,cross:CZe,crossAndNormalize:NZe,direction:KZe,dist:JZe,distance:rve,div:ZZe,divide:tve,dot:ove,equals:qZe,exactEquals:HZe,floor:bZe,hermite:LZe,inverse:MZe,len:eJe,length:J1e,lerp:OZe,max:kZe,min:TZe,mul:XZe,multiply:eve,negate:PZe,normalize:rV,random:$Ze,rotateX:zZe,rotateY:UZe,rotateZ:GZe,round:IZe,scale:nve,scaleAndAdd:RZe,set:_Ze,sign:SZe,sqrDist:QZe,sqrLen:tJe,squaredDistance:ive,squaredLength:sve,str:WZe,sub:YZe,subtract:Q1e,transformMat3:FZe,transformMat4:jZe,transformQuat:VZe},Symbol.toStringTag,{value:"Module"}));function Pu(t){let e=t*t;return t<0&&(e*=-1),e}function nJe(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function rJe(t,e,n){const r=n,i=t.state,s=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(r.translation[0]=Pu(i.axes[0]),r.translation[1]=Pu(i.axes[1]),r.translation[2]=Pu(i.buttons[7])-Pu(i.buttons[6]),r.heading=Pu(i.axes[2]),r.tilt=Pu(i.axes[3])):s.deviceType==="spacemouse"&&(r.translation[0]=1.2*Pu(i.axes[0]),r.translation[1]=1.2*Pu(i.axes[1]),r.translation[2]=2*-Pu(i.axes[2]),r.heading=1.2*Pu(i.axes[5]),r.tilt=1.2*Pu(i.axes[3])),r.tilt*=o,nve(r.translation,r.translation,a),r}function iJe(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let sJe=class extends Ws{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new q2,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",n=>this._handleGamePadEvent(n)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([dn(()=>this._view.navigation.gamepad?.enabled,n=>{n?(this._handle.resume(),this._frameTask||(this._frameTask=s2({update:r=>this._frameUpdate(r.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},fa)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const n=this._view.navigation.gamepad.device;n&&e.data.device!==n||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,nJe(this._transformation)):(this._currentDevice=e.data.device,rJe(e.data,this._view.navigation.gamepad,this._transformation)),this._frameTask?.resume())}_frameUpdate(e){const n=this._transformation;if(iJe(n))return void this._frameTask?.pause();const r=this._view.viewpoint.clone(),i=this._view.navigation.gamepad.velocityFactor,s=aJe*i*e;NO(r,r,[n.translation[0]*s,-n.translation[1]*s]);const o=1+n.translation[2]*lJe*e,a=this._view.constraints.rotationEnabled?-n.heading*oJe*e:0,l=this._view.size,c=[l[0]/2,l[1]];D1e(r,r,o,a,c,l);const u=this._view.constraints.constrain(r,this._view.viewpoint);this._view.viewpoint=u}};const oJe=.06,aJe=.7,lJe=6e-4;function ave(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),qn(()=>document.removeEventListener("visibilitychange",e))}let cJe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=i=>{const s=this._keyMap[i.data.key];if(i.modifiers.has("Meta")||i.modifiers.has("Control"))return void this._stopMovement();if(s==null)return;i.stopPropagation(),i.preventDefault();const o=i.type==="key-down";if(this._pressedKeys[o?"add":"delete"](s),o){if(this._direction===s)return;this._direction=s,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[n.left]:"left",[n.right]:"right",[n.up]:"up",[n.down]:"down"},this.registerIncoming("key-down",r,this._handleKey),this.registerIncoming("key-up",r,this._handleKey),this.registerIncoming("blur",r,this._stopMovement),this._visibilityHandle=ave(i=>i?null:this._stopMovement())}onUninstall(){this._stopMovement(),this._visibilityHandle?.remove()}get _direction(){return this._currentDirection}set _direction(e){const n=this._currentDirection!=null;if(e!=null){if(n||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else n&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},uJe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(n),this.registerIncoming("key-down",r,i=>this._handleKeyDown(i)),this.registerIncoming("key-up",r,i=>this._handleKeyUp(i)),this.registerIncoming("blur",r,()=>this._handleStop()),this._visibilityHandle=ave(i=>i?null:this._handleStop())}onUninstall(){this._visibilityHandle?.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,n){for(const r of e)this._keyToDirection.set(r,n)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,n){const r=e.modifiers;if(r.size>0&&!r.has("Shift")||!this.view.constraints.rotationEnabled)return;const i=this._keyToDirection.get(e.data.key);if(this._pressed=i!=null,this._pressed){if(e.preventDefault(),n)switch(this.view.mapViewNavigation.begin(),i){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},hJe=class extends Ws{constructor(e,n,r){super(!0),this.view=e,this.keys=n,this._keysToZoomAction={},this.registerIncoming("key-down",r,i=>this._handleKeyDown(i)),n.zoomIn.forEach(i=>this._keysToZoomAction[i]=0),n.zoomOut.forEach(i=>this._keysToZoomAction[i]=1)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const n=e.modifiers;if(n.size>0&&!n.has("Shift"))return;const{key:r}=e.data;if(!(r in this._keysToZoomAction))return;const i=this._keysToZoomAction[r],{mapViewNavigation:s}=this.view;let o=null;switch(i){case 0:o=s.zoomIn();break;case 1:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),e.stopPropagation()}};const dJe=.6;let fJe=class extends Ws{constructor(e,n){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",n,r=>this._handleMouseWheel(r))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const n=this._view.mapViewNavigation,{x:r,y:i,deltaY:s}=e.data,o=1/dJe**(1/60*s),a=n.zoom(o,[r,i]);this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,n.end()})}},pJe=class extends Ws{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const n=this.view.mapViewNavigation;this._dragEventSeparator=new OO({start:(r,i)=>{n.pinch.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{n.pinch.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{n.pinch.end(this.view),i.stopPropagation()},condition:r=>r>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function wne(t){const e=t.native;return e?{buttons:e.buttons.map(n=>n.pressed?n.value||1:0),axes:e.axes.map(n=>yJe(n,t.axisThreshold))}:{buttons:[],axes:[]}}function mJe(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let n=0;n<t.axes.length;n++)if(t.axes[n]!==e.axes[n])return!1;for(let n=0;n<t.buttons.length;n++)if(t.buttons[n]!==e.buttons[n])return!1;return!0}function gJe(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function yJe(t,e){const n=Math.abs(t);return n<e?0:Math.sign(t)*(n-e)/(1-e)}let vJe=class{constructor(e,n){this._element=e,this._input=n,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,wne(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const r="getGamepads"in window.navigator,i=window.isSecureContext;this.supported=r&&i,this.supported&&(bne(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const n=new qB(e);n.deviceType!=="unknown"&&(this._inputDevices[e.index]=n,this._input.gamepad.devices.add(n)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=s2({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),n=this._element.contains(document.activeElement),r=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!n;bne(i=>{const s=this._inputDevices[i.index];if(!s)return;const o=this._latestUpdate[i.index],a=wne(s),l=r||gJe(a);o&&(o.timestamp===i.timestamp||!o.active&&l||mJe(o.state,a))||this._emitGamepadEvent(i,a,!l)})}_emitGamepadEvent(e,n,r){const i=this._latestUpdate[e.index],s=i&&i.active;if(!s&&!r)return;const o=!s&&r?"start":s&&r?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:n,active:r},this._callback&&this._callback({device:this._inputDevices[e.index],state:n,action:o})}};function _Je(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function bne(t){for(const e of navigator.getGamepads())_Je(e)&&t(e)}const Ene=ve("edge"),xJe=ve("chrome"),wJe=ve("ff"),bJe=ve("safari"),Sne="esri-view-surface",v_={touchNone:`${Sne}--touch-none`,touchPan:`${Sne}--touch-pan`};var o1;let EJe=(o1=class{constructor(e,n){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new vJe(e,n),this._gamepadSource.onEvent=r=>this._callback("gamepad",r)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=Ci(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const n in this._active)if(!e||!e.has(n)){const r=this._active[n];this._element.removeEventListener(z$[n],r),delete this._active[n]}e&&e.forEach(n=>{if(!this._active[n]&&z$[n]){const r=(this._eventHandlers[n]||this._handleDefault).bind(this,n);this._element.addEventListener(z$[n],r),this._active[n]=r}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=e?.has("gamepad")??!1)}setPointerCapture(e,n){n?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?v_.touchNone:v_.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?v_.touchPan:v_.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(v_.touchNone),this._element.classList.remove(v_.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,n){const r=a1e(this._element,e);return o1.test.disableSubpixelCoordinates&&(r.x=Math.round(r.x),r.y=Math.round(r.y)),n.x=r.x,n.y=r.y,n}_handleKey(e,n){const{key:r}=n;r&&e==="key-up"&&this._keyDownState.delete(r);const i={native:n,key:r,repeat:!!r&&this._keyDownState.has(r)};r&&e==="key-down"&&this._keyDownState.add(i.key),this._callback(e,i)}_handlePointer(e,n){const r=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,pointerType:n.pointerType,button:n.button,buttons:n.buttons,eventId:this._eventId++});this._callback(e,r)}_handlePointerPreventDefault(e,n){const r=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,pointerType:n.pointerType,button:n.button,buttons:n.buttons,eventId:this._eventId++});n.preventDefault(),this._callback(e,r)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&ve("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,n){let r=this._getDeltaFromTrackpadOrMouseWheel(n);switch(n.deltaMode){case 0:Ene&&(r=r/document.documentElement.clientHeight*600);break;case 1:r*=30;break;case 2:r*=900}Ene?r*=.7:xJe||bJe?r*=.6:wJe&&(r*=1.375);const i=100,s=Math.abs(r);s>i&&(r=r/s*200/(1+Math.exp(-.02*(s-i))));const o=this._updateNormalizedPointerLikeEvent(n,{native:n,x:0,y:0,deltaY:r});this._callback(e,o)}_handlePointerCaptureLost(e,n){this._activePointerCaptures.delete(n.pointerId),this._handleDefault(e,n)}_handleDefault(e,n){const r={native:n};n.preventDefault(),this._callback(e,r)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}},o1.test={disableSubpixelCoordinates:!1},o1);const z$={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let SJe=class extends Ws{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const lve=()=>({maximumClickDelay:300}),TJe=(t={})=>({...lve(),movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,...t}),sW=(t={})=>({...lve(),maximumDoubleClickDistance:10,maximumDoubleTouchDistance:35,maximumDoubleClickDelay:250,maximumDoubleTouchDelay:350,...t});function D4(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function kJe(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function AJe(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Fs()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[I,R]=t,[C,V]=[R.x-I.x,R.y-I.y];return e.radius=Math.sqrt(C*C+V*V)/2,e.center.x=(I.x+R.x)/2,e.center.y=(I.y+R.y)/2,e}let n=0,r=0;for(let I=0;I<t.length;I++)n+=t[I].x,r+=t[I].y;n/=t.length,r/=t.length;const i=t.map(I=>I.x-n),s=t.map(I=>I.y-r);let o=0,a=0,l=0,c=0,u=0,h=0,f=0;for(let I=0;I<i.length;I++){const R=i[I],C=s[I],V=R*R,M=C*C;o+=V,a+=M,l+=R*C,c+=V*R,u+=M*C,h+=R*M,f+=C*V}const g=.5*(c+h),v=.5*(u+f),x=o*a-l*l,b=(g*a-v*l)/x,T=(o*v-l*g)/x,A=Fs(b+n,T+r);return{radius:Math.sqrt(b*b+T*T+(o+a)/t.length),center:A}}function e1(t){const{native:e}=t,{pointerId:n,button:r,pointerType:i}=e;return i==="mouse"?`${n}:${r}`:`${i}`}let IJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Fs(0,0),this._pointerState=new Map,this._parameters=sW(e),this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new OO({start:(r,i)=>this._dragStart(r,i),update:(r,i)=>this._dragUpdate(i),end:(r,i)=>this._dragEnd(i)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Qr(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const n=this._pointerState.get(e);n&&(n.doubleTapTimeout=Qr(n.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,n){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:r,modifiers:i}=n,{center:s}=r;this._dragStartCenter=s;const o=U$("begin",Fs(0,0),r);this._doubleTapDrag.emit(o,void 0,i),n.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:n,modifiers:r}=e,{center:i}=n,s=U$("update",Fs(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),n);this._doubleTapDrag.emit(s,void 0,r),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:n,modifiers:r}=e,{center:i}=n,s=U$("end",Fs(i.x-this._dragStartCenter.x,i.y-this._dragStartCenter.y),n);this._doubleTapDrag.emit(s,void 0,r),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:n}=e,r=e1(n),i=this._pointerState.get(r),{pointerType:s}=n.native;if(i){const o=s==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;this._clearPointerDown(r),D4(i.event.data,n)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:n}=e,{pointerType:r}=n.native,i=e1(n),s=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(i),s);this._pointerState.set(i,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function U$(t,e,n){const{button:r,buttons:i,pointer:s,pointers:o,pointerType:a,timestamp:l}=n;return{action:t,delta:e,button:r,buttons:i,pointer:s,pointers:o,pointerType:a,timestamp:l}}let RJe=class extends Ws{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,n,r,i){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:n.buttons,timestamp:i,pointers:PJe(this._activePointerMap),pointer:n,angle:r.angle,radius:r.radius,center:r.center}}_addPointer(e){const n=e.native.pointerId,r=UP(this._activePointerMap).angle,i={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(n,i);const s=LC(i,cve(this._activePointerMap));i.initialAngle=s,i.lastAngle=s,this._updatePointerAngles(r)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const n=e.native.pointerId,r=this._activePointerMap.get(n);r?r.event=e:this._addPointer(e)}_removePointer(e){const n=UP(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(n)}_updatePointerAngles(e){const n=UP(this._activePointerMap);this._activePointerMap.forEach(r=>{r.initialAngle=LC(r,n)-e,r.lastAngle=LC(r,n)-e})}_emitEvent(e,n,r){const i=UP(this._activePointerMap);this._drag.emit(this._createPayload(e,n,i,r),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const n=e.data.native.pointerId,r=e.timestamp;this._activePointerMap.get(n)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,r),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(n)):(this._removePointer(n),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const n=e.data,r=n.currentEvent,i=e.timestamp;switch(n.action){case"start":case"update":this._isDragging?this._activePointerMap.has(r.native.pointerId)?(this._updatePointer(r),!this._isCurrentDragSuppressed&&this._emitEvent("update",r,i)):(this._addPointer(r),this._emitEvent("added",r,i),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(r),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",r,i))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function cve(t){const e=[];return t.forEach(n=>{e.push(Fs(n.event.x,n.event.y))}),AJe(e)}function UP(t){const e=cve(t);let n=0;return t.forEach(r=>{let i=LC(r,e),s=i-r.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;i=r.lastAngle+s,r.lastAngle=i;const o=i-r.initialAngle;n+=o}),n/=t.size||1,{angle:n,radius:e.radius,center:e.center}}function PJe(t){const e=new Map;return t.forEach((n,r)=>e.set(r,n.event)),e}function LC(t,e){const n=t.event,r=n.x-e.center.x,i=n.y-e.center.y;return Math.atan2(i,r)}let MJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=sW(e),this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const n=e.data,r=e1(n);if(!this._pointerState.has(r)){const i={downButton:n.native.button,x:n.x,y:n.y,immediateDoubleClick:null};this._pointerState.set(r,i),this.startCapturingPointer(n.native)}}_handlePointerUp(e){const n=e.data,r=e1(n),i=this._pointerState.get(r);if(i&&i.downButton===n.native.button){const s=i.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;s?(s.timeoutHandle.remove(),D4(s,e.data)>o?this._startImmediateDoubleClick(e,i):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(n))):D4(i,e.data)>o?this._removeState(n):this._startImmediateDoubleClick(e,i)}}_startImmediateDoubleClick(e,n){const r=e.data.native.pointerType==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay;n.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),r)}}_removeState(e){const n=e1(e);this._pointerState.delete(n),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},CJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=TJe(e),this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",r=>this._handlePointerLoss(r,"pointer-up")),this.registerIncoming("pointer-capture-lost",r=>this._handlePointerLoss(r,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",r=>this._handlePointerLoss(r,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",r=>this._handlePointerMove(r)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Qr(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const n=e.data,r=n.native.pointerId;let i=null;this._pointerState.size===0&&(i=this._clock.setTimeout(()=>{const o=this._pointerState.get(r);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._parameters.holdDelay));const s={startEvent:n,previousEvent:n,startTimestamp:e.timestamp,isDragging:!1,downButton:n.native.button,holdTimeout:i,modifiers:new Set};this._pointerState.set(r,s),this.startCapturingPointer(n.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const n=e.data,r=n.native.pointerId,i=this._pointerState.get(r);i&&(i.isDragging?this._pointerDrag.emit(GP("update",i,n),void 0,i.modifiers):kJe(n,i.startEvent)>this._getDragThreshold(n.native.pointerType)&&this._startDragging(e),i.previousEvent=n)}_getDragThreshold(e){switch(e){case"touch":return this._parameters.movementUntilTouchDrag;case"pen":return this._parameters.movementUntilPenDrag;default:return this._parameters.movementUntilMouseDrag}}_startDragging(e){const n=e.data,r=n.native.pointerId;this._pointerState.forEach(i=>{i.holdTimeout!=null&&(i.holdTimeout.remove(),i.holdTimeout=null),i.isDragging||(i.modifiers=e.modifiers,i.isDragging=!0,r===i.startEvent.native.pointerId?this._pointerDrag.emit(GP("start",i,n)):this._pointerDrag.emit(GP("start",i,i.previousEvent),e.timestamp))})}_handlePointerLoss(e,n){const r=e.data,i=r.native.pointerId,s=this._pointerState.get(i);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(GP("end",s,n==="pointer-up"?r:s.previousEvent),void 0,s.modifiers):n==="pointer-up"&&s.downButton===r.native.button&&e.timestamp-s.startTimestamp<=this._parameters.maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(r),this._pointerState.delete(i),this.stopCapturingPointer(r.native),this._pointerState.size===0&&this._moveHandle.pause())}};function GP(t,e,n){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:n}}let NJe=class extends Ws{constructor(e={},n=G2){super(!1),this._clock=n,this._pointerState=new Map,this._parameters=sW(e),this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",r=>this._handleImmediateClick(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Qr(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,n){const r=this._pointerState.get(e);r&&(r.doubleClickTimer=Qr(r.doubleClickTimer),n&&this._click.emit(r.event.data,void 0,r.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const n=this._pointerState.get(e);n.pointerDownCount===1&&this._click.emit(n.event.data,void 0,n.event.modifiers),n.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const n=e.data,{pointerType:r}=n.native,i=OJe(n);if(!this._pointerState.has(i))return void this._startClick(e);const s=this._pointerState.get(i),{data:o,modifiers:a}=s.event,l=r==="touch"?this._parameters.maximumDoubleTouchDistance:this._parameters.maximumDoubleClickDistance;D4(o,n)>l?(this._clearDoubleClickTimer(i,!0),this._startClick(e)):(this._clearDoubleClickTimer(i,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const n=e1(e.data),r=this._pointerState.get(n);r&&(r.pointerDownCount+=1)}_startClick(e){const{data:n}=e,{native:{pointerType:r}}=n,i=e1(n),s=r==="touch"?this._parameters.maximumDoubleTouchDelay:this._parameters.maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(i),s);this._pointerState.set(i,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function OJe(t){const{pointerId:e,pointerType:n,button:r}=t.native;return n==="mouse"?`${e}:${r}`:`${n}`}const BP={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},Tne=Symbol("handles");let ex=class extends Kt{initialize(){const e=()=>this.view?.ready;this.addHandles([hc(()=>!e(),()=>this._disconnect()),hc(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerInfo(){return this._inputManager?.latestPointerInfo}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(Tne),this._inputManager=Ci(this._inputManager)}_connect(){const e=this.view.surface,n=new EJe(e,this.view.input),r=[new MJe,new CJe,new NJe,new RJe(this.view.navigation),new IJe],i=new Lu({eventSource:n,recognizers:r}),s=new gZe(this.view,["primary"]),o=new yZe(this.view,["secondary"]);i.installHandlers("prevent-context-menu",[new SJe],Xf.INTERNAL),i.installHandlers("navigation",[new pJe(this.view),new sJe(this.view),new fJe(this.view),new vne(this.view),new vne(this.view,[BP.counter]),s,new cJe(this.view,BP.pan),new hJe(this.view,BP.zoom),new uJe(this.view,BP.rotate),o,new mZe(this.view,"touch")],Xf.INTERNAL),this.view.viewEvents.connect(i),this._source=n,this._inputManager=i,this.addHandles([dn(()=>this.view?.navigation?.browserTouchPanEnabled,a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)},fa),dn(()=>{const{actionMap:a}=this.view.navigation;return{panActions:yne("pan",a),rotateActions:yne("rotate",a)}},({panActions:a,rotateActions:l})=>{s.pointerActions=a,o.pointerActions=l},ea)],Tne)}get test(){}};_([E()],ex.prototype,"view",void 0),_([E()],ex.prototype,"latestPointerInfo",null),_([E()],ex.prototype,"multiTouchActive",null),ex=_([ue("esri.views.2d.input.MapViewInputManager")],ex);const LJe=ex,DJe=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.goToManager=new OC({view:this}),this.animationsEnabled=!0,this.inputManager=new LJe({view:this}),this.addHandles([this.on("resize",i=>this.stateManager.resize(i.width,i.height))])}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}on(r,i,s,o){return this.viewEvents.on(r,i,s,o)||super.on(r,i)}hasEventListener(r){return super.hasEventListener(r)||this.viewEvents.hasHandler(r)}goTo(r,i){return this.goToManager.goTo(r,i)}toMap(r){if(!this.ready)return null;const i=c1e(r)?l1e(this,r):r;return this.stateManager.toMap(i)}};return _([E()],n.prototype,"goToManager",void 0),_([E({readOnly:!0})],n.prototype,"interacting",null),_([E()],n.prototype,"stationary",null),_([E()],n.prototype,"animationsEnabled",void 0),_([E({readOnly:!0})],n.prototype,"inputManager",void 0),n=_([ue("esri.views.Viewport2DMixin")],n),n};let kne=class{constructor(e){this._view=e,this.viewpoint=new tu({targetGeometry:new Jt,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,n]=this._view.size;return Math.sqrt(e*e+n*n)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return O1e(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,n){n.pan=ape(this.center,e.center);let r=Math.abs(e.rotation-this.rotation);r=r>=180?360-r:r,n.rotate=cI(r),n.sourceZoom=this.scale,n.targetZoom=e.scale}interpolate(e,n,r){const{pan:i,rotate:s,zoom:o,zoomOffset:a}=r,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=eS(e.center.x,n.center.x,i),l.y=eS(e.center.y,n.center.y,i),this.viewpoint.scale=eS(e.scale,n.scale+a,o);let c=e.rotation;const u=n.rotation;Math.abs(u-c)>=180&&(c+=360*(c<u?1:-1)),this.viewpoint.rotation=eS(c,u,s)}copyFrom(e){la(this.viewpoint,e.viewpoint),this._view=e.view}};function AE(t,e,n,r){const i=3*t,s=3*(n-t)-i,o=1-i-s,a=3*e,l=3*(r-e)-a,c=1-a-l;function u(v){return((o*v+s)*v+i)*v}function h(v){return((c*v+l)*v+a)*v}function f(v){return(3*o*v+2*s)*v+i}function g(v,x){let b,T,A,I,R,C;for(A=v,C=0;C<8;C++){if(I=u(A)-v,Math.abs(I)<x)return A;if(R=f(A),Math.abs(R)<1e-6)break;A-=I/R}if(b=0,T=1,A=v,A<b)return b;if(A>T)return T;for(;b<T;){if(I=u(A),Math.abs(I-v)<x)return A;v>I?b=A:T=A,A=.5*(T-b)+b}return A}return function(v,x=1e-6){return h(g(v,x))}}const jc={};jc.ease=AE(.25,.1,.25,1),jc.linear=AE(0,0,1,1),jc.easeIn=jc["ease-in"]=AE(.42,0,1,1),jc.easeOut=jc["ease-out"]=AE(0,0,.58,1),jc.easeInOut=jc["ease-in-out"]=AE(.42,0,.58,1);const $Je=t=>t,Gk=t=>t*t,$4=t=>1-Gk(1-t),Ane=t=>t<.5?Gk(2*t)/2:($4(2*(t-.5))+1)/2,j4=t=>t*t*t,iV=t=>1-j4(1-t),Ine=t=>t<.5?j4(2*t)/2:(iV(2*(t-.5))+1)/2,F4=t=>t*t*t*t,sV=t=>1-F4(1-t),Rne=t=>t<.5?F4(2*t)/2:(sV(2*(t-.5))+1)/2,V4=t=>t*t*t*t*t,oV=t=>1-V4(1-t),Pne=t=>t<.5?V4(2*t)/2:(oV(2*(t-.5))+1)/2,z4=t=>1-Math.cos(t*Math.PI/2),aV=t=>1-z4(1-t),Mne=t=>t<.5?z4(2*t)/2:(aV(2*(t-.5))+1)/2,U4=t=>2**(10*(t-1)),G4=t=>1-U4(1-t),Cne=t=>t<.5?U4(2*t)/2:(G4(2*(t-.5))+1)/2,B4=t=>-(Math.sqrt(1-t*t)-1),lV=t=>1-B4(1-t),Nne=t=>t<.5?B4(2*t)/2:(lV(2*(t-.5))+1)/2;function hu(t){const e=2*(t-Math.sqrt((t-1)*t)),n=e/2/t;return r=>r<n?t*r*r:e*r-e+1}function du(t,e){return(n,r)=>n<e?e*t(n/e,r):1-t((1-n)/(1-e),r)*(1-e)}const One=du(hu(1),1),Lne=du(hu(1),0),W4=du(hu(1),.5),Dne=du(hu(2),1),$ne=du(hu(2),0),jne=du(hu(2),.5),Fne=du(hu(3),1),Vne=du(hu(3),0),zne=du(hu(3),.5),Une=du(hu(4),1),Gne=du(hu(4),0),Bne=du(hu(4),.5),Wne={linear:$Je,"in-quad":Gk,"out-quad":$4,"in-out-quad":Ane,"in-coast-quad":One,"out-coast-quad":Lne,"in-out-coast-quad":W4,"in-cubic":j4,"out-cubic":iV,"in-out-cubic":Ine,"in-coast-cubic":Dne,"out-coast-cubic":$ne,"in-out-coast-cubic":jne,"in-quart":F4,"out-quart":sV,"in-out-quart":Rne,"in-coast-quart":Fne,"out-coast-quart":Vne,"in-out-coast-quart":zne,"in-quint":V4,"out-quint":oV,"in-out-quint":Pne,"in-coast-quint":Une,"out-coast-quint":Gne,"in-out-coast-quint":Bne,"in-sine":z4,"out-sine":aV,"in-out-sine":Mne,"in-expo":U4,"out-expo":G4,"in-out-expo":Cne,"in-circ":B4,"out-circ":lV,"in-out-circ":Nne,"quad-in":Gk,"quad-out":$4,"quad-in-out":Ane,"quad-in-coast":One,"quad-out-coast":Lne,"quad-in-out-coast":W4,"cubic-in":j4,"cubic-out":iV,"cubic-in-out":Ine,"cubic-in-coast":Dne,"cubic-out-coast":$ne,"cubic-in-out-coast":jne,"quart-in":F4,"quart-out":sV,"quart-in-out":Rne,"quart-in-coast":Fne,"quart-out-coast":Vne,"quart-in-out-coast":zne,"quint-in":V4,"quint-out":oV,"quint-in-out":Pne,"quint-in-coast":Une,"quint-out-coast":Gne,"quint-in-out-coast":Bne,"sine-in":z4,"sine-out":aV,"sine-in-out":Mne,"expo-in":U4,"expo-out":G4,"expo-in-out":Cne,"circ-in":B4,"circ-out":lV,"circ-in-out":Nne,ease:t=>jc.ease(t),"ease-in":t=>jc.easeIn(t),"ease-out":t=>jc.easeOut(t),"ease-in-out":t=>jc.easeInOut(t)};let jJe=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const H4={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},uve={maxDuration:4e3};let FJe=class hve{constructor(e){this._createCamera=e,this.compared=new jJe,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:H4.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new hve(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,n,r){this.source!==e&&this.source.copyFrom(e),this.target!==n&&this.target.copyFrom(n),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=r.desiredScreenFlow??H4.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const n=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/n}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>vl()}get hasFov(){return Math.abs(this.compared.fov)>vl()}get hasRotate(){return this.compared.rotate>vl()}},VJe=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},zJe=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,n)=>e+n.time,0)}interpolateComponentsAt(e,n){e=Math.min(Math.max(e,0),1),e*=this.time;let r=0,i=0;const s=this.definition,o=this.segments.reduce((a,l)=>a||l.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],c=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,n),s.hasPan&&!isNaN(n.pan)&&isFinite(s.compared.pan)?n.pan=(r+c.compared.pan*n.pan)/s.compared.pan:n.pan=1,s.hasRotate&&!isNaN(n.rotate)&&isFinite(s.compared.rotate)?n.rotate=(i+c.compared.rotate*n.rotate)/s.compared.rotate:n.rotate=1,o&&!isNaN(n.zoom)&&isFinite(c.compared.targetZoom)){const{sourceZoom:u,targetZoom:h}=c.compared,f=n.zoom*(h-u)+u,g=this.segments[0].definition.compared.sourceZoom,v=this.segments[this.segments.length-1].definition.compared.targetZoom,x=Math.abs(h-g)>Math.abs(u-g)?h:u;n.zoomOffset=x-v,n.zoom=(f-g)/(x-g)}else n.zoom=1;return n}e-=l.time,r+=c.compared.pan,i+=c.compared.rotate}}segmentInterpolateComponentsAt(e,n,r){e.interpolateComponentsAt(n,r)}},G$=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,n=e.compared,r=n.sourceZoom,i=n.targetZoom;this._zoomSign=r>i?1:-1,this._panPixelsAtSource=n.pan*e.source.pixelsPerPanAtZoom(r);const s=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=n.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom,{hasZoom:r,hasPan:i,hasRotate:s}=this.definition;let o=0,a=0;r&&(i&&(o=(n/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(a=this._zoomSign*(Math.log(e/n)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(r&&i&&s){const c=o+a+o*a;this._zoomPixelFlow=o*a/c*l,this._panPixelFlow=a/c*l,this._rotatePixelFlow=o/c*l}else if(r&&i){const c=1+o;this._zoomPixelFlow=o/c*l,this._panPixelFlow=1/c*l}else if(r&&s){const c=1+a;this._zoomPixelFlow=a/c*l,this._rotatePixelFlow=1/c*l}else if(i&&s){const c=this._panPixelsAtSource/this._rotatePixels,u=1+c;this._panPixelFlow=c/u*l,this._rotatePixelFlow=1/u*l}else i?this._panPixelFlow=l:r?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const c=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=c,this._panPixelFlow/=c,this._rotatePixelFlow/=c}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/UJe:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,n=e*this._panPixelsAtSource;return Math.log(n*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const n=this.definition.compared.sourceZoom,r=this.definition.compared.targetZoom;return(n*(n/r)**-e-n)/(r-n)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:n,segmentEnd:r}=this.definition;return n+e*(r-n)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const n=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(n*e*this._time)-1))/(n*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,n){e=Math.min(Math.max(e,0),1),n.zoom=this._interpolateComponentsZoom(e),n.pan=this._interpolateComponentsPan(e),n.rotate=this._interpolateComponentsRotate(e),n.zoomOffset=0,n.fov=this._interpolateComponentsFov(e)}};const UJe=cI(45);function GJe(t,e,n){const r=e-t.compared.sourceZoom,i=t.halfWindowPanAtZoom(r);return-t.halfWindowSize*(n.ascensionFactor*Math.LN2*t.compared.pan+i)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*i)}function BJe(t,e,n){const r=1/e,i=Math.log(t.compared.sourceZoom*r),s=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,c=(n.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*r*s*o*l*c-t.halfWindowSize*i*s*o*l+t.halfWindowSize*i*s*o*c/(a*a)}function WJe(t,e,n){const r=e-t.compared.sourceZoom,i=1/r,s=1/e,o=Math.log(t.compared.sourceZoom*s),a=(n.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(r))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*(-2*i*s*a+2*i*o+2*s-2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function HJe(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function qJe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function KJe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function YJe(t,e,n){return-t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function XJe(t,e,n){return t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function ZJe(t,e,n){return-2*t.compared.pan*t.halfWindowSize*(n.ascensionFactor+n.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function JJe(t,e,n){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-n.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function QJe(t,e,n){const r=Math.log(e/t.compared.targetZoom),i=1/t.desiredPixelFlow,s=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-n.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*r*i*s*a+t.halfWindowSize*r*i*s*l/(o*o)+t.halfWindowSize*i*s*a*l/e}function eQe(t,e,n){const r=e-t.compared.targetZoom,i=1/r,s=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+n.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*i*(-2*i*s*a-2*i*o+2*s+2*o*a/(r*r)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function tQe(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function nQe(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function rQe(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function iQe(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const n=Math.LN2*t.compared.pan,r=e,i=t.halfWindowPanAtZoom(r),s=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*i);return t.compared.sourceZoom<=t.compared.targetZoom?s*(n-i):s*(n+i)}function sQe(t,e){let n=oQe(t,e);const r={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},i=r.ascensionFactor===0,s=r.descensionFactor===0,o=i?HJe:GJe,a=i?qJe:BJe,l=i?KJe:WJe,c=s?tQe:JJe,u=s?nQe:QJe,h=s?rQe:eQe,f=C=>o(t,C,r)+YJe(t,C,r)+c(t,C,r),g=C=>a(t,C,r)+XJe(t,C,r)+u(t,C,r),v=C=>l(t,C,r)+ZJe(t,C,r)+h(t,C,r);let x=f(n);const b=iQe(t);let T;const A=e.maximumIterations||20,I=e.maximumDistance!=null?e.maximumDistance:1/0;for(T=0;T<A;T++){const C=e.desiredSlope??1e-6;let V=g(n);Math.abs(V)>C&&(V+=C);const M=V/v(n);if(isNaN(M)||n>=I&&M<0){if(!isFinite(I))return null;n=I,x=f(n);break}if(n-=M,n<=t.compared.sourceZoom||n<=t.compared.targetZoom)return null;const N=f(n);if(Math.abs(N-x)/x<=.005)break;x=N}return isNaN(x)||x>b*(1-.3)||n<=t.compared.sourceZoom||n<=t.compared.targetZoom?null:n}function oQe(t,e){const n=Math.max(t.compared.sourceZoom,t.compared.targetZoom),r=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return r<n?e.maximumDistance!=null?n+(e.maximumDistance-n)/2:1.5*n:e.maximumDistance?Math.min(e.maximumDistance,r):r}let aQe=class extends zJe{constructor(e,n){super(),this._preallocSegments=[new G$,new G$,new G$],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,n)}update(e,n){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const r=n?.apex?sQe(e,n.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,r?this._updateWithApex(r,n?.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,n,r){e.interpolateComponentsAt(n,r),e===this._ascensionSegment?r.zoom=$4(r.zoom):e===this._descensionSegment&&(r.zoom=Gk(r.zoom))}_updateWithApex(e,n){const[r,i,s]=this._preallocSegments,o=n?.ascensionFactor??.5,a=Math.min(1-o,n?.ascensionFactor!=null&&n.descensionFactor!=null?n.descensionFactor:.5),l=1-o-a;r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*o,r.definition.compared.rotate=this.definition.compared.rotate*o,r.definition.segmentEnd=o,r.update(),this._ascensionSegment=r,this.segments.push(r),l>0&&(i.definition?i.definition.copyFrom(this.definition):i.definition=this.definition.clone(),i.definition.copyFrom(this.definition),i.definition.compared.sourceZoom=e,i.definition.compared.targetZoom=e,i.definition.compared.pan=this.definition.compared.pan*l,i.definition.compared.rotate=this.definition.compared.rotate*l,i.definition.segmentStart=r.definition.segmentEnd,i.definition.segmentEnd=r.definition.segmentEnd+l,i.update(),this.segments.push(i)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*a,s.definition.compared.rotate=this.definition.compared.rotate*a,s.definition.segmentStart=o+l,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const lQe=new VJe;let cQe=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=W4,this.definition=new FJe(e),this.path=new aQe}update(e,n,r){this.definition.update(e,n,r),this.path.update(this.definition,r),this._time=this._applyTimeSettings(n$e(isFinite(this.path.time)?this.path.time:0),r),this._easing=r.easing??(this._time>=1e3?W4:G4)}cameraAt(e,n){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const r=this.path.interpolateComponentsAt(e,lQe);n.interpolate(this.definition.source,this.definition.target,r)}_normalizedEasing(e){const n=this._easing(0,this._time),r=this._easing(1,this._time);return(this._easing(e,this._time)-n)/(r-n)}_applyTimeSettings(e,n){const r=n.speedFactor!=null?n.speedFactor:1,i=n.minDuration??H4.minDuration/r,s=n.maxDuration??H4.maxDuration/r;return e=n.duration!=null?n.duration:Math.min(Math.max(e/r,i),s)}};const uQe=2e3,hQe=64;let dQe=class{constructor(e){this._view=e,this._animation=new cQe(()=>new kne(this._view)),this._current=new kne(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,n,r={}){la(this._current.viewpoint,e),la(this._source.viewpoint,e),la(this._target.viewpoint,n),this._animation.update(this._source,this._target,r)}applyRatio(e,n){this._animation.cameraAt(n,this._current),la(e,this._current.viewpoint)}},tx=class extends Kt{constructor(e){super(e),this._animation=null,this._destinationViewState=new rW,this.updateFunction=null,this.easing=Wne.ease,this.viewpoint=new tu({targetGeometry:new Jt,scale:0,rotation:0}),this._updateTask=s2({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new dQe(e.view)}destroy(){this._updateTask=Qr(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,n,r){this.stop();const i=this.viewpoint;la(i,n);const s=e.target;this._transition.update(this.viewpoint,s,{apex:{maximumDistance:Math.min(Math.min(n.scale,s.scale)*hQe,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:r?.duration,maxDuration:r?.animationMode==="auto"?1/0:r?.maxDuration??uve.maxDuration,speedFactor:r?.speedFactor,easing:(typeof r?.easing=="string"?Wne[r.easing]:r?.easing)||this.easing}),r?.animationMode==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=s,fQe(this._transition.animation,r,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,s,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,n){this.stop(),this.updateFunction=n,this.viewpoint=e;const r=new nV({target:e.clone()}),i=()=>{this.animation===r&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return r.when(i,i),this._startTime=performance.now(),this._updateTask.resume(),this.animation=r,r}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const n=this.animation;if(n&&n.state!==nV.state.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),this.animation?.update(this.viewpoint);else{const r=performance.now()-this._startTime,i=this._transition.duration,s=i>0?r/i:1,o=s>=1;this._transition.applyRatio(this.viewpoint,s),o&&this.animation?.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function fQe(t,e,n,r){if(e?.duration!=null)return!0;const{time:i,isLinear:s}=t,o=e?.speedFactor||1;if(i>(e?.maxDuration??uve.maxDuration/o))return!1;if(s){const l=Di(),c=Fs(...r.toScreen(l,...n.center)),u=Fs(...n.toScreen(l,...r.center)),h=u!=null&&u.x>-1*n.size[0]&&u.x<(1.5+.5)*n.size[0]&&u.y>-1*n.size[1]&&u.y<(1.5+.5)*n.size[1],f=c!=null&&c.x>-1*r.size[0]&&c.x<(1.5+.5)*r.size[0]&&c.y>-1*r.size[1]&&c.y<(1.5+.5)*r.size[1];if(i>uQe/o&&!h&&!f)return!1}return!0}_([E()],tx.prototype,"easing",void 0),_([E()],tx.prototype,"view",void 0),_([E()],tx.prototype,"viewpoint",void 0),tx=_([ue("esri.views.2d.AnimationManager")],tx);const pQe=tx;function ni(){return Promise.all([xe(()=>import("./webglDeps-PJGhStvc.js"),__vite__mapDeps([305,247,306,307,308,49,142])),xe(()=>import("./mapViewDeps-BnHV3PZw.js"),__vite__mapDeps([309,28,29,30,179,180,172,50,49,181,33,34,178,182,168,18,19,310,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,315,183,184,316,39,40,170,127,128,317,108,305,318,196,319,320,223,321,236,237,322,48,166,171,173,22,122,121,323,185,324,177,102,103,104,325,187,192,164,326,327,328,329,243,267,330,331]))])}const IE=()=>ni().then(()=>xe(()=>import("./TileLayerView2D-B37lytzY.js"),__vite__mapDeps([332,178,34,179,180,172,50,49,181,33,182,168,18,19,316,28,29,30,39,40,170,127,128,317,108,314,57,313,167,141,307,308,142,246,247,201,224,227,118,51,318,311,306,238,312,174,196,319,320,223,48,310,169,8,175,186,183,184,236,237,325,166,171,173,22,122,121,187,192,164,333,334,335,329,336,290,337,327,328,338,339,340,267,341,342,343,344,345]))),I0=()=>ni().then(()=>xe(()=>import("./FeatureLayerView2D-CeAN_emD.js").then(t=>t.F),__vite__mapDeps([346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),Hne={"base-dynamic":()=>ni().then(()=>xe(()=>import("./BaseDynamicLayerView2D-BAS56ta2.js"),__vite__mapDeps([351,352,313,167,168,141,307,308,49,142,246,247,201,314,57,224,227,118,50,51,334,311,306,238,335,336,290,353,338,339]))),"base-tile":IE,"bing-maps":IE,catalog:()=>ni().then(()=>xe(()=>import("./CatalogLayerView2D-Dqm0SBRS.js"),__vite__mapDeps([354,336,314,57,290,338]))),"catalog-dynamic-group":()=>ni().then(()=>xe(()=>import("./CatalogDynamicGroupLayerView2D-BW7eJxi8.js"),__vite__mapDeps([355,336,314,57,290,338]))),"catalog-footprint":()=>ni().then(()=>xe(()=>import("./CatalogFootprintLayerView2D-C_r6zRQ-.js"),__vite__mapDeps([356,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),csv:I0,"geo-rss":()=>ni().then(()=>xe(()=>import("./GeoRSSLayerView2D-BQPWqQjL.js"),__vite__mapDeps([357,3,231,12,13,14,15,8,16,17,18,19,229,230,11,20,35,36,176,39,40,170,127,128,33,34,109,29,30,21,22,23,43,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,178,182,311,238,312,174,175,186,325,316,28,317,108,166,171,173,122,121,187,192,164,338]))),feature:I0,geojson:I0,parquet:I0,graphics:()=>ni().then(()=>xe(()=>import("./GraphicsLayerView2D-DBqaJEo1.js"),__vite__mapDeps([358,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,33,34,178,182,18,19,311,238,312,174,8,175,186,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338,345]))),group:()=>ni().then(()=>xe(()=>import("./GroupLayerView2D-CeV6_jjV.js"),__vite__mapDeps([359,336,314,57,290,338]))),imagery:()=>ni().then(()=>xe(()=>import("./ImageryLayerView2D-DTR0nfff.js"),__vite__mapDeps([360,361,308,49,142,246,247,141,38,313,167,168,307,201,314,57,224,227,118,50,51,27,25,336,290,325,39,40,179,180,172,181,33,34,178,182,18,19,316,28,29,30,170,127,128,317,108,166,169,171,173,22,174,122,121,310,311,306,238,312,8,175,186,187,192,164,337,327,328,329,352,334,335,353,210,42,347,344,338,339,345]))),"imagery-tile":()=>ni().then(()=>xe(()=>import("./ImageryTileLayerView2D-D9XbNQJb.js"),__vite__mapDeps([362,9,361,308,49,142,246,247,141,38,313,167,168,307,201,314,57,224,227,118,50,51,27,25,336,290,209,363,329,311,306,238,324,312,174,335,364,210,345,42,347,344,338,339]))),kml:()=>ni().then(()=>xe(()=>import("./KMLLayerView2D-CfQaRCk6.js"),__vite__mapDeps([365,366,229,230,11,12,13,14,15,8,16,17,18,19,20,35,36,176,39,40,170,127,128,33,34,109,29,30,231,21,22,23,43,334,314,57,311,247,306,307,238,335,352,313,167,168,141,308,49,142,246,201,224,227,118,50,51,336,290,326,327,328,169,329,310,179,180,172,181,178,182,312,174,175,186,325,316,28,317,108,166,171,173,122,121,187,192,164,338,102,103,104,210,321,305,236,237,319,363]))),"knowledge-graph":()=>ni().then(()=>xe(()=>import("./KnowledgeGraphLayerView2D-Bcm1sVuk.js"),__vite__mapDeps([367,336,314,57,290,338]))),"link-chart":()=>ni().then(()=>xe(()=>import("./KnowledgeGraphLayerView2D-Bcm1sVuk.js"),__vite__mapDeps([367,336,314,57,290,338]))),"knowledge-graph-sublayer":I0,"map-image":()=>ni().then(()=>xe(()=>import("./MapImageLayerView2D-DO_ras3X.js"),__vite__mapDeps([368,352,313,167,168,141,307,308,49,142,246,247,201,314,57,224,227,118,50,51,334,311,306,238,335,336,290,325,39,40,179,180,172,181,33,34,178,182,18,19,316,28,29,30,170,127,128,317,108,166,169,171,173,22,174,122,121,310,312,8,175,186,187,192,164,337,327,328,329,353,338,369,267,341,343,347,339,340,342,344,345]))),"map-notes":()=>ni().then(()=>xe(()=>import("./MapNotesLayerView2D-DdCDf72M.js"),__vite__mapDeps([370,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,33,34,178,182,18,19,311,238,312,174,8,175,186,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338,345]))),media:()=>ni().then(()=>xe(()=>import("./MediaLayerView2D-DuGu9FIu.js"),__vite__mapDeps([371,372,192,231,12,13,14,15,8,16,17,18,19,178,34,179,180,172,50,49,181,33,182,168,316,28,29,30,39,40,170,127,128,317,108,314,57,313,167,141,307,308,142,246,247,201,224,227,118,51,318,311,306,238,312,174,196,319,320,223,48,310,169,175,186,183,184,236,237,325,166,171,173,22,122,121,187,164,323,185,373,324,336,290,338]))),"ogc-feature":()=>ni().then(()=>xe(()=>import("./OGCFeatureLayerView2D-DLZTA0ao.js"),__vite__mapDeps([374,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),"open-street-map":IE,"oriented-imagery":I0,route:()=>ni().then(()=>xe(()=>import("./RouteLayerView2D-CBqVRUvK.js"),__vite__mapDeps([375,376,377,336,314,57,290,326,327,328,49,169,167,168,141,306,247,329,313,307,308,142,246,201,224,227,118,50,51,310,179,180,172,181,33,34,178,182,18,19,311,238,312,174,8,175,186,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338,345]))),stream:()=>ni().then(()=>xe(()=>import("./StreamLayerView2D-jFAcegxv.js"),__vite__mapDeps([378,43,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),"subtype-group":()=>ni().then(()=>xe(()=>import("./SubtypeGroupLayerView2D-CQeZL96C.js"),__vite__mapDeps([379,346,310,179,180,172,50,49,181,33,34,178,182,168,18,19,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,271,258,231,12,13,14,15,16,17,21,22,20,23,132,173,347,43,348,349,122,131,336,290,328,329,196,46,47,48,52,193,194,187,39,40,281,109,29,30,315,350,251,134,189,270,56,341,344,338,339,345]))),tile:IE,"vector-tile":()=>ni().then(()=>xe(()=>import("./VectorTileLayerView2D-DtjC_jTv.js"),__vite__mapDeps([380,22,182,48,49,178,34,35,36,223,320,224,181,247,308,142,246,313,167,168,141,307,201,314,57,227,118,50,51,329,120,3,225,226,28,29,30,336,290,338,339]))),video:()=>ni().then(()=>xe(()=>import("./VideoLayerView2D-DT_vFgQl.js"),__vite__mapDeps([381,382,55,6,56,57,62,7,8,383,32,33,34,31,35,36,373,201,313,167,168,141,307,308,49,142,246,247,314,224,227,118,50,51,310,179,180,172,181,178,182,18,19,311,306,238,169,312,174,175,186,324,384,336,290,326,327,328,329,325,39,40,316,28,29,30,170,127,128,317,108,166,171,173,22,122,121,187,192,164,338]))),wcs:()=>ni().then(()=>xe(()=>import("./ImageryTileLayerView2D-D9XbNQJb.js"),__vite__mapDeps([362,9,361,308,49,142,246,247,141,38,313,167,168,307,201,314,57,224,227,118,50,51,27,25,336,290,209,363,329,311,306,238,324,312,174,335,364,210,345,42,347,344,338,339]))),"web-tile":IE,wfs:I0,wms:()=>ni().then(()=>xe(()=>import("./WMSLayerView2D-BBfXXpXd.js"),__vite__mapDeps([385,352,313,167,168,141,307,308,49,142,246,247,201,314,57,224,227,118,50,51,334,311,306,238,335,336,290,353,338,339,386,347]))),wmts:()=>ni().then(()=>xe(()=>import("./WMTSLayerView2D-BlxpCj-f.js"),__vite__mapDeps([387,333,334,314,57,311,247,306,307,238,335,313,167,168,141,308,49,142,246,201,224,227,118,50,51,329,336,290,338,339]))),"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"gaussian-splat":null,"integrated-mesh-3dtiles":null,"integrated-mesh":null,"line-of-sight":null,"point-cloud":null,scene:null,unknown:null,unsupported:null,viewshed:null,voxel:null};function mQe(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",n=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Xe(`${n}:view-not-supported`,`${e} is not supported in 2D`)}const qne={hasLayerViewModule:t=>Hne[t.type]!=null,importLayerView:t=>{const e=Hne[t.type];if(e==null)throw mQe(t);return e(t)}};var Hl;let ib=(Hl=class{static getId(e,n,r,i){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${n}/${r}/${i}`}constructor(e,n,r,i){this.set(e,n,r,i)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,n=4095&this.col,r=63&this.level;return(3&this.world)<<30|n<<22|e<<8|r}acquire(e,n,r,i){this.set(e,n,r,i)}contains(e){const n=e.level-this.level;return n>=0&&this.row===e.row>>n&&this.col===e.col>>n&&this.world===e.world}containsChild(e){const n=e.level-this.level;return n>0&&this.row===e.row>>n&&this.col===e.col>>n&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new Hl(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,n,r,i){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[s,o,a,l]=e.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+n,this.col=+r,this.world=+i||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new Hl(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,n,r){const i=this.clone();return i.col+=e,i.row+=n,r.normalizeKey(i),i}getChildKeys(){const e=this.level+1,n=this.row<<1,r=this.col<<1,i=this.world;return[new Hl(e,n,r,i),new Hl(e,n,r+1,i),new Hl(e,n+1,r,i),new Hl(e,n+1,r+1,i)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}},Hl.pool=new H2(()=>new Hl(""),null,null,25,50),Hl);function __(t,e){return[t,e]}function R0(t,e,n){return t[0]=e,t[1]=n,t}function gQe(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}const Mu=new ib("0/0/0/0");let yQe=class dve{static create(e,n,r=null){const i=La(e.spatialReference),s=n.origin||__(e.origin.x,e.origin.y),o=__(e.size[0]*n.resolution,e.size[1]*n.resolution),a=__(-1/0,-1/0),l=__(1/0,1/0),c=__(1/0,1/0);r!=null&&(R0(a,Math.max(0,Math.floor((r.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymax)/o[1]))),R0(l,Math.max(0,Math.floor((r.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-r.ymin)/o[1]))),R0(c,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:u,rows:h}=n;let f,g,v,x;return!r&&u&&h&&(R0(a,u[0],h[0]),R0(l,u[1],h[1]),R0(c,u[1]-u[0]+1,h[1]-h[0]+1)),e.isWrappable?(f=__(Math.ceil(Math.round((i.valid[1]-i.valid[0])/n.resolution)/e.size[0]),c[1]),g=!0,v=i.origin,x=i.valid):(f=c,g=!1),new dve(n.level,n.resolution,n.scale,s,a,l,c,o,f,g,v,x)}constructor(e,n,r,i,s,o,a,l,c,u,h,f){this.level=e,this.resolution=n,this.scale=r,this.origin=i,this.first=s,this.last=o,this.size=a,this.norm=l,this.worldSize=c,this.wrap=u,this._spatialReferenceOrigin=h,this._spatialReferenceValid=f}normalizeCol(e){if(!this.wrap)return e;const n=this.worldSize[0];return e<0?n-1-Math.abs((e+1)%n):e%n}normalizeKey(e){if(!this.wrap)return;const n=this.worldSize[0],r=e.col;r<0?(e.col=r+n,e.world-=1):r>=n&&(e.col=r-n,e.world+=1)}denormalizeCol(e,n){return this.wrap?this.worldSize[0]*n+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const n=this.origin[0]+e*this.norm[0],r=this._spatialReferenceOrigin,i=this._spatialReferenceValid;return this.wrap&&r&&i?n===r[0]?i[0]:this.origin[0]===r[0]&&e===this.worldSize[0]?i[1]:n:n}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,n,r=!1){Mu.set(n);const i=r?Mu.col:this.denormalizeCol(Mu.col,Mu.world),s=Mu.row;return gQe(e,this.getXForColumn(i),this.getYForRow(s+1),this.getXForColumn(i+1),this.getYForRow(s)),e}getTileCoords(e,n,r=!1){Mu.set(n);const i=r?Mu.col:this.denormalizeCol(Mu.col,Mu.world);return Array.isArray(e)?R0(e,this.getXForColumn(i),this.getYForRow(Mu.row)):(e.x=this.getXForColumn(i),e.y=this.getYForRow(Mu.row)),e}};var a1;let oW=(a1=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:n,colFrom:r,colTo:i}of this.spans)for(let s=r;s<=i;s++){const o=e.getWorldForColumn(s);yield new ib(e.level,n,e.normalizeCol(s),o)}}forEach(e,n){const{spans:r,lodInfo:i}=this,{level:s}=i;if(r.length!==0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++)e.call(n,s,o,i.normalizeCol(c),i.getWorldForColumn(c))}},a1.pool=new H2(()=>new a1),a1),B$=class{constructor(e,n,r){this.row=e,this.colFrom=n,this.colTo=r}};const ai=new ib("0/0/0/0");let vQe=class fve{static create(e,n){e[1]>n[1]&&([e,n]=[n,e]);const[r,i]=e,[s,o]=n,a=s-r,l=o-i,c=l!==0?a/l:0,u=(Math.ceil(i)-i)*c,h=(Math.floor(i)-i)*c;return new fve(r,Math.floor(i),Math.ceil(o),c,a<0?u:h,a<0?h:u,a<0?s:r,a<0?r:s)}constructor(e,n,r,i,s,o,a,l){this.x=e,this.ymin=n,this.ymax=r,this.invM=i,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Dl=[[0,0],[0,0],[0,0],[0,0]],_Qe=1e-6;let xQe=class{constructor(e,n=null,r=e.lods[0].level,i=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=n,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=e.lods.filter(a=>a.level>=r&&a.level<=i);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>yQe.create(e,a,n));s.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,n,r=!1){ai.set(n);const i=this._infoByLevel[ai.level];return i?i.getTileBounds(e,ai,r):e}getTileCoords(e,n,r=!1){ai.set(n);const i=this._infoByLevel[ai.level];return i?i.getTileCoords(e,ai,r):e}getTileCoverage(e,n=192,r=!0,i="closest"){if(!r&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const s=i==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=oW.pool.acquire(s),a=this._wrap;let l,c,u,h=1/0,f=-1/0;const g=o.spans;Dl[0][0]=Dl[0][1]=Dl[1][1]=Dl[3][0]=-n,Dl[1][0]=Dl[2][0]=e.size[0]+n,Dl[2][1]=Dl[3][1]=e.size[1]+n;for(const T of Dl)e.toMap(T,T),T[0]=s.getColumnForX(T[0]),T[1]=s.getRowForY(T[1]);const v=[];let x=3;for(let T=0;T<4;T++){if(Dl[T][1]===Dl[x][1]){x=T;continue}const A=vQe.create(Dl[T],Dl[x]);h=Math.min(A.ymin,h),f=Math.max(A.ymax,f),v[A.ymin]===void 0&&(v[A.ymin]=[]),v[A.ymin].push(A),x=T}if(h==null||f==null||f-h>100)return null;let b=[];for(l=h;l<f;){v[l]!=null&&(b=b.concat(v[l])),c=1/0,u=-1/0;for(let T=b.length-1;T>=0;T--){const A=b[T];c=Math.min(c,A.getLeftCol()),u=Math.max(u,A.getRightCol())}if(c=Math.floor(c),u=Math.floor(u),l>=s.first[1]&&l<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const T=Math.floor(u/s.worldSize[0]);for(let A=Math.floor(c/s.worldSize[0]);A<=T;A++)g.push(new B$(l,Math.max(s.getFirstColumnForWorld(A),c),Math.min(s.getLastColumnForWorld(A),u)))}else g.push(new B$(l,c,u));else c>s.last[0]||u<s.first[0]||(c=Math.max(c,s.first[0]),u=Math.min(u,s.last[0]),g.push(new B$(l,c,u)));l+=1;for(let T=b.length-1;T>=0;T--){const A=b[T];A.ymax>=l?A.incrRow():b.splice(T,1)}}return o}getTileParentId(e){ai.set(e);const n=this._infoByLevel[ai.level],r=this._lodInfos.indexOf(n)-1;return r<0?null:(this._getTileIdAtLOD(ai,this._lodInfos[r],ai),ai.id)}getTileResolution(e){const n=this._infoByLevel[typeof e=="object"?e.level:e];return n?n.resolution:-1}getTileScale(e){const n=this._infoByLevel[e.level];return n?n.scale:-1}intersects(e,n){ai.set(n);const r=this._infoByLevel[ai.level],i=e.lodInfo;if(i.resolution>r.resolution){this._getTileIdAtLOD(ai,i,ai);const o=i.denormalizeCol(ai.col,ai.world);for(const a of e.spans)if(a.row===ai.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(i.resolution<r.resolution){const[o,a,l,c]=e.spans.reduce((x,b)=>(x[0]=Math.min(x[0],b.row),x[1]=Math.max(x[1],b.row),x[2]=Math.min(x[2],b.colFrom),x[3]=Math.max(x[3],b.colTo),x),[1/0,-1/0,1/0,-1/0]),u=r.denormalizeCol(ai.col,ai.world),h=i.getColumnForX(r.getXForColumn(u)),f=i.getRowForY(r.getYForRow(ai.row)),g=i.getColumnForX(r.getXForColumn(u+1))-1,v=i.getRowForY(r.getYForRow(ai.row+1))-1;return!(h>c||g<l||f>a||v<o)}const s=i.denormalizeCol(ai.col,ai.world);return e.spans.some(o=>o.row===ai.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(e,n,r){if(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],this._wrap){const i=La(this.tileInfo.spatialReference),s=-r*(i.valid[1]-i.valid[0]);e[0]+=s,e[2]+=s}return e}getSmallestInfoForScale(e){const n=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>n[0])return this._infoByScale[n[0]];for(let r=1;r<n.length-1;r++)if(e>n[r]+_Qe)return this._infoByScale[n[r-1]];return this._infoByScale[n[n.length-1]]}getClosestInfoForScale(e){const n=this.scales;return this._infoByScale[e]||(e=n.reduce((r,i)=>Math.abs(i-e)<Math.abs(r-e)?i:r,n[0])),this._infoByScale[e]}scaleToLevel(e){const n=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let r=n.length-1;r>=0;r--)if(e<n[r])return r===n.length-1?this._infoByScale[n[n.length-1]].level:this._infoByScale[n[r]].level+(n[r]-e)/(n[r]-n[r+1]);return this._infoByScale[n[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,n,r){const i=this._infoByLevel[r.level];return e.set(r),n.resolution<i.resolution?null:(n.resolution===i.resolution||(e.level=n.level,e.col=Math.floor(r.col*i.resolution/n.resolution+.01),e.row=Math.floor(r.row*i.resolution/n.resolution+.01)),e)}},wQe=class{constructor(e,n){this.item=e,this.controller=n,this.promise=null}},bQe=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new iw,this._controllers=new iw,this._processingItems=new iw,this._pausedSignal=v2(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new Ok(e.peeker),this.process=e.process;const n=e.scheduler;e.priority&&n&&(this._task=n.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=Qr(this._schedule),this._task=Qr(this._task)}get updating(){return!!this._task?.updating||this.readyToRun}get length(){return this._processingItems.size+this._queue.length}abort(e){const n=this._controllers.get(e);n&&n.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(n=>e.push(n)),this._controllers.clear(),e.forEach(n=>n.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((n,r)=>e(r))}get(e){const n=this._deferreds.get(e);return n?n.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,n){const r=this.get(e);if(r)return r;const i=new AbortController;let s=null;n&&(s=lu(n,()=>i.abort()));const o=()=>{const u=this._processingItems.get(e);u&&u.controller.abort(),a(),c.reject(Tr())},a=()=>{l.remove(),s?.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=_G(i.signal,o),c=uc();return this._deferreds.set(e,c),this._controllers.set(e,i),c.promise.then(a,a),this._queue.push(e),this._scheduleNext(),c.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject(Tr()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const n of e)this._queue.push(n.item),n.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get readyToRun(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Y2(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,n){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(n))}_processError(e,n){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(n))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let n;const r=new AbortController,i=new wQe(e,r);this._processingItems.set(e,i);try{n=this.process(e,r.signal)}catch(s){this._processError(i,s)}da(n)?(i.promise=n,n.then(s=>this._processResult(i,s),s=>this._processError(i,s))):this._processResult(i,n)}get test(){}};const Kne=[0,0];let _f=class extends Kt{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:n,scheduler:r,priority:i}=this;this._queue=new bQe({concurrency:e,scheduler:r,priority:i,process:(s,o)=>{const a=this._keyToItem.get(s);return n(a,{signal:o})},peeker:s=>this._peek(s)})}destroy(){this.clear(),this._queue=Ci(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const n=typeof e=="string"?e:e.id;this._queue.abort(n)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const n=e.key.id;if(this._queue.has(n))return this._queue.get(n);const r=this._queue.push(n),i=this.tileInfoView.getTileScale(e.key),s=XA(this._tilesByScale,i,()=>new Set),o=()=>{s.delete(e.key),s.size===0&&this._tilesByScale.delete(i),this._keyToItem.delete(n)};return s.add(e.key),this._keyToItem.set(n,e),r.then(o,o),r}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const n=new Set;for(const o of e)n.add(this._keyToItem.get(o).key);const r=this.state.scale;let i,s=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(hfe(a,l=>n.has(l))){const l=Math.abs(o-r);l<s&&(i=a,s=l)}return this._getClosestTileKey(i,e).id}_getClosestTileKey(e,n){const r=this.tileInfoView,i=this.state.center;let s,o=Number.POSITIVE_INFINITY;for(const a of e)if(n.has(a.id)){r.getTileCoords(Kne,a);const l=_O(Kne,i);l<o&&(o=l,s=a)}return s}};_([E({constructOnly:!0})],_f.prototype,"concurrency",void 0),_([E({constructOnly:!0})],_f.prototype,"priority",void 0),_([E({constructOnly:!0})],_f.prototype,"process",void 0),_([E({constructOnly:!0})],_f.prototype,"scheduler",void 0),_([E()],_f.prototype,"state",void 0),_([E({constructOnly:!0})],_f.prototype,"tileInfoView",void 0),_f=_([ue("esri.views.2d.tiling.TileQueue")],_f);const W4t=_f;let EQe=class{constructor(e,n,r){this.maxSize=e,this._tileInfoView=n,this._removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const n=this._tilePerId.get(e);if(!n)return;const r=n.key.level,i=this._tileKeysPerLevel[r];Yne(this._tilePerId,e);for(let s=0;s<i.length;s++)if(i[s].id===e){i.splice(s,1);break}return n.visible=!0,n}add(e){e.visible=!1;const n=e.key,r=n.id;if(this._tilePerId.has(r))return;this._tilePerId.set(r,e);const i=n.level;this._tileKeysPerLevel[i]||(this._tileKeysPerLevel[i]=[]),this._tileKeysPerLevel[i].push(n)}prune(e,n,r){let i=this._tilePerId.size;if(i<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;i>this.maxSize&&s>=0;)s!==e&&(i=this._pruneAroundCenterTile(i,n,r,s)),s--;i>this.maxSize&&(i=this._pruneAroundCenterTile(i,n,r,e))}_pruneAroundCenterTile(e,n,r,i){const s=this._tileKeysPerLevel[i];if(!s||s.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=r*o[0],c=r*o[1],u=[0,0],h=[0,0];for(s.sort((f,g)=>(u[0]=a.x+l*(f.col+.5),u[1]=a.y-c*(f.row+.5),h[0]=a.x+l*(g.col+.5),h[1]=a.y-c*(g.row+.5),Ik(u,n)-Ik(h,n)));s.length>0;){const f=s.pop();if(this._removeTile(f.id),--e===this.maxSize)break}return e}_removeTile(e){const n=this._tilePerId.get(e);this._removedFunc&&n&&this._removedFunc(n),Yne(this._tilePerId,e)}};function Yne(t,e){t.delete(e)}const P0=new ib(0,0,0,0),rf=new Map,RE=[],W$=[];let q4t=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new EQe(e.cacheSize,this.tileInfoView,n=>{this.releaseTile(n)}))}destroy(){this.tileIndex.clear()}update(e){const{resampling:n,tileIndex:r}=this,{scale:i,center:s,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,c=!e.stationary&&i>this._previousScale;if(this._previousScale=i,!n&&(i>a||i<l))return this.tiles.length=0,void this.clear();const u=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!u)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:f}=u,{level:g}=f;this.tiles.length=0,r.forEach(T=>T.visible=!0);let v=0,x=0;if(h.length>0)for(const{row:T,colFrom:A,colTo:I}of h)for(let R=A;R<=I;R++){v++;const C=P0.set(g,T,f.normalizeCol(R),f.getWorldForColumn(R)).id;let V=r.get(C);if(V)V.isReady?(rf.set(C,V),x++):c||this._addParentTile(C,rf);else{if(this._tileCache?.has(C)){if(V=this._tileCache.pop(C),this.tileIndex.set(C,V),V.isReady){rf.set(C,V),x++;continue}}else V=this.acquireTile(P0),this.tileIndex.set(C,V);c||this._addParentTile(C,rf)}}const b=x===v;for(const[T,A]of r){if(rf.has(T))continue;P0.set(T);const I=this.tileInfoView.intersects(u,P0),R=this.cachePolicy==="purge"?P0.level!==g:P0.level>g;!I||!c&&b?!R&&I||RE.push(A):A.isReady?R&&this.cachePolicy==="purge"&&this._hasReadyAncestor(P0,g)?RE.push(A):W$.push(A):R&&RE.push(A)}for(const T of W$)T.isReady&&rf.set(T.key.id,T);for(const T of RE)this._tileCache?this._tileCache.add(T):this.releaseTile(T),r.delete(T.key.id);for(const T of rf.values())this.tiles.push(T);for(const T of r.values())rf.has(T.key.id)||(T.visible=!1);this._tileCache?.prune(g,s,o),oW.pool.release(u),W$.length=0,RE.length=0,rf.clear()}clear(){const{tileIndex:e}=this;for(const n of e.values())this.releaseTile(n);e.clear()}refresh(e){for(const n of this.tileIndex.values())e(n);this._tileCache?.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,n){let r=e,i=null;for(;r=this.tileInfoView.getTileParentId(r),r;)if(this.tileIndex.has(r)){if(i=this.tileIndex.get(r),i?.isReady){n.has(i.key.id)||n.set(i.key.id,i);break}}else if(this._tileCache?.has(r)&&(i=this._tileCache.pop(r),this.tileIndex.set(r,i),i?.isReady)){n.has(i.key.id)||n.set(i.key.id,i);break}}_hasReadyAncestor(e,n){const r=pl();this.tileInfoView.getTileBounds(r,e,!0);for(const i of this.tileIndex.values())if(i.isReady&&i.key.level>=n&&i.key.level<e.level){const s=pl();if(this.tileInfoView.getTileBounds(s,i.key,!0),WVe(s,r))return!0}return!1}};const SQe={"area-measurement":null,dimension:null,"direct-line-measurement":null,"elevation-profile":()=>xe(()=>import("./ElevationProfileAnalysisView2D-ByFMsDzP.js"),__vite__mapDeps([388,28,29,30,254,382,55,6,56,57,62,7,8,389,331,390,391,392,393,394,395,104,396,397,398,399,400,199,200,35,36,401,66,402,101,403,404,218,152,205,206,214,256,150,405,191,227,235,213])),"line-of-sight":null,slice:null,viewshed:null,"volume-measurement":null};function TQe(t){const e=SQe[t.type];if(!e)throw new Xe("analysis-view-module-import-utils:analysis-not-supported",`Analysis "${t.type}" is not supported`);return e()}let kQe=class{constructor(e,n={}){this.events=new d8e,this._hasMajorPerformanceCaveat=!1,this._lastRenderFrameCounter=0,e!=null?(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform"),e.contains(this._canvas)||e.appendChild(this._canvas)):n.canvas!=null&&(this._canvas=n.canvas);const r={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};let i=this._canvas.getContext("webgl2",r);i||(i=this._canvas.getContext("webgl2",{...r,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0),this._gl=i,this._handles=rv([B2(this._canvas,"webglcontextlost",s=>this.events.emit("webgl-context-lost",s))])}destroy(){this._canvas.remove(),this._canvas=null,this._handles.remove(),this._gl=null}get gl(){return this._gl}get canvas(){return this._canvas}render(e,n){if(this._hasMajorPerformanceCaveat||ve("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=ve("esri-performance-mode-frames-between-render")&&(n(),this._lastRenderViewState=e.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const[r,i,s,o,a,l]=this._computeViewTransform(this._lastRenderViewState,e.state);this._canvas.style.transform=`matrix(${r}, ${i}, ${s}, ${o}, ${a}, ${l})`}}else n()}resize(e){const n=this._canvas,r=n.style,{state:{size:i},pixelRatio:s}=e,o=i[0],a=i[1],l=Math.round(o*s),c=Math.round(a*s);n.width===l&&n.height===c||(n.width=l,n.height=c),r.width=o+"px",r.height=a+"px"}_computeViewTransform(e,n){const[r,i]=e.center,[s,o]=n.center,[a,l]=e.toScreen([0,0],s,o),[c,u]=e.toScreen([0,0],r,i),h=c-a,f=u-l,g=e.scale/n.scale,v=n.rotation-e.rotation,x=gd();return b1e(x),MO(x,x,[g,g]),wI(x,x,cI(v)),_2(x,x,[h,f]),x}};function AQe(t,e,n,r,i){pve(t,e,n||0,r||t.length-1,i||IQe)}function pve(t,e,n,r,i){for(;r>n;){if(r-n>600){var s=r-n+1,o=e-n+1,a=Math.log(s),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1);pve(t,e,Math.max(n,Math.floor(e-o*l/s+c)),Math.min(r,Math.floor(e+(s-o)*l/s+c)),i)}var u=t[e],h=n,f=r;for(PE(t,n,e),i(t[r],u)>0&&PE(t,n,r);h<f;){for(PE(t,h,f),h++,f--;i(t[h],u)<0;)h++;for(;i(t[f],u)>0;)f--}i(t[n],u)===0?PE(t,n,f):PE(t,++f,r),f<=e&&(n=f+1),e<=f&&(r=f-1)}}function PE(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function IQe(t,e){return t<e?-1:t>e?1:0}function q4(t,e){if(!(this instanceof q4))return new q4(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function RQe(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function x_(t,e){SS(t,0,t.children.length,e,t)}function SS(t,e,n,r,i){i||(i=nx(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],TS(i,t.leaf?r(s):s);return i}function TS(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Xne(t,e){return t.minX-e.minX}function Zne(t,e){return t.minY-e.minY}function H$(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function WP(t){return t.maxX-t.minX+(t.maxY-t.minY)}function PQe(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function MQe(t,e){var n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function q$(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function HP(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function nx(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Jne(t,e,n,r,i){for(var s,o=[e,n];o.length;)(n=o.pop())-(e=o.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,AQe(t,s,e,n,i),o.push(e,s,s,n))}q4.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!HP(t,e))return n;for(var i,s,o,a,l=[];e;){for(i=0,s=e.children.length;i<s;i++)o=e.children[i],HP(t,a=e.leaf?r(o):o)&&(e.leaf?n.push(o):q$(t,a)?this._all(o,n):l.push(o));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!HP(t,e))return!1;for(var r,i,s,o,a=[];e;){for(r=0,i=e.children.length;r<i;r++)if(s=e.children[r],HP(t,o=e.leaf?n(s):s)){if(e.leaf||q$(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=nx([]),this},remove:function(t,e){if(t==null)return this;for(var n,r,i,s,o=this.data,a=this.toBBox(t),l=[],c=[];o||l.length;){if(o||(o=l.pop(),r=l[l.length-1],n=c.pop(),s=!0),o.leaf&&(i=RQe(t,o.children,e))!==-1)return o.children.splice(i,1),l.push(o),this._condense(l),this;s||o.leaf||!q$(o,a)?r?(n++,o=r.children[n],s=!1):o=null:(l.push(o),c.push(n),n=0,r=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:Xne,compareMinY:Zne,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,s=n-e+1,o=this._maxEntries;if(s<=o)return x_(i=nx(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,r-1))),(i=nx([])).leaf=!1,i.height=r;var a,l,c,u,h=Math.ceil(s/o),f=h*Math.ceil(Math.sqrt(o));for(Jne(t,e,n,f,this.compareMinX),a=e;a<=n;a+=f)for(Jne(t,a,c=Math.min(a+f-1,n),h,this.compareMinY),l=a;l<=c;l+=h)u=Math.min(l+h-1,c),i.children.push(this._build(t,l,u,r-1));return x_(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,s,o,a,l,c,u,h;r.push(e),!e.leaf&&r.length-1!==n;){for(u=h=1/0,i=0,s=e.children.length;i<s;i++)l=H$(o=e.children[i]),(c=PQe(t,o)-l)<h?(h=c,u=l<u?l:u,a=o):c===h&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),s=[],o=this._chooseSubtree(i,this.data,e,s);for(o.children.push(t),TS(o,i);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(i,s,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),o=nx(n.children.splice(s,n.children.length-s));o.height=n.height,o.leaf=n.leaf,x_(n,this.toBBox),x_(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,e){this.data=nx([t,e]),this.data.height=t.height+1,this.data.leaf=!1,x_(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,s,o,a,l,c,u;for(l=c=1/0,r=e;r<=n-e;r++)o=MQe(i=SS(t,0,r,this.toBBox),s=SS(t,r,n,this.toBBox)),a=H$(i)+H$(s),o<l?(l=o,u=r,c=a<c?a:c):o===l&&a<c&&(c=a,u=r);return u},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:Xne,i=t.leaf?this.compareMinY:Zne;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,s,o=this.toBBox,a=SS(t,0,e,o),l=SS(t,n-e,n,o),c=WP(a)+WP(l);for(i=e;i<n-e;i++)s=t.children[i],TS(a,t.leaf?o(s):s),c+=WP(a);for(i=n-e-1;i>=e;i--)s=t.children[i],TS(l,t.leaf?o(s):s),c+=WP(l);return c},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)TS(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)t[n].children.length===0?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():x_(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function CQe(t,{timeZone:e,timeExtent:n}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:n?.start,currentEnd:n?.end}}}}let Qne=class mve{constructor(e,n){this.key=new ib(0,0,0,0),this.bounds=pl(),this.objectIds=new Set,this.key.set(n);const r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.level=r.level,this.scale=r.scale,this.minScale=e.zoomToScale(r.level-1),this.maxScale=e.zoomToScale(r.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return UVe(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return CQe(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),n=Aa.acquire();for(let r=0;r<e.length;r++)n[r]=new mve(this.tileInfoView,e[r]);return n}getQuantizationParameters(){return Cm.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const M0={added:[],removed:[]},K$=new Set,NQe=new ib(0,0,0,0);function OQe(t,e){const n=La(e);if(!n)return null;const[r,i]=n.valid;return t[2]>i?[pl([t[0],t[1],i,t[3]]),pl([r,t[1],r+t[2]-i,t[3]])]:t[0]<r?[pl([r,t[1],t[2],t[3]]),pl([i-(r-t[0]),t[1],i,t[3]])]:null}let LQe=class extends Pfe{constructor(e){super(),this._tiles=new Map,this._index=q4(9,ve("esri-csp-restrictions")?n=>({minX:n.bounds[0],minY:n.bounds[1],maxX:n.bounds[2],maxY:n.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){super.destroy(),this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||dB(e)===0||fB(e)===0)return[];const n=OQe(e,this.tileScheme.spatialReference);return n!=null?[...new Set([...this.boundsIntersections(n[0]),...this.boundsIntersections(n[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const n={added:[],removed:[]};for(const r of e.added)if(!this.has(r)){const i=new Qne(this.tileScheme,r);this._tiles.set(r,i),this._index.insert(i),n.added.push(i)}for(const r of e.removed)if(this.has(r)){const i=this.get(r);this._tiles.delete(r),this._index.remove(i),n.removed.push(i)}this.tiles.length=0,this._tiles.forEach(r=>this.tiles.push(r)),(n.added.length||n.removed.length)&&this.emit("update",n)}setViewState(e){const n=this.tileScheme.getTileCoverage(e,0);if(!n)return;const{spans:r,lodInfo:i}=n,{level:s}=i;if(r.length>0)for(const{row:o,colFrom:a,colTo:l}of r)for(let c=a;c<=l;c++){const u=NQe.set(s,o,i.normalizeCol(c),i.getWorldForColumn(c)).id;if(K$.add(u),!this.has(u)){const h=new Qne(this.tileScheme,u);this._tiles.set(u,h),this._index.insert(h),this.tiles.push(h),M0.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];K$.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),M0.removed.push(a))}(M0.added.length||M0.removed.length)&&this.emit("update",M0),oW.pool.release(n),K$.clear(),M0.added.length=0,M0.removed.length=0}};const Z4t=1e-30,ere=512,qP=16777216,J4t=8,Q4t=29,eNt=24,tNt=4,nNt=0,rNt=0,iNt=0,sNt=1,oNt=2,aNt=3,lNt=4,cNt=5,uNt=6,hNt=12,dNt=13,fNt=5,DQe=6,pNt=5,mNt=6,gve=6,$Qe=1<<gve,gNt=$Qe<<1,yNt=1.05,vNt=3,_Nt=1,xNt=3,wNt=3,bNt=5,ENt=6,SNt=1.15,jQe=4,TNt=128,FQe=256,kNt=FQe-2*jQe,ANt=2,INt=128,RNt=1,PNt=10,MNt=1024,CNt=128,NNt=4,ONt=1,LNt=1<<20,DNt=.75,$Nt=10,jNt=.75,FNt=256,VNt=32,zNt=512,UNt=0,GNt=1,VQe=1,BNt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],WNt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ME=256,zQe=()=>St.getLogger("esri.views.webgl.checkWebGLError");function yve(t){switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const vve=!!ve("enable-feature:webgl-debug");function _ve(){return vve}function HNt(){return vve}function C0(t,e=_ve()){if(e){const n=yve(t);if(n){const r=new Error().stack;zQe().error(new Xe("webgl-error","WebGL error occurred",{message:n,stack:r}))}}}const qNt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},N0={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,HALF_FLOAT:5131},Gt={RGBA4:32854,R16F:33325,RG16F:33327,RGB32F:34837,RGBA16F:34842,R32F:33326,RG32F:33328,RGBA32F:34836,R11F_G11F_B10F:35898,RGB8:32849,RGBA8:32856,RGB5_A1:32855,R8:33321,RG8:33323,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,RGB16F:34843,RGB9_E5:35901,SRGB8:35905,SRGB8_ALPHA8:35907,RGB565:36194,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2:32857,RGB10_A2UI:36975},UQe=Object.values(Gt),K4={DEPTH24_STENCIL8:35056,DEPTH32F_STENCIL8:36013},_T={DEPTH_COMPONENT16:33189,DEPTH_COMPONENT24:33190,DEPTH_COMPONENT32F:36012},cV={FLOAT:N0.FLOAT,UNSIGNED_BYTE:N0.UNSIGNED_BYTE,UNSIGNED_INT_24_8:34042,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,BYTE:N0.BYTE,UNSIGNED_SHORT:N0.UNSIGNED_SHORT,SHORT:N0.SHORT,UNSIGNED_INT:N0.UNSIGNED_INT,INT:N0.INT,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269},KNt=33984,tre={Texture:0,TileTexture:1,BufferObject:2,VertexArrayObject:3,Shader:4,Program:5,FramebufferObject:6,Renderbuffer:7,TransformFeedback:8,Sync:9,UNCOUNTED:10,LinesOfCode:10,Uniform:11,COUNT:12},YNt=1029,XNt=0,ZNt=36064,JNt=36065,QNt=36066,e5t=36067,t5t=33306,n5t=36096,r5t=36128,qo={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497};function i5t(t,e,n,r=0){const i=t.gl;t.bindBuffer(n);for(const s of n.layout){const o=e.get(s.name);if(o==null){console.warn(`There is no location for vertex attribute '${s.name}' defined.`);continue}const a=r*s.stride;if(s.count<=4)i.vertexAttribPointer(o,s.count,s.type,s.normalized,s.stride,s.offset+a),i.enableVertexAttribArray(o),s.divisor>0&&i.vertexAttribDivisor(o,s.divisor);else if(s.count===9)for(let l=0;l<3;l++)i.vertexAttribPointer(o+l,3,s.type,s.normalized,s.stride,s.offset+12*l+a),i.enableVertexAttribArray(o+l),s.divisor>0&&i.vertexAttribDivisor(o+l,s.divisor);else if(s.count===16)for(let l=0;l<4;l++)i.vertexAttribPointer(o+l,4,s.type,s.normalized,s.stride,s.offset+16*l+a),i.enableVertexAttribArray(o+l),s.divisor>0&&i.vertexAttribDivisor(o+l,s.divisor);else console.error("Unsupported vertex attribute element count: "+s.count);if(_ve()){const l=yve(t.gl);l&&console.error(`Unable to bind vertex attribute "${s.name}" with baseInstanceOffset ${a}:`,l,s)}}}function s5t(t){switch(t){case 6406:case 6409:case 6403:case 36244:case 6402:case 34041:return 1;case 6410:case 33319:case 33320:return 2;case 6407:case 36248:return 3;case 6408:case 36249:return 4}return 0}function GQe(t){switch(t){case 6406:case 6409:case 6403:case 36244:case Gt.R8:case Gt.R8I:case Gt.R8UI:case Gt.R8_SNORM:case 36168:return 1;case 6410:case 33319:case 33320:case Gt.RGBA4:case Gt.R16F:case Gt.R16I:case Gt.R16UI:case Gt.RG8:case Gt.RG8I:case Gt.RG8UI:case Gt.RG8_SNORM:case Gt.RGB565:case Gt.RGB5_A1:case _T.DEPTH_COMPONENT16:return 2;case 6407:case 36248:case Gt.RGB8:case Gt.RGB8I:case Gt.RGB8UI:case Gt.RGB8_SNORM:case Gt.SRGB8:case _T.DEPTH_COMPONENT24:return 3;case 6408:case 36249:case Gt.RGBA8:case Gt.R32F:case Gt.R11F_G11F_B10F:case Gt.RG16F:case Gt.R32I:case Gt.R32UI:case Gt.RG16I:case Gt.RG16UI:case Gt.RGBA8I:case Gt.RGBA8UI:case Gt.RGBA8_SNORM:case Gt.SRGB8_ALPHA8:case Gt.RGB9_E5:case Gt.RGB10_A2UI:case Gt.RGB10_A2:case _T.DEPTH_COMPONENT32F:case K4.DEPTH24_STENCIL8:return 4;case K4.DEPTH32F_STENCIL8:return 5;case Gt.RGB16F:case Gt.RGB16I:case Gt.RGB16UI:return 6;case Gt.RG32F:case Gt.RG32I:case Gt.RG32UI:case Gt.RGBA16F:case Gt.RGBA16I:case Gt.RGBA16UI:return 8;case Gt.RGB32F:case Gt.RGB32I:case Gt.RGB32UI:return 12;case Gt.RGBA32F:case Gt.RGBA32I:case Gt.RGBA32UI:return 16;case qo.COMPRESSED_RGB_S3TC_DXT1_EXT:case qo.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case qo.COMPRESSED_RGBA_S3TC_DXT3_EXT:case qo.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case qo.COMPRESSED_R11_EAC:case qo.COMPRESSED_SIGNED_R11_EAC:case qo.COMPRESSED_RGB8_ETC2:case qo.COMPRESSED_SRGB8_ETC2:case qo.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case qo.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case qo.COMPRESSED_RG11_EAC:case qo.COMPRESSED_SIGNED_RG11_EAC:case qo.COMPRESSED_RGBA8_ETC2_EAC:case qo.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let xve=class{constructor(e=0,n=e){this.width=e,this.height=n,this.type=0,this.target=3553,this.pixelFormat=6408,this.dataType=cV.UNSIGNED_BYTE,this.samplingMode=9729,this.wrapMode=10497,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.compareEnabled=!1,this.linearFilterDepth=!1,this.depth=1,this.isImmutable=!1}};function BQe(t){return t.width<=0||t.height<=0||t.depth<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:GQe(t.internalFormat))*(t.target===34067?6:1))}const CE=()=>St.getLogger("esri/views/webgl/textureUtils");function NE(t){const{width:e,height:n,depth:r}=t;(e!=null&&e<0||n!=null&&n<0||r!=null&&r<0)&&CE().error("Negative dimension parameters are not allowed!");const{internalFormat:i}=t;if(i&&(wve(i)||bve(i))){const{linearFilterDepth:s,compareEnabled:o,samplingMode:a,hasMipmap:l}=t;l&&CE().error("Depth textures cannot have mipmaps"),s?a!==9729&&a!==9728&&CE().error("Depth textures cannot sample mipmaps"):(a!==9728&&CE().error("Depth textures without filtering must use NEAREST filtering"),o&&CE().error("Depth textures without filtering cannot use compare function"))}}function WQe(t){return UQe.includes(t)}function wve(t){return K5(_T,t)}function bve(t){return K5(K4,t)}function HQe(t){return t!=null&&K5(qo,t)}function rx(t){return t!=null&&"type"in t&&t.type==="compressed"}function qQe(t){return t!=null&&"byteLength"in t}function nre(t){return t!=null&&!rx(t)&&!qQe(t)}function w_(t){return t===32879||t===35866}function rre(t,e,n,r=1){let i=Math.max(e,n);return t===32879&&(i=Math.max(i,r)),Math.floor(Math.log2(i))+1}function KP(t){if(t.internalFormat!=null)return t.internalFormat;switch(t.dataType){case cV.FLOAT:switch(t.pixelFormat){case 6408:return Gt.RGBA32F;case 6407:return Gt.RGB32F;default:throw new Xe("texture:unknown-format","Unable to derive format")}case cV.UNSIGNED_BYTE:switch(t.pixelFormat){case 6408:return Gt.RGBA8;case 6407:return Gt.RGB8}}const{pixelFormat:e}=t;return t.internalFormat=e===34041?K4.DEPTH24_STENCIL8:e===6402?_T.DEPTH_COMPONENT24:e,t.internalFormat}function KQe(t){let e="width"in t?t.width:t.codedWidth,n="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,n=t.videoHeight),{width:e,height:n,depth:1}}let YQe=class Eve extends xve{constructor(e,n){switch(super(),this.context=e,Object.assign(this,n),this.internalFormat){case Gt.R16F:case Gt.R32F:case Gt.R8_SNORM:case Gt.R8:this.pixelFormat=6403;break;case Gt.R8I:case Gt.R8UI:case Gt.R16I:case Gt.R16UI:case Gt.R32I:case Gt.R32UI:this.pixelFormat=36244}}static validate(e,n){return new Eve(e,n)}};const XQe=!!ve("esri-tests-disable-gpu-memory-measurements"),sf=()=>St.getLogger("esri/views/webgl/Texture");var ys;let ZQe=(ys=class{constructor(e,n=null,r=null){if(this.type=1,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._shadowFilterDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,r=n;else{const i=YQe.validate(e,n);if(!i)throw new Xe("texture:invalid-descriptor","Texture descriptor invalid");this._descriptor=i}this._descriptor.target===34067?this._setDataCubeMap(r):this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return XQe?0:BQe(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty||this._shadowFilterDirty}get hasWebGLTextureObject(){return!!this._glName}dispose(){this.abortCompression(),this.hasWebGLTextureObject&&this._descriptor.context?.gl&&(this._descriptor.context.instanceCounter.decrement(tre.Texture,this),this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null,this._descriptor=null)}release(){this.dispose()}[Symbol.dispose](){this.dispose()}resize(e,n){const r=this._descriptor;if(r.width!==e||r.height!==n){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-resize","Immutable textures can't be resized!");r.width=e,r.height=n,this._descriptor.target===34067?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.compress=e}disableCompression(){this._descriptor.compress=void 0}setData(e){this.abortCompression(),!rx(e)&&this._descriptor.internalFormat&&K5(qo,this._descriptor.internalFormat)&&(this._descriptor.internalFormat=void 0),this._setData(e),!rx(e)&&this._descriptor.compress&&this._compressOnWorker(e)}updateData(e,n,r,i,s,o,a=0){o||sf().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||sf().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=KP(l);const{context:c,pixelFormat:u,dataType:h,target:f,isImmutable:g}=l;if(g&&!this._wasImmutablyAllocated)throw new Xe("texture:uninitialized","Cannot update immutable texture before allocation!");const v=c.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES,!0);(n<0||r<0||n+i>l.width||r+s>l.height)&&sf().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:x}=c;a&&(i&&s||sf().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),x.pixelStorei(x.UNPACK_SKIP_ROWS,a)),nre(o)?x.texSubImage2D(f,e,n,r,i,s,u,h,o):rx(o)?x.compressedTexSubImage2D(f,e,n,r,i,s,l.internalFormat,o.levels[e]):x.texSubImage2D(f,e,n,r,i,s,u,h,o),a&&x.pixelStorei(x.UNPACK_SKIP_ROWS,0),c.bindTexture(v,ys.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,n,r,i,s,o,a,l){l||sf().error("An attempt to use uninitialized data!"),this.hasWebGLTextureObject||sf().error("An attempt to update an uninitialized texture!");const c=this._descriptor;c.internalFormat=KP(c);const{context:u,pixelFormat:h,dataType:f,isImmutable:g,target:v}=c;if(g&&!this._wasImmutablyAllocated)throw new Xe("texture:uninitialized","Cannot update immutable texture before allocation!");w_(v)||sf().warn("Attempting to set 3D texture data on a non-3D texture");const x=u.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES);u.setActiveTexture(ys.TEXTURE_UNIT_FOR_UPDATES),(n<0||r<0||i<0||n+s>c.width||r+o>c.height||i+a>c.depth)&&sf().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:b}=u;if(rx(l))l=l.levels[e],b.compressedTexSubImage3D(v,e,n,r,i,s,o,a,c.internalFormat,l);else{const T=l;b.texSubImage3D(v,e,n,r,i,s,o,a,h,f,T)}u.bindTexture(x,ys.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-change","Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,NE(e)}e.samplingMode===9729?(this._samplingModeDirty=!0,e.samplingMode=9985):e.samplingMode===9728&&(this._samplingModeDirty=!0,e.samplingMode=9984);const n=this._descriptor.context.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(ys.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(n,ys.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new Xe("texture:immutable-change","Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,NE(e)}e.samplingMode===9985?(this._samplingModeDirty=!0,e.samplingMode=9729):e.samplingMode===9984&&(this._samplingModeDirty=!0,e.samplingMode=9728)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,NE(this._descriptor),this._wrapModeDirty=!0)}setShadowFiltering(e){e!==this._descriptor.linearFilterDepth&&(this._descriptor.linearFilterDepth=this._descriptor.compareEnabled=e,this.setSamplingMode(e?9729:9728),NE(this._descriptor),this._shadowFilterDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1),this._shadowFilterDirty&&(this._applyShadowMode(),this._shadowFilterDirty=!1)}abortCompression(){this._compressionAbortController=R1(this._compressionAbortController)}_setData(e,n){const r=this._descriptor,i=r.context?.gl;if(!i)return;C0(i),this.hasWebGLTextureObject||(this._glName=i.createTexture(),r.context.instanceCounter.increment(tre.Texture,this)),NE(r);const s=r.context.bindTexture(this,ys.TEXTURE_UNIT_FOR_UPDATES);r.context.setActiveTexture(ys.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),C0(i);const o=n??r.target,a=w_(o);if(nre(e))this._setDataFromTexImageSource(e,o);else{const{width:l,height:c,depth:u}=r;if(l==null||c==null)throw new Xe("texture:missing-size","Width and height must be specified!");if(a&&u==null)throw new Xe("texture:missing-depth","Depth must be specified!");if(r.internalFormat=KP(r),r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,r.internalFormat,r.hasMipmap,l,c,u),rx(e)){if(!HQe(r.internalFormat))throw new Xe("texture:format-mismatch","Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,r.internalFormat,o)}else this._texImage(o,0,r.internalFormat,l,c,u,e),C0(i),r.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),this._applyShadowMode(),C0(i),r.context.bindTexture(s,ys.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let n=34069;n<=34074;n++)this._setData(e,n)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:n,flipped:r,preMultiplyAlpha:i}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,n),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i?1:0)}_setDataFromTexImageSource(e,n){const{gl:r}=this._descriptor.context,i=this._descriptor;i.internalFormat=KP(i);const s=w_(n),{width:o,height:a,depth:l}=KQe(e);i.width&&i.height,i.width||(i.width=o),i.height||(i.height=a),s&&i.depth,s&&(i.depth=l),i.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(n,i.internalFormat,i.hasMipmap,o,a,l),this._texImage(n,0,i.internalFormat,o,a,l,e),C0(r),i.hasMipmap&&(this.generateMipmap(),C0(r))}_setDataFromCompressedSource(e,n,r){const i=this._descriptor,{width:s,height:o,depth:a}=i,l=e.levels,c=rre(r,s,o,a),u=Math.min(c,l.length)-1;this._descriptor.context.gl.texParameteri(i.target,33085,u),this._forEachMipmapLevel((h,f,g,v)=>{const x=l[Math.min(h,l.length-1)];this._compressedTexImage(r,h,n,f,g,v,x)},u)}_texStorage(e,n,r,i,s,o){const{gl:a}=this._descriptor.context;if(!WQe(n)&&!wve(n)&&!bve(n))throw new Xe("texture:missing-format","Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=r?rre(e,i,s,o):1;if(w_(e)){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,n,i,s,o)}else a.texStorage2D(e,l,n,i,s);this._wasImmutablyAllocated=!0}_texImage(e,n,r,i,s,o,a){const l=this._descriptor.context.gl,c=w_(e),{isImmutable:u,pixelFormat:h,dataType:f}=this._descriptor;if(u){if(a!=null){const g=a;if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texSubImage3D(e,n,0,0,0,i,s,o,h,f,g)}else l.texSubImage2D(e,n,0,0,i,s,h,f,g)}}else{const g=a;if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.texImage3D(e,n,r,i,s,o,0,h,f,g)}else l.texImage2D(e,n,r,i,s,0,h,f,g)}}_compressedTexImage(e,n,r,i,s,o,a){const l=this._descriptor.context.gl,c=w_(e);if(this._descriptor.isImmutable){if(a!=null)if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,n,0,0,0,i,s,o,r,a)}else l.compressedTexSubImage2D(e,n,0,0,i,s,r,a)}else if(c){if(o==null)throw new Xe("texture:missing-depth","Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,n,r,i,s,o,0,a)}else l.compressedTexImage2D(e,n,r,i,s,0,a)}async _compressOnWorker(e){const{width:n,height:r,context:i,flipped:s,preMultiplyAlpha:o,hasMipmap:a}=this._descriptor,l=this._descriptor.compress?.compressionTracker,c=this._descriptor.compress?.compressionCallback,{compressedTextureETC:u,compressedTextureS3TC:h}=i.capabilities;if(!ys.compressionWorkerHandle?.isCompressible(e,this._descriptor)||!u&&!h)return;this.abortCompression();const f=new AbortController;let g;this._compressionAbortController=f,l?.increment();try{e instanceof Uint8Array?g=e.buffer:(g=await createImageBitmap(e,{imageOrientation:s?"flipY":"none"}),hi(f));const v={data:g,width:n,height:r,needsFlip:e instanceof Uint8Array&&this.descriptor.flipped,components:this._descriptor.pixelFormat===6408?4:3,preMultiplyAlpha:o,hasMipmap:a,hasETC:!!u,hasS3TC:!!h},x=await ys.compressionWorkerHandle.invoke(v,f.signal,"low");if(hi(f),x.compressedTexture&&this.hasWebGLTextureObject){const b=this.usedMemory;this._descriptor.internalFormat=x.internalFormat,this._setData(x.compressedTexture),c?.(b-this.usedMemory)}}catch(v){ya(v)||sf().error("Texture compression failed!")}finally{l?.decrement(),this._compressionAbortController?.signal.aborted&&(this._compressionAbortController=null),g instanceof ImageBitmap&&g.close()}}_forEachMipmapLevel(e,n=1/0){let{width:r,height:i,depth:s,hasMipmap:o,target:a}=this._descriptor;const l=a===32879;if(r==null||i==null||l&&s==null)throw new Xe("texture:missing-size","Missing texture dimensions for mipmap calculation");for(let c=0;e(c,r,i,s),o&&(r!==1||i!==1||l&&s!==1)&&!(c>=n);++c)r=Math.max(1,r>>1),i=Math.max(1,i>>1),l&&(s=Math.max(1,s>>1))}_applySamplingMode(){const e=this._descriptor,n=e.context?.gl;let r=e.samplingMode,i=e.samplingMode;r===9985||r===9987?(r=9729,e.hasMipmap||(i=9729)):r!==9984&&r!==9986||(r=9728,e.hasMipmap||(i=9728)),n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,r),n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,i)}_applyWrapMode(){const e=this._descriptor,n=e.context?.gl;typeof e.wrapMode=="number"?(n.texParameteri(e.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,e.wrapMode)):(n.texParameteri(e.target,n.TEXTURE_WRAP_S,e.wrapMode.s),n.texParameteri(e.target,n.TEXTURE_WRAP_T,e.wrapMode.t))}_applyShadowMode(){const e=this._descriptor,n=e.context?.gl,r=e.compareEnabled?n.COMPARE_REF_TO_TEXTURE:n.NONE;n.texParameteri(e.target,n.TEXTURE_COMPARE_MODE,r),e.compareEnabled&&n.texParameteri(e.target,n.TEXTURE_COMPARE_FUNC,n.GREATER),C0(n)}_applyAnisotropicFilteringParameters(){const e=this._descriptor,n=e.context.capabilities.textureFilterAnisotropic;n&&e.context.gl.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}},ys.TEXTURE_UNIT_FOR_UPDATES=0,ys.compressionWorkerHandle=null,ys);const Y$=()=>St.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function JQe(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const QQe=[0,0,0,0];let Sve=class{constructor(){this.type="single",this._highlightOptions=new yg,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*ME),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,n){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,DQe),n.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<gve)-1,activeGradient:this}]}_updateGradientTexture(e){const n=eet(this._highlightOptions);if(n===this._optionsShadeTexKey)return;this._optionsShadeTexKey=n,JQe(this._highlightOptions,this._convertedHighlightOptions);const r=this._convertedHighlightOptions,i=r.outlinePosition-r.outlineWidth/2-r.outerHaloWidth,s=r.outlinePosition-r.outlineWidth/2,o=r.outlinePosition+r.outlineWidth/2,a=r.outlinePosition+r.outlineWidth/2+r.innerHaloWidth,l=Math.sqrt(Math.PI/2)*VQe,c=Math.abs(i)>l?Math.round(10*(Math.abs(i)-l))/10:0,u=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let h;c&&!u?Y$().error("The outer rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!c&&u?Y$().error("The inner rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):c&&u&&Y$().error("The highlight is "+Math.max(c,u)+"px away from the edge of the feature; consider reducing some width values.");const f=[void 0,void 0,void 0,void 0];function g(x,b,T){f[0]=(1-T)*x[0]+T*b[0],f[1]=(1-T)*x[1]+T*b[1],f[2]=(1-T)*x[2]+T*b[2],f[3]=(1-T)*x[3]+T*b[3]}const{_texelData:v}=this;for(let x=0;x<ME;++x)h=i+x/(ME-1)*(a-i),h<i?(f[0]=0,f[1]=0,f[2]=0,f[3]=0):h<s?g(QQe,r.outlineColor,(h-i)/(s-i)):h<o?[f[0],f[1],f[2],f[3]]=r.outlineColor:h<a?g(r.outlineColor,r.fillColor,(h-o)/(a-o)):[f[0],f[1],f[2],f[3]]=r.fillColor,v[4*x]=255*f[0],v[4*x+1]=255*f[1],v[4*x+2]=255*f[2],v[4*x+3]=255*f[3];if(this._minMaxDistance[0]=i,this._minMaxDistance[1]=a,!this._shadeTex){const x=new xve(ME,1);x.wrapMode=33071,this._shadeTex=new ZQe(e,x)}this._shadeTex.updateData(0,0,0,ME,1,this._texelData)}};function eet(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let tet=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let n=0;n<e.length;n++)this.gradients[n]||(this.gradients[n]=new Sve),this.gradients[n].setHighlightOptions(e[n]);for(let n=e.length+1;n<this.gradients.length;n++)this.gradients[n].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const n=[];for(let r=0;r<this.gradients.length;r++){const i=this.gradients[r];n.push({activeReasons:e,activeGradient:i}),e<<=1}return n}};const Tve={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},net={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},ret={...Tve,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function iet({pixelRatio:t,state:e,displayLevel:n,requiredLevel:r},i){const s=1/2**(n-i.key.level),o=1/2**(r-i.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:i.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:i.transforms.tileMat3,displayZoomFactor:s,requiredZoomFactor:o,tileOffset:[i.x,i.y],currentScale:e.scale,currentZoom:n,metersPerSRUnit:Dd(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function kve(t){return t.passOptions?.type==="highlight"}function Ave(t){return t.passOptions?.type==="hittest"}function set(t){if(!Ave(t))return null;const{position:e,distance:n,smallSymbolDistance:r,smallSymbolSizeThreshold:i}=t.passOptions;return{position:e,distance:n,smallSymbolDistance:r,smallSymbolSizeThreshold:i}}function oet(t){if(!kve(t))return null;const{activeReasons:e,highlightAll:n}=t.passOptions;return{activeReasons:e,highlightAll:n?1:0}}function c5t(t,e,n){const r={};for(const i in n)typeof n[i]!="function"?r[i]=n[i]:r[i]=n[i](t,e);return r}function u5t(t,e){const{attributeView:n,context:r}=t;return{storage:n.getUniforms(r),view:iet(t,e),hittestRequest:set(t),highlight:oet(t)}}function h5t(t){return{inside:t.selection===2,outside:t.selection===3}}function aet(t){return Ave(t)?net:kve(t)&&t.passOptions.stepType==="clear"?ret:Tve}function d5t(t){const{row:e,col:n}=t.key,r=n*ere,i=e*ere;return{tileOffsetFromLocalOrigin:[r%qP,i%qP],maxIntsToLocalOrigin:[Math.floor(r/qP),Math.floor(i/qP)]}}const cet=new Gs({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function f5t(t){return cet.toJSON(t)}function p5t(t){const{bandCount:e,attributeTable:n,colormap:r,pixelType:i}=t.raster.rasterInfo;return e===1&&(n!=null||r!=null||i==="u8"||i==="s8")}function uet(t,e){return e==null?(t?.destroy(),null):(t?.type==="single"&&Array.isArray(e)&&(t.destroy(),t=null),t?.type!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new tet:new Sve),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function m5t(t,e,n,r){const{painter:i,highlightGradient:s}=t,{highlight:o}=i.effects;if(!s)return;const a=t.passOptions,l=s.getReasonsWithGradients();for(let c=0;c<l.length;c++){const u={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(u),n(u),c<l.length-1){let f=0;for(let g=c+1;g<l.length;g++)f|=l[g].activeReasons;n({...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:f,stepType:"clear",highlightAll:e}})}const h={...t,passOptions:{type:"highlight",activeGradient:l[c].activeGradient,activeReasons:l[c].activeReasons,stepType:"draw",highlightAll:e}};i.setPipelineState(aet(t)),i.updatePipelineState(t.context),o.draw(h),o.unbind()}t.passOptions=a}const YP=t=>parseFloat(t)/100;function het(t,e,n){const r=typeof t.left=="string"?YP(t.left)*e:t.left,i=typeof t.right=="string"?YP(t.right)*e:t.right,s=typeof t.top=="string"?YP(t.top)*n:t.top,o=typeof t.bottom=="string"?YP(t.bottom)*n:t.bottom,a=s;return{xmin:r,xmax:Math.max(e-i,r),ymin:a,ymax:Math.max(n-o,s)}}function Ive(t,e,n,r){switch(e.type){case"rect":{const{width:i,height:s}=t,{xmin:o,xmax:a,ymin:l,ymax:c}=het(e,i,s),{x:u,y:h}=n;return u>o&&u<a&&h>l&&h<c}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||HG(e.path,[n.x,n.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?WG(e.geometry,r):iI(e.geometry,r))}}function det(t){if(!t.highlights)return null;const e=t.highlights.findIndex(n=>n.name==="default");return e===-1?null:t.highlights.items[e]}function fet(t,e){if(!t.highlights){if(!e)return;t.highlights=new Ot([new yg])}const n=t.highlights.findIndex(r=>r.name==="default");e?t.highlights.items[n].assignFrom(e):(t.highlights.removeAt(n),t.highlights.length===0&&(t.highlights=null))}async function pet(t,e,n){const r=c1e(e)?l1e(t,e):e;if(!t.ready||isNaN(r.x)||isNaN(r.y))return{screenPoint:r,results:[]};let i=new Set;const s=new Set;let o=!1,a=null,l=null;n?.include?sre(n.include,ire(t,f=>{i.add(f),X$(f,g=>s.add(g))},(f,g)=>{s.add(f),i.add(g)},f=>{a||(a=new Set),a.add(f)},f=>i.add(f),()=>o=!0)):(o=!0,i=new Set(t.allLayerViews),i.forEach(f=>{X$(f,g=>s.add(g))})),n?.exclude&&sre(n.exclude,ire(t,f=>{i.delete(f),X$(f,g=>s.delete(g))},f=>s.delete(f),f=>{l||(l=new Set),l.add(f)}));const c=t.toMap(r),u=t.allLayerViews.filter(f=>!f.suspended&&i.has(f)&&f.clips.every(g=>Ive(t,g,r,c))).reverse();let h=[...o?t.graphicsView.hitTest(c).map(f=>({type:"graphic",graphic:f,layer:null,mapPoint:c})):[],...await Promise.all(u.map(f=>f.hitTest(c,r)).toArray())].filter(e2).flat().filter(e2);return h=h.filter(f=>f.type!=="graphic"||f.layer?.type!=="subtype-group"||s.has(f.graphic.layer)),a&&(h=h.filter(f=>!("graphic"in f)||!f.graphic||a?.has(uV(f.graphic)))),l&&(h=h.filter(f=>!("graphic"in f)||!f.graphic||!l?.has(uV(f.graphic)))),{screenPoint:r,results:h}}function ire(t,e,n,r,i,s){return o=>{if(o instanceof Yo){if(o.layer===t)s?.();else{const a=t.allLayerViews.find(l=>l.layer===o.layer);a&&i?.(a)}r(uV(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(l=>l.layer===o.parent);a&&n(o,a)}else{const a=t.allLayerViews.find(l=>l.layer===o);a&&e(a)}}}function sre(t,e){if(t)if(i4(t))for(const n of t)if(i4(n))for(const r of n)e(r);else e(n);else e(t)}function uV(t){const e=t.getObjectId();return e?`${t.layer?.uid??t.sourceLayer?.uid??"MapView"}/${e}`:`"MapView/${t.uid}`}function X$(t,e){const n=t.layer;n?.type==="subtype-group"&&n.sublayers.forEach(r=>{e(r)})}let OE=null,Y4=!0;function met(t,e,n){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(Y4)try{return new ImageData(t,e)}catch{Y4=!1}return Rve(t,e,n)}function g5t(t,e,n,r){if(!e||!n)throw new Error("Cannot construct image data without dimensions");if(Y4)try{return new ImageData(t,e,n)}catch{Y4=!1}const i=Rve(e,n,r);return i.data.set(t,0),i}function get(){return OE||(OE=document.createElement("canvas"),OE.width=1,OE.height=1),OE}function Rve(t,e,n){return n||(n=get()),n.getContext("2d").createImageData(t,e)}async function yet(t,e){const n=window.URL.createObjectURL(t);try{const{data:r}=await Ji(n,{...e,responseType:"image"});return r}catch(r){throw ya(r)?r:new Xe("invalid-image",`Could not fetch requested image at ${n}`)}finally{window.URL.revokeObjectURL(n)}}async function y5t(t,e){const{arrayBuffer:n,mediaType:r}=await vet(t,e),i=r==="image/png";if(r==="image/gif"){const{isAnimatedGIF:s,parseGif:o}=await xe(()=>import("./gif-DsVADOG5.js"),[]);if(s(n))return o(n,e)}if(i){const{isAnimatedPNG:s,parseApng:o}=await xe(()=>import("./apng-CwEgiEAO.js"),__vite__mapDeps([406,26]));if(s(n))return o(n,e)}return yet(new Blob([n],{type:r}),e)}async function vet(t,e){const n=t2(t);if(n?.isBase64)return{arrayBuffer:gde(n.data),mediaType:n.mediaType};const r=await Ji(t,{responseType:"array-buffer",...e});return{arrayBuffer:r.data,mediaType:r.getHeader?.("Content-Type")??""}}function Pve(t,e,n){const{ctx:r,canvas:i}=Cve(t,n),s=r.getImageData(0,0,t.width,t.height),o=Ove(i,e);return Nve(i),{dataUrl:o,data:s}}function Mve(t,e){const{ctx:n,canvas:r}=Cve(t,e),i=n.getImageData(0,0,t.width,t.height);return Nve(r),i}function Cve(t,e){const n=_et();e.premultipliedAlpha&&Eet(t),n.width=t.width,n.height=t.height;const r=n.getContext("2d",{willReadFrequently:!0});return r.putImageData(t,0,0),e.flipY&&bet(r),{ctx:r,canvas:n}}function Nve(t){t.width=0,t.height=0}function _et(){return Z$==null&&(Z$=document.createElement("canvas")),Z$}let Z$=null;function Ove(t,e){const n=Tet[e.format],r=e.quality/100;return t.toDataURL(n,r)}function Lve(t,e){const n=wet(t),r=Aet[n];return{format:n,quality:cu(e??r,0,100)}}function Dve(t,e){return e/Math.max(t[0],t[1])}function xet(t,e,n,r=0,i=0,s=t.width-r,o=t.height-i,a=!1){const{data:l}=t,{width:c,height:u,data:h}=e,f=s/c,g=o/u,v=Math.ceil(f/2),x=Math.ceil(g/2),b=t.width;for(let T=0;T<u;T++)for(let A=0;A<c;A++){const I=4*(A+(a?u-T-1:T)*c);let R=0,C=0,V=0,M=0,N=0,O=0;const F=(T+.5)*g;for(let L=Math.floor(T*g);L<(T+1)*g;L++){const B=Math.abs(F-(L+.5))/x,U=(A+.5)*f,de=B*B;for(let me=Math.floor(A*f);me<(A+1)*f;me++){const ze=Math.abs(U-(me+.5))/v,Le=Math.sqrt(de+ze*ze);if(Le>=1)continue;let fe=2*Le*Le*Le-3*Le*Le+1;const $e=4*(r+me+(i+L)*b);O+=fe*l[$e+3],C+=fe,!n&&l[$e+3]<255&&(fe=fe*l[$e+3]/255),V+=fe*l[$e],M+=fe*l[$e+1],N+=fe*l[$e+2],R+=fe}}h[I]=V/R,h[I+1]=M/R,h[I+2]=N/R,h[I+3]=O/C}return e}function wet(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return ket}}function bet(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function Eet(t){const e=t.data,n=e.length;for(let r=0;r<n;r+=4){const i=e[r+3];if(i!==255&&i>0){const s=255/i;e[r]=e[r]*s,e[r+1]=e[r+1]*s,e[r+2]=e[r+2]*s}}}const Tet={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},ore=98,ket="png",Aet={png:100,jpg:ore,jpeg:ore},v5t=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:met,encode:Pve,encodeData:Mve,getFormatAndQuality:Lve,getMaximumResolutionScale:Dve,resampleHermite:xet,toDataUrl:Ove},Symbol.toStringTag,{value:"Module"})),$ve={flipY:!0,premultipliedAlpha:!0};async function Iet(t,e){const n=await jve(t,e),{format:r,quality:i}=Lve(e?.format,e?.quality);return Pve(n,{format:r,quality:i},$ve)}async function Ret(t,e){const n=await jve(t,e);return Mve(n,$ve)}function jve(t,e){const n=Cet(e||{},Met(t.stage,t.size),t.size,t.padding),r=Pet(e,t.allLayerViews);return t.stage.takeScreenshot(n,r,t.backgroundColor,e?.rotation)}function Pet(t={},e){if(!t.layers)return;const n=[];return t.layers.forEach(r=>{const i=e.find(s=>s.layer.id===r.id);i?.container&&n.push(i.container)}),n}function Met(t,e){return Math.min(4,Dve(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function Cet(t,e,n,r){t.ignorePadding&&(r={left:0,right:0,top:0,bottom:0});let i=null;t.width!=null&&t.height!=null?i=[t.width,t.height]:t.width==null&&t.height!=null?i=[t.height,t.height]:t.width!=null&&t.height==null?i=[t.width,t.width]:t.width==null&&t.height==null&&(i=null);const s=n[0]-(r.left+r.right),o=n[1]-(r.top+r.bottom);let a,l,c=t.area||{x:0,y:0,width:s,height:o};if(i){const u=s/o,h=i[0]/i[1];if(h>u){const f=c.width/h;c={x:c.x,y:Math.round(c.y+(c.height-f)/2),width:c.width,height:Math.round(f)}}else{const f=c.height*h;c={x:Math.round(c.x+(c.width-f)/2),y:c.y,width:Math.round(f),height:c.height}}}else i=[c.width,c.height];return i[0]>c.width?(a=Math.min(i[0]/c.width,e),l=i[0]/c.width/a):(a=1,l=i[0]/c.width),{cropArea:{x:Math.round((c.x+r.left)*a),y:Math.round((c.y+r.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:l,resolutionScale:a}}const Net=t=>t.includes("Brush");let Fve=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),Net(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};const are=Symbol("analyses-owner-handles");let Em=class extends Kt{constructor(e){super(e),this._allAnalysisViews=new Ot,this._creatingViewCount=0,this._attachedToViewResolver=lre(),this._items=new Map,this._moduleMap=new Map,this._scheduledUpdateHandle=null,this._emitOnView=(n,r)=>this.view.emit(n,r)}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(Tr("AnalysisViewManager was destroyed")),this._set("view",null)}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(Tr()),this._attachedToViewResolver=lre()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const n=this._items.get(e);if(n==null||n.state.list===1)throw new Xe("AnalysisViewManager:no-analysis-view-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return n.createAnalysisViewTask.promise}_connectOwners(){this.addHandles(this._connectAnalysesCollection(this.view.analyses),are)}_disconnectOwners(){this.removeHandles(are),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const i of e)this._addAnalysis(i);const n=e.on("after-add",i=>this._addAnalysis(i.item)),r=e.on("after-remove",i=>this._removeAnalysis(i.item));return qn(()=>{n.remove(),r.remove();for(const i of e)this._removeAnalysis(i)})}_addAnalysis(e){const n=this._items.get(e);if(n==null){const r={state:{view:0,list:0},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,r),r.createAnalysisViewTask=iO(i=>this._createAnalysisViewPromise(r,i).then(s=>(this._emitOnView("analysis-view-create",{analysis:e,analysisView:s}),s),s=>{throw this._emitOnView("analysis-view-create-error",{analysis:e,error:s}),s}))}else n.state.list=0}_removeAnalysis(e){const n=this._items.get(e);n!=null?(n.state.list=1,this._scheduleUpdate()):St.getLogger(this).error("Trying to remove analysis which was not added")}_scheduleUpdate(){this._scheduledUpdateHandle==null&&(this._scheduledUpdateHandle=Y2(()=>this._update()))}_update(){this._scheduledUpdateHandle=Qr(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list!==1)return;const{analysis:n,view:r}=e;switch(this._items.delete(n),e.state.view){case 0:e.createAnalysisViewTask=R1(e.createAnalysisViewTask);break;case 1:r!=null&&(this._allAnalysisViews.remove(r),e.view=Ci(r),e.createAnalysisViewTask=null,this._emitOnView("analysis-view-destroy",{analysis:n,analysisView:r}))}})}async _createAnalysisViewPromise(e,n){const{analysis:r}=e;if(this._creatingViewCount+=1,!this._moduleMap.has(r.type))try{this._moduleMap.set(r.type,await this.importAnalysisViewModule(r))}catch{throw this._creatingViewCount-=1,new Xe("AnalysisViewManager:no-analysis-view-for-analysis",`Analysis of type "${r.type}" is not supported`)}if(ha(n))throw this._creatingViewCount-=1,Tr("AnalysisView creation aborted");const i=new(this._moduleMap.get(r.type)).default({analysis:r,view:this.view});let s=!0;lu(n,()=>{s&&this._destroyAnalysisView(r,i)});try{await i.when()}catch(o){throw s=!1,this._destroyAnalysisView(r,i),o}if(ha(n))throw Tr();return s=!1,e.view=i,e.state.view=1,this._allAnalysisViews.add(i),this._creatingViewCount-=1,i}_destroyAnalysisView(e,n){n.destroyed||(this._creatingViewCount-=1,n.destroy(),this._emitOnView("analysis-view-destroy",{analysis:e,analysisView:n}))}};_([E()],Em.prototype,"updating",null),_([E({constructOnly:!0})],Em.prototype,"importAnalysisViewModule",void 0),_([E({constructOnly:!0})],Em.prototype,"view",void 0),_([E()],Em.prototype,"_allAnalysisViews",void 0),_([E()],Em.prototype,"_creatingViewCount",void 0),Em=_([ue("esri.views.support.AnalysisViewManager")],Em);const Oet=Em;function lre(){const t=uc();return t.promise.catch(()=>{}),t}let Let=class{constructor(e){this.getUnmaskedRenderer=e}};function Det(t){const e=t.getExtension("WEBGL_debug_renderer_info");return e?new Let(()=>t.getParameter(e.UNMASKED_RENDERER_WEBGL)):null}let cre;function $et(){return cre??=Vet(),cre}let jet=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function Fet(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let n=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(n==null&&(n=e.getContext("webgl2"),n!=null&&(t.majorPerformanceCaveat=!0,t.unmaskedRenderer=Det(n)?.getUnmaskedRenderer()??"unknown")),n==null)return n;t.available=!0,t.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const r=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);return r&&(t.supportsHighPrecisionFragment=r.precision>0),n}function Vet(){const t=new jet,e=Fet(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null),t}function zet(t){const e=$et();return e.available?t==="3d"&&e.majorPerformanceCaveat?new Xe("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new Xe("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Xe("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Xe("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Uet(t){return t&&"nodeType"in t}function Get(t){return t&&typeof t.render=="function"}const ure={component:"esri-component"};let ry=class extends Kt{constructor(){super(...arguments),this.widget=null}destroy(){this.node=null,this.widget?.destroy()}get id(){return this._get("id")??this.widget?.id??this.node?.id}set id(e){this._set("id",e)}set node(e){const n=this._get("node");e!==n&&(e&&e.classList.add(ure.component),n&&n.classList.remove(ure.component),this._set("node",e))}castNode(e){return this.widget?.destroy(),e?typeof e=="string"||Uet(e)?(this._set("widget",null),PB(e)):(Get(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};_([E()],ry.prototype,"id",null),_([E()],ry.prototype,"node",null),_([zs("node")],ry.prototype,"castNode",null),_([E({readOnly:!0})],ry.prototype,"widget",void 0),ry=_([ue("esri.views.ui.Component")],ry);const DC=ry,Bet=(t,e)=>{let n=t;for(;n;){if(n===e)return!0;if(!n.parentNode)return!1;n.parentNode instanceof ShadowRoot?n=n.parentNode.host:n=n.parentNode}return!1},S5t=(t,e,n)=>{const r=Wet(e).subscribe;return r(i=>{i.some(o=>Bet(t,o.target))&&n()})},J$={},Wet=t=>{const e=t.join(","),n=J$[e];if(n!==void 0)return n;const r=new Set,i=new MutationObserver(o=>r.forEach(a=>a(o)));globalThis.document&&i.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const s={subscribe:o=>(r.add(o),()=>{r.delete(o),r.size===0&&(i.disconnect(),J$[e]=void 0)})};return J$[e]=s,s},Vve=(t,e)=>{let n=t;for(;n;){const r=n.closest?.(e);if(r)return r;const i=n.getRootNode?.();if(i===globalThis.document)return;n=i.host}};function Het(t){const e=Vve(t,".calcite-mode-dark, .calcite-mode-light, .calcite-mode-auto");return e?.classList.contains("calcite-mode-dark")||e?.classList.contains("calcite-mode-auto")&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}const T5t=(t,e,n)=>Vve(t,`[${e}]`)?.getAttribute(e)??n,qet="--esri-calcite-mode-name";function Ket(){const t=getComputedStyle(document.body).getPropertyValue(qet).replaceAll(/\W/g,"").toLowerCase();return t==="dark"||t==="light"?t:void 0}const zve="calcite-mode-";function Uve(t){return Ket()??Het(t??document.body)}function k5t(t){return Uve(t)==="dark"}function Yet(t){return`${zve}${Uve(t)}`}function Xet(t){const e=Yet(t);Zet(t),t.classList.add(e)}function Zet(t){Array.from(t.classList).forEach(e=>{e.startsWith(zve)&&t.classList.remove(e)})}const LO=new Map;function Gve(){LO.clear()}function Jet(t){return LO.get(t)}function Qet(t,e){LO.set(t,e)}function Q$(t){LO.delete(t)}function ett(...t){const e=Aa.acquire();for(let r=0;r<t.length;r++){const i=t[r],s=typeof i;if(s==="string")e.push(i);else if(Array.isArray(i))e.push.apply(e,i);else if(s==="object")for(const o in i)i[o]&&e.push(o)}const n=e.join(" ");return Aa.release(e),n}(()=>{const t=new Map,e=new ResizeObserver(r=>{Gve();for(const i of r)t.get(i.target)?.(i)}),n=(r,i,s)=>(t.set(r,i),e.observe(r,s),qn(()=>{e.unobserve(r),t.delete(r)}));return(r,i,s)=>{let o=null;return rv([dn(()=>typeof r=="function"?r():r,a=>{o?.remove(),a&&(o=n(a,i,s))},ea),qn(()=>o?.remove())])}})();function ttt(t){const e=t?.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function A5t(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function I5t(t){const e="data-node-ref";this[t.getAttribute(e)]=t}function ntt(t){return t==="Enter"||t===" "}async function rtt(t,e){await h$e(ZA(e));const n=typeof t=="function"?t():t;n&&("setFocus"in n&&typeof n.setFocus=="function"?await n.setFocus():n instanceof HTMLElement&&n.focus())}const itt={left:0,top:0,bottom:0,right:0},Bve={bottom:30,top:15,right:15,left:15},of="esri-ui",Ha={ui:of,corner:`${of}-corner`,innerContainer:`${of}-inner-container`,manualContainer:`${of}-manual-container`,cornerContainer:`${of}-corner-container`,topLeft:`${of}-top-left`,topRight:`${of}-top-right`,bottomLeft:`${of}-bottom-left`,bottomRight:`${of}-bottom-right`};function stt(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function XP(t){return t===0?"0":`${t}px`}function e8(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function t8(t,{top:e,bottom:n,left:r,right:i}){t.style.top=e,t.style.bottom=n,t.style.left=r,t.style.right=i}let Gh=class extends tI{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=eu(),this.view=null,this._applyViewPadding=()=>{const n=this.container;n&&t8(n,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const n=this._innerContainer;n&&t8(n,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([dn(()=>[this.view?.padding,this.container],this._applyViewPadding,fa),dn(()=>this.padding,this._applyUIPadding,fa),dn(()=>[this.container,this._locale],([e,n])=>{e&&e.setAttribute("lang",n)},fa),mpe(e=>{this._locale=e})])}destroy(){this.removeAllHandles(),this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear(),this.view=null,this._set("view",null)}set container(e){const n=this._get("container");e!==n&&(e&&(e.classList.add(Ha.ui),Xet(e),this._attachContainers(e)),n&&(n.classList.remove(Ha.ui),t8(n,{top:"",bottom:"",left:"",right:""}),n.textContent=""),this._set("container",e))}get height(){const e=this.view?.height??0;if(e===0)return e;const n=this._getViewPadding(),{top:r,bottom:i}=n;return Math.max(e-r-i,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Bve,...e}}get width(){const e=this.view?.width??0;if(e===0)return e;const n=this._getViewPadding(),{left:r,right:i}=n;return Math.max(e-r-i,0)}add(e,n){let r,i,s;if(Array.isArray(e))return void e.forEach(a=>this.add(a,n));const o=e8(e);o&&({index:r,position:n,component:e,key:i}=o),n&&typeof n=="object"&&({index:r,key:i,position:n,internal:s}=n),!e||n&&!this._isValidPosition(n)||this._add(e,n,r??this._getNumComponentsAtPosition(n),i,s)}remove(e,n){if(!e)return;if(Array.isArray(e))return e.map(i=>this.remove(i,n));const r=this._find(e);if(r){const i=this._componentMap.get(r);if(!i||i.key!==n)return;const s=this._components.indexOf(r);return r.node.parentNode?.removeChild(r.node),this._componentMap.delete(r),r.widget?.removeHandlesReference(this._removeWidgetHandleKey),this._components.forEach(a=>{const l=this._componentMap.get(a);l&&l.position===i.position&&l.index>i.index&&l.index--}),this._components.splice(s,1)[0]}}empty(e,n={removeInternal:!1}){if(Array.isArray(e)){for(const s of e)this.empty(s,n);return}const r=this._positionNameToContainerLookup[e??"manual"],i=Array.prototype.slice.call(r.children).map(s=>this._findByNode(s)).filter(s=>s==null?!1:!(this._componentMap.get(s)?.internal??!1)||n.removeInternal);for(const s of i)this.remove(s)}move(e,n){if(Array.isArray(e)&&e.forEach(o=>this.move(o,n)),!e)return;let r;const i=e8(e)||e8(n);if(i&&(r=i.index,n=i.position,e=i.component||e),n&&!this._isValidPosition(n))return;const s=this.remove(e);s&&this.add(s,{position:n,index:r})}find(e){if(!e)return null;const n=this._findById(e);return n&&(n.widget||n.node)}getComponents(e,n={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(r=>this._getComponentsAtPosition(r,n)):this._getComponentsAtPosition(e,n):this._components.filter(r=>n.includeInternal||!this._componentMap.get(r)?.internal).map(({widget:r,node:i})=>r??i)}getPosition(e){for(const n in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[n].contains(e))return n;return null}_add(e,n,r,i,s){e instanceof DC||(e=new DC({node:e}));const{widget:o}=e;o!=null&&o instanceof Kt&&o.addHandles(qn(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey);const a=this._positionNameToContainerLookup[n];this._components.some(l=>{const c=this._componentMap.get(l)?.position,u=c?this._positionNameToContainerLookup[c]:null;return a===u&&this._componentMap.get(l)?.index===r})&&this._components.forEach(l=>{const c=this._componentMap.get(l),u=c?.position,h=u?this._positionNameToContainerLookup[u]:null;c&&h===a&&c.index>=r&&c.index++}),this._place({component:e,position:n,index:r}),this._components.push(e),this._componentMap.set(e,{key:i,position:n,internal:s,index:r})}_find(e){return e?e instanceof DC?this._findByComponent(e):typeof e=="string"?this._findById(e):"domNode"in e?this._findByNode(e.domNode):this._findByNode(e):null}_getViewPadding(){return this.view?.padding??itt}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Ha.innerContainer,Ha.cornerContainer);const n=document.createElement("div");n.classList.add(Ha.innerContainer,Ha.manualContainer);const r=document.createElement("div");r.classList.add(Ha.topLeft,Ha.corner),e.appendChild(r);const i=document.createElement("div");i.classList.add(Ha.topRight,Ha.corner),e.appendChild(i);const s=document.createElement("div");s.classList.add(Ha.bottomLeft,Ha.corner),e.appendChild(s);const o=document.createElement("div");o.classList.add(Ha.bottomRight,Ha.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=n;const a=ttt();this._cornerNameToContainerLookup={"top-left":r,"top-right":i,"bottom-left":s,"bottom-right":o,"top-leading":a?i:r,"top-trailing":a?r:i,"bottom-leading":a?o:s,"bottom-trailing":a?s:o},this._positionNameToContainerLookup={manual:n,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const n=e.position??"manual",{component:r,index:i}=e,s=this._positionNameToContainerLookup[n],o=i!=null&&i>-1;if(stt(r.widget)&&r.widget.startup(),!o)return void s.appendChild(r.node);const a=Array.from(s.children);if(a.length!==0){for(const l of a){const c=this._findByNode(l);if(c&&i<(this._componentMap.get(c)?.index??0))return void l.parentNode?.insertBefore(r.node,l)}s.appendChild(r.node)}else s.appendChild(r.node)}_toPixelPosition(e){return{top:XP(e.top),left:XP(e.left),right:XP(e.right),bottom:XP(e.bottom)}}_findByComponent(e){return this._components.find(n=>n===e)??null}_findById(e){return this._components.find(({id:n})=>n===e)??null}_findByNode(e){return e?this._components.find(({node:n})=>n===e):null}_getComponentsAtPosition(e,n){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(i=>this._findByNode(i)).filter(e2).filter(i=>n.includeInternal||!this._componentMap.get(i)?.internal).map(({widget:i,node:s})=>i??s)}_getNumComponentsAtPosition(e){return this._positionNameToContainerLookup[e]?.children.length??0}};_([E()],Gh.prototype,"_locale",void 0),_([E()],Gh.prototype,"container",null),_([E()],Gh.prototype,"height",null),_([E({value:Bve})],Gh.prototype,"padding",null),_([zs("padding")],Gh.prototype,"castPadding",null),_([E()],Gh.prototype,"view",void 0),_([E()],Gh.prototype,"width",null),Gh=_([ue("esri.views.ui.UI")],Gh);const ott=Gh,att={handleInterceptedEvent:(t,e,n,r)=>(t.scheduleRender(),e.properties[`on${r.type}`].apply(e.properties.bind||n,[r]))},ltt={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,n)=>{e.startsWith("-")?t.style.setProperty(e,n):t.style[e]=n}},ctt=t=>({...ltt,...t}),utt=(t,e)=>{const n=[];for(;t&&t!==e;)n.push(t),t=t.parentNode;return n},htt=(t,e)=>t.find(e),hre=(t,e,n=!1)=>{let r=t;return e.forEach((i,s)=>{const o=r?.children?htt(r.children,a=>a.domNode===i):void 0;n&&!o&&s!==e.length-1||(r=o)}),r},dtt=t=>{let e;const n={...att,...t},r=ctt(n),i=r.performanceLogger;let s,o=!0,a=!1;const l=[],c=[],u=(f,g,v)=>{let x;r.eventHandlerInterceptor=(T,A,I,R)=>function(C){let V;i("domEvent",C);const M=utt(C.currentTarget,x.domNode),N=M.some(F=>customElements.get(F?.tagName?.toLowerCase()));if(C.eventPhase===Event.CAPTURING_PHASE||!N)M.reverse(),V=hre(x.getLastRender(),M);else{const F=C.composedPath(),L=F.slice(F.indexOf(C.currentTarget),F.indexOf(x.domNode)).reverse();V=hre(x.getLastRender(),L,!0)}let O;return V&&(O=n.handleInterceptedEvent(e,V,this,C)),i("domEventProcessed",C),O},n.postProcessProjectionOptions?.(r);const b=v();x=f(g,b,r),r.eventHandlerInterceptor=void 0,l.push(x),c.push(v),n.afterFirstVNodeRendered&&n.afterFirstVNodeRendered(x,b)};let h=()=>{if(s=void 0,o){o=!1,i("renderStart",void 0);for(let f=0;f<l.length;f++){const g=c[f]();i("rendered",void 0);try{l[f].update(g)}catch(v){console.error(v)}i("patched",void 0)}i("renderDone",void 0),o=!0}};return n.modifyDoRenderImplementation&&(h=n.modifyDoRenderImplementation(h,l,c)),e={renderNow:h,scheduleRender:()=>{s||a||(s=requestAnimationFrame(h))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(f,g)=>{u(Jm.append,f,g)},insertBefore:(f,g)=>{u(Jm.insertBefore,f,g)},merge:(f,g)=>{u(Jm.merge,f,g)},replace:(f,g)=>{u(Jm.replace,f,g)},detach:f=>{for(let g=0;g<c.length;g++)if(c[g]===f)return c.splice(g,1),l.splice(g,1)[0];throw new Error("renderFunction was not found")}},e},Ri=(t,e,...n)=>{try{return t?.call(e,...n)}catch(r){console.error(r,t)}},hV=async(t,e,...n)=>{try{return await t?.call(e,...n)}catch(r){console.error(r,t)}},aW=Symbol.for("controller"),ftt=t=>typeof t=="object"&&t!==null&&(aW in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),P5t=t=>typeof t?.then=="function";let kS;const AS=t=>{kS!==t&&(kS=t,queueMicrotask(()=>kS===t?kS=void 0:0))},DO=t=>kS;let iy=[];const ptt=t=>{if(t===void 0){iy=[];return}const e=iy.indexOf(t);iy=e===-1?[...iy,t]:iy.slice(0,e+1),queueMicrotask(()=>iy=[])},mtt=()=>iy;let bx;const M5t=t=>{bx!==t&&(bx=t,queueMicrotask(()=>bx===t?bx=void 0:0))},gtt=()=>{const t=bx;return bx=void 0,t},ytt=async(t,e)=>{const n=lW(t);if(n===void 0)return t;if(await n.ready,typeof e=="function"){const r=n.watchExports(i=>e(i,r))}return n.exports},vtt=async t=>{const e=lW(t);return await e.ready,e},lW=t=>{const n=DO().manager.X(t);if(n!==void 0)return n;if(ftt(t))return t;const r=gtt();if(r!==void 0)return r};let dV=!1;const C5t=t=>{dV=!0;try{return t()}finally{dV=!1}};const $C=globalThis,cW=$C.ShadowRoot&&($C.ShadyCSS===void 0||$C.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,uW=Symbol(),dre=new WeakMap;let Wve=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==uW)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(cW&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=dre.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&dre.set(n,e))}return e}toString(){return this.cssText}};const _tt=t=>new Wve(typeof t=="string"?t:t+"",void 0,uW),O5t=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,i,s)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[s+1],t[0]);return new Wve(n,t,uW)},xtt=(t,e)=>{if(cW)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),i=$C.litNonce;i!==void 0&&r.setAttribute("nonce",i),r.textContent=n.cssText,t.appendChild(r)}},fre=cW?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return _tt(n)})(t):t;const{is:wtt,defineProperty:btt,getOwnPropertyDescriptor:Ett,getOwnPropertyNames:Stt,getOwnPropertySymbols:Ttt,getPrototypeOf:ktt}=Object,$O=globalThis,pre=$O.trustedTypes,Att=pre?pre.emptyScript:"",Itt=$O.reactiveElementPolyfillSupport,xT=(t,e)=>t,fV={toAttribute(t,e){switch(e){case Boolean:t=t?Att:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},hW=(t,e)=>!wtt(t,e),mre={attribute:!0,type:String,converter:fV,reflect:!1,useDefault:!1,hasChanged:hW};Symbol.metadata??=Symbol("metadata"),$O.litPropertyMetadata??=new WeakMap;let ix=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=mre){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),i=this.getPropertyDescriptor(e,r,n);i!==void 0&&btt(this.prototype,e,i)}}static getPropertyDescriptor(e,n,r){const{get:i,set:s}=Ett(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:i,set(o){const a=i?.call(this);s?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??mre}static _$Ei(){if(this.hasOwnProperty(xT("elementProperties")))return;const e=ktt(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(xT("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(xT("properties"))){const n=this.properties,r=[...Stt(n),...Ttt(n)];for(const i of r)this.createProperty(i,n[i])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,i]of n)this.elementProperties.set(r,i)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const i=this._$Eu(n,r);i!==void 0&&this._$Eh.set(i,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const i of r)n.unshift(fre(i))}else e!==void 0&&n.push(fre(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return xtt(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,r);if(i!==void 0&&r.reflect===!0){const s=(r.converter?.toAttribute!==void 0?r.converter:fV).toAttribute(n,r.type);this._$Em=e,s==null?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(e,n){const r=this.constructor,i=r._$Eh.get(e);if(i!==void 0&&this._$Em!==i){const s=r.getPropertyOptions(i),o=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:fV;this._$Em=i;const a=o.fromAttribute(n,s.type);this[i]=a??this._$Ej?.get(i)??a,this._$Em=null}}requestUpdate(e,n,r,i=!1,s){if(e!==void 0){const o=this.constructor;if(i===!1&&(s=this[e]),r??=o.getPropertyOptions(e),!((r.hasChanged??hW)(s,n)||r.useDefault&&r.reflect&&s===this._$Ej?.get(e)&&!this.hasAttribute(o._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:i,wrapped:s},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),s!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),i===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[i,s]of this._$Ep)this[i]=s;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[i,s]of r){const{wrapped:o}=s,a=this[i];o!==!0||this._$AL.has(i)||a===void 0||this.C(i,void 0,s,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach(r=>r.hostUpdate?.()),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach(n=>n.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(n=>this._$ET(n,this[n])),this._$EM()}updated(e){}firstUpdated(e){}};ix.elementStyles=[],ix.shadowRootOptions={mode:"open"},ix[xT("elementProperties")]=new Map,ix[xT("finalized")]=new Map,Itt?.({ReactiveElement:ix}),($O.reactiveElementVersions??=[]).push("2.1.2");const dW=globalThis,gre=t=>t,X4=dW.trustedTypes,yre=X4?X4.createPolicy("lit-html",{createHTML:t=>t}):void 0,Hve="$lit$",Vm=`lit$${Math.random().toFixed(9).slice(2)}$`,qve="?"+Vm,Rtt=`<${qve}>`,V1=document,Bk=()=>V1.createComment(""),Wk=t=>t===null||typeof t!="object"&&typeof t!="function",fW=Array.isArray,Ptt=t=>fW(t)||typeof t?.[Symbol.iterator]=="function",n8=`[ 	
\f\r]`,LE=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,vre=/-->/g,_re=/>/g,O0=RegExp(`>|${n8}(?:([^\\s"'>=/]+)(${n8}*=${n8}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),xre=/'/g,wre=/"/g,Kve=/^(?:script|style|textarea|title)$/i,Yve=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),D5t=Yve(1),$5t=Yve(2),jg=Symbol.for("lit-noChange"),Zi=Symbol.for("lit-nothing"),bre=new WeakMap,Ly=V1.createTreeWalker(V1,129);function Xve(t,e){if(!fW(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return yre!==void 0?yre.createHTML(e):e}const Mtt=(t,e)=>{const n=t.length-1,r=[];let i,s=e===2?"<svg>":e===3?"<math>":"",o=LE;for(let a=0;a<n;a++){const l=t[a];let c,u,h=-1,f=0;for(;f<l.length&&(o.lastIndex=f,u=o.exec(l),u!==null);)f=o.lastIndex,o===LE?u[1]==="!--"?o=vre:u[1]!==void 0?o=_re:u[2]!==void 0?(Kve.test(u[2])&&(i=RegExp("</"+u[2],"g")),o=O0):u[3]!==void 0&&(o=O0):o===O0?u[0]===">"?(o=i??LE,h=-1):u[1]===void 0?h=-2:(h=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?O0:u[3]==='"'?wre:xre):o===wre||o===xre?o=O0:o===vre||o===_re?o=LE:(o=O0,i=void 0);const g=o===O0&&t[a+1].startsWith("/>")?" ":"";s+=o===LE?l+Rtt:h>=0?(r.push(c),l.slice(0,h)+Hve+l.slice(h)+Vm+g):l+Vm+(h===-2?a:g)}return[Xve(t,s+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class Hk{constructor({strings:e,_$litType$:n},r){let i;this.parts=[];let s=0,o=0;const a=e.length-1,l=this.parts,[c,u]=Mtt(e,n);if(this.el=Hk.createElement(c,r),Ly.currentNode=this.el.content,n===2||n===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(i=Ly.nextNode())!==null&&l.length<a;){if(i.nodeType===1){if(i.hasAttributes())for(const h of i.getAttributeNames())if(h.endsWith(Hve)){const f=u[o++],g=i.getAttribute(h).split(Vm),v=/([.?@])?(.*)/.exec(f);l.push({type:1,index:s,name:v[2],strings:g,ctor:v[1]==="."?Ntt:v[1]==="?"?Ott:v[1]==="@"?Ltt:jO}),i.removeAttribute(h)}else h.startsWith(Vm)&&(l.push({type:6,index:s}),i.removeAttribute(h));if(Kve.test(i.tagName)){const h=i.textContent.split(Vm),f=h.length-1;if(f>0){i.textContent=X4?X4.emptyScript:"";for(let g=0;g<f;g++)i.append(h[g],Bk()),Ly.nextNode(),l.push({type:2,index:++s});i.append(h[f],Bk())}}}else if(i.nodeType===8)if(i.data===qve)l.push({type:2,index:s});else{let h=-1;for(;(h=i.data.indexOf(Vm,h+1))!==-1;)l.push({type:7,index:s}),h+=Vm.length-1}s++}}static createElement(e,n){const r=V1.createElement("template");return r.innerHTML=e,r}}function w2(t,e,n=t,r){if(e===jg)return e;let i=r!==void 0?n._$Co?.[r]:n._$Cl;const s=Wk(e)?void 0:e._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),s===void 0?i=void 0:(i=new s(t),i._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=i:n._$Cl=i),i!==void 0&&(e=w2(t,i._$AS(t,e.values),i,r)),e}class Ctt{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,i=(e?.creationScope??V1).importNode(n,!0);Ly.currentNode=i;let s=Ly.nextNode(),o=0,a=0,l=r[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new bI(s,s.nextSibling,this,e):l.type===1?c=new l.ctor(s,l.name,l.strings,this,e):l.type===6&&(c=new Dtt(s,this,e)),this._$AV.push(c),l=r[++a]}o!==l?.index&&(s=Ly.nextNode(),o++)}return Ly.currentNode=V1,i}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class bI{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,i){this.type=2,this._$AH=Zi,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=w2(this,e,n),Wk(e)?e===Zi||e==null||e===""?(this._$AH!==Zi&&this._$AR(),this._$AH=Zi):e!==this._$AH&&e!==jg&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Ptt(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Zi&&Wk(this._$AH)?this._$AA.nextSibling.data=e:this.T(V1.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,i=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=Hk.createElement(Xve(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===i)this._$AH.p(n);else{const s=new Ctt(i,this),o=s.u(this.options);s.p(n),this.T(o),this._$AH=s}}_$AC(e){let n=bre.get(e.strings);return n===void 0&&bre.set(e.strings,n=new Hk(e)),n}k(e){fW(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of e)i===n.length?n.push(r=new bI(this.O(Bk()),this.O(Bk()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=gre(e).nextSibling;gre(e).remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class jO{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,i,s){this.type=1,this._$AH=Zi,this._$AN=void 0,this.element=e,this.name=n,this._$AM=i,this.options=s,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Zi}_$AI(e,n=this,r,i){const s=this.strings;let o=!1;if(s===void 0)e=w2(this,e,n,0),o=!Wk(e)||e!==this._$AH&&e!==jg,o&&(this._$AH=e);else{const a=e;let l,c;for(e=s[0],l=0;l<s.length-1;l++)c=w2(this,a[r+l],n,l),c===jg&&(c=this._$AH[l]),o||=!Wk(c)||c!==this._$AH[l],c===Zi?e=Zi:e!==Zi&&(e+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!i&&this.j(e)}j(e){e===Zi?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}let Ntt=class extends jO{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Zi?void 0:e}};class Ott extends jO{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Zi)}}let Ltt=class extends jO{constructor(e,n,r,i,s){super(e,n,r,i,s),this.type=5}_$AI(e,n=this){if((e=w2(this,e,n,0)??Zi)===jg)return;const r=this._$AH,i=e===Zi&&r!==Zi||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,s=e!==Zi&&(r===Zi||i);i&&this.element.removeEventListener(this.name,this,r),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},Dtt=class{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){w2(this,e)}};const $tt=dW.litHtmlPolyfillSupport;$tt?.(Hk,bI),(dW.litHtmlVersions??=[]).push("3.3.2");const jtt=(t,e,n)=>{const r=n?.renderBefore??e;let i=r._$litPart$;if(i===void 0){const s=n?.renderBefore??null;r._$litPart$=i=new bI(e.insertBefore(Bk(),s),s,void 0,n??{})}return i._$AI(t),i};const pW=globalThis;let sw=class extends ix{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=jtt(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return jg}};sw._$litElement$=!0,sw.finalized=!0,pW.litElementHydrateSupport?.({LitElement:sw});const Ftt=pW.litElementPolyfillSupport;Ftt?.({LitElement:sw});(pW.litElementVersions??=[]).push("4.2.2");class qk{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}const Vtt=(t,e)=>{const n=e/ztt;let r=0;const i=setInterval(()=>{r+=n,r>=e&&(clearInterval(i),t())},n);return i},ztt=4,Utt=(t,e,n)=>{const r=Object.keys(t),i=r.length;Ex===void 0&&queueMicrotask(FO),Ex??=new Map;let s=Ex.get(t);return s===void 0&&(s={callbacks:[],keyCount:i},Ex.set(t,s)),s.keyCount!==i&&(s.callbacks.forEach(o=>o(r)),s.callbacks=[],s.keyCount=i),s.callbacks.push(o=>{const a=c=>Ri(e,null,c),l=o[i];l===void 0?a(void 0):t[l]===n?a(l):a(void 0)}),n};let Ex;const FO=()=>{Ex?.forEach(({callbacks:t},e)=>{const n=Object.keys(e);t.forEach(r=>r(n))}),Ex=void 0},Gtt=(t,e,n)=>{const r=t.manager;return r.V!==Zi&&r.V!==n&&r.S(void 0,void 0),r.T.length===0&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=n,r.T.push((i,s)=>Ri(e,void 0,n===s?i:void 0)),n},Btt=(t=[DO(),...mtt()],e,n)=>{const r=Array.isArray(t)?t:[t];let i=r.length+1;const s=o=>{i-=1,o!==void 0&&(i=Math.min(i,0)),i===0&&e(o)};r.forEach(o=>Utt(o,a=>s(a===void 0?void 0:{key:a,host:o,isReactive:!1}),n));for(const o of r)if("manager"in o&&o.manager.component===o){Gtt(o,a=>s(a===void 0?void 0:{key:a,host:o,isReactive:!0}),n);break}return n},Wtt=(t="",e={},n=DO())=>{const r={emit:i=>{t===""&&FO();const s=new CustomEvent(t,{detail:i,cancelable:!0,bubbles:!0,composed:!0,...e});return n.el.dispatchEvent(s),s}};return t===""&&Btt(void 0,i=>t=i.key,r),r},U5t=Wtt.bind(null,"");var Zve;Zve=aW;class Htt{constructor(e){this.#n=[],this.#e=[],this.#r=[],this.#l=[],this.#c=[],this.#u=[],this.#h=[],this.#d=[],this.#o=[],this.#a=!1,this.P=new qk,this.connectedCalled=!1,this.loadedCalled=!1,this[Zve]=!0,this.#s=[];const n=this,r=e??DO();n.#t=r,n.ready=n.P.promise,n.#i=Sre(n),n.component=r,n.#t.addController(n),n.#t.manager===void 0||(ptt(n),queueMicrotask(()=>n.catchUpLifecycle()))}#n;#e;#r;#l;#c;#u;#h;#d;#o;#a;#t;catchUpLifecycle(){const{manager:e}=this.#t;e.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),e.#a&&this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#i;get exports(){return this.#i}set exports(e){const n=this.#i;n!==e&&(this.#i=e,this.#s.forEach(Ri),this.connectedCalled&&this.O!==!1&&this.#t.requestUpdate(this.O,n)),this.P.resolve(e)}setProvisionalExports(e,n=!0){this.#i=n?Sre(e):e,this.#s.forEach(Ri)}#s;watchExports(e){const n=()=>e(this.#i);return this.#s.push(n),()=>{this.#s.splice(this.#s.indexOf(n),1)}}get use(){return AS(this.#t),ytt}get useRef(){return AS(this.#t),vtt}get useRefSync(){return AS(this.#t),lW}controllerRemoved(){this.#t.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#n.push(e)}onDisconnected(e){this.#e.push(e)}onLoad(e){this.#r.push(e)}onLoaded(e){this.#l.push(e)}onUpdate(e){this.#c.push(e)}onUpdated(e){this.#u.push(e)}onDestroy(e){this.#h.push(e)}onLifecycle(e){this.#d.push(e),this.connectedCalled&&this.#t.el.isConnected&&this.#f(e)}triggerConnected(){const e=this;e.hostConnected&&Ri(e.hostConnected,e),e.#n.forEach(Ri),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&Ri(e.hostDisconnected,e),e.#e.forEach(Ri),e.#o.forEach(Ri),e.#o=[]}async triggerLoad(){if(this.#a)return;this.#a=!0;const e=this;e.hostLoad&&await hV(e.hostLoad,e),this.#r.length>0&&await Promise.allSettled(this.#r.map(hV)),this.P.resolve(this.#i)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&Ri(this.hostLoaded,this),this.#l.forEach(Ri),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&Ri(this.hostUpdate,this,e),this.#c.forEach(Ere,e)}triggerUpdated(e){this.hostUpdated&&Ri(this.hostUpdated,this,e),this.#u.forEach(Ere,e)}triggerDestroy(){this.hostDestroy&&Ri(this.hostDestroy,this),this.#h.forEach(Ri)}triggerLifecycle(){this.hostLifecycle&&this.#f(()=>this.hostLifecycle()),this.#d.forEach(this.#f,this)}#f(e){AS(this.#t);const n=Ri(e);(Array.isArray(n)?n:[n]).forEach(i=>{typeof i=="function"?this.#o.push(i):typeof i=="object"&&typeof i.remove=="function"&&this.#o.push(i.remove)})}}function Ere(t){Ri(t,void 0,this)}const qtt=Htt,Sre=t=>{if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e={get(r,i,s){if(!((i==="exports"||i==="_exports")&&i in r&&r[i]===n)&&(i in r||i in Promise.prototype||typeof i=="symbol"))return typeof r=="function"?r[i]:Reflect.get(r,i,s)}},n=new Proxy(t,e);return n},Ktt=t=>t.replace(Ytt,(e,n)=>`${n===0?"":"-"}${e.toLowerCase()}`),Ytt=/[A-Z]+(?![a-z])|[A-Z]/gu,Xtt=1,Ztt=2,Jtt=4,Qtt=8,ent=16,tnt=32,nnt=64,Jve=t=>{let e=t;for(;e=e.parentNode??e.host;)if(e?.constructor?.lumina){const n=e;return n.manager?.loadedCalled||(n.J??n._offspring).push(t),(n.I??n._postLoad).promise}return!1},Tre={};function Qve(){}const jC=Object.defineProperty,rnt=globalThis.HTMLElement??Qve;var Ja,Lf,Cw,dA,pV;const KH=class KH extends rnt{constructor(){var i;super();bu(this,dA);bu(this,Ja);bu(this,Lf);bu(this,Cw);Eu(this,Lf,{}),Eu(this,Cw,[]),this.I=new qk,this.H=new qk,this.J=[];const n=this,r=n.constructor;n._offspring=n.J,n._postLoad=n.I,r.C?.forEach(s=>{Object.hasOwn(n,s)&&(Ir(n,Lf)[s]=n[s],delete n[s])}),r.A?Jb(i=n,dA,pV).call(i,{a:r.A}):r.B.then(async s=>{var o;await r.K.p,Jb(o=n,dA,pV).call(o,await(s.default?.then(a=>typeof a=="function"?{a}:a)??s))}).catch(s=>{n.H.reject(s),setTimeout(()=>{throw s})})}static F(){for(const n of this.C??[])jC(this.prototype,n,{configurable:!0,enumerable:!0,get(){return Ir(this,Lf)[n]},set(r){Ir(this,Lf)[n]=r}});for(const n of this.E??[])jC(this.prototype,n,{async value(...r){return Ir(this,Ja)||await this.H.promise,await Ir(this,Ja)[n](...r)},configurable:!0});for(const n of this.D??[])jC(this.prototype,n,{value(...r){return Ir(this,Ja)[n](...r)},configurable:!0})}get manager(){return Ir(this,Ja)?.manager}attributeChangedCallback(n,r,i){Ir(this,Ja)?.attributeChangedCallback(n,r,i),Ir(this,Ja)||Ir(this,Cw).push(n)}connectedCallback(){Ir(this,Ja)?Ir(this,Ja).connectedCallback?.():queueMicrotask(()=>this.G=Jve(this))}disconnectedCallback(){Ir(this,Ja)?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}addController(){}requestUpdate(){Ir(this,Ja)?.requestUpdate()}};Ja=new WeakMap,Lf=new WeakMap,Cw=new WeakMap,dA=new WeakSet,pV=function(n){const r=this.constructor,i=r.L,s=Ir(this,Lf),o=Object.values(n).find(f=>f.L===i),a=`${i}--lazy`;let l=o;for(;l&&!Object.hasOwn(l,"lumina");)l=Object.getPrototypeOf(l);snt(l),!r.A&&(r.A=o,customElements.define(a,o)),o.N=this;const u=document.createElement(a);o.N=void 0,Eu(this,Ja,u),Eu(this,Lf,u),Ir(this,Cw).forEach(f=>u.attributeChangedCallback(f,null,this.getAttribute(f))),Object.entries(s).forEach(int,u);const h=this.isConnected;(h||this.G)&&(u.connectedCallback?.(),h||u.disconnectedCallback())},KH.lumina=!0;let kre=KH;function int([t,e]){this[t]=e}const snt=t=>{const e=t.prototype,n=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(i,s){n.setAttribute.call(this.el,i,s)},e.removeAttribute=function(i){n.removeAttribute.call(this.el,i)},jC(e,"isConnected",{get(){return Reflect.get(n,"isConnected",this.el)}}))};const e_e={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},t_e=t=>(...e)=>({_$litDirective$:t,values:e});let n_e=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,n,r){this._$Ct=e,this._$AM=n,this._$Ci=r}_$AS(e,n){return this.update(e,n)}update(e,n){return this.render(...n)}};const ont=t_e(class extends n_e{constructor(t){if(super(t),t.type!==e_e.ATTRIBUTE||t.name!=="class"||t.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(r=>r!=="")));for(const r in e)e[r]&&!this.nt?.has(r)&&this.st.add(r);return this.render(e)}const n=t.element.classList;for(const r of this.st)r in e||(n.remove(r),this.st.delete(r));for(const r in e){const i=!!e[r];i===this.st.has(r)||this.nt?.has(r)||(i?(n.add(r),this.st.add(r)):(n.remove(r),this.st.delete(r)))}return jg}});const r_e="important",ant=" !"+r_e,lnt=t_e(class extends n_e{constructor(t){if(super(t),t.type!==e_e.ATTRIBUTE||t.name!=="style"||t.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return r==null?e:e+`${n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(t,[e]){const{style:n}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const r of this.ft)e[r]==null&&(this.ft.delete(r),r.includes("-")?n.removeProperty(r):n[r]=null);for(const r in e){const i=e[r];if(i!=null){this.ft.add(r);const s=typeof i=="string"&&i.endsWith(ant);r.includes("-")||s?n.setProperty(r,s?i.slice(0,-11):i,s?r_e:""):n[r]=i}}return jg}});class cnt extends qtt{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=Zi,this.T=[],this.#r=new WeakMap,this.#e=e,this.exports=void 0,this.hasDestroy=mV in e&&typeof e.destroy=="function",sw.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const n=e.el.localName;throw e.el.remove(),new Error(`The ${n} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${mV} prop.`)}this.#n!==void 0&&clearTimeout(this.#n),FO();for(const n of e.M)"triggerConnected"in n?n.triggerConnected():Ri(n.hostConnected,n)},hostDisconnected:()=>{for(const n of e.M)"triggerDisconnected"in n?n.triggerDisconnected():Ri(n.hostDisconnected,n);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const n of e.M)"triggerUpdate"in n?n.triggerUpdate(this.Q):Ri(n.hostUpdate,n,this.Q)},hostUpdated:()=>{for(const n of e.M)"triggerUpdated"in n?n.triggerUpdated(this.Q):Ri(n.hostUpdated,n,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),AS(e)}#n;#e;async destroy(){if(!this.destroyed){this.#e.el.isConnected&&(this.hasDestroy=!1,this.#e.el.remove()),this.#n=void 0,this.destroyed=!0;for(const e of this.#e.M)"triggerDestroy"in e?e.triggerDestroy():Ri(e.hostDestroy,e);this.#e.M.splice(0)}}U(){if(this.#n!==void 0&&clearTimeout(this.#n),!this.#e.el.isConnected&&!this.#e.autoDestroyDisabled){const e=()=>{this.#e.destroy()};this.#n=Vtt(e,unt)}}S(e,n){const r=this.T;this.V=Zi,this.T=[],r.forEach(i=>i(e,n))}#r;W(e,n){(typeof n=="object"&&n!==null||typeof n=="function")&&this.#r.set(n,e)}X(e){if(typeof e=="object"&&e!==null||typeof e=="function")return this.#r.get(e)}}let unt=1e3;const mV="autoDestroyDisabled";var Fy,fA,pA,Vy,Yh,P2,i_e,s_e;const UT=class UT extends sw{constructor(){super();bu(this,P2);bu(this,Fy);bu(this,fA);bu(this,pA);bu(this,Vy);bu(this,Yh);this.M=[],this.manager=new cnt(this);const n=this,r=n.constructor,i=r.N,s=r.K.o,o=UT.prototype.shouldUpdate;Eu(n,Vy,i?.H??new qk),n.I=i?.I??new qk,n.J=i?.J??[],n._offspring=n.J,n._postLoad=n.I,n.el=i??n,Eu(n,pA,n.enableUpdating),n.enableUpdating=Qve,n.shouldUpdate!==o&&(Eu(n,fA,n.shouldUpdate),n.shouldUpdate=o),s&&(Eu(n,Fy,new Map),r.elementProperties.forEach((a,l)=>Ir(n,Fy).set(l,s())))}static finalizeStyles(n){const r=super.finalizeStyles(n),i=this.shadowRootOptions===Tre;return this.K?.commonStyles===void 0||i?r:[this.K.commonStyles,...r]}static createProperty(n,r){const i=typeof r=="number"?r:Array.isArray(r)?r[0]:0,s=Array.isArray(r)?r[1]:void 0,o=s?.hasChanged??hW,a={attribute:i&Xtt&&typeof n=="string"?Ktt(n):!1,reflect:!!(i&Ztt),type:i&Jtt?Boolean:i&Qtt?Number:void 0,state:!!(i&ent),readOnly:!!(i&tnt),noAccessor:!!(i&nnt),c:!1,...s,hasChanged(l,c){const u=o(l,c);return a.c=u,u}};super.createProperty(n,a)}static getPropertyDescriptor(n,r,i){const s=this.K,o=super.getPropertyDescriptor(n,r,i);return i.d=o,{...o,get(){return s.t?.(Ir(this,Fy).get(n)),o.get?.call(this)},set(a){const l=this.manager;if(i.readOnly&&!dV&&(l.R||l.connectedCalled))throw Error(`Cannot assign to read-only property "${n}" of ${this.el.localName}. Trying to assign "${a}"`);o.set.call(this,a??void 0),i.c&&Ir(this,Fy)?.get(n)?.notify(),l.T.length>0&&(FO(),l?.S(n,a))}}}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const n=this.constructor.K.c?.(()=>this.requestUpdate());Eu(this,Yh,n);const r=!this.manager.connectedCalled;super.connectedCallback(),r?queueMicrotask(()=>Jb(this,P2,s_e).call(this).catch(i=>{Ir(this,Vy).reject(i),setTimeout(()=>{throw i})})):n&&this.requestUpdate()}disconnectedCallback(){super.disconnectedCallback(),Ir(this,Yh)?.destroy(),Eu(this,Yh,void 0)}createRenderRoot(){const n=this.el.shadowRoot,r=this.constructor,i=r.shadowRootOptions,o=n??(i===Tre?this.el:this.el.attachShadow(i));if(this.isConnected){const a=o.getRootNode();a.adoptedStyleSheets=[...a.adoptedStyleSheets,...r.elementStyles.map(l=>"styleSheet"in l?l.styleSheet:l)]}return o}shouldUpdate(n){var r;return this.manager.Q=n,((r=Ir(this,fA))==null?void 0:r.call(this,n))??!0}update(n){Ir(this,Yh)?Jb(this,P2,i_e).call(this,n):super.update(n)}listen(n,r,i){const s=r?.bind(this)??r;this.manager.onLifecycle(()=>(this.el.addEventListener(n,s,i),()=>this.el.removeEventListener(n,s,i)))}listenOn(n,r,i,s){const o=i?.bind(this)??i;this.manager.onLifecycle(()=>(n.addEventListener(r,o,s),()=>n.removeEventListener(r,o,s)))}async componentOnReady(){return await Ir(this,Vy).promise,this}addController(n){this.M.push(n),!(aW in n)&&this.renderRoot&&this.el.isConnected&&n.hostConnected?.()}removeController(n){this.M.splice(this.M.indexOf(n),1),n.controllerRemoved?.()}};Fy=new WeakMap,fA=new WeakMap,pA=new WeakMap,Vy=new WeakMap,Yh=new WeakMap,P2=new WeakSet,i_e=function(n){try{Ir(this,Yh).clear(),this.constructor.K.r(Ir(this,Yh),()=>iY(UT.prototype,this,"update").call(this,n))}catch(r){throw Ir(this,Yh).clear(),r}},s_e=async function(){const n=this.el.G??Jve(this.el);n&&await n;const r=[];for(const s of this.M)"triggerLoad"in s?r.push(s.triggerLoad()):r.push(hV(s.hostLoad,s));await Promise.all(r),await this.load?.(),this.manager.hasDestroy&&this.manager.onUpdate(s=>s.has(mV)&&this.manager.U()),Ir(this,pA).call(this,!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const i=this.J.filter(s=>!s.manager?.loadedCalled);i.length&&await Promise.allSettled(i.map(async s=>await s.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const s of this.M)"triggerLoaded"in s?s.triggerLoaded():Ri(s.hostLoaded,s);this.loaded?.(),Ir(this,Vy).resolve()},UT.lumina=!0;let Are=UT;const hnt=t=>{let e;const n=i=>{e=new URL(i,globalThis.location?.href||void 0).href},r={...t,getAssetPath(i){const s=new URL(i,e);return s.origin!==globalThis.location?.origin?s.href:s.pathname},setAssetPath:n,customElement(i,s){s.K=r,s.L=i,customElements.get(i)||customElements.define(i,s)}};return n(t.defaultAssetPath),r},B5t=t=>typeof t=="object"&&t!=null?ont(t):t,W5t=t=>typeof t=="object"&&t!=null?lnt(t):t,H5t=Zi;function q5t(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}const K5t={toAttribute:t=>t===!0?"":t===!1?null:t},dnt="calcite-mode-auto",fnt="calcite-mode-dark",Y5t={rtl:"calcite--rtl"},X5t={filter:250,nextTick:0,resize:150,reposition:100},Z5t=25;function Ire(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,n=()=>t.contains(fnt)||t.contains(dnt)&&e?"dark":"light",r=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),i=o=>{s!==o&&r(o),s=o};let s=n();r(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>i(o.matches?"dark":"light")),new MutationObserver(()=>i(n())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const wT=globalThis.calciteConfig,J5t=wT?.focusTrapStack||[],Q5t=wT?.logLevel||"info",Rre="3.3.3",pnt="2025-10-08",mnt="7391af08e";function gnt(){if(wT&&wT.version)return;console.info(`Using Calcite Components ${Rre} [Date: ${pnt}, Revision: ${mnt}]`);const t=wT||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:Rre,writable:!1}),globalThis.calciteConfig=t}document.readyState==="interactive"?Ire():document.addEventListener("DOMContentLoaded",Ire,{once:!0});queueMicrotask(gnt);const ynt=hnt({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.3.3/",hydratedAttribute:"calcite-hydrated"}),{customElement:eOt,getAssetPath:tOt,setAssetPath:vnt}=ynt;let o_e=!1;const _nt=t=>{o_e=!0,vnt(t)};let a_e;function xnt(){o_e||_nt(Bc(Ui(a_e)))}function mW(t){const e=[];for(const n of Object.keys(t))customElements.get(`calcite-${n}`)||e.push(t[n]?.());return e.length>0?Promise.all(e):null}a_e="components/assets";const l_e=Symbol("widget"),c_e=Symbol("widget-test-data"),wnt=[],bnt={},Z4=new WeakMap;function u_e(t,e){let n=e.children;if(n?.length)for(let i=0;i<n.length;++i)n[i]=u_e(t,n[i]);else n=wnt;const r=e.vnodeSelector;if(J4(r)){const i=e.properties||bnt,s=i.key||r,o={key:s,afterCreate:Ent,afterUpdate:Snt,afterRemoved:h_e,parentWidget:t,widgetConstructor:r,widgetProperties:{...i,key:s,children:n}};return{vnodeSelector:r.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function Ent(t,e,n,{parentWidget:r,widgetConstructor:i,widgetProperties:s}){const o=new i(s);o.container=t,Z4.set(t,o),o.afterCreate?.(o,t),r.addHandles(qn(()=>h_e(t))),queueMicrotask(()=>{o[c_e].projector?.renderNow()})}function Snt(t,e,n,{widgetProperties:r}){const i=Z4.get(t);i&&(i.set(r),i.afterUpdate?.(i,t))}function h_e(t){const e=Z4.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),Z4.delete(t))}function J4(t){return typeof t=="function"&&t[l_e]}const Pre=new Set;function Tnt(t){Pre.add(t),t.finally(()=>Pre.delete(t))}function knt(t){return qn()}var Mre;let Ant=0;function d_e(t,e){const n=Object.prototype.hasOwnProperty;for(const r in e)n.call(e,r)&&n.call(t,r)&&(t[r]!=null&&e[r]!=null&&typeof t[r]=="object"&&typeof e[r]=="object"?d_e(t[r],e[r]):t[r]=e[r]);return t}const Int=dtt({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,n=/capture$/i;t.eventHandlerInterceptor=(r,i,s,o)=>{const a=e?.(r,i,s,o),l=n.test(r);if(!((r=r.replace(n,"")).toLowerCase()in s)||l){const c=r[2].toLowerCase()+r.slice(3),u=g=>a?.call(s,g);s.addEventListener(c,u,l);const h=()=>s.removeEventListener(c,u,l),f=o.afterRemoved;o.afterRemoved=g=>{f?.(g),h()}}return a}},handleInterceptedEvent(t,e,n,r){const{eventPhase:i,type:s}=r,o=i===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,l&&a in l))&&(Gve(),t.scheduleRender(),l[a].call(l.bind||n,r))}});let r8=!1;var l1;let Xs=(l1=class extends $fe(tI){constructor(e,n){super(e,n),this._attached=!1,this._projector=Int,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=e6e(async()=>{if(this._messageBundleProps?.length){const l=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:c,propertyName:u})=>{if(this.destroyed)return;let h=await vpe(c);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(h=d_e(Ze(h),this.uiStrings)),this[u]=h)}));if(this.destroyed)return;for(const c of l)c.status==="rejected"&&St.getLogger(this).error("widget-intl:locale-error",this.declaredClass,c.reason)}await this.loadLocale()}),this.addHandles(knt()),xnt();const r="esri-widget-uid-"+uI(),i=this.render.bind(this);this._trackingTarget=new eO(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const s=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const l=i()??s(),c=l.properties??={};if(c.key??=r,J4(l.vnodeSelector)){if(!this.visible)return s()}else this.visible?c.styles||(c.styles={}):(c.class="",c.styles={display:"none"}),c.styles.display??="";let u=0;return l.children?.forEach(h=>{J4(h.vnodeSelector)||(h.properties??={},h.properties.key??=`${this.id}--${u++}`)}),u_e(this,l)};this.render=()=>{if(r8)return o();let l=Jet(this)??null;if(l)return l;this._trackingTarget.clear(),r8=!0;try{l=ap(this._trackingTarget,o)}catch(c){throw St.getLogger(this).error(c),c}finally{r8=!1}return l&&Qet(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Tnt(this._resourcesFetch)}normalizeCtorArgs(e,n){const r={...e};return n&&(r.container=n),r}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(JJ):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(Ci(this._trackingTarget),Ci(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,Q$(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return PB(e)}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+Ant++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(Mre=l_e,c_e)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(Q$(this),this._projector.scheduleRender())}classes(...e){return ett.apply(this,e)}renderNow(){Q$(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(dn(()=>this.viewModel,(n,r)=>{r&&this.removeHandles("delegated-events"),n&&X5(n)&&this.addHandles(this._delegatedEventNames.map(i=>B2(n,i,s=>{this.emit(i,s)})),"delegated-events")},ea)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(JJ),this.scheduleRender()};this.addHandles([mpe(e),dn(()=>this.uiStrings,e)]),this.addHandles(hc(()=>this.container,n=>{this.destroyed||this._attach(n)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}},l1[Mre]=!0,l1.vnodeSelector="div",l1);_([E()],Xs.prototype,"_readyForTrueRender",void 0),_([E({value:null})],Xs.prototype,"container",null),_([zs("container")],Xs.prototype,"castContainer",null),_([E()],Xs.prototype,"icon",null),_([E()],Xs.prototype,"id",null),_([E()],Xs.prototype,"label",null),_([E()],Xs.prototype,"renderable",null),_([E()],Xs.prototype,"uiStrings",void 0),_([E()],Xs.prototype,"viewModel",void 0),_([E({value:!0})],Xs.prototype,"visible",null),_([E()],Xs.prototype,"key",void 0),_([E()],Xs.prototype,"children",void 0),_([E()],Xs.prototype,"afterCreate",void 0),_([E()],Xs.prototype,"afterUpdate",void 0),_([E()],Xs.prototype,"afterRemoved",void 0),Xs=_([ue("esri.widgets.Widget")],Xs);const VO=Xs,Rnt=new Map;function Pnt(t){return Rnt.get(t)}function Cre(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function Mnt(t,e){return t.length!==e.length||t.some((n,r)=>n.text!==e[r].text)}function ZP(t,e,n){!n||!e||t.find(r=>r.layerView===e&&r.text===n)||t.push({text:n,layerView:e})}function Cnt(t){return t.type==="bing-maps"}const Oh=[];let sx=class extends Kt{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Ot,this.view=null,this._allLayerViewsChange=e=>{this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const n=this.view?.allLayerViews;n&&(this.addHandles(n.map(r=>dn(()=>[r.suspended,r.layer?.attributionVisible],()=>this._updateAttributionItems())).toArray(),"suspension"),n.forEach(r=>{r.declaredClass==="esri.views.3d.layers.IntegratedMesh3DTilesLayerView3D"&&this.addHandles(r.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),e?.removed&&e.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.addHandles([$1(()=>this.view?.allLayerViews,"change",e=>this._allLayerViewsChange(e),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),hc(()=>this.view?.stationary===!0,()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.view?.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,e=t?.allLayerViews;Oh.length=0;let n=!1,r=null;if(!t||!e)return void this._clear();e.forEach(s=>{if(s.suspended||!s.layer?.attributionVisible)return;const o=s.layer;if(Cre(o,"user"))return void ZP(Oh,s,o.copyright);if(o.type==="integrated-mesh-3dtiles"&&o.hasGoogleUrl&&(n=!0,r=s),o.hasAttributionData){if(this._fetchedAttributionData.has(s)){const l=this._fetchedAttributionData.get(s);return void(l?ZP(Oh,s,this._getDynamicAttribution(l,t,o)):Cre(o)&&ZP(Oh,s,o.copyright))}return void this._fetchAttributionData(s)}const a="portalItem"in o?o.portalItem?.accessInformation:void 0;ZP(Oh,s,a||o.copyright)});const i=e.find(s=>s.layer?.type==="integrated-mesh-3dtiles");if(this.view&&i){const s=Pnt(this.view);if(s){const o=s.getAttributionText();for(let a=o.length-1;a>-1;--a)Oh.unshift({text:o[a],layerView:i})}}n&&r&&Oh.unshift({text:"Google Maps",layerView:r}),Mnt(this.items,Oh)&&(this.items.removeAll(),this.items.addMany(Oh)),Oh.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await jfe(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const n=e.ok?this._createContributionIndex(e.value,Cnt(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,n)}this._updateAttributionItems()}_createContributionIndex(t,e){const n=t.contributors,r={};if(!n)return r;for(let i=0;i<n.length;i++){const s=n[i],o=s.coverageAreas;if(!o)return;for(const a of o){const l=a.bbox,c=a.zoomMin-(e&&a.zoomMin?1:0),u=a.zoomMax-(e&&a.zoomMax?1:0),h=new Dn({xmin:l[1],ymin:l[0],xmax:l[3],ymax:l[2],spatialReference:Bt.WGS84}),f={extent:Yy(h),attribution:s.attribution||"",score:a.score!=null?a.score:100,id:i};for(let g=c;g<=u;g++)r[g]??=[],r[g].push(f)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,n){const{extent:r,scale:i}=e;let s=n.tileInfo?.scaleToZoom(i)??0;if(s=Math.min(t.maxKey??0,Math.round(s)),!r||s==null||s<=-1)return"";const o=t[s],a=lO(r.center.clone().normalize(),Bt.WebMercator),l=new Set;return o?o.filter(c=>{const u=c.id,h=!l.has(u)&&a&&c.extent&&iI(c.extent,a);return h&&l.add(u),h}).sort((c,u)=>u.score-c.score||c.objectId-u.objectId).map(c=>c.attribution).join(", "):""}};_([E({readOnly:!0,type:Ot})],sx.prototype,"items",void 0),_([E({readOnly:!0})],sx.prototype,"state",null),_([E()],sx.prototype,"view",void 0),sx=_([ue("esri.widgets.Attribution.AttributionViewModel")],sx);const f_e=sx,yd={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function Nnt(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:Lnt(t[e])}}}function Ont(t){const e=t?.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function Lnt(t){return function(e,...n){Ont(e)?ntt(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...n)}}function zO(t){return(e,n)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:n})}}var Dnt=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},p_e=function(t,e){for(var n=0,r=t.length;n<r;n++){var i=t[n];Array.isArray(i)?p_e(i,e):i!=null&&i!==!1&&(i.hasOwnProperty("vnodeSelector")||(i=Dnt(i)),e.push(i))}},$nt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(n.length===1&&typeof n[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:n[0],domNode:null};var i=[];return p_e(n,i),{vnodeSelector:t,properties:e||void 0,children:i,text:void 0,domNode:null}};function ml(t,e,...n){return typeof t!="function"||J4(t)?$nt(t,e??null,...n):t(e,...n)}function nOt(...t){return t}const b_="esri-attribution",E_={base:b_,poweredBy:`${b_}__powered-by`,sources:`${b_}__sources`,open:`${b_}--open`,sourcesOpen:`${b_}__sources--open`,link:`${b_}__link`};let wa=class extends VO{constructor(e,n){super(e,n),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._sourcesNode=null,this._overflowRequestAnimationFrame=null,this._resizeObserver=new ResizeObserver(r=>{r.forEach(({target:i})=>{this._scheduleOverflowCheck(i)})}),this._mutationObserver=new MutationObserver(r=>{let i=!1;for(const s of r)if(s.type==="childList"||s.type==="characterData"||s.type==="attributes"){i=!0;break}i&&this._sourcesNode&&this._scheduleOverflowCheck(this._sourcesNode)}),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new f_e}initialize(){this.addHandles($1(()=>this.viewModel?.items,"change",()=>this.scheduleRender()))}destroy(){this._resizeObserver?.disconnect(),this._mutationObserver?.disconnect(),this._overflowRequestAnimationFrame!=null&&(cancelAnimationFrame(this._overflowRequestAnimationFrame),this._overflowRequestAnimationFrame=null)}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}_scheduleOverflowCheck(e){this._overflowRequestAnimationFrame==null&&(this._overflowRequestAnimationFrame=requestAnimationFrame(()=>{this._overflowRequestAnimationFrame=null,this._checkSourceTextOverflow(e)}))}get attributionText(){return this.viewModel.items.reduce((e,n)=>(e.includes(n.text)||e.push(n.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[E_.open]:this._isOpen};return ml("div",{bind:this,class:this.classes(E_.base,yd.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return ml("div",{class:E_.poweredBy},"Powered by"," ",ml("a",{class:E_.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,n=this._isInteractive,r=n?0:void 0,{attributionText:i}=this,s={[E_.sourcesOpen]:e,[yd.interactive]:n};return ml("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(E_.sources,s),innerHTML:i,tabIndex:r})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._sourcesNode=e,this._resizeObserver.observe(e),this._mutationObserver.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0}),this._scheduleOverflowCheck(e)}_checkSourceTextOverflow(e){let n=!1;const{clientHeight:r,clientWidth:i,scrollWidth:s}=e,o=s>i,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(n=!0),this._isOpen){const l=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,l&&(this._isOpen=!1,n=!0)}n&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};_([E()],wa.prototype,"_isOpen",void 0),_([E()],wa.prototype,"_isInteractive",null),_([E()],wa.prototype,"_attributionTextOverflowed",void 0),_([E()],wa.prototype,"_prevSourceNodeHeight",void 0),_([E({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],wa.prototype,"attributionText",null),_([E()],wa.prototype,"icon",null),_([E()],wa.prototype,"itemDelimiter",void 0),_([E()],wa.prototype,"label",null),_([E(),zO("esri/widgets/Attribution/t9n/Attribution")],wa.prototype,"messages",void 0),_([E()],wa.prototype,"view",null),_([E({type:f_e})],wa.prototype,"viewModel",void 0),_([Nnt()],wa.prototype,"_toggleState",null),wa=_([ue("esri.widgets.Attribution")],wa);const jnt=wa;function Fnt(){const t=ve("mapview-essential-goto-duration");return t==null?t:t}function Vnt(t){return t?.spatialReference?.isWebMercator||t?.spatialReference?.isGeographic||!1}function znt(t,e,n){return t.goTo(e,n)}const Unt=t=>{const e=t;let n=class extends e{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:i}=this;return Cde(i),this.goToOverride?this.goToOverride(i,r):znt(i,r.target,r.options)}};return _([E()],n.prototype,"goToOverride",void 0),_([E()],n.prototype,"view",void 0),n=_([ue("esri.widgets.support.GoTo")],n),n};let sy=class extends Unt(Kt){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(fa)}destroy(){this.view=null}get canShowNorth(){return Vnt(this.view)}get state(){return!this.view?.ready||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){this.view?.ready&&(this.view?.type==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:Fnt()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const n=-e.heading;this._set("orientation",{x:0,y:0,z:n})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?dn(()=>e?.rotation,this._updateForRotation,fa):dn(()=>e?.camera,this._updateForCamera,fa))}_watchForView(e){this.addHandles(dn(()=>this.view,this._updateRotationWatcher,e))}};_([E({readOnly:!0})],sy.prototype,"canShowNorth",null),_([E({readOnly:!0})],sy.prototype,"orientation",void 0),_([E({readOnly:!0})],sy.prototype,"state",null),_([E()],sy.prototype,"view",void 0),sy=_([ue("esri.widgets.Compass.CompassViewModel")],sy);const m_e=sy,Nre="esri-compass",Ore={base:Nre,iconContainer:`${Nre}__icon-container`};let xf=class extends VO{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new m_e,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=r=>({transform:`rotateZ(${r.z}deg)`})}loadDependencies(){return mW({button:()=>xe(()=>import("./index-D23hXsub.js"),__vite__mapDeps([407,408,409,410,411,412,413,414,415,416,417,418,419,420])),icon:()=>xe(()=>import("./index-Buz8uJGw.js").then(e=>e.i),__vite__mapDeps([412,413,414]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:n}=this.viewModel,{messages:r}=this;return ml("div",{class:this.classes(Ore.base,yd.widget)},ml("calcite-button",{class:yd.widgetButton,disabled:n==="disabled",kind:"neutral",label:r.reset,onclick:this._reset,round:!0,scale:"s",title:r.reset},ml("div",{"aria-hidden":"true",class:Ore.iconContainer,title:r.reset},ml("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};_([E()],xf.prototype,"goToOverride",null),_([E()],xf.prototype,"icon",null),_([E()],xf.prototype,"label",null),_([E(),zO("esri/widgets/Compass/t9n/Compass")],xf.prototype,"messages",void 0),_([E()],xf.prototype,"view",null),_([E({type:m_e})],xf.prototype,"viewModel",void 0),xf=_([ue("esri.widgets.Compass")],xf);const Gnt=xf,Lre="esri-navigation-toggle",Dre={base:Lre,isLayoutHorizontal:`${Lre}--horizontal`};let ox=class extends Kt{constructor(t){super(t),this._navigationMode="pan",this.view=null,t?.isDefaultViewModel||M6e(St.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.33"})}normalizeCtorArgs(t={}){const{isDefaultViewModel:e,...n}=t;return n}initialize(){this.addHandles(hc(()=>this.view?.navigation?.actionMap,()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){return this.view?.ready&&this.view?.type==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(t){this._navigationMode=t,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){const t=this.view?.navigation?.actionMap;if(!t)return;const e=this._navigationMode==="pan";t.dragPrimary=e?"pan":"rotate",t.dragSecondary=e?"rotate":"pan"}};_([E({readOnly:!0})],ox.prototype,"state",null),_([E()],ox.prototype,"_navigationMode",void 0),_([E()],ox.prototype,"view",void 0),ox=_([ue("esri.widgets.NavigationToggle.NavigationToggleViewModel")],ox);const g_e=ox;let wf=class extends VO{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new g_e({isDefaultViewModel:!0}),this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{const r=this.viewModel?.navigationMode==="pan"?this._rotateButton:this._panButton;rtt(r),this.toggle()},e?.isDefaultUI||P6e(St.getLogger(this),"Navigation Toggle","arcgis-navigation-toggle",{version:"4.32"})}normalizeCtorArgs(e={}){const{isDefaultUI:n,...r}=e;return r}loadDependencies(){return mW({button:()=>xe(()=>import("./index-D23hXsub.js"),__vite__mapDeps([407,408,409,410,411,412,413,414,415,416,417,418,419,420]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.viewModel?.state==="disabled",n=this.viewModel?.navigationMode==="pan",r=this.messages.toggle;return ml("div",{class:this.classes(Dre.base,yd.widget,{[Dre.isLayoutHorizontal]:this.layout==="horizontal"})},ml("calcite-button",{afterCreate:i=>{this._panButton=i},appearance:n?"outline-fill":"solid",class:yd.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:r,onclick:this._toggle,tabIndex:n?void 0:-1,title:r}),ml("calcite-button",{afterCreate:i=>{this._rotateButton=i},appearance:n?"solid":"outline-fill",class:yd.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:r,onclick:this._toggle,tabIndex:n?-1:void 0,title:r}))}};_([E()],wf.prototype,"icon",null),_([E()],wf.prototype,"label",null),_([E({value:"vertical"})],wf.prototype,"layout",null),_([E(),zO("esri/widgets/NavigationToggle/t9n/NavigationToggle")],wf.prototype,"messages",void 0),_([E()],wf.prototype,"view",null),_([E({type:g_e})],wf.prototype,"viewModel",void 0),wf=_([ue("esri.widgets.NavigationToggle")],wf);const Bnt=wf;let oy=class extends Kt{get canZoomIn(){if(!this.view?.ready)return!1;const n=this.view?.constraints?.effectiveMaxScale;return n===0||this._scale>n}get canZoomOut(){const{view:e}=this;if(!e?.ready)return!1;const r=e.constraints?.effectiveMinScale;return r===0||this._scale<r}get _scale(){const e=this.view?.animation?.target;return(e&&"then"in e?void 0:e?.scale)??this.view?.scale??0}};_([E({readOnly:!0})],oy.prototype,"canZoomIn",null),_([E({readOnly:!0})],oy.prototype,"canZoomOut",null),_([E()],oy.prototype,"view",void 0),_([E()],oy.prototype,"_scale",null),oy=_([ue("esri.widgets.Zoom.ZoomConditions2D")],oy);const Wnt=oy;let ax=class extends Kt{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};_([E({readOnly:!0})],ax.prototype,"canZoomIn",null),_([E({readOnly:!0})],ax.prototype,"canZoomOut",null),_([E()],ax.prototype,"view",void 0),ax=_([ue("esri.widgets.Zoom.ZoomConditions3D")],ax);const Hnt=ax;let Sm=class extends Kt{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){return this._zoomConditions!=null&&this._zoomConditions?.canZoomOut}get state(){return this.view?.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Wnt({view:e}):e.type==="3d"&&(this._zoomConditions=new Hnt({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():e4(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():e4(e.goTo({zoomFactor:.5})))}};_([E()],Sm.prototype,"_zoomConditions",void 0),_([E()],Sm.prototype,"canZoomIn",null),_([E()],Sm.prototype,"canZoomOut",null),_([E({readOnly:!0})],Sm.prototype,"state",null),_([E()],Sm.prototype,"view",null),Sm=_([ue("esri.widgets.Zoom.ZoomViewModel")],Sm);const y_e=Sm,$re={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let bf=class extends VO{constructor(e,n){super(e,n),this.messages=null,this.viewModel=new y_e,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return mW({button:()=>xe(()=>import("./index-D23hXsub.js"),__vite__mapDeps([407,408,409,410,411,412,413,414,415,416,417,418,419,420]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[$re.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:n,canZoomOut:r}=this.viewModel,{zoomIn:i,zoomOut:s}=this.messages;return ml("div",{class:this.classes($re.base,yd.widget,e)},ml("calcite-button",{class:yd.widgetButton,disabled:!n,iconStart:"plus",kind:"neutral",label:i,onclick:this.zoomIn,title:i}),ml("calcite-button",{class:yd.widgetButton,disabled:!r,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};_([E()],bf.prototype,"icon",null),_([E()],bf.prototype,"label",null),_([E({value:"vertical"})],bf.prototype,"layout",null),_([E(),zO("esri/widgets/Zoom/t9n/Zoom")],bf.prototype,"messages",void 0),_([E()],bf.prototype,"view",null),_([E({type:y_e})],bf.prototype,"viewModel",void 0),bf=_([ue("esri.widgets.Zoom")],bf);const qnt=bf;function Knt(t){return t?.view!==void 0}let FC=class extends ott{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=e=>{this.components.forEach(n=>{const r=this._find(n),i=r?.widget;Knt(i)&&(i.view=e)})},this._componentsWatcher=(e,n)=>{this._removeComponents(n),this._addComponents(e),this._adjustPadding(e)}}initialize(){this.addHandles([dn(()=>this.components,this._componentsWatcher,fa),dn(()=>this.view,this._updateViewAwareWidgets,fa)])}_add(t,e,n,r,i){let s=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;s=this._createComponent(t)}super._add(s,e,n,r,i)}_removeComponents(t){t.forEach(e=>{const n=this._find(e);n&&(this.remove(n),n.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:e}=this.padding;this.padding=e}}_addComponents(t){this.constructed&&t.forEach(e=>this.add(this._createComponent(e),this._defaultPositionLookup[e]))}_createComponent(t){const e=this._createWidget(t);return new DC({id:t,node:e})}_createWidget(t){const e=this.view;switch(t){case"attribution":return new jnt({view:e});case"compass":return new Gnt({view:e});case"navigation-toggle":return new Bnt({view:e,isDefaultUI:!0});case"zoom":return new qnt({view:e})}}};_([E()],FC.prototype,"components",void 0),FC=_([ue("esri.views.ui.DefaultUI")],FC);const v_e=FC;let VC=class extends v_e{constructor(e){super(e),this.components=["attribution","zoom"]}};_([E()],VC.prototype,"components",void 0),VC=_([ue("esri.views.ui.2d.DefaultUI2D")],VC);const __e=VC;let Ynt=class{constructor(t={},e={},n=8,r=1/0){this.disabledExtensions=t,this.debugWebGLExtensions=e,this.maxAnisotropy=n,this.maxPreferredTexturePixels=r}},Xnt=class gV{constructor(e,n,r=""){this.major=e,this.minor=n,this._context=r}lessThan(e,n){return this.major<e||e===this.major&&this.minor<n}greaterEqual(e,n){return!this.lessThan(e,n)}validate(e){if(this.major!==e.major){const n=this._context&&this._context+":",r=this._context&&this._context+" ";throw new Xe(n+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new gV(this.major,this.minor,this._context)}static parse(e,n=""){const[r,i]=e.split("."),s=/^\s*\d+\s*$/;if(!r?.match||!s.test(r))throw new Xe((n&&n+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!i?.match||!s.test(i))throw new Xe((n&&n+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(r,10),a=parseInt(i,10);return new gV(o,a,n)}};class Znt extends Xnt{constructor(e,n){super(e,n,"webmap")}}function i8(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new Znt(2,35);var yV;let zC=yV=class extends qt{constructor(t){super(t),this.color=new Kn([0,0,0,1])}clone(){return new yV(Ze({color:this.color}))}};_([E({type:Kn,json:{write:!0}})],zC.prototype,"color",void 0),zC=yV=_([ue("esri.webmap.background.ColorBackground")],zC);const Jnt=zC;let x_e,w_e,b_e,E_e,S_e,T_e,k_e;async function Qnt(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:n,MapViewNavigation:r,MagnifierView2D:i,GridView2D:s,Stage:o}]=await Promise.all([xe(()=>import("./webglDeps-PJGhStvc.js"),__vite__mapDeps([305,247,306,307,308,49,142])),xe(()=>import("./mapViewDeps-BnHV3PZw.js"),__vite__mapDeps([309,28,29,30,179,180,172,50,49,181,33,34,178,182,168,18,19,310,311,247,306,307,238,169,312,174,308,142,246,141,313,167,201,314,57,224,227,118,51,8,175,186,315,183,184,316,39,40,170,127,128,317,108,305,318,196,319,320,223,321,236,237,322,48,166,171,173,22,122,121,323,185,324,177,102,103,104,325,187,192,164,326,327,328,329,243,267,330,331]))]);w_e=t,b_e=e,E_e=n,S_e=r,T_e=i,k_e=s,x_e=o}var Nw;let jn=(Nw=class extends DJe(fZe(VBe(hHe(YWe($Ye))))){get timeZone(){return super.timeZone}set timeZone(e){super.timeZone=e}constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new Hu({getCollections:()=>[this.basemapView?.baseLayerViews,this.layerViews,this.basemapView?.referenceLayerViews],getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new PO({actionMap:new KB({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.analyses=new y2,this.analysisViewManager=new Oet({importAnalysisViewModule:n=>TQe(n),view:this}),this.floors=new Ot,this.grid=null,this.map=null,this.timeline=new Fve,this.type="2d",this.view2dType=null,this.ui=new __e,this.animationsEnabled=!0,this.test={takeScreenshot:async n=>Ret(this._getScreenshotView(n),n)},this.padding={top:0,right:0,bottom:0,left:0},$Be()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=Ci(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new LQe(this.featuresTilingScheme)}get constraintsInfo(){const e=this.defaultsFromMap?.tileInfo,n=this.spatialReference;return{lods:e?.spatialReference?.equals(n)?e.lods:null,spatialReference:n}}get initialExtentRequired(){if(!this.stateManager)return!1;const{scale:e,constraints:n,center:r,viewpoint:i,extent:s}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties?.viewpoint)&&!s&&(n?.effectiveLODs||(o=-1),(!r||e===0&&o===-1)&&(i?.targetGeometry==null||i.targetGeometry.type!=="extent"&&!i.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const n=e.targetGeometry,r=this.spatialReference;return Hge(n.spatialReference,r)}get background(){return i8(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){return this.stateManager?.center??null}set center(e){this.stateManager.center=e}get constraints(){return super.constraints}set constraints(e){super.constraints=e}get highlightOptions(){return det(this)}set highlightOptions(e){fet(this,e)}get padding(){return this.stateManager?.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){return this.stage?.renderRequested??!1}get resizeAlign(){return super.resizeAlign}set resizeAlign(e){super.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return super.rotation}set rotation(e){super.rotation=e}get scale(){return this.stateManager?.scale??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get spatialReference(){return super.spatialReference}set spatialReference(e){super.spatialReference=e}get spatialReferenceLocked(){return this._get("spatialReferenceLocked")}set spatialReferenceLocked(e){this.stage&&St.getLogger(this).warn("spatialReferenceLocked cannot be changed after the view has become ready"),this._set("spatialReferenceLocked",e)}get tileInfo(){return this.featuresTilingScheme?.tileInfo}get updating(){const e=!(!this.magnifier.visible||this.magnifier.position===null||!this._magnifierView?.updatingHandles.updating),n=!this.destroyed&&(!this.analysisViewManager||!this.layerViewManager||!this.labelManager||!this.graphicsView||this.analysisViewManager.updating===!0||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(r=>!r.destroyed&&!("layerViews"in r)&&r.updating===!0)||e);if(ve("esri-2d-log-updating")){const r=this.allLayerViews.reduce((i,s)=>({...i,[`${s.layer.id}(${s.layer.type})`]:!s.destroyed&&!("layerViews"in s)&&s.updating}),{});console.log(`Updating MapView: ${n}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${this.layerViewManager?.updating}
-> labelManager.updating: ${this.labelManager?.updating}
-> graphicsView.updating: ${this.graphicsView?.updating}
-> allLayerViews: ${JSON.stringify(r)}
-> updatingMagnifier: ${e}
`)}return n}get viewpoint(){return super.viewpoint}set viewpoint(e){super.viewpoint=e}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new yi({rings:[e.map(n=>[n[0],n[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){return this.mapViewNavigation?.interacting??!1}async hitTest(e,n){return pet(this,e,n)}async takeScreenshot(e){return Iet(this._getScreenshotView(e),e)}toScreen(e,n){return this.stateManager.toScreen(e,n)}async whenAnalysisView(e){if(e.parent==null)throw new Xe("view:no-analysisview-for-analysis","The analysis does not exist in view.analyses",{analysis:e});return this.analysisViewManager.whenAnalysisView(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||this.defaultsFromMap?.spatialReference||null}getDefaultTimeZone(){return i8(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return i8(this.map)?this.map.initialViewProperties.timeExtent:null}getSurface(){return this.surface}hasLayerViewModule(e){return qne.hasLayerViewModule(e)}importLayerView(e){return qne.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(St.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){const n=this.toMap(e),r=await this.hitTest(e),i=this.allLayerViews.toArray().filter(c=>c.clips.every(u=>Ive(this,u,e,n))).reverse(),s=new globalThis.Map(i.map(c=>[c.layer.uid,c])),o=[];let a=0,l=0;for(;a<r.results.length||l<i.length;){const c=r.results.at(a);if(c&&c.type!=="graphic"){++a;continue}const u=s.get((c?.layer??c?.graphic.layer)?.uid);if((!c||u)&&l<i.length&&i.at(l)!==u){const h=i.at(l);"fetchPopupFeaturesAtLocation"in h&&o.push({mapPoint:n,layerView:h}),++l}else c&&(o.push({graphic:c.graphic,layerView:u}),++a)}return{hits:o,location:n}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=zet(this.type);if(ve("safari")&&ve("safari")<9&&(e=new Xe("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ve("safari")})),e!=null)throw St.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return Qnt()}_getDefaultViewpoint(){const{constraints:e,initialExtent:n,map:r,padding:i,size:s}=this;if(!e)return null;const o=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o?.viewpoint,c=l?.targetGeometry?.extent??n,u=c?.center,h=l?.rotation??0,f=l?.scale||c&&CO(c,[s[0]-i.left-i.right,s[1]-i.top-i.bottom]),g=a.center??u,v=a.rotation??h,x=a.scale??f;return g&&x?new tu({targetGeometry:g,scale:x,rotation:v}):null}_startup(){this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,this.defaultsFromMap.extent?.center),this.graphics.owner=this;const n=new kQe(this.surface),r=new x_e(this.surface,{canvas:this.renderCanvas,contextOptions:new Ynt(this.deactivatedWebGLExtensions,this.debugWebGLExtensions),renderingOptions:this.renderingOptions,timeline:this.timeline},n);this.stage=r,this._magnifierView=new T_e,this._magnifierView.magnifier=this.magnifier,this._gridView=new k_e;const i=new E_e({view:this});this._set("labelManager",i);const s=new pQe({view:this});this._set("animationManager",s);const o=new S_e({view:this,animationManager:s});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),r.on("webgl-error",l=>this.fatalError=l.error),dn(()=>this.stationary,l=>r.stationary=l,ea),dn(()=>this.background,l=>{r.backgroundColor=l?.color,this._magnifierView.backgroundColor=l?.color},ea),dn(()=>this.magnifier,l=>this._magnifierView.magnifier=l,ea),dn(()=>this.grid,l=>this._gridView.grid=l,ea),dn(()=>this.renderingOptions,l=>r.renderingOptions=l,ea),dn(()=>this.highlights.items.map(l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})),()=>{r.highlightGradient=uet(r.highlightGradient,this.highlights.items)},ea),dn(()=>this.state.id,()=>r.state=this.state,ea),dn(()=>this.animationsEnabled,l=>{this.stage.animationsEnabled=l},ea)],"map-view"),this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(n=>{this.stage.addChild(n.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new xQe(xa.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const n=new w_e({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new b_e(e)});this._set("graphicsView",n)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){const{allLayerViews:n,padding:r,size:i,stage:s}=this;return{allLayerViews:n,backgroundColor:e?.ignoreBackground?null:this.background?.color,padding:r,size:i,stage:s}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const n of this.allLayerViews)n.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const n of this.allLayerViews)n.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}},Nw.type="2d",Nw);_([E({constructOnly:!0})],jn.prototype,"deactivatedWebGLExtensions",void 0),_([E({constructOnly:!0})],jn.prototype,"debugWebGLExtensions",void 0),_([E({readOnly:!0})],jn.prototype,"featuresTilingScheme",void 0),_([E({readOnly:!0})],jn.prototype,"graphicsTileStore",null),_([E()],jn.prototype,"graphicsView",void 0),_([E()],jn.prototype,"constraintsInfo",null),_([E()],jn.prototype,"initialExtentRequired",null),_([E()],jn.prototype,"labelManager",void 0),_([E({type:PO,nonNullable:!0})],jn.prototype,"navigation",void 0),_([E({constructOnly:!0})],jn.prototype,"renderCanvas",void 0),_([E()],jn.prototype,"renderingOptions",void 0),_([E({constructOnly:!0})],jn.prototype,"supersampleScreenshotsEnabled",void 0),_([E()],jn.prototype,"defaultsFromMapSettings",null),_([E({readOnly:!0})],jn.prototype,"typeSpecificPreconditionsReady",null),_([E(v9(y2,"analyses"))],jn.prototype,"analyses",void 0),_([E()],jn.prototype,"analysisViewManager",void 0),_([E({type:Jnt})],jn.prototype,"background",null),_([E()],jn.prototype,"center",null),_([E({type:Ot})],jn.prototype,"floors",void 0),_([E()],jn.prototype,"grid",void 0),_([E({type:yg})],jn.prototype,"highlightOptions",null),_([E()],jn.prototype,"map",void 0),_([E()],jn.prototype,"padding",null),_([E({readOnly:!0})],jn.prototype,"rendering",null),_([E({readOnly:!0})],jn.prototype,"resolution",null),_([E()],jn.prototype,"scale",null),_([E({type:Boolean,value:!1})],jn.prototype,"spatialReferenceLocked",null),_([E({readOnly:!0})],jn.prototype,"tileInfo",null),_([E({type:Fve,readOnly:!0})],jn.prototype,"timeline",void 0),_([E({readOnly:!0})],jn.prototype,"type",void 0),_([E({readOnly:!0})],jn.prototype,"updating",null),_([E({readOnly:!0})],jn.prototype,"view2dType",void 0),_([E({readOnly:!0})],jn.prototype,"visibleArea",null),_([E()],jn.prototype,"zoom",null),_([E({readOnly:!0})],jn.prototype,"navigating",null),_([E(),zs(t=>t instanceof v_e?t:tO(__e,t))],jn.prototype,"ui",void 0),_([E()],jn.prototype,"animationsEnabled",void 0),jn=_([ue("esri.views.View2D")],jn);const ert=jn;let UC=class extends ert{constructor(t){super(t),this.view2dType="map"}};_([E({readOnly:!0})],UC.prototype,"view2dType",void 0),UC=_([ue("esri.views.MapView")],UC);const trt=UC,jre=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"];function nrt(){const t=X.useRef(null),e=X.useRef(null),n=X.useRef(!1),r=X.useRef(!1),[i,s]=X.useState(!1);HLe({target:"map"});const o=es(T=>T.map),a=es(T=>T.setArcGISMap),l=io(T=>T.registerLayer),c=io(T=>T.setLayerVisibility),u=Nn(T=>T.defaultBackground);X.useEffect(()=>{if(!o){console.warn(" Map not initialized yet");return}console.log(" Initializing map layers...");const T=new Am({properties:{title:"OpenStreetMap",type:"base"},visible:!1,source:new CRe}),A=new Am({properties:{title:"CartoDB (licht)",type:"base"},visible:!0,source:new hy({url:"https://{a-d}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO"})}),I=new Am({properties:{title:"Luchtfoto",type:"base"},visible:!1,source:new hy({url:"https://service.pdok.nl/hwh/luchtfotorgb/wmts/v1_0/Actueel_orthoHR/EPSG:3857/{z}/{x}/{y}.jpeg",attributions:" Kadaster / PDOK Luchtfoto",maxZoom:19})}),R=new Am({properties:{title:"Labels Overlay",type:"overlay"},visible:!1,source:new hy({url:"https://{a-d}.basemaps.cartocdn.com/rastertiles/voyager_only_labels/{z}/{x}/{y}.png",attributions:" OpenStreetMap contributors  CARTO",maxZoom:20}),zIndex:100}),C=new Am({properties:{title:"TMK 1850",type:"base"},visible:!1,source:new hy({url:"https://s.map5.nl/map/gast/tiles/tmk_1850/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})}),V=new Am({properties:{title:"Bonnebladen 1900",type:"base"},visible:!1,source:new hy({url:"https://s.map5.nl/map/gast/tiles/bonne_1900/EPSG3857/{z}/{x}/{y}.png",attributions:" Kadaster / Map5.nl",crossOrigin:"anonymous",maxZoom:14})});o.addLayer(T),o.addLayer(A),o.addLayer(I),o.addLayer(R),o.addLayer(C),o.addLayer(V),console.log(" Base layers added:",{osm:T.getVisible(),cartodb:A.getVisible(),satellite:I.getVisible()}),l("OpenStreetMap",T),l("CartoDB (licht)",A),l("Luchtfoto",I),l("Labels Overlay",R),l("TMK 1850",C),l("Bonnebladen 1900",V),o.updateSize(),console.log(" Map size:",o.getSize()),console.log(" Map center:",o.getView().getCenter()),console.log(" Map zoom:",o.getView().getZoom()),h()},[o,l]);async function h(){if(!o){console.error(" Cannot load layers: map is null");return}const T=GPe();console.log(` Loading ${T.length} immediate-load layers (WMS/Tile)...`);const A=await Promise.allSettled(T.map(async R=>{try{const C=await R.factory();return C?{name:R.name,layer:C}:null}catch(C){return console.warn(` Failed to create ${R.name}:`,C),null}}));let I=0;A.forEach(R=>{if(R.status==="fulfilled"&&R.value){const{name:C,layer:V}=R.value;o.addLayer(V),l(C,V),I++,console.log(`   ${C}`)}}),console.log(` Immediate layers loaded: ${I}/${T.length}`),console.log(` Total layers on map: ${o.getLayers().getLength()}`),console.log(" Vector layers will load on first toggle (lazy loading enabled)")}X.useEffect(()=>{if(!o||!e.current||r.current)return;console.log(" Initializing ArcGIS MapView for AHN layers...");const T=o.getView(),A=T.getCenter(),I=T.getZoom()||8,R=A?Zn(A):[5.5,52],C=new d0e({}),V=new trt({container:e.current,map:C,center:R,zoom:I,constraints:{rotationEnabled:!1},ui:{components:[]}});return V.when(()=>{console.log(" ArcGIS MapView ready"),a(C,V),s(!0),r.current=!0,T.on("change:center",()=>{const M=T.getCenter();if(M){const N=Zn(M);V.goTo({center:N},{animate:!1})}}),T.on("change:resolution",()=>{const M=T.getZoom();M!==void 0&&V.goTo({zoom:M},{animate:!1})})}).catch(M=>{console.error(" ArcGIS MapView initialization failed:",M)}),()=>{V&&V.destroy()}},[o,a]),X.useEffect(()=>{if(!o||n.current)return;const T=setTimeout(()=>{const A=u||"CartoDB (licht)";jre.forEach(I=>{c(I,!1)}),jre.includes(A)?c(A,!0):c("CartoDB (licht)",!0),n.current=!0,console.log(` Default background: ${A}`)},100);return()=>clearTimeout(T)},[o,u,c]);const f=Nn(T=>T.gpsAutoStart),g=bs(T=>T.startTracking),v=X.useRef(!1);X.useEffect(()=>{if(!(!o||v.current)&&f){const T=setTimeout(()=>{g(),v.current=!0,console.log(" GPS autostart enabled - tracking started")},500);return()=>clearTimeout(T)}},[o,f,g]);const x={width:"100%",height:"100vh"},b={position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1,opacity:i?1:0,transition:"opacity 0.3s ease"};return m.jsxs("div",{style:{position:"relative",width:"100%",height:"100vh"},children:[m.jsx("div",{id:"map",ref:t,style:x}),m.jsx("div",{id:"arcgis-map",ref:e,style:b})]})}const gW=X.createContext({});function yW(t){const e=X.useRef(null);return e.current===null&&(e.current=t()),e.current}const UO=X.createContext(null),vW=X.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class rrt extends X.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function irt({children:t,isPresent:e}){const n=X.useId(),r=X.useRef(null),i=X.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=X.useContext(vW);return X.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=i.current;if(e||!r.current||!o||!a)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return s&&(u.nonce=s),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),m.jsx(rrt,{isPresent:e,childRef:r,sizeRef:i,children:X.cloneElement(t,{ref:r})})}const srt=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o})=>{const a=yW(ort),l=X.useId(),c=X.useCallback(h=>{a.set(h,!0);for(const f of a.values())if(!f)return;r&&r()},[a,r]),u=X.useMemo(()=>({id:l,initial:e,isPresent:n,custom:i,onExitComplete:c,register:h=>(a.set(h,!1),()=>a.delete(h))}),s?[Math.random(),c]:[n,c]);return X.useMemo(()=>{a.forEach((h,f)=>a.set(f,!1))},[n]),X.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),o==="popLayout"&&(t=m.jsx(irt,{isPresent:n,children:t})),m.jsx(UO.Provider,{value:u,children:t})};function ort(){return new Map}function A_e(t=!0){const e=X.useContext(UO);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=e,s=X.useId();X.useEffect(()=>{t&&i(s)},[t]);const o=X.useCallback(()=>t&&r&&r(s),[s,r,t]);return!n&&r?[!1,o]:[!0]}const JP=t=>t.key||"";function Fre(t){const e=[];return X.Children.forEach(t,n=>{X.isValidElement(n)&&e.push(n)}),e}const _W=typeof window<"u",I_e=_W?X.useLayoutEffect:X.useEffect,ar=({children:t,custom:e,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1})=>{const[a,l]=A_e(o),c=X.useMemo(()=>Fre(t),[t]),u=o&&!a?[]:c.map(JP),h=X.useRef(!0),f=X.useRef(c),g=yW(()=>new Map),[v,x]=X.useState(c),[b,T]=X.useState(c);I_e(()=>{h.current=!1,f.current=c;for(let R=0;R<b.length;R++){const C=JP(b[R]);u.includes(C)?g.delete(C):g.get(C)!==!0&&g.set(C,!1)}},[b,u.length,u.join("-")]);const A=[];if(c!==v){let R=[...c];for(let C=0;C<b.length;C++){const V=b[C],M=JP(V);u.includes(M)||(R.splice(C,0,V),A.push(V))}s==="wait"&&A.length&&(R=A),T(Fre(R)),x(c);return}const{forceRender:I}=X.useContext(gW);return m.jsx(m.Fragment,{children:b.map(R=>{const C=JP(R),V=o&&!a?!1:c===b||u.includes(C),M=()=>{if(g.has(C))g.set(C,!0);else return;let N=!0;g.forEach(O=>{O||(N=!1)}),N&&(I?.(),T(f.current),o&&l?.(),r&&r())};return m.jsx(srt,{isPresent:V,initial:!h.current||n?void 0:!1,custom:V?void 0:e,presenceAffectsLayout:i,mode:s,onExitComplete:V?void 0:M,children:R},C)})})},ac=t=>t;let R_e=ac;function xW(t){let e;return()=>(e===void 0&&(e=t()),e)}const b2=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},Zf=t=>t*1e3,Jf=t=>t/1e3,art={useManualTiming:!1};function lrt(t){let e=new Set,n=new Set,r=!1,i=!1;const s=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){s.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const g=h&&r?e:n;return u&&s.add(c),g.has(c)||g.add(c),c},cancel:c=>{n.delete(c),s.delete(c)},process:c=>{if(o=c,r){i=!0;return}r=!0,[e,n]=[n,e],e.forEach(a),e.clear(),r=!1,i&&(i=!1,l.process(c))}};return l}const QP=["read","resolveKeyframes","update","preRender","render","postRender"],crt=40;function P_e(t,e){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,o=QP.reduce((T,A)=>(T[A]=lrt(s),T),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:f}=o,g=()=>{const T=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(T-i.timestamp,crt),1),i.timestamp=T,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),u.process(i),h.process(i),f.process(i),i.isProcessing=!1,n&&e&&(r=!1,t(g))},v=()=>{n=!0,r=!0,i.isProcessing||t(g)};return{schedule:QP.reduce((T,A)=>{const I=o[A];return T[A]=(R,C=!1,V=!1)=>(n||v(),I.schedule(R,C,V)),T},{}),cancel:T=>{for(let A=0;A<QP.length;A++)o[QP[A]].cancel(T)},state:i,steps:o}}const{schedule:di,cancel:Fg,state:Eo,steps:s8}=P_e(typeof requestAnimationFrame<"u"?requestAnimationFrame:ac,!0),M_e=X.createContext({strict:!1}),Vre={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},E2={};for(const t in Vre)E2[t]={isEnabled:e=>Vre[t].some(n=>!!e[n])};function urt(t){for(const e in t)E2[e]={...E2[e],...t[e]}}const hrt=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Q4(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||hrt.has(t)}let C_e=t=>!Q4(t);function drt(t){t&&(C_e=e=>e.startsWith("on")?!Q4(e):t(e))}try{drt(require("@emotion/is-prop-valid").default)}catch{}function frt(t,e,n){const r={};for(const i in t)i==="values"&&typeof t.values=="object"||(C_e(i)||n===!0&&Q4(i)||!e&&!Q4(i)||t.draggable&&i.startsWith("onDrag"))&&(r[i]=t[i]);return r}function prt(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...r)=>t(...r);return new Proxy(n,{get:(r,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const GO=X.createContext({});function Kk(t){return typeof t=="string"||Array.isArray(t)}function BO(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const wW=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bW=["initial",...wW];function WO(t){return BO(t.animate)||bW.some(e=>Kk(t[e]))}function N_e(t){return!!(WO(t)||t.variants)}function mrt(t,e){if(WO(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Kk(n)?n:void 0,animate:Kk(r)?r:void 0}}return t.inherit!==!1?e:{}}function grt(t){const{initial:e,animate:n}=mrt(t,X.useContext(GO));return X.useMemo(()=>({initial:e,animate:n}),[zre(e),zre(n)])}function zre(t){return Array.isArray(t)?t.join(" "):t}const yrt=Symbol.for("motionComponentSymbol");function Sx(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function vrt(t,e,n){return X.useCallback(r=>{r&&t.onMount&&t.onMount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):Sx(n)&&(n.current=r))},[e])}const EW=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),_rt="framerAppearId",O_e="data-"+EW(_rt),{schedule:SW}=P_e(queueMicrotask,!1),L_e=X.createContext({});function xrt(t,e,n,r,i){var s,o;const{visualElement:a}=X.useContext(GO),l=X.useContext(M_e),c=X.useContext(UO),u=X.useContext(vW).reducedMotion,h=X.useRef(null);r=r||l.renderer,!h.current&&r&&(h.current=r(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const f=h.current,g=X.useContext(L_e);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&wrt(h.current,n,i,g);const v=X.useRef(!1);X.useInsertionEffect(()=>{f&&v.current&&f.update(n,c)});const x=n[O_e],b=X.useRef(!!x&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,x))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,x)));return I_e(()=>{f&&(v.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),SW.render(f.render),b.current&&f.animationState&&f.animationState.animateChanges())}),X.useEffect(()=>{f&&(!b.current&&f.animationState&&f.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)===null||T===void 0||T.call(window,x)}),b.current=!1))}),f}function wrt(t,e,n,r){const{layoutId:i,layout:s,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:D_e(t.parent)),t.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||a&&Sx(a),visualElement:t,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:c})}function D_e(t){if(t)return t.options.allowProjection!==!1?t.projection:D_e(t.parent)}function brt({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:i}){var s,o;t&&urt(t);function a(c,u){let h;const f={...X.useContext(vW),...c,layoutId:Ert(c)},{isStatic:g}=f,v=grt(c),x=r(c,g);if(!g&&_W){Srt();const b=Trt(f);h=b.MeasureLayout,v.visualElement=xrt(i,x,f,e,b.ProjectionNode)}return m.jsxs(GO.Provider,{value:v,children:[h&&v.visualElement?m.jsx(h,{visualElement:v.visualElement,...f}):null,n(i,c,vrt(x,v.visualElement,u),x,g,v.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&o!==void 0?o:""})`}`;const l=X.forwardRef(a);return l[yrt]=i,l}function Ert({layoutId:t}){const e=X.useContext(gW).id;return e&&t!==void 0?e+"-"+t:t}function Srt(t,e){X.useContext(M_e).strict}function Trt(t){const{drag:e,layout:n}=E2;if(!e&&!n)return{};const r={...e,...n};return{MeasureLayout:e?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const krt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function TW(t){return typeof t!="string"||t.includes("-")?!1:!!(krt.indexOf(t)>-1||/[A-Z]/u.test(t))}function Ure(t){const e=[{},{}];return t?.values.forEach((n,r)=>{e[0][r]=n.get(),e[1][r]=n.getVelocity()}),e}function kW(t,e,n,r){if(typeof e=="function"){const[i,s]=Ure(r);e=e(n!==void 0?n:t.custom,i,s)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,s]=Ure(r);e=e(n!==void 0?n:t.custom,i,s)}return e}const vV=t=>Array.isArray(t),Art=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Irt=t=>vV(t)?t[t.length-1]||0:t,ca=t=>!!(t&&t.getVelocity);function GC(t){const e=ca(t)?t.get():t;return Art(e)?e.toValue():e}function Rrt({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},r,i,s){const o={latestValues:Prt(r,i,s,t),renderState:e()};return n&&(o.onMount=a=>n({props:r,current:a,...o}),o.onUpdate=a=>n(a)),o}const $_e=t=>(e,n)=>{const r=X.useContext(GO),i=X.useContext(UO),s=()=>Rrt(t,e,r,i);return n?s():yW(s)};function Prt(t,e,n,r){const i={},s=r(t,{});for(const f in s)i[f]=GC(s[f]);let{initial:o,animate:a}=t;const l=WO(t),c=N_e(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!BO(h)){const f=Array.isArray(h)?h:[h];for(let g=0;g<f.length;g++){const v=kW(t,f[g]);if(v){const{transitionEnd:x,transition:b,...T}=v;for(const A in T){let I=T[A];if(Array.isArray(I)){const R=u?I.length-1:0;I=I[R]}I!==null&&(i[A]=I)}for(const A in x)i[A]=x[A]}}}return i}const sb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],cv=new Set(sb),j_e=t=>e=>typeof e=="string"&&e.startsWith(t),F_e=j_e("--"),Mrt=j_e("var(--"),AW=t=>Mrt(t)?Crt.test(t.split("/*")[0].trim()):!1,Crt=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,V_e=(t,e)=>e&&typeof t=="number"?e.transform(t):t,cp=(t,e,n)=>n>e?e:n<t?t:n,ob={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Yk={...ob,transform:t=>cp(0,1,t)},eM={...ob,default:1},EI=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Tm=EI("deg"),vd=EI("%"),mn=EI("px"),Nrt=EI("vh"),Ort=EI("vw"),Gre={...vd,parse:t=>vd.parse(t)/100,transform:t=>vd.transform(t*100)},Lrt={borderWidth:mn,borderTopWidth:mn,borderRightWidth:mn,borderBottomWidth:mn,borderLeftWidth:mn,borderRadius:mn,radius:mn,borderTopLeftRadius:mn,borderTopRightRadius:mn,borderBottomRightRadius:mn,borderBottomLeftRadius:mn,width:mn,maxWidth:mn,height:mn,maxHeight:mn,top:mn,right:mn,bottom:mn,left:mn,padding:mn,paddingTop:mn,paddingRight:mn,paddingBottom:mn,paddingLeft:mn,margin:mn,marginTop:mn,marginRight:mn,marginBottom:mn,marginLeft:mn,backgroundPositionX:mn,backgroundPositionY:mn},Drt={rotate:Tm,rotateX:Tm,rotateY:Tm,rotateZ:Tm,scale:eM,scaleX:eM,scaleY:eM,scaleZ:eM,skew:Tm,skewX:Tm,skewY:Tm,distance:mn,translateX:mn,translateY:mn,translateZ:mn,x:mn,y:mn,z:mn,perspective:mn,transformPerspective:mn,opacity:Yk,originX:Gre,originY:Gre,originZ:mn},Bre={...ob,transform:Math.round},IW={...Lrt,...Drt,zIndex:Bre,size:mn,fillOpacity:Yk,strokeOpacity:Yk,numOctaves:Bre},$rt={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},jrt=sb.length;function Frt(t,e,n){let r="",i=!0;for(let s=0;s<jrt;s++){const o=sb[s],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=V_e(a,IW[o]);if(!l){i=!1;const u=$rt[o]||o;r+=`${u}(${c}) `}n&&(e[o]=c)}}return r=r.trim(),n?r=n(e,i?"":r):i&&(r="none"),r}function RW(t,e,n){const{style:r,vars:i,transformOrigin:s}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(cv.has(l)){o=!0;continue}else if(F_e(l)){i[l]=c;continue}else{const u=V_e(c,IW[l]);l.startsWith("origin")?(a=!0,s[l]=u):r[l]=u}}if(e.transform||(o||n?r.transform=Frt(e,t.transform,n):r.transform&&(r.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;r.transformOrigin=`${l} ${c} ${u}`}}const Vrt={offset:"stroke-dashoffset",array:"stroke-dasharray"},zrt={offset:"strokeDashoffset",array:"strokeDasharray"};function Urt(t,e,n=1,r=0,i=!0){t.pathLength=1;const s=i?Vrt:zrt;t[s.offset]=mn.transform(-r);const o=mn.transform(e),a=mn.transform(n);t[s.array]=`${o} ${a}`}function Wre(t,e,n){return typeof t=="string"?t:mn.transform(e+n*t)}function Grt(t,e,n){const r=Wre(e,t.x,t.width),i=Wre(n,t.y,t.height);return`${r} ${i}`}function PW(t,{attrX:e,attrY:n,attrScale:r,originX:i,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(RW(t,c,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:g,dimensions:v}=t;f.transform&&(v&&(g.transform=f.transform),delete f.transform),v&&(i!==void 0||s!==void 0||g.transform)&&(g.transformOrigin=Grt(v,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),r!==void 0&&(f.scale=r),o!==void 0&&Urt(f,o,a,l,!1)}const MW=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),z_e=()=>({...MW(),attrs:{}}),CW=t=>typeof t=="string"&&t.toLowerCase()==="svg";function U_e(t,{style:e,vars:n},r,i){Object.assign(t.style,e,i&&i.getProjectionStyles(r));for(const s in n)t.style.setProperty(s,n[s])}const G_e=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function B_e(t,e,n,r){U_e(t,e,void 0,r);for(const i in e.attrs)t.setAttribute(G_e.has(i)?i:EW(i),e.attrs[i])}const eN={};function Brt(t){Object.assign(eN,t)}function W_e(t,{layout:e,layoutId:n}){return cv.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!eN[t]||t==="opacity")}function NW(t,e,n){var r;const{style:i}=t,s={};for(const o in i)(ca(i[o])||e.style&&ca(e.style[o])||W_e(o,t)||((r=n?.getValue(o))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[o]=i[o]);return s}function H_e(t,e,n){const r=NW(t,e,n);for(const i in t)if(ca(t[i])||ca(e[i])){const s=sb.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=t[i]}return r}function Wrt(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Hre=["x","y","width","height","cx","cy","r"],Hrt={useVisualState:$_e({scrapeMotionValuesFromProps:H_e,createRenderState:z_e,onUpdate:({props:t,prevProps:e,current:n,renderState:r,latestValues:i})=>{if(!n)return;let s=!!t.drag;if(!s){for(const a in i)if(cv.has(a)){s=!0;break}}if(!s)return;let o=!e;if(e)for(let a=0;a<Hre.length;a++){const l=Hre[a];t[l]!==e[l]&&(o=!0)}o&&di.read(()=>{Wrt(n,r),di.render(()=>{PW(r,i,CW(n.tagName),t.transformTemplate),B_e(n,r)})})}})},qrt={useVisualState:$_e({scrapeMotionValuesFromProps:NW,createRenderState:MW})};function q_e(t,e,n){for(const r in e)!ca(e[r])&&!W_e(r,n)&&(t[r]=e[r])}function Krt({transformTemplate:t},e){return X.useMemo(()=>{const n=MW();return RW(n,e,t),Object.assign({},n.vars,n.style)},[e])}function Yrt(t,e){const n=t.style||{},r={};return q_e(r,n,t),Object.assign(r,Krt(t,e)),r}function Xrt(t,e){const n={},r=Yrt(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=r,n}function Zrt(t,e,n,r){const i=X.useMemo(()=>{const s=z_e();return PW(s,e,CW(r),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};q_e(s,t.style,t),i.style={...s,...i.style}}return i}function Jrt(t=!1){return(n,r,i,{latestValues:s},o)=>{const l=(TW(n)?Zrt:Xrt)(r,s,o,n),c=frt(r,typeof n=="string",t),u=n!==X.Fragment?{...c,...l,ref:i}:{},{children:h}=r,f=X.useMemo(()=>ca(h)?h.get():h,[h]);return X.createElement(n,{...u,children:f})}}function Qrt(t,e){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...TW(r)?Hrt:qrt,preloadedFeatures:t,useRender:Jrt(i),createVisualElement:e,Component:r};return brt(o)}}function K_e(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function HO(t,e,n){const r=t.getProps();return kW(r,e,n!==void 0?n:r.custom,t)}const eit=xW(()=>window.ScrollTimeline!==void 0);class tit{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let r=0;r<this.animations.length;r++)this.animations[r][e]=n}attachTimeline(e,n){const r=this.animations.map(i=>{if(eit()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class nit extends tit{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function OW(t,e){return t?t[e]||t.default||t:void 0}const _V=2e4;function Y_e(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<_V;)e+=n,r=t.next(e);return e>=_V?1/0:e}function LW(t){return typeof t=="function"}function qre(t,e){t.timeline=e,t.onfinish=null}const DW=t=>Array.isArray(t)&&typeof t[0]=="number",rit={linearEasing:void 0};function iit(t,e){const n=xW(t);return()=>{var r;return(r=rit[e])!==null&&r!==void 0?r:n()}}const tN=iit(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),X_e=(t,e,n=10)=>{let r="";const i=Math.max(Math.round(e/n),2);for(let s=0;s<i;s++)r+=t(b2(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function Z_e(t){return!!(typeof t=="function"&&tN()||!t||typeof t=="string"&&(t in xV||tN())||DW(t)||Array.isArray(t)&&t.every(Z_e))}const IS=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,xV={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:IS([0,.65,.55,1]),circOut:IS([.55,0,1,.45]),backIn:IS([.31,.01,.66,-.59]),backOut:IS([.33,1.53,.69,.99])};function J_e(t,e){if(t)return typeof t=="function"&&tN()?X_e(t,e):DW(t)?IS(t):Array.isArray(t)?t.map(n=>J_e(n,e)||xV.easeOut):xV[t]}const Fu={x:!1,y:!1};function Q_e(){return Fu.x||Fu.y}function sit(t,e,n){var r;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const s=(r=void 0)!==null&&r!==void 0?r:i.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}function exe(t,e){const n=sit(t),r=new AbortController,i={passive:!0,...e,signal:r.signal};return[n,i,()=>r.abort()]}function Kre(t){return e=>{e.pointerType==="touch"||Q_e()||t(e)}}function oit(t,e,n={}){const[r,i,s]=exe(t,n),o=Kre(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=Kre(h=>{c(h),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,i)});return r.forEach(a=>{a.addEventListener("pointerenter",o,i)}),s}const txe=(t,e)=>e?t===e?!0:txe(t,e.parentElement):!1,$W=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,ait=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function lit(t){return ait.has(t.tagName)||t.tabIndex!==-1}const RS=new WeakSet;function Yre(t){return e=>{e.key==="Enter"&&t(e)}}function o8(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const cit=(t,e)=>{const n=t.currentTarget;if(!n)return;const r=Yre(()=>{if(RS.has(n))return;o8(n,"down");const i=Yre(()=>{o8(n,"up")}),s=()=>o8(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",s,e)});n.addEventListener("keydown",r,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),e)};function Xre(t){return $W(t)&&!Q_e()}function uit(t,e,n={}){const[r,i,s]=exe(t,n),o=a=>{const l=a.currentTarget;if(!Xre(a)||RS.has(l))return;RS.add(l);const c=e(a),u=(g,v)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),!(!Xre(g)||!RS.has(l))&&(RS.delete(l),typeof c=="function"&&c(g,{success:v}))},h=g=>{u(g,n.useGlobalTarget||txe(l,g.target))},f=g=>{u(g,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",f,i)};return r.forEach(a=>{!lit(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),a.addEventListener("focus",c=>cit(c,i),i)}),s}function hit(t){return t==="x"||t==="y"?Fu[t]?null:(Fu[t]=!0,()=>{Fu[t]=!1}):Fu.x||Fu.y?null:(Fu.x=Fu.y=!0,()=>{Fu.x=Fu.y=!1})}const nxe=new Set(["width","height","top","left","right","bottom",...sb]);let BC;function dit(){BC=void 0}const _d={now:()=>(BC===void 0&&_d.set(Eo.isProcessing||art.useManualTiming?Eo.timestamp:performance.now()),BC),set:t=>{BC=t,queueMicrotask(dit)}};function jW(t,e){t.indexOf(e)===-1&&t.push(e)}function FW(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class VW{constructor(){this.subscriptions=[]}add(e){return jW(this.subscriptions,e),()=>FW(this.subscriptions,e)}notify(e,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function rxe(t,e){return e?t*(1e3/e):0}const Zre=30,fit=t=>!isNaN(parseFloat(t));class pit{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=_d.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=_d.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=fit(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new VW);const r=this.events[e].add(n);return e==="change"?()=>{r(),di.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=_d.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Zre)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Zre);return rxe(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Xk(t,e){return new pit(t,e)}function mit(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Xk(n))}function git(t,e){const n=HO(t,e);let{transitionEnd:r={},transition:i={},...s}=n||{};s={...s,...r};for(const o in s){const a=Irt(s[o]);mit(t,o,a)}}function yit(t){return!!(ca(t)&&t.add)}function wV(t,e){const n=t.getValue("willChange");if(yit(n))return n.add(e)}function ixe(t){return t.props[O_e]}const sxe=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,vit=1e-7,_it=12;function xit(t,e,n,r,i){let s,o,a=0;do o=e+(n-e)/2,s=sxe(o,r,i)-t,s>0?n=o:e=o;while(Math.abs(s)>vit&&++a<_it);return o}function SI(t,e,n,r){if(t===e&&n===r)return ac;const i=s=>xit(s,0,1,t,n);return s=>s===0||s===1?s:sxe(i(s),e,r)}const oxe=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,axe=t=>e=>1-t(1-e),lxe=SI(.33,1.53,.69,.99),zW=axe(lxe),cxe=oxe(zW),uxe=t=>(t*=2)<1?.5*zW(t):.5*(2-Math.pow(2,-10*(t-1))),UW=t=>1-Math.sin(Math.acos(t)),hxe=axe(UW),dxe=oxe(UW),fxe=t=>/^0[^.\s]+$/u.test(t);function wit(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||fxe(t):!0}const bT=t=>Math.round(t*1e5)/1e5,GW=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function bit(t){return t==null}const Eit=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,BW=(t,e)=>n=>!!(typeof n=="string"&&Eit.test(n)&&n.startsWith(t)||e&&!bit(n)&&Object.prototype.hasOwnProperty.call(n,e)),pxe=(t,e,n)=>r=>{if(typeof r!="string")return r;const[i,s,o,a]=r.match(GW);return{[t]:parseFloat(i),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Sit=t=>cp(0,255,t),a8={...ob,transform:t=>Math.round(Sit(t))},Dy={test:BW("rgb","red"),parse:pxe("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+a8.transform(t)+", "+a8.transform(e)+", "+a8.transform(n)+", "+bT(Yk.transform(r))+")"};function Tit(t){let e="",n="",r="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,r+=r,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const bV={test:BW("#"),parse:Tit,transform:Dy.transform},Tx={test:BW("hsl","hue"),parse:pxe("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+vd.transform(bT(e))+", "+vd.transform(bT(n))+", "+bT(Yk.transform(r))+")"},Zo={test:t=>Dy.test(t)||bV.test(t)||Tx.test(t),parse:t=>Dy.test(t)?Dy.parse(t):Tx.test(t)?Tx.parse(t):bV.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Dy.transform(t):Tx.transform(t)},kit=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ait(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(GW))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(kit))===null||n===void 0?void 0:n.length)||0)>0}const mxe="number",gxe="color",Iit="var",Rit="var(",Jre="${}",Pit=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zk(t){const e=t.toString(),n=[],r={color:[],number:[],var:[]},i=[];let s=0;const a=e.replace(Pit,l=>(Zo.test(l)?(r.color.push(s),i.push(gxe),n.push(Zo.parse(l))):l.startsWith(Rit)?(r.var.push(s),i.push(Iit),n.push(l)):(r.number.push(s),i.push(mxe),n.push(parseFloat(l))),++s,Jre)).split(Jre);return{values:n,split:a,indexes:r,types:i}}function yxe(t){return Zk(t).values}function vxe(t){const{split:e,types:n}=Zk(t),r=e.length;return i=>{let s="";for(let o=0;o<r;o++)if(s+=e[o],i[o]!==void 0){const a=n[o];a===mxe?s+=bT(i[o]):a===gxe?s+=Zo.transform(i[o]):s+=i[o]}return s}}const Mit=t=>typeof t=="number"?0:t;function Cit(t){const e=yxe(t);return vxe(t)(e.map(Mit))}const Vg={test:Ait,parse:yxe,createTransformer:vxe,getAnimatableNone:Cit},Nit=new Set(["brightness","contrast","saturate","opacity"]);function Oit(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(GW)||[];if(!r)return t;const i=n.replace(r,"");let s=Nit.has(e)?1:0;return r!==n&&(s*=100),e+"("+s+i+")"}const Lit=/\b([a-z-]*)\(.*?\)/gu,EV={...Vg,getAnimatableNone:t=>{const e=t.match(Lit);return e?e.map(Oit).join(" "):t}},Dit={...IW,color:Zo,backgroundColor:Zo,outlineColor:Zo,fill:Zo,stroke:Zo,borderColor:Zo,borderTopColor:Zo,borderRightColor:Zo,borderBottomColor:Zo,borderLeftColor:Zo,filter:EV,WebkitFilter:EV},WW=t=>Dit[t];function _xe(t,e){let n=WW(t);return n!==EV&&(n=Vg),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const $it=new Set(["auto","none","0"]);function jit(t,e,n){let r=0,i;for(;r<t.length&&!i;){const s=t[r];typeof s=="string"&&!$it.has(s)&&Zk(s).values.length&&(i=t[r]),r++}if(i&&n)for(const s of e)t[s]=_xe(n,i)}const Qre=t=>t===ob||t===mn,eie=(t,e)=>parseFloat(t.split(", ")[e]),tie=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return eie(i[1],e);{const s=r.match(/^matrix\((.+)\)$/u);return s?eie(s[1],t):0}},Fit=new Set(["x","y","z"]),Vit=sb.filter(t=>!Fit.has(t));function zit(t){const e=[];return Vit.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e}const S2={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:tie(4,13),y:tie(5,14)};S2.translateX=S2.x;S2.translateY=S2.y;const t1=new Set;let SV=!1,TV=!1;function xxe(){if(TV){const t=Array.from(t1).filter(r=>r.needsMeasurement),e=new Set(t.map(r=>r.element)),n=new Map;e.forEach(r=>{const i=zit(r);i.length&&(n.set(r,i),r.render())}),t.forEach(r=>r.measureInitialState()),e.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([s,o])=>{var a;(a=r.getValue(s))===null||a===void 0||a.set(o)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}TV=!1,SV=!1,t1.forEach(t=>t.complete()),t1.clear()}function wxe(){t1.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(TV=!0)})}function Uit(){wxe(),xxe()}class HW{constructor(e,n,r,i,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=r,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(t1.add(this),SV||(SV=!0,di.read(wxe),di.resolveKeyframes(xxe))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:r,motionValue:i}=this;for(let s=0;s<e.length;s++)if(e[s]===null)if(s===0){const o=i?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(r&&n){const l=r.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[s]=e[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),t1.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,t1.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const bxe=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Git=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Bit(t){const e=Git.exec(t);if(!e)return[,];const[,n,r,i]=e;return[`--${n??r}`,i]}function Exe(t,e,n=1){const[r,i]=Bit(t);if(!r)return;const s=window.getComputedStyle(e).getPropertyValue(r);if(s){const o=s.trim();return bxe(o)?parseFloat(o):o}return AW(i)?Exe(i,e,n+1):i}const Sxe=t=>e=>e.test(t),Wit={test:t=>t==="auto",parse:t=>t},Txe=[ob,mn,vd,Tm,Ort,Nrt,Wit],nie=t=>Txe.find(Sxe(t));class kxe extends HW{constructor(e,n,r,i,s){super(e,n,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),AW(c))){const u=Exe(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!nxe.has(r)||e.length!==2)return;const[i,s]=e,o=nie(i),a=nie(s);if(o!==a)if(Qre(o)&&Qre(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,r=[];for(let i=0;i<e.length;i++)wit(e[i])&&r.push(i);r.length&&jit(e,r,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:r}=this;if(!e||!e.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=S2[r](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(r,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:r,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const s=n.getValue(r);s&&s.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=S2[r](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const rie=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Vg.test(t)||t==="0")&&!t.startsWith("url("));function Hit(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function qit(t,e,n,r){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const s=t[t.length-1],o=rie(i,e),a=rie(s,e);return!o||!a?!1:Hit(t)||(n==="spring"||LW(n))&&r}const Kit=t=>t!==null;function qO(t,{repeat:e,repeatType:n="loop"},r){const i=t.filter(Kit),s=e&&n!=="loop"&&e%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const Yit=40;class Axe{constructor({autoplay:e=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=_d.now(),this.options={autoplay:e,delay:n,type:r,repeat:i,repeatDelay:s,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Yit?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Uit(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=_d.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!qit(e,r,i,s))if(o)this.options.duration=0;else{l&&l(qO(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Li=(t,e,n)=>t+(e-t)*n;function l8(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Xit({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let i=0,s=0,o=0;if(!e)i=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=l8(l,a,t+1/3),s=l8(l,a,t),o=l8(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}function nN(t,e){return n=>n>0?e:t}const c8=(t,e,n)=>{const r=t*t,i=n*(e*e-r)+r;return i<0?0:Math.sqrt(i)},Zit=[bV,Dy,Tx],Jit=t=>Zit.find(e=>e.test(t));function iie(t){const e=Jit(t);if(!e)return!1;let n=e.parse(t);return e===Tx&&(n=Xit(n)),n}const sie=(t,e)=>{const n=iie(t),r=iie(e);if(!n||!r)return nN(t,e);const i={...n};return s=>(i.red=c8(n.red,r.red,s),i.green=c8(n.green,r.green,s),i.blue=c8(n.blue,r.blue,s),i.alpha=Li(n.alpha,r.alpha,s),Dy.transform(i))},Qit=(t,e)=>n=>e(t(n)),TI=(...t)=>t.reduce(Qit),kV=new Set(["none","hidden"]);function est(t,e){return kV.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function tst(t,e){return n=>Li(t,e,n)}function qW(t){return typeof t=="number"?tst:typeof t=="string"?AW(t)?nN:Zo.test(t)?sie:ist:Array.isArray(t)?Ixe:typeof t=="object"?Zo.test(t)?sie:nst:nN}function Ixe(t,e){const n=[...t],r=n.length,i=t.map((s,o)=>qW(s)(s,e[o]));return s=>{for(let o=0;o<r;o++)n[o]=i[o](s);return n}}function nst(t,e){const n={...t,...e},r={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(r[i]=qW(t[i])(t[i],e[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}}function rst(t,e){var n;const r=[],i={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const o=e.types[s],a=t.indexes[o][i[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;r[s]=l,i[o]++}return r}const ist=(t,e)=>{const n=Vg.createTransformer(e),r=Zk(t),i=Zk(e);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?kV.has(t)&&!i.values.length||kV.has(e)&&!r.values.length?est(t,e):TI(Ixe(rst(r,i),i.values),n):nN(t,e)};function Rxe(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Li(t,e,n):qW(t)(t,e)}const sst=5;function Pxe(t,e,n){const r=Math.max(e-sst,0);return rxe(n-t(r),e-r)}const qi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},u8=.001;function ost({duration:t=qi.duration,bounce:e=qi.bounce,velocity:n=qi.velocity,mass:r=qi.mass}){let i,s,o=1-e;o=cp(qi.minDamping,qi.maxDamping,o),t=cp(qi.minDuration,qi.maxDuration,Jf(t)),o<1?(i=c=>{const u=c*o,h=u*t,f=u-n,g=AV(c,o),v=Math.exp(-h);return u8-f/g*v},s=c=>{const h=c*o*t,f=h*n+n,g=Math.pow(o,2)*Math.pow(c,2)*t,v=Math.exp(-h),x=AV(Math.pow(c,2),o);return(-i(c)+u8>0?-1:1)*((f-g)*v)/x}):(i=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-u8+u*h},s=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=lst(i,s,a);if(t=Zf(t),isNaN(l))return{stiffness:qi.stiffness,damping:qi.damping,duration:t};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:o*2*Math.sqrt(r*c),duration:t}}}const ast=12;function lst(t,e,n){let r=n;for(let i=1;i<ast;i++)r=r-t(r)/e(r);return r}function AV(t,e){return t*Math.sqrt(1-e*e)}const cst=["duration","bounce"],ust=["stiffness","damping","mass"];function oie(t,e){return e.some(n=>t[n]!==void 0)}function hst(t){let e={velocity:qi.velocity,stiffness:qi.stiffness,damping:qi.damping,mass:qi.mass,isResolvedFromDuration:!1,...t};if(!oie(t,ust)&&oie(t,cst))if(t.visualDuration){const n=t.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,s=2*cp(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:qi.mass,stiffness:i,damping:s}}else{const n=ost(t);e={...e,...n,mass:qi.mass},e.isResolvedFromDuration=!0}return e}function Mxe(t=qi.visualDuration,e=qi.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:r,restDelta:i}=n;const s=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:h,velocity:f,isResolvedFromDuration:g}=hst({...n,velocity:-Jf(n.velocity||0)}),v=f||0,x=c/(2*Math.sqrt(l*u)),b=o-s,T=Jf(Math.sqrt(l/u)),A=Math.abs(b)<5;r||(r=A?qi.restSpeed.granular:qi.restSpeed.default),i||(i=A?qi.restDelta.granular:qi.restDelta.default);let I;if(x<1){const C=AV(T,x);I=V=>{const M=Math.exp(-x*T*V);return o-M*((v+x*T*b)/C*Math.sin(C*V)+b*Math.cos(C*V))}}else if(x===1)I=C=>o-Math.exp(-T*C)*(b+(v+T*b)*C);else{const C=T*Math.sqrt(x*x-1);I=V=>{const M=Math.exp(-x*T*V),N=Math.min(C*V,300);return o-M*((v+x*T*b)*Math.sinh(N)+C*b*Math.cosh(N))/C}}const R={calculatedDuration:g&&h||null,next:C=>{const V=I(C);if(g)a.done=C>=h;else{let M=0;x<1&&(M=C===0?Zf(v):Pxe(I,C,V));const N=Math.abs(M)<=r,O=Math.abs(o-V)<=i;a.done=N&&O}return a.value=a.done?o:V,a},toString:()=>{const C=Math.min(Y_e(R),_V),V=X_e(M=>R.next(C*M).value,C,30);return C+"ms "+V}};return R}function aie({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],f={done:!1,value:h},g=N=>a!==void 0&&N<a||l!==void 0&&N>l,v=N=>a===void 0?l:l===void 0||Math.abs(a-N)<Math.abs(l-N)?a:l;let x=n*e;const b=h+x,T=o===void 0?b:o(b);T!==b&&(x=T-h);const A=N=>-x*Math.exp(-N/r),I=N=>T+A(N),R=N=>{const O=A(N),F=I(N);f.done=Math.abs(O)<=c,f.value=f.done?T:F};let C,V;const M=N=>{g(f.value)&&(C=N,V=Mxe({keyframes:[f.value,v(f.value)],velocity:Pxe(I,N,f.value),damping:i,stiffness:s,restDelta:c,restSpeed:u}))};return M(0),{calculatedDuration:null,next:N=>{let O=!1;return!V&&C===void 0&&(O=!0,R(N),M(N)),C!==void 0&&N>=C?V.next(N-C):(!O&&R(N),f)}}}const dst=SI(.42,0,1,1),fst=SI(0,0,.58,1),Cxe=SI(.42,0,.58,1),pst=t=>Array.isArray(t)&&typeof t[0]!="number",mst={linear:ac,easeIn:dst,easeInOut:Cxe,easeOut:fst,circIn:UW,circInOut:dxe,circOut:hxe,backIn:zW,backInOut:cxe,backOut:lxe,anticipate:uxe},lie=t=>{if(DW(t)){R_e(t.length===4);const[e,n,r,i]=t;return SI(e,n,r,i)}else if(typeof t=="string")return mst[t];return t};function gst(t,e,n){const r=[],i=n||Rxe,s=t.length-1;for(let o=0;o<s;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ac:e;a=TI(l,a)}r.push(a)}return r}function yst(t,e,{clamp:n=!0,ease:r,mixer:i}={}){const s=t.length;if(R_e(s===e.length),s===1)return()=>e[0];if(s===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=gst(e,r,i),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const f=b2(t[h],t[h+1],u);return a[h](f)};return n?u=>c(cp(t[0],t[s-1],u)):c}function vst(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=b2(0,e,r);t.push(Li(n,1,i))}}function _st(t){const e=[0];return vst(e,t.length-1),e}function xst(t,e){return t.map(n=>n*e)}function wst(t,e){return t.map(()=>e||Cxe).splice(0,t.length-1)}function rN({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const i=pst(r)?r.map(lie):lie(r),s={done:!1,value:e[0]},o=xst(n&&n.length===e.length?n:_st(e),t),a=yst(o,e,{ease:Array.isArray(i)?i:wst(e,i)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}const bst=t=>{const e=({timestamp:n})=>t(n);return{start:()=>di.update(e,!0),stop:()=>Fg(e),now:()=>Eo.isProcessing?Eo.timestamp:_d.now()}},Est={decay:aie,inertia:aie,tween:rN,keyframes:rN,spring:Mxe},Sst=t=>t/100;class KW extends Axe{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:i,keyframes:s}=this.options,o=i?.KeyframeResolver||HW,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(s,a,n,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=this.options,a=LW(n)?n:Est[n]||rN;let l,c;a!==rN&&typeof e[0]!="number"&&(l=TI(Sst,Rxe(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});s==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=Y_e(u));const{calculatedDuration:h}=u,f=h+i,g=f*(r+1)-i;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:f,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:r}=this;if(!r){const{keyframes:N}=this.options;return{done:!0,value:N[N.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=r;if(this.startTime===null)return s.next(0);const{delay:f,repeat:g,repeatType:v,repeatDelay:x,onUpdate:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const T=this.currentTime-f*(this.speed>=0?1:-1),A=this.speed>=0?T<0:T>u;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let I=this.currentTime,R=s;if(g){const N=Math.min(this.currentTime,u)/h;let O=Math.floor(N),F=N%1;!F&&N>=1&&(F=1),F===1&&O--,O=Math.min(O,g+1),O%2&&(v==="reverse"?(F=1-F,x&&(F-=x/h)):v==="mirror"&&(R=o)),I=cp(0,1,F)*h}const C=A?{done:!1,value:l[0]}:R.next(I);a&&(C.value=a(C.value));let{done:V}=C;!A&&c!==null&&(V=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return M&&i!==void 0&&(C.value=qO(l,this.options,i)),b&&b(C.value),M&&this.finish(),C}get duration(){const{resolved:e}=this;return e?Jf(e.calculatedDuration):0}get time(){return Jf(this.currentTime)}set time(e){e=Zf(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Jf(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=bst,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=e(s=>this.tick(s))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Tst=new Set(["opacity","clipPath","filter","transform"]);function kst(t,e,n,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=J_e(a,i);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:r,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const Ast=xW(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),iN=10,Ist=2e4;function Rst(t){return LW(t.type)||t.type==="spring"||!Z_e(t.ease)}function Pst(t,e){const n=new KW({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:t[0]};const i=[];let s=0;for(;!r.done&&s<Ist;)r=n.sample(s),i.push(r.value),s+=iN;return{times:void 0,keyframes:i,duration:s-iN,ease:"linear"}}const Nxe={anticipate:uxe,backInOut:cxe,circInOut:dxe};function Mst(t){return t in Nxe}class cie extends Axe{constructor(e){super(e);const{name:n,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new kxe(s,(o,a)=>this.onKeyframesResolved(o,a),n,r,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:r=300,times:i,ease:s,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof s=="string"&&tN()&&Mst(s)&&(s=Nxe[s]),Rst(this.options)){const{onComplete:h,onUpdate:f,motionValue:g,element:v,...x}=this.options,b=Pst(e,x);e=b.keyframes,e.length===1&&(e[1]=e[0]),r=b.duration,i=b.times,s=b.ease,o="keyframes"}const u=kst(a.owner.current,l,e,{...this.options,duration:r,times:i,ease:s});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(qre(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;a.set(qO(e,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:r,times:i,type:o,ease:s,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Jf(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Jf(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=Zf(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return ac;const{animation:r}=n;qre(r,e)}return ac}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:r,duration:i,type:s,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:f,...g}=this.options,v=new KW({...g,keyframes:r,duration:i,type:s,ease:o,times:a,isGenerator:!0}),x=Zf(this.time);c.setWithVelocity(v.sample(x-iN).value,v.sample(x).value,iN)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:r,repeatDelay:i,repeatType:s,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return Ast()&&r&&Tst.has(r)&&!l&&!c&&!i&&s!=="mirror"&&o!==0&&a!=="inertia"}}const Cst={type:"spring",stiffness:500,damping:25,restSpeed:10},Nst=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Ost={type:"keyframes",duration:.8},Lst={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Dst=(t,{keyframes:e})=>e.length>2?Ost:cv.has(t)?t.startsWith("scale")?Nst(e[1]):Cst:Lst;function $st({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const YW=(t,e,n,r={},i,s)=>o=>{const a=OW(r,t)||{},l=a.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Zf(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:s?void 0:i};$st(a)||(u={...u,...Dst(t,u)}),u.duration&&(u.duration=Zf(u.duration)),u.repeatDelay&&(u.repeatDelay=Zf(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!s&&e.get()!==void 0){const f=qO(u.keyframes,a);if(f!==void 0)return di.update(()=>{u.onUpdate(f),u.onComplete()}),new nit([])}return!s&&cie.supports(u)?new cie(u):new KW(u)};function jst({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function Oxe(t,e,{delay:n=0,transitionOverride:r,type:i}={}){var s;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;r&&(o=r);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in l){const f=t.getValue(h,(s=t.latestValues[h])!==null&&s!==void 0?s:null),g=l[h];if(g===void 0||u&&jst(u,h))continue;const v={delay:n,...OW(o||{},h)};let x=!1;if(window.MotionHandoffAnimation){const T=ixe(t);if(T){const A=window.MotionHandoffAnimation(T,h,di);A!==null&&(v.startTime=A,x=!0)}}wV(t,h),f.start(YW(h,f,g,t.shouldReduceMotion&&nxe.has(h)?{type:!1}:v,t,x));const b=f.animation;b&&c.push(b)}return a&&Promise.all(c).then(()=>{di.update(()=>{a&&git(t,a)})}),c}function IV(t,e,n={}){var r;const i=HO(t,e,n.type==="exit"?(r=t.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(s=n.transitionOverride);const o=i?()=>Promise.all(Oxe(t,i,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=s;return Fst(t,e,u+c,h,f,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function Fst(t,e,n=0,r=0,i=1,s){const o=[],a=(t.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>a-c*r;return Array.from(t.variantChildren).sort(Vst).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(IV(c,e,{...s,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Vst(t,e){return t.sortNodePosition(e)}function zst(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const i=e.map(s=>IV(t,s,n));r=Promise.all(i)}else if(typeof e=="string")r=IV(t,e,n);else{const i=typeof e=="function"?HO(t,e,n.custom):e;r=Promise.all(Oxe(t,i,n))}return r.then(()=>{t.notify("AnimationComplete",e)})}const Ust=bW.length;function Lxe(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?Lxe(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Ust;n++){const r=bW[n],i=t.props[r];(Kk(i)||i===!1)&&(e[r]=i)}return e}const Gst=[...wW].reverse(),Bst=wW.length;function Wst(t){return e=>Promise.all(e.map(({animation:n,options:r})=>zst(t,n,r)))}function Hst(t){let e=Wst(t),n=uie(),r=!0;const i=l=>(c,u)=>{var h;const f=HO(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(f){const{transition:g,transitionEnd:v,...x}=f;c={...c,...x,...v}}return c};function s(l){e=l(t)}function o(l){const{props:c}=t,u=Lxe(t.parent)||{},h=[],f=new Set;let g={},v=1/0;for(let b=0;b<Bst;b++){const T=Gst[b],A=n[T],I=c[T]!==void 0?c[T]:u[T],R=Kk(I),C=T===l?A.isActive:null;C===!1&&(v=b);let V=I===u[T]&&I!==c[T]&&R;if(V&&r&&t.manuallyAnimateOnMount&&(V=!1),A.protectedKeys={...g},!A.isActive&&C===null||!I&&!A.prevProp||BO(I)||typeof I=="boolean")continue;const M=qst(A.prevProp,I);let N=M||T===l&&A.isActive&&!V&&R||b>v&&R,O=!1;const F=Array.isArray(I)?I:[I];let L=F.reduce(i(T),{});C===!1&&(L={});const{prevResolvedValues:B={}}=A,U={...B,...L},de=Le=>{N=!0,f.has(Le)&&(O=!0,f.delete(Le)),A.needsAnimating[Le]=!0;const fe=t.getValue(Le);fe&&(fe.liveStyle=!1)};for(const Le in U){const fe=L[Le],$e=B[Le];if(g.hasOwnProperty(Le))continue;let Ce=!1;vV(fe)&&vV($e)?Ce=!K_e(fe,$e):Ce=fe!==$e,Ce?fe!=null?de(Le):f.add(Le):fe!==void 0&&f.has(Le)?de(Le):A.protectedKeys[Le]=!0}A.prevProp=I,A.prevResolvedValues=L,A.isActive&&(g={...g,...L}),r&&t.blockInitialAnimation&&(N=!1),N&&(!(V&&M)||O)&&h.push(...F.map(Le=>({animation:Le,options:{type:T}})))}if(f.size){const b={};f.forEach(T=>{const A=t.getBaseTarget(T),I=t.getValue(T);I&&(I.liveStyle=!0),b[T]=A??null}),h.push({animation:b})}let x=!!h.length;return r&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(x=!1),r=!1,x?e(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var g;return(g=f.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const f in n)n[f].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n,reset:()=>{n=uie(),r=!0}}}function qst(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!K_e(e,t):!1}function L0(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function uie(){return{animate:L0(!0),whileInView:L0(),whileHover:L0(),whileTap:L0(),whileDrag:L0(),whileFocus:L0(),exit:L0()}}class Qg{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Kst extends Qg{constructor(e){super(e),e.animationState||(e.animationState=Hst(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();BO(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Yst=0;class Xst extends Qg{constructor(){super(...arguments),this.id=Yst++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Zst={animation:{Feature:Kst},exit:{Feature:Xst}};function Jk(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}function kI(t){return{point:{x:t.pageX,y:t.pageY}}}const Jst=t=>e=>$W(e)&&t(e,kI(e));function ET(t,e,n,r){return Jk(t,e,Jst(n),r)}const hie=(t,e)=>Math.abs(t-e);function Qst(t,e){const n=hie(t.x,e.x),r=hie(t.y,e.y);return Math.sqrt(n**2+r**2)}class Dxe{constructor(e,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=d8(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,g=Qst(h.offset,{x:0,y:0})>=3;if(!f&&!g)return;const{point:v}=h,{timestamp:x}=Eo;this.history.push({...v,timestamp:x});const{onStart:b,onMove:T}=this.handlers;f||(b&&b(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=h8(f,this.transformPagePoint),di.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:g,onSessionEnd:v,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=d8(h.type==="pointercancel"?this.lastMoveEventInfo:h8(f,this.transformPagePoint),this.history);this.startEvent&&g&&g(h,b),v&&v(h,b)},!$W(e))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const o=kI(e),a=h8(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Eo;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,d8(a,this.history)),this.removeListeners=TI(ET(this.contextWindow,"pointermove",this.handlePointerMove),ET(this.contextWindow,"pointerup",this.handlePointerUp),ET(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Fg(this.updatePoint)}}function h8(t,e){return e?{point:e(t.point)}:t}function die(t,e){return{x:t.x-e.x,y:t.y-e.y}}function d8({point:t},e){return{point:t,delta:die(t,$xe(e)),offset:die(t,eot(e)),velocity:tot(e,.1)}}function eot(t){return t[0]}function $xe(t){return t[t.length-1]}function tot(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const i=$xe(t);for(;n>=0&&(r=t[n],!(i.timestamp-r.timestamp>Zf(e)));)n--;if(!r)return{x:0,y:0};const s=Jf(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const jxe=1e-4,not=1-jxe,rot=1+jxe,Fxe=.01,iot=0-Fxe,sot=0+Fxe;function dc(t){return t.max-t.min}function oot(t,e,n){return Math.abs(t-e)<=n}function fie(t,e,n,r=.5){t.origin=r,t.originPoint=Li(e.min,e.max,t.origin),t.scale=dc(n)/dc(e),t.translate=Li(n.min,n.max,t.origin)-t.originPoint,(t.scale>=not&&t.scale<=rot||isNaN(t.scale))&&(t.scale=1),(t.translate>=iot&&t.translate<=sot||isNaN(t.translate))&&(t.translate=0)}function ST(t,e,n,r){fie(t.x,e.x,n.x,r?r.originX:void 0),fie(t.y,e.y,n.y,r?r.originY:void 0)}function pie(t,e,n){t.min=n.min+e.min,t.max=t.min+dc(e)}function aot(t,e,n){pie(t.x,e.x,n.x),pie(t.y,e.y,n.y)}function mie(t,e,n){t.min=e.min-n.min,t.max=t.min+dc(e)}function TT(t,e,n){mie(t.x,e.x,n.x),mie(t.y,e.y,n.y)}function lot(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?Li(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?Li(n,t,r.max):Math.min(t,n)),t}function gie(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function cot(t,{top:e,left:n,bottom:r,right:i}){return{x:gie(t.x,n,i),y:gie(t.y,e,r)}}function yie(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function uot(t,e){return{x:yie(t.x,e.x),y:yie(t.y,e.y)}}function hot(t,e){let n=.5;const r=dc(t),i=dc(e);return i>r?n=b2(e.min,e.max-r,t.min):r>i&&(n=b2(t.min,t.max-i,e.min)),cp(0,1,n)}function dot(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const RV=.35;function fot(t=RV){return t===!1?t=0:t===!0&&(t=RV),{x:vie(t,"left","right"),y:vie(t,"top","bottom")}}function vie(t,e,n){return{min:_ie(t,e),max:_ie(t,n)}}function _ie(t,e){return typeof t=="number"?t:t[e]||0}const xie=()=>({translate:0,scale:1,origin:0,originPoint:0}),kx=()=>({x:xie(),y:xie()}),wie=()=>({min:0,max:0}),ss=()=>({x:wie(),y:wie()});function Oc(t){return[t("x"),t("y")]}function Vxe({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function pot({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function mot(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function f8(t){return t===void 0||t===1}function PV({scale:t,scaleX:e,scaleY:n}){return!f8(t)||!f8(e)||!f8(n)}function ay(t){return PV(t)||zxe(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function zxe(t){return bie(t.x)||bie(t.y)}function bie(t){return t&&t!=="0%"}function sN(t,e,n){const r=t-n,i=e*r;return n+i}function Eie(t,e,n,r,i){return i!==void 0&&(t=sN(t,i,r)),sN(t,n,r)+e}function MV(t,e=0,n=1,r,i){t.min=Eie(t.min,e,n,r,i),t.max=Eie(t.max,e,n,r,i)}function Uxe(t,{x:e,y:n}){MV(t.x,e.translate,e.scale,e.originPoint),MV(t.y,n.translate,n.scale,n.originPoint)}const Sie=.999999999999,Tie=1.0000000000001;function got(t,e,n,r=!1){const i=n.length;if(!i)return;e.x=e.y=1;let s,o;for(let a=0;a<i;a++){s=n[a],o=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Ix(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Uxe(t,o)),r&&ay(s.latestValues)&&Ix(t,s.latestValues))}e.x<Tie&&e.x>Sie&&(e.x=1),e.y<Tie&&e.y>Sie&&(e.y=1)}function Ax(t,e){t.min=t.min+e,t.max=t.max+e}function kie(t,e,n,r,i=.5){const s=Li(t.min,t.max,i);MV(t,e,n,s,r)}function Ix(t,e){kie(t.x,e.x,e.scaleX,e.scale,e.originX),kie(t.y,e.y,e.scaleY,e.scale,e.originY)}function Gxe(t,e){return Vxe(mot(t.getBoundingClientRect(),e))}function yot(t,e,n){const r=Gxe(t,n),{scroll:i}=e;return i&&(Ax(r.x,i.offset.x),Ax(r.y,i.offset.y)),r}const Bxe=({current:t})=>t?t.ownerDocument.defaultView:null,vot=new WeakMap;class _ot{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ss(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(kI(u).point)},s=(u,h)=>{const{drag:f,dragPropagation:g,onDragStart:v}=this.getProps();if(f&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=hit(f),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Oc(b=>{let T=this.getAxisMotionValue(b).get()||0;if(vd.test(T)){const{projection:A}=this.visualElement;if(A&&A.layout){const I=A.layout.layoutBox[b];I&&(T=dc(I)*(parseFloat(T)/100))}}this.originPoint[b]=T}),v&&di.postRender(()=>v(u,h)),wV(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:f,dragDirectionLock:g,onDirectionLock:v,onDrag:x}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:b}=h;if(g&&this.currentDirection===null){this.currentDirection=xot(b),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",h.point,b),this.updateAxis("y",h.point,b),this.visualElement.render(),x&&x(u,h)},a=(u,h)=>this.stop(u,h),l=()=>Oc(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Dxe(e,{onSessionStart:i,onStart:s,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Bxe(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&di.postRender(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:i}=this.getProps();if(!r||!tM(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=lot(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;n&&Sx(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=cot(i.layoutBox,n):this.constraints=!1,this.elastic=fot(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Oc(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=dot(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Sx(e))return!1;const r=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=yot(r,i.root,this.visualElement.getTransformPagePoint());let o=uot(i.layout.layoutBox,s);if(n){const a=n(pot(o));this.hasMutatedConstraints=!!a,a&&(o=Vxe(a))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Oc(u=>{if(!tM(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const f=i?200:1e6,g=i?40:1e7,v={type:"inertia",velocity:r?e[u]:0,bounceStiffness:f,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(u,v)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return wV(this.visualElement,e),r.start(YW(e,r,0,n,this.visualElement,!1))}stopAnimation(){Oc(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Oc(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Oc(n=>{const{drag:r}=this.getProps();if(!tM(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];s.set(e[n]-Li(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Sx(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Oc(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=hot({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Oc(o=>{if(!tM(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Li(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;vot.set(this.visualElement,this);const e=this.visualElement.current,n=ET(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();Sx(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),di.read(r);const o=Jk(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Oc(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())}));return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=RV,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function tM(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function xot(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class wot extends Qg{constructor(e){super(e),this.removeGroupControls=ac,this.removeListeners=ac,this.controls=new _ot(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ac}unmount(){this.removeGroupControls(),this.removeListeners()}}const Aie=t=>(e,n)=>{t&&di.postRender(()=>t(e,n))};class bot extends Qg{constructor(){super(...arguments),this.removePointerDownListener=ac}onPointerDown(e){this.session=new Dxe(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Bxe(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:Aie(e),onStart:Aie(n),onMove:r,onEnd:(s,o)=>{delete this.session,i&&di.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=ET(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const WC={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Iie(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const DE={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(mn.test(t))t=parseFloat(t);else return t;const n=Iie(t,e.target.x),r=Iie(t,e.target.y);return`${n}% ${r}%`}},Eot={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,i=Vg.parse(t);if(i.length>5)return r;const s=Vg.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=Li(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),s(i)}};class Sot extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=e;Brt(Tot),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),WC.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,o=r.projection;return o&&(o.isPresent=s,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||di.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),SW.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Wxe(t){const[e,n]=A_e(),r=X.useContext(gW);return m.jsx(Sot,{...t,layoutGroup:r,switchLayoutGroup:X.useContext(L_e),isPresent:e,safeToRemove:n})}const Tot={borderRadius:{...DE,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:DE,borderTopRightRadius:DE,borderBottomLeftRadius:DE,borderBottomRightRadius:DE,boxShadow:Eot};function kot(t,e,n){const r=ca(t)?t:Xk(t);return r.start(YW("",r,e,n)),r.animation}function Aot(t){return t instanceof SVGElement&&t.tagName!=="svg"}const Iot=(t,e)=>t.depth-e.depth;class Rot{constructor(){this.children=[],this.isDirty=!1}add(e){jW(this.children,e),this.isDirty=!0}remove(e){FW(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Iot),this.isDirty=!1,this.children.forEach(e)}}function Pot(t,e){const n=_d.now(),r=({timestamp:i})=>{const s=i-n;s>=e&&(Fg(r),t(s-e))};return di.read(r,!0),()=>Fg(r)}const Hxe=["TopLeft","TopRight","BottomLeft","BottomRight"],Mot=Hxe.length,Rie=t=>typeof t=="string"?parseFloat(t):t,Pie=t=>typeof t=="number"||mn.test(t);function Cot(t,e,n,r,i,s){i?(t.opacity=Li(0,n.opacity!==void 0?n.opacity:1,Not(r)),t.opacityExit=Li(e.opacity!==void 0?e.opacity:1,0,Oot(r))):s&&(t.opacity=Li(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<Mot;o++){const a=`border${Hxe[o]}Radius`;let l=Mie(e,a),c=Mie(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Pie(l)===Pie(c)?(t[a]=Math.max(Li(Rie(l),Rie(c),r),0),(vd.test(c)||vd.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Li(e.rotate||0,n.rotate||0,r))}function Mie(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Not=qxe(0,.5,hxe),Oot=qxe(.5,.95,ac);function qxe(t,e,n){return r=>r<t?0:r>e?1:n(b2(t,e,r))}function Cie(t,e){t.min=e.min,t.max=e.max}function kc(t,e){Cie(t.x,e.x),Cie(t.y,e.y)}function Nie(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Oie(t,e,n,r,i){return t-=e,t=sN(t,1/n,r),i!==void 0&&(t=sN(t,1/i,r)),t}function Lot(t,e=0,n=1,r=.5,i,s=t,o=t){if(vd.test(e)&&(e=parseFloat(e),e=Li(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Li(s.min,s.max,r);t===s&&(a-=e),t.min=Oie(t.min,e,n,a,i),t.max=Oie(t.max,e,n,a,i)}function Lie(t,e,[n,r,i],s,o){Lot(t,e[n],e[r],e[i],e.scale,s,o)}const Dot=["x","scaleX","originX"],$ot=["y","scaleY","originY"];function Die(t,e,n,r){Lie(t.x,e,Dot,n?n.x:void 0,r?r.x:void 0),Lie(t.y,e,$ot,n?n.y:void 0,r?r.y:void 0)}function $ie(t){return t.translate===0&&t.scale===1}function Kxe(t){return $ie(t.x)&&$ie(t.y)}function jie(t,e){return t.min===e.min&&t.max===e.max}function jot(t,e){return jie(t.x,e.x)&&jie(t.y,e.y)}function Fie(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Yxe(t,e){return Fie(t.x,e.x)&&Fie(t.y,e.y)}function Vie(t){return dc(t.x)/dc(t.y)}function zie(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class Fot{constructor(){this.members=[]}add(e){jW(this.members,e),e.scheduleRender()}remove(e){if(FW(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Vot(t,e,n){let r="";const i=t.x.translate/e.x,s=t.y.translate/e.y,o=n?.z||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:f,skewX:g,skewY:v}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),h&&(r+=`rotateX(${h}deg) `),f&&(r+=`rotateY(${f}deg) `),g&&(r+=`skewX(${g}deg) `),v&&(r+=`skewY(${v}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}const ly={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},PS=typeof window<"u"&&window.MotionDebug!==void 0,p8=["","X","Y","Z"],zot={visibility:"hidden"},Uie=1e3;let Uot=0;function m8(t,e,n,r){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),r&&(r[t]=0))}function Xxe(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=ixe(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:s}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",di,!(i||s))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&Xxe(r)}function Zxe({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},a=e?.()){this.id=Uot++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,PS&&(ly.totalNodes=ly.resolvedTargetDeltas=ly.recalculatedProjection=0),this.nodes.forEach(Wot),this.nodes.forEach(Xot),this.nodes.forEach(Zot),this.nodes.forEach(Hot),PS&&window.MotionDebug.record(ly)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Rot)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new VW),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Aot(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Pot(f,250),WC.hasAnimatedSinceResize&&(WC.hasAnimatedSinceResize=!1,this.nodes.forEach(Bie))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:g,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||nat,{onLayoutAnimationStart:b,onLayoutAnimationComplete:T}=u.getProps(),A=!this.targetLayout||!Yxe(this.targetLayout,v)||g,I=!f&&g;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||I||f&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,I);const R={...OW(x,"layout"),onPlay:b,onComplete:T};(u.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else f||Bie(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Fg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Jot),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Xxe(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Gie);return}this.isUpdating||this.nodes.forEach(Kot),this.isUpdating=!1,this.nodes.forEach(Yot),this.nodes.forEach(Got),this.nodes.forEach(Bot),this.clearAllSnapshots();const a=_d.now();Eo.delta=cp(0,1e3/60,a-Eo.timestamp),Eo.timestamp=a,Eo.isProcessing=!0,s8.update.process(Eo),s8.preRender.process(Eo),s8.render.process(Eo),Eo.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,SW.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(qot),this.sharedNodes.forEach(Qot)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,di.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){di.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ss(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!Kxe(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||ay(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),rat(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return ss();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(iat))){const{scroll:u}=this.root;u&&(Ax(l.x,u.offset.x),Ax(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=ss();if(kc(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&kc(l,o),Ax(l.x,h.offset.x),Ax(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=ss();kc(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Ix(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),ay(u.latestValues)&&Ix(l,u.latestValues)}return ay(this.latestValues)&&Ix(l,this.latestValues),l}removeTransform(o){const a=ss();kc(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!ay(c.latestValues))continue;PV(c.latestValues)&&c.updateSnapshot();const u=ss(),h=c.measurePageBox();kc(u,h),Die(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return ay(this.latestValues)&&Die(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Eo.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=Eo.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),TT(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),kc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ss(),this.targetWithTransforms=ss()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),aot(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):kc(this.target,this.layout.layoutBox),Uxe(this.target,this.targetDelta)):kc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),TT(this.relativeTargetOrigin,this.target,g.target),kc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}PS&&ly.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||PV(this.parent.latestValues)||zxe(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Eo.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;kc(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,g=this.treeScale.y;got(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ss());const{target:v}=a;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Nie(this.prevProjectionDelta.x,this.projectionDelta.x),Nie(this.prevProjectionDelta.y,this.projectionDelta.y)),ST(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==g||!zie(this.projectionDelta.x,this.prevProjectionDelta.x)||!zie(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),PS&&ly.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=kx(),this.projectionDelta=kx(),this.projectionDeltaWithTransform=kx()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=kx();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=ss(),g=l?l.source:void 0,v=this.layout?this.layout.source:void 0,x=g!==v,b=this.getStack(),T=!b||b.members.length<=1,A=!!(x&&!T&&this.options.crossfade===!0&&!this.path.some(tat));this.animationProgress=0;let I;this.mixTargetDelta=R=>{const C=R/1e3;Wie(h.x,o.x,C),Wie(h.y,o.y,C),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(TT(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),eat(this.relativeTarget,this.relativeTargetOrigin,f,C),I&&jot(this.relativeTarget,I)&&(this.isProjectionDirty=!1),I||(I=ss()),kc(I,this.relativeTarget)),x&&(this.animationValues=u,Cot(u,c,this.latestValues,C,A,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Fg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=di.update(()=>{WC.hasAnimatedSinceResize=!0,this.currentAnimation=kot(0,Uie,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Uie),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&Jxe(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||ss();const h=dc(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const f=dc(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+f}kc(a,l),Ix(a,u),ST(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Fot),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&m8("z",o,c,this.animationValues);for(let u=0;u<p8.length;u++)m8(`rotate${p8[u]}`,o,c,this.animationValues),m8(`skew${p8[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return zot;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=GC(o?.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=GC(o?.pointerEvents)||""),this.hasProjected&&!ay(this.latestValues)&&(x.transform=u?u({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=Vot(this.projectionDeltaWithTransform,this.treeScale,f),u&&(c.transform=u(f,c.transform));const{x:g,y:v}=this.projectionDelta;c.transformOrigin=`${g.origin*100}% ${v.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=f.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:c.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in eN){if(f[x]===void 0)continue;const{correct:b,applyTo:T}=eN[x],A=c.transform==="none"?f[x]:b(f[x],h);if(T){const I=T.length;for(let R=0;R<I;R++)c[T[R]]=A}else c[x]=A}return this.options.layoutId&&(c.pointerEvents=h===this?GC(o?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Gie),this.root.sharedNodes.clear()}}}function Got(t){t.updateLayout()}function Bot(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Oc(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],g=dc(f);f.min=r[h].min,f.max=f.min+g}):Jxe(s,n.layoutBox,r)&&Oc(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],g=dc(r[h]);f.max=f.min+g,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+g)});const a=kx();ST(a,r,n.layoutBox);const l=kx();o?ST(l,t.applyTransform(i,!0),n.measuredBox):ST(l,r,n.layoutBox);const c=!Kxe(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:g}=h;if(f&&g){const v=ss();TT(v,n.layoutBox,f.layoutBox);const x=ss();TT(x,r,g.layoutBox),Yxe(v,x)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=v,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Wot(t){PS&&ly.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Hot(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function qot(t){t.clearSnapshot()}function Gie(t){t.clearMeasurements()}function Kot(t){t.isLayoutDirty=!1}function Yot(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Bie(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Xot(t){t.resolveTargetDelta()}function Zot(t){t.calcProjection()}function Jot(t){t.resetSkewAndRotation()}function Qot(t){t.removeLeadSnapshot()}function Wie(t,e,n){t.translate=Li(e.translate,0,n),t.scale=Li(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Hie(t,e,n,r){t.min=Li(e.min,n.min,r),t.max=Li(e.max,n.max,r)}function eat(t,e,n,r){Hie(t.x,e.x,n.x,r),Hie(t.y,e.y,n.y,r)}function tat(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const nat={duration:.45,ease:[.4,0,.1,1]},qie=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Kie=qie("applewebkit/")&&!qie("chrome/")?Math.round:ac;function Yie(t){t.min=Kie(t.min),t.max=Kie(t.max)}function rat(t){Yie(t.x),Yie(t.y)}function Jxe(t,e,n){return t==="position"||t==="preserve-aspect"&&!oot(Vie(e),Vie(n),.2)}function iat(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const sat=Zxe({attachResizeListener:(t,e)=>Jk(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),g8={current:void 0},Qxe=Zxe({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!g8.current){const t=new sat({});t.mount(window),t.setOptions({layoutScroll:!0}),g8.current=t}return g8.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),oat={pan:{Feature:bot},drag:{Feature:wot,ProjectionNode:Qxe,MeasureLayout:Wxe}};function Xie(t,e,n){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,s=r[i];s&&di.postRender(()=>s(e,kI(e)))}class aat extends Qg{mount(){const{current:e}=this.node;e&&(this.unmount=oit(e,n=>(Xie(this.node,n,"Start"),r=>Xie(this.node,r,"End"))))}unmount(){}}class lat extends Qg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=TI(Jk(this.node.current,"focus",()=>this.onFocus()),Jk(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Zie(t,e,n){const{props:r}=t;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),s=r[i];s&&di.postRender(()=>s(e,kI(e)))}class cat extends Qg{mount(){const{current:e}=this.node;e&&(this.unmount=uit(e,n=>(Zie(this.node,n,"Start"),(r,{success:i})=>Zie(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const CV=new WeakMap,y8=new WeakMap,uat=t=>{const e=CV.get(t.target);e&&e(t)},hat=t=>{t.forEach(uat)};function dat({root:t,...e}){const n=t||document;y8.has(n)||y8.set(n,{});const r=y8.get(n),i=JSON.stringify(e);return r[i]||(r[i]=new IntersectionObserver(hat,{root:t,...e})),r[i]}function fat(t,e,n){const r=dat(e);return CV.set(t,n),r.observe(t),()=>{CV.delete(t),r.unobserve(t)}}const pat={some:0,all:1};class mat extends Qg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:pat[i]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=c?u:h;f&&f(l)};return fat(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(gat(e,n))&&this.startObserver()}unmount(){}}function gat({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const yat={inView:{Feature:mat},tap:{Feature:cat},focus:{Feature:lat},hover:{Feature:aat}},vat={layout:{ProjectionNode:Qxe,MeasureLayout:Wxe}},NV={current:null},ewe={current:!1};function _at(){if(ewe.current=!0,!!_W)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>NV.current=t.matches;t.addListener(e),e()}else NV.current=!1}const xat=[...Txe,Zo,Vg],wat=t=>xat.find(Sxe(t)),Jie=new WeakMap;function bat(t,e,n){for(const r in e){const i=e[r],s=n[r];if(ca(i))t.addValue(r,i);else if(ca(s))t.addValue(r,Xk(i,{owner:t}));else if(s!==i)if(t.hasValue(r)){const o=t.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(r);t.addValue(r,Xk(o!==void 0?o:i,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const Qie=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Eat{scrapeMotionValuesFromProps(e,n,r){return{}}constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=HW,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=_d.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,di.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!s,this.isControllingVariants=WO(n),this.isVariantNode=N_e(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const g in f){const v=f[g];l[g]!==void 0&&ca(v)&&v.set(l[g],!1)}}mount(e){this.current=e,Jie.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),ewe.current||_at(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:NV.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Jie.delete(this.current),this.projection&&this.projection.unmount(),Fg(this.notifyUpdate),Fg(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=cv.has(e),i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&di.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),s(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in E2){const n=E2[e];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[e]&&i&&r(this.props)&&(this.features[e]=new i(this)),this.features[e]){const s=this.features[e];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ss()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Qie.length;r++){const i=Qie[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=e[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=bat(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const r=this.values.get(e);n!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Xk(n===null?void 0:n,{owner:this}),this.addValue(e,r)),r}readValue(e,n){var r;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(bxe(i)||fxe(i))?i=parseFloat(i):!wat(i)&&Vg.test(n)&&(i=_xe(e,n)),this.setBaseTarget(e,ca(i)?i.get():i)),ca(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const o=kW(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(i=o[e])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ca(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new VW),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class twe extends Eat{constructor(){super(...arguments),this.KeyframeResolver=kxe}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ca(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Sat(t){return window.getComputedStyle(t)}class Tat extends twe{constructor(){super(...arguments),this.type="html",this.renderInstance=U_e}readValueFromInstance(e,n){if(cv.has(n)){const r=WW(n);return r&&r.default||0}else{const r=Sat(e),i=(F_e(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Gxe(e,n)}build(e,n,r){RW(e,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,n,r){return NW(e,n,r)}}class kat extends twe{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ss}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(cv.has(n)){const r=WW(n);return r&&r.default||0}return n=G_e.has(n)?n:EW(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,r){return H_e(e,n,r)}build(e,n,r){PW(e,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,r,i){B_e(e,n,r,i)}mount(e){this.isSVGTag=CW(e.tagName),super.mount(e)}}const Aat=(t,e)=>TW(t)?new kat(e):new Tat(e,{allowProjection:t!==X.Fragment}),Iat=Qrt({...Zst,...yat,...oat,...vat},Aat),Ct=prt(Iat);const Rat=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Pat=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),ese=t=>{const e=Pat(t);return e.charAt(0).toUpperCase()+e.slice(1)},nwe=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),Mat=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Cat={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Nat=X.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>X.createElement("svg",{ref:l,...Cat,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:nwe("lucide",i),...!s&&!Mat(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>X.createElement(c,u)),...Array.isArray(s)?s:[s]]));const ut=(t,e)=>{const n=X.forwardRef(({className:r,...i},s)=>X.createElement(Nat,{ref:s,iconNode:e,className:nwe(`lucide-${Rat(ese(t))}`,`lucide-${t}`,r),...i}));return n.displayName=ese(t),n};const Oat=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Lat=ut("archive-restore",Oat);const Dat=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],rwe=ut("archive",Dat);const $at=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],jat=ut("ban",$at);const Fat=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Vat=ut("book-open",Fat);const zat=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],iwe=ut("bug",zat);const Uat=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],XW=ut("calendar",Uat);const Gat=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],KO=ut("camera",Gat);const Bat=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],swe=ut("chart-column",Bat);const Wat=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],up=ut("check",Wat);const Hat=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ab=ut("chevron-down",Hat);const qat=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],owe=ut("chevron-left",qat);const Kat=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lb=ut("chevron-right",Kat);const Yat=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],YO=ut("chevron-up",Yat);const Xat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],awe=ut("circle-alert",Xat);const Zat=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Jat=ut("circle-check-big",Zat);const Qat=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],oN=ut("clock",Qat);const elt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 17H7",key:"pygtm1"}],["path",{d:"M17 21H9",key:"1u2q02"}]],tlt=ut("cloud-fog",elt);const nlt=[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]],rlt=ut("cloud-lightning",nlt);const ilt=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],slt=ut("cloud-off",ilt);const olt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],ZW=ut("cloud-rain",olt);const alt=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M8 15h.01",key:"a7atzg"}],["path",{d:"M8 19h.01",key:"puxtts"}],["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M12 21h.01",key:"h35vbk"}],["path",{d:"M16 15h.01",key:"rnfrdf"}],["path",{d:"M16 19h.01",key:"1vcnzz"}]],llt=ut("cloud-snow",alt);const clt=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],hp=ut("cloud",clt);const ult=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],hlt=ut("code",ult);const dlt=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],flt=ut("compass",dlt);const plt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],aN=ut("crosshair",plt);const mlt=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],lN=ut("download",mlt);const glt=[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]],ylt=ut("droplets",glt);const vlt=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],vg=ut("external-link",vlt);const _lt=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],cN=ut("eye-off",_lt);const xlt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uN=ut("eye",xlt);const wlt=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],JW=ut("file-text",wlt);const blt=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Elt=ut("flame",blt);const Slt=[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]],tse=ut("flower-2",Slt);const Tlt=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],klt=ut("folder-open",Tlt);const Alt=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ilt=ut("folder-plus",Alt);const Rlt=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Plt=ut("folder",Rlt);const Mlt=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Clt=ut("gauge",Mlt);const Nlt=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],Olt=ut("gem",Nlt);const Llt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Dlt=ut("globe",Llt);const $lt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],lwe=ut("grid-3x3",$lt);const jlt=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],Flt=ut("grip-horizontal",jlt);const Vlt=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],zlt=ut("image-plus",Vlt);const Ult=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],QW=ut("info",Ult);const Glt=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],cwe=ut("landmark",Glt);const Blt=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],nu=ut("layers",Blt);const Wlt=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],uwe=ut("list",Wlt);const Hlt=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],eH=ut("loader-circle",Hlt);const qlt=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Klt=ut("locate-fixed",qlt);const Ylt=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],OV=ut("lock",Ylt);const Xlt=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],tH=ut("log-out",Xlt);const Zlt=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],fc=ut("map-pin",Zlt);const Jlt=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],nH=ut("map",Jlt);const Qlt=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],ect=ut("menu",Qlt);const tct=[["path",{d:"M5 12h14",key:"1ays0h"}]],hwe=ut("minus",tct);const nct=[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]],T2=ut("mountain",nct);const rct=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],ict=ut("mouse-pointer",rct);const sct=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],cb=ut("navigation",sct);const oct=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],dwe=ut("pause",oct);const act=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],nse=ut("pen-line",act);const lct=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],cct=ut("pen",lct);const uct=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],k2=ut("pencil",uct);const hct=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]],fwe=ut("person-standing",hct);const dct=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],pwe=ut("play",dct);const fct=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],uu=ut("plus",fct);const pct=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],mct=ut("refresh-cw",pct);const gct=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yct=ut("rotate-ccw",gct);const vct=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],_ct=ut("rotate-cw",vct);const xct=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],hN=ut("route",xct);const wct=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Qk=ut("ruler",wct);const bct=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],mwe=ut("save",bct);const Ect=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Sct=ut("scale",Ect);const Tct=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],dN=ut("search",Tct);const kct=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],LV=ut("settings",kct);const Act=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Ict=ut("settings-2",Act);const Rct=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Pct=ut("share-2",Rct);const Mct=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Cct=ut("shield",Mct);const Nct=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Oct=ut("sliders-horizontal",Nct);const Lct=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],Dct=ut("sliders-vertical",Lct);const $ct=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],jct=ut("smartphone",$ct);const Fct=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Vct=ut("square",Fct);const zct=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Uct=ut("sun",zct);const Gct=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Bct=ut("tag",Gct);const Wct=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Hct=ut("target",Wct);const qct=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Kct=ut("timer",qct);const Yct=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wp=ut("trash-2",Yct);const Xct=[["path",{d:"M13 8c0-2.76-2.46-5-5.5-5S2 5.24 2 8h2l1-1 1 1h4",key:"foxbe7"}],["path",{d:"M13 7.14A5.82 5.82 0 0 1 16.5 6c3.04 0 5.5 2.24 5.5 5h-3l-1-1-1 1h-3",key:"18arnh"}],["path",{d:"M5.89 9.71c-2.15 2.15-2.3 5.47-.35 7.43l4.24-4.25.7-.7.71-.71 2.12-2.12c-1.95-1.96-5.27-1.8-7.42.35",key:"ywahnh"}],["path",{d:"M11 15.5c.5 2.5-.17 4.5-1 6.5h4c2-5.5-.5-12-1-14",key:"ft0feo"}]],Zct=ut("tree-palm",Xct);const Jct=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Qct=ut("trending-down",Jct);const eut=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],tut=ut("trending-up",eut);const nut=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],rH=ut("type",nut);const rut=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],AI=ut("upload",rut);const iut=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],iH=ut("user",iut);const sut=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],out=ut("volume-2",sut);const aut=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],lut=ut("waves",aut);const cut=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],uut=ut("wifi-off",cut);const hut=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],rse=ut("wind",hut);const dut=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ei=ut("x",dut);const fut=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],put=ut("zoom-in",fut);function mut(){const{tracking:t,startTracking:e,stopTracking:n,updatePosition:r,setWatchId:i}=bs(),s=X.useCallback(a=>{r(a)},[r]),o=X.useCallback(a=>{console.error("GPS error:",a),alert(`GPS fout: ${a.message}`),n()},[n]);return X.useEffect(()=>{if(!t)return;if(!navigator.geolocation){alert("Geolocation wordt niet ondersteund door deze browser"),n();return}const a=navigator.geolocation.watchPosition(s,o,{enableHighAccuracy:!0,maximumAge:1e3,timeout:15e3});return i(a),()=>{navigator.geolocation.clearWatch(a)}},[t,s,o,i,n]),{tracking:t,start:e,stop:n,toggle:()=>t?n():e()}}async function gut(){const t=DeviceOrientationEvent;if(typeof t.requestPermission=="function")try{return await t.requestPermission()==="granted"}catch{return!1}return!0}function yut(){const{tracking:t,start:e,stop:n}=mut(),r=bs(a=>a.navigationMode),i=bs(a=>a.setNavigationMode),s=t&&r==="headingUp",o=async()=>{t?r==="free"?i("headingUp"):n():(await gut(),e(),i("free"))};return m.jsx(Ct.button,{className:`
        fixed bottom-2 right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${s?"bg-gradient-to-br from-green-400 to-green-600 text-white shadow-lg shadow-green-500/30":t?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:o,whileHover:{scale:1.05},whileTap:{scale:.95},animate:t?{scale:[1,1.02,1]}:{},transition:t?{scale:{duration:2,repeat:1/0,ease:"easeInOut"}}:{},"aria-label":s?"Rijmodus actief (kaart draait mee)":t?"GPS actief - klik voor rijmodus":"GPS starten",title:s?"Rijmodus actief - klik om GPS te stoppen":t?"GPS actief - klik voor rijmodus":"GPS starten",children:s?m.jsx(cb,{size:22,strokeWidth:2}):m.jsx(Klt,{size:22,strokeWidth:2})})}const vut="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
    <polygon points="24,6 38,38 24,30 10,38" fill="#4285F4" stroke="white" stroke-width="3" stroke-linejoin="round"/>
  </svg>`),ise=new zn({image:new $a({radius:7,fill:new Nr({color:"#4285F4"}),stroke:new Sr({color:"white",width:2.5})})});function _ut(){const t=es(v=>v.map),e=bs(v=>v.position),n=bs(v=>v.accuracy),r=bs(v=>v.tracking),i=bs(v=>v.smoothHeading),s=bs(v=>v.navigationMode),o=Nn(v=>v.showAccuracyCircle),a=bs(v=>v.firstFix),l=bs(v=>v.resetFirstFix),c=bs(v=>v.config.centerOnUser),u=X.useRef(null),h=X.useRef(null),f=X.useRef(null),g=X.useMemo(()=>v=>new zn({image:new TA({src:vut,scale:.9,rotation:v,rotateWithView:!0,anchor:[.5,.5]})}),[]);return X.useEffect(()=>{if(!t||!e)return;const v=Pi([e.lng,e.lat]);return u.current=new _i({geometry:new Vs(v)}),u.current.setStyle(r?g(0):ise),h.current=new _i({geometry:new Vs(v)}),f.current=new gp({source:new Nd({features:[h.current,u.current]}),zIndex:1e3}),t.addLayer(f.current),()=>{f.current&&t&&t.removeLayer(f.current)}},[t,!!e,g]),X.useEffect(()=>{if(u.current)if(r){const v=i!==null?i*Math.PI/180:0;u.current.setStyle(g(v))}else u.current.setStyle(ise)},[r,g,i]),X.useEffect(()=>{if(!t||!e||!u.current||!h.current)return;const v=Pi([e.lng,e.lat]);if(u.current.getGeometry()?.setCoordinates(v),h.current.getGeometry()?.setCoordinates(v),r&&o&&n){const x=t.getView().getResolution()||1,b=Math.min(n/x,80);h.current.setStyle(new zn({image:new $a({radius:b,fill:new Nr({color:"rgba(66, 133, 244, 0.12)"})})}))}else h.current.setStyle(new zn({}));if(a&&r){t.getView().setCenter(v),t.getView().setZoom(17),l();return}r&&c&&!a&&t.getView().animate({center:v,duration:150})},[t,r,e,n,a,l,c,o]),X.useEffect(()=>{if(!u.current||!r)return;const v=i!==null?i*Math.PI/180:0;u.current.setStyle(g(v))},[i,g,r]),X.useEffect(()=>{if(!(!t||!r)&&s==="headingUp"&&i!==null){const v=-(i*Math.PI)/180,x=t.getView(),b=x.getRotation();let T=v-b;for(;T>Math.PI;)T-=2*Math.PI;for(;T<-Math.PI;)T+=2*Math.PI;Math.abs(T)>.01&&x.animate({rotation:b+T,duration:200})}},[t,r,s,i]),X.useEffect(()=>{if(t&&s==="free"){const v=t.getView(),x=v.getRotation();Math.abs(x)>.01&&v.animate({rotation:0,duration:300})}},[t,s]),null}function xut(){const t=ri(n=>n.themesPanelOpen),e=ri(n=>n.toggleThemesPanel);return m.jsx(Ct.button,{className:`
        fixed bottom-[60px] right-2 z-[1000]
        w-11 h-11 cursor-pointer border-0 outline-none
        flex items-center justify-center
        rounded-xl backdrop-blur-sm
        transition-all duration-200
        ${t?"bg-gradient-to-br from-blue-400 to-blue-600 text-white shadow-lg shadow-blue-500/30":"bg-white/80 text-gray-500 hover:bg-white/90 shadow-sm"}
      `,onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":t?"Kaartlagen sluiten":"Kaartlagen openen",title:"Kaartlagen",children:m.jsx(nH,{size:22,strokeWidth:2})})}function wut(){return m.jsx(xut,{})}const nM=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"],Nm=["Mineraal","Fossiel","Erfgoed","Monument","Overig"],Uc="default-vondsten",DV={id:Uc,name:"Mijn vondsten",color:"#f97316",categories:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()},but=t=>t.some(n=>n.id===Uc)?t:[{...DV,createdAt:new Date().toISOString()},...t],Po=No()(dh((t,e)=>({layers:[{...DV}],colorIndex:0,addLayer:(n,r=Nm)=>{const i=crypto.randomUUID(),s=nM[e().colorIndex%nM.length];return t(o=>({layers:[...o.layers,{id:i,name:n,color:s,categories:[...r],points:[],visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:o.colorIndex+1})),i},removeLayer:n=>{t(r=>({layers:r.layers.filter(i=>i.id!==n)}))},updateLayer:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,...r}:s)}))},toggleVisibility:n=>{t(r=>({layers:r.layers.map(i=>i.id===n?{...i,visible:!i.visible}:i)}))},toggleArchived:n=>{t(r=>({layers:r.layers.map(i=>i.id===n?{...i,archived:!i.archived,visible:i.archived?i.visible:!1}:i)}))},addPoint:(n,r)=>{const i={...r,status:r.status||"todo",id:crypto.randomUUID(),createdAt:new Date().toISOString()};t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:[...o.points,i]}:o)}))},removePoint:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,points:s.points.filter(o=>o.id!==r)}:s)}))},updatePoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,...i}:a)}:o)}))},setPointStatus:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,status:i}:a)}:o)}))},addCategory:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n&&!s.categories.includes(r)?{...s,categories:[...s.categories,r]}:s)}))},removeCategory:(n,r)=>{t(i=>({layers:i.layers.map(s=>s.id===n?{...s,categories:s.categories.filter(o=>o!==r)}:s)}))},addPhotoToPoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,photos:[...a.photos||[],i]}:a)}:o)}))},removePhotoFromPoint:(n,r,i)=>{t(s=>({layers:s.layers.map(o=>o.id===n?{...o,points:o.points.map(a=>a.id===r?{...a,photos:(a.photos||[]).filter(l=>l.id!==i)}:a)}:o)}))},updatePhotoInPoint:(n,r,i,s)=>{t(o=>({layers:o.layers.map(a=>a.id===n?{...a,points:a.points.map(l=>l.id===r?{...l,photos:(l.photos||[]).map(c=>c.id===i?{...c,...s}:c)}:l)}:a)}))},exportLayerAsGeoJSON:n=>{const r=e().layers.find(l=>l.id===n);if(!r)return;const i={type:"FeatureCollection",properties:{name:r.name,color:r.color,categories:r.categories,createdAt:r.createdAt,exportedAt:new Date().toISOString()},features:r.points.map(l=>({type:"Feature",geometry:{type:"Point",coordinates:l.coordinates},properties:{id:l.id,name:l.name,category:l.category,notes:l.notes,url:l.url,status:l.status,sourceLayer:l.sourceLayer,sourceId:l.sourceId,photos:l.photos,createdAt:l.createdAt}}))},s=new Blob([JSON.stringify(i,null,2)],{type:"application/geo+json"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`${r.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},importLayerFromGeoJSON:n=>{try{const r=JSON.parse(n);if(r.type!=="FeatureCollection")return{success:!1,error:"Ongeldig GeoJSON formaat"};const i=r.properties||{},s=i.name||`Gemporteerd ${new Date().toLocaleDateString("nl-NL")}`,o=i.categories||Nm,a=i.color||nM[e().colorIndex%nM.length],l=(r.features||[]).filter(u=>u.geometry?.type==="Point").map(u=>({id:u.properties?.id||crypto.randomUUID(),name:u.properties?.name||"Naamloos",category:u.properties?.category||"Overig",notes:u.properties?.notes||"",url:u.properties?.url,status:u.properties?.status||"todo",sourceLayer:u.properties?.sourceLayer,sourceId:u.properties?.sourceId,photos:u.properties?.photos,coordinates:u.geometry.coordinates,createdAt:u.properties?.createdAt||new Date().toISOString()})),c=crypto.randomUUID();return t(u=>({layers:[...u.layers,{id:c,name:s,color:a,categories:o,points:l,visible:!0,archived:!1,createdAt:new Date().toISOString()}],colorIndex:u.colorIndex+1})),{success:!0,layerId:c}}catch{return{success:!1,error:"Fout bij parsen van GeoJSON"}}},getLayer:n=>e().layers.find(r=>r.id===n),getActiveLayerCount:()=>e().layers.filter(n=>!n.archived).length,getArchivedLayerCount:()=>e().layers.filter(n=>n.archived).length,clearAll:()=>{t(n=>({layers:n.layers.map(r=>r.id===Uc?{...r,points:[]}:r).filter(r=>r.id===Uc),colorIndex:0}))}}),{name:"detectorapp-custom-point-layers",version:3,onRehydrateStorage:()=>t=>{t&&(t.layers.some(n=>n.id===Uc)||(t.layers=[{...DV,createdAt:new Date().toISOString()},...t.layers]))},migrate:(t,e)=>{const n=t;return e<2?{...n,layers:but(n.layers||[])}:e<3?{...n,layers:(n.layers||[]).map(r=>r.id===Uc?{...r,name:"Mijn vondsten"}:r)}:n}}));function Ns({title:t,children:e,defaultExpanded:n=!0,layerNames:r}){const[i,s]=X.useState(n),o=io(b=>b.visible),a=io(b=>b.setLayerVisibility),l=sG(b=>b.isLayerUnlocked),c=b=>{const T=Sy[b],A=T?.tier??"free",I=T?.regions??["nl"];return l(b,A,I)},u=r?.filter(b=>c(b))||[],h=u.filter(b=>o[b]).length,f=u.length,g=f>0&&h===f,v=h>0&&h<f,x=b=>{if(b.stopPropagation(),!r||u.length===0)return;const T=!g;u.forEach(A=>{a(A,T)})};return m.jsxs("div",{className:"mb-0.5",children:[m.jsxs("div",{className:"flex items-center gap-1 py-1 px-1 hover:bg-blue-50 transition-colors",children:[m.jsxs("button",{onClick:b=>{b.stopPropagation(),s(!i)},className:"flex-1 flex items-center gap-1 bg-transparent border-0 outline-none text-left",style:{fontSize:"inherit"},children:[m.jsx(Ct.span,{animate:{rotate:i?90:0},transition:{duration:.15},className:"text-gray-400",children:m.jsx(lb,{size:14})}),i?m.jsx(klt,{size:16,className:"text-blue-500"}):m.jsx(Plt,{size:16,className:"text-blue-500"}),m.jsx("span",{className:"text-gray-700 font-medium",style:{fontSize:"1em"},children:t}),h>0&&m.jsx("span",{className:"ml-1 px-1.5 py-0.5 font-medium bg-blue-100 text-blue-600 rounded-full",style:{fontSize:"0.7em"},children:h})]}),r&&r.length>0&&m.jsx("button",{onClick:x,className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:g?"#3b82f6":v?"#93c5fd":"white",border:g?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:(g||v)&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),m.jsx(ar,{initial:!1,children:i&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.15},style:{overflow:"hidden"},className:"ml-5",children:e})})]})}function xt({name:t,type:e,hasOverlay:n,displayName:r}){const i=io(R=>R.visible[t]),s=io(R=>R.visible["Labels Overlay"]),o=io(R=>R.loadingState[t]),a=io(R=>R.toggleLayer),l=io(R=>R.setLayerVisibility),c=sG(R=>R.isLayerUnlocked),u=o==="loading",h=o==="error",f=Sy[t],g=f?.tier??"free",v=f?.regions??["nl"],b=!c(t,g,v),T=R=>{R.stopPropagation(),!(u||b)&&(e==="overlay"?a(t):["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"].forEach(V=>{l(V,V===t)}))},A=R=>{R.stopPropagation(),l("Labels Overlay",!s)},I=i??!1;return m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs("button",{onClick:T,disabled:u||b,className:`flex-1 flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${b?"opacity-50 cursor-not-allowed bg-gray-50":u?"opacity-70 cursor-wait bg-transparent":I?"bg-blue-50 hover:bg-blue-100":"bg-transparent hover:bg-blue-50"}`,style:{fontSize:"inherit"},title:b?"Premium laag - upgrade om te ontgrendelen":void 0,children:[m.jsxs("span",{className:`flex items-center gap-1 ${h?"text-red-500":b?"text-gray-400":"text-gray-600"}`,children:[r||t,h&&m.jsx(awe,{size:12,className:"text-red-500"}),b&&m.jsx(OV,{size:12,className:"text-amber-500"})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:b?"#e5e7eb":u?"#93c5fd":I?"#3b82f6":"white",border:b?"2px solid #d1d5db":u?"2px solid #93c5fd":I?"2px solid #3b82f6":"2px solid #60a5fa",color:"white"},children:b?m.jsx(OV,{size:10,strokeWidth:3,className:"text-gray-400"}):u?m.jsx(eH,{size:10,strokeWidth:3,className:"animate-spin"}):I?m.jsx(up,{size:12,strokeWidth:3}):null})]}),n&&I&&m.jsx("button",{onClick:A,className:`p-1 rounded transition-colors border-0 outline-none ${s?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,title:s?"Labels verbergen":"Labels tonen",children:m.jsx(Bct,{size:12})})]})}const Eut=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#6b7280"];function gwe({layer:t,compact:e=!1}){const{toggleVisibility:n,removeLayer:r,updateLayer:i,setColor:s}=qA(),[o,a]=X.useState(!1),[l,c]=X.useState(!1),[u,h]=X.useState(t.name),[f,g]=X.useState(!1),v=X.useRef(null),x=X.useRef(null),b=t.features.features.length,T=[...new Set(t.features.features.map(M=>M.geometry?.type).filter(Boolean))];X.useEffect(()=>{l&&v.current&&(v.current.focus(),v.current.select())},[l]),X.useEffect(()=>{const M=N=>{x.current&&!x.current.contains(N.target)&&g(!1)};if(f)return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[f]);const A=()=>{o?r(t.id):(a(!0),setTimeout(()=>a(!1),3e3))},I=()=>{const M=u.trim();M&&M!==t.name&&i(t.id,{name:M}),c(!1)},R=()=>{h(t.name),c(!1)},C=M=>{M.key==="Enter"?I():M.key==="Escape"&&R()},V=M=>{s(t.id,M),g(!1)};return e?m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 hover:bg-blue-50 transition-colors rounded",children:[m.jsx("button",{onClick:()=>n(t.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:t.visible?t.color:"white",border:`2px solid ${t.color}`},title:t.visible?"Verbergen":"Tonen",children:t.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("span",{className:"text-gray-700 truncate flex-1 cursor-pointer",style:{fontSize:"0.9em"},onClick:()=>n(t.id),children:t.name}),m.jsx("span",{className:"text-[10px] text-gray-400 flex-shrink-0",children:b})]}):m.jsxs("div",{className:"flex items-center justify-between py-1.5 group",children:[m.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[m.jsxs("div",{className:"relative",ref:x,children:[m.jsx("button",{onClick:()=>g(!f),className:"w-5 h-5 rounded border-2 border-white shadow-sm flex-shrink-0 hover:scale-110 transition-transform",style:{backgroundColor:t.color},title:"Kleur wijzigen"}),f&&m.jsx("div",{className:"absolute top-6 left-0 z-50 bg-white rounded-lg shadow-lg border p-2 grid grid-cols-3 gap-1",children:Eut.map(M=>m.jsx("button",{onClick:()=>V(M),className:`w-6 h-6 rounded border-2 transition-transform hover:scale-110 ${M===t.color?"border-gray-800 scale-110":"border-white"}`,style:{backgroundColor:M},title:M},M))})]}),m.jsx("div",{className:"flex-1 min-w-0",children:l?m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("input",{ref:v,type:"text",value:u,onChange:M=>h(M.target.value),onKeyDown:C,className:"flex-1 text-sm px-1 py-0.5 border rounded min-w-0"}),m.jsx("button",{onClick:I,className:"p-0.5 text-green-600 hover:bg-green-50 rounded",title:"Opslaan",children:m.jsx(up,{size:14})}),m.jsx("button",{onClick:R,className:"p-0.5 text-gray-400 hover:bg-gray-100 rounded",title:"Annuleren",children:m.jsx(Ei,{size:14})})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-sm text-gray-700 truncate",children:t.name}),m.jsx("button",{onClick:()=>c(!0),className:"p-0.5 text-gray-400 hover:text-blue-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Naam wijzigen",children:m.jsx(k2,{size:12})})]}),m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[m.jsxs("span",{children:[b," ",b===1?"feature":"features"]}),T.length>0&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"mx-0.5",children:""}),m.jsx("span",{children:T.join(", ")})]})]})]})})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>n(t.id),className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:t.visible?t.color:"white",border:`2px solid ${t.visible?t.color:"#9ca3af"}`},title:t.visible?"Verbergen":"Tonen",children:t.visible&&m.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",children:m.jsx("path",{d:"M2 5 L4 7 L8 3",stroke:"white",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})}),m.jsx("button",{onClick:A,className:`p-1 rounded transition-colors border-0 outline-none ${o?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-500 hover:bg-red-50"}`,title:o?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(wp,{size:14})})]})]})}const fN="commercial",Sut={commercial:["Archeologische lagen","Archeologische verwachtingen","Erfgoed & Monumenten","WOII & Militair","Hillshade & LiDAR","Terrein & Bodem","Percelen","Recreatie"],personal:["Steentijd & Prehistorie","Paleokaarten","Archeologische lagen","Archeologische verwachtingen","Erfgoed & Monumenten","WOII & Militair","Hillshade & LiDAR","Terrein & Bodem","Percelen","Provinciale Thema's","Fossielen, Mineralen & Goud","Recreatie"]},Tut={commercial:["Specials (3D)"],personal:["Specials (3D)"]};function $l(t){return Sut[fN].includes(t)}function kut(t){return Tut[fN].includes(t)}const Aut=[{name:"Rapa Nui - Moai Productie",url:"https://arcg.is/qu59O1",desc:"Paaseiland steengroeve in 3D"},{name:"Digital Giza - Piramides",url:"http://giza.fas.harvard.edu/giza3d/",desc:"Harvard 3D reconstructie"},{name:"Stonehenge 360",url:"https://www.english-heritage.org.uk/visit/places/stonehenge/history-and-stories/stonehenge360/",desc:"English Heritage virtuele tour"},{name:"Pompeii 3D Explorer",url:"https://www.cyark.org/projects/pompeii/3D-Explorer",desc:"CyArk LiDAR scans"},{name:"Virtual Angkor Wat",url:"https://www.virtualangkor.com/",desc:"3D reconstructie 1300 n.Chr."},{name:"Petra Virtuele Tour",url:"https://www.zamaniproject.org/site-jordan-petra.html",desc:"Zamani Project 3D"}],Iut=[{name:"CyArk (200+ sites)",url:"https://www.cyark.org/projects/",desc:"Wereldwijd erfgoed archief"},{name:"Google Open Heritage",url:"https://artsandculture.google.com/project/openheritage",desc:"26+ UNESCO sites in 3D"}];function Rut(){const{themesPanelOpen:t,toggleThemesPanel:e,toggleSettingsPanel:n}=ri(),{layers:r,toggleVisibility:i}=Po(),s=qA(v=>v.layers),o=X.useRef(null),a=Nn(v=>v.layerPanelFontScale),l=Nn(v=>v.setLayerPanelFontScale),c=Nn(v=>v.showFontSliders),u=Nn(v=>v.showCustomPointLayers),h=13*a/100,[f,g]=X.useState(!1);return X.useEffect(()=>{if(!t)return;const v=b=>{o.current&&!o.current.contains(b.target)&&e()},x=setTimeout(()=>{document.addEventListener("click",v)},100);return()=>{clearTimeout(x),document.removeEventListener("click",v)}},[t,e]),m.jsx(ar,{children:t&&m.jsxs(Ct.div,{ref:o,className:"fixed top-2.5 right-2 z-[1101] bg-white rounded-lg shadow-lg overflow-hidden w-[300px] max-h-[calc(100vh-200px)] flex flex-col",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.15},children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-500",style:{fontSize:`${h}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(nu,{size:14,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Kaartlagen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[c&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:a,onInput:v=>{l(parseInt(v.target.value))},onChange:v=>l(parseInt(v.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),m.jsx("button",{onClick:e,className:"p-0.5 rounded border-0 outline-none bg-blue-400/50 hover:bg-blue-400 transition-colors ml-1",children:m.jsx(Ei,{size:16,className:"text-white",strokeWidth:2.5})})]})]}),m.jsxs("div",{className:"p-2 overflow-y-auto flex-1",style:{fontSize:`${h}px`},children:[u&&r.filter(v=>!v.archived).length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsx("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:m.jsx("span",{className:"text-orange-600 font-medium",style:{fontSize:"0.9em"},children:"Mijn lagen"})}),r.filter(v=>!v.archived).map(v=>m.jsxs("button",{onClick:x=>{x.stopPropagation(),i(v.id)},className:`w-full flex items-center justify-between py-1 pl-3 pr-2 border-0 outline-none transition-colors text-left ${v.visible?"bg-orange-50 hover:bg-orange-100":"bg-transparent hover:bg-orange-50"}`,style:{fontSize:"inherit"},children:[m.jsxs("span",{className:"flex items-center gap-2 text-gray-600",children:[v.name,m.jsxs("span",{className:"text-xs text-gray-400",children:["(",v.points.length,")"]})]}),m.jsx("div",{className:"w-4 h-4 rounded-sm flex items-center justify-center transition-all duration-100 flex-shrink-0",style:{backgroundColor:v.visible?"#f97316":"white",border:v.visible?"2px solid #f97316":"2px solid #fb923c",color:"white"},children:v.visible&&m.jsx(up,{size:12,strokeWidth:3})})]},v.id))]}),s.length>0&&m.jsxs("div",{className:"mb-2 pb-1 border-b border-gray-100",children:[m.jsxs("div",{className:"flex items-center gap-1 py-0.5 px-1 mb-1",children:[m.jsx(AI,{size:12,className:"text-cyan-600"}),m.jsx("span",{className:"text-cyan-600 font-medium",style:{fontSize:"0.9em"},children:"Gemporteerde lagen"})]}),s.map(v=>m.jsx(gwe,{layer:v,compact:!0},v.id)),m.jsx("button",{onClick:()=>{e(),n()},className:"w-full text-left py-1 pl-3 text-xs text-cyan-500 hover:text-cyan-700 hover:bg-cyan-50 transition-colors",children:"+ Laag importeren..."})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Basislaag"})}),m.jsxs("div",{className:"space-y-0",children:[m.jsx(xt,{name:"CartoDB (licht)",type:"base"}),m.jsx(xt,{name:"OpenStreetMap",type:"base"}),m.jsx(xt,{name:"Luchtfoto",type:"base",hasOverlay:!0}),m.jsx(xt,{name:"TMK 1850",type:"base",hasOverlay:!0}),m.jsx(xt,{name:"Bonnebladen 1900",type:"base",hasOverlay:!0})]})]}),m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"flex items-center gap-1 py-1 px-1 mb-1 border-t border-gray-100 pt-2",children:m.jsx("span",{className:"text-blue-600 font-medium",style:{fontSize:"0.95em"},children:"Thema's"})}),$l("Steentijd & Prehistorie")&&m.jsxs(Ns,{title:"Steentijd & Prehistorie",defaultExpanded:!1,layerNames:["Hunebedden","Grafheuvels","Terpen","FAMKE Steentijd","FAMKE IJzertijd"],children:[m.jsx(xt,{name:"Hunebedden",type:"overlay"}),m.jsx(xt,{name:"Grafheuvels",type:"overlay"}),m.jsx(xt,{name:"Terpen",type:"overlay"}),m.jsx(xt,{name:"FAMKE Steentijd",type:"overlay"}),m.jsx(xt,{name:"FAMKE IJzertijd",type:"overlay"})]}),$l("Paleokaarten")&&m.jsxs(Ns,{title:"Paleokaarten",defaultExpanded:!1,layerNames:["Paleokaart 9000 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 500 v.Chr.","Paleokaart 100 n.Chr.","Paleokaart 800 n.Chr."],children:[m.jsx(xt,{name:"Paleokaart 9000 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 5500 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 2750 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 1500 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 500 v.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 100 n.Chr.",type:"overlay"}),m.jsx(xt,{name:"Paleokaart 800 n.Chr.",type:"overlay"})]}),$l("Archeologische lagen")&&m.jsxs(Ns,{title:"Archeologische lagen",defaultExpanded:!1,layerNames:["AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Archeo Onderzoeken","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(xt,{name:"AMK Monumenten",type:"overlay"}),m.jsxs(Ns,{title:"Per periode",defaultExpanded:!1,layerNames:["AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig"],children:[m.jsx(xt,{name:"AMK Romeins",type:"overlay"}),m.jsx(xt,{name:"AMK Steentijd",type:"overlay"}),m.jsx(xt,{name:"AMK Vroege ME",type:"overlay"}),m.jsx(xt,{name:"AMK Late ME",type:"overlay"}),m.jsx(xt,{name:"AMK Overig",type:"overlay"})]}),m.jsx(xt,{name:"Archeo Onderzoeken",type:"overlay"}),m.jsxs(Ns,{title:"Romeinse tijd",defaultExpanded:!1,layerNames:["Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(xt,{name:"Romeinse wegen (regio)",type:"overlay"}),m.jsx(xt,{name:"Romeinse wegen (Wereld)",type:"overlay"}),m.jsxs(Ns,{title:"Romeinse Forten",defaultExpanded:!1,layerNames:["Romeinse Forten","Romeinse Forten Lijnen"],children:[m.jsx(xt,{name:"Romeinse Forten",type:"overlay"}),m.jsx(xt,{name:"Romeinse Forten Lijnen",type:"overlay"})]})]})]}),$l("Archeologische verwachtingen")&&m.jsxs(Ns,{title:"Archeologische verwachtingen",defaultExpanded:!1,layerNames:["Kansenkaart","IKAW","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling"],children:[m.jsx(xt,{name:"Kansenkaart",type:"overlay"}),m.jsx(xt,{name:"IKAW",type:"overlay"}),m.jsx(xt,{name:"UIKAV Punten",type:"overlay"}),m.jsx(xt,{name:"UIKAV Vlakken",type:"overlay"}),m.jsx(xt,{name:"UIKAV Expert",type:"overlay"}),m.jsx(xt,{name:"UIKAV Buffer",type:"overlay"}),m.jsx(xt,{name:"UIKAV Indeling",type:"overlay"})]}),$l("Erfgoed & Monumenten")&&m.jsxs(Ns,{title:"Erfgoed & Monumenten",defaultExpanded:!1,layerNames:["Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Kastelen","Runes"],children:[m.jsx(xt,{name:"Rijksmonumenten",type:"overlay"}),m.jsx(xt,{name:"Werelderfgoed",type:"overlay"}),m.jsx(xt,{name:"Religieus Erfgoed",type:"overlay"}),m.jsx(xt,{name:"Kastelen",type:"overlay"}),m.jsx(xt,{name:"Runes",type:"overlay"})]}),$l("WOII & Militair")&&m.jsxs(Ns,{title:"WOII & Militair",defaultExpanded:!1,layerNames:["WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Militaire Objecten","Inundatiegebieden"],children:[m.jsx(xt,{name:"WWII Bunkers",type:"overlay"}),m.jsx(xt,{name:"Slagvelden",type:"overlay"}),m.jsx(xt,{name:"Militaire Vliegvelden",type:"overlay"}),m.jsx(xt,{name:"Verdedigingslinies",type:"overlay"}),m.jsx(xt,{name:"Militaire Objecten",type:"overlay"}),m.jsx(xt,{name:"Inundatiegebieden",type:"overlay"})]}),$l("Hillshade & LiDAR")&&m.jsxs(Ns,{title:"Hillshade & LiDAR",defaultExpanded:!1,layerNames:["AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN4 Hillshade Kleur","AHN 0.5m"],children:[m.jsx(xt,{name:"AHN4 Hoogtekaart Kleur",type:"overlay"}),m.jsx(xt,{name:"AHN4 Hillshade NL",type:"overlay"}),m.jsx(xt,{name:"AHN4 Multi-Hillshade NL",type:"overlay"}),m.jsx(xt,{name:"AHN4 Hillshade Kleur",type:"overlay"}),m.jsx(xt,{name:"AHN 0.5m",type:"overlay"})]}),$l("Terrein & Bodem")&&m.jsxs(Ns,{title:"Terrein & Bodem",defaultExpanded:!1,layerNames:["Veengebieden","Geomorfologie","Bodemkaart","Essen"],children:[m.jsx(xt,{name:"Veengebieden",type:"overlay"}),m.jsx(xt,{name:"Geomorfologie",type:"overlay"}),m.jsx(xt,{name:"Bodemkaart",type:"overlay"}),m.jsx(xt,{name:"Essen",type:"overlay"})]}),$l("Percelen")&&m.jsxs(Ns,{title:"Percelen",defaultExpanded:!1,layerNames:["Gewaspercelen","Kadastrale Grenzen"],children:[m.jsx(xt,{name:"Gewaspercelen",type:"overlay"}),m.jsx(xt,{name:"Kadastrale Grenzen",type:"overlay"})]}),$l("Provinciale Thema's")&&m.jsxs(Ns,{title:"Provinciale Thema's",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],children:[m.jsxs(Ns,{title:"Zuid-Holland",defaultExpanded:!1,layerNames:["Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen"],children:[m.jsx(xt,{name:"Scheepswrakken",type:"overlay"}),m.jsx(xt,{name:"Woonheuvels ZH",type:"overlay"}),m.jsx(xt,{name:"Windmolens",type:"overlay"}),m.jsx(xt,{name:"Erfgoedlijnen",type:"overlay"}),m.jsx(xt,{name:"Oude Kernen",type:"overlay"})]}),m.jsxs(Ns,{title:"Gelderland",defaultExpanded:!1,layerNames:["Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken"],children:[m.jsx(xt,{name:"Relictenkaart Punten",type:"overlay"}),m.jsx(xt,{name:"Relictenkaart Lijnen",type:"overlay"}),m.jsx(xt,{name:"Relictenkaart Vlakken",type:"overlay"})]}),m.jsx(Ns,{title:"Zeeland",defaultExpanded:!1,layerNames:["Verdronken Dorpen"],children:m.jsx(xt,{name:"Verdronken Dorpen",type:"overlay"})})]}),$l("Fossielen, Mineralen & Goud")&&m.jsxs(Ns,{title:"Fossielen, Mineralen & Goud",defaultExpanded:!1,layerNames:["Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk"],children:[m.jsx(xt,{name:"Fossiel Hotspots",type:"overlay"}),m.jsx(xt,{name:"Mineralen Hotspots",type:"overlay"}),m.jsx(xt,{name:"Goudrivieren",type:"overlay"}),m.jsx(xt,{name:"Fossielen Nederland",type:"overlay"}),m.jsx(xt,{name:"Fossielen Belgi",type:"overlay"}),m.jsx(xt,{name:"Fossielen Duitsland",type:"overlay"}),m.jsx(xt,{name:"Fossielen Frankrijk",type:"overlay"})]}),$l("Recreatie")&&fN==="commercial"&&m.jsxs(Ns,{title:"Recreatie",defaultExpanded:!1,layerNames:["Parken","Speeltuinen","Strandjes"],children:[m.jsx(xt,{name:"Parken",type:"overlay"}),m.jsx(xt,{name:"Speeltuinen",type:"overlay"}),m.jsx(xt,{name:"Strandjes",type:"overlay",displayName:"Recreatie (strand)"})]}),$l("Recreatie")&&fN==="personal"&&m.jsxs(Ns,{title:"Recreatie",defaultExpanded:!1,layerNames:["Ruiterpaden","Laarzenpaden","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels"],children:[m.jsx(xt,{name:"Ruiterpaden",type:"overlay"}),m.jsx(xt,{name:"Laarzenpaden",type:"overlay"}),m.jsx(xt,{name:"Parken",type:"overlay"}),m.jsx(xt,{name:"Speeltuinen",type:"overlay"}),m.jsx(xt,{name:"Musea",type:"overlay"}),m.jsx(xt,{name:"Strandjes",type:"overlay"}),m.jsx(xt,{name:"Kringloopwinkels",type:"overlay"})]}),kut("Specials (3D)")&&m.jsxs("div",{className:"mb-2",children:[m.jsxs("button",{onClick:v=>{v.stopPropagation(),g(!f)},className:"w-full flex items-center gap-1 py-1 px-1 hover:bg-purple-50 rounded transition-colors border-0 outline-none bg-transparent",children:[f?m.jsx(ab,{size:14,className:"text-purple-500"}):m.jsx(lb,{size:14,className:"text-purple-500"}),m.jsx(Dlt,{size:12,className:"text-purple-500"}),m.jsx("span",{className:"text-purple-600 font-medium",style:{fontSize:"0.95em"},children:"Specials (3D)"}),m.jsx(vg,{size:10,className:"text-purple-400 ml-auto"})]}),f&&m.jsxs("div",{className:"mt-1",onClick:v=>v.stopPropagation(),children:[Aut.map(v=>m.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-gray-700",children:v.name}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:v.desc})]}),m.jsx(vg,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},v.name)),m.jsx("div",{className:"border-t border-gray-200 my-1.5 mx-2"}),Iut.map(v=>m.jsxs("a",{href:v.url,target:"_blank",rel:"noopener noreferrer",onClick:x=>x.stopPropagation(),className:"w-full flex items-center justify-between py-1.5 pl-6 pr-2 hover:bg-purple-50 rounded transition-colors text-left",style:{fontSize:"inherit"},children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-gray-700 font-medium",children:v.name}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:v.desc})]}),m.jsx(vg,{size:12,className:"text-purple-400 flex-shrink-0 ml-2"})]},v.name))]})]})]})]})]})})}function Put(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var z1=1,U1=2,ow=3,Mut=4,$V=5,sse=6378137,Cut=6356752314e-3,ose=.0066943799901413165,kT=484813681109536e-20,st=Math.PI/2,Nut=.16666666666666666,Out=.04722222222222222,Lut=.022156084656084655,wt=1e-10,Wi=.017453292519943295,gl=57.29577951308232,Pr=Math.PI/4,eA=Math.PI*2,ls=3.14159265359,Al={};Al.greenwich=0;Al.lisbon=-9.131906111111;Al.paris=2.337229166667;Al.bogota=-74.080916666667;Al.madrid=-3.687938888889;Al.rome=12.452333333333;Al.bern=7.439583333333;Al.jakarta=106.807719444444;Al.ferro=-17.666666666667;Al.brussels=4.367975;Al.stockholm=18.058277777778;Al.athens=23.7163375;Al.oslo=10.722916666667;const Dut={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var ase=/[\s_\-\/\(\)]/g;function zg(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(ase,""),i=-1,s,o;++i<n.length;)if(s=n[i],o=s.toLowerCase().replace(ase,""),o===r)return t[s]}function jV(t){var e={},n=t.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var c=l.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),r,i,s,o={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*Wi},lat_1:function(a){e.lat1=a*Wi},lat_2:function(a){e.lat2=a*Wi},lat_ts:function(a){e.lat_ts=a*Wi},lon_0:function(a){e.long0=a*Wi},lon_1:function(a){e.long1=a*Wi},lon_2:function(a){e.long2=a*Wi},alpha:function(a){e.alpha=parseFloat(a)*Wi},gamma:function(a){e.rectified_grid_angle=parseFloat(a)*Wi},lonc:function(a){e.longc=a*Wi},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var l=zg(Dut,a);l&&(e.to_meter=l.to_meter)},from_greenwich:function(a){e.from_greenwich=a*Wi},pm:function(a){var l=zg(Al,a);e.from_greenwich=(l||parseFloat(a))*Wi},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0},over:function(){e.over=!0}};for(r in n)i=n[r],r in o?(s=o[r],typeof s=="function"?s(i):e[s]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e.projStr=t,e}class ywe{static getId(e){const n=e.find(r=>Array.isArray(r)&&r[0]==="ID");return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(e,n="unit"){if(!e||e.length<3)return{type:n,name:"unknown",conversion_factor:null};const r=e[1],i=parseFloat(e[2])||null,s=e.find(a=>Array.isArray(a)&&a[0]==="ID"),o=s?{authority:s[1],code:parseInt(s[2],10)}:null;return{type:n,name:r,conversion_factor:i,id:o}}static convertAxis(e){const n=e[1]||"Unknown";let r;const i=n.match(/^\((.)\)$/);if(i){const c=i[1].toUpperCase();if(c==="E")r="east";else if(c==="N")r="north";else if(c==="U")r="up";else throw new Error(`Unknown axis abbreviation: ${c}`)}else r=e[2]?e[2].toLowerCase():"unknown";const s=e.find(c=>Array.isArray(c)&&c[0]==="ORDER"),o=s?parseInt(s[1],10):null,a=e.find(c=>Array.isArray(c)&&(c[0]==="LENGTHUNIT"||c[0]==="ANGLEUNIT"||c[0]==="SCALEUNIT")),l=this.convertUnit(a);return{name:n,direction:r,unit:l,order:o}}static extractAxes(e){return e.filter(n=>Array.isArray(n)&&n[0]==="AXIS").map(n=>this.convertAxis(n)).sort((n,r)=>(n.order||0)-(r.order||0))}static convert(e,n={}){switch(e[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=e[1],n.base_crs=e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="BASEGEOGCRS")):null,n.conversion=e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="CONVERSION")):null;const r=e.find(f=>Array.isArray(f)&&f[0]==="CS");r&&(n.coordinate_system={type:r[1],axis:this.extractAxes(e)});const i=e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT");if(i){const f=this.convertUnit(i);n.coordinate_system.unit=f}n.id=this.getId(e);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=e[1];const s=e.find(f=>Array.isArray(f)&&(f[0]==="DATUM"||f[0]==="ENSEMBLE"));if(s){const f=this.convert(s);s[0]==="ENSEMBLE"?n.datum_ensemble=f:n.datum=f;const g=e.find(v=>Array.isArray(v)&&v[0]==="PRIMEM");g&&g[1]!=="Greenwich"&&(f.prime_meridian={name:g[1],longitude:parseFloat(g[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(e)},n.id=this.getId(e);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=e[1],n.ellipsoid=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=e[1],n.members=e.filter(f=>Array.isArray(f)&&f[0]==="MEMBER").map(f=>({type:"DatumEnsembleMember",name:f[1],id:this.getId(f)}));const o=e.find(f=>Array.isArray(f)&&f[0]==="ENSEMBLEACCURACY");o&&(n.accuracy=parseFloat(o[1]));const a=e.find(f=>Array.isArray(f)&&f[0]==="ELLIPSOID");a&&(n.ellipsoid=this.convert(a)),n.id=this.getId(e);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=e[1],n.semi_major_axis=parseFloat(e[2]),n.inverse_flattening=parseFloat(e[3]),e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT")&&this.convert(e.find(f=>Array.isArray(f)&&f[0]==="LENGTHUNIT"),n);break;case"CONVERSION":n.type="Conversion",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&f[0]==="PARAMETER").map(f=>this.convert(f));break;case"METHOD":n.type="Method",n.name=e[1],n.id=this.getId(e);break;case"PARAMETER":n.type="Parameter",n.name=e[1],n.value=parseFloat(e[2]),n.unit=this.convertUnit(e.find(f=>Array.isArray(f)&&(f[0]==="LENGTHUNIT"||f[0]==="ANGLEUNIT"||f[0]==="SCALEUNIT"))),n.id=this.getId(e);break;case"BOUNDCRS":n.type="BoundCRS";const l=e.find(f=>Array.isArray(f)&&f[0]==="SOURCECRS");if(l){const f=l.find(g=>Array.isArray(g));n.source_crs=f?this.convert(f):null}const c=e.find(f=>Array.isArray(f)&&f[0]==="TARGETCRS");if(c){const f=c.find(g=>Array.isArray(g));n.target_crs=f?this.convert(f):null}const u=e.find(f=>Array.isArray(f)&&f[0]==="ABRIDGEDTRANSFORMATION");u?n.transformation=this.convert(u):n.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=e[1],n.method=e.find(f=>Array.isArray(f)&&f[0]==="METHOD")?this.convert(e.find(f=>Array.isArray(f)&&f[0]==="METHOD")):null,n.parameters=e.filter(f=>Array.isArray(f)&&(f[0]==="PARAMETER"||f[0]==="PARAMETERFILE")).map(f=>{if(f[0]==="PARAMETER")return this.convert(f);if(f[0]==="PARAMETERFILE")return{name:f[1],value:f[2],id:{authority:"EPSG",code:8656}}}),n.parameters.length===7){const f=n.parameters[6];f.name==="Scale difference"&&(f.value=Math.round((f.value-1)*1e12)/1e6)}n.id=this.getId(e);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(e));break;case"LENGTHUNIT":const h=this.convertUnit(e,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(f=>{f.unit||(f.unit=h)}),h.conversion_factor&&h.conversion_factor!==1&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:h});break;default:n.keyword=e[0];break}return n}}class $ut extends ywe{static convert(e,n={}){return super.convert(e,n),n.coordinate_system&&n.coordinate_system.subtype==="Cartesian"&&delete n.coordinate_system,n.usage&&delete n.usage,n}}class jut extends ywe{static convert(e,n={}){super.convert(e,n);const r=e.find(s=>Array.isArray(s)&&s[0]==="CS");r&&(n.coordinate_system={subtype:r[1],axis:this.extractAxes(e)});const i=e.find(s=>Array.isArray(s)&&s[0]==="USAGE");if(i){const s=i.find(l=>Array.isArray(l)&&l[0]==="SCOPE"),o=i.find(l=>Array.isArray(l)&&l[0]==="AREA"),a=i.find(l=>Array.isArray(l)&&l[0]==="BBOX");n.usage={},s&&(n.usage.scope=s[1]),o&&(n.usage.area=o[1]),a&&(n.usage.bbox=a.slice(1))}return n}}function Fut(t){return t.find(e=>Array.isArray(e)&&e[0]==="USAGE")?"2019":(t.find(e=>Array.isArray(e)&&e[0]==="CS")||t[0]==="BOUNDCRS"||t[0]==="PROJCRS"||t[0]==="GEOGCRS","2015")}function Vut(t){return(Fut(t)==="2019"?jut:$ut).convert(t)}function zut(t){const e=t.toUpperCase();return e.includes("PROJCRS")||e.includes("GEOGCRS")||e.includes("BOUNDCRS")||e.includes("VERTCRS")||e.includes("LENGTHUNIT")||e.includes("ANGLEUNIT")||e.includes("SCALEUNIT")?"WKT2":(e.includes("PROJCS")||e.includes("GEOGCS")||e.includes("LOCAL_CS")||e.includes("VERT_CS")||e.includes("UNIT"),"WKT1")}var tA=1,vwe=2,_we=3,pN=4,xwe=5,sH=-1,Uut=/\s/,Gut=/[A-Za-z]/,But=/[A-Za-z84_]/,XO=/[,\]]/,wwe=/[\d\.E\-\+]/;function bp(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=tA}bp.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==pN)for(;Uut.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case tA:return this.neutral(t);case vwe:return this.keyword(t);case pN:return this.quoted(t);case xwe:return this.afterquote(t);case _we:return this.number(t);case sH:return}};bp.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=pN;return}if(XO.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};bp.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=tA;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=tA,this.currentObject=this.stack.pop(),this.currentObject||(this.state=sH);return}};bp.prototype.number=function(t){if(wwe.test(t)){this.word+=t;return}if(XO.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};bp.prototype.quoted=function(t){if(t==='"'){this.state=xwe;return}this.word+=t};bp.prototype.keyword=function(t){if(But.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=tA;return}if(XO.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};bp.prototype.neutral=function(t){if(Gut.test(t)){this.word=t,this.state=vwe;return}if(t==='"'){this.word="",this.state=pN;return}if(wwe.test(t)){this.word=t,this.state=_we;return}if(XO.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};bp.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===sH)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Wut(t){var e=new bp(t);return e.output()}function v8(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce(function(s,o){return Rx(o,s),s},r);e&&(t[e]=i)}function Rx(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},Rx(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&Rx(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&Rx(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],v8(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],v8(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Rx(t,e[n]);return v8(e,n,t)}}var Hut=.017453292519943295;function Vu(t){return t*Hut}function bwe(t){const e=(t.projName||"").toLowerCase().replace(/_/g," ");!t.long0&&t.longc&&(e==="albers conic equal area"||e==="lambert azimuthal equal area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(e==="stereographic south pole"||e==="polar stereographic (variant b)")?(t.lat0=Vu(t.lat1>0?90:-90),t.lat_ts=t.lat1,delete t.lat1):!t.lat_ts&&t.lat0&&(e==="polar stereographic"||e==="polar stereographic (variant a)")&&(t.lat_ts=t.lat0,t.lat0=Vu(t.lat0>0?90:-90),delete t.lat1)}function lse(t){let e={units:null,to_meter:void 0};return typeof t=="string"?(e.units=t.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.units==="meter"&&(e.to_meter=1)):t&&t.name&&(e.units=t.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.to_meter=t.conversion_factor),e}function cse(t){return typeof t=="object"?t.value*t.unit.conversion_factor:t}function use(t,e){t.ellipsoid.radius?(e.a=t.ellipsoid.radius,e.rf=0):(e.a=cse(t.ellipsoid.semi_major_axis),t.ellipsoid.inverse_flattening!==void 0?e.rf=t.ellipsoid.inverse_flattening:t.ellipsoid.semi_major_axis!==void 0&&t.ellipsoid.semi_minor_axis!==void 0&&(e.rf=e.a/(e.a-cse(t.ellipsoid.semi_minor_axis))))}function mN(t,e={}){return!t||typeof t!="object"?t:t.type==="BoundCRS"?(mN(t.source_crs,e),t.transformation&&(t.transformation.method&&t.transformation.method.name==="NTv2"?e.nadgrids=t.transformation.parameters[0].value:e.datum_params=t.transformation.parameters.map(n=>n.value)),e):(Object.keys(t).forEach(n=>{const r=t[n];if(r!==null)switch(n){case"name":if(e.srsCode)break;e.name=r,e.srsCode=r;break;case"type":r==="GeographicCRS"?e.projName="longlat":r==="ProjectedCRS"&&t.conversion&&t.conversion.method&&(e.projName=t.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(e.ellps=r.ellipsoid.name,use(r,e)),r.prime_meridian&&(e.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":e.ellps=r.name,use(r,e);break;case"prime_meridian":e.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis){if(e.axis=r.axis.map(i=>{const s=i.direction;if(s==="east")return"e";if(s==="north")return"n";if(s==="west")return"w";if(s==="south")return"s";throw new Error(`Unknown axis direction: ${s}`)}).join("")+"u",r.unit){const{units:i,to_meter:s}=lse(r.unit);e.units=i,e.to_meter=s}else if(r.axis[0]&&r.axis[0].unit){const{units:i,to_meter:s}=lse(r.axis[0].unit);e.units=i,e.to_meter=s}}break;case"id":r.authority&&r.code&&(e.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(e.projName=r.method.name),r.parameters&&r.parameters.forEach(i=>{const s=i.name.toLowerCase().replace(/\s+/g,"_"),o=i.value;i.unit&&i.unit.conversion_factor?e[s]=o*i.unit.conversion_factor:i.unit==="degree"?e[s]=o*Math.PI/180:e[s]=o});break;case"unit":r.name&&(e.units=r.name.toLowerCase(),e.units==="metre"&&(e.units="meter")),r.conversion_factor&&(e.to_meter=r.conversion_factor);break;case"base_crs":mN(r,e),e.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name;break}}),e.latitude_of_false_origin!==void 0&&(e.lat0=e.latitude_of_false_origin),e.longitude_of_false_origin!==void 0&&(e.long0=e.longitude_of_false_origin),e.latitude_of_standard_parallel!==void 0&&(e.lat0=e.latitude_of_standard_parallel,e.lat1=e.latitude_of_standard_parallel),e.latitude_of_1st_standard_parallel!==void 0&&(e.lat1=e.latitude_of_1st_standard_parallel),e.latitude_of_2nd_standard_parallel!==void 0&&(e.lat2=e.latitude_of_2nd_standard_parallel),e.latitude_of_projection_centre!==void 0&&(e.lat0=e.latitude_of_projection_centre),e.longitude_of_projection_centre!==void 0&&(e.longc=e.longitude_of_projection_centre),e.easting_at_false_origin!==void 0&&(e.x0=e.easting_at_false_origin),e.northing_at_false_origin!==void 0&&(e.y0=e.northing_at_false_origin),e.latitude_of_natural_origin!==void 0&&(e.lat0=e.latitude_of_natural_origin),e.longitude_of_natural_origin!==void 0&&(e.long0=e.longitude_of_natural_origin),e.longitude_of_origin!==void 0&&(e.long0=e.longitude_of_origin),e.false_easting!==void 0&&(e.x0=e.false_easting),e.easting_at_projection_centre&&(e.x0=e.easting_at_projection_centre),e.false_northing!==void 0&&(e.y0=e.false_northing),e.northing_at_projection_centre&&(e.y0=e.northing_at_projection_centre),e.standard_parallel_1!==void 0&&(e.lat1=e.standard_parallel_1),e.standard_parallel_2!==void 0&&(e.lat2=e.standard_parallel_2),e.scale_factor_at_natural_origin!==void 0&&(e.k0=e.scale_factor_at_natural_origin),e.scale_factor_at_projection_centre!==void 0&&(e.k0=e.scale_factor_at_projection_centre),e.scale_factor_on_pseudo_standard_parallel!==void 0&&(e.k0=e.scale_factor_on_pseudo_standard_parallel),e.azimuth!==void 0&&(e.alpha=e.azimuth),e.azimuth_at_projection_centre!==void 0&&(e.alpha=e.azimuth_at_projection_centre),e.angle_from_rectified_to_skew_grid&&(e.rectified_grid_angle=e.angle_from_rectified_to_skew_grid),bwe(e),e)}var qut=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Kut(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function Ewe(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var i=e[n];qut.indexOf(i)!==-1&&Yut(t[i]),typeof t[i]=="object"&&Ewe(t[i])}}function Yut(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,i=t.AXIS.length;r<i;++r){var s=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];s[0].indexOf("north")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="north"?n+="n":s[0].indexOf("south")!==-1||(s[0]==="y"||s[0]==="lat")&&s[1]==="south"?n+="s":s[0].indexOf("east")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="east"?n+="e":(s[0].indexOf("west")!==-1||(s[0]==="x"||s[0]==="lon")&&s[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var o=t.GEOGCS;t.type==="GEOGCS"&&(o=t),o&&(o.DATUM?t.datumCode=o.DATUM.name.toLowerCase():t.datumCode=o.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),o.DATUM&&o.DATUM.SPHEROID&&(t.ellps=o.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=o.DATUM.SPHEROID.a,t.rf=parseFloat(o.DATUM.SPHEROID.rf,10)),o.DATUM&&o.DATUM.TOWGS84&&(t.datum_params=o.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),t.rectified_grid_angle&&(t.rectified_grid_angle=Vu(t.rectified_grid_angle));function a(u){var h=t.to_meter||1;return u*h}var l=function(u){return Kut(t,u)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Vu],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Vu],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Vu],["lat0","latitude_of_origin",Vu],["lat0","standard_parallel_1",Vu],["lat1","standard_parallel_1",Vu],["lat2","standard_parallel_2",Vu],["azimuth","Azimuth"],["alpha","azimuth",Vu],["srsCode","name"]];c.forEach(l),bwe(t)}function gN(t){if(typeof t=="object")return mN(t);const e=zut(t);var n=Wut(t);if(e==="WKT2"){const s=Vut(n);return mN(s)}var r=n[0],i={};return Rx(n,i),Ewe(i),i[r]}function bo(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?bo[t]=jV(arguments[1]):bo[t]=gN(arguments[1]):n&&typeof n=="object"&&!("projName"in n)?bo[t]=gN(arguments[1]):(bo[t]=n,n||delete bo[t])}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){return Array.isArray(r)?bo.apply(e,r):bo(r)});if(typeof t=="string"){if(t in bo)return bo[t]}else"EPSG"in t?bo["EPSG:"+t.EPSG]=t:"ESRI"in t?bo["ESRI:"+t.ESRI]=t:"IAU2000"in t?bo["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Put(bo);function Xut(t){return typeof t=="string"}function Zut(t){return t in bo}function Jut(t){return t.indexOf("+")!==0&&t.indexOf("[")!==-1||typeof t=="object"&&!("srsCode"in t)}var Qut=["3857","900913","3785","102113"];function eht(t){var e=zg(t,"authority");if(e){var n=zg(e,"epsg");return n&&Qut.indexOf(n)>-1}}function tht(t){var e=zg(t,"extension");if(e)return zg(e,"proj4")}function nht(t){return t[0]==="+"}function rht(t){if(Xut(t)){if(Zut(t))return bo[t];if(Jut(t)){var e=gN(t);if(eht(e))return bo["EPSG:3857"];var n=tht(e);return n?jV(n):e}if(nht(t))return jV(t)}else return"projName"in t?t:gN(t)}function hse(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Rd(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function II(t){return t<0?-1:1}function At(t,e){return e||Math.abs(t)<=ls?t:t-II(t)*eA}function ih(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(st-e))/r}function nA(t,e){for(var n=.5*t,r,i,s=st-2*Math.atan(e),o=0;o<=15;o++)if(r=t*Math.sin(s),i=st-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-s,s+=i,Math.abs(i)<=1e-10)return s;return-9999}function iht(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Rd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function sht(t){var e=t.x,n=t.y;if(n*gl>90&&n*gl<-90&&e*gl>180&&e*gl<-180)return null;var r,i;if(Math.abs(Math.abs(n)-st)<=wt)return null;if(this.sphere)r=this.x0+this.a*this.k0*At(e-this.long0,this.over),i=this.y0+this.a*this.k0*Math.log(Math.tan(Pr+.5*n));else{var s=Math.sin(n),o=ih(this.e,n,s);r=this.x0+this.a*this.k0*At(e-this.long0,this.over),i=this.y0-this.a*this.k0*Math.log(o)}return t.x=r,t.y=i,t}function oht(t){var e=t.x-this.x0,n=t.y-this.y0,r,i;if(this.sphere)i=st-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var s=Math.exp(-n/(this.a*this.k0));if(i=nA(this.e,s),i===-9999)return null}return r=At(this.long0+e/(this.a*this.k0),this.over),t.x=r,t.y=i,t}var aht=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const lht={init:iht,forward:sht,inverse:oht,names:aht};function cht(){}function dse(t){return t}var Swe=["longlat","identity"];const uht={init:cht,forward:dse,inverse:dse,names:Swe};var hht=[lht,uht],cy={},Px=[];function Twe(t,e){var n=Px.length;return t.names?(Px[n]=t,t.names.forEach(function(r){cy[r.toLowerCase()]=n}),this):(console.log(e),!0)}function kwe(t){return t.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function dht(t){if(!t)return!1;var e=t.toLowerCase();if(typeof cy[e]<"u"&&Px[cy[e]]||(e=kwe(e),e in cy&&Px[cy[e]]))return Px[cy[e]]}function fht(){hht.forEach(Twe)}const pht={start:fht,add:Twe,get:dht};var Awe={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const mht=Awe.WGS84;function ght(t,e,n,r){var i=t*t,s=e*e,o=(i-s)/i,a=0;r?(t*=1-o*(Nut+o*(Out+o*Lut)),i=t*t,o=0):a=Math.sqrt(o);var l=(i-s)/s;return{es:o,e:a,ep2:l}}function yht(t,e,n,r,i){if(!t){var s=zg(Awe,r);s||(s=mht),t=s.a,e=s.b,n=s.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<wt)&&(i=!0,e=t),{a:t,b:e,rf:n,sphere:i}}var HC={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var vht in HC){var _8=HC[vht];_8.datumName&&(HC[_8.datumName]=_8)}function _ht(t,e,n,r,i,s,o){var a={};return t===void 0||t==="none"?a.datum_type=$V:a.datum_type=Mut,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=z1),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=U1,a.datum_params[3]*=kT,a.datum_params[4]*=kT,a.datum_params[5]*=kT,a.datum_params[6]=a.datum_params[6]/1e6+1)),o&&(a.datum_type=ow,a.grids=o),a.a=n,a.b=r,a.es=i,a.ep2=s,a}var oH={};function xht(t,e,n){return e instanceof ArrayBuffer?wht(t,e,n):{ready:bht(t,e)}}function wht(t,e,n){var r=!0;n!==void 0&&n.includeErrorFields===!1&&(r=!1);var i=new DataView(e),s=Tht(i),o=kht(i,s),a=Aht(i,o,s,r),l={header:o,subgrids:a};return oH[t]=l,l}async function bht(t,e){for(var n=[],r=await e.getImageCount(),i=r-1;i>=0;i--){var s=await e.getImage(i),o=await s.readRasters(),a=o,l=[s.getWidth(),s.getHeight()],c=s.getBoundingBox().map(fse),u=[s.fileDirectory.ModelPixelScale[0],s.fileDirectory.ModelPixelScale[1]].map(fse),h=c[0]+(l[0]-1)*u[0],f=c[3]-(l[1]-1)*u[1],g=a[0],v=a[1],x=[];for(let A=l[1]-1;A>=0;A--)for(let I=l[0]-1;I>=0;I--){var b=A*l[0]+I;x.push([-ng(v[b]),ng(g[b])])}n.push({del:u,lim:l,ll:[-h,f],cvs:x})}var T={header:{nSubgrids:r},subgrids:n};return oH[t]=T,T}function Eht(t){if(t===void 0)return null;var e=t.split(",");return e.map(Sht)}function Sht(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:oH[t]||null,isNull:!1}}function fse(t){return t*Math.PI/180}function ng(t){return t/3600*Math.PI/180}function Tht(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function kht(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:FV(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function FV(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Aht(t,e,n,r){for(var i=176,s=[],o=0;o<e.nSubgrids;o++){var a=Rht(t,i,n),l=Pht(t,i,a,n,r),c=Math.round(1+(a.upperLongitude-a.lowerLongitude)/a.longitudeInterval),u=Math.round(1+(a.upperLatitude-a.lowerLatitude)/a.latitudeInterval);s.push({ll:[ng(a.lowerLongitude),ng(a.lowerLatitude)],del:[ng(a.longitudeInterval),ng(a.latitudeInterval)],lim:[c,u],count:a.gridNodeCount,cvs:Iht(l)});var h=16;r===!1&&(h=8),i+=176+a.gridNodeCount*h}return s}function Iht(t){return t.map(function(e){return[ng(e.longitudeShift),ng(e.latitudeShift)]})}function Rht(t,e,n){return{name:FV(t,e+8,e+16).trim(),parent:FV(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Pht(t,e,n,r,i){var s=e+176,o=16;i===!1&&(o=8);for(var a=[],l=0;l<n.gridNodeCount;l++){var c={latitudeShift:t.getFloat32(s+l*o,r),longitudeShift:t.getFloat32(s+l*o+4,r)};i!==!1&&(c.latitudeAccuracy=t.getFloat32(s+l*o+8,r),c.longitudeAccuracy=t.getFloat32(s+l*o+12,r)),a.push(c)}return a}function ru(t,e){if(!(this instanceof ru))return new ru(t);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,e=e||function(c){if(c)throw c};var n=rht(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=ru.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var i=zg(HC,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var s=yht(n.a,n.b,n.rf,n.ellps,n.sphere),o=ght(s.a,s.b,s.rf,n.R_A),a=Eht(n.nadgrids),l=n.datum||_ht(n.datumCode,n.datum_params,s.a,s.b,o.es,o.ep2,a);hse(this,n),hse(this,r),this.a=s.a,this.b=s.b,this.rf=s.rf,this.sphere=s.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=l,"init"in this&&typeof this.init=="function"&&this.init(),e(null,this)}ru.projections=pht;ru.projections.start();function Mht(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===z1?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===U1?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function Iwe(t,e,n){var r=t.x,i=t.y,s=t.z?t.z:0,o,a,l,c;if(i<-st&&i>-1.001*st)i=-st;else if(i>st&&i<1.001*st)i=st;else{if(i<-st)return{x:-1/0,y:-1/0,z:t.z};if(i>st)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),a=Math.sin(i),c=Math.cos(i),l=a*a,o=n/Math.sqrt(1-e*l),{x:(o+s)*c*Math.cos(r),y:(o+s)*c*Math.sin(r),z:(o*(1-e)+s)*a}}function Rwe(t,e,n,r){var i=1e-12,s=i*i,o=30,a,l,c,u,h,f,g,v,x,b,T,A,I,R=t.x,C=t.y,V=t.z?t.z:0,M,N,O;if(a=Math.sqrt(R*R+C*C),l=Math.sqrt(R*R+C*C+V*V),a/n<i){if(M=0,l/n<i)return N=st,O=-r,{x:t.x,y:t.y,z:t.z}}else M=Math.atan2(C,R);c=V/l,u=a/l,h=1/Math.sqrt(1-e*(2-e)*u*u),v=u*(1-e)*h,x=c*h,I=0;do I++,g=n/Math.sqrt(1-e*x*x),O=a*v+V*x-g*(1-e*x*x),f=e*g/(g+O),h=1/Math.sqrt(1-f*(2-f)*u*u),b=u*(1-f)*h,T=c*h,A=T*v-b*x,v=b,x=T;while(A*A>s&&I<o);return N=Math.atan(T/Math.abs(b)),{x:M,y:N,z:O}}function Cht(t,e,n){if(e===z1)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===U1){var r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+a*t.z)+r,y:c*(l*t.x+t.y-o*t.z)+i,z:c*(-a*t.x+o*t.y+t.z)+s}}}function Nht(t,e,n){if(e===z1)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===U1){var r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=(t.x-r)/c,h=(t.y-i)/c,f=(t.z-s)/c;return{x:u+l*h-a*f,y:-l*u+h+o*f,z:a*u-o*h+f}}}function rM(t){return t===z1||t===U1}function Oht(t,e,n){if(Mht(t,e)||t.datum_type===$V||e.datum_type===$V)return n;var r=t.a,i=t.es;if(t.datum_type===ow){var s=pse(t,!1,n);if(s!==0)return;r=sse,i=ose}var o=e.a,a=e.b,l=e.es;if(e.datum_type===ow&&(o=sse,a=Cut,l=ose),i===l&&r===o&&!rM(t.datum_type)&&!rM(e.datum_type))return n;if(n=Iwe(n,i,r),rM(t.datum_type)&&(n=Cht(n,t.datum_type,t.datum_params)),rM(e.datum_type)&&(n=Nht(n,e.datum_type,e.datum_params)),n=Rwe(n,l,o,a),e.datum_type===ow){var c=pse(e,!0,n);if(c!==0)return}return n}function pse(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},s=[];e:for(var o=0;o<t.grids.length;o++){var a=t.grids[o];if(s.push(a.name),a.isNull){i=r;break}if(a.grid===null){if(a.mandatory)return console.log("Unable to find mandatory grid '"+a.name+"'"),-1;continue}for(var l=a.grid.subgrids,c=0,u=l.length;c<u;c++){var h=l[c],f=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,g=h.ll[0]-f,v=h.ll[1]-f,x=h.ll[0]+(h.lim[0]-1)*h.del[0]+f,b=h.ll[1]+(h.lim[1]-1)*h.del[1]+f;if(!(v>r.y||g>r.x||b<r.y||x<r.x)&&(i=Lht(r,e,h),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*gl+" "+r.y*gl+" tried: '"+s+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function Lht(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var i={x:t.x,y:t.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=At(i.x-Math.PI)+Math.PI;var s=mse(i,n);if(e){if(isNaN(s.x))return r;s.x=i.x-s.x,s.y=i.y-s.y;var o=9,a=1e-12,l,c;do{if(c=mse(s,n),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+s.x),y:i.y-(c.y+s.y)},s.x+=l.x,s.y+=l.y}while(o--&&Math.abs(l.x)>a&&Math.abs(l.y)>a);if(o<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=At(s.x+n.ll[0]),r.y=s.y+n.ll[1]}else isNaN(s.x)||(r.x=t.x+s.x,r.y=t.y+s.y);return r}function mse(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},s={x:Number.NaN,y:Number.NaN},o;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return s;o=r.y*e.lim[0]+r.x;var a={x:e.cvs[o][0],y:e.cvs[o][1]};o++;var l={x:e.cvs[o][0],y:e.cvs[o][1]};o+=e.lim[0];var c={x:e.cvs[o][0],y:e.cvs[o][1]};o--;var u={x:e.cvs[o][0],y:e.cvs[o][1]},h=i.x*i.y,f=i.x*(1-i.y),g=(1-i.x)*(1-i.y),v=(1-i.x)*i.y;return s.x=g*a.x+f*l.x+v*u.x+h*c.x,s.y=g*a.y+f*l.y+v*u.y+h*c.y,s}function gse(t,e,n){var r=n.x,i=n.y,s=n.z||0,o,a,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&n.z===void 0))switch(l===0?(o=r,"ew".indexOf(t.axis[l])!==-1?a="x":a="y"):l===1?(o=i,"ns".indexOf(t.axis[l])!==-1?a="y":a="x"):(o=s,a="z"),t.axis[l]){case"e":c[a]=o;break;case"w":c[a]=-o;break;case"n":c[a]=o;break;case"s":c[a]=-o;break;case"u":n[a]!==void 0&&(c.z=o);break;case"d":n[a]!==void 0&&(c.z=-o);break;default:return null}return c}function Pwe(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Dht(t){yse(t.x),yse(t.y)}function yse(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function $ht(t,e){return(t.datum.datum_type===z1||t.datum.datum_type===U1||t.datum.datum_type===ow)&&e.datumCode!=="WGS84"||(e.datum.datum_type===z1||e.datum.datum_type===U1||e.datum.datum_type===ow)&&t.datumCode!=="WGS84"}function yN(t,e,n,r){var i;Array.isArray(n)?n=Pwe(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var s=n.z!==void 0;if(Dht(n),t.datum&&e.datum&&$ht(t,e)&&(i=new ru("WGS84"),n=yN(t,i,n,r),t=i),r&&t.axis!=="enu"&&(n=gse(t,!1,n)),t.projName==="longlat")n={x:n.x*Wi,y:n.y*Wi,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=Oht(t.datum,e.datum,n),!!n)return n=n,e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*gl,y:n.y*gl,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?gse(e,!0,n):(n&&!s&&delete n.z,n)}var vse=ru("WGS84");function x8(t,e,n,r){var i,s,o;return Array.isArray(n)?(i=yN(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(s=yN(t,e,n,r),o=Object.keys(n),o.length===2||o.forEach(function(a){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;s[a]=n[a]}),s)}function iM(t){return t instanceof ru?t:typeof t=="object"&&"oProj"in t?t.oProj:ru(t)}function jht(t,e,n){var r,i,s=!1,o;return typeof e>"u"?(i=iM(t),r=vse,s=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,i=iM(t),r=vse,s=!0),r||(r=iM(t)),i||(i=iM(e)),n?x8(r,i,n):(o={forward:function(a,l){return x8(r,i,a,l)},inverse:function(a,l){return x8(i,r,a,l)}},s&&(o.oProj=i),o)}var _se=6,Mwe="AJSAJS",Cwe="AFAFAF",Mx=65,Xa=73,Lc=79,MS=86,CS=90;const Fht={forward:Nwe,inverse:Vht,toPoint:Owe};function Nwe(t,e){return e=e||5,Ght(zht({lat:t[1],lon:t[0]}),e)}function Vht(t){var e=aH(Dwe(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function Owe(t){var e=aH(Dwe(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function w8(t){return t*(Math.PI/180)}function xse(t){return 180*(t/Math.PI)}function zht(t){var e=t.lat,n=t.lon,r=6378137,i=.00669438,s=.9996,o,a,l,c,u,h,f,g=w8(e),v=w8(n),x,b;b=Math.floor((n+180)/6)+1,n===180&&(b=60),e>=56&&e<64&&n>=3&&n<12&&(b=32),e>=72&&e<84&&(n>=0&&n<9?b=31:n>=9&&n<21?b=33:n>=21&&n<33?b=35:n>=33&&n<42&&(b=37)),o=(b-1)*6-180+3,x=w8(o),a=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(g)*Math.sin(g)),c=Math.tan(g)*Math.tan(g),u=a*Math.cos(g)*Math.cos(g),h=Math.cos(g)*(v-x),f=r*((1-i/4-3*i*i/64-5*i*i*i/256)*g-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*g)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*g)-35*i*i*i/3072*Math.sin(6*g));var T=s*l*(h+(1-c+u)*h*h*h/6+(5-18*c+c*c+72*u-58*a)*h*h*h*h*h/120)+5e5,A=s*(f+l*Math.tan(g)*(h*h/2+(5-c+9*u+4*u*u)*h*h*h*h/24+(61-58*c+c*c+600*u-330*a)*h*h*h*h*h*h/720));return e<0&&(A+=1e7),{northing:Math.round(A),easting:Math.round(T),zoneNumber:b,zoneLetter:Uht(e)}}function aH(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var s=.9996,o=6378137,a=.00669438,l,c=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),u,h,f,g,v,x,b,T,A,I=n-5e5,R=e;r<"N"&&(R-=1e7),b=(i-1)*6-180+3,l=a/(1-a),x=R/s,T=x/(o*(1-a/4-3*a*a/64-5*a*a*a/256)),A=T+(3*c/2-27*c*c*c/32)*Math.sin(2*T)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*T)+151*c*c*c/96*Math.sin(6*T),u=o/Math.sqrt(1-a*Math.sin(A)*Math.sin(A)),h=Math.tan(A)*Math.tan(A),f=l*Math.cos(A)*Math.cos(A),g=o*(1-a)/Math.pow(1-a*Math.sin(A)*Math.sin(A),1.5),v=I/(u*s);var C=A-u*Math.tan(A)/g*(v*v/2-(5+3*h+10*f-4*f*f-9*l)*v*v*v*v/24+(61+90*h+298*f+45*h*h-252*l-3*f*f)*v*v*v*v*v*v/720);C=xse(C);var V=(v-(1+2*h+f)*v*v*v/6+(5-2*f+28*h-3*f*f+8*l+24*h*h)*v*v*v*v*v/120)/Math.cos(A);V=b+xse(V);var M;if(t.accuracy){var N=aH({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});M={top:N.lat,right:N.lon,bottom:C,left:V}}else M={lat:C,lon:V};return M}function Uht(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Ght(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+Bht(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function Bht(t,e,n){var r=Lwe(n),i=Math.floor(t/1e5),s=Math.floor(e/1e5)%20;return Wht(i,s,r)}function Lwe(t){var e=t%_se;return e===0&&(e=_se),e}function Wht(t,e,n){var r=n-1,i=Mwe.charCodeAt(r),s=Cwe.charCodeAt(r),o=i+t-1,a=s+e,l=!1;o>CS&&(o=o-CS+Mx-1,l=!0),(o===Xa||i<Xa&&o>Xa||(o>Xa||i<Xa)&&l)&&o++,(o===Lc||i<Lc&&o>Lc||(o>Lc||i<Lc)&&l)&&(o++,o===Xa&&o++),o>CS&&(o=o-CS+Mx-1),a>MS?(a=a-MS+Mx-1,l=!0):l=!1,(a===Xa||s<Xa&&a>Xa||(a>Xa||s<Xa)&&l)&&a++,(a===Lc||s<Lc&&a>Lc||(a>Lc||s<Lc)&&l)&&(a++,a===Xa&&a++),a>MS&&(a=a-MS+Mx-1);var c=String.fromCharCode(o)+String.fromCharCode(a);return c}function Dwe(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",i,s=0;!/[A-Z]/.test(i=t.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+t;r+=i,s++}var o=parseInt(r,10);if(s===0||s+3>e)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(s++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(s,s+=2);for(var l=Lwe(o),c=Hht(n.charAt(0),l),u=qht(n.charAt(1),l);u<Kht(a);)u+=2e6;var h=e-s;if(h%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var f=h/2,g=0,v=0,x,b,T,A,I;return f>0&&(x=1e5/Math.pow(10,f),b=t.substring(s,s+f),g=parseFloat(b)*x,T=t.substring(s+f),v=parseFloat(T)*x),A=g+c,I=v+u,{easting:A,northing:I,zoneLetter:a,zoneNumber:o,accuracy:x}}function Hht(t,e){for(var n=Mwe.charCodeAt(e-1),r=1e5,i=!1;n!==t.charCodeAt(0);){if(n++,n===Xa&&n++,n===Lc&&n++,n>CS){if(i)throw"Bad character: "+t;n=Mx,i=!0}r+=1e5}return r}function qht(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=Cwe.charCodeAt(e-1),r=0,i=!1;n!==t.charCodeAt(0);){if(n++,n===Xa&&n++,n===Lc&&n++,n>MS){if(i)throw"Bad character: "+t;n=Mx,i=!0}r+=1e5}return r}function Kht(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function A2(t,e,n){if(!(this instanceof A2))return new A2(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}A2.fromMGRS=function(t){return new A2(Owe(t))};A2.prototype.toMGRS=function(t){return Nwe([this.x,this.y],t)};var Yht=1,Xht=.25,wse=.046875,bse=.01953125,Ese=.01068115234375,Zht=.75,Jht=.46875,Qht=.013020833333333334,edt=.007120768229166667,tdt=.3645833333333333,ndt=.005696614583333333,rdt=.3076171875;function lH(t){var e=[];e[0]=Yht-t*(Xht+t*(wse+t*(bse+t*Ese))),e[1]=t*(Zht-t*(wse+t*(bse+t*Ese)));var n=t*t;return e[2]=n*(Jht-t*(Qht+t*edt)),n*=t,e[3]=n*(tdt-t*ndt),e[4]=n*t*rdt,e}function ub(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var idt=20;function cH(t,e,n){for(var r=1/(1-e),i=t,s=idt;s;--s){var o=Math.sin(i),a=1-e*o*o;if(a=(ub(i,o,Math.cos(i),n)-t)*(a*Math.sqrt(a))*r,i-=a,Math.abs(a)<wt)return i}return i}function sdt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=lH(this.es),this.ml0=ub(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function odt(t){var e=t.x,n=t.y,r=At(e-this.long0,this.over),i,s,o,a=Math.sin(n),l=Math.cos(n);if(this.es){var u=l*r,h=Math.pow(u,2),f=this.ep2*Math.pow(l,2),g=Math.pow(f,2),v=Math.abs(l)>wt?Math.tan(n):0,x=Math.pow(v,2),b=Math.pow(x,2);i=1-this.es*Math.pow(a,2),u=u/Math.sqrt(i);var T=ub(n,a,l,this.en);s=this.a*(this.k0*u*(1+h/6*(1-x+f+h/20*(5-18*x+b+14*f-58*x*f+h/42*(61+179*b-b*x-479*x)))))+this.x0,o=this.a*(this.k0*(T-this.ml0+a*r*u/2*(1+h/12*(5-x+9*f+4*g+h/30*(61+b-58*x+270*f-330*x*f+h/56*(1385+543*b-b*x-3111*x))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<wt)return 93;if(s=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,o=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(o),c>=1){if(c-1>wt)return 93;o=0}else o=Math.acos(o);n<0&&(o=-o),o=this.a*this.k0*(o-this.lat0)+this.y0}return t.x=s,t.y=o,t}function adt(t){var e,n,r,i,s=(t.x-this.x0)*(1/this.a),o=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+o/this.k0,n=cH(e,this.es,this.en),Math.abs(n)<st){var h=Math.sin(n),f=Math.cos(n),g=Math.abs(f)>wt?Math.tan(n):0,v=this.ep2*Math.pow(f,2),x=Math.pow(v,2),b=Math.pow(g,2),T=Math.pow(b,2);e=1-this.es*Math.pow(h,2);var A=s*Math.sqrt(e)/this.k0,I=Math.pow(A,2);e=e*g,r=n-e*I/(1-this.es)*.5*(1-I/12*(5+3*b-9*v*b+v-4*x-I/30*(61+90*b-252*v*b+45*T+46*v-I/56*(1385+3633*b+4095*T+1574*T*b)))),i=At(this.long0+A*(1-I/6*(1+2*b+v-I/20*(5+28*b+24*T+8*v*b+6*v-I/42*(61+662*b+1320*T+720*T*b))))/f,this.over)}else r=st*II(o),i=0;else{var a=Math.exp(s/this.k0),l=.5*(a-1/a),c=this.lat0+o/this.k0,u=Math.cos(c);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(l,2))),r=Math.asin(e),o<0&&(r=-r),l===0&&u===0?i=0:i=At(Math.atan2(l,u)+this.long0,this.over)}return t.x=i,t.y=r,t}var ldt=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const qC={init:sdt,forward:odt,inverse:adt,names:ldt};function $we(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function dl(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function cdt(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function udt(t){var e=Math.abs(t);return e=cdt(e*(1+e/(dl(1,e)+1))),t<0?-e:e}function uH(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,i=t[r],s=0,o;--r>=0;)o=-s+n*i+t[r],s=i,i=o;return e+o*Math.sin(2*e)}function hdt(t,e){for(var n=2*Math.cos(e),r=t.length-1,i=t[r],s=0,o;--r>=0;)o=-s+n*i+t[r],s=i,i=o;return Math.sin(e)*o}function ddt(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function jwe(t,e,n){for(var r=Math.sin(e),i=Math.cos(e),s=$we(n),o=ddt(n),a=2*i*o,l=-2*r*s,c=t.length-1,u=t[c],h=0,f=0,g=0,v,x;--c>=0;)v=f,x=h,f=u,h=g,u=-v+a*f-l*h+t[c],g=-x+l*f+a*h;return a=r*o,l=i*s,[a*u-l*g,a*g+l*u]}function fdt(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(qC.init.apply(this),this.forward=qC.forward,this.inverse=qC.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=uH(this.cbg,this.lat0);this.Zb=-this.Qn*(r+hdt(this.gtu,2*r))}function pdt(t){var e=At(t.x-this.long0,this.over),n=t.y;n=uH(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),s=Math.sin(e),o=Math.cos(e);n=Math.atan2(r,o*i),e=Math.atan2(s*i,dl(r,i*o)),e=udt(Math.tan(e));var a=jwe(this.gtu,2*n,2*e);n=n+a[0],e=e+a[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*n+this.Zb)+this.y0):(l=1/0,c=1/0),t.x=l,t.y=c,t}function mdt(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var s=jwe(this.utg,2*n,2*e);n=n+s[0],e=e+s[1],e=Math.atan($we(e));var o=Math.sin(n),a=Math.cos(n),l=Math.sin(e),c=Math.cos(e);n=Math.atan2(o*c,dl(l,c*a)),e=Math.atan2(l,c*a),r=At(e+this.long0,this.over),i=uH(this.cgb,n)}else r=1/0,i=1/0;return t.x=r,t.y=i,t}var gdt=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const KC={init:fdt,forward:pdt,inverse:mdt,names:gdt};function ydt(t,e){if(t===void 0){if(t=Math.floor((At(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var vdt="etmerc";function _dt(){var t=ydt(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*Wi,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,KC.init.apply(this),this.forward=KC.forward,this.inverse=KC.inverse}var xdt=["Universal Transverse Mercator System","utm"];const wdt={init:_dt,names:xdt,dependsOn:vdt};function hH(t,e){return Math.pow((1-t)/(1+t),e)}var bdt=20;function Edt(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Pr)/(Math.pow(Math.tan(.5*this.lat0+Pr),this.C)*hH(this.e*t,this.ratexp))}function Sdt(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Pr),this.C)*hH(this.e*Math.sin(n),this.ratexp))-st,t.x=this.C*e,t}function Tdt(t){for(var e=1e-14,n=t.x/this.C,r=t.y,i=Math.pow(Math.tan(.5*r+Pr)/this.K,1/this.C),s=bdt;s>0&&(r=2*Math.atan(i*hH(this.e*Math.sin(t.y),-.5*this.e))-st,!(Math.abs(r-t.y)<e));--s)t.y=r;return s?(t.x=n,t.y=r,t):null}const dH={init:Edt,forward:Sdt,inverse:Tdt};function kdt(){dH.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Adt(t){var e,n,r,i;return t.x=At(t.x-this.long0,this.over),dH.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Idt(t){var e,n,r,i,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=dl(t.x,t.y)){var o=2*Math.atan2(s,this.R2);e=Math.sin(o),n=Math.cos(o),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/s),r=Math.atan2(t.x*e,s*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,dH.inverse.apply(this,[t]),t.x=At(t.x+this.long0,this.over),t}var Rdt=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Pdt={init:kdt,forward:Adt,inverse:Idt,names:Rdt};function fH(t,e,n){return e*=n,Math.tan(.5*(st+t))*Math.pow((1-e)/(1+e),.5*n)}function Mdt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&(this.k0=.5*(1+II(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=wt&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&Math.abs(Math.cos(this.lat_ts))>wt&&(this.k0=.5*this.cons*Rd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ih(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Rd(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(fH(this.lat0,this.sinlat0,this.e))-st,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Cdt(t){var e=t.x,n=t.y,r=Math.sin(n),i=Math.cos(n),s,o,a,l,c,u,h=At(e-this.long0,this.over);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=wt&&Math.abs(n+this.lat0)<=wt?(t.x=NaN,t.y=NaN,t):this.sphere?(s=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(h)),t.x=this.a*s*i*Math.sin(h)+this.x0,t.y=this.a*s*(this.coslat0*r-this.sinlat0*i*Math.cos(h))+this.y0,t):(o=2*Math.atan(fH(n,r,this.e))-st,l=Math.cos(o),a=Math.sin(o),Math.abs(this.coslat0)<=wt?(c=ih(this.e,n*this.con,this.con*r),u=2*this.a*this.k0*c/this.cons,t.x=this.x0+u*Math.sin(e-this.long0),t.y=this.y0-this.con*u*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<wt?(s=2*this.a*this.k0/(1+l*Math.cos(h)),t.y=s*a):(s=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*l*Math.cos(h))),t.y=s*(this.cosX0*a-this.sinX0*l*Math.cos(h))+this.y0),t.x=s*l*Math.sin(h)+this.x0,t))}function Ndt(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,s,o=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(o/(2*this.a*this.k0));return e=this.long0,n=this.lat0,o<=wt?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/o),Math.abs(this.coslat0)<wt?this.lat0>0?e=At(this.long0+Math.atan2(t.x,-1*t.y),this.over):e=At(this.long0+Math.atan2(t.x,t.y),this.over):e=At(this.long0+Math.atan2(t.x*Math.sin(a),o*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a)),this.over),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=wt){if(o<=wt)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=o*this.cons/(2*this.a*this.k0),n=this.con*nA(this.e,r),e=this.con*At(this.con*this.long0+Math.atan2(t.x,-1*t.y),this.over)}else i=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,o<=wt?s=this.X0:(s=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/o),e=At(this.long0+Math.atan2(t.x*Math.sin(i),o*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)),this.over)),n=-1*nA(this.e,Math.tan(.5*(st+s)));return t.x=e,t.y=n,t}var Odt=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Ldt={init:Mdt,forward:Cdt,inverse:Ndt,names:Odt,ssfn_:fH};function Ddt(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),o=this.e=Math.sqrt(s);this.R=this.k0*n*Math.sqrt(1-s)/(1-s*Math.pow(e,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),c=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*l+this.alpha*o/2*c}function $dt(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t}function jdt(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+o/this.alpha,l=0,c=s,u=-1e3,h=0;Math.abs(c-u)>1e-7;){if(++h>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),u=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=c,t}var Fdt=["somerc"];const Vdt={init:Ddt,forward:$dt,inverse:jdt,names:Fdt};var lx=1e-7;function zdt(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.projName=="object"?Object.keys(t.projName)[0]:t.projName;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1||e.indexOf(kwe(n))!==-1}function Udt(){var t,e,n,r,i,s,o,a,l,c,u=0,h,f=0,g=0,v=0,x=0,b=0,T=0;this.no_off=zdt(this),this.no_rot="no_rot"in this;var A=!1;"alpha"in this&&(A=!0);var I=!1;if("rectified_grid_angle"in this&&(I=!0),A&&(T=this.alpha),I&&(u=this.rectified_grid_angle),A||I)f=this.longc;else if(g=this.long1,x=this.lat1,v=this.long2,b=this.lat2,Math.abs(x-b)<=lx||(t=Math.abs(x))<=lx||Math.abs(t-st)<=lx||Math.abs(Math.abs(this.lat0)-st)<=lx||Math.abs(Math.abs(b)-st)<=lx)throw new Error;var R=1-this.es;e=Math.sqrt(R),Math.abs(this.lat0)>wt?(a=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*a*a,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/R),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(ih(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),A||I?(A?(h=Math.asin(Math.sin(T)/r),I||(u=T)):(h=u,T=Math.asin(r*Math.sin(h))),this.lam0=f-Math.asin(.5*(i-1/i)*Math.tan(h))/this.B):(s=Math.pow(ih(this.e,x,Math.sin(x)),this.B),o=Math.pow(ih(this.e,b,Math.sin(b)),this.B),i=this.E/s,l=(o-s)/(o+s),c=this.E*this.E,c=(c-o*s)/(c+o*s),t=g-v,t<-Math.PI?v-=eA:t>Math.PI&&(v+=eA),this.lam0=At(.5*(g+v)-Math.atan(c*Math.tan(.5*this.B*(g-v))/l)/this.B,this.over),h=Math.atan(2*Math.sin(this.B*At(g-this.lam0,this.over))/(i-1/i)),u=T=Math.asin(r*Math.sin(h))),this.singam=Math.sin(h),this.cosgam=Math.cos(h),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*h,this.v_pole_n=this.ArB*Math.log(Math.tan(Pr-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Pr+i))}function Gdt(t){var e={},n,r,i,s,o,a,l,c;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-st)>wt){if(o=this.E/Math.pow(ih(this.e,t.y,Math.sin(t.y)),this.B),a=1/o,n=.5*(o-a),r=.5*(o+a),s=Math.sin(this.B*t.x),i=(n*this.singam-s*this.cosgam)/r,Math.abs(Math.abs(i)-1)<wt)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),a=Math.cos(this.B*t.x),Math.abs(a)<lx?l=this.A*t.x:l=this.ArB*Math.atan2(n*this.cosgam+s*this.singam,a)}else c=t.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*t.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Bdt(t){var e,n,r,i,s,o,a,l={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),s=.5*(r+1/r),o=Math.sin(this.BrA*e),a=(o*this.cosgam+i*this.singam)/s,Math.abs(Math.abs(a)-1)<wt)l.x=0,l.y=a<0?-st:st;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=nA(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-o*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Wdt=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Hdt={init:Udt,forward:Gdt,inverse:Bdt,names:Wdt};function qdt(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<wt)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Rd(this.e,e,n),i=ih(this.e,this.lat1,e),s=Math.sin(this.lat2),o=Math.cos(this.lat2),a=Rd(this.e,s,o),l=ih(this.e,this.lat2,s),c=Math.abs(Math.abs(this.lat0)-st)<wt?0:ih(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>wt?this.ns=Math.log(r/a)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Kdt(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=wt&&(n=II(n)*(st-2*wt));var r=Math.abs(Math.abs(n)-st),i,s;if(r>wt)i=ih(this.e,n,Math.sin(n)),s=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;s=0}var o=this.ns*At(e-this.long0,this.over);return t.x=this.k0*(s*Math.sin(o))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(o))+this.y0,t}function Ydt(t){var e,n,r,i,s,o=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(o*o+a*a),n=1):(e=-Math.sqrt(o*o+a*a),n=-1);var l=0;if(e!==0&&(l=Math.atan2(n*o,n*a)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),i=nA(this.e,r),i===-9999)return null}else i=-st;return s=At(l/this.ns+this.long0,this.over),t.x=s,t.y=i,t}var Xdt=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Zdt={init:qdt,forward:Kdt,inverse:Ydt,names:Xdt};function Jdt(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Qdt(t){var e,n,r,i,s,o,a,l=t.x,c=t.y,u=At(l-this.long0,this.over);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-u*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),s=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),o=this.n*s,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=a*Math.cos(o)/1,t.x=a*Math.sin(o)/1,this.czech||(t.y*=-1,t.x*=-1),t}function eft(t){var e,n,r,i,s,o,a,l,c=t.x;t.x=t.y,t.y=c,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e,l=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(l=1),a=t.y,u+=1;while(l===0&&u<15);return u>=15?null:t}var tft=["Krovak","krovak"];const nft={init:Jdt,forward:Qdt,inverse:eft,names:tft};function Na(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function RI(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function PI(t){return .375*t*(1+.25*t*(1+.46875*t))}function MI(t){return .05859375*t*t*(1+.75*t)}function CI(t){return t*t*t*(35/3072)}function pH(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function e0(t){return Math.abs(t)<st?t:t-II(t)*Math.PI}function vN(t,e,n,r,i){var s,o;s=t/e;for(var a=0;a<15;a++)if(o=(t-(e*s-n*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(e-2*n*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}function rft(){this.sphere||(this.e0=RI(this.es),this.e1=PI(this.es),this.e2=MI(this.es),this.e3=CI(this.es),this.ml0=this.a*Na(this.e0,this.e1,this.e2,this.e3,this.lat0))}function ift(t){var e,n,r=t.x,i=t.y;if(r=At(r-this.long0,this.over),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var s=Math.sin(i),o=Math.cos(i),a=pH(this.a,this.e,s),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),u=c*c,h=this.es*o*o/(1-this.es),f=this.a*Na(this.e0,this.e1,this.e2,this.e3,i);e=a*c*(1-u*l*(1/6-(8-l+8*h)*u/120)),n=f-this.ml0+a*s/o*u*(.5+(5-l+6*h)*u/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function sft(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i;if(this.sphere){var s=n+this.lat0;r=Math.asin(Math.sin(s)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(s))}else{var o=this.ml0/this.a+n,a=vN(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-st)<=wt)return t.x=this.long0,t.y=st,n<0&&(t.y*=-1),t;var l=pH(this.a,this.e,Math.sin(a)),c=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),h=e*this.a/l,f=h*h;r=a-l*Math.tan(a)/c*h*h*(.5-(1+3*u)*h*h/24),i=h*(1-f*(u/3+(1+3*u)*u*f/15))/Math.cos(a)}return t.x=At(i+this.long0,this.over),t.y=e0(r),t}var oft=["Cassini","Cassini_Soldner","cass"];const aft={init:rft,forward:ift,inverse:sft,names:oft};function _g(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var VV=1,zV=2,UV=3,YC=4;function lft(){var t=Math.abs(this.lat0);if(Math.abs(t-st)<wt?this.mode=this.lat0<0?VV:zV:Math.abs(t)<wt?this.mode=UV:this.mode=YC,this.es>0){var e;switch(this.qp=_g(this.e,1),this.mmf=.5/(1-this.es),this.apa=yft(this.es),this.mode){case zV:this.dd=1;break;case VV:this.dd=1;break;case UV:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case YC:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=_g(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===YC&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function cft(t){var e,n,r,i,s,o,a,l,c,u,h=t.x,f=t.y;if(h=At(h-this.long0,this.over),this.sphere){if(s=Math.sin(f),u=Math.cos(f),r=Math.cos(h),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+u*r:1+this.sinph0*s+this.cosph0*u*r,n<=wt)return null;n=Math.sqrt(2/n),e=n*u*Math.sin(h),n*=this.mode===this.EQUIT?s:this.cosph0*s-this.sinph0*u*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(f+this.lat0)<wt)return null;n=Pr-f*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(h),n*=r}}else{switch(a=0,l=0,c=0,r=Math.cos(h),i=Math.sin(h),s=Math.sin(f),o=_g(this.e,s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=o/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=st+f,o=this.qp-o;break;case this.S_POLE:c=f-st,o=this.qp+o;break}if(Math.abs(c)<wt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?n=this.ymf*c*(this.cosb1*a-this.sinb1*l*r):n=(c=Math.sqrt(2/(1+l*r)))*a*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:o>=0?(e=(c=Math.sqrt(o))*i,n=r*(this.mode===this.S_POLE?c:-c)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function uft(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i,s,o,a,l,c;if(this.sphere){var u=0,h,f=0;if(h=Math.sqrt(e*e+n*n),i=h*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(i),u=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(h)<=wt?0:Math.asin(n*f/h),e*=f,n=u*h;break;case this.OBLIQ:i=Math.abs(h)<=wt?this.lat0:Math.asin(u*this.sinph0+n*f*this.cosph0/h),e*=f*this.cosph0,n=(u-Math.sin(i)*this.sinph0)*h;break;case this.N_POLE:n=-n,i=st-i;break;case this.S_POLE:i-=st;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,l=Math.sqrt(e*e+n*n),l<wt)return t.x=this.long0,t.y=this.lat0,t;o=2*Math.asin(.5*l/this.rq),s=Math.cos(o),e*=o=Math.sin(o),this.mode===this.OBLIQ?(c=s*this.sinb1+n*o*this.cosb1/l,a=this.qp*c,n=l*this.cosb1*s-n*this.sinb1*o):(c=n*o/l,a=this.qp*c,n=l*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),a=e*e+n*n,!a)return t.x=this.long0,t.y=this.lat0,t;c=1-a/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,n),i=vft(Math.asin(c),this.apa)}return t.x=At(this.long0+r,this.over),t.y=i,t}var hft=.3333333333333333,dft=.17222222222222222,fft=.10257936507936508,pft=.06388888888888888,mft=.0664021164021164,gft=.016415012942191543;function yft(t){var e,n=[];return n[0]=t*hft,e=t*t,n[0]+=e*dft,n[1]=e*pft,e*=t,n[0]+=e*fft,n[1]+=e*mft,n[2]=e*gft,n}function vft(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var _ft=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const xft={init:lft,forward:cft,inverse:uft,names:_ft,S_POLE:VV,N_POLE:zV,EQUIT:UV,OBLIQ:YC};function Ug(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function wft(){Math.abs(this.lat1+this.lat2)<wt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Rd(this.e3,this.sin_po,this.cos_po),this.qs1=_g(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Rd(this.e3,this.sin_po,this.cos_po),this.qs2=_g(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=_g(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>wt?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function bft(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=_g(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,s=this.ns0*At(e-this.long0,this.over),o=i*Math.sin(s)+this.x0,a=this.rh-i*Math.cos(s)+this.y0;return t.x=o,t.y=a,t}function Eft(t){var e,n,r,i,s,o;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?o=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,o=this.phi1z(this.e3,n)),s=At(i/this.ns0+this.long0,this.over),t.x=s,t.y=o,t}function Sft(t,e){var n,r,i,s,o,a=Ug(.5*e);if(t<wt)return a;for(var l=t*t,c=1;c<=25;c++)if(n=Math.sin(a),r=Math.cos(a),i=t*n,s=1-i*i,o=.5*s*s/r*(e/(1-l)-n/s+.5/t*Math.log((1-i)/(1+i))),a=a+o,Math.abs(o)<=1e-7)return a;return null}var Tft=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const kft={init:wft,forward:bft,inverse:Eft,names:Tft,phi1z:Sft};function Aft(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Ift(t){var e,n,r,i,s,o,a,l,c=t.x,u=t.y;return r=At(c-this.long0,this.over),e=Math.sin(u),n=Math.cos(u),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,s=1,o>0||Math.abs(o)<=wt?(a=this.x0+this.a*s*n*Math.sin(r)/o,l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*n*i)/o):(a=this.x0+this.infinity_dist*n*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=l,t}function Rft(t){var e,n,r,i,s,o;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),o=Ug(r*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),s=At(this.long0+s,this.over)):(o=this.phic0,s=0),t.x=s,t.y=o,t}var Pft=["gnom"];const Mft={init:Aft,forward:Ift,inverse:Rft,names:Pft};function Cft(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*st:st;for(var r=Math.asin(.5*e),i,s,o,a,l=0;l<30;l++)if(s=Math.sin(r),o=Math.cos(r),a=t*s,i=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-s/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function Nft(){this.sphere||(this.k0=Rd(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Oft(t){var e=t.x,n=t.y,r,i,s=At(e-this.long0,this.over);if(this.sphere)r=this.x0+this.a*s*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var o=_g(this.e,Math.sin(n));r=this.x0+this.a*this.k0*s,i=this.y0+this.a*o*.5/this.k0}return t.x=r,t.y=i,t}function Lft(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=At(this.long0+t.x/this.a/Math.cos(this.lat_ts),this.over),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=Cft(this.e,2*t.y*this.k0/this.a),e=At(this.long0+t.x/(this.a*this.k0),this.over)),t.x=e,t.y=n,t}var Dft=["cea"];const $ft={init:Nft,forward:Oft,inverse:Lft,names:Dft};function jft(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Fft(t){var e=t.x,n=t.y,r=At(e-this.long0,this.over),i=e0(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t}function Vft(t){var e=t.x,n=t.y;return t.x=At(this.long0+(e-this.x0)/(this.a*this.rc),this.over),t.y=e0(this.lat0+(n-this.y0)/this.a),t}var zft=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const Uft={init:jft,forward:Fft,inverse:Vft,names:zft};var Sse=20;function Gft(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=RI(this.es),this.e1=PI(this.es),this.e2=MI(this.es),this.e3=CI(this.es),this.ml0=this.a*Na(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Bft(t){var e=t.x,n=t.y,r,i,s,o=At(e-this.long0,this.over);if(s=o*Math.sin(n),this.sphere)Math.abs(n)<=wt?(r=this.a*o,i=-1*this.a*this.lat0):(r=this.a*Math.sin(s)/Math.tan(n),i=this.a*(e0(n-this.lat0)+(1-Math.cos(s))/Math.tan(n)));else if(Math.abs(n)<=wt)r=this.a*o,i=-1*this.ml0;else{var a=pH(this.a,this.e,Math.sin(n))/Math.tan(n);r=a*Math.sin(s),i=this.a*Na(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+a*(1-Math.cos(s))}return t.x=r+this.x0,t.y=i+this.y0,t}function Wft(t){var e,n,r,i,s,o,a,l,c;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=wt)e=At(r/this.a+this.long0,this.over),n=0;else{o=this.lat0+i/this.a,a=r*r/this.a/this.a+o*o,l=o;var u;for(s=Sse;s;--s)if(u=Math.tan(l),c=-1*(o*(l*u+1)-l-.5*(l*l+a)*u)/((l-o)/u-1),l+=c,Math.abs(c)<=wt){n=l;break}e=At(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(n),this.over)}else if(Math.abs(i+this.ml0)<=wt)n=0,e=At(this.long0+r/this.a,this.over);else{o=(this.ml0+i)/this.a,a=r*r/this.a/this.a+o*o,l=o;var h,f,g,v,x;for(s=Sse;s;--s)if(x=this.e*Math.sin(l),h=Math.sqrt(1-x*x)*Math.tan(l),f=this.a*Na(this.e0,this.e1,this.e2,this.e3,l),g=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),v=f/this.a,c=(o*(h*v+1)-v-.5*h*(v*v+a))/(this.es*Math.sin(2*l)*(v*v+a-2*o*v)/(4*h)+(o-v)*(h*g-2/Math.sin(2*l))-g),l-=c,Math.abs(c)<=wt){n=l;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=At(this.long0+Math.asin(r*h/this.a)/Math.sin(n),this.over)}return t.x=e,t.y=n,t}var Hft=["Polyconic","American_Polyconic","poly"];const qft={init:Gft,forward:Bft,inverse:Wft,names:Hft};function Kft(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Yft(t){var e,n=t.x,r=t.y,i=r-this.lat0,s=n-this.long0,o=i/kT*1e-5,a=s,l=1,c=0;for(e=1;e<=10;e++)l=l*o,c=c+this.A[e]*l;var u=c,h=a,f=1,g=0,v,x,b=0,T=0;for(e=1;e<=6;e++)v=f*u-g*h,x=g*u+f*h,f=v,g=x,b=b+this.B_re[e]*f-this.B_im[e]*g,T=T+this.B_im[e]*f+this.B_re[e]*g;return t.x=T*this.a+this.x0,t.y=b*this.a+this.y0,t}function Xft(t){var e,n=t.x,r=t.y,i=n-this.x0,s=r-this.y0,o=s/this.a,a=i/this.a,l=1,c=0,u,h,f=0,g=0;for(e=1;e<=6;e++)u=l*o-c*a,h=c*o+l*a,l=u,c=h,f=f+this.C_re[e]*l-this.C_im[e]*c,g=g+this.C_im[e]*l+this.C_re[e]*c;for(var v=0;v<this.iterations;v++){var x=f,b=g,T,A,I=o,R=a;for(e=2;e<=6;e++)T=x*f-b*g,A=b*f+x*g,x=T,b=A,I=I+(e-1)*(this.B_re[e]*x-this.B_im[e]*b),R=R+(e-1)*(this.B_im[e]*x+this.B_re[e]*b);x=1,b=0;var C=this.B_re[1],V=this.B_im[1];for(e=2;e<=6;e++)T=x*f-b*g,A=b*f+x*g,x=T,b=A,C=C+e*(this.B_re[e]*x-this.B_im[e]*b),V=V+e*(this.B_im[e]*x+this.B_re[e]*b);var M=C*C+V*V;f=(I*C+R*V)/M,g=(R*C-I*V)/M}var N=f,O=g,F=1,L=0;for(e=1;e<=9;e++)F=F*N,L=L+this.D[e]*F;var B=this.lat0+L*kT*1e5,U=this.long0+O;return t.x=U,t.y=B,t}var Zft=["New_Zealand_Map_Grid","nzmg"];const Jft={init:Kft,forward:Yft,inverse:Xft,names:Zft};function Qft(){}function ept(t){var e=t.x,n=t.y,r=At(e-this.long0,this.over),i=this.x0+this.a*r,s=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=s,t}function tpt(t){t.x-=this.x0,t.y-=this.y0;var e=At(this.long0+t.x/this.a,this.over),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var npt=["Miller_Cylindrical","mill"];const rpt={init:Qft,forward:ept,inverse:tpt,names:npt};var ipt=20;function spt(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=lH(this.es)}function opt(t){var e,n,r=t.x,i=t.y;if(r=At(r-this.long0,this.over),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var s=this.n*Math.sin(i),o=ipt;o;--o){var a=(this.m*i+Math.sin(i)-s)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<wt)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);n=this.a*ub(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return t.x=e,t.y=n,t}function apt(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=Ug((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Ug(Math.sin(e)/this.n)),r=At(r+this.long0,this.over),e=e0(e)):(e=cH(t.y/this.a,this.es,this.en),i=Math.abs(e),i<st?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=At(n,this.over)):i-wt<st&&(r=this.long0)),t.x=r,t.y=e,t}var lpt=["Sinusoidal","sinu"];const cpt={init:spt,forward:opt,inverse:apt,names:lpt};function upt(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function hpt(t){for(var e=t.x,n=t.y,r=At(e-this.long0,this.over),i=n,s=Math.PI*Math.sin(n);;){var o=-(i+Math.sin(i)-s)/(1+Math.cos(i));if(i+=o,Math.abs(o)<wt)break}i/=2,Math.PI/2-Math.abs(n)<wt&&(r=0);var a=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=a,t.y=l,t}function dpt(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=At(this.long0+t.x/(.900316316158*this.a*Math.cos(e)),this.over);r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t}var fpt=["Mollweide","moll"];const ppt={init:upt,forward:hpt,inverse:dpt,names:fpt};function mpt(){Math.abs(this.lat1+this.lat2)<wt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=RI(this.es),this.e1=PI(this.es),this.e2=MI(this.es),this.e3=CI(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=Rd(this.e,this.sin_phi,this.cos_phi),this.ml1=Na(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<wt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=Rd(this.e,this.sin_phi,this.cos_phi),this.ml2=Na(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Na(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function gpt(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=Na(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var s=this.ns*At(e-this.long0,this.over),o=this.x0+r*Math.sin(s),a=this.y0+this.rh-r*Math.cos(s);return t.x=o,t.y=a,t}function ypt(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,i;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var s=0;if(n!==0&&(s=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=At(this.long0+s/this.ns,this.over),r=e0(this.g-n/this.a),t.x=i,t.y=r,t;var o=this.g-n/this.a;return r=vN(o,this.e0,this.e1,this.e2,this.e3),i=At(this.long0+s/this.ns,this.over),t.x=i,t.y=r,t}var vpt=["Equidistant_Conic","eqdc"];const _pt={init:mpt,forward:gpt,inverse:ypt,names:vpt};function xpt(){this.R=this.a}function wpt(t){var e=t.x,n=t.y,r=At(e-this.long0,this.over),i,s;Math.abs(n)<=wt&&(i=this.x0+this.R*r,s=this.y0);var o=Ug(2*Math.abs(n/Math.PI));(Math.abs(r)<=wt||Math.abs(Math.abs(n)-st)<=wt)&&(i=this.x0,n>=0?s=this.y0+Math.PI*this.R*Math.tan(.5*o):s=this.y0+Math.PI*this.R*-Math.tan(.5*o));var a=.5*Math.abs(Math.PI/r-r/Math.PI),l=a*a,c=Math.sin(o),u=Math.cos(o),h=u/(c+u-1),f=h*h,g=h*(2/c-1),v=g*g,x=Math.PI*this.R*(a*(h-v)+Math.sqrt(l*(h-v)*(h-v)-(v+l)*(f-v)))/(v+l);r<0&&(x=-x),i=this.x0+x;var b=l+h;return x=Math.PI*this.R*(g*b-a*Math.sqrt((v+l)*(l+1)-b*b))/(v+l),n>=0?s=this.y0+x:s=this.y0-x,t.x=i,t.y=s,t}function bpt(t){var e,n,r,i,s,o,a,l,c,u,h,f,g;return t.x-=this.x0,t.y-=this.y0,h=Math.PI*this.R,r=t.x/h,i=t.y/h,s=r*r+i*i,o=-Math.abs(i)*(1+s),a=o-2*i*i+r*r,l=-2*o+1+2*i*i+s*s,g=i*i/l+(2*a*a*a/l/l/l-9*o*a/l/l)/27,c=(o-a*a/3/l)/l,u=2*Math.sqrt(-c/3),h=3*g/c/u,Math.abs(h)>1&&(h>=0?h=1:h=-1),f=Math.acos(h)/3,t.y>=0?n=(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:n=-(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,Math.abs(r)<wt?e=this.long0:e=At(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(r*r-i*i)+s*s))/2/r,this.over),t.x=e,t.y=n,t}var Ept=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const Spt={init:xpt,forward:wpt,inverse:bpt,names:Ept};function Tpt(t,e,n,r,i,s){const o=r-e,a=Math.atan((1-s)*Math.tan(t)),l=Math.atan((1-s)*Math.tan(n)),c=Math.sin(a),u=Math.cos(a),h=Math.sin(l),f=Math.cos(l);let g=o,v,x=100,b,T,A,I,R,C,V,M,N,O,F,L,B,U;do{if(b=Math.sin(g),T=Math.cos(g),A=Math.sqrt(f*b*(f*b)+(u*h-c*f*T)*(u*h-c*f*T)),A===0)return{azi1:0,s12:0};I=c*h+u*f*T,R=Math.atan2(A,I),C=u*f*b/A,V=1-C*C,M=V!==0?I-2*c*h/V:0,N=s/16*V*(4+s*(4-3*V)),v=g,g=o+(1-N)*s*C*(R+N*A*(M+N*I*(-1+2*M*M)))}while(Math.abs(g-v)>1e-12&&--x>0);return x===0?{azi1:NaN,s12:NaN}:(O=V*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),F=1+O/16384*(4096+O*(-768+O*(320-175*O))),L=O/1024*(256+O*(-128+O*(74-47*O))),B=L*A*(M+L/4*(I*(-1+2*M*M)-L/6*M*(-3+4*A*A)*(-3+4*M*M))),U=i*(1-s)*F*(R-B),{azi1:Math.atan2(f*b,u*h-c*f*T),s12:U})}function kpt(t,e,n,r,i,s){const o=Math.atan((1-s)*Math.tan(t)),a=Math.sin(o),l=Math.cos(o),c=Math.sin(n),u=Math.cos(n),h=Math.atan2(a,l*u),f=l*c,g=1-f*f,v=g*(i*i-i*(1-s)*(i*(1-s)))/(i*(1-s)*(i*(1-s))),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),b=v/1024*(256+v*(-128+v*(74-47*v)));let T=r/(i*(1-s)*x),A,I=100,R,C,V,M;do R=Math.cos(2*h+T),C=Math.sin(T),V=Math.cos(T),M=b*C*(R+b/4*(V*(-1+2*R*R)-b/6*R*(-3+4*C*C)*(-3+4*R*R))),A=T,T=r/(i*(1-s)*x)+M;while(Math.abs(T-A)>1e-12&&--I>0);if(I===0)return{lat2:NaN,lon2:NaN};const N=a*C-l*V*u,O=Math.atan2(a*V+l*C*u,(1-s)*Math.sqrt(f*f+N*N)),F=Math.atan2(C*c,l*V-a*C*u),L=s/16*g*(4+s*(4-3*g)),B=F-(1-L)*s*f*(T+L*C*(R+L*V*(-1+2*R*R))),U=e+B;return{lat2:O,lon2:U}}function Apt(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function Ipt(t){var e=t.x,n=t.y,r=Math.sin(t.y),i=Math.cos(t.y),s=At(e-this.long0,this.over),o,a,l,c,u,h,f,g,v,x,b;return this.sphere?Math.abs(this.sin_p12-1)<=wt?(t.x=this.x0+this.a*(st-n)*Math.sin(s),t.y=this.y0-this.a*(st-n)*Math.cos(s),t):Math.abs(this.sin_p12+1)<=wt?(t.x=this.x0+this.a*(st+n)*Math.sin(s),t.y=this.y0+this.a*(st+n)*Math.cos(s),t):(v=this.sin_p12*r+this.cos_p12*i*Math.cos(s),f=Math.acos(v),g=f?f/Math.sin(f):1,t.x=this.x0+this.a*g*i*Math.sin(s),t.y=this.y0+this.a*g*(this.cos_p12*r-this.sin_p12*i*Math.cos(s)),t):(o=RI(this.es),a=PI(this.es),l=MI(this.es),c=CI(this.es),Math.abs(this.sin_p12-1)<=wt?(u=this.a*Na(o,a,l,c,st),h=this.a*Na(o,a,l,c,n),t.x=this.x0+(u-h)*Math.sin(s),t.y=this.y0-(u-h)*Math.cos(s),t):Math.abs(this.sin_p12+1)<=wt?(u=this.a*Na(o,a,l,c,st),h=this.a*Na(o,a,l,c,n),t.x=this.x0+(u+h)*Math.sin(s),t.y=this.y0+(u+h)*Math.cos(s),t):Math.abs(e)<wt&&Math.abs(n-this.lat0)<wt?(t.x=t.y=0,t):(x=Tpt(this.lat0,this.long0,n,e,this.a,this.f),b=x.azi1,t.x=x.s12*Math.sin(b),t.y=x.s12*Math.cos(b),t))}function Rpt(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,s,o,a,l,c,u,h,f,g,v,x,b;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*st*this.a?void 0:(n=e/this.a,r=Math.sin(n),i=Math.cos(n),s=this.long0,Math.abs(e)<=wt?o=this.lat0:(o=Ug(i*this.sin_p12+t.y*r*this.cos_p12/e),a=Math.abs(this.lat0)-st,Math.abs(a)<=wt?this.lat0>=0?s=At(this.long0+Math.atan2(t.x,-t.y),this.over):s=At(this.long0-Math.atan2(-t.x,t.y),this.over):s=At(this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r),this.over)),t.x=s,t.y=o,t)):(l=RI(this.es),c=PI(this.es),u=MI(this.es),h=CI(this.es),Math.abs(this.sin_p12-1)<=wt?(f=this.a*Na(l,c,u,h,st),e=Math.sqrt(t.x*t.x+t.y*t.y),g=f-e,o=vN(g/this.a,l,c,u,h),s=At(this.long0+Math.atan2(t.x,-1*t.y),this.over),t.x=s,t.y=o,t):Math.abs(this.sin_p12+1)<=wt?(f=this.a*Na(l,c,u,h,st),e=Math.sqrt(t.x*t.x+t.y*t.y),g=e-f,o=vN(g/this.a,l,c,u,h),s=At(this.long0+Math.atan2(t.x,t.y),this.over),t.x=s,t.y=o,t):(v=Math.atan2(t.x,t.y),x=Math.sqrt(t.x*t.x+t.y*t.y),b=kpt(this.lat0,this.long0,v,x,this.a,this.f),t.x=b.lon2,t.y=b.lat2,t))}var Ppt=["Azimuthal_Equidistant","aeqd"];const Mpt={init:Apt,forward:Ipt,inverse:Rpt,names:Ppt};function Cpt(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Npt(t){var e,n,r,i,s,o,a,l,c=t.x,u=t.y;return r=At(c-this.long0,this.over),e=Math.sin(u),n=Math.cos(u),i=Math.cos(r),o=this.sin_p14*e+this.cos_p14*n*i,s=1,(o>0||Math.abs(o)<=wt)&&(a=this.a*s*n*Math.sin(r),l=this.y0+this.a*s*(this.cos_p14*e-this.sin_p14*n*i)),t.x=a,t.y=l,t}function Opt(t){var e,n,r,i,s,o,a;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Ug(e/this.a),r=Math.sin(n),i=Math.cos(n),o=this.long0,Math.abs(e)<=wt?(a=this.lat0,t.x=o,t.y=a,t):(a=Ug(i*this.sin_p14+t.y*r*this.cos_p14/e),s=Math.abs(this.lat0)-st,Math.abs(s)<=wt?(this.lat0>=0?o=At(this.long0+Math.atan2(t.x,-t.y),this.over):o=At(this.long0-Math.atan2(-t.x,t.y),this.over),t.x=o,t.y=a,t):(o=At(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r),this.over),t.x=o,t.y=a,t))}var Lpt=["ortho"];const Dpt={init:Cpt,forward:Npt,inverse:Opt,names:Lpt};var Mi={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Mr={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function $pt(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=st-Pr/2?this.face=Mi.TOP:this.lat0<=-(st-Pr/2)?this.face=Mi.BOTTOM:Math.abs(this.long0)<=Pr?this.face=Mi.FRONT:Math.abs(this.long0)<=st+Pr?this.face=this.long0>0?Mi.RIGHT:Mi.LEFT:this.face=Mi.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function jpt(t){var e={x:0,y:0},n,r,i,s,o,a,l={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===Mi.TOP)s=st-n,r>=Pr&&r<=st+Pr?(l.value=Mr.AREA_0,i=r-st):r>st+Pr||r<=-(st+Pr)?(l.value=Mr.AREA_1,i=r>0?r-ls:r+ls):r>-(st+Pr)&&r<=-Pr?(l.value=Mr.AREA_2,i=r+st):(l.value=Mr.AREA_3,i=r);else if(this.face===Mi.BOTTOM)s=st+n,r>=Pr&&r<=st+Pr?(l.value=Mr.AREA_0,i=-r+st):r<Pr&&r>=-Pr?(l.value=Mr.AREA_1,i=-r):r<-Pr&&r>=-(st+Pr)?(l.value=Mr.AREA_2,i=-r-st):(l.value=Mr.AREA_3,i=r>0?-r+ls:-r-ls);else{var c,u,h,f,g,v,x;this.face===Mi.RIGHT?r=aw(r,+st):this.face===Mi.BACK?r=aw(r,+ls):this.face===Mi.LEFT&&(r=aw(r,-st)),f=Math.sin(n),g=Math.cos(n),v=Math.sin(r),x=Math.cos(r),c=g*x,u=g*v,h=f,this.face===Mi.FRONT?(s=Math.acos(c),i=sM(s,h,u,l)):this.face===Mi.RIGHT?(s=Math.acos(u),i=sM(s,h,-c,l)):this.face===Mi.BACK?(s=Math.acos(-c),i=sM(s,h,-u,l)):this.face===Mi.LEFT?(s=Math.acos(-u),i=sM(s,h,c,l)):(s=i=0,l.value=Mr.AREA_0)}return a=Math.atan(12/ls*(i+Math.acos(Math.sin(i)*Math.cos(Pr))-st)),o=Math.sqrt((1-Math.cos(s))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===Mr.AREA_1?a+=st:l.value===Mr.AREA_2?a+=ls:l.value===Mr.AREA_3&&(a+=1.5*ls),e.x=o*Math.cos(a),e.y=o*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function Fpt(t){var e={lam:0,phi:0},n,r,i,s,o,a,l,c,u,h={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?h.value=Mr.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(h.value=Mr.AREA_1,n-=st):t.x<0&&-t.x>=Math.abs(t.y)?(h.value=Mr.AREA_2,n=n<0?n+ls:n-ls):(h.value=Mr.AREA_3,n+=st),u=ls/12*Math.tan(n),o=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(o),i=Math.cos(n),s=Math.tan(r),l=1-i*i*s*s*(1-Math.cos(Math.atan(1/Math.cos(a)))),l<-1?l=-1:l>1&&(l=1),this.face===Mi.TOP)c=Math.acos(l),e.phi=st-c,h.value===Mr.AREA_0?e.lam=a+st:h.value===Mr.AREA_1?e.lam=a<0?a+ls:a-ls:h.value===Mr.AREA_2?e.lam=a-st:e.lam=a;else if(this.face===Mi.BOTTOM)c=Math.acos(l),e.phi=c-st,h.value===Mr.AREA_0?e.lam=-a+st:h.value===Mr.AREA_1?e.lam=-a:h.value===Mr.AREA_2?e.lam=-a-st:e.lam=a<0?-a-ls:-a+ls;else{var f,g,v;f=l,u=f*f,u>=1?v=0:v=Math.sqrt(1-u)*Math.sin(a),u+=v*v,u>=1?g=0:g=Math.sqrt(1-u),h.value===Mr.AREA_1?(u=g,g=-v,v=u):h.value===Mr.AREA_2?(g=-g,v=-v):h.value===Mr.AREA_3&&(u=g,g=v,v=-u),this.face===Mi.RIGHT?(u=f,f=-g,g=u):this.face===Mi.BACK?(f=-f,g=-g):this.face===Mi.LEFT&&(u=f,f=g,g=-u),e.phi=Math.acos(-v)-st,e.lam=Math.atan2(g,f),this.face===Mi.RIGHT?e.lam=aw(e.lam,-st):this.face===Mi.BACK?e.lam=aw(e.lam,-ls):this.face===Mi.LEFT&&(e.lam=aw(e.lam,+st))}if(this.es!==0){var x,b,T;x=e.phi<0?1:0,b=Math.tan(e.phi),T=this.b/Math.sqrt(b*b+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),x&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function sM(t,e,n,r){var i;return t<wt?(r.value=Mr.AREA_0,i=0):(i=Math.atan2(e,n),Math.abs(i)<=Pr?r.value=Mr.AREA_0:i>Pr&&i<=st+Pr?(r.value=Mr.AREA_1,i-=st):i>st+Pr||i<=-(st+Pr)?(r.value=Mr.AREA_2,i=i>=0?i-ls:i+ls):(r.value=Mr.AREA_3,i+=st)),i}function aw(t,e){var n=t+e;return n<-ls?n+=eA:n>+ls&&(n-=eA),n}var Vpt=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const zpt={init:$pt,forward:jpt,inverse:Fpt,names:Vpt};var GV=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],NS=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Fwe=.8487,Vwe=1.3523,zwe=gl/5,Upt=1/zwe,Cx=18,_N=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},Gpt=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function Bpt(t,e,n,r){for(var i=e;r;--r){var s=t(i);if(i-=s,Math.abs(s)<n)break}return i}function Wpt(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Hpt(t){var e=At(t.x-this.long0,this.over),n=Math.abs(t.y),r=Math.floor(n*zwe);r<0?r=0:r>=Cx&&(r=Cx-1),n=gl*(n-Upt*r);var i={x:_N(GV[r],n)*e,y:_N(NS[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*Fwe+this.x0,i.y=i.y*this.a*Vwe+this.y0,i}function qpt(t){var e={x:(t.x-this.x0)/(this.a*Fwe),y:Math.abs(t.y-this.y0)/(this.a*Vwe)};if(e.y>=1)e.x/=GV[Cx][0],e.y=t.y<0?-st:st;else{var n=Math.floor(e.y*Cx);for(n<0?n=0:n>=Cx&&(n=Cx-1);;)if(NS[n][0]>e.y)--n;else if(NS[n+1][0]<=e.y)++n;else break;var r=NS[n],i=5*(e.y-r[0])/(NS[n+1][0]-r[0]);i=Bpt(function(s){return(_N(r,s)-e.y)/Gpt(r,s)},i,wt,100),e.x/=_N(GV[n],i),e.y=(5*n+i)*Wi,t.y<0&&(e.y=-e.y)}return e.x=At(e.x+this.long0,this.over),e}var Kpt=["Robinson","robin"];const Ypt={init:Wpt,forward:Hpt,inverse:qpt,names:Kpt};function Xpt(){this.name="geocent"}function Zpt(t){var e=Iwe(t,this.es,this.a);return e}function Jpt(t){var e=Rwe(t,this.es,this.a,this.b);return e}var Qpt=["Geocentric","geocentric","geocent","Geocent"];const emt={init:Xpt,forward:Zpt,inverse:Jpt,names:Qpt};var na={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},$E={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function tmt(){if(Object.keys($E).forEach((function(n){if(typeof this[n]>"u")this[n]=$E[n].def;else{if($E[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);$E[n].num&&(this[n]=parseFloat(this[n]))}$E[n].degrees&&(this[n]=this[n]*Wi)}).bind(this)),Math.abs(Math.abs(this.lat0)-st)<wt?this.mode=this.lat0<0?na.S_POLE:na.N_POLE:Math.abs(this.lat0)<wt?this.mode=na.EQUIT:(this.mode=na.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function nmt(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i,s;switch(this.mode){case na.OBLIQ:s=this.sinph0*e+this.cosph0*n*r;break;case na.EQUIT:s=n*r;break;case na.S_POLE:s=-e;break;case na.N_POLE:s=e;break}switch(s=this.pn1/(this.p-s),i=s*n*Math.sin(t.x),this.mode){case na.OBLIQ:s*=this.cosph0*e-this.sinph0*n*r;break;case na.EQUIT:s*=e;break;case na.N_POLE:s*=-(n*r);break;case na.S_POLE:s*=n*r;break}var o,a;return o=s*this.cg+i*this.sg,a=1/(o*this.sw*this.h1+this.cw),i=(i*this.cg-s*this.sg)*this.cw*a,s=o*a,t.x=i*this.a,t.y=s*this.a,t}function rmt(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,i;i=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*i,r=this.pn1*t.y*this.cw*i,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var s=dl(t.x,t.y);if(Math.abs(s)<wt)e.x=0,e.y=t.y;else{var o,a;switch(a=1-s*s*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/s+s/this.pn1),o=Math.sqrt(1-a*a),this.mode){case na.OBLIQ:e.y=Math.asin(o*this.sinph0+t.y*a*this.cosph0/s),t.y=(o-this.sinph0*Math.sin(e.y))*s,t.x*=a*this.cosph0;break;case na.EQUIT:e.y=Math.asin(t.y*a/s),t.y=o*s,t.x*=a;break;case na.N_POLE:e.y=Math.asin(o),t.y=-t.y;break;case na.S_POLE:e.y=-Math.asin(o);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var imt=["Tilted_Perspective","tpers"];const smt={init:tmt,forward:nmt,inverse:rmt,names:imt};function omt(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function amt(t){var e=t.x,n=t.y,r,i,s,o;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var a=this.radius_p/dl(this.radius_p*Math.cos(n),Math.sin(n));if(i=a*Math.cos(e)*Math.cos(n),s=a*Math.sin(e)*Math.cos(n),o=a*Math.sin(n),(this.radius_g-i)*i-s*s-o*o*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/dl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(s/r),t.y=this.radius_g_1*Math.atan(o/dl(s,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(e)*r,s=Math.sin(e)*r,o=Math.sin(n),r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(s/dl(o,r)),t.y=this.radius_g_1*Math.atan(o/r)):(t.x=this.radius_g_1*Math.atan(s/r),t.y=this.radius_g_1*Math.atan(o/dl(s,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function lmt(t){var e=-1,n=0,r=0,i,s,o,a;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*dl(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*dl(1,n));var l=r/this.radius_p;if(i=n*n+l*l+e*e,s=2*this.radius_g*e,o=s*s-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-s-Math.sqrt(o))/(2*i),e=this.radius_g+a*e,n*=a,r*=a,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+e*e,s=2*this.radius_g*e,o=s*s-4*i*this.C,o<0)return t.x=Number.NaN,t.y=Number.NaN,t;a=(-s-Math.sqrt(o))/(2*i),e=this.radius_g+a*e,n*=a,r*=a,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var cmt=["Geostationary Satellite View","Geostationary_Satellite","geos"];const umt={init:omt,forward:amt,inverse:lmt,names:cmt};var AT=1.340264,IT=-.081106,RT=893e-6,PT=.003796,xN=Math.sqrt(3)/2;function hmt(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function dmt(t){var e=At(t.x-this.long0,this.over),n=t.y,r=Math.asin(xN*Math.sin(n)),i=r*r,s=i*i*i;return t.x=e*Math.cos(r)/(xN*(AT+3*IT*i+s*(7*RT+9*PT*i))),t.y=r*(AT+IT*i+s*(RT+PT*i)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function fmt(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,i,s,o,a,l,c;for(c=0;c<n&&(i=r*r,s=i*i*i,o=r*(AT+IT*i+s*(RT+PT*i))-t.y,a=AT+3*IT*i+s*(7*RT+9*PT*i),r-=l=o/a,!(Math.abs(l)<e));++c);return i=r*r,s=i*i*i,t.x=xN*t.x*(AT+3*IT*i+s*(7*RT+9*PT*i))/Math.cos(r),t.y=Math.asin(Math.sin(r)/xN),t.x=At(t.x+this.long0,this.over),t}var pmt=["eqearth","Equal Earth","Equal_Earth"];const mmt={init:hmt,forward:dmt,inverse:fmt,names:pmt};var rA=1e-10;function gmt(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<rA)throw new Error;this.es?(this.en=lH(this.es),this.m1=ub(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=vmt,this.forward=ymt):(Math.abs(this.phi1)+rA>=st?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=xmt,this.forward=_mt)}function ymt(t){var e=At(t.x-(this.long0||0),this.over),n=t.y,r,i,s;return r=this.am1+this.m1-ub(n,i=Math.sin(n),s=Math.cos(n),this.en),i=s*e/(r*Math.sqrt(1-this.es*i*i)),t.x=r*Math.sin(i),t.y=this.am1-r*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function vmt(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,i;if(n=dl(t.x,t.y=this.am1-t.y),i=cH(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(i))<st)e=Math.sin(i),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-st)<=rA)r=0;else throw new Error;return t.x=At(r+(this.long0||0),this.over),t.y=e0(i),t}function _mt(t){var e=At(t.x-(this.long0||0),this.over),n=t.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>rA?(t.x=i*Math.sin(r=e*Math.cos(n)/i),t.y=this.cphi1-i*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function xmt(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=dl(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>st)throw new Error;return Math.abs(Math.abs(n)-st)<=rA?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=At(e+(this.long0||0),this.over),t.y=e0(n),t}var wmt=["bonne","Bonne (Werner lat_1=90)"];const bmt={init:gmt,names:wmt},Tse={OBLIQUE:{forward:Amt,inverse:Rmt},TRANSVERSE:{forward:Imt,inverse:Pmt}},wN={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function Emt(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=Swe.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const t=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),e=ru(t);if(!e)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);e.long0=0,this.obliqueProjection=e;let n;const r=Object.keys(wN),i=a=>{if(typeof this[a]>"u")return;const l=parseFloat(this[a])*Wi;if(isNaN(l))throw new Error("Invalid value for "+a+": "+this[a]);return l};for(let a=0;a<r.length;a++){const l=r[a],c=wN[l],u=Object.entries(c);if(u.some(([f])=>typeof this[f]<"u")){n=c;for(let f=0;f<u.length;f++){const[g,v]=u[f],x=i(g);if(typeof x>"u")throw new Error("Missing parameter: "+g+".");this[v]=x}break}}if(!n)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:s,phip:o}=kmt(this,n);this.lamp=s,Math.abs(o)>wt?(this.cphip=Math.cos(o),this.sphip=Math.sin(o),this.projectionType=Tse.OBLIQUE):this.projectionType=Tse.TRANSVERSE}function Smt(t){return this.projectionType.forward(this,t)}function Tmt(t){return this.projectionType.inverse(this,t)}function kmt(t,e){let n,r;if(e===wN.ROTATE){let i=t.oLongC,s=t.oLatC,o=t.oAlpha;if(Math.abs(Math.abs(s)-st)<=wt)throw new Error("Invalid value for o_lat_c: "+t.o_lat_c+" should be < 90");r=i+Math.atan2(-1*Math.cos(o),-1*Math.sin(o)*Math.sin(s)),n=Math.asin(Math.cos(s)*Math.sin(o))}else if(e===wN.NEW_POLE)r=t.oLongP,n=t.oLatP;else{let i=t.oLong1,s=t.oLat1,o=t.oLong2,a=t.oLat2,l=Math.abs(s);if(Math.abs(s)>st-wt)throw new Error("Invalid value for o_lat_1: "+t.o_lat_1+" should be < 90");if(Math.abs(a)>st-wt)throw new Error("Invalid value for o_lat_2: "+t.o_lat_2+" should be < 90");if(Math.abs(s-a)<wt)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(l<wt)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");r=Math.atan2(Math.cos(s)*Math.sin(a)*Math.cos(i)-Math.sin(s)*Math.cos(a)*Math.cos(o),Math.sin(s)*Math.cos(a)*Math.sin(o)-Math.cos(s)*Math.sin(a)*Math.sin(i)),n=Math.atan(-1*Math.cos(r-i)/Math.tan(s))}return{lamp:r,phip:n}}function Amt(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(n),s=Math.sin(r),o=Math.cos(r);e.x=At(Math.atan2(o*Math.sin(n),t.sphip*o*i+t.cphip*s)+t.lamp),e.y=Math.asin(t.sphip*s-t.cphip*o*i);const a=t.obliqueProjection.forward(e);return t.isIdentity&&(a.x*=gl,a.y*=gl),a}function Imt(t,e){let{x:n,y:r}=e;n+=t.long0;const i=Math.cos(r),s=Math.cos(n);e.x=At(Math.atan2(i*Math.sin(n),Math.sin(r))+t.lamp),e.y=Math.asin(-1*i*s);const o=t.obliqueProjection.forward(e);return t.isIdentity&&(o.x*=gl,o.y*=gl),o}function Rmt(t,e){t.isIdentity&&(e.x*=Wi,e.y*=Wi);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){r-=t.lamp;const s=Math.cos(r),o=Math.sin(i),a=Math.cos(i);e.x=Math.atan2(a*Math.sin(r),t.sphip*a*s-t.cphip*o),e.y=Math.asin(t.sphip*o+t.cphip*a*s)}return e.x=At(e.x+t.long0),e}function Pmt(t,e){t.isIdentity&&(e.x*=Wi,e.y*=Wi);const n=t.obliqueProjection.inverse(e);let{x:r,y:i}=n;if(r<Number.MAX_VALUE){const s=Math.cos(i);r-=t.lamp,e.x=Math.atan2(s*Math.sin(r),-1*Math.sin(i)),e.y=Math.asin(s*Math.cos(r))}return e.x=At(e.x+t.long0),e}var Mmt=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const Cmt={init:Emt,forward:Smt,inverse:Tmt,names:Mmt};function Nmt(t){t.Proj.projections.add(qC),t.Proj.projections.add(KC),t.Proj.projections.add(wdt),t.Proj.projections.add(Pdt),t.Proj.projections.add(Ldt),t.Proj.projections.add(Vdt),t.Proj.projections.add(Hdt),t.Proj.projections.add(Zdt),t.Proj.projections.add(nft),t.Proj.projections.add(aft),t.Proj.projections.add(xft),t.Proj.projections.add(kft),t.Proj.projections.add(Mft),t.Proj.projections.add($ft),t.Proj.projections.add(Uft),t.Proj.projections.add(qft),t.Proj.projections.add(Jft),t.Proj.projections.add(rpt),t.Proj.projections.add(cpt),t.Proj.projections.add(ppt),t.Proj.projections.add(_pt),t.Proj.projections.add(Spt),t.Proj.projections.add(Mpt),t.Proj.projections.add(Dpt),t.Proj.projections.add(zpt),t.Proj.projections.add(Ypt),t.Proj.projections.add(emt),t.Proj.projections.add(smt),t.Proj.projections.add(umt),t.Proj.projections.add(mmt),t.Proj.projections.add(bmt),t.Proj.projections.add(Cmt)}const ir=Object.assign(jht,{defaultDatum:"WGS84",Proj:ru,WGS84:new ru("WGS84"),Point:A2,toPoint:Pwe,defs:bo,nadgrid:xht,transform:yN,mgrs:Fht,version:"__VERSION__"});Nmt(ir);class Uwe{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=_i,this.supportedMediaTypes=null}getReadOptions(e,n){if(n){let r=n.dataProjection?Yr(n.dataProjection):this.readProjection(e);n.extent&&r&&r.getUnits()==="tile-pixels"&&(r=Yr(r),r.setWorldExtent(n.extent)),n={dataProjection:r,featureProjection:n.featureProjection}}return this.adaptOptions(n)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return xn()}readFeature(e,n){return xn()}readFeatures(e,n){return xn()}readGeometry(e,n){return xn()}readProjection(e){return xn()}writeFeature(e,n){return xn()}writeFeatures(e,n){return xn()}writeGeometry(e,n){return xn()}}function fh(t,e,n){const r=n?Yr(n.featureProjection):null,i=n?Yr(n.dataProjection):null;let s=t;if(r&&i&&!Uy(r,i)){e&&(s=t.clone());const o=e?r:i,a=e?i:r;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(WT(o,a))}if(e&&n&&n.decimals!==void 0){const o=Math.pow(10,n.decimals),a=function(l){for(let c=0,u=l.length;c<u;++c)l[c]=Math.round(l[c]*o)/o;return l};s===t&&(s=t.clone()),s.applyTransform(a)}return s}const Omt={Point:Vs,LineString:ro,Polygon:ou,MultiPoint:X1,MultiLineString:np,MultiPolygon:p1};function Lmt(t,e,n){return Array.isArray(e[0])?(Aae(t,0,e,n)||(t=t.slice(),rj(t,0,e,n)),t):(Tz(t,0,e,n)||(t=t.slice(),u3(t,0,e,n)),t)}function Gwe(t,e){const n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(s=>Gwe({...t,geometry:s})).flat();const r=n.type==="MultiPolygon"?"Polygon":n.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=n.layout.length;return fh(new ul(r,r==="Polygon"?Lmt(n.flatCoordinates,n.ends,i):n.flatCoordinates,n.ends?.flat(),i,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function mH(t,e){if(!t)return null;if(Array.isArray(t)){const r=t.map(i=>mH(i,e));return new eh(r)}const n=Omt[t.type];return fh(new n(t.flatCoordinates,t.layout||"XY",t.ends),!1,e)}class Dmt extends Uwe{constructor(){super()}getType(){return"json"}readFeature(e,n){return this.readFeatureFromObject(oM(e),this.getReadOptions(e,n))}readFeatures(e,n){return this.readFeaturesFromObject(oM(e),this.getReadOptions(e,n))}readFeatureFromObject(e,n){return xn()}readFeaturesFromObject(e,n){return xn()}readGeometry(e,n){return this.readGeometryFromObject(oM(e),this.getReadOptions(e,n))}readGeometryFromObject(e,n){return xn()}readProjection(e){return this.readProjectionFromObject(oM(e))}readProjectionFromObject(e){return xn()}writeFeature(e,n){return JSON.stringify(this.writeFeatureObject(e,n))}writeFeatureObject(e,n){return xn()}writeFeatures(e,n){return JSON.stringify(this.writeFeaturesObject(e,n))}writeFeaturesObject(e,n){return xn()}writeGeometry(e,n){return JSON.stringify(this.writeGeometryObject(e,n))}writeGeometryObject(e,n){return xn()}}function oM(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class ZO extends Dmt{constructor(e){e=e||{},super(),this.dataProjection=Yr(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Yr(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,n){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=gH(r.geometry);if(this.featureClass===ul)return Gwe({geometry:i,id:r.id,properties:r.properties},n);const s=new _i;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(mH(i,n)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,n){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],n);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,n)];return i.flat()}readGeometryFromObject(e,n){return $mt(e,n)}readProjectionFromObject(e){const n=e.crs;let r;if(n)if(n.type=="name")r=Yr(n.properties.name);else if(n.type==="EPSG")r=Yr("EPSG:"+n.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,n){n=this.adaptOptions(n);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),o=e.getGeometry();return o&&(r.geometry=BV(o,n),delete s[e.getGeometryName()]),c1(s)||(r.properties=s),r}writeFeaturesObject(e,n){n=this.adaptOptions(n);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],n));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,n){return BV(e,this.adaptOptions(n))}}function gH(t,e){if(!t)return null;let n;switch(t.type){case"Point":{n=Fmt(t);break}case"LineString":{n=Vmt(t);break}case"Polygon":{n=Bmt(t);break}case"MultiPoint":{n=Umt(t);break}case"MultiLineString":{n=zmt(t);break}case"MultiPolygon":{n=Gmt(t);break}case"GeometryCollection":{n=jmt(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function $mt(t,e){const n=gH(t);return mH(n,e)}function jmt(t,e){return t.geometries.map(function(r){return gH(r)})}function Fmt(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:Y1(e.length)}}function Vmt(t){const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:Y1(e[0]?.length||2)}}function zmt(t){const e=t.coordinates,n=e[0]?.[0]?.length||2,r=[],i=bA(r,0,e,n);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:Y1(n)}}function Umt(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Y1(e[0]?.length||2)}}function Gmt(t){const e=t.coordinates,n=[],r=e[0]?.[0]?.[0].length||2,i=rae(n,0,e,r);return{type:"MultiPolygon",flatCoordinates:n,ends:i,layout:Y1(r)}}function Bmt(t){const e=t.coordinates,n=[],r=e[0]?.[0]?.length,i=bA(n,0,e,r);return{type:"Polygon",flatCoordinates:n,ends:i,layout:Y1(r)}}function BV(t,e){t=fh(t,!0,e);const n=t.getType();let r;switch(n){case"Point":{r=Xmt(t);break}case"LineString":{r=Hmt(t);break}case"Polygon":{r=Zmt(t,e);break}case"MultiPoint":{r=Kmt(t);break}case"MultiLineString":{r=qmt(t);break}case"MultiPolygon":{r=Ymt(t,e);break}case"GeometryCollection":{r=Wmt(t,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+n)}return r}function Wmt(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(r){return BV(r,e)})}}function Hmt(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function qmt(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Kmt(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Ymt(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}function Xmt(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function Zmt(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}const bN="http://www.w3.org/2001/XMLSchema-instance";function uv(t,e){return hb().createElementNS(t,e)}function ph(t,e){return Bwe(t,e,[]).join("")}function Bwe(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)n.push(t.nodeValue);else{let r;for(r=t.firstChild;r;r=r.nextSibling)Bwe(r,e,n)}return n}function Vf(t){return"documentElement"in t}function zf(t){return new DOMParser().parseFromString(t,"application/xml")}function kse(t,e){return(function(n,r){const i=t.call(e??this,n,r);if(i!==void 0){const s=r[r.length-1];Rr(s,i)}})}function qu(t,e){return(function(n,r){const i=t.call(e??this,n,r);i!==void 0&&r[r.length-1].push(i)})}function yH(t,e){return(function(n,r){const i=t.call(this,n,r);i!==void 0&&(r[r.length-1]=i)})}function Qe(t,e,n){return(function(r,i){const s=t.call(this,r,i);if(s!==void 0){const o=i[i.length-1],a=e!==void 0?e:r.localName;o[a]=s}})}function pt(t,e){return(function(n,r,i){t.call(this,n,r,i),i[i.length-1].node.appendChild(n)})}function Wwe(t,e){let n,r;return function(i,s,o){if(n===void 0){n={};const a={};a[i.localName]=t,n[i.namespaceURI]=a,r=mh(i.localName)}Hwe(n,r,s,o)}}function mh(t,e){return(function(n,r,i){const o=r[r.length-1].node;let a=t;a===void 0&&(a=i);const l=o.namespaceURI;return uv(l,a)})}const pa=mh();function El(t,e){const n=e.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=t[e[i]];return r}function kt(t,e,n){n=n!==void 0?n:{};let r,i;for(r=0,i=t.length;r<i;++r)n[t[r]]=e;return n}function t0(t,e,n,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=t[i.namespaceURI];if(s!==void 0){const o=s[i.localName];o!==void 0&&o.call(r,i,n)}}}function tr(t,e,n,r,i){return r.push(t),t0(e,n,r,i),r.pop()}function Hwe(t,e,n,r,i,s){const o=(i!==void 0?i:n).length;let a,l;for(let c=0;c<o;++c)a=n[c],a!==void 0&&(l=e.call(s,a,r,i!==void 0?i[c]:void 0),l!==void 0&&t[l.namespaceURI][l.localName].call(s,l,a,r))}function ei(t,e,n,r,i,s,o){return i.push(t),Hwe(e,n,r,i,s,o),i.pop()}let b8;function Jmt(){return b8===void 0&&typeof XMLSerializer<"u"&&(b8=new XMLSerializer),b8}let E8;function hb(){return E8===void 0&&typeof document<"u"&&(E8=document.implementation.createDocument("","",null)),E8}class qwe extends Uwe{constructor(){super(),this.xmlSerializer_=Jmt()}getType(){return"xml"}readFeature(e,n){if(!e)return null;if(typeof e=="string"){const r=zf(e);return this.readFeatureFromDocument(r,n)}return Vf(e)?this.readFeatureFromDocument(e,n):this.readFeatureFromNode(e,n)}readFeatureFromDocument(e,n){const r=this.readFeaturesFromDocument(e,n);return r.length>0?r[0]:null}readFeatureFromNode(e,n){return null}readFeatures(e,n){if(!e)return[];if(typeof e=="string"){const r=zf(e);return this.readFeaturesFromDocument(r,n)}return Vf(e)?this.readFeaturesFromDocument(e,n):this.readFeaturesFromNode(e,n)}readFeaturesFromDocument(e,n){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Rr(r,this.readFeaturesFromNode(i,n));return r}readFeaturesFromNode(e,n){return xn()}readGeometry(e,n){if(!e)return null;if(typeof e=="string"){const r=zf(e);return this.readGeometryFromDocument(r,n)}return Vf(e)?this.readGeometryFromDocument(e,n):this.readGeometryFromNode(e,n)}readGeometryFromDocument(e,n){return null}readGeometryFromNode(e,n){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const n=zf(e);return this.readProjectionFromDocument(n)}return Vf(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,n){const r=this.writeFeatureNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,n){return null}writeFeatures(e,n){const r=this.writeFeaturesNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,n){return null}writeGeometry(e,n){const r=this.writeGeometryNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,n){return null}}function Gg(t){const e=ph(t,!1);return Qmt(e)}function Qmt(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return e[1]!==void 0||!1}function JO(t){const e=ph(t,!1),n=Date.parse(e);return isNaN(n)?void 0:n/1e3}function gr(t){const e=ph(t,!1);return egt(e)}function egt(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function iA(t){const e=ph(t,!1);return tgt(e)}function tgt(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function Vn(t){return ph(t,!1).trim()}function I2(t,e){br(t,e?"1":"0")}function ngt(t,e){t.appendChild(hb().createCDATASection(e))}function rgt(t,e){const n=new Date(e*1e3),r=n.getUTCFullYear()+"-"+eE(n.getUTCMonth()+1,2)+"-"+eE(n.getUTCDate(),2)+"T"+eE(n.getUTCHours(),2)+":"+eE(n.getUTCMinutes(),2)+":"+eE(n.getUTCSeconds(),2)+"Z";t.appendChild(hb().createTextNode(r))}function al(t,e){const n=e.toPrecision();t.appendChild(hb().createTextNode(n))}function EN(t,e){const n=e.toString();t.appendChild(hb().createTextNode(n))}const igt=/^\s/,sgt=/\s$/,ogt=/(\n|\t|\r|<|&| {2})/;function br(t,e){typeof e=="string"&&(igt.test(e)||sgt.test(e)||ogt.test(e))?e.split("]]>").forEach((n,r,i)=>{r<i.length-1&&(n+="]]"),r>0&&(n=">"+n),ngt(t,n)}):t.appendChild(hb().createTextNode(e))}const ui=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],agt="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",lgt={rte:Kwe,trk:Ywe,wpt:Xwe},cgt=kt(ui,{rte:qu(Kwe),trk:qu(Ywe),wpt:qu(Xwe)}),ugt=kt(ui,{text:Qe(Vn,"linkText"),type:Qe(Vn,"linkType")}),hgt=kt(ui,{name:Qe(Vn),email:jgt,link:NI}),dgt=kt(ui,{name:Qe(Vn),desc:Qe(Vn),author:Qe(Lgt),copyright:Qe(Dgt),link:NI,time:Qe(JO),keywords:Qe(Vn),bounds:$gt,extensions:QO}),fgt=kt(ui,{year:Qe(iA),license:Qe(Vn)}),pgt=kt(ui,{rte:pt(Ugt),trk:pt(Ggt),wpt:pt(Wgt)});class mgt extends qwe{constructor(e){super(),e=e||{},this.dataProjection=Yr("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(zf(e)):Vf(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(n);if(r)return r}return null}readMetadataFromNode(e){if(!ui.includes(e.namespaceURI))return null;for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(ui.includes(n.namespaceURI)&&n.localName==="metadata")return tr({},dgt,n,[]);return null}readFeatureFromNode(e,n){if(!ui.includes(e.namespaceURI))return null;const r=lgt[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,n)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,n){if(!ui.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=tr([],cgt,e,[this.getReadOptions(e,n)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=uv("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",bN),r.setAttributeNS(bN,"xsi:schemaLocation",agt),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),ei({node:r},pgt,Ogt,e,[n]),r}}const ggt=kt(ui,{name:Qe(Vn),cmt:Qe(Vn),desc:Qe(Vn),src:Qe(Vn),link:NI,number:Qe(iA),extensions:QO,type:Qe(Vn),rtept:Fgt}),ygt=kt(ui,{ele:Qe(gr),time:Qe(JO)}),vgt=kt(ui,{name:Qe(Vn),cmt:Qe(Vn),desc:Qe(Vn),src:Qe(Vn),link:NI,number:Qe(iA),type:Qe(Vn),extensions:QO,trkseg:zgt}),_gt=kt(ui,{trkpt:Vgt}),xgt=kt(ui,{ele:Qe(gr),time:Qe(JO)}),wgt=kt(ui,{ele:Qe(gr),time:Qe(JO),magvar:Qe(gr),geoidheight:Qe(gr),name:Qe(Vn),cmt:Qe(Vn),desc:Qe(Vn),src:Qe(Vn),link:NI,sym:Qe(Vn),type:Qe(Vn),fix:Qe(Vn),sat:Qe(iA),hdop:Qe(gr),vdop:Qe(gr),pdop:Qe(gr),ageofdgpsdata:Qe(gr),dgpsid:Qe(iA),extensions:QO}),bgt=["text","type"],Egt=kt(ui,{text:pt(br),type:pt(br)}),Sgt=kt(ui,["name","cmt","desc","src","link","number","type","rtept"]),Tgt=kt(ui,{name:pt(br),cmt:pt(br),desc:pt(br),src:pt(br),link:pt(xH),number:pt(EN),type:pt(br),rtept:Wwe(pt(wH))}),kgt=kt(ui,["ele","time"]),Agt=kt(ui,["name","cmt","desc","src","link","number","type","trkseg"]),Igt=kt(ui,{name:pt(br),cmt:pt(br),desc:pt(br),src:pt(br),link:pt(xH),number:pt(EN),type:pt(br),trkseg:Wwe(pt(Bgt))}),Rgt=mh("trkpt"),Pgt=kt(ui,{trkpt:pt(wH)}),Mgt=kt(ui,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Cgt=kt(ui,{ele:pt(al),time:pt(rgt),magvar:pt(al),geoidheight:pt(al),name:pt(br),cmt:pt(br),desc:pt(br),src:pt(br),link:pt(xH),sym:pt(br),type:pt(br),fix:pt(br),sat:pt(EN),hdop:pt(al),vdop:pt(al),pdop:pt(al),ageofdgpsdata:pt(al),dgpsid:pt(EN)}),Ngt={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Ogt(t,e,n){const r=t.getGeometry();if(r){const i=Ngt[r.getType()];if(i){const s=e[e.length-1].node;return uv(s.namespaceURI,i)}}}function vH(t,e,n,r){return t.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in r?(t.push(r.ele),delete r.ele,e.hasZ=!0):t.push(0),"time"in r?(t.push(r.time),delete r.time,e.hasM=!0):t.push(0),t}function _H(t,e,n){let r="XY",i=2;if(t.hasZ&&t.hasM?(r="XYZM",i=4):t.hasZ?(r="XYZ",i=3):t.hasM&&(r="XYM",i=3),i!==4){for(let s=0,o=e.length/4;s<o;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],t.hasZ&&(e[s*i+2]=e[s*4+2]),t.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,n)for(let s=0,o=n.length;s<o;s++)n[s]=n[s]/4*i}return r}function Lgt(t,e){const n=tr({},hgt,t,e);if(n)return n}function Dgt(t,e){const n=tr({},fgt,t,e);if(n){const r=t.getAttribute("author");return r!==null&&(n.author=r),n}}function $gt(t,e){const n=e[e.length-1],r=t.getAttribute("minlat"),i=t.getAttribute("minlon"),s=t.getAttribute("maxlat"),o=t.getAttribute("maxlon");i!==null&&r!==null&&o!==null&&s!==null&&(n.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(o),parseFloat(s)]])}function jgt(t,e){const n=e[e.length-1],r=t.getAttribute("id"),i=t.getAttribute("domain");r!==null&&i!==null&&(n.email=`${r}@${i}`)}function NI(t,e){const n=e[e.length-1],r=t.getAttribute("href");r!==null&&(n.link=r),t0(ugt,t,e)}function QO(t,e){const n=e[e.length-1];n.extensionsNode_=t}function Fgt(t,e){const n=tr({},ygt,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;vH(i,s,t,n)}}function Vgt(t,e){const n=tr({},xgt,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;vH(i,s,t,n)}}function zgt(t,e){const n=e[e.length-1];t0(_gt,t,e);const r=n.flatCoordinates;n.ends.push(r.length)}function Kwe(t,e){const n=e[0],r=tr({flatCoordinates:[],layoutOptions:{}},ggt,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const o=_H(s,i),a=new ro(i,o);fh(a,!1,n);const l=new _i(a);return l.setProperties(r,!0),l}function Ywe(t,e){const n=e[0],r=tr({flatCoordinates:[],ends:[],layoutOptions:{}},vgt,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const o=r.layoutOptions;delete r.layoutOptions;const a=_H(o,i,s),l=new np(i,a,s);fh(l,!1,n);const c=new _i(l);return c.setProperties(r,!0),c}function Xwe(t,e){const n=e[0],r=tr({},wgt,t,e);if(!r)return;const i={},s=vH([],i,t,r),o=_H(i,s),a=new Vs(s,o);fh(a,!1,n);const l=new _i(a);return l.setProperties(r,!0),l}function xH(t,e,n){t.setAttribute("href",e);const i=n[n.length-1].properties,s=[i.linkText,i.linkType];ei({node:t},Egt,pa,s,n,bgt)}function wH(t,e,n){const r=n[n.length-1],s=r.node.namespaceURI,o=r.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(o.time=e[3]);case"XYZ":e[2]!==0&&(o.ele=e[2]);break;case"XYM":e[2]!==0&&(o.time=e[2]);break}const l=t.nodeName=="rtept"?kgt[s]:Mgt[s],c=El(o,l);ei({node:t,properties:o},Cgt,pa,c,n,l)}function Ugt(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="LineString"){const u=fh(o,!0,r);s.geometryLayout=u.getLayout(),i.rtept=u.getCoordinates()}const a=n[n.length-1].node,l=Sgt[a.namespaceURI],c=El(i,l);ei(s,Tgt,pa,c,n,l)}function Ggt(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="MultiLineString"){const u=fh(o,!0,r);i.trkseg=u.getLineStrings()}const a=n[n.length-1].node,l=Agt[a.namespaceURI],c=El(i,l);ei(s,Igt,pa,c,n,l)}function Bgt(t,e,n){const r={node:t};r.geometryLayout=e.getLayout(),r.properties={},ei(r,Pgt,Rgt,e.getCoordinates(),n)}function Wgt(t,e,n){const r=n[0],i=n[n.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const o=fh(s,!0,r);i.geometryLayout=o.getLayout(),wH(t,o.getCoordinates(),n)}}const Ep=["http://www.google.com/kml/ext/2.2"],Xt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Hgt="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",Ase={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},qgt=kt(Xt,{ExtendedData:h2e,Region:d2e,MultiGeometry:Qe(l2e,"geometry"),LineString:Qe(o2e,"geometry"),LinearRing:Qe(a2e,"geometry"),Point:Qe(c2e,"geometry"),Polygon:Qe(u2e,"geometry"),Style:Qe(SH),StyleMap:P0t,address:Qe(Vn),description:Qe(Vn),name:Qe(Vn),open:Qe(Gg),phoneNumber:Qe(Vn),styleUrl:Qe(t2e),visibility:Qe(Gg)},kt(Ep,{MultiTrack:Qe(y0t,"geometry"),Track:Qe(s2e,"geometry")})),Kgt=kt(Xt,{ExtendedData:h2e,Region:d2e,Link:U0t,address:Qe(Vn),description:Qe(Vn),name:Qe(Vn),open:Qe(Gg),phoneNumber:Qe(Vn),visibility:Qe(Gg)}),Ygt=kt(Xt,{href:Qe(e2e)}),Xgt=kt(Xt,{Altitude:Qe(gr),Longitude:Qe(gr),Latitude:Qe(gr),Tilt:Qe(gr),AltitudeMode:Qe(Vn),Heading:Qe(gr),Roll:Qe(gr)}),Zwe=kt(Xt,{LatLonAltBox:L0t,Lod:$0t}),Zgt=kt(Xt,["Document","Placemark"]),Jgt=kt(Xt,{Document:pt(X0t),Placemark:pt(m2e)});let lw,XC=null,WV,MT,CT,NT,SN,HV=null,bH,qV=null,KV,$y=null,Ise=null,YV=null;function TN(t){return 32/Math.min(t[0],t[1])}function Qgt(){lw=[255,255,255,1],XC=new Nr({color:lw}),WV=[20,2],MT="pixels",CT="pixels",NT=[64,64],SN="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",HV=new TA({anchor:WV,anchorOrigin:"bottom-left",anchorXUnits:MT,anchorYUnits:CT,crossOrigin:"anonymous",rotation:0,scale:TN(NT),size:NT,src:SN}),bH="NO_IMAGE",qV=new Sr({color:lw,width:1}),KV=new Sr({color:[51,51,51,1],width:2}),$y=new th({font:"bold 16px Helvetica",fill:XC,stroke:KV,scale:.8}),Ise=new zn({fill:XC,image:HV,text:$y,stroke:qV,zIndex:0}),YV=[Ise]}let aM;function e0t(t){return t}class t0t extends qwe{constructor(e){super(),e=e||{},YV||Qgt(),this.dataProjection=Yr("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:YV,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:e0t,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,n){const r=kt(Xt,{Document:kse(this.readDocumentOrFolder_,this),Folder:kse(this.readDocumentOrFolder_,this),Placemark:qu(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=tr([],r,e,n,this);if(i)return i}readPlacemark_(e,n){const r=tr({geometry:null},qgt,e,n,this);if(!r)return;const i=new _i,s=e.getAttribute("id");s!==null&&i.setId(s);const o=n[0],a=r.geometry;if(a&&fh(a,!1,o),i.setGeometry(a),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,u=r0t(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(u)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,n){const r=e.getAttribute("id");if(r!==null){const i=SH.call(this,e,n);if(i){let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,n){const r=e.getAttribute("id");if(r===null)return;const i=r2e.call(this,e,n);if(!i)return;let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,n){if(!Xt.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return r||null}readFeaturesFromNode(e,n){if(!Xt.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,n)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const o=this.readFeaturesFromNode(s,n);o&&Rr(r,o)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const n=zf(e);return this.readNameFromDocument(n)}return Vf(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(n);if(r)return r}}readNameFromNode(e){for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(Xt.includes(n.namespaceURI)&&n.localName=="name")return Vn(n);for(let n=e.firstElementChild;n;n=n.nextElementSibling){const r=n.localName;if(Xt.includes(n.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(n);if(i)return i}}}readNetworkLinks(e){const n=[];if(typeof e=="string"){const r=zf(e);Rr(n,this.readNetworkLinksFromDocument(r))}else Vf(e)?Rr(n,this.readNetworkLinksFromDocument(e)):Rr(n,this.readNetworkLinksFromNode(e));return n}readNetworkLinksFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Rr(n,this.readNetworkLinksFromNode(r));return n}readNetworkLinksFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=tr({},Kgt,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Rr(n,this.readNetworkLinksFromNode(r))}return n}readRegion(e){const n=[];if(typeof e=="string"){const r=zf(e);Rr(n,this.readRegionFromDocument(r))}else Vf(e)?Rr(n,this.readRegionFromDocument(e)):Rr(n,this.readRegionFromNode(e));return n}readRegionFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Rr(n,this.readRegionFromNode(r));return n}readRegionFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName=="Region"){const i=tr({},Zwe,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Rr(n,this.readRegionFromNode(r))}return n}readCamera(e){const n=[];if(typeof e=="string"){const r=zf(e);Rr(n,this.readCameraFromDocument(r))}else Vf(e)?Rr(n,this.readCameraFromDocument(e)):Rr(n,this.readCameraFromNode(e));return n}readCameraFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&Rr(n,this.readCameraFromNode(r));return n}readCameraFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(Xt.includes(r.namespaceURI)&&r.localName==="Camera"){const i=tr({},Xgt,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;Xt.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Rr(n,this.readCameraFromNode(r))}return n}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=uv(Xt[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Ep[0]),r.setAttributeNS(i,"xmlns:xsi",bN),r.setAttributeNS(bN,"xsi:schemaLocation",Hgt);const s={node:r},o={};e.length>1?o.Document=e:e.length==1&&(o.Placemark=e[0]);const a=Zgt[r.namespaceURI],l=El(o,a);return ei(s,Jgt,pa,l,[n],a,this),r}}function n0t(t,e){const n=[0,0];let r="start";const i=t.getImage();if(i){const a=i.getSize();if(a&&a.length==2){const l=i.getScaleArray(),c=i.getAnchor();n[0]=l[0]*(a[0]-c[0]),n[1]=l[1]*(a[1]/2-c[1]),r="left"}}let s=t.getText();return s?(s=s.clone(),s.setFont(s.getFont()||$y.getFont()),s.setScale(s.getScale()||$y.getScale()),s.setFill(s.getFill()||$y.getFill()),s.setStroke(s.getStroke()||KV)):s=$y.clone(),s.setText(e),s.setOffsetX(n[0]),s.setOffsetY(n[1]),s.setTextAlign(r),new zn({image:i,text:s})}function r0t(t,e,n,r,i){return(function(s,o){let a=i,l="",c=[];if(a){const h=s.getGeometry();if(h)if(h instanceof eh)c=h.getGeometriesArrayRecursive().filter(function(f){const g=f.getType();return g==="Point"||g==="MultiPoint"}),a=c.length>0;else{const f=h.getType();a=f==="Point"||f==="MultiPoint"}}a&&(l=s.get("name"),a=a&&!!l,a&&/&[^&]+;/.test(l)&&(aM||(aM=document.createElement("textarea")),aM.innerHTML=l,l=aM.value));let u=n;if(t?u=t:e&&(u=Jwe(e,n,r)),a){const h=n0t(u[0],l);if(c.length>0){h.setGeometry(new eh(c));const f=new zn({geometry:u[0].getGeometry(),image:null,fill:u[0].getFill(),stroke:u[0].getStroke(),text:null});return[h,f].concat(u.slice(1))}return h}return u})}function Jwe(t,e,n){return Array.isArray(t)?t:typeof t=="string"?Jwe(n[t],e,n):e}function eL(t){const e=ph(t,!1),n=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(n){const r=n[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function Qwe(t){let e=ph(t,!1);const n=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),o=parseFloat(i[2]),a=i[3]?parseFloat(i[3]):0;n.push(s,o,a),e=e.substr(i[0].length)}if(e==="")return n}function e2e(t){const e=ph(t,!1).trim();let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function t2e(t){const e=ph(t,!1).trim().replace(/^(?!.*#)/,"#");let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function i0t(t){const e=t.getAttribute("xunits"),n=t.getAttribute("yunits");let r;return e!=="insetPixels"?n!=="insetPixels"?r="bottom-left":r="top-left":n!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(t.getAttribute("x")),xunits:Ase[e],y:parseFloat(t.getAttribute("y")),yunits:Ase[n],origin:r}}function n2e(t){return gr(t)}const s0t=kt(Xt,{Pair:R0t});function r2e(t,e){return tr(void 0,s0t,t,e,this)}const o0t=kt(Xt,{Icon:Qe(x0t),color:Qe(eL),heading:Qe(gr),hotSpot:Qe(i0t),scale:Qe(n2e)});function a0t(t,e){const n=tr({},o0t,t,e);if(!n)return;const r=e[e.length-1],i="Icon"in n?n.Icon:{},s=!("Icon"in n)||Object.keys(i).length>0;let o;const a=i.href;a?o=a:s&&(o=SN);let l,c,u,h="bottom-left";const f=n.hotSpot;f?(l=[f.x,f.y],c=f.xunits,u=f.yunits,h=f.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(o)&&(o.includes("pushpin")?(l=WV,c=MT,u=CT):o.includes("arrow-reverse")?(l=[54,42],c=MT,u=CT):o.includes("paddle")&&(l=[32,1],c=MT,u=CT));let g;const v=i.x,x=i.y;v!==void 0&&x!==void 0&&(g=[v,x]);let b;const T=i.w,A=i.h;T!==void 0&&A!==void 0&&(b=[T,A]);let I;const R=n.heading;R!==void 0&&(I=Wf(R));const C=n.scale,V=n.color;if(s){o==SN&&(b=NT);const M=new TA({anchor:l,anchorOrigin:h,anchorXUnits:c,anchorYUnits:u,crossOrigin:this.crossOrigin_,offset:g,offsetOrigin:"bottom-left",rotation:I,scale:C,size:b,src:this.iconUrlFunction_(o),color:V}),N=M.getScaleArray()[0],O=M.getSize();if(O===null){const F=M.getImageState();if(F===Vt.IDLE||F===Vt.LOADING){const L=function(){const B=M.getImageState();if(!(B===Vt.IDLE||B===Vt.LOADING)){const U=M.getSize();if(U&&U.length==2){const de=TN(U);M.setScale(N*de)}M.unlistenImageChange(L)}};M.listenImageChange(L),F===Vt.IDLE&&M.load()}}else if(O.length==2){const F=TN(O);M.setScale(N*F)}r.imageStyle=M}else r.imageStyle=bH}const l0t=kt(Xt,{color:Qe(eL),scale:Qe(n2e)});function c0t(t,e){const n=tr({},l0t,t,e);if(!n)return;const r=e[e.length-1],i=new th({fill:new Nr({color:"color"in n?n.color:lw}),scale:n.scale});r.textStyle=i}const u0t=kt(Xt,{color:Qe(eL),width:Qe(gr)});function h0t(t,e){const n=tr({},u0t,t,e);if(!n)return;const r=e[e.length-1],i=new Sr({color:"color"in n?n.color:lw,width:"width"in n?n.width:1});r.strokeStyle=i}const d0t=kt(Xt,{color:Qe(eL),fill:Qe(Gg),outline:Qe(Gg)});function f0t(t,e){const n=tr({},d0t,t,e);if(!n)return;const r=e[e.length-1],i=new Nr({color:"color"in n?n.color:lw});r.fillStyle=i;const s=n.fill;s!==void 0&&(r.fill=s);const o=n.outline;o!==void 0&&(r.outline=o)}const p0t=kt(Xt,{coordinates:yH(Qwe)});function i2e(t,e){return tr(null,p0t,t,e)}function m0t(t,e){const r=e[e.length-1].coordinates,i=ph(t,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(o){const a=parseFloat(o[1]),l=parseFloat(o[2]),c=parseFloat(o[3]);r.push([a,l,c])}else r.push([])}const g0t=kt(Ep,{Track:qu(s2e)});function y0t(t,e){const n=tr([],g0t,t,e);if(n)return new np(n)}const v0t=kt(Xt,{when:G0t},kt(Ep,{coord:m0t}));function s2e(t,e){const n=tr({coordinates:[],whens:[]},v0t,t,e);if(!n)return;const r=[],i=n.coordinates,s=n.whens;for(let o=0,a=Math.min(i.length,s.length);o<a;++o)i[o].length==3&&r.push(i[o][0],i[o][1],i[o][2],s[o]);return new ro(r,"XYZM")}const _0t=kt(Xt,{href:Qe(e2e)},kt(Ep,{x:Qe(gr),y:Qe(gr),w:Qe(gr),h:Qe(gr)}));function x0t(t,e){const n=tr({},_0t,t,e);return n||null}const w0t=kt(Xt,{coordinates:yH(Qwe)});function EH(t,e){return tr(null,w0t,t,e)}const tL=kt(Xt,{extrude:Qe(Gg),tessellate:Qe(Gg),altitudeMode:Qe(Vn)});function o2e(t,e){const n=tr({},tL,t,e),r=EH(t,e);if(r){const i=new ro(r,"XYZ");return i.setProperties(n,!0),i}}function a2e(t,e){const n=tr({},tL,t,e),r=EH(t,e);if(r){const i=new ou(r,"XYZ",[r.length]);return i.setProperties(n,!0),i}}const b0t=kt(Xt,{LineString:qu(o2e),LinearRing:qu(a2e),MultiGeometry:qu(l2e),Point:qu(c2e),Polygon:qu(u2e)});function l2e(t,e){const n=tr([],b0t,t,e);if(!n)return null;if(n.length===0)return new eh(n);let r,i=!0;const s=n[0].getType();let o;for(let a=1,l=n.length;a<l;++a)if(o=n[a],o.getType()!=s){i=!1;break}if(i){let a,l;if(s=="Point"){const c=n[0];a=c.getLayout(),l=c.getFlatCoordinates();for(let u=1,h=n.length;u<h;++u)o=n[u],Rr(l,o.getFlatCoordinates());r=new X1(l,a),S8(r,n)}else if(s=="LineString")r=new np(n),S8(r,n);else if(s=="Polygon")r=new p1(n),S8(r,n);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new eh(n);else throw new Error("Unknown geometry type found")}else r=new eh(n);return r}function c2e(t,e){const n=tr({},tL,t,e),r=EH(t,e);if(r){const i=new Vs(r,"XYZ");return i.setProperties(n,!0),i}}const E0t=kt(Xt,{innerBoundaryIs:F0t,outerBoundaryIs:z0t});function u2e(t,e){const n=tr({},tL,t,e),r=tr([null],E0t,t,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let a=1,l=r.length;a<l;++a)Rr(i,r[a]),s.push(i.length);const o=new ou(i,"XYZ",s);return o.setProperties(n,!0),o}}const S0t=kt(Xt,{IconStyle:a0t,LabelStyle:c0t,LineStyle:h0t,PolyStyle:f0t});function SH(t,e){const n=tr({},S0t,t,e,this);if(!n)return null;let r="fillStyle"in n?n.fillStyle:XC;const i=n.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in n?n.imageStyle!=bH&&(s=n.imageStyle):s=HV;const o="textStyle"in n?n.textStyle:$y,a="strokeStyle"in n?n.strokeStyle:qV,l=n.outline;return l!==void 0&&!l?[new zn({geometry:function(c){const u=c.getGeometry(),h=u.getType();if(h==="GeometryCollection"){const f=u;return new eh(f.getGeometriesArrayRecursive().filter(function(g){const v=g.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(h!=="Polygon"&&h!=="MultiPolygon")return u},fill:r,image:s,stroke:a,text:o,zIndex:void 0}),new zn({geometry:function(c){const u=c.getGeometry(),h=u.getType();if(h==="GeometryCollection"){const f=u;return new eh(f.getGeometriesArrayRecursive().filter(function(g){const v=g.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(h==="Polygon"||h==="MultiPolygon")return u},fill:r,stroke:null,zIndex:void 0})]:[new zn({fill:r,image:s,stroke:a,text:o,zIndex:void 0})]}function S8(t,e){const n=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let o,a,l;o=!1,a=!1,l=!1;for(let c=0;c<n;++c){const u=e[c];r[c]=u.get("extrude"),i[c]=u.get("tessellate"),s[c]=u.get("altitudeMode"),o=o||r[c]!==void 0,a=a||i[c]!==void 0,l=l||s[c]}o&&t.set("extrude",r),a&&t.set("tessellate",i),l&&t.set("altitudeMode",s)}const T0t=kt(Xt,{displayName:Qe(Vn),value:Qe(Vn)});function k0t(t,e){const n=t.getAttribute("name");t0(T0t,t,e);const r=e[e.length-1];n&&r.displayName?r[n]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:n!==null?r[n]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const A0t=kt(Xt,{Data:k0t,SchemaData:C0t});function h2e(t,e){t0(A0t,t,e)}function d2e(t,e){t0(Zwe,t,e)}const I0t=kt(Xt,{Style:Qe(SH),key:Qe(Vn),styleUrl:Qe(t2e)});function R0t(t,e){const n=tr({},I0t,t,e,this);if(!n)return;const r=n.key;if(r&&r=="normal"){const i=n.styleUrl;i&&(e[e.length-1]=i);const s=n.Style;s&&(e[e.length-1]=s)}}function P0t(t,e){const n=r2e.call(this,t,e);if(!n)return;const r=e[e.length-1];if(Array.isArray(n))r.Style=n;else if(typeof n=="string")r.styleUrl=n;else throw new Error("`styleMapValue` has an unknown type")}const M0t=kt(Xt,{SimpleData:N0t});function C0t(t,e){t0(M0t,t,e)}function N0t(t,e){const n=t.getAttribute("name");if(n!==null){const r=Vn(t),i=e[e.length-1];i[n]=r}}const O0t=kt(Xt,{altitudeMode:Qe(Vn),minAltitude:Qe(gr),maxAltitude:Qe(gr),north:Qe(gr),south:Qe(gr),east:Qe(gr),west:Qe(gr)});function L0t(t,e){const n=tr({},O0t,t,e);if(!n)return;const r=e[e.length-1],i=[parseFloat(n.west),parseFloat(n.south),parseFloat(n.east),parseFloat(n.north)];r.extent=i,r.altitudeMode=n.altitudeMode,r.minAltitude=parseFloat(n.minAltitude),r.maxAltitude=parseFloat(n.maxAltitude)}const D0t=kt(Xt,{minLodPixels:Qe(gr),maxLodPixels:Qe(gr),minFadeExtent:Qe(gr),maxFadeExtent:Qe(gr)});function $0t(t,e){const n=tr({},D0t,t,e);if(!n)return;const r=e[e.length-1];r.minLodPixels=parseFloat(n.minLodPixels),r.maxLodPixels=parseFloat(n.maxLodPixels),r.minFadeExtent=parseFloat(n.minFadeExtent),r.maxFadeExtent=parseFloat(n.maxFadeExtent)}const j0t=kt(Xt,{LinearRing:qu(i2e)});function F0t(t,e){const n=tr([],j0t,t,e);n.length>0&&e[e.length-1].push(...n)}const V0t=kt(Xt,{LinearRing:yH(i2e)});function z0t(t,e){const n=tr(void 0,V0t,t,e);if(n){const r=e[e.length-1];r[0]=n}}function U0t(t,e){t0(Ygt,t,e)}function G0t(t,e){const r=e[e.length-1].whens,i=ph(t,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function nL(t,e){const n=su(e),i=[(n.length==4?n[3]:1)*255,n[2],n[1],n[0]];for(let s=0;s<4;++s){const o=Math.floor(i[s]).toString(16);i[s]=o.length==1?"0"+o:o}br(t,i.join(""))}function B0t(t,e,n){const r=n[n.length-1],i=r.layout,s=r.stride;let o;if(i=="XY"||i=="XYM")o=2;else if(i=="XYZ"||i=="XYZM")o=3;else throw new Error("Invalid geometry layout");const a=e.length;let l="";if(a>0){l+=e[0];for(let c=1;c<o;++c)l+=","+e[c];for(let c=s;c<a;c+=s){l+=" "+e[c];for(let u=1;u<o;++u)l+=","+e[c+u]}}br(t,l)}const ZC=kt(Xt,{Data:pt(W0t),value:pt(q0t),displayName:pt(H0t)});function W0t(t,e,n){t.setAttribute("name",e.name);const r={node:t},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&ei(r,ZC,pa,[i.displayName],n,["displayName"]),i!==null&&i.value&&ei(r,ZC,pa,[i.value],n,["value"])):ei(r,ZC,pa,[i],n,["value"])}function H0t(t,e){br(t,e)}function q0t(t,e){br(t,e)}const K0t=kt(Xt,{Placemark:pt(m2e)}),Y0t=function(t,e,n){const r=e[e.length-1].node;return uv(r.namespaceURI,"Placemark")};function X0t(t,e,n){ei({node:t},K0t,Y0t,e,n,void 0,this)}const Z0t=mh("Data");function J0t(t,e,n){const r={node:t},i=e.names,s=e.values,o=i.length;for(let a=0;a<o;a++)ei(r,ZC,Z0t,[{name:i[a],value:s[a]}],n)}const Rse=kt(Xt,["href"],kt(Ep,["x","y","w","h"])),Pse=kt(Xt,{href:pt(br)},kt(Ep,{x:pt(al),y:pt(al),w:pt(al),h:pt(al)})),Q0t=function(t,e,n){return uv(Ep[0],"gx:"+n)};function eyt(t,e,n){const r={node:t},i=n[n.length-1].node;let s=Rse[i.namespaceURI],o=El(e,s);ei(r,Pse,pa,o,n,s),s=Rse[Ep[0]],o=El(e,s),ei(r,Pse,Q0t,o,n,s)}const tyt=kt(Xt,["scale","heading","Icon","color","hotSpot"]),nyt=kt(Xt,{Icon:pt(eyt),color:pt(nL),heading:pt(al),hotSpot:pt(Ryt),scale:pt(y2e)});function ryt(t,e,n){const r={node:t},i={},s=e.getSrc(),o=e.getSize(),a=e.getImageSize(),l={href:s};if(o){l.w=o[0],l.h=o[1];const b=e.getAnchor(),T=e.getOrigin();if(T&&a&&T[0]!==0&&T[1]!==o[1]&&(l.x=T[0],l.y=a[1]-(T[1]+o[1])),b&&(b[0]!==o[0]/2||b[1]!==o[1]/2)){const A={x:b[0],xunits:"pixels",y:o[1]-b[1],yunits:"pixels"};i.hotSpot=A}}i.Icon=l;let c=e.getScaleArray()[0],u=o;if(u===null&&(u=NT),u.length==2){const b=TN(u);c=c/b}c!==1&&(i.scale=c);const h=e.getRotation();h!==0&&(i.heading=h);const f=e.getColor();f&&(i.color=f);const g=n[n.length-1].node,v=tyt[g.namespaceURI],x=El(i,v);ei(r,nyt,pa,x,n,v)}const iyt=kt(Xt,["color","scale"]),syt=kt(Xt,{color:pt(nL),scale:pt(y2e)});function oyt(t,e,n){const r={node:t},i={},s=e.getFill();s&&(i.color=s.getColor());const o=e.getScale();o&&o!==1&&(i.scale=o);const a=n[n.length-1].node,l=iyt[a.namespaceURI],c=El(i,l);ei(r,syt,pa,c,n,l)}const ayt=kt(Xt,["color","width"]),lyt=kt(Xt,{color:pt(nL),width:pt(al)});function cyt(t,e,n){const r={node:t},i={color:e.getColor(),width:Number(e.getWidth())||1},s=n[n.length-1].node,o=ayt[s.namespaceURI],a=El(i,o);ei(r,lyt,pa,a,n,o)}const uyt={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},f2e=function(t,e,n){if(t){const r=e[e.length-1].node;return uv(r.namespaceURI,uyt[t.getType()])}},hyt=mh("Point"),dyt=mh("LineString"),fyt=mh("LinearRing"),pyt=mh("Polygon"),myt=kt(Xt,{LineString:pt(cw),Point:pt(cw),Polygon:pt(g2e),GeometryCollection:pt(p2e)});function p2e(t,e,n){const r={node:t},i=e.getType();let s=[],o;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(a){const l=a.getType();if(l==="MultiPoint")s=s.concat(a.getPoints());else if(l==="MultiLineString")s=s.concat(a.getLineStrings());else if(l==="MultiPolygon")s=s.concat(a.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(a);else throw new Error("Unknown geometry type")}),o=f2e;else if(i==="MultiPoint")s=e.getPoints(),o=hyt;else if(i==="MultiLineString")s=e.getLineStrings(),o=dyt;else if(i==="MultiPolygon")s=e.getPolygons(),o=pyt;else throw new Error("Unknown geometry type");ei(r,myt,o,s,n)}const gyt=kt(Xt,{LinearRing:pt(cw)});function Mse(t,e,n){ei({node:t},gyt,fyt,[e],n)}const T8=kt(Xt,{ExtendedData:pt(J0t),MultiGeometry:pt(p2e),LineString:pt(cw),LinearRing:pt(cw),Point:pt(cw),Polygon:pt(g2e),Style:pt(Iyt),address:pt(br),description:pt(br),name:pt(br),open:pt(I2),phoneNumber:pt(br),styleUrl:pt(br),visibility:pt(I2)}),yyt=kt(Xt,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),vyt=mh("ExtendedData");function m2e(t,e,n){const r={node:t};e.getId()&&t.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const o=Object.keys(i||{}).sort().filter(function(g){return!s[g]}),a=e.getStyleFunction();if(a){const g=a(e,0);if(g){const v=Array.isArray(g)?g:[g];let x=v;if(e.getGeometry()&&(x=v.filter(function(b){const T=b.getGeometryFunction()(e);if(T){const A=T.getType();return A==="GeometryCollection"?T.getGeometriesArrayRecursive().filter(function(I){const R=I.getType();return R==="Point"||R==="MultiPoint"}).length:A==="Point"||A==="MultiPoint"}})),this.writeStyles_){let b=v,T=v;e.getGeometry()&&(b=v.filter(function(A){const I=A.getGeometryFunction()(e);if(I){const R=I.getType();return R==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(C){const V=C.getType();return V==="LineString"||V==="MultiLineString"}).length:R==="LineString"||R==="MultiLineString"}}),T=v.filter(function(A){const I=A.getGeometryFunction()(e);if(I){const R=I.getType();return R==="GeometryCollection"?I.getGeometriesArrayRecursive().filter(function(C){const V=C.getType();return V==="Polygon"||V==="MultiPolygon"}).length:R==="Polygon"||R==="MultiPolygon"}})),i.Style={pointStyles:x,lineStyles:b,polyStyles:T}}if(x.length&&i.name===void 0){const b=x[0].getText();b&&(i.name=b.getText())}}}const l=n[n.length-1].node,c=yyt[l.namespaceURI],u=El(i,c);if(ei(r,T8,pa,u,n,c),o.length>0){const g=El(i,o);ei(r,T8,vyt,[{names:o,values:g}],n)}const h=n[0];let f=e.getGeometry();f&&(f=fh(f,!0,h)),ei(r,T8,f2e,[f],n)}const _yt=kt(Xt,["extrude","tessellate","altitudeMode","coordinates"]),xyt=kt(Xt,{extrude:pt(I2),tessellate:pt(I2),altitudeMode:pt(br),coordinates:pt(B0t)});function cw(t,e,n){const r=e.getFlatCoordinates(),i={node:t};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const o=n[n.length-1].node,a=_yt[o.namespaceURI],l=El(s,a);ei(i,xyt,pa,l,n,a)}const wyt=kt(Xt,["color","fill","outline"]),Cse=kt(Xt,{outerBoundaryIs:pt(Mse),innerBoundaryIs:pt(Mse)}),byt=mh("innerBoundaryIs"),Eyt=mh("outerBoundaryIs");function g2e(t,e,n){const r=e.getLinearRings(),i=r.shift(),s={node:t};ei(s,Cse,byt,r,n),ei(s,Cse,Eyt,[i],n)}const Syt=kt(Xt,{color:pt(nL),fill:pt(I2),outline:pt(I2)});function Tyt(t,e,n){const r={node:t},i=e.getFill(),s=e.getStroke(),o={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},a=n[n.length-1].node,l=wyt[a.namespaceURI],c=El(o,l);ei(r,Syt,pa,c,n,l)}function y2e(t,e){al(t,Math.round(e*1e6)/1e6)}const kyt=kt(Xt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Ayt=kt(Xt,{IconStyle:pt(ryt),LabelStyle:pt(oyt),LineStyle:pt(cyt),PolyStyle:pt(Tyt)});function Iyt(t,e,n){const r={node:t},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=n[n.length-1].node,o=kyt[s.namespaceURI],a=El(i,o);ei(r,Ayt,pa,a,n,o)}function Ryt(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)}function v2e(t){const e=Object.keys(t.defs),n=e.length;let r,i;for(r=0;r<n;++r){const s=e[r];if(!vM(s)){const o=t.defs(s);let a=o.units;!a&&o.projName==="longlat"&&(a="degrees"),i3(new KN({code:s,axisOrientation:o.axis,metersPerUnit:o.to_meter,units:a}))}}for(r=0;r<n;++r){const s=e[r],o=vM(s);for(i=0;i<n;++i){const a=e[i],l=vM(a);if(!_M(s,a))if(t.defs[s]===t.defs[a])K8([o,l]);else{const c=t(s,a);pTe(o,l,kY(o,l,c.forward),kY(l,o,c.inverse))}}}}console.log(" parcelHighlight.ts v3.1 loaded - fixed pixelRatio for Android");ir.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");v2e(ir);let jy=null,OT=null,cx=null;function XV(t){jy&&(t.removeLayer(jy),jy=null),OT&&(t.removeLayer(OT),OT=null),cx=null}async function Pyt(t,e){try{const n=Zn(e);console.log(` Click (3857): ${e[0].toFixed(0)}, ${e[1].toFixed(0)}`),console.log(` LonLat (WGS84): ${n[0].toFixed(5)}, ${n[1].toFixed(5)}`);const r=ir("EPSG:4326","EPSG:28992",n);if(console.log(` RD (28992): ${r?r[0].toFixed(0)+", "+r[1].toFixed(0):"FAILED"}`),!r||r[0]<7e3||r[0]>3e5||r[1]<289e3||r[1]>629e3)return console.error(" Coordinate outside Netherlands or transformation failed:",r),!1;XV(t);const i=1,s=`${r[0]-i},${r[1]-i},${r[0]+i},${r[1]+i}`,o=Date.now(),a=`https://service.pdok.nl/rvo/brpgewaspercelen/wfs/v1_0?SERVICE=WFS&VERSION=2.0.0&REQUEST=GetFeature&TYPENAMES=brpgewaspercelen:BrpGewas&OUTPUTFORMAT=json&SRSNAME=EPSG:28992&BBOX=${s},EPSG:28992&_=${o}`;console.log(" WFS URL:",a);const l=new AbortController,c=setTimeout(()=>l.abort(),1e4),u=await fetch(a,{signal:l.signal});if(clearTimeout(c),!u.ok)return console.error("WFS request failed:",u.status),!1;const h=await u.json();if(console.log(" WFS RESPONSE:",JSON.stringify(h).substring(0,500)),!h.features||h.features.length===0)return console.log("No parcel found at location"),!1;const f=h.features[0];console.log(" PARCEL ID:",f.id||f.properties?.id||"geen ID"),console.log(" PARCEL BBOX:",JSON.stringify(f.bbox||"geen bbox"));const v=new ZO().readFeature(f,{dataProjection:"EPSG:28992",featureProjection:"EPSG:3857"}),x=v.getGeometry();if(!x)return console.log("No geometry in parcel feature"),!1;const b=f.properties||{};console.log(` Parcel: ${b.category||"unknown"} - ${b.gewasnaam||b.gewas||"geen gewas"}`),console.log(` Geometry type: ${x.getType()}, extent: ${x.getExtent().map(O=>O.toFixed(0)).join(", ")}`);const T=x.getExtent(),A=T[2]-T[0],I=T[3]-T[1],R=Math.max(A,I)*.05,C=[T[0]-R,T[1]-R,T[2]+R,T[3]+R],V=Math.max(A,I)*.3,M=[T[0]-V,T[1]-V,T[2]+V,T[3]+V];cx=x,jy=new tRe({source:new IRe({url:"https://ahn.arcgisonline.nl/arcgis/rest/services/Hoogtebestand/AHN4_DTM_50cm/ImageServer",params:{renderingRule:JSON.stringify({rasterFunction:"AHN - Color Ramp D"})},crossOrigin:"anonymous"}),extent:C,zIndex:998}),jy.on("prerender",O=>{if(!cx)return;const F=O.context;if(!F)return;const L=O.frameState;if(!L)return;F.save(),F.beginPath(),(cx.getType()==="Polygon"?cx.getCoordinates()[0]:cx.getCoordinates()[0][0]).forEach((U,de)=>{const me=t.getPixelFromCoordinate(U);if(!me)return;const ze=L.pixelRatio,Le=me[0]*ze,fe=me[1]*ze;de===0?F.moveTo(Le,fe):F.lineTo(Le,fe)}),F.closePath(),F.clip()}),jy.on("postrender",O=>{const F=O.context;F&&F.restore()}),t.addLayer(jy);const N=new Nd({features:[v]});return OT=new gp({source:N,style:new zn({fill:new Nr({color:"rgba(0, 0, 0, 0)"}),stroke:new Sr({color:"#dc2626",width:3})}),zIndex:999}),t.addLayer(OT),console.log(" Parcel height map displayed"),!0}catch(n){return console.error("Failed to show parcel height map:",n),!1}}var kN={};kN.version="0.18.5";var _2e=1252,Myt=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],x2e=function(t){Myt.indexOf(t)!=-1&&(_2e=t)};function Cyt(){x2e(1252)}var sA=function(t){x2e(t)};function Nyt(){sA(1200),Cyt()}var lM=function(e){return String.fromCharCode(e)},Nse=function(e){return String.fromCharCode(e)},AN,rg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function oA(t){for(var e="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,c=0;c<t.length;)n=t.charCodeAt(c++),s=n>>2,r=t.charCodeAt(c++),o=(n&3)<<4|r>>4,i=t.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),e+=rg.charAt(s)+rg.charAt(o)+rg.charAt(a)+rg.charAt(l);return e}function dp(t){var e="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=rg.indexOf(t.charAt(c++)),o=rg.indexOf(t.charAt(c++)),n=s<<2|o>>4,e+=String.fromCharCode(n),a=rg.indexOf(t.charAt(c++)),r=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=rg.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var wr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Sp=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function G1(t){return wr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ose(t){return wr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ku=function(e){return wr?Sp(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function rL(t){if(typeof ArrayBuffer>"u")return Ku(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function OI(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function Oyt(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Io=wr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Sp(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),i=0;for(e=0,n=0;e<t.length;n+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Lyt(t){for(var e=[],n=0,r=t.length+250,i=G1(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(e.push(i.slice(0,n)),n=0,i=G1(65535),r=65530)}return e.push(i.slice(0,n)),Io(e)}var LT=/\u0000/g,cM=/[\u0001-\u0006]/g;function uw(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function Qu(t,e){var n=""+t;return n.length>=e?n:Yi("0",e-n.length)+n}function TH(t,e){var n=""+t;return n.length>=e?n:Yi(" ",e-n.length)+n}function IN(t,e){var n=""+t;return n.length>=e?n:n+Yi(" ",e-n.length)}function Dyt(t,e){var n=""+Math.round(t);return n.length>=e?n:Yi("0",e-n.length)+n}function $yt(t,e){var n=""+t;return n.length>=e?n:Yi("0",e-n.length)+n}var Lse=Math.pow(2,32);function S_(t,e){if(t>Lse||t<-Lse)return Dyt(t,e);var n=Math.round(t);return $yt(n,e)}function RN(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Dse=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],k8=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jyt(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Qi={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},$se={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Fyt={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function PN(t,e,n){for(var r=t<0?-1:1,i=t*r,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=s):(u=c,a=o)),!n)return[0,r*a,u];var f=Math.floor(r*a/u);return[f,r*a-f*u,u]}function uM(t,e,n){if(t>2958465||t<0)return null;var r=t|0,i=Math.floor(86400*(t-r)),s=0,o=[],a={D:r,T:i,u:86400*(t-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=Hyt(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var w2e=new Date(1899,11,31,0,0,0),Vyt=w2e.getTime(),zyt=new Date(1900,2,1,0,0,0);function b2e(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=zyt&&(n+=1440*60*1e3),(n-(Vyt+(t.getTimezoneOffset()-w2e.getTimezoneOffset())*6e4))/(1440*60*1e3)}function kH(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Uyt(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Gyt(t){var e=t<0?12:11,n=kH(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function Byt(t){var e=kH(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Wyt(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=Gyt(t):e===10?n=t.toFixed(10).substr(0,12):n=Byt(t),kH(Uyt(n.toUpperCase()))}function ZV(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Wyt(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Bg(14,b2e(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Hyt(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function qyt(t,e,n,r){var i="",s=0,o=0,a=n.y,l,c=0;switch(t){case 98:a=n.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=n.m,c=e.length;break;case 3:return k8[n.m-1][1];case 5:return k8[n.m-1][0];default:return k8[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=n.d,c=e.length;break;case 3:return Dse[n.q][0];default:return Dse[n.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(n.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=n.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=n.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?Qu(n.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=Qu(s,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Qu(l,c):"";return u}function ig(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var E2e=/%/g;function Kyt(t,e,n){var r=e.replace(E2e,""),i=e.length-r.length;return Qf(t,r,n*Math.pow(10,2*i))+Yi("%",i)}function Yyt(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Qf(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function S2e(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+S2e(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var T2e=/# (\?+)( ?)\/( ?)(\d+)/;function Xyt(t,e,n){var r=parseInt(t[4],10),i=Math.round(e*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?Yi(" ",t[1].length+1+t[4].length):TH(o,t[1].length)+t[2]+"/"+t[3]+Qu(a,t[4].length))}function Zyt(t,e,n){return n+(e===0?"":""+e)+Yi(" ",t[1].length+2+t[4].length)}var k2e=/^#*0*\.([0#]+)/,A2e=/\).*[0#]/,I2e=/\(###\) ###\\?-####/;function Ta(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function jse(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function Fse(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Jyt(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Qyt(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Nc(t,e,n){if(t.charCodeAt(0)===40&&!e.match(A2e)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Nc("n",r,n):"("+Nc("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return Yyt(t,e,n);if(e.indexOf("%")!==-1)return Kyt(t,e,n);if(e.indexOf("E")!==-1)return S2e(e,n);if(e.charCodeAt(0)===36)return"$"+Nc(t,e.substr(e.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+S_(l,e.length);if(e.match(/^[#?]+$/))return i=S_(n,0),i==="0"&&(i=""),i.length>e.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(T2e))return Xyt(s,l,c);if(e.match(/^#+0+$/))return c+S_(l,e.length-e.indexOf("0"));if(s=e.match(k2e))return i=jse(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Ta(s[1])).replace(/\.$/,"."+Ta(s[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+Yi("0",Ta(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+jse(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ig(S_(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Nc(t,e,-n):ig(""+(Math.floor(n)+Jyt(n,s[1].length)))+"."+Qu(Fse(n,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Nc(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=uw(Nc(t,e.replace(/[\\-]/g,""),n)),o=0,uw(uw(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(e.match(I2e))return i=Nc(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=PN(l,Math.pow(10,o)-1,!1),i=""+c,u=Qf("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=IN(a[2],o),u.length<s[4].length&&(u=Ta(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=PN(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?TH(a[1],o)+s[2]+"/"+s[3]+IN(a[2],o):Yi(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=S_(n,0),e.length<=i.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ta(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=Fse(n,s[1].length),n<0?"-"+Nc(t,e,-n):ig(Qyt(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Qu(0,3-v.length):"")+v})+"."+Qu(o,s[1].length);switch(e){case"###,##0.00":return Nc(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var g=ig(S_(l,0));return g!=="0"?c+g:"";case"###,###.00":return Nc(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Nc(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function e1t(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Qf(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function t1t(t,e,n){var r=e.replace(E2e,""),i=e.length-r.length;return Qf(t,r,n*Math.pow(10,2*i))+Yi("%",i)}function R2e(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+R2e(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(e/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bh(t,e,n){if(t.charCodeAt(0)===40&&!e.match(A2e)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bh("n",r,n):"("+Bh("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return e1t(t,e,n);if(e.indexOf("%")!==-1)return t1t(t,e,n);if(e.indexOf("E")!==-1)return R2e(e,n);if(e.charCodeAt(0)===36)return"$"+Bh(t,e.substr(e.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+Qu(l,e.length);if(e.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>e.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(T2e))return Zyt(s,l,c);if(e.match(/^#+0+$/))return c+Qu(l,e.length-e.indexOf("0"));if(s=e.match(k2e))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Ta(s[1])).replace(/\.$/,"."+Ta(s[1])),i=i.replace(/\.(\d*)$/,function(v,x){return"."+x+Yi("0",Ta(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ig(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bh(t,e,-n):ig(""+n)+"."+Yi("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Bh(t,e.replace(/^#,#*,/,""),n);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=uw(Bh(t,e.replace(/[\\-]/g,""),n)),o=0,uw(uw(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return o<i.length?i.charAt(o++):v==="0"?"0":""}));if(e.match(I2e))return i=Bh(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=PN(l,Math.pow(10,o)-1,!1),i=""+c,u=Qf("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=IN(a[2],o),u.length<s[4].length&&(u=Ta(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=PN(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?TH(a[1],o)+s[2]+"/"+s[3]+IN(a[2],o):Yi(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+n,e.length<=i.length?i:Ta(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,f=e.length-i.length-h;return Ta(e.substr(0,h)+i+e.substr(e.length-f))}if(s=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bh(t,e,-n):ig(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Qu(0,3-v.length):"")+v})+"."+Qu(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var g=ig(""+l);return g!=="0"?c+g:"";default:if(e.match(/\.[0#?]*$/))return Bh(t,e.slice(0,e.lastIndexOf(".")),n)+Ta(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qf(t,e,n){return(n|0)===n?Bh(t,e,n):Nc(t,e,n)}function n1t(t){for(var e=[],n=!1,r=0,i=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(i,r-i),i=r+1}if(e[e.length]=t.substr(i),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var P2e=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function M2e(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":RN(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(P2e))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function r1t(t,e,n,r){for(var i=[],s="",o=0,a="",l="t",c,u,h,f="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!RN(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var g=t.charAt(++o),v=g==="("||g===")"?g:"t";i[i.length]={t:v,v:g},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(c==null&&(c=uM(e,n,t.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=uM(e,n),c==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var x={t:a,v:a};if(c==null&&(c=uM(e,n)),t.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",f="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",o+=5,f="h"):t.substr(o,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",o+=5,f="h"):(x.t="t",++o),c==null&&x.t==="T")return"";i[i.length]=x,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(P2e)){if(c==null&&(c=uM(e,n),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",M2e(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var b=0,T=0,A;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",b<1&&(b=1);break;case"s":(A=i[o].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var I="",R;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=qyt(i[o].t.charCodeAt(0),i[o].v,c,T),i[o].t="t";break;case"n":case"?":for(R=o+1;i[R]!=null&&((a=i[R].t)==="?"||a==="D"||(a===" "||a==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[o].v+=i[R].v,i[R]={v:"",t:";"},++R;I+=i[o].v,o=R-1;break;case"G":i[o].t="t",i[o].v=ZV(e,n);break}var C="",V,M;if(I.length>0){I.charCodeAt(0)==40?(V=e<0&&I.charCodeAt(0)===45?-e:e,M=Qf("n",I,V)):(V=e<0&&r>1?-e:e,M=Qf("n",I,V),V<0&&i[0]&&i[0].t=="t"&&(M=M.substr(1),i[0].v="-"+i[0].v)),R=M.length-1;var N=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){N=o;break}var O=i.length;if(N===i.length&&M.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(R>=i[o].v.length-1?(R-=i[o].v.length,i[o].v=M.substr(R+1,i[o].v.length)):R<0?i[o].v="":(i[o].v=M.substr(0,R+1),R=-1),i[o].t="t",O=o);R>=0&&O<i.length&&(i[O].v=M.substr(0,R+1)+i[O].v)}else if(N!==i.length&&M.indexOf("E")===-1){for(R=M.indexOf(".")-1,o=N;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===N?i[o].v.indexOf(".")-1:i[o].v.length-1,C=i[o].v.substr(u+1);u>=0;--u)R>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(C=M.charAt(R--)+C);i[o].v=C,i[o].t="t",O=o}for(R>=0&&O<i.length&&(i[O].v=M.substr(0,R+1)+i[O].v),R=M.indexOf(".")+1,o=N;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==N)){for(u=i[o].v.indexOf(".")>-1&&o===N?i[o].v.indexOf(".")+1:0,C=i[o].v.substr(0,u);u<i[o].v.length;++u)R<M.length&&(C+=M.charAt(R++));i[o].v=C,i[o].t="t",O=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(V=r>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Qf(i[o].t,i[o].v,V),i[o].t="t");var F="";for(o=0;o!==i.length;++o)i[o]!=null&&(F+=i[o].v);return F}var Vse=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zse(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function i1t(t,e){var n=n1t(t),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Vse),a=n[1].match(Vse);return zse(e,o)?[r,n[0]]:zse(e,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function Bg(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:Qi)[t],r==null&&(r=n.table&&n.table[$se[t]]||Qi[$se[t]]),r==null&&(r=Fyt[t]||"General");break}if(RN(r,0))return ZV(e,n);e instanceof Date&&(e=b2e(e,n.date1904));var i=i1t(r,e);if(RN(i[1]))return ZV(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return r1t(i[1],e,n,i[0])}function C2e(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(Qi[n]==null){e<0&&(e=n);continue}if(Qi[n]==t){e=n;break}}e<0&&(e=391)}return Qi[e]=t,e}function iL(t){for(var e=0;e!=392;++e)t[e]!==void 0&&C2e(t[e],e)}function sL(){Qi=jyt()}var N2e=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function s1t(t){var e=typeof t=="number"?Qi[t]:t;return e=e.replace(N2e,"(\\d+)"),new RegExp("^"+e+"$")}function o1t(t,e,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(N2e)||[]).forEach(function(h,f){var g=parseInt(n[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=g;break;case"d":s=g;break;case"h":o=g;break;case"s":l=g;break;case"m":o>=0?a=g:i=g;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&s==-1?u:c+"T"+u}var a1t=(function(){var t={};t.version="1.2.0";function e(){for(var M=0,N=new Array(256),O=0;O!=256;++O)M=O,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,N[O]=M;return typeof Int32Array<"u"?new Int32Array(N):N}var n=e();function r(M){var N=0,O=0,F=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)L[F]=M[F];for(F=0;F!=256;++F)for(O=M[F],N=256+F;N<4096;N+=256)O=L[N]=O>>>8^M[O&255];var B=[];for(F=1;F!=16;++F)B[F-1]=typeof Int32Array<"u"?L.subarray(F*256,F*256+256):L.slice(F*256,F*256+256);return B}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],f=i[7],g=i[8],v=i[9],x=i[10],b=i[11],T=i[12],A=i[13],I=i[14];function R(M,N){for(var O=N^-1,F=0,L=M.length;F<L;)O=O>>>8^n[(O^M.charCodeAt(F++))&255];return~O}function C(M,N){for(var O=N^-1,F=M.length-15,L=0;L<F;)O=I[M[L++]^O&255]^A[M[L++]^O>>8&255]^T[M[L++]^O>>16&255]^b[M[L++]^O>>>24]^x[M[L++]]^v[M[L++]]^g[M[L++]]^f[M[L++]]^h[M[L++]]^u[M[L++]]^c[M[L++]]^l[M[L++]]^a[M[L++]]^o[M[L++]]^s[M[L++]]^n[M[L++]];for(F+=15;L<F;)O=O>>>8^n[(O^M[L++])&255];return~O}function V(M,N){for(var O=N^-1,F=0,L=M.length,B=0,U=0;F<L;)B=M.charCodeAt(F++),B<128?O=O>>>8^n[(O^B)&255]:B<2048?(O=O>>>8^n[(O^(192|B>>6&31))&255],O=O>>>8^n[(O^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,U=M.charCodeAt(F++)&1023,O=O>>>8^n[(O^(240|B>>8&7))&255],O=O>>>8^n[(O^(128|B>>2&63))&255],O=O>>>8^n[(O^(128|U>>6&15|(B&3)<<4))&255],O=O>>>8^n[(O^(128|U&63))&255]):(O=O>>>8^n[(O^(224|B>>12&15))&255],O=O>>>8^n[(O^(128|B>>6&63))&255],O=O>>>8^n[(O^(128|B&63))&255]);return~O}return t.table=n,t.bstr=R,t.buf=C,t.str=V,t})(),qr=(function(){var e={};e.version="1.2.1";function n(q,te){for(var J=q.split("/"),ee=te.split("/"),re=0,ie=0,Pe=Math.min(J.length,ee.length);re<Pe;++re){if(ie=J[re].length-ee[re].length)return ie;if(J[re]!=ee[re])return J[re]<ee[re]?-1:1}return J.length-ee.length}function r(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:r(q.slice(0,-1));var te=q.lastIndexOf("/");return te===-1?q:q.slice(0,te+1)}function i(q){if(q.charAt(q.length-1)=="/")return i(q.slice(0,-1));var te=q.lastIndexOf("/");return te===-1?q:q.slice(te+1)}function s(q,te){typeof te=="string"&&(te=new Date(te));var J=te.getHours();J=J<<6|te.getMinutes(),J=J<<5|te.getSeconds()>>>1,q.write_shift(2,J);var ee=te.getFullYear()-1980;ee=ee<<4|te.getMonth()+1,ee=ee<<5|te.getDate(),q.write_shift(2,ee)}function o(q){var te=q.read_shift(2)&65535,J=q.read_shift(2)&65535,ee=new Date,re=J&31;J>>>=5;var ie=J&15;J>>>=4,ee.setMilliseconds(0),ee.setFullYear(J+1980),ee.setMonth(ie-1),ee.setDate(re);var Pe=te&31;te>>>=5;var Be=te&63;return te>>>=6,ee.setHours(te),ee.setMinutes(Be),ee.setSeconds(Pe<<1),ee}function a(q){Kl(q,0);for(var te={},J=0;q.l<=q.length-4;){var ee=q.read_shift(2),re=q.read_shift(2),ie=q.l+re,Pe={};switch(ee){case 21589:J=q.read_shift(1),J&1&&(Pe.mtime=q.read_shift(4)),re>5&&(J&2&&(Pe.atime=q.read_shift(4)),J&4&&(Pe.ctime=q.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}q.l=ie,te[ee]=Pe}return te}var l;function c(){return l||(l={})}function u(q,te){if(q[0]==80&&q[1]==75)return rn(q,te);if((q[0]|32)==109&&(q[1]|32)==105)return Je(q,te);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var J=3,ee=512,re=0,ie=0,Pe=0,Be=0,Re=0,Ne=[],Oe=q.slice(0,512);Kl(Oe,0);var at=h(Oe);switch(J=at[0],J){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(at[1]==0)return rn(q,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}ee!==512&&(Oe=q.slice(0,ee),Kl(Oe,28));var gt=q.slice(0,ee);f(Oe,J);var It=Oe.read_shift(4,"i");if(J===3&&It!==0)throw new Error("# Directory Sectors: Expected 0 saw "+It);Oe.l+=4,Pe=Oe.read_shift(4,"i"),Oe.l+=4,Oe.chk("00100000","Mini Stream Cutoff Size: "),Be=Oe.read_shift(4,"i"),re=Oe.read_shift(4,"i"),Re=Oe.read_shift(4,"i"),ie=Oe.read_shift(4,"i");for(var lt=-1,ct=0;ct<109&&(lt=Oe.read_shift(4,"i"),!(lt<0));++ct)Ne[ct]=lt;var wn=g(q,ee);b(Re,ie,wn,ee,Ne);var Ar=A(wn,Pe,Ne,ee);Ar[Pe].name="!Directory",re>0&&Be!==U&&(Ar[Be].name="!MiniFAT"),Ar[Ne[0]].name="!FAT",Ar.fat_addrs=Ne,Ar.ssz=ee;var Lr={},pi=[],pu=[],mc=[];I(Pe,Ar,wn,pi,re,Lr,pu,Be),v(pu,mc,pi),pi.shift();var Il={FileIndex:pu,FullPaths:mc};return te&&te.raw&&(Il.raw={header:gt,sectors:wn}),Il}function h(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(de,"Header Signature: "),q.l+=16;var te=q.read_shift(2,"u");return[q.read_shift(2,"u"),te]}function f(q,te){var J=9;switch(q.l+=2,J=q.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function g(q,te){for(var J=Math.ceil(q.length/te)-1,ee=[],re=1;re<J;++re)ee[re-1]=q.slice(re*te,(re+1)*te);return ee[J-1]=q.slice(J*te),ee}function v(q,te,J){for(var ee=0,re=0,ie=0,Pe=0,Be=0,Re=J.length,Ne=[],Oe=[];ee<Re;++ee)Ne[ee]=Oe[ee]=ee,te[ee]=J[ee];for(;Be<Oe.length;++Be)ee=Oe[Be],re=q[ee].L,ie=q[ee].R,Pe=q[ee].C,Ne[ee]===ee&&(re!==-1&&Ne[re]!==re&&(Ne[ee]=Ne[re]),ie!==-1&&Ne[ie]!==ie&&(Ne[ee]=Ne[ie])),Pe!==-1&&(Ne[Pe]=ee),re!==-1&&ee!=Ne[ee]&&(Ne[re]=Ne[ee],Oe.lastIndexOf(re)<Be&&Oe.push(re)),ie!==-1&&ee!=Ne[ee]&&(Ne[ie]=Ne[ee],Oe.lastIndexOf(ie)<Be&&Oe.push(ie));for(ee=1;ee<Re;++ee)Ne[ee]===ee&&(ie!==-1&&Ne[ie]!==ie?Ne[ee]=Ne[ie]:re!==-1&&Ne[re]!==re&&(Ne[ee]=Ne[re]));for(ee=1;ee<Re;++ee)if(q[ee].type!==0){if(Be=ee,Be!=Ne[Be])do Be=Ne[Be],te[ee]=te[Be]+"/"+te[ee];while(Be!==0&&Ne[Be]!==-1&&Be!=Ne[Be]);Ne[ee]=-1}for(te[0]+="/",ee=1;ee<Re;++ee)q[ee].type!==2&&(te[ee]+="/")}function x(q,te,J){for(var ee=q.start,re=q.size,ie=[],Pe=ee;J&&re>0&&Pe>=0;)ie.push(te.slice(Pe*B,Pe*B+B)),re-=B,Pe=_y(J,Pe*4);return ie.length===0?Ge(0):Io(ie).slice(0,q.size)}function b(q,te,J,ee,re){var ie=U;if(q===U){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Pe=J[q],Be=(ee>>>2)-1;if(!Pe)return;for(var Re=0;Re<Be&&(ie=_y(Pe,Re*4))!==U;++Re)re.push(ie);b(_y(Pe,ee-4),te-1,J,ee,re)}}function T(q,te,J,ee,re){var ie=[],Pe=[];re||(re=[]);var Be=ee-1,Re=0,Ne=0;for(Re=te;Re>=0;){re[Re]=!0,ie[ie.length]=Re,Pe.push(q[Re]);var Oe=J[Math.floor(Re*4/ee)];if(Ne=Re*4&Be,ee<4+Ne)throw new Error("FAT boundary crossed: "+Re+" 4 "+ee);if(!q[Oe])break;Re=_y(q[Oe],Ne)}return{nodes:ie,data:Yse([Pe])}}function A(q,te,J,ee){var re=q.length,ie=[],Pe=[],Be=[],Re=[],Ne=ee-1,Oe=0,at=0,gt=0,It=0;for(Oe=0;Oe<re;++Oe)if(Be=[],gt=Oe+te,gt>=re&&(gt-=re),!Pe[gt]){Re=[];var lt=[];for(at=gt;at>=0;){lt[at]=!0,Pe[at]=!0,Be[Be.length]=at,Re.push(q[at]);var ct=J[Math.floor(at*4/ee)];if(It=at*4&Ne,ee<4+It)throw new Error("FAT boundary crossed: "+at+" 4 "+ee);if(!q[ct]||(at=_y(q[ct],It),lt[at]))break}ie[gt]={nodes:Be,data:Yse([Re])}}return ie}function I(q,te,J,ee,re,ie,Pe,Be){for(var Re=0,Ne=ee.length?2:0,Oe=te[q].data,at=0,gt=0,It;at<Oe.length;at+=128){var lt=Oe.slice(at,at+128);Kl(lt,64),gt=lt.read_shift(2),It=MH(lt,0,gt-Ne),ee.push(It);var ct={name:It,type:lt.read_shift(1),color:lt.read_shift(1),L:lt.read_shift(4,"i"),R:lt.read_shift(4,"i"),C:lt.read_shift(4,"i"),clsid:lt.read_shift(16),state:lt.read_shift(4,"i"),start:0,size:0},wn=lt.read_shift(2)+lt.read_shift(2)+lt.read_shift(2)+lt.read_shift(2);wn!==0&&(ct.ct=R(lt,lt.l-8));var Ar=lt.read_shift(2)+lt.read_shift(2)+lt.read_shift(2)+lt.read_shift(2);Ar!==0&&(ct.mt=R(lt,lt.l-8)),ct.start=lt.read_shift(4,"i"),ct.size=lt.read_shift(4,"i"),ct.size<0&&ct.start<0&&(ct.size=ct.type=0,ct.start=U,ct.name=""),ct.type===5?(Re=ct.start,re>0&&Re!==U&&(te[Re].name="!StreamData")):ct.size>=4096?(ct.storage="fat",te[ct.start]===void 0&&(te[ct.start]=T(J,ct.start,te.fat_addrs,te.ssz)),te[ct.start].name=ct.name,ct.content=te[ct.start].data.slice(0,ct.size)):(ct.storage="minifat",ct.size<0?ct.size=0:Re!==U&&ct.start!==U&&te[Re]&&(ct.content=x(ct,te[Re].data,(te[Be]||{}).data))),ct.content&&Kl(ct.content,0),ie[It]=ct,Pe.push(ct)}}function R(q,te){return new Date((Ql(q,te+4)/1e7*Math.pow(2,32)+Ql(q,te)/1e7-11644473600)*1e3)}function C(q,te){return c(),u(l.readFileSync(q),te)}function V(q,te){var J=te&&te.type;switch(J||wr&&Buffer.isBuffer(q)&&(J="buffer"),J||"base64"){case"file":return C(q,te);case"base64":return u(Ku(dp(q)),te);case"binary":return u(Ku(q),te)}return u(q,te)}function M(q,te){var J=te||{},ee=J.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=ee+"/",q.FileIndex[0]={name:ee,type:5}),J.CLSID&&(q.FileIndex[0].clsid=J.CLSID),N(q)}function N(q){var te="Sh33tJ5";if(!qr.find(q,"/"+te)){var J=Ge(4);J[0]=55,J[1]=J[3]=50,J[2]=54,q.FileIndex.push({name:te,type:2,content:J,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+te),O(q)}}function O(q,te){M(q);for(var J=!1,ee=!1,re=q.FullPaths.length-1;re>=0;--re){var ie=q.FileIndex[re];switch(ie.type){case 0:ee?J=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(ie.R*ie.L*ie.C)&&(J=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!te)){var Pe=new Date(1987,1,19),Be=0,Re=Object.create?Object.create(null):{},Ne=[];for(re=0;re<q.FullPaths.length;++re)Re[q.FullPaths[re]]=!0,q.FileIndex[re].type!==0&&Ne.push([q.FullPaths[re],q.FileIndex[re]]);for(re=0;re<Ne.length;++re){var Oe=r(Ne[re][0]);ee=Re[Oe],ee||(Ne.push([Oe,{name:i(Oe).replace("/",""),type:1,clsid:ze,ct:Pe,mt:Pe,content:null}]),Re[Oe]=!0)}for(Ne.sort(function(It,lt){return n(It[0],lt[0])}),q.FullPaths=[],q.FileIndex=[],re=0;re<Ne.length;++re)q.FullPaths[re]=Ne[re][0],q.FileIndex[re]=Ne[re][1];for(re=0;re<Ne.length;++re){var at=q.FileIndex[re],gt=q.FullPaths[re];if(at.name=i(gt).replace("/",""),at.L=at.R=at.C=-(at.color=1),at.size=at.content?at.content.length:0,at.start=0,at.clsid=at.clsid||ze,re===0)at.C=Ne.length>1?1:-1,at.size=0,at.type=5;else if(gt.slice(-1)=="/"){for(Be=re+1;Be<Ne.length&&r(q.FullPaths[Be])!=gt;++Be);for(at.C=Be>=Ne.length?-1:Be,Be=re+1;Be<Ne.length&&r(q.FullPaths[Be])!=r(gt);++Be);at.R=Be>=Ne.length?-1:Be,at.type=1}else r(q.FullPaths[re+1]||"")==r(gt)&&(at.R=re+1),at.type=2}}}function F(q,te){var J=te||{};if(J.fileType=="mad")return Ue(q,J);switch(O(q),J.fileType){case"zip":return bt(q,J)}var ee=(function(It){for(var lt=0,ct=0,wn=0;wn<It.FileIndex.length;++wn){var Ar=It.FileIndex[wn];if(Ar.content){var Lr=Ar.content.length;Lr>0&&(Lr<4096?lt+=Lr+63>>6:ct+=Lr+511>>9)}}for(var pi=It.FullPaths.length+3>>2,pu=lt+7>>3,mc=lt+127>>7,Il=pu+ct+pi+mc,ns=Il+127>>7,Tp=ns<=109?0:Math.ceil((ns-109)/127);Il+ns+Tp+127>>7>ns;)Tp=++ns<=109?0:Math.ceil((ns-109)/127);var ki=[1,Tp,ns,mc,pi,ct,lt,0];return It.FileIndex[0].size=lt<<6,ki[7]=(It.FileIndex[0].start=ki[0]+ki[1]+ki[2]+ki[3]+ki[4]+ki[5])+(ki[6]+7>>3),ki})(q),re=Ge(ee[7]<<9),ie=0,Pe=0;{for(ie=0;ie<8;++ie)re.write_shift(1,me[ie]);for(ie=0;ie<8;++ie)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ie=0;ie<3;++ie)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ee[2]),re.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:U),re.write_shift(4,ee[3]),re.write_shift(-4,ee[1]?ee[0]-1:U),re.write_shift(4,ee[1]),ie=0;ie<109;++ie)re.write_shift(-4,ie<ee[2]?ee[1]+ie:-1)}if(ee[1])for(Pe=0;Pe<ee[1];++Pe){for(;ie<236+Pe*127;++ie)re.write_shift(-4,ie<ee[2]?ee[1]+ie:-1);re.write_shift(-4,Pe===ee[1]-1?U:Pe+1)}var Be=function(It){for(Pe+=It;ie<Pe-1;++ie)re.write_shift(-4,ie+1);It&&(++ie,re.write_shift(-4,U))};for(Pe=ie=0,Pe+=ee[1];ie<Pe;++ie)re.write_shift(-4,Le.DIFSECT);for(Pe+=ee[2];ie<Pe;++ie)re.write_shift(-4,Le.FATSECT);Be(ee[3]),Be(ee[4]);for(var Re=0,Ne=0,Oe=q.FileIndex[0];Re<q.FileIndex.length;++Re)Oe=q.FileIndex[Re],Oe.content&&(Ne=Oe.content.length,!(Ne<4096)&&(Oe.start=Pe,Be(Ne+511>>9)));for(Be(ee[6]+7>>3);re.l&511;)re.write_shift(-4,Le.ENDOFCHAIN);for(Pe=ie=0,Re=0;Re<q.FileIndex.length;++Re)Oe=q.FileIndex[Re],Oe.content&&(Ne=Oe.content.length,!(!Ne||Ne>=4096)&&(Oe.start=Pe,Be(Ne+63>>6)));for(;re.l&511;)re.write_shift(-4,Le.ENDOFCHAIN);for(ie=0;ie<ee[4]<<2;++ie){var at=q.FullPaths[ie];if(!at||at.length===0){for(Re=0;Re<17;++Re)re.write_shift(4,0);for(Re=0;Re<3;++Re)re.write_shift(4,-1);for(Re=0;Re<12;++Re)re.write_shift(4,0);continue}Oe=q.FileIndex[ie],ie===0&&(Oe.start=Oe.size?Oe.start-1:U);var gt=ie===0&&J.root||Oe.name;if(Ne=2*(gt.length+1),re.write_shift(64,gt,"utf16le"),re.write_shift(2,Ne),re.write_shift(1,Oe.type),re.write_shift(1,Oe.color),re.write_shift(-4,Oe.L),re.write_shift(-4,Oe.R),re.write_shift(-4,Oe.C),Oe.clsid)re.write_shift(16,Oe.clsid,"hex");else for(Re=0;Re<4;++Re)re.write_shift(4,0);re.write_shift(4,Oe.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,Oe.start),re.write_shift(4,Oe.size),re.write_shift(4,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(Oe=q.FileIndex[ie],Oe.size>=4096)if(re.l=Oe.start+1<<9,wr&&Buffer.isBuffer(Oe.content))Oe.content.copy(re,re.l,0,Oe.size),re.l+=Oe.size+511&-512;else{for(Re=0;Re<Oe.size;++Re)re.write_shift(1,Oe.content[Re]);for(;Re&511;++Re)re.write_shift(1,0)}for(ie=1;ie<q.FileIndex.length;++ie)if(Oe=q.FileIndex[ie],Oe.size>0&&Oe.size<4096)if(wr&&Buffer.isBuffer(Oe.content))Oe.content.copy(re,re.l,0,Oe.size),re.l+=Oe.size+63&-64;else{for(Re=0;Re<Oe.size;++Re)re.write_shift(1,Oe.content[Re]);for(;Re&63;++Re)re.write_shift(1,0)}if(wr)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function L(q,te){var J=q.FullPaths.map(function(Re){return Re.toUpperCase()}),ee=J.map(function(Re){var Ne=Re.split("/");return Ne[Ne.length-(Re.slice(-1)=="/"?2:1)]}),re=!1;te.charCodeAt(0)===47?(re=!0,te=J[0].slice(0,-1)+te):re=te.indexOf("/")!==-1;var ie=te.toUpperCase(),Pe=re===!0?J.indexOf(ie):ee.indexOf(ie);if(Pe!==-1)return q.FileIndex[Pe];var Be=!ie.match(cM);for(ie=ie.replace(LT,""),Be&&(ie=ie.replace(cM,"!")),Pe=0;Pe<J.length;++Pe)if((Be?J[Pe].replace(cM,"!"):J[Pe]).replace(LT,"")==ie||(Be?ee[Pe].replace(cM,"!"):ee[Pe]).replace(LT,"")==ie)return q.FileIndex[Pe];return null}var B=64,U=-2,de="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],ze="00000000000000000000000000000000",Le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ze,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(q,te,J){c();var ee=F(q,J);l.writeFileSync(te,ee)}function $e(q){for(var te=new Array(q.length),J=0;J<q.length;++J)te[J]=String.fromCharCode(q[J]);return te.join("")}function Ce(q,te){var J=F(q,te);switch(te&&te.type||"buffer"){case"file":return c(),l.writeFileSync(te.filename,J),J;case"binary":return typeof J=="string"?J:$e(J);case"base64":return oA(typeof J=="string"?J:$e(J));case"buffer":if(wr)return Buffer.isBuffer(J)?J:Sp(J);case"array":return typeof J=="string"?Ku(J):J}return J}var le;function W(q){try{var te=q.InflateRaw,J=new te;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)le=q;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function ne(q,te){if(!le)return Ae(q,te);var J=le.InflateRaw,ee=new J,re=ee._processChunk(q.slice(q.l),ee._finishFlushFlag);return q.l+=ee.bytesRead,re}function se(q){return le?le.deflateRawSync(q):On(q)}var ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ye(q){var te=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(te>>16|te>>8|te)&255}for(var ke=typeof Uint8Array<"u",Te=ke?new Uint8Array(256):[],Dt=0;Dt<256;++Dt)Te[Dt]=Ye(Dt);function qe(q,te){var J=Te[q&255];return te<=8?J>>>8-te:(J=J<<8|Te[q>>8&255],te<=16?J>>>16-te:(J=J<<8|Te[q>>16&255],J>>>24-te))}function sn(q,te){var J=te&7,ee=te>>>3;return(q[ee]|(J<=6?0:q[ee+1]<<8))>>>J&3}function $t(q,te){var J=te&7,ee=te>>>3;return(q[ee]|(J<=5?0:q[ee+1]<<8))>>>J&7}function fn(q,te){var J=te&7,ee=te>>>3;return(q[ee]|(J<=4?0:q[ee+1]<<8))>>>J&15}function yn(q,te){var J=te&7,ee=te>>>3;return(q[ee]|(J<=3?0:q[ee+1]<<8))>>>J&31}function dt(q,te){var J=te&7,ee=te>>>3;return(q[ee]|(J<=1?0:q[ee+1]<<8))>>>J&127}function lr(q,te,J){var ee=te&7,re=te>>>3,ie=(1<<J)-1,Pe=q[re]>>>ee;return J<8-ee||(Pe|=q[re+1]<<8-ee,J<16-ee)||(Pe|=q[re+2]<<16-ee,J<24-ee)||(Pe|=q[re+3]<<24-ee),Pe&ie}function $n(q,te,J){var ee=te&7,re=te>>>3;return ee<=5?q[re]|=(J&7)<<ee:(q[re]|=J<<ee&255,q[re+1]=(J&7)>>8-ee),te+3}function Un(q,te,J){var ee=te&7,re=te>>>3;return J=(J&1)<<ee,q[re]|=J,te+1}function Xr(q,te,J){var ee=te&7,re=te>>>3;return J<<=ee,q[re]|=J&255,J>>>=8,q[re+1]=J,te+8}function fo(q,te,J){var ee=te&7,re=te>>>3;return J<<=ee,q[re]|=J&255,J>>>=8,q[re+1]=J&255,q[re+2]=J>>>8,te+16}function kr(q,te){var J=q.length,ee=2*J>te?2*J:te+5,re=0;if(J>=te)return q;if(wr){var ie=Ose(ee);if(q.copy)q.copy(ie);else for(;re<q.length;++re)ie[re]=q[re];return ie}else if(ke){var Pe=new Uint8Array(ee);if(Pe.set)Pe.set(q);else for(;re<J;++re)Pe[re]=q[re];return Pe}return q.length=ee,q}function Si(q){for(var te=new Array(q),J=0;J<q;++J)te[J]=0;return te}function Rs(q,te,J){var ee=1,re=0,ie=0,Pe=0,Be=0,Re=q.length,Ne=ke?new Uint16Array(32):Si(32);for(ie=0;ie<32;++ie)Ne[ie]=0;for(ie=Re;ie<J;++ie)q[ie]=0;Re=q.length;var Oe=ke?new Uint16Array(Re):Si(Re);for(ie=0;ie<Re;++ie)Ne[re=q[ie]]++,ee<re&&(ee=re),Oe[ie]=0;for(Ne[0]=0,ie=1;ie<=ee;++ie)Ne[ie+16]=Be=Be+Ne[ie-1]<<1;for(ie=0;ie<Re;++ie)Be=q[ie],Be!=0&&(Oe[ie]=Ne[Be+16]++);var at=0;for(ie=0;ie<Re;++ie)if(at=q[ie],at!=0)for(Be=qe(Oe[ie],ee)>>ee-at,Pe=(1<<ee+4-at)-1;Pe>=0;--Pe)te[Be|Pe<<at]=at&15|ie<<4;return ee}var Mt=ke?new Uint16Array(512):Si(512),Yn=ke?new Uint16Array(32):Si(32);if(!ke){for(var cr=0;cr<512;++cr)Mt[cr]=0;for(cr=0;cr<32;++cr)Yn[cr]=0}(function(){for(var q=[],te=0;te<32;te++)q.push(5);Rs(q,Yn,32);var J=[];for(te=0;te<=143;te++)J.push(8);for(;te<=255;te++)J.push(9);for(;te<=279;te++)J.push(7);for(;te<=287;te++)J.push(8);Rs(J,Mt,288)})();var Ft=(function(){for(var te=ke?new Uint8Array(32768):[],J=0,ee=0;J<Ke.length-1;++J)for(;ee<Ke[J+1];++ee)te[ee]=J;for(;ee<32768;++ee)te[ee]=29;var re=ke?new Uint8Array(259):[];for(J=0,ee=0;J<_e.length-1;++J)for(;ee<_e[J+1];++ee)re[ee]=J;function ie(Be,Re){for(var Ne=0;Ne<Be.length;){var Oe=Math.min(65535,Be.length-Ne),at=Ne+Oe==Be.length;for(Re.write_shift(1,+at),Re.write_shift(2,Oe),Re.write_shift(2,~Oe&65535);Oe-- >0;)Re[Re.l++]=Be[Ne++]}return Re.l}function Pe(Be,Re){for(var Ne=0,Oe=0,at=ke?new Uint16Array(32768):[];Oe<Be.length;){var gt=Math.min(65535,Be.length-Oe);if(gt<10){for(Ne=$n(Re,Ne,+(Oe+gt==Be.length)),Ne&7&&(Ne+=8-(Ne&7)),Re.l=Ne/8|0,Re.write_shift(2,gt),Re.write_shift(2,~gt&65535);gt-- >0;)Re[Re.l++]=Be[Oe++];Ne=Re.l*8;continue}Ne=$n(Re,Ne,+(Oe+gt==Be.length)+2);for(var It=0;gt-- >0;){var lt=Be[Oe];It=(It<<5^lt)&32767;var ct=-1,wn=0;if((ct=at[It])&&(ct|=Oe&-32768,ct>Oe&&(ct-=32768),ct<Oe))for(;Be[ct+wn]==Be[Oe+wn]&&wn<250;)++wn;if(wn>2){lt=re[wn],lt<=22?Ne=Xr(Re,Ne,Te[lt+1]>>1)-1:(Xr(Re,Ne,3),Ne+=5,Xr(Re,Ne,Te[lt-23]>>5),Ne+=3);var Ar=lt<8?0:lt-4>>2;Ar>0&&(fo(Re,Ne,wn-_e[lt]),Ne+=Ar),lt=te[Oe-ct],Ne=Xr(Re,Ne,Te[lt]>>3),Ne-=3;var Lr=lt<4?0:lt-2>>1;Lr>0&&(fo(Re,Ne,Oe-ct-Ke[lt]),Ne+=Lr);for(var pi=0;pi<wn;++pi)at[It]=Oe&32767,It=(It<<5^Be[Oe])&32767,++Oe;gt-=wn-1}else lt<=143?lt=lt+48:Ne=Un(Re,Ne,1),Ne=Xr(Re,Ne,Te[lt]),at[It]=Oe&32767,++Oe}Ne=Xr(Re,Ne,0)-1}return Re.l=(Ne+7)/8|0,Re.l}return function(Re,Ne){return Re.length<8?ie(Re,Ne):Pe(Re,Ne)}})();function On(q){var te=Ge(50+Math.floor(q.length*1.1)),J=Ft(q,te);return te.slice(0,J)}var Qt=ke?new Uint16Array(32768):Si(32768),Oo=ke?new Uint16Array(32768):Si(32768),ji=ke?new Uint16Array(128):Si(128),Ps=1,Pn=1;function Ti(q,te){var J=yn(q,te)+257;te+=5;var ee=yn(q,te)+1;te+=5;var re=fn(q,te)+4;te+=4;for(var ie=0,Pe=ke?new Uint8Array(19):Si(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Re=1,Ne=ke?new Uint8Array(8):Si(8),Oe=ke?new Uint8Array(8):Si(8),at=Pe.length,gt=0;gt<re;++gt)Pe[ae[gt]]=ie=$t(q,te),Re<ie&&(Re=ie),Ne[ie]++,te+=3;var It=0;for(Ne[0]=0,gt=1;gt<=Re;++gt)Oe[gt]=It=It+Ne[gt-1]<<1;for(gt=0;gt<at;++gt)(It=Pe[gt])!=0&&(Be[gt]=Oe[It]++);var lt=0;for(gt=0;gt<at;++gt)if(lt=Pe[gt],lt!=0){It=Te[Be[gt]]>>8-lt;for(var ct=(1<<7-lt)-1;ct>=0;--ct)ji[It|ct<<lt]=lt&7|gt<<3}var wn=[];for(Re=1;wn.length<J+ee;)switch(It=ji[dt(q,te)],te+=It&7,It>>>=3){case 16:for(ie=3+sn(q,te),te+=2,It=wn[wn.length-1];ie-- >0;)wn.push(It);break;case 17:for(ie=3+$t(q,te),te+=3;ie-- >0;)wn.push(0);break;case 18:for(ie=11+dt(q,te),te+=7;ie-- >0;)wn.push(0);break;default:wn.push(It),Re<It&&(Re=It);break}var Ar=wn.slice(0,J),Lr=wn.slice(J);for(gt=J;gt<286;++gt)Ar[gt]=0;for(gt=ee;gt<30;++gt)Lr[gt]=0;return Ps=Rs(Ar,Qt,286),Pn=Rs(Lr,Oo,30),te}function He(q,te){if(q[0]==3&&!(q[1]&3))return[G1(te),2];for(var J=0,ee=0,re=Ose(te||1<<18),ie=0,Pe=re.length>>>0,Be=0,Re=0;(ee&1)==0;){if(ee=$t(q,J),J+=3,ee>>>1)ee>>1==1?(Be=9,Re=5):(J=Ti(q,J),Be=Ps,Re=Pn);else{J&7&&(J+=8-(J&7));var Ne=q[J>>>3]|q[(J>>>3)+1]<<8;if(J+=32,Ne>0)for(!te&&Pe<ie+Ne&&(re=kr(re,ie+Ne),Pe=re.length);Ne-- >0;)re[ie++]=q[J>>>3],J+=8;continue}for(;;){!te&&Pe<ie+32767&&(re=kr(re,ie+32767),Pe=re.length);var Oe=lr(q,J,Be),at=ee>>>1==1?Mt[Oe]:Qt[Oe];if(J+=at&15,at>>>=4,(at>>>8&255)===0)re[ie++]=at;else{if(at==256)break;at-=257;var gt=at<8?0:at-4>>2;gt>5&&(gt=0);var It=ie+_e[at];gt>0&&(It+=lr(q,J,gt),J+=gt),Oe=lr(q,J,Re),at=ee>>>1==1?Yn[Oe]:Oo[Oe],J+=at&15,at>>>=4;var lt=at<4?0:at-2>>1,ct=Ke[at];for(lt>0&&(ct+=lr(q,J,lt),J+=lt),!te&&Pe<It&&(re=kr(re,It+100),Pe=re.length);ie<It;)re[ie]=re[ie-ct],++ie}}}return te?[re,J+7>>>3]:[re.slice(0,ie),J+7>>>3]}function Ae(q,te){var J=q.slice(q.l||0),ee=He(J,te);return q.l+=ee[1],ee[0]}function Ie(q,te){if(q)typeof console<"u"&&console.error(te);else throw new Error(te)}function rn(q,te){var J=q;Kl(J,0);var ee=[],re=[],ie={FileIndex:ee,FullPaths:re};M(ie,{root:te.root});for(var Pe=J.length-4;(J[Pe]!=80||J[Pe+1]!=75||J[Pe+2]!=5||J[Pe+3]!=6)&&Pe>=0;)--Pe;J.l=Pe+4,J.l+=4;var Be=J.read_shift(2);J.l+=6;var Re=J.read_shift(4);for(J.l=Re,Pe=0;Pe<Be;++Pe){J.l+=20;var Ne=J.read_shift(4),Oe=J.read_shift(4),at=J.read_shift(2),gt=J.read_shift(2),It=J.read_shift(2);J.l+=8;var lt=J.read_shift(4),ct=a(J.slice(J.l+at,J.l+at+gt));J.l+=at+gt+It;var wn=J.l;J.l=lt+4,z(J,Ne,Oe,ie,ct),J.l=wn}return ie}function z(q,te,J,ee,re){q.l+=2;var ie=q.read_shift(2),Pe=q.read_shift(2),Be=o(q);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var Re=q.read_shift(4),Ne=q.read_shift(4),Oe=q.read_shift(4),at=q.read_shift(2),gt=q.read_shift(2),It="",lt=0;lt<at;++lt)It+=String.fromCharCode(q[q.l++]);if(gt){var ct=a(q.slice(q.l,q.l+gt));(ct[21589]||{}).mt&&(Be=ct[21589].mt),((re||{})[21589]||{}).mt&&(Be=re[21589].mt)}q.l+=gt;var wn=q.slice(q.l,q.l+Ne);switch(Pe){case 8:wn=ne(q,Oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var Ar=!1;ie&8&&(Re=q.read_shift(4),Re==134695760&&(Re=q.read_shift(4),Ar=!0),Ne=q.read_shift(4),Oe=q.read_shift(4)),Ne!=te&&Ie(Ar,"Bad compressed size: "+te+" != "+Ne),Oe!=J&&Ie(Ar,"Bad uncompressed size: "+J+" != "+Oe),et(ee,It,wn,{unsafe:!0,mt:Be})}function bt(q,te){var J=te||{},ee=[],re=[],ie=Ge(1),Pe=J.compression?8:0,Be=0,Re=0,Ne=0,Oe=0,at=0,gt=q.FullPaths[0],It=gt,lt=q.FileIndex[0],ct=[],wn=0;for(Re=1;Re<q.FullPaths.length;++Re)if(It=q.FullPaths[Re].slice(gt.length),lt=q.FileIndex[Re],!(!lt.size||!lt.content||It=="Sh33tJ5")){var Ar=Oe,Lr=Ge(It.length);for(Ne=0;Ne<It.length;++Ne)Lr.write_shift(1,It.charCodeAt(Ne)&127);Lr=Lr.slice(0,Lr.l),ct[at]=a1t.buf(lt.content,0);var pi=lt.content;Pe==8&&(pi=se(pi)),ie=Ge(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Be),ie.write_shift(2,Pe),lt.mt?s(ie,lt.mt):ie.write_shift(4,0),ie.write_shift(-4,ct[at]),ie.write_shift(4,pi.length),ie.write_shift(4,lt.content.length),ie.write_shift(2,Lr.length),ie.write_shift(2,0),Oe+=ie.length,ee.push(ie),Oe+=Lr.length,ee.push(Lr),Oe+=pi.length,ee.push(pi),ie=Ge(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Be),ie.write_shift(2,Pe),ie.write_shift(4,0),ie.write_shift(-4,ct[at]),ie.write_shift(4,pi.length),ie.write_shift(4,lt.content.length),ie.write_shift(2,Lr.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,Ar),wn+=ie.l,re.push(ie),wn+=Lr.length,re.push(Lr),++at}return ie=Ge(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,at),ie.write_shift(2,at),ie.write_shift(4,wn),ie.write_shift(4,Oe),ie.write_shift(2,0),Io([Io(ee),Io(re),ie])}var Y={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function oe(q,te){if(q.ctype)return q.ctype;var J=q.name||"",ee=J.match(/\.([^\.]+)$/);return ee&&Y[ee[1]]||te&&(ee=(J=te).match(/[\.\\]([^\.\\])+$/),ee&&Y[ee[1]])?Y[ee[1]]:"application/octet-stream"}function Ve(q){for(var te=oA(q),J=[],ee=0;ee<te.length;ee+=76)J.push(te.slice(ee,ee+76));return J.join(`\r
`)+`\r
`}function Q(q){var te=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var Oe=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(Oe.length==1?"0"+Oe:Oe)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],ee=te.split(`\r
`),re=0;re<ee.length;++re){var ie=ee[re];if(ie.length==0){J.push("");continue}for(var Pe=0;Pe<ie.length;){var Be=76,Re=ie.slice(Pe,Pe+Be);Re.charAt(Be-1)=="="?Be--:Re.charAt(Be-2)=="="?Be-=2:Re.charAt(Be-3)=="="&&(Be-=3),Re=ie.slice(Pe,Pe+Be),Pe+=Be,Pe<ie.length&&(Re+="="),J.push(Re)}}return J.join(`\r
`)}function ye(q){for(var te=[],J=0;J<q.length;++J){for(var ee=q[J];J<=q.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+q[++J];te.push(ee)}for(var re=0;re<te.length;++re)te[re]=te[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return Ku(te.join(`\r
`))}function De(q,te,J){for(var ee="",re="",ie="",Pe,Be=0;Be<10;++Be){var Re=te[Be];if(!Re||Re.match(/^\s*$/))break;var Ne=Re.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":ee=Ne[2].trim();break;case"content-type":ie=Ne[2].trim();break;case"content-transfer-encoding":re=Ne[2].trim();break}}switch(++Be,re.toLowerCase()){case"base64":Pe=Ku(dp(te.slice(Be).join("")));break;case"quoted-printable":Pe=ye(te.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var Oe=et(q,ee.slice(J.length),Pe,{unsafe:!0});ie&&(Oe.ctype=ie)}function Je(q,te){if($e(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=te&&te.root||"",ee=(wr&&Buffer.isBuffer(q)?q.toString("binary"):$e(q)).split(`\r
`),re=0,ie="";for(re=0;re<ee.length;++re)if(ie=ee[re],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),J||(J=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),ie.slice(0,J.length)!=J););var Pe=(ee[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var Be="--"+(Pe[1]||""),Re=[],Ne=[],Oe={FileIndex:Re,FullPaths:Ne};M(Oe);var at,gt=0;for(re=0;re<ee.length;++re){var It=ee[re];It!==Be&&It!==Be+"--"||(gt++&&De(Oe,ee.slice(at,re),J),at=re)}return Oe}function Ue(q,te){var J=te||{},ee=J.boundary||"SheetJS";ee="------="+ee;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],ie=q.FullPaths[0],Pe=ie,Be=q.FileIndex[0],Re=1;Re<q.FullPaths.length;++Re)if(Pe=q.FullPaths[Re].slice(ie.length),Be=q.FileIndex[Re],!(!Be.size||!Be.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(wn){return"_x"+wn.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(wn){return"_u"+wn.charCodeAt(0).toString(16)+"_"});for(var Ne=Be.content,Oe=wr&&Buffer.isBuffer(Ne)?Ne.toString("binary"):$e(Ne),at=0,gt=Math.min(1024,Oe.length),It=0,lt=0;lt<=gt;++lt)(It=Oe.charCodeAt(lt))>=32&&It<128&&++at;var ct=at>=gt*4/5;re.push(ee),re.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+Pe),re.push("Content-Transfer-Encoding: "+(ct?"quoted-printable":"base64")),re.push("Content-Type: "+oe(Be,Pe)),re.push(""),re.push(ct?Q(Oe):Ve(Oe))}return re.push(ee+`--\r
`),re.join(`\r
`)}function nt(q){var te={};return M(te,q),te}function et(q,te,J,ee){var re=ee&&ee.unsafe;re||M(q);var ie=!re&&qr.find(q,te);if(!ie){var Pe=q.FullPaths[0];te.slice(0,Pe.length)==Pe?Pe=te:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+te).replace("//","/")),ie={name:i(te),type:2},q.FileIndex.push(ie),q.FullPaths.push(Pe),re||qr.utils.cfb_gc(q)}return ie.content=J,ie.size=J?J.length:0,ee&&(ee.CLSID&&(ie.clsid=ee.CLSID),ee.mt&&(ie.mt=ee.mt),ee.ct&&(ie.ct=ee.ct)),ie}function Pt(q,te){M(q);var J=qr.find(q,te);if(J){for(var ee=0;ee<q.FileIndex.length;++ee)if(q.FileIndex[ee]==J)return q.FileIndex.splice(ee,1),q.FullPaths.splice(ee,1),!0}return!1}function zt(q,te,J){M(q);var ee=qr.find(q,te);if(ee){for(var re=0;re<q.FileIndex.length;++re)if(q.FileIndex[re]==ee)return q.FileIndex[re].name=i(J),q.FullPaths[re]=J,!0}return!1}function gn(q){O(q,!0)}return e.find=L,e.read=V,e.parse=u,e.write=Ce,e.writeFile=fe,e.utils={cfb_new:nt,cfb_add:et,cfb_del:Pt,cfb_mov:zt,cfb_gc:gn,ReadShift:$T,CheckField:Z2e,prep_blob:Kl,bconcat:Io,use_zlib:W,_deflateRaw:On,_inflateRaw:Ae,consts:Le},e})();function l1t(t){return typeof t=="string"?rL(t):Array.isArray(t)?Oyt(t):t}function LI(t,e,n){if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=rL(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?lA(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var i=new Blob([l1t(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=OI(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Co(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function Use(t,e){for(var n=[],r=Co(t),i=0;i!==r.length;++i)n[t[r[i]][e]]==null&&(n[t[r[i]][e]]=r[i]);return n}function AH(t){for(var e=[],n=Co(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function oL(t){for(var e=[],n=Co(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function c1t(t){for(var e=[],n=Co(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var MN=new Date(1899,11,30,0,0,0);function Sl(t,e){var n=t.getTime(),r=MN.getTime()+(t.getTimezoneOffset()-MN.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var O2e=new Date,u1t=MN.getTime()+(O2e.getTimezoneOffset()-MN.getTimezoneOffset())*6e4,Gse=O2e.getTimezoneOffset();function L2e(t){var e=new Date;return e.setTime(t*24*60*60*1e3+u1t),e.getTimezoneOffset()!==Gse&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Gse)*6e4),e}var Bse=new Date("2017-02-19T19:06:09.000Z"),D2e=isNaN(Bse.getFullYear())?new Date("2/19/17"):Bse,h1t=D2e.getFullYear()==2017;function Da(t,e){var n=new Date(t);if(h1t)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(D2e.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function aL(t,e){if(wr&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=t.length;++i)r.push(String.fromCharCode(t[i]));return r.join("")}function Tl(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Tl(t[n]));return e}function Yi(t,e){for(var n="";n.length<e;)n+=t;return n}function ep(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(e=Number(r)))?e/n:e}var d1t=["january","february","march","april","may","june","july","august","september","october","november","december"];function aA(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return n;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&d1t.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}function Fn(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return wr?r=Sp(n):r=Lyt(n),qr.utils.cfb_add(t,e,r)}qr.utils.cfb_add(t,e,n)}else t.file(e,n)}function IH(){return qr.utils.cfb_new()}var Is=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,f1t={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},RH=AH(f1t),PH=/[&<>'"]/g,p1t=/[\u0000-\u0008\u000b-\u001f]/g;function Ur(t){var e=t+"";return e.replace(PH,function(n){return RH[n]}).replace(p1t,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Wse(t){return Ur(t).replace(/ /g,"_x0020_")}var $2e=/[\u0000-\u001f]/g;function m1t(t){var e=t+"";return e.replace(PH,function(n){return RH[n]}).replace(/\n/g,"<br/>").replace($2e,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function g1t(t){var e=t+"";return e.replace(PH,function(n){return RH[n]}).replace($2e,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function y1t(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function v1t(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function A8(t){for(var e="",n=0,r=0,i=0,s=0,o=0,a=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(i=t.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function Hse(t){var e=G1(2*t.length),n,r,i=1,s=0,o=0,a;for(r=0;r<t.length;r+=i)i=1,(a=t.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(t.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=n%256,e[s++]=n>>>8;return e.slice(0,s).toString("ucs2")}function qse(t){return Sp(t,"binary").toString("utf8")}var hM="foo bar baz",DT=wr&&(qse(hM)==A8(hM)&&qse||Hse(hM)==A8(hM)&&Hse)||A8,lA=wr?function(t){return Sp(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,i=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},_1t=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)r=r.replace(t[i][0],t[i][1]);return r}})(),j2e=/(^\s|\s$|\n)/;function Ro(t,e){return"<"+t+(e.match(j2e)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function cA(t){return Co(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function yt(t,e,n){return"<"+t+(n!=null?cA(n):"")+(e!=null?(e.match(j2e)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function JV(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function x1t(t,e){switch(typeof t){case"string":var n=yt("vt:lpwstr",Ur(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return yt((t|0)==t?"vt:i4":"vt:r8",Ur(String(t)));case"boolean":return yt("vt:bool",t?"true":"false")}if(t instanceof Date)return yt("vt:filetime",JV(t));throw new Error("Unable to serialize "+t)}var so={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},db=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Jl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function w1t(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function b1t(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=r?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[n+a]=s&255;t[n+6]=(i&15)<<4|s&15,t[n+7]=i>>4|r}var Kse=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var i=0,s=t[0][r].length;i<s;i+=n)e.push.apply(e,t[0][r].slice(i,i+n));return e},Yse=wr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Sp(e)})):Kse(t)}:Kse,Xse=function(t,e,n){for(var r=[],i=e;i<n;i+=2)r.push(String.fromCharCode(OS(t,i)));return r.join("").replace(LT,"")},MH=wr?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(LT,""):Xse(t,e,n)}:Xse,Zse=function(t,e,n){for(var r=[],i=e;i<e+n;++i)r.push(("0"+t[i].toString(16)).slice(-2));return r.join("")},F2e=wr?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):Zse(t,e,n)}:Zse,Jse=function(t,e,n){for(var r=[],i=e;i<n;i++)r.push(String.fromCharCode(ux(t,i)));return r.join("")},DI=wr?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):Jse(e,n,r)}:Jse,V2e=function(t,e){var n=Ql(t,e);return n>0?DI(t,e+4,e+4+n-1):""},z2e=V2e,U2e=function(t,e){var n=Ql(t,e);return n>0?DI(t,e+4,e+4+n-1):""},G2e=U2e,B2e=function(t,e){var n=2*Ql(t,e);return n>0?DI(t,e+4,e+4+n-1):""},W2e=B2e,H2e=function(e,n){var r=Ql(e,n);return r>0?MH(e,n+4,n+4+r):""},q2e=H2e,K2e=function(t,e){var n=Ql(t,e);return n>0?DI(t,e+4,e+4+n):""},Y2e=K2e,X2e=function(t,e){return w1t(t,e)},CN=X2e,CH=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wr&&(z2e=function(e,n){if(!Buffer.isBuffer(e))return V2e(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},G2e=function(e,n){if(!Buffer.isBuffer(e))return U2e(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},W2e=function(e,n){if(!Buffer.isBuffer(e))return B2e(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},q2e=function(e,n){if(!Buffer.isBuffer(e))return H2e(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},Y2e=function(e,n){if(!Buffer.isBuffer(e))return K2e(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},CN=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):X2e(e,n)},CH=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ux=function(t,e){return t[e]},OS=function(t,e){return t[e+1]*256+t[e]},E1t=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Ql=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_y=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},S1t=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function $T(t,e){var n="",r,i,s=[],o,a,l,c;switch(e){case"dbcs":if(c=this.l,wr&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)n+=String.fromCharCode(OS(this,c)),c+=2;t*=2;break;case"utf8":n=DI(this,this.l,this.l+t);break;case"utf16le":t*=2,n=MH(this,this.l,this.l+t);break;case"wstr":return $T.call(this,t,"dbcs");case"lpstr-ansi":n=z2e(this,this.l),t=4+Ql(this,this.l);break;case"lpstr-cp":n=G2e(this,this.l),t=4+Ql(this,this.l);break;case"lpwstr":n=W2e(this,this.l),t=4+2*Ql(this,this.l);break;case"lpp4":t=4+Ql(this,this.l),n=q2e(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ql(this,this.l),n=Y2e(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(o=ux(this,this.l+t++))!==0;)s.push(lM(o));n=s.join("");break;case"_wstr":for(t=0,n="";(o=OS(this,this.l+t))!==0;)s.push(lM(o)),t+=2;t+=2,n=s.join("");break;case"dbcs-cont":for(n="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ux(this,c),this.l=c+1,a=$T.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(lM(OS(this,c))),c+=2}n=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=ux(this,c),this.l=c+1,a=$T.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(lM(ux(this,c))),c+=1}n=s.join("");break;default:switch(t){case 1:return r=ux(this,this.l),this.l++,r;case 2:return r=(e==="i"?E1t:OS)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?_y:S1t)(this,this.l),this.l+=4,r):(i=Ql(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=CN(this,this.l):i=CN([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:n=F2e(this,this.l,t);break}}return this.l+=t,n}var T1t=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},k1t=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},A1t=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function I1t(t,e,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=e.length;++i)A1t(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(n==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,T1t(this,e,this.l);break;case 8:if(r=8,n==="f"){b1t(this,e,this.l);break}case 16:break;case-4:r=4,k1t(this,e,this.l);break}return this.l+=r,this}function Z2e(t,e){var n=F2e(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Kl(t,e){t.l=e,t.read_shift=$T,t.chk=Z2e,t.write_shift=I1t}function Pd(t,e){t.l+=e}function Ge(t){var e=G1(t);return Kl(e,0),e}function _l(){var t=[],e=wr?256:2048,n=function(c){var u=Ge(c);return Kl(u,0),u},r=n(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=n(Math.max(c+1,e)))},o=function(){return i(),Io(t)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function tt(t,e,n,r){var i=+e,s;if(!isNaN(i)){r||(r=wbt[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&CH(n)&&t.push(n)}}function jT(t,e,n){var r=Tl(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Qse(t,e,n){var r=Tl(t);return r.s=jT(r.s,e.s,n),r.e=jT(r.e,e.s,n),r}function FT(t,e){if(t.cRel&&t.c<0)for(t=Tl(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Tl(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=Br(t);return!t.cRel&&t.cRel!=null&&(n=M1t(n)),!t.rRel&&t.rRel!=null&&(n=R1t(n)),n}function I8(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ma(t.s.c)+":"+(t.e.cRel?"":"$")+ma(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mo(t.s.r)+":"+(t.e.rRel?"":"$")+Mo(t.e.r):FT(t.s,e.biff)+":"+FT(t.e,e.biff)}function NH(t){return parseInt(P1t(t),10)-1}function Mo(t){return""+(t+1)}function R1t(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function P1t(t){return t.replace(/\$(\d+)$/,"$1")}function OH(t){for(var e=C1t(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function ma(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function M1t(t){return t.replace(/^([A-Z])/,"$$$1")}function C1t(t){return t.replace(/^\$([A-Z])/,"$1")}function N1t(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ao(t){for(var e=0,n=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:e-1}}function Br(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function pc(t){var e=t.indexOf(":");return e==-1?{s:ao(t),e:ao(t)}:{s:ao(t.slice(0,e)),e:ao(t.slice(e+1))}}function ks(t,e){return typeof e>"u"||typeof e=="number"?ks(t.s,t.e):(typeof t!="string"&&(t=Br(t)),typeof e!="string"&&(e=Br(e)),t==e?t:t+":"+e)}function fi(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=t.length;for(n=0;r<s&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.s.c=--n,n=0;r<s&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(e.s.r=--n,r===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=s&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.e.c=--n,n=0;r!=s&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return e.e.r=--n,e}function eoe(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Bg(t.z,n?Sl(e):e)}catch{}try{return t.w=Bg((t.XF||{}).numFmtId||(n?14:0),n?Sl(e):e)}catch{return""+e}}function fp(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?$I[t.v]||t.v:e==null?eoe(t,t.v):eoe(t,e))}function hv(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function J2e(t,e,n){var r=n||{},i=t?Array.isArray(t):r.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?ao(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=fi(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var g={v:e[h][f]},v=o+h,x=a+f;if(c.s.r>v&&(c.s.r=v),c.s.c>x&&(c.s.c=x),c.e.r<v&&(c.e.r=v),c.e.c<x&&(c.e.c=x),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))g=e[h][f];else if(Array.isArray(g.v)&&(g.f=e[h][f][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else if(r.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=r.dateNF||Qi[14],r.cellDates?(g.t="d",g.w=Bg(g.z,Sl(g.v))):(g.t="n",g.v=Sl(g.v),g.w=Bg(g.z,g.v))):g.t="s";if(i)s[v]||(s[v]=[]),s[v][x]&&s[v][x].z&&(g.z=s[v][x].z),s[v][x]=g;else{var b=Br({c:x,r:v});s[b]&&s[b].z&&(g.z=s[b].z),s[b]=g}}}return c.s.c<1e7&&(s["!ref"]=ks(c)),s}function fb(t,e){return J2e(null,t,e)}function O1t(t){return t.read_shift(4,"i")}function sh(t,e){return e||(e=Ge(4)),e.write_shift(4,t),e}function ga(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function lo(t,e){var n=!1;return e==null&&(n=!0,e=Ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function L1t(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function D1t(t,e){return e||(e=Ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function LH(t,e){var n=t.l,r=t.read_shift(1),i=ga(t),s=[],o={t:i,h:i};if((r&1)!==0){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(L1t(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=n+e,o}function $1t(t,e){var n=!1;return e==null&&(n=!0,e=Ge(15+4*t.t.length)),e.write_shift(1,0),lo(t.t,e),n?e.slice(0,e.l):e}var j1t=LH;function F1t(t,e){var n=!1;return e==null&&(n=!0,e=Ge(23+4*t.t.length)),e.write_shift(1,1),lo(t.t,e),e.write_shift(4,1),D1t({},e),n?e.slice(0,e.l):e}function fu(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function dv(t,e){return e==null&&(e=Ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function fv(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function pv(t,e){return e==null&&(e=Ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var V1t=ga,Q2e=lo;function DH(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function NN(t,e){var n=!1;return e==null&&(n=!0,e=Ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var z1t=ga,QV=DH,$H=NN;function ebe(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var i=r===0?CN([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_y(e,0)>>2;return n?i/100:i}function tbe(t,e){e==null&&(e=Ge(4));var n=0,r=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?i:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function nbe(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function U1t(t,e){return e||(e=Ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var mv=nbe,pb=U1t;function mb(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function B1(t,e){return(e||Ge(8)).write_shift(8,t,"f")}function G1t(t){var e={},n=t.read_shift(1),r=n>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=J1t[i];c&&(e.rgb=hoe(c));break;case 2:e.rgb=hoe([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function ON(t,e){if(e||(e=Ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function B1t(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function W1t(t,e){e||(e=Ge(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}var rbe=2,Bl=3,dM=11,LN=19,fM=64,H1t=65,q1t=71,K1t=4108,Y1t=4126,To=80,toe={1:{n:"CodePage",t:rbe},2:{n:"Category",t:To},3:{n:"PresentationFormat",t:To},4:{n:"ByteCount",t:Bl},5:{n:"LineCount",t:Bl},6:{n:"ParagraphCount",t:Bl},7:{n:"SlideCount",t:Bl},8:{n:"NoteCount",t:Bl},9:{n:"HiddenCount",t:Bl},10:{n:"MultimediaClipCount",t:Bl},11:{n:"ScaleCrop",t:dM},12:{n:"HeadingPairs",t:K1t},13:{n:"TitlesOfParts",t:Y1t},14:{n:"Manager",t:To},15:{n:"Company",t:To},16:{n:"LinksUpToDate",t:dM},17:{n:"CharacterCount",t:Bl},19:{n:"SharedDoc",t:dM},22:{n:"HyperlinksChanged",t:dM},23:{n:"AppVersion",t:Bl,p:"version"},24:{n:"DigSig",t:H1t},26:{n:"ContentType",t:To},27:{n:"ContentStatus",t:To},28:{n:"Language",t:To},29:{n:"Version",t:To},255:{},2147483648:{n:"Locale",t:LN},2147483651:{n:"Behavior",t:LN},1919054434:{}},noe={1:{n:"CodePage",t:rbe},2:{n:"Title",t:To},3:{n:"Subject",t:To},4:{n:"Author",t:To},5:{n:"Keywords",t:To},6:{n:"Comments",t:To},7:{n:"Template",t:To},8:{n:"LastAuthor",t:To},9:{n:"RevNumber",t:To},10:{n:"EditTime",t:fM},11:{n:"LastPrinted",t:fM},12:{n:"CreatedDate",t:fM},13:{n:"ModifiedDate",t:fM},14:{n:"PageCount",t:Bl},15:{n:"WordCount",t:Bl},16:{n:"CharCount",t:Bl},17:{n:"Thumbnail",t:q1t},18:{n:"Application",t:To},19:{n:"DocSecurity",t:Bl},255:{},2147483648:{n:"Locale",t:LN},2147483651:{n:"Behavior",t:LN},1919054434:{}};function X1t(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Z1t=X1t([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),J1t=Tl(Z1t),$I={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Q1t={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},pM={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ibe(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sbe(t,e){var n=c1t(Q1t),r=[],i;r[r.length]=Is,r[r.length]=yt("Types",null,{xmlns:so.CT,"xmlns:xsd":so.xsd,"xmlns:xsi":so.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return yt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],r[r.length]=yt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:pM[l][e.bookType]||pM[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(c){r[r.length]=yt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:pM[l][e.bookType]||pM[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(c){r[r.length]=yt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var mr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function obe(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function hw(t){var e=[Is,yt("Relationships",null,{xmlns:so.RELS})];return Co(t["!id"]).forEach(function(n){e[e.length]=yt("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Fr(t,e,n,r,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=n,[mr.HLINK,mr.XPATH,mr.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function evt(t){var e=[Is];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function roe(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function tvt(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function nvt(t){var e=[Is];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(roe(t[n][0],t[n][1])),e.push(tvt("",t[n][0]));return e.push(roe("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function abe(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kN.version+"</meta:generator></office:meta></office:document-meta>"}var n1=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function R8(t,e,n,r,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ur(e),r[r.length]=n?yt(t,e,n):Ro(t,e))}function lbe(t,e){var n=e||{},r=[Is,yt("cp:coreProperties",null,{"xmlns:cp":so.CORE_PROPS,"xmlns:dc":so.dc,"xmlns:dcterms":so.dcterms,"xmlns:dcmitype":so.dcmitype,"xmlns:xsi":so.xsi})],i={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&R8("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:JV(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),t.ModifiedDate!=null&&R8("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:JV(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=n1.length;++s){var o=n1[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&R8(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var dw=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],cbe=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ube(t){var e=[],n=yt;return t||(t={}),t.Application="SheetJS",e[e.length]=Is,e[e.length]=yt("Properties",null,{xmlns:so.EXT_PROPS,"xmlns:vt":so.vt}),dw.forEach(function(r){if(t[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Ur(String(t[r[1]]));break;case"bool":i=t[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=n(r[0],i))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Ur(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function hbe(t){var e=[Is,yt("Properties",null,{xmlns:so.CUST_PROPS,"xmlns:vt":so.vt})];if(!t)return e.join("");var n=1;return Co(t).forEach(function(i){++n,e[e.length]=yt("property",x1t(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ur(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ioe={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rvt(t,e){var n=[];return Co(ioe).map(function(r){for(var i=0;i<n1.length;++i)if(n1[i][1]==r)return n1[i];for(i=0;i<dw.length;++i)if(dw[i][1]==r)return dw[i];throw r}).forEach(function(r){if(t[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Ro(ioe[r[1]]||r[1],i))}}),yt("DocumentProperties",n.join(""),{xmlns:Jl.o})}function ivt(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return t&&Co(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<n1.length;++o)if(s==n1[o][1])return;for(o=0;o<dw.length;++o)if(s==dw[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(yt(Wse(s),a,{"dt:dt":l}))}}),e&&Co(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(yt(Wse(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+Jl.o+'">'+i.join("")+"</"+r+">"}function svt(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=Ge(8);return o.write_shift(4,r),o.write_shift(4,i),o}function soe(t,e){var n=Ge(4),r=Ge(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=Ge(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=svt(e);break;case 31:case 80:for(r=Ge(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Io([n,r])}var dbe=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ovt(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function ooe(t,e,n){var r=Ge(8),i=[],s=[],o=8,a=0,l=Ge(8),c=Ge(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!e){c=Ge(8),c.write_shift(4,0),i.unshift(c);var u=[Ge(4)];for(u[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=Ge(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Io(u),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(dbe.indexOf(t[a][0])>-1||cbe.indexOf(t[a][0])>-1)&&t[a][1]!=null){var f=t[a][1],g=0;if(e){g=+e[t[a][0]];var v=n[g];if(v.p=="version"&&typeof f=="string"){var x=f.split(".");f=(+x[0]<<16)+(+x[1]||0)}l=soe(v.t,f)}else{var b=ovt(f);b==-1&&(b=31,f=String(f)),l=soe(b,f)}s.push(l),c=Ge(8),c.write_shift(4,e?g:2+a),i.push(c),o+=8+l.length}var T=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,T),T+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),Io([r].concat(i).concat(s))}function aoe(t,e,n,r,i,s){var o=Ge(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,qr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=ooe(t,n,r);if(a.push(l),i){var c=ooe(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Io(a)}function avt(t,e){e||(e=Ge(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function lvt(t,e){return t.read_shift(e)===1}function ka(t,e){return e||(e=Ge(2)),e.write_shift(2,+!!t),e}function fbe(t){return t.read_shift(2,"u")}function Fc(t,e){return e||(e=Ge(2)),e.write_shift(2,t),e}function pbe(t,e,n){return n||(n=Ge(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function mbe(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?t.read_shift(r,i):"";return o}function cvt(t){var e=t.t||"",n=Ge(3);n.write_shift(2,e.length),n.write_shift(1,1);var r=Ge(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[n,r];return Io(i)}function uvt(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function hvt(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):uvt(t,r,n)}function dvt(t,e,n){if(n.biff>5)return hvt(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function gbe(t,e,n){return n||(n=Ge(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function loe(t,e){e||(e=Ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function fvt(t){var e=Ge(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)e.write_shift(4,o[n]);if(s==28)r=r.slice(1),loe(r,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)e.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)e.write_shift(2,a.charCodeAt(n));e.write_shift(2,0),s&8&&loe(i>-1?r.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)e.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)e.write_shift(1,r.charCodeAt(n+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function W1(t,e,n,r){return r||(r=Ge(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function pvt(t,e,n){var r=n.biff>8?4:2,i=t.read_shift(r),s=t.read_shift(r,"i"),o=t.read_shift(r,"i");return[i,s,o]}function mvt(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:n}}}function ybe(t,e){return e||(e=Ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function jH(t,e,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ge(i);return s.write_shift(2,r),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function gvt(t,e){var n=!e||e.biff==8,r=Ge(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function yvt(t,e){var n=!e||e.biff>=8?2:1,r=Ge(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function vvt(t,e){var n=Ge(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],i=0;i<t.length;++i)r[i]=cvt(t[i]);var s=Io([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function _vt(){var t=Ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function xvt(t){var e=Ge(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function wvt(t,e){var n=t.name||"Arial",r=e&&e.biff==5,i=r?15+n.length:16+2*n.length,s=Ge(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function bvt(t,e,n,r){var i=Ge(10);return W1(t,e,r,i),i.write_shift(4,n),i}function Evt(t,e,n,r,i){var s=!i||i.biff==8,o=Ge(8+ +s+(1+s)*n.length);return W1(t,e,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function Svt(t,e,n,r){var i=n&&n.biff==5;r||(r=Ge(i?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Tvt(t,e){var n=e.biff==8||!e.biff?4:2,r=Ge(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function coe(t,e,n,r){var i=n&&n.biff==5;r||(r=Ge(i?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function kvt(t){var e=Ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Avt(t,e,n,r,i,s){var o=Ge(8);return W1(t,e,r,o),pbe(n,s,o),o}function Ivt(t,e,n,r){var i=Ge(14);return W1(t,e,r,i),B1(n,i),i}function Rvt(t,e,n){if(n.biff<8)return Pvt(t,e,n);for(var r=[],i=t.l+e,s=t.read_shift(n.biff>8?4:2);s--!==0;)r.push(pvt(t,n.biff>8?12:6,n));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return r}function Pvt(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=mbe(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function Mvt(t){var e=Ge(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)ybe(t[n],e);return e}function Cvt(t){var e=Ge(24),n=ao(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return Io([e,fvt(t[1])])}function Nvt(t){var e=t[1].Tooltip,n=Ge(10+2*(e.length+1));n.write_shift(2,2048);var r=ao(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<e.length;++i)n.write_shift(2,e.charCodeAt(i));return n.write_shift(2,0),n}function Ovt(t){return t||(t=Ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Lvt(t,e,n){if(!n.cellStyles)return Pd(t,e);var r=n&&n.biff>=12?4:2,i=t.read_shift(r),s=t.read_shift(r),o=t.read_shift(r),a=t.read_shift(r),l=t.read_shift(2);r==2&&(t.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}function Dvt(t,e){var n=Ge(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function $vt(t){for(var e=Ge(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}function jvt(t,e,n){var r=Ge(15);return FI(r,t,e),r.write_shift(8,n,"f"),r}function Fvt(t,e,n){var r=Ge(9);return FI(r,t,e),r.write_shift(2,n),r}var Vvt=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=AH({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var c=[],u=G1(1);switch(l.type){case"base64":u=Ku(dp(a));break;case"binary":u=Ku(a);break;case"buffer":case"array":u=a;break}Kl(u,0);var h=u.read_shift(1),f=!!(h&136),g=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:g=!0,f=!0;break;case 49:g=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,b=521;h==2&&(x=u.read_shift(2)),u.l+=3,h!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(b=u.read_shift(2));var T=u.read_shift(2),A=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(A=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var I=[],R={},C=Math.min(u.length,h==2?521:b-10-(g?264:0)),V=v?32:11;u.l<C&&u[u.l]!=13;)switch(R={},R.name=AN.utils.decode(A,u.slice(u.l,u.l+V)).replace(/[\u0000\r\n].*$/g,""),u.l+=V,R.type=String.fromCharCode(u.read_shift(1)),h!=2&&!v&&(R.offset=u.read_shift(4)),R.len=u.read_shift(1),h==2&&(R.offset=u.read_shift(2)),R.dec=u.read_shift(1),R.name.length&&I.push(R),h!=2&&(u.l+=v?13:14),R.type){case"B":(!g||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var M=0,N=0;for(c[0]=[],N=0;N!=I.length;++N)c[0][N]=I[N].name;for(;x-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,c[++M]=[],N=0,N=0;N!=I.length;++N){var O=u.slice(u.l,u.l+I[N].len);u.l+=I[N].len,Kl(O,0);var F=AN.utils.decode(A,O);switch(I[N].type){case"C":F.trim().length&&(c[M][N]=F.replace(/\s+$/,""));break;case"D":F.length===8?c[M][N]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):c[M][N]=F;break;case"F":c[M][N]=parseFloat(F.trim());break;case"+":case"I":c[M][N]=v?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":c[M][N]=!0;break;case"N":case"F":c[M][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[M][N]="##MEMO##"+(v?parseInt(F.trim(),10):O.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(c[M][N]=+F||0);break;case"@":c[M][N]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":c[M][N]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":c[M][N]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[M][N]=-O.read_shift(-8,"f");break;case"B":if(g&&I[N].len==8){c[M][N]=O.read_shift(8,"f");break}case"G":case"P":O.l+=I[N].len;break;case"0":if(I[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[N].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=I,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=fb(n(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return hv(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&sA(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=_l(),h=VN(a,{header:1,raw:!0,cellDates:!0}),f=h[0],g=h.slice(1),v=a["!cols"]||[],x=0,b=0,T=0,A=1;for(x=0;x<f.length;++x){if(((v[x]||{}).DBF||{}).name){f[x]=v[x].DBF.name,++T;continue}if(f[x]!=null){if(++T,typeof f[x]=="number"&&(f[x]=f[x].toString(10)),typeof f[x]!="string")throw new Error("DBF Invalid column name "+f[x]+" |"+typeof f[x]+"|");if(f.indexOf(f[x])!==x){for(b=0;b<1024;++b)if(f.indexOf(f[x]+"_"+b)==-1){f[x]+="_"+b;break}}}}var I=fi(a["!ref"]),R=[],C=[],V=[];for(x=0;x<=I.e.c-I.s.c;++x){var M="",N="",O=0,F=[];for(b=0;b<g.length;++b)g[b][x]!=null&&F.push(g[b][x]);if(F.length==0||f[x]==null){R[x]="?";continue}for(b=0;b<F.length;++b){switch(typeof F[b]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=F[b]instanceof Date?"D":"C";break;default:N="C"}O=Math.max(O,String(F[b]).length),M=M&&M!=N?"C":N}O>250&&(O=250),N=((v[x]||{}).DBF||{}).type,N=="C"&&v[x].DBF.len>O&&(O=v[x].DBF.len),M=="B"&&N=="N"&&(M="N",V[x]=v[x].DBF.dec,O=v[x].DBF.len),C[x]=M=="C"||N=="N"?O:s[M]||0,A+=C[x],R[x]=M}var L=u.next(32);for(L.write_shift(4,318902576),L.write_shift(4,g.length),L.write_shift(2,296+32*T),L.write_shift(2,A),x=0;x<4;++x)L.write_shift(4,0);for(L.write_shift(4,0|(+e[_2e]||3)<<8),x=0,b=0;x<f.length;++x)if(f[x]!=null){var B=u.next(32),U=(f[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,U,"sbcs"),B.write_shift(1,R[x]=="?"?"C":R[x],"sbcs"),B.write_shift(4,b),B.write_shift(1,C[x]||s[R[x]]||0),B.write_shift(1,V[x]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),b+=C[x]||s[R[x]]||0}var de=u.next(264);for(de.write_shift(4,13),x=0;x<65;++x)de.write_shift(4,0);for(x=0;x<g.length;++x){var me=u.next(A);for(me.write_shift(1,0),b=0;b<f.length;++b)if(f[b]!=null)switch(R[b]){case"L":me.write_shift(1,g[x][b]==null?63:g[x][b]?84:70);break;case"B":me.write_shift(8,g[x][b]||0,"f");break;case"N":var ze="0";for(typeof g[x][b]=="number"&&(ze=g[x][b].toFixed(V[b]||0)),T=0;T<C[b]-ze.length;++T)me.write_shift(1,32);me.write_shift(1,ze,"sbcs");break;case"D":g[x][b]?(me.write_shift(4,("0000"+g[x][b].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(g[x][b].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+g[x][b].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var Le=String(g[x][b]!=null?g[x][b]:"").slice(0,C[b]);for(me.write_shift(1,Le,"sbcs"),T=0;T<C[b]-Le.length;++T)me.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}})(),zvt=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Co(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(f,g){var v=t[g];return typeof v=="number"?Nse(v):v},r=function(f,g,v){var x=g.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?f:Nse(x)};t["|"]=254;function i(f,g){switch(g.type){case"base64":return s(dp(f),g);case"binary":return s(f,g);case"buffer":return s(wr&&Buffer.isBuffer(f)?f.toString("binary"):OI(f),g);case"array":return s(aL(f),g)}throw new Error("Unrecognized type "+g.type)}function s(f,g){var v=f.split(/[\n\r]+/),x=-1,b=-1,T=0,A=0,I=[],R=[],C=null,V={},M=[],N=[],O=[],F=0,L;for(+g.codepage>=0&&sA(+g.codepage);T!==v.length;++T){F=0;var B=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),U=B.replace(/;;/g,"\0").split(";").map(function(ae){return ae.replace(/\u0000/g,";")}),de=U[0],me;if(B.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&R.push(B.slice(3).replace(/;;/g,";"));break;case"C":var ze=!1,Le=!1,fe=!1,$e=!1,Ce=-1,le=-1;for(A=1;A<U.length;++A)switch(U[A].charAt(0)){case"A":break;case"X":b=parseInt(U[A].slice(1))-1,Le=!0;break;case"Y":for(x=parseInt(U[A].slice(1))-1,Le||(b=0),L=I.length;L<=x;++L)I[L]=[];break;case"K":me=U[A].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(ep(me))?isNaN(aA(me).getDate())||(me=Da(me)):(me=ep(me),C!==null&&M2e(C)&&(me=L2e(me))),ze=!0;break;case"E":$e=!0;var W=F_t(U[A].slice(1),{r:x,c:b});I[x][b]=[I[x][b],W];break;case"S":fe=!0,I[x][b]=[I[x][b],"S5S"];break;case"G":break;case"R":Ce=parseInt(U[A].slice(1))-1;break;case"C":le=parseInt(U[A].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}if(ze&&(I[x][b]&&I[x][b].length==2?I[x][b][0]=me:I[x][b]=me,C=null),fe){if($e)throw new Error("SYLK shared formula cannot have own formula");var ne=Ce>-1&&I[Ce][le];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");I[x][b][1]=V_t(ne[1],{r:x-Ce,c:b-le})}break;case"F":var se=0;for(A=1;A<U.length;++A)switch(U[A].charAt(0)){case"X":b=parseInt(U[A].slice(1))-1,++se;break;case"Y":for(x=parseInt(U[A].slice(1))-1,L=I.length;L<=x;++L)I[L]=[];break;case"M":F=parseInt(U[A].slice(1))/20;break;case"F":break;case"G":break;case"P":C=R[parseInt(U[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=U[A].slice(1).split(" "),L=parseInt(O[0],10);L<=parseInt(O[1],10);++L)F=parseInt(O[2],10),N[L-1]=F===0?{hidden:!0}:{wch:F},FH(N[L-1]);break;case"C":b=parseInt(U[A].slice(1))-1,N[b]||(N[b]={});break;case"R":x=parseInt(U[A].slice(1))-1,M[x]||(M[x]={}),F>0?(M[x].hpt=F,M[x].hpx=bbe(F)):F===0&&(M[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}se<1&&(C=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+B)}}return M.length>0&&(V["!rows"]=M),N.length>0&&(V["!cols"]=N),g&&g.sheetRows&&(I=I.slice(0,g.sheetRows)),[I,V]}function o(f,g){var v=i(f,g),x=v[0],b=v[1],T=fb(x,g);return Co(b).forEach(function(A){T[A]=b[A]}),T}function a(f,g){return hv(o(f,g),g)}function l(f,g,v,x){var b="C;Y"+(v+1)+";X"+(x+1)+";K";switch(f.t){case"n":b+=f.v||0,f.f&&!f.F&&(b+=";E"+zH(f.f,{r:v,c:x}));break;case"b":b+=f.v?"TRUE":"FALSE";break;case"e":b+=f.w||f.v;break;case"d":b+='"'+(f.w||f.v)+'"';break;case"s":b+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function c(f,g){g.forEach(function(v,x){var b="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?b+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=DN(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=$N(v.wpx)),typeof v.wch=="number"&&(b+=Math.round(v.wch))),b.charAt(b.length-1)!=" "&&f.push(b)})}function u(f,g){g.forEach(function(v,x){var b="F;";v.hidden?b+="M0;":v.hpt?b+="M"+20*v.hpt+";":v.hpx&&(b+="M"+20*jN(v.hpx)+";"),b.length>2&&f.push(b+"R"+(x+1))})}function h(f,g){var v=["ID;PWXL;N;E"],x=[],b=fi(f["!ref"]),T,A=Array.isArray(f),I=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&c(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var R=b.s.r;R<=b.e.r;++R)for(var C=b.s.c;C<=b.e.c;++C){var V=Br({r:R,c:C});T=A?(f[R]||[])[C]:f[V],!(!T||T.v==null&&(!T.f||T.F))&&x.push(l(T,f,R,C))}return v.join(I)+I+x.join(I)+I+"E"+I}return{to_workbook:a,to_sheet:o,from_sheet:h}})(),Uvt=(function(){function t(s,o){switch(o.type){case"base64":return e(dp(s),o);case"binary":return e(s,o);case"buffer":return e(wr&&Buffer.isBuffer(s)?s.toString("binary"):OI(s),o);case"array":return e(aL(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var f=a[u].trim().split(","),g=f[0],v=f[1];++u;for(var x=a[u]||"";(x.match(/["]/g)||[]).length&1&&u<a.length-1;)x+=`
`+a[++u];switch(x=x.trim(),+g){case-1:if(x==="BOT"){h[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[l][c]=!0:x==="FALSE"?h[l][c]=!1:isNaN(ep(v))?isNaN(aA(v).getDate())?h[l][c]=v:h[l][c]=Da(v):h[l][c]=ep(v),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function n(s,o){return fb(t(s,o),o)}function r(s,o){return hv(n(s,o),o)}var i=(function(){var s=function(l,c,u,h,f){l.push(c),l.push(u+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=fi(l["!ref"]),h,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var g=u.s.r;g<=u.e.r;++g){o(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var x=Br({r:g,c:v});if(h=f?(l[g]||[])[v]:l[x],!h){o(c,1,0,"");continue}switch(h.t){case"n":var b=h.w;!b&&h.v!=null&&(b=h.v),b==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,b,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Bg(h.z||Qi[14],Sl(Da(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var T=`\r
`,A=c.join(T);return A}})();return{to_workbook:r,to_sheet:n,from_sheet:i}})(),vbe=(function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,f){for(var g=h.split(`
`),v=-1,x=-1,b=0,T=[];b!==g.length;++b){var A=g[b].trim().split(":");if(A[0]==="cell"){var I=ao(A[1]);if(T.length<=I.r)for(v=T.length;v<=I.r;++v)T[v]||(T[v]=[]);switch(v=I.r,x=I.c,A[2]){case"t":T[v][x]=t(A[3]);break;case"v":T[v][x]=+A[3];break;case"vtf":var R=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[v][x]=!!+A[4];break;default:T[v][x]=+A[4];break}A[2]=="vtf"&&(T[v][x]=[T[v][x],R])}}}return f&&f.sheetRows&&(T=T.slice(0,f.sheetRows)),T}function r(h,f){return fb(n(h,f),f)}function i(h,f){return hv(r(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],g=[],v,x="",b=pc(h["!ref"]),T=Array.isArray(h),A=b.s.r;A<=b.e.r;++A)for(var I=b.s.c;I<=b.e.c;++I)if(x=Br({r:A,c:I}),v=T?(h[A]||[])[I]:h[x],!(!v||v.v==null||v.t==="z")){switch(g=["cell",x,"t"],v.t){case"s":case"str":g.push(e(v.v));break;case"n":v.f?(g[2]="vtf",g[3]="n",g[4]=v.v,g[5]=e(v.f)):(g[2]="v",g[3]=v.v);break;case"b":g[2]="vt"+(v.f?"f":"c"),g[3]="nl",g[4]=v.v?"1":"0",g[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var R=Sl(Da(v.v));g[2]="vtc",g[3]="nd",g[4]=""+R,g[5]=v.w||Bg(v.z||Qi[14],R);break;case"e":continue}f.push(g.join(":"))}return f.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}})(),Gvt=(function(){function t(u,h,f,g,v){v.raw?h[f][g]=u:u===""||(u==="TRUE"?h[f][g]=!0:u==="FALSE"?h[f][g]=!1:isNaN(ep(u))?isNaN(aA(u).getDate())?h[f][g]=u:h[f][g]=Da(u):h[f][g]=ep(u))}function e(u,h){var f=h||{},g=[];if(!u||u.length===0)return g;for(var v=u.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var b=10,T=0,A=0;A<=x;++A)T=v[A].indexOf(" "),T==-1?T=v[A].length:T++,b=Math.max(b,T);for(A=0;A<=x;++A){g[A]=[];var I=0;for(t(v[A].slice(0,b).trim(),g,A,I,f),I=1;I<=(v[A].length-b)/10+1;++I)t(v[A].slice(b+(I-1)*10,b+I*10).trim(),g,A,I,f)}return f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var h={},f=!1,g=0,v=0;g<u.length;++g)(v=u.charCodeAt(g))==34?f=!f:!f&&v in n&&(h[v]=(h[v]||0)+1);v=[];for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&v.push([h[g],g]);if(!v.length){h=r;for(g in h)Object.prototype.hasOwnProperty.call(h,g)&&v.push([h[g],g])}return v.sort(function(x,b){return x[0]-b[0]||r[x[1]]-r[b[1]]}),n[v.pop()[1]]||44}function s(u,h){var f=h||{},g="",v=f.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(g=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(g=u.charAt(4),u=u.slice(6)):g=i(u.slice(0,1024)):f&&f.FS?g=f.FS:g=i(u.slice(0,1024));var b=0,T=0,A=0,I=0,R=0,C=g.charCodeAt(0),V=!1,M=0,N=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var O=f.dateNF!=null?s1t(f.dateNF):null;function F(){var L=u.slice(I,R),B={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)B.t="z";else if(f.raw)B.t="s",B.v=L;else if(L.trim().length===0)B.t="s",B.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(B.t="s",B.v=L.slice(2,-1).replace(/""/g,'"')):z_t(L)?(B.t="n",B.f=L.slice(1)):(B.t="s",B.v=L);else if(L=="TRUE")B.t="b",B.v=!0;else if(L=="FALSE")B.t="b",B.v=!1;else if(!isNaN(A=ep(L)))B.t="n",f.cellText!==!1&&(B.w=L),B.v=A;else if(!isNaN(aA(L).getDate())||O&&L.match(O)){B.z=f.dateNF||Qi[14];var U=0;O&&L.match(O)&&(L=o1t(L,f.dateNF,L.match(O)||[]),U=1),f.cellDates?(B.t="d",B.v=Da(L,U)):(B.t="n",B.v=Sl(Da(L,U))),f.cellText!==!1&&(B.w=Bg(B.z,B.v instanceof Date?Sl(B.v):B.v)),f.cellNF||delete B.z}else B.t="s",B.v=L;if(B.t=="z"||(f.dense?(v[b]||(v[b]=[]),v[b][T]=B):v[Br({c:T,r:b})]=B),I=R+1,N=u.charCodeAt(I),x.e.c<T&&(x.e.c=T),x.e.r<b&&(x.e.r=b),M==C)++T;else if(T=0,++b,f.sheetRows&&f.sheetRows<=b)return!0}e:for(;R<u.length;++R)switch(M=u.charCodeAt(R)){case 34:N===34&&(V=!V);break;case C:case 10:case 13:if(!V&&F())break e;break}return R-I>0&&F(),v["!ref"]=ks(x),v}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):fb(e(u,h),h)}function a(u,h){var f="",g=h.type=="string"?[0,0,0,0]:tEt(u,h);switch(h.type){case"base64":f=dp(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof AN<"u"||(f=wr&&Buffer.isBuffer(u)?u.toString("binary"):OI(u));break;case"array":f=aL(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return g[0]==239&&g[1]==187&&g[2]==191?f=DT(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=DT(f):h.type=="binary"&&typeof AN<"u",f.slice(0,19)=="socialcalc:version:"?vbe.to_sheet(h.type=="string"?f:DT(f),h):o(f,h)}function l(u,h){return hv(a(u,h),h)}function c(u){for(var h=[],f=fi(u["!ref"]),g,v=Array.isArray(u),x=f.s.r;x<=f.e.r;++x){for(var b=[],T=f.s.c;T<=f.e.c;++T){var A=Br({r:x,c:T});if(g=v?(u[x]||[])[T]:u[A],!g||g.v==null){b.push("          ");continue}for(var I=(g.w||(fp(g),g.w)||"").slice(0,10);I.length<10;)I+=" ";b.push(I+(T===0?" ":""))}h.push(b.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}})(),uoe=(function(){function t(W,ne,se){if(W){Kl(W,W.l||0);for(var ae=se.Enum||Ce;W.l<W.length;){var _e=W.read_shift(2),Ke=ae[_e]||ae[65535],Ye=W.read_shift(2),ke=W.l+Ye,Te=Ke.f&&Ke.f(W,Ye,se);if(W.l=ke,ne(Te,Ke,_e))return}}}function e(W,ne){switch(ne.type){case"base64":return n(Ku(dp(W)),ne);case"binary":return n(Ku(W),ne);case"buffer":case"array":return n(W,ne)}throw"Unsupported type "+ne.type}function n(W,ne){if(!W)return W;var se=ne||{},ae=se.dense?[]:{},_e="Sheet1",Ke="",Ye=0,ke={},Te=[],Dt=[],qe={s:{r:0,c:0},e:{r:0,c:0}},sn=se.sheetRows||0;if(W[2]==0&&(W[3]==8||W[3]==9)&&W.length>=16&&W[14]==5&&W[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(W[2]==2)se.Enum=Ce,t(W,function(dt,lr,$n){switch($n){case 0:se.vers=dt,dt>=4096&&(se.qpro=!0);break;case 6:qe=dt;break;case 204:dt&&(Ke=dt);break;case 222:Ke=dt;break;case 15:case 51:se.qpro||(dt[1].v=dt[1].v.slice(1));case 13:case 14:case 16:$n==14&&(dt[2]&112)==112&&(dt[2]&15)>1&&(dt[2]&15)<15&&(dt[1].z=se.dateNF||Qi[14],se.cellDates&&(dt[1].t="d",dt[1].v=L2e(dt[1].v))),se.qpro&&dt[3]>Ye&&(ae["!ref"]=ks(qe),ke[_e]=ae,Te.push(_e),ae=se.dense?[]:{},qe={s:{r:0,c:0},e:{r:0,c:0}},Ye=dt[3],_e=Ke||"Sheet"+(Ye+1),Ke="");var Un=se.dense?(ae[dt[0].r]||[])[dt[0].c]:ae[Br(dt[0])];if(Un){Un.t=dt[1].t,Un.v=dt[1].v,dt[1].z!=null&&(Un.z=dt[1].z),dt[1].f!=null&&(Un.f=dt[1].f);break}se.dense?(ae[dt[0].r]||(ae[dt[0].r]=[]),ae[dt[0].r][dt[0].c]=dt[1]):ae[Br(dt[0])]=dt[1];break}},se);else if(W[2]==26||W[2]==14)se.Enum=le,W[2]==14&&(se.qpro=!0,W.l=0),t(W,function(dt,lr,$n){switch($n){case 204:_e=dt;break;case 22:dt[1].v=dt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(dt[3]>Ye&&(ae["!ref"]=ks(qe),ke[_e]=ae,Te.push(_e),ae=se.dense?[]:{},qe={s:{r:0,c:0},e:{r:0,c:0}},Ye=dt[3],_e="Sheet"+(Ye+1)),sn>0&&dt[0].r>=sn)break;se.dense?(ae[dt[0].r]||(ae[dt[0].r]=[]),ae[dt[0].r][dt[0].c]=dt[1]):ae[Br(dt[0])]=dt[1],qe.e.c<dt[0].c&&(qe.e.c=dt[0].c),qe.e.r<dt[0].r&&(qe.e.r=dt[0].r);break;case 27:dt[14e3]&&(Dt[dt[14e3][0]]=dt[14e3][1]);break;case 1537:Dt[dt[0]]=dt[1],dt[0]==Ye&&(_e=dt[1]);break}},se);else throw new Error("Unrecognized LOTUS BOF "+W[2]);if(ae["!ref"]=ks(qe),ke[Ke||_e]=ae,Te.push(Ke||_e),!Dt.length)return{SheetNames:Te,Sheets:ke};for(var $t={},fn=[],yn=0;yn<Dt.length;++yn)ke[Te[yn]]?(fn.push(Dt[yn]||Te[yn]),$t[Dt[yn]]=ke[Dt[yn]]||ke[Te[yn]]):(fn.push(Dt[yn]),$t[Dt[yn]]={"!ref":"A1"});return{SheetNames:fn,Sheets:$t}}function r(W,ne){var se=ne||{};if(+se.codepage>=0&&sA(+se.codepage),se.type=="string")throw new Error("Cannot write WK1 to JS string");var ae=_l(),_e=fi(W["!ref"]),Ke=Array.isArray(W),Ye=[];vt(ae,0,s(1030)),vt(ae,6,l(_e));for(var ke=Math.min(_e.e.r,8191),Te=_e.s.r;Te<=ke;++Te)for(var Dt=Mo(Te),qe=_e.s.c;qe<=_e.e.c;++qe){Te===_e.s.r&&(Ye[qe]=ma(qe));var sn=Ye[qe]+Dt,$t=Ke?(W[Te]||[])[qe]:W[sn];if(!(!$t||$t.t=="z"))if($t.t=="n")($t.v|0)==$t.v&&$t.v>=-32768&&$t.v<=32767?vt(ae,13,g(Te,qe,$t.v)):vt(ae,14,x(Te,qe,$t.v));else{var fn=fp($t);vt(ae,15,h(Te,qe,fn.slice(0,239)))}}return vt(ae,1),ae.end()}function i(W,ne){var se=ne||{};if(+se.codepage>=0&&sA(+se.codepage),se.type=="string")throw new Error("Cannot write WK3 to JS string");var ae=_l();vt(ae,0,o(W));for(var _e=0,Ke=0;_e<W.SheetNames.length;++_e)(W.Sheets[W.SheetNames[_e]]||{})["!ref"]&&vt(ae,27,$e(W.SheetNames[_e],Ke++));var Ye=0;for(_e=0;_e<W.SheetNames.length;++_e){var ke=W.Sheets[W.SheetNames[_e]];if(!(!ke||!ke["!ref"])){for(var Te=fi(ke["!ref"]),Dt=Array.isArray(ke),qe=[],sn=Math.min(Te.e.r,8191),$t=Te.s.r;$t<=sn;++$t)for(var fn=Mo($t),yn=Te.s.c;yn<=Te.e.c;++yn){$t===Te.s.r&&(qe[yn]=ma(yn));var dt=qe[yn]+fn,lr=Dt?(ke[$t]||[])[yn]:ke[dt];if(!(!lr||lr.t=="z"))if(lr.t=="n")vt(ae,23,F($t,yn,Ye,lr.v));else{var $n=fp(lr);vt(ae,22,M($t,yn,Ye,$n.slice(0,239)))}}++Ye}}return vt(ae,1),ae.end()}function s(W){var ne=Ge(2);return ne.write_shift(2,W),ne}function o(W){var ne=Ge(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var se=0,ae=0,_e=0,Ke=0;Ke<W.SheetNames.length;++Ke){var Ye=W.SheetNames[Ke],ke=W.Sheets[Ye];if(!(!ke||!ke["!ref"])){++_e;var Te=pc(ke["!ref"]);se<Te.e.r&&(se=Te.e.r),ae<Te.e.c&&(ae=Te.e.c)}}return se>8191&&(se=8191),ne.write_shift(2,se),ne.write_shift(1,_e),ne.write_shift(1,ae),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function a(W,ne,se){var ae={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&se.qpro?(ae.s.c=W.read_shift(1),W.l++,ae.s.r=W.read_shift(2),ae.e.c=W.read_shift(1),W.l++,ae.e.r=W.read_shift(2),ae):(ae.s.c=W.read_shift(2),ae.s.r=W.read_shift(2),ne==12&&se.qpro&&(W.l+=2),ae.e.c=W.read_shift(2),ae.e.r=W.read_shift(2),ne==12&&se.qpro&&(W.l+=2),ae.s.c==65535&&(ae.s.c=ae.e.c=ae.s.r=ae.e.r=0),ae)}function l(W){var ne=Ge(8);return ne.write_shift(2,W.s.c),ne.write_shift(2,W.s.r),ne.write_shift(2,W.e.c),ne.write_shift(2,W.e.r),ne}function c(W,ne,se){var ae=[{c:0,r:0},{t:"n",v:0},0,0];return se.qpro&&se.vers!=20768?(ae[0].c=W.read_shift(1),ae[3]=W.read_shift(1),ae[0].r=W.read_shift(2),W.l+=2):(ae[2]=W.read_shift(1),ae[0].c=W.read_shift(2),ae[0].r=W.read_shift(2)),ae}function u(W,ne,se){var ae=W.l+ne,_e=c(W,ne,se);if(_e[1].t="s",se.vers==20768){W.l++;var Ke=W.read_shift(1);return _e[1].v=W.read_shift(Ke,"utf8"),_e}return se.qpro&&W.l++,_e[1].v=W.read_shift(ae-W.l,"cstr"),_e}function h(W,ne,se){var ae=Ge(7+se.length);ae.write_shift(1,255),ae.write_shift(2,ne),ae.write_shift(2,W),ae.write_shift(1,39);for(var _e=0;_e<ae.length;++_e){var Ke=se.charCodeAt(_e);ae.write_shift(1,Ke>=128?95:Ke)}return ae.write_shift(1,0),ae}function f(W,ne,se){var ae=c(W,ne,se);return ae[1].v=W.read_shift(2,"i"),ae}function g(W,ne,se){var ae=Ge(7);return ae.write_shift(1,255),ae.write_shift(2,ne),ae.write_shift(2,W),ae.write_shift(2,se,"i"),ae}function v(W,ne,se){var ae=c(W,ne,se);return ae[1].v=W.read_shift(8,"f"),ae}function x(W,ne,se){var ae=Ge(13);return ae.write_shift(1,255),ae.write_shift(2,ne),ae.write_shift(2,W),ae.write_shift(8,se,"f"),ae}function b(W,ne,se){var ae=W.l+ne,_e=c(W,ne,se);if(_e[1].v=W.read_shift(8,"f"),se.qpro)W.l=ae;else{var Ke=W.read_shift(2);R(W.slice(W.l,W.l+Ke),_e),W.l+=Ke}return _e}function T(W,ne,se){var ae=ne&32768;return ne&=-32769,ne=(ae?W:0)+(ne>=8192?ne-16384:ne),(ae?"":"$")+(se?ma(ne):Mo(ne))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(W,ne){Kl(W,0);for(var se=[],ae=0,_e="",Ke="",Ye="",ke="";W.l<W.length;){var Te=W[W.l++];switch(Te){case 0:se.push(W.read_shift(8,"f"));break;case 1:Ke=T(ne[0].c,W.read_shift(2),!0),_e=T(ne[0].r,W.read_shift(2),!1),se.push(Ke+_e);break;case 2:{var Dt=T(ne[0].c,W.read_shift(2),!0),qe=T(ne[0].r,W.read_shift(2),!1);Ke=T(ne[0].c,W.read_shift(2),!0),_e=T(ne[0].r,W.read_shift(2),!1),se.push(Dt+qe+":"+Ke+_e)}break;case 3:if(W.l<W.length){console.error("WK1 premature formula end");return}break;case 4:se.push("("+se.pop()+")");break;case 5:se.push(W.read_shift(2));break;case 6:{for(var sn="";Te=W[W.l++];)sn+=String.fromCharCode(Te);se.push('"'+sn.replace(/"/g,'""')+'"')}break;case 8:se.push("-"+se.pop());break;case 23:se.push("+"+se.pop());break;case 22:se.push("NOT("+se.pop()+")");break;case 20:case 21:ke=se.pop(),Ye=se.pop(),se.push(["AND","OR"][Te-20]+"("+Ye+","+ke+")");break;default:if(Te<32&&I[Te])ke=se.pop(),Ye=se.pop(),se.push(Ye+I[Te]+ke);else if(A[Te]){if(ae=A[Te][1],ae==69&&(ae=W[W.l++]),ae>se.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+se.join("|")+"|");return}var $t=se.slice(-ae);se.length-=ae,se.push(A[Te][0]+"("+$t.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}se.length==1?ne[1].f=""+se[0]:console.error("WK1 bad formula parse |"+se.join("|")+"|")}function C(W){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=W.read_shift(2),ne[3]=W[W.l++],ne[0].c=W[W.l++],ne}function V(W,ne){var se=C(W);return se[1].t="s",se[1].v=W.read_shift(ne-4,"cstr"),se}function M(W,ne,se,ae){var _e=Ge(6+ae.length);_e.write_shift(2,W),_e.write_shift(1,se),_e.write_shift(1,ne),_e.write_shift(1,39);for(var Ke=0;Ke<ae.length;++Ke){var Ye=ae.charCodeAt(Ke);_e.write_shift(1,Ye>=128?95:Ye)}return _e.write_shift(1,0),_e}function N(W,ne){var se=C(W);se[1].v=W.read_shift(2);var ae=se[1].v>>1;if(se[1].v&1)switch(ae&7){case 0:ae=(ae>>3)*5e3;break;case 1:ae=(ae>>3)*500;break;case 2:ae=(ae>>3)/20;break;case 3:ae=(ae>>3)/200;break;case 4:ae=(ae>>3)/2e3;break;case 5:ae=(ae>>3)/2e4;break;case 6:ae=(ae>>3)/16;break;case 7:ae=(ae>>3)/64;break}return se[1].v=ae,se}function O(W,ne){var se=C(W),ae=W.read_shift(4),_e=W.read_shift(4),Ke=W.read_shift(2);if(Ke==65535)return ae===0&&_e===3221225472?(se[1].t="e",se[1].v=15):ae===0&&_e===3489660928?(se[1].t="e",se[1].v=42):se[1].v=0,se;var Ye=Ke&32768;return Ke=(Ke&32767)-16446,se[1].v=(1-Ye*2)*(_e*Math.pow(2,Ke+32)+ae*Math.pow(2,Ke)),se}function F(W,ne,se,ae){var _e=Ge(14);if(_e.write_shift(2,W),_e.write_shift(1,se),_e.write_shift(1,ne),ae==0)return _e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(2,65535),_e;var Ke=0,Ye=0,ke=0,Te=0;return ae<0&&(Ke=1,ae=-ae),Ye=Math.log2(ae)|0,ae/=Math.pow(2,Ye-31),Te=ae>>>0,(Te&2147483648)==0&&(ae/=2,++Ye,Te=ae>>>0),ae-=Te,Te|=2147483648,Te>>>=0,ae*=Math.pow(2,32),ke=ae>>>0,_e.write_shift(4,ke),_e.write_shift(4,Te),Ye+=16383+(Ke?32768:0),_e.write_shift(2,Ye),_e}function L(W,ne){var se=O(W);return W.l+=ne-14,se}function B(W,ne){var se=C(W),ae=W.read_shift(4);return se[1].v=ae>>6,se}function U(W,ne){var se=C(W),ae=W.read_shift(8,"f");return se[1].v=ae,se}function de(W,ne){var se=U(W);return W.l+=ne-10,se}function me(W,ne){return W[W.l+ne-1]==0?W.read_shift(ne,"cstr"):""}function ze(W,ne){var se=W[W.l++];se>ne-1&&(se=ne-1);for(var ae="";ae.length<se;)ae+=String.fromCharCode(W[W.l++]);return ae}function Le(W,ne,se){if(!(!se.qpro||ne<21)){var ae=W.read_shift(1);W.l+=17,W.l+=1,W.l+=2;var _e=W.read_shift(ne-21,"cstr");return[ae,_e]}}function fe(W,ne){for(var se={},ae=W.l+ne;W.l<ae;){var _e=W.read_shift(2);if(_e==14e3){for(se[_e]=[0,""],se[_e][0]=W.read_shift(2);W[W.l];)se[_e][1]+=String.fromCharCode(W[W.l]),W.l++;W.l++}}return se}function $e(W,ne){var se=Ge(5+W.length);se.write_shift(2,14e3),se.write_shift(2,ne);for(var ae=0;ae<W.length;++ae){var _e=W.charCodeAt(ae);se[se.l++]=_e>127?95:_e}return se[se.l++]=0,se}var Ce={0:{n:"BOF",f:fbe},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:ze},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}})(),Bvt=/^\s|\s$|[\t\n\r]/;function _be(t,e){if(!e.bookSST)return"";var n=[Is];n[n.length]=yt("sst",null,{xmlns:db[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var i=t[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Bvt)&&(s+=' xml:space="preserve"'),s+=">"+Ur(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function Wvt(t){return[t.read_shift(4),t.read_shift(4)]}function Hvt(t,e){return e||(e=Ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var qvt=$1t;function Kvt(t){var e=_l();tt(e,159,Hvt(t));for(var n=0;n<t.length;++n)tt(e,19,qvt(t[n]));return tt(e,160),e.end()}function Yvt(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function xbe(t){var e=0,n,r=Yvt(t),i=r.length+1,s,o,a,l,c;for(n=G1(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=(e&16384)===0?0:1,l=e<<1&32767,c=a|l,e=c^o;return e^52811}var Xvt=(function(){function t(i,s){switch(s.type){case"base64":return e(dp(i),s);case"binary":return e(i,s);case"buffer":return e(wr&&Buffer.isBuffer(i)?i.toString("binary"):OI(i),s);case"array":return e(aL(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,g=0,v,x=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var b=u.slice(g,f.lastIndex-v[0].length);if(b[0]==" "&&(b=b.slice(1)),++x,b.length){var T={v:b,t:"s"};Array.isArray(a)?a[h][x]=T:a[Br({r:h,c:x})]=T}break}g=f.lastIndex}x>c.e.c&&(c.e.c=x)}),a["!ref"]=ks(c),a}function n(i,s){return hv(t(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=fi(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=Br({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(fp(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}})();function hoe(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}var Zvt=6,tp=Zvt;function DN(t){return Math.floor((t+Math.round(128/tp)/256)*tp)}function $N(t){return Math.floor((t-5)/tp*100+.5)/100}function ez(t){return Math.round((t*tp+5)/tp*256)/256}function FH(t){t.width?(t.wpx=DN(t.width),t.wch=$N(t.wpx),t.MDW=tp):t.wpx?(t.wch=$N(t.wpx),t.width=ez(t.wch),t.MDW=tp):typeof t.wch=="number"&&(t.width=ez(t.wch),t.wpx=DN(t.width),t.MDW=tp),t.customWidth&&delete t.customWidth}var Jvt=96,wbe=Jvt;function jN(t){return t*96/wbe}function bbe(t){return t*wbe/96}function Qvt(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=yt("numFmt",null,{numFmtId:r,formatCode:Ur(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=yt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function e_t(t){var e=[];return e[e.length]=yt("cellXfs",null),t.forEach(function(n){e[e.length]=yt("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=yt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Ebe(t,e){var n=[Is,yt("styleSheet",null,{xmlns:db[0],"xmlns:vt":so.vt})],r;return t.SSF&&(r=Qvt(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=e_t(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function t_t(t,e){var n=t.read_shift(2),r=ga(t);return[n,r]}function n_t(t,e,n){n||(n=Ge(6+4*e.length)),n.write_shift(2,t),lo(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function r_t(t,e,n){var r={};r.sz=t.read_shift(2)/20;var i=B1t(t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=t.read_shift(2);switch(s===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(r.underline=o);var a=t.read_shift(1);a>0&&(r.family=a);var l=t.read_shift(1);switch(l>0&&(r.charset=l),t.l++,r.color=G1t(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ga(t),r}function i_t(t,e){e||(e=Ge(153)),e.write_shift(2,t.sz*20),W1t(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ON(t.color,e);var r=0;return r=2,e.write_shift(1,r),lo(t.name,e),e.length>e.l?e.slice(0,e.l):e}var s_t=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],P8,o_t=Pd;function doe(t,e){e||(e=Ge(84)),P8||(P8=AH(s_t));var n=P8[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(ON({auto:1},e),ON({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function a_t(t,e){var n=t.l+e,r=t.read_shift(2),i=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:i}}function Sbe(t,e,n){n||(n=Ge(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function jE(t,e){return e||(e=Ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var l_t=Pd;function c_t(t,e){return e||(e=Ge(51)),e.write_shift(1,0),jE(null,e),jE(null,e),jE(null,e),jE(null,e),jE(null,e),e.length>e.l?e.slice(0,e.l):e}function u_t(t,e){return e||(e=Ge(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),NN(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function h_t(t,e,n){var r=Ge(2052);return r.write_shift(4,t),NN(e,r),NN(n,r),r.length>r.l?r.slice(0,r.l):r}function d_t(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++n}),n!=0&&(tt(t,615,sh(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&tt(t,44,n_t(i,e[i]))}),tt(t,616))}}function f_t(t){var e=1;tt(t,611,sh(e)),tt(t,43,i_t({sz:12,color:{theme:1},name:"Calibri",family:2})),tt(t,612)}function p_t(t){var e=2;tt(t,603,sh(e)),tt(t,45,doe({patternType:"none"})),tt(t,45,doe({patternType:"gray125"})),tt(t,604)}function m_t(t){var e=1;tt(t,613,sh(e)),tt(t,46,c_t()),tt(t,614)}function g_t(t){var e=1;tt(t,626,sh(e)),tt(t,47,Sbe({numFmtId:0},65535)),tt(t,627)}function y_t(t,e){tt(t,617,sh(e.length)),e.forEach(function(n){tt(t,47,Sbe(n,0))}),tt(t,618)}function v_t(t){var e=1;tt(t,619,sh(e)),tt(t,48,u_t({xfId:0,name:"Normal"})),tt(t,620)}function __t(t){var e=0;tt(t,505,sh(e)),tt(t,506)}function x_t(t){var e=0;tt(t,508,h_t(e,"TableStyleMedium9","PivotStyleMedium4")),tt(t,509)}function w_t(t,e){var n=_l();return tt(n,278),d_t(n,t.SSF),f_t(n),p_t(n),m_t(n),g_t(n),y_t(n,e.cellXfs),v_t(n),__t(n),x_t(n),tt(n,279),n.end()}function Tbe(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[Is];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function b_t(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ga(t)}}function E_t(t){var e=Ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),lo(t.name,e),e.slice(0,e.l)}function S_t(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function T_t(t){var e=Ge(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function k_t(t,e){var n=Ge(8+2*e.length);return n.write_shift(4,t),lo(e,n),n.slice(0,n.l)}function A_t(t){return t.l+=4,t.read_shift(4)!=0}function I_t(t,e){var n=Ge(8);return n.write_shift(4,t),n.write_shift(4,1),n}function R_t(){var t=_l();return tt(t,332),tt(t,334,sh(1)),tt(t,335,E_t({name:"XLDAPR",version:12e4,flags:3496657072})),tt(t,336),tt(t,339,k_t(1,"XLDAPR")),tt(t,52),tt(t,35,sh(514)),tt(t,4096,sh(0)),tt(t,4097,Fc(1)),tt(t,36),tt(t,53),tt(t,340),tt(t,337,I_t(1)),tt(t,51,T_t([[1,0]])),tt(t,338),tt(t,333),t.end()}function kbe(){var t=[Is];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function P_t(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=Br(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Nx=1024;function Abe(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[yt("xml",null,{"xmlns:v":Jl.v,"xmlns:o":Jl.o,"xmlns:x":Jl.x,"xmlns:mv":Jl.mv}).replace(/\/>/,">"),yt("o:shapelayout",yt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),yt("v:shapetype",[yt("v:stroke",null,{joinstyle:"miter"}),yt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Nx<t*1e3;)Nx+=1e3;return e.forEach(function(s){var o=ao(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?yt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=yt("v:fill",l,a),u={on:"t",obscured:"t"};++Nx,i=i.concat(["<v:shape"+cA({id:"_x0000_s"+Nx,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,yt("v:shadow",null,u),yt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ro("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ro("x:AutoFill","False"),Ro("x:Row",String(o.r)),Ro("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Ibe(t){var e=[Is,yt("comments",null,{xmlns:db[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(i){var s=Ur(i.a);n.indexOf(s)==-1&&(n.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(Ur(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Ro("t",Ur(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(Ro("t",Ur(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function M_t(t,e,n){var r=[Is,yt("ThreadedComments",null,{xmlns:so.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),r.push(yt("threadedComment",Ro("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function C_t(t){var e=[Is,yt("personList",null,{xmlns:so.TCMNT,"xmlns:x":db[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(yt("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function N_t(t){var e={};e.iauthor=t.read_shift(4);var n=mv(t);return e.rfx=n.s,e.ref=Br(n.s),t.l+=16,e}function O_t(t,e){return e==null&&(e=Ge(36)),e.write_shift(4,t[1].iauthor),pb(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var L_t=ga;function D_t(t){return lo(t.slice(0,54))}function $_t(t){var e=_l(),n=[];return tt(e,628),tt(e,630),t.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),tt(e,632,D_t(i.a)))})}),tt(e,631),tt(e,633),t.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:ao(r[0]),e:ao(r[0])};tt(e,635,O_t([s,i])),i.t&&i.t.length>0&&tt(e,637,F1t(i)),tt(e,636),delete i.iauthor})}),tt(e,634),tt(e,629),e.end()}function j_t(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&qr.utils.cfb_add(t,i,e.FileIndex[r].content)}})}var Rbe=["xlsb","xlsm","xlam","biff8","xla"],F_t=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+ma(u)+(l?"":"$")+Mo(c)}return function(i,s){return e=s,i.replace(t,n)}})(),VH=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zH=(function(){return function(e,n){return e.replace(VH,function(r,i,s,o,a,l){var c=OH(o)-(s?0:n.c),u=NH(l)-(a?0:n.r),h=u==0?"":a?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}})();function V_t(t,e){return t.replace(VH,function(n,r,i,s,o,a){return r+(i=="$"?i+s:ma(OH(s)+e.c))+(o=="$"?o+a:Mo(NH(a)+e.r))})}function z_t(t){return t.length!=1}function ps(t){t.l+=1}function Wg(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function Pbe(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Mbe(t);n.biff==12&&(r=4)}var i=t.read_shift(r),s=t.read_shift(r),o=Wg(t),a=Wg(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Mbe(t){var e=Wg(t),n=Wg(t),r=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function U_t(t,e,n){if(n.biff<8)return Mbe(t);var r=t.read_shift(n.biff==12?4:2),i=t.read_shift(n.biff==12?4:2),s=Wg(t),o=Wg(t);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Cbe(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return G_t(t);var r=t.read_shift(n&&n.biff==12?4:2),i=Wg(t);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function G_t(t){var e=Wg(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function B_t(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function W_t(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return H_t(t);var i=t.read_shift(r>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function H_t(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:i,rRel:r}}function q_t(t,e,n){var r=(t[t.l++]&96)>>5,i=Pbe(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function K_t(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=Pbe(t,s,n);return[r,i,o]}function Y_t(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function X_t(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(n)switch(n.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[r,i]}function Z_t(t,e,n){var r=(t[t.l++]&96)>>5,i=U_t(t,e-1,n);return[r,i]}function J_t(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function foe(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function Q_t(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(t.read_shift(n&&n.biff==2?1:2));return i}function ext(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function txt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function nxt(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function rxt(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function Nbe(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function ixt(t){return t.read_shift(2),Nbe(t)}function sxt(t){return t.read_shift(2),Nbe(t)}function oxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=Cbe(t,0,n);return[r,i]}function axt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=W_t(t,0,n);return[r,i]}function lxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var s=Cbe(t,0,n);return[r,i,s]}function cxt(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(n&&n.biff<=3?1:2);return[cwt[i],Dbe[i],r]}function uxt(t,e,n){var r=t[t.l++],i=t.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:hxt(t);return[i,(s[0]===0?Dbe:lwt)[s[1]]]}function hxt(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function dxt(t,e,n){t.l+=n&&n.biff==2?3:4}function fxt(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function pxt(t){return t.l++,$I[t.read_shift(1)]}function mxt(t){return t.l++,t.read_shift(2)}function gxt(t){return t.l++,t.read_shift(1)!==0}function yxt(t){return t.l++,mb(t)}function vxt(t,e,n){return t.l++,mbe(t,e-1,n)}function _xt(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=lvt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=$I[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=mb(t);break;case 2:n[1]=dvt(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function xxt(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?mv:mvt)(t));return i}function wxt(t,e,n){var r=0,i=0;n.biff==12?(r=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=_xt(t,n.biff);return o}function bxt(t,e,n){var r=t.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=t.read_shift(i);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,s]}function Ext(t,e,n){if(n.biff==5)return Sxt(t);var r=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[r,i,s]}function Sxt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function Txt(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function kxt(t,e,n){var r=t.read_shift(1)>>>5&3,i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function Axt(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function Ixt(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[r,i]}var Rxt=Pd,Pxt=Pd,Mxt=Pd;function jI(t,e,n){return t.l+=2,[B_t(t)]}function UH(t){return t.l+=6,[]}var Cxt=jI,Nxt=UH,Oxt=UH,Lxt=jI;function Obe(t){return t.l+=2,[fbe(t),t.read_shift(2)&1]}var Dxt=jI,$xt=Obe,jxt=UH,Fxt=jI,Vxt=jI,zxt=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Uxt(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=zxt[n>>2&31];return{ixti:e,coltype:n&3,rt:o,idx:r,c:i,C:s}}function Gxt(t){return t.l+=2,[t.read_shift(4)]}function Bxt(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function Wxt(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function Hxt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function qxt(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function Kxt(t){return t.l+=4,[0,0]}var poe={1:{n:"PtgExp",f:fxt},2:{n:"PtgTbl",f:Mxt},3:{n:"PtgAdd",f:ps},4:{n:"PtgSub",f:ps},5:{n:"PtgMul",f:ps},6:{n:"PtgDiv",f:ps},7:{n:"PtgPower",f:ps},8:{n:"PtgConcat",f:ps},9:{n:"PtgLt",f:ps},10:{n:"PtgLe",f:ps},11:{n:"PtgEq",f:ps},12:{n:"PtgGe",f:ps},13:{n:"PtgGt",f:ps},14:{n:"PtgNe",f:ps},15:{n:"PtgIsect",f:ps},16:{n:"PtgUnion",f:ps},17:{n:"PtgRange",f:ps},18:{n:"PtgUplus",f:ps},19:{n:"PtgUminus",f:ps},20:{n:"PtgPercent",f:ps},21:{n:"PtgParen",f:ps},22:{n:"PtgMissArg",f:ps},23:{n:"PtgStr",f:vxt},26:{n:"PtgSheet",f:Bxt},27:{n:"PtgEndSheet",f:Wxt},28:{n:"PtgErr",f:pxt},29:{n:"PtgBool",f:gxt},30:{n:"PtgInt",f:mxt},31:{n:"PtgNum",f:yxt},32:{n:"PtgArray",f:J_t},33:{n:"PtgFunc",f:cxt},34:{n:"PtgFuncVar",f:uxt},35:{n:"PtgName",f:bxt},36:{n:"PtgRef",f:oxt},37:{n:"PtgArea",f:q_t},38:{n:"PtgMemArea",f:Txt},39:{n:"PtgMemErr",f:Rxt},40:{n:"PtgMemNoMem",f:Pxt},41:{n:"PtgMemFunc",f:kxt},42:{n:"PtgRefErr",f:Axt},43:{n:"PtgAreaErr",f:Y_t},44:{n:"PtgRefN",f:axt},45:{n:"PtgAreaN",f:Z_t},46:{n:"PtgMemAreaN",f:Hxt},47:{n:"PtgMemNoMemN",f:qxt},57:{n:"PtgNameX",f:Ext},58:{n:"PtgRef3d",f:lxt},59:{n:"PtgArea3d",f:K_t},60:{n:"PtgRefErr3d",f:Ixt},61:{n:"PtgAreaErr3d",f:X_t},255:{}},Yxt={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Xxt={1:{n:"PtgElfLel",f:Obe},2:{n:"PtgElfRw",f:Fxt},3:{n:"PtgElfCol",f:Cxt},6:{n:"PtgElfRwV",f:Vxt},7:{n:"PtgElfColV",f:Lxt},10:{n:"PtgElfRadical",f:Dxt},11:{n:"PtgElfRadicalS",f:jxt},13:{n:"PtgElfColS",f:Nxt},15:{n:"PtgElfColSV",f:Oxt},16:{n:"PtgElfRadicalLel",f:$xt},25:{n:"PtgList",f:Uxt},29:{n:"PtgSxName",f:Gxt},255:{}},Zxt={0:{n:"PtgAttrNoop",f:Kxt},1:{n:"PtgAttrSemi",f:rxt},2:{n:"PtgAttrIf",f:txt},4:{n:"PtgAttrChoose",f:Q_t},8:{n:"PtgAttrGoto",f:ext},16:{n:"PtgAttrSum",f:dxt},32:{n:"PtgAttrBaxcel",f:foe},33:{n:"PtgAttrBaxcel",f:foe},64:{n:"PtgAttrSpace",f:ixt},65:{n:"PtgAttrSpaceSemi",f:sxt},128:{n:"PtgAttrIfError",f:nxt},255:{}};function Jxt(t,e,n,r){if(r.biff<8)return Pd(t,e);for(var i=t.l+e,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=wxt(t,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=xxt(t,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=t.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return e=i-t.l,e!==0&&s.push(Pd(t,e)),s}function Qxt(t,e,n){for(var r=t.l+e,i,s,o=[];r!=t.l;)e=r-t.l,s=t[t.l],i=poe[s]||poe[Yxt[s]],(s===24||s===25)&&(i=(s===24?Xxt:Zxt)[t[t.l+1]]),!i||!i.f?Pd(t,e):o.push([i.n,i.f(t,e,n)]);return o}function ewt(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var twt={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nwt(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Lbe(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(t[r[0]][0]){case 357:return i=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[r[0]][0][3]?(i=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function moe(t,e,n){var r=Lbe(t,e,n);return r=="#REF"?r:nwt(r,n)}function R2(t,e,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,h=0,f=0,g,v="";if(!t[0]||!t[0][0])return"";for(var x=-1,b="",T=0,A=t[0].length;T<A;++T){var I=t[0][T];switch(I[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),x>=0){switch(t[0][x][1][0]){case 0:b=Yi(" ",t[0][x][1][1]);break;case 1:b=Yi("\r",t[0][x][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+b,x=-1}a.push(c+twt[I[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=jT(I[1][1],o,i),a.push(FT(u,s));break;case"PtgRefN":u=n?jT(I[1][1],n,i):I[1][1],a.push(FT(u,s));break;case"PtgRef3d":h=I[1][1],u=jT(I[1][2],o,i),v=moe(r,h,i),a.push(v+"!"+FT(u,s));break;case"PtgFunc":case"PtgFuncVar":var R=I[1][0],C=I[1][1];R||(R=0),R&=127;var V=R==0?[]:a.slice(-R);a.length-=R,C==="User"&&(C=V.shift()),a.push(C+"("+V.join(",")+")");break;case"PtgBool":a.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(I[1]);break;case"PtgNum":a.push(String(I[1]));break;case"PtgStr":a.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(I[1]);break;case"PtgAreaN":g=Qse(I[1][1],n?{s:n}:o,i),a.push(I8(g,i));break;case"PtgArea":g=Qse(I[1][1],o,i),a.push(I8(g,i));break;case"PtgArea3d":h=I[1][1],g=I[1][2],v=moe(r,h,i),a.push(v+"!"+I8(g,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=I[1][2];var M=(r.names||[])[f-1]||(r[0]||[])[f],N=M?M.Name:"SH33TJSNAME"+String(f);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),a.push(N);break;case"PtgNameX":var O=I[1][1];f=I[1][2];var F;if(i.biff<=5)O<0&&(O=-O),r[O]&&(F=r[O][f]);else{var L="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][f]&&r[O][f].itab>0&&(L=r.SheetNames[r[O][f].itab-1]+"!"):L=r.SheetNames[f-1]+"!"),r[O]&&r[O][f])L+=r[O][f].Name;else if(r[0]&&r[0][f])L+=r[0][f].Name;else{var B=(Lbe(r,O,i)||"").split(";;");B[f-1]?L=B[f-1]:L+="SH33TJSERRX"}a.push(L);break}F||(F={Name:"SH33TJSERRY"}),a.push(F.Name);break;case"PtgParen":var U="(",de=")";if(x>=0){switch(b="",t[0][x][1][0]){case 2:U=Yi(" ",t[0][x][1][1])+U;break;case 3:U=Yi("\r",t[0][x][1][1])+U;break;case 4:de=Yi(" ",t[0][x][1][1])+de;break;case 5:de=Yi("\r",t[0][x][1][1])+de;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}a.push(U+a.pop()+de);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:I[1][1],r:I[1][0]};var me={c:n.c,r:n.r};if(r.sharedf[Br(u)]){var ze=r.sharedf[Br(u)];a.push(R2(ze,o,me,r,i))}else{var Le=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(R2(c[1],o,me,r,i)),Le=!0;break}Le||a.push(I[1])}break;case"PtgArray":a.push("{"+ewt(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&fe.indexOf(t[0][T][0])==-1){I=t[0][x];var $e=!0;switch(I[1][0]){case 4:$e=!1;case 0:b=Yi(" ",I[1][1]);break;case 5:$e=!1;case 1:b=Yi("\r",I[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}a.push(($e?b:"")+a.pop()+($e?"":b)),x=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function rwt(t){if(t==null){var e=Ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return B1(t);return B1(0)}function iwt(t,e,n,r,i){var s=W1(e,n,i),o=rwt(t.v),a=Ge(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=Ge(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var h=Io([s,o,a,c]);return h}function lL(t,e,n){var r=t.read_shift(4),i=Qxt(t,r,n),s=t.read_shift(4),o=s>0?Jxt(t,s,i,n):null;return[i,o]}var swt=lL,cL=lL,owt=lL,awt=lL,lwt={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Dbe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cwt={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uwt(t){var e="of:="+t.replace(VH,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function hwt(t){return t.replace(/\./,"!")}var VT=typeof Map<"u";function GH(t,e,n){var r=0,i=t.length;if(n){if(VT?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var s=VT?n.get(e):n[e];r<s.length;++r)if(t[s[r]].t===e)return t.Count++,s[r]}}else for(;r<i;++r)if(t[r].t===e)return t.Count++,r;return t[i]={t:e},t.Count++,t.Unique++,n&&(VT?(n.has(e)||n.set(e,[]),n.get(e).push(i)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(i))),i}function uL(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(tp=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=$N(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=ez(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function $be(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function n0(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){C2e(e.z,i),n.ssf[i]=e.z,n.revssf[e.z]=r=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===r)return i;return t[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function dwt(t,e,n){if(t&&t["!ref"]){var r=fi(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function fwt(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+ks(t[n])+'"/>';return e+"</mergeCells>"}function pwt(t,e,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[n];try{e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=lA(Ur(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),a=(a||"")+yt("outlinePr",null,c)}!s&&!a||(i[i.length]=yt("sheetPr",a,o))}var mwt=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gwt=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ywt(t){var e={sheet:1};return mwt.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),gwt.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=xbe(t.password).toString(16).toUpperCase()),yt("sheetProtection",null,e)}function vwt(t){return $be(t),yt("pageMargins",null,t)}function _wt(t,e){for(var n=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(n[n.length]=yt("col",null,uL(i,r)));return n[n.length]="</cols>",n.join("")}function xwt(t,e,n,r){var i=typeof t.ref=="string"?t.ref:ks(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=pc(i);o.s.r==o.e.r&&(o.e.r=pc(e["!ref"]).e.r,i=ks(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),yt("autoFilter",null,{ref:i})}function wwt(t,e,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),yt("sheetViews",yt("sheetView",null,i),{})}function bwt(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=$I[t.v];break;case"d":r&&r.cellDates?i=Da(t.v,-1).toISOString():(t=Tl(t),t.t="n",i=""+(t.v=Sl(Da(t.v)))),typeof t.z>"u"&&(t.z=Qi[14]);break;default:i=t.v;break}var a=Ro("v",Ur(i)),l={r:e},c=n0(r.cellXfs,t,r);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Ro("v",""+GH(r.Strings,t.v,r.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=yt("f",Ur(t.f),u)+(t.v!=null?a:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(l.cm=1),yt("c",a,l)}function Ewt(t,e,n,r){var i=[],s=[],o=fi(t["!ref"]),a="",l,c="",u=[],h=0,f=0,g=t["!rows"],v=Array.isArray(t),x={r:c},b,T=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=ma(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=Mo(h),f=o.s.c;f<=o.e.c;++f){l=u[f]+c;var A=v?(t[h]||[])[f]:t[l];A!==void 0&&(a=bwt(A,l,t,e))!=null&&s.push(a)}(s.length>0||g&&g[h])&&(x={r:c},g&&g[h]&&(b=g[h],b.hidden&&(x.hidden=1),T=-1,b.hpx?T=jN(b.hpx):b.hpt&&(T=b.hpt),T>-1&&(x.ht=T,x.customHeight=1),b.level&&(x.outlineLevel=b.level)),i[i.length]=yt("row",s.join(""),x))}if(g)for(;h<g.length;++h)g&&g[h]&&(x={r:h+1},b=g[h],b.hidden&&(x.hidden=1),T=-1,b.hpx?T=jN(b.hpx):b.hpt&&(T=b.hpt),T>-1&&(x.ht=T,x.customHeight=1),b.level&&(x.outlineLevel=b.level),i[i.length]=yt("row","",x));return i.join("")}function jbe(t,e,n,r){var i=[Is,yt("worksheet",null,{xmlns:db[0],"xmlns:r":so.r})],s=n.SheetNames[t],o=0,a="",l=n.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=fi(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=ks(u)}r||(r={}),l["!comments"]=[];var h=[];pwt(l,n,t,e,i),i[i.length]=yt("dimension",null,{ref:c}),i[i.length]=wwt(l,e,t,n),e.sheetFormat&&(i[i.length]=yt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=_wt(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=Ewt(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=ywt(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=xwt(l["!autofilter"],l,n,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=fwt(l["!merges"]));var f=-1,g,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=Fr(r,-1,Ur(x[1].Target).replace(/#.*$/,""),mr.HLINK),g["r:id"]="rId"+v),(f=x[1].Target.indexOf("#"))>-1&&(g.location=Ur(x[1].Target.slice(f+1))),x[1].Tooltip&&(g.tooltip=Ur(x[1].Tooltip)),i[i.length]=yt("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=vwt(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ro("ignoredErrors",yt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(v=Fr(r,-1,"../drawings/drawing"+(t+1)+".xml",mr.DRAW),i[i.length]=yt("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=h),l["!comments"].length>0&&(v=Fr(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",mr.VML),i[i.length]=yt("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Swt(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function Twt(t,e,n){var r=Ge(145),i=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var s=320;i.hpx?s=jN(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var h=-1,f=-1,g=u<<10;g<u+1<<10;++g){c.c=g;var v=Array.isArray(n)?(n[c.r]||[])[c.c]:n[Br(c)];v&&(h<0&&(h=g),f=g)}h<0||(++a,r.write_shift(4,h),r.write_shift(4,f))}var x=r.l;return r.l=l,r.write_shift(4,a),r.l=x,r.length>r.l?r.slice(0,r.l):r}function kwt(t,e,n,r){var i=Twt(r,n,e);(i.length>17||(e["!rows"]||[])[r])&&tt(t,0,i)}var Awt=mv,Iwt=pb;function Rwt(){}function Pwt(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=V1t(t),n}function Mwt(t,e,n){n==null&&(n=Ge(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return ON({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Q2e(t,n),n.slice(0,n.l)}function Cwt(t){var e=fu(t);return[e]}function Nwt(t,e,n){return n==null&&(n=Ge(8)),dv(e,n)}function Owt(t){var e=fv(t);return[e]}function Lwt(t,e,n){return n==null&&(n=Ge(4)),pv(e,n)}function Dwt(t){var e=fu(t),n=t.read_shift(1);return[e,n,"b"]}function $wt(t,e,n){return n==null&&(n=Ge(9)),dv(e,n),n.write_shift(1,t.v?1:0),n}function jwt(t){var e=fv(t),n=t.read_shift(1);return[e,n,"b"]}function Fwt(t,e,n){return n==null&&(n=Ge(5)),pv(e,n),n.write_shift(1,t.v?1:0),n}function Vwt(t){var e=fu(t),n=t.read_shift(1);return[e,n,"e"]}function zwt(t,e,n){return n==null&&(n=Ge(9)),dv(e,n),n.write_shift(1,t.v),n}function Uwt(t){var e=fv(t),n=t.read_shift(1);return[e,n,"e"]}function Gwt(t,e,n){return n==null&&(n=Ge(8)),pv(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function Bwt(t){var e=fu(t),n=t.read_shift(4);return[e,n,"s"]}function Wwt(t,e,n){return n==null&&(n=Ge(12)),dv(e,n),n.write_shift(4,e.v),n}function Hwt(t){var e=fv(t),n=t.read_shift(4);return[e,n,"s"]}function qwt(t,e,n){return n==null&&(n=Ge(8)),pv(e,n),n.write_shift(4,e.v),n}function Kwt(t){var e=fu(t),n=mb(t);return[e,n,"n"]}function Ywt(t,e,n){return n==null&&(n=Ge(16)),dv(e,n),B1(t.v,n),n}function Xwt(t){var e=fv(t),n=mb(t);return[e,n,"n"]}function Zwt(t,e,n){return n==null&&(n=Ge(12)),pv(e,n),B1(t.v,n),n}function Jwt(t){var e=fu(t),n=ebe(t);return[e,n,"n"]}function Qwt(t,e,n){return n==null&&(n=Ge(12)),dv(e,n),tbe(t.v,n),n}function e2t(t){var e=fv(t),n=ebe(t);return[e,n,"n"]}function t2t(t,e,n){return n==null&&(n=Ge(8)),pv(e,n),tbe(t.v,n),n}function n2t(t){var e=fu(t),n=LH(t);return[e,n,"is"]}function r2t(t){var e=fu(t),n=ga(t);return[e,n,"str"]}function i2t(t,e,n){return n==null&&(n=Ge(12+4*t.v.length)),dv(e,n),lo(t.v,n),n.length>n.l?n.slice(0,n.l):n}function s2t(t){var e=fv(t),n=ga(t);return[e,n,"str"]}function o2t(t,e,n){return n==null&&(n=Ge(8+4*t.v.length)),pv(e,n),lo(t.v,n),n.length>n.l?n.slice(0,n.l):n}function a2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(n.cellFormula){t.l+=2;var a=cL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}function l2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(n.cellFormula){t.l+=2;var a=cL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}function c2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=mb(t),o=[i,s,"n"];if(n.cellFormula){t.l+=2;var a=cL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}function u2t(t,e,n){var r=t.l+e,i=fu(t);i.r=n["!row"];var s=ga(t),o=[i,s,"str"];if(n.cellFormula){t.l+=2;var a=cL(t,r-t.l,n);o[3]=R2(a,null,i,n.supbooks,n)}else t.l=r;return o}var h2t=mv,d2t=pb;function f2t(t,e){return e==null&&(e=Ge(4)),e.write_shift(4,t),e}function p2t(t,e){var n=t.l+e,r=mv(t),i=DH(t),s=ga(t),o=ga(t),a=ga(t);t.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function m2t(t,e){var n=Ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));pb({s:ao(t[0]),e:ao(t[0])},n),$H("rId"+e,n);var r=t[1].Target.indexOf("#"),i=r==-1?"":t[1].Target.slice(r+1);return lo(i||"",n),lo(t[1].Tooltip||"",n),lo("",n),n.slice(0,n.l)}function g2t(){}function y2t(t,e,n){var r=t.l+e,i=nbe(t),s=t.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=swt(t,r-t.l,n);o[1]=a}else t.l=r;return o}function v2t(t,e,n){var r=t.l+e,i=mv(t),s=[i];if(n.cellFormula){var o=awt(t,r-t.l,n);s[1]=o,t.l=r}else t.l=r;return s}function _2t(t,e,n){n==null&&(n=Ge(18));var r=uL(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),n.write_shift(2,i),n}var Fbe=["left","right","top","bottom","header","footer"];function x2t(t){var e={};return Fbe.forEach(function(n){e[n]=mb(t)}),e}function w2t(t,e){return e==null&&(e=Ge(48)),$be(t),Fbe.forEach(function(n){B1(t[n],e)}),e}function b2t(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function E2t(t,e,n){n==null&&(n=Ge(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function S2t(t){var e=Ge(24);return e.write_shift(4,4),e.write_shift(4,1),pb(t,e),e}function T2t(t,e){return e==null&&(e=Ge(66)),e.write_shift(2,t.password?xbe(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function k2t(){}function A2t(){}function I2t(t,e,n,r,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Tl(e),e.z=e.z||Qi[14],e.v=Sl(Da(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:n,c:r};switch(l.s=n0(i.cellXfs,e,i),e.l&&s["!links"].push([Br(l),e.l]),e.c&&s["!comments"].push([Br(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=GH(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?tt(t,18,qwt(e,l)):tt(t,7,Wwt(e,l))):(l.t="str",o?tt(t,17,o2t(e,l)):tt(t,6,i2t(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?tt(t,13,t2t(e,l)):tt(t,2,Qwt(e,l)):o?tt(t,16,Zwt(e,l)):tt(t,5,Ywt(e,l)),!0;case"b":return l.t="b",o?tt(t,15,Fwt(e,l)):tt(t,4,$wt(e,l)),!0;case"e":return l.t="e",o?tt(t,14,Gwt(e,l)):tt(t,3,zwt(e,l)),!0}return o?tt(t,12,Lwt(e,l)):tt(t,1,Nwt(e,l)),!0}function R2t(t,e,n,r){var i=fi(e["!ref"]||"A1"),s,o="",a=[];tt(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Mo(u),kwt(t,e,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(a[f]=ma(f)),s=a[f]+o;var g=l?(e[u]||[])[f]:e[s];if(!g){h=!1;continue}h=I2t(t,g,u,f,r,e,h)}}tt(t,146)}function P2t(t,e){!e||!e["!merges"]||(tt(t,177,f2t(e["!merges"].length)),e["!merges"].forEach(function(n){tt(t,176,d2t(n))}),tt(t,178))}function M2t(t,e){!e||!e["!cols"]||(tt(t,390),e["!cols"].forEach(function(n,r){n&&tt(t,60,_2t(r,n))}),tt(t,391))}function C2t(t,e){!e||!e["!ref"]||(tt(t,648),tt(t,649,S2t(fi(e["!ref"]))),tt(t,650))}function N2t(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var i=Fr(n,-1,r[1].Target.replace(/#.*$/,""),mr.HLINK);tt(t,494,m2t(r,i))}}),delete e["!links"]}function O2t(t,e,n,r){if(e["!comments"].length>0){var i=Fr(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",mr.VML);tt(t,551,$H("rId"+i)),e["!legacy"]=i}}function L2t(t,e,n,r){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:ks(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=pc(s);a.s.r==a.e.r&&(a.e.r=pc(e["!ref"]).e.r,s=ks(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),tt(t,161,pb(fi(s))),tt(t,162)}}function D2t(t,e,n){tt(t,133),tt(t,137,E2t(e,n)),tt(t,138),tt(t,134)}function $2t(t,e){e["!protect"]&&tt(t,535,T2t(e["!protect"]))}function j2t(t,e,n,r){var i=_l(),s=n.SheetNames[t],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[t].CodeName||a)}catch{}var l=fi(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],tt(i,129),(n.vbaraw||o["!outline"])&&tt(i,147,Mwt(a,o["!outline"])),tt(i,148,Iwt(l)),D2t(i,o,n.Workbook),M2t(i,o),R2t(i,o,t,e),$2t(i,o),L2t(i,o,n,t),P2t(i,o),N2t(i,o,r),o["!margins"]&&tt(i,476,w2t(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&C2t(i,o),O2t(i,o,t,r),tt(i,130),i.end()}function F2t(t,e){t.l+=10;var n=ga(t);return{name:n}}var V2t=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function z2t(t){return!t.Workbook||!t.Workbook.WBProps?"false":v1t(t.Workbook.WBProps.date1904)?"true":"false"}var U2t="][*?/\\".split("");function Vbe(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return U2t.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function G2t(t,e,n){t.forEach(function(r,i){Vbe(r);for(var s=0;s<i;++s)if(r==t[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=e&&e[i]&&e[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function B2t(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];G2t(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)dwt(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}function zbe(t){var e=[Is];e[e.length]=yt("workbook",null,{xmlns:db[0],"xmlns:r":so.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(V2t.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=yt("workbookPr",null,r);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:Ur(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=yt("sheet",null,o)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=yt("definedName",Ur(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function W2t(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=QV(t),n.name=ga(t),n}function H2t(t,e){return e||(e=Ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),$H(t.strRelID,e),lo(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function q2t(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var i=e>8?ga(t):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function K2t(t,e){e||(e=Ge(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),Q2e(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Y2t(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=z1t(t),o=owt(t,0,n),a=DH(t);t.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function X2t(t,e){tt(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};tt(t,156,H2t(i))}tt(t,144)}function Z2t(t,e){e||(e=Ge(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return lo("SheetJS",e),lo(kN.version,e),lo(kN.version,e),lo("7262",e),e.length>e.l?e.slice(0,e.l):e}function J2t(t,e){e||(e=Ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function Q2t(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(tt(t,135),tt(t,158,J2t(i)),tt(t,136))}}function ebt(t,e){var n=_l();return tt(n,131),tt(n,128,Z2t()),tt(n,153,K2t(t.Workbook&&t.Workbook.WBProps||null)),Q2t(n,t),X2t(n,t),tt(n,132),n.end()}function tbt(t,e,n){return(e.slice(-4)===".bin"?ebt:zbe)(t)}function nbt(t,e,n,r,i){return(e.slice(-4)===".bin"?j2t:jbe)(t,n,r,i)}function rbt(t,e,n){return(e.slice(-4)===".bin"?w_t:Ebe)(t,n)}function ibt(t,e,n){return(e.slice(-4)===".bin"?Kvt:_be)(t,n)}function sbt(t,e,n){return(e.slice(-4)===".bin"?$_t:Ibe)(t)}function obt(t){return(t.slice(-4)===".bin"?R_t:kbe)()}function abt(t,e){var n=[];return t.Props&&n.push(rvt(t.Props,e)),t.Custprops&&n.push(ivt(t.Props,t.Custprops)),n.join("")}function lbt(){return""}function cbt(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var s=[];s.push(yt("NumberFormat",null,{"ss:Format":Ur(Qi[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(yt("Style",s.join(""),o))}),yt("Styles",n.join(""))}function Ube(t){return yt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+zH(t.Ref,{r:0,c:0})})}function ubt(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(Ube(i)))}return yt("Names",n.join(""))}function hbt(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(Ube(a)))}return s.join("")}function dbt(t,e,n,r){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(yt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(yt("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(yt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(yt("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Ro("ProtectContents","True")),t["!protect"].objects&&i.push(Ro("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Ro("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Ro("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Ro("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":yt("WorksheetOptions",i.join(""),{xmlns:Jl.x})}function fbt(t){return t.map(function(e){var n=y1t(e.t||""),r=yt("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return yt("Comment",r,{"ss:Author":e.a})}).join("")}function pbt(t,e,n,r,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+Ur(zH(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=ao(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=Ur(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=Ur(t.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=$I[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Qi[14]);break;case"s":h="String",f=g1t(t.v||"");break}var g=n0(r.cellXfs,t,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=o.c+1;var v=t.v!=null?f:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(t.c||[]).length>0&&(x+=fbt(t.c)),yt("Cell",x,a)}function mbt(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=bbe(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function gbt(t,e,n,r){if(!t["!ref"])return"";var i=fi(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(b,T){FH(b);var A=!!b.width,I=uL(T,b),R={"ss:Index":T+1};A&&(R["ss:Width"]=DN(I.width)),b.hidden&&(R["ss:Hidden"]="1"),a.push(yt("Column",null,R))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[mbt(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(f=!0);break}if(!f){var g={r:c,c:h},v=Br(g),x=l?(t[c]||[])[h]:t[v];u.push(pbt(x,v,t,e,n,r,g))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function ybt(t,e,n){var r=[],i=n.SheetNames[t],s=n.Sheets[i],o=s?hbt(s,e,t,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?gbt(s,e,t,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(dbt(s,e,t,n)),r.join("")}function vbt(t,e){e||(e={}),t.SSF||(t.SSF=Tl(Qi)),t.SSF&&(sL(),iL(t.SSF),e.revssf=oL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],n0(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(abt(t,e)),n.push(lbt()),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(yt("Worksheet",ybt(r,e,t),{"ss:Name":Ur(t.SheetNames[r])}));return n[2]=cbt(t,e),n[3]=ubt(t),Is+yt("Workbook",n.join(""),{xmlns:Jl.ss,"xmlns:o":Jl.o,"xmlns:x":Jl.x,"xmlns:ss":Jl.ss,"xmlns:dt":Jl.dt,"xmlns:html":Jl.html})}var M8={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _bt(t,e){var n=[],r=[],i=[],s=0,o,a=Use(toe,"n"),l=Use(noe,"n");if(t.Props)for(o=Co(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=Co(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],t.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)dbe.indexOf(i[s][0])>-1||cbe.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&qr.utils.cfb_add(e,"/SummaryInformation",aoe(r,M8.SI,l,noe)),(n.length||c.length)&&qr.utils.cfb_add(e,"/DocumentSummaryInformation",aoe(n,M8.DSI,a,toe,c.length?c:null,M8.UDI))}function xbt(t,e){var n=e||{},r=qr.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return qr.utils.cfb_add(r,i,Gbe(t,n)),n.biff==8&&(t.Props||t.Custprops)&&_bt(t,r),n.biff==8&&t.vbaraw&&j_t(r,qr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var wbt={0:{f:Swt},1:{f:Cwt},2:{f:Jwt},3:{f:Vwt},4:{f:Dwt},5:{f:Kwt},6:{f:r2t},7:{f:Bwt},8:{f:u2t},9:{f:c2t},10:{f:a2t},11:{f:l2t},12:{f:Owt},13:{f:e2t},14:{f:Uwt},15:{f:jwt},16:{f:Xwt},17:{f:s2t},18:{f:Hwt},19:{f:LH},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Y2t},40:{},42:{},43:{f:r_t},44:{f:t_t},45:{f:o_t},46:{f:l_t},47:{f:a_t},48:{},49:{f:O1t},50:{},51:{f:S_t},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Lvt},62:{f:n2t},63:{f:P_t},64:{f:k2t},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pd,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:b2t},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Pwt},148:{f:Awt,p:16},151:{f:g2t},152:{},153:{f:q2t},154:{},155:{},156:{f:W2t},157:{},158:{},159:{T:1,f:Wvt},160:{T:-1},161:{T:1,f:mv},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:h2t},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:b_t},336:{T:-1},337:{f:A_t,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:QV},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Rvt},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:y2t},427:{f:v2t},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:x2t},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Rwt},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:p2t},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:QV},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:L_t},633:{T:1},634:{T:-1},635:{T:1,f:N_t},636:{T:-1},637:{f:j1t},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:F2t},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:A2t},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function vt(t,e,n,r){var i=e;if(!isNaN(i)){var s=r||(n||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&CH(n)&&t.push(n)}}function bbt(t,e,n,r){var i=(n||[]).length||0;if(i<=8224)return vt(t,e,n,i);var s=e;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c}}}function FI(t,e,n){return t||(t=Ge(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function Ebt(t,e,n,r){var i=Ge(9);return FI(i,t,e),pbe(n,r||"b",i),i}function Sbt(t,e,n){var r=Ge(8+2*n.length);return FI(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function Tbt(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Sl(Da(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?vt(t,2,Fvt(n,r,i)):vt(t,3,jvt(n,r,i));return;case"b":case"e":vt(t,5,Ebt(n,r,e.v,e.t));return;case"s":case"str":vt(t,4,Sbt(n,r,(e.v||"").slice(0,255)));return}vt(t,1,FI(null,n,r))}function kbt(t,e,n,r){var i=Array.isArray(e),s=fi(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=ks(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Mo(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=ma(u)),o=l[u]+a;var h=i?(e[c]||[])[u]:e[o];h&&Tbt(t,h,c,u)}}}function Abt(t,e){for(var n=e||{},r=_l(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return vt(r,n.biff==4?1033:n.biff==3?521:9,jH(t,16,n)),kbt(r,t.Sheets[t.SheetNames[i]],i,n),vt(r,10),r.end()}function Ibt(t,e,n){vt(t,49,wvt({sz:12,name:"Arial"},n))}function Rbt(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&vt(t,1054,Svt(i,e[i],n))})}function Pbt(t,e){var n=Ge(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),vt(t,2151,n),n=Ge(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),ybe(fi(e["!ref"]||"A1"),n),n.write_shift(4,4),vt(t,2152,n)}function Mbt(t,e){for(var n=0;n<16;++n)vt(t,224,coe({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){vt(t,224,coe(r,0,e))})}function Cbt(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];vt(t,440,Cvt(r)),r[1].Tooltip&&vt(t,2048,Nvt(r))}delete e["!links"]}function Nbt(t,e){if(e){var n=0;e.forEach(function(r,i){++n<=256&&r&&vt(t,125,Dvt(uL(i,r),i))})}}function Obt(t,e,n,r,i){var s=16+n0(i.cellXfs,e,i);if(e.v==null&&!e.bf){vt(t,513,W1(n,r,s));return}if(e.bf)vt(t,6,iwt(e,n,r,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?Sl(Da(e.v)):e.v;vt(t,515,Ivt(n,r,o,s));break;case"b":case"e":vt(t,517,Avt(n,r,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=GH(i.Strings,e.v,i.revStrings);vt(t,253,bvt(n,r,a,s))}else vt(t,516,Evt(n,r,(e.v||"").slice(0,255),s,i));break;default:vt(t,513,W1(n,r,s))}}function Lbt(t,e,n){var r=_l(),i=n.SheetNames[t],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,u,h="",f=[],g=fi(s["!ref"]||"A1"),v=c?65536:16384;if(g.e.c>255||g.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,v-1)}vt(r,2057,jH(n,16,e)),vt(r,13,Fc(1)),vt(r,12,Fc(100)),vt(r,15,ka(!0)),vt(r,17,ka(!1)),vt(r,16,B1(.001)),vt(r,95,ka(!0)),vt(r,42,ka(!1)),vt(r,43,ka(!1)),vt(r,130,Fc(1)),vt(r,128,kvt()),vt(r,131,ka(!1)),vt(r,132,ka(!1)),c&&Nbt(r,s["!cols"]),vt(r,512,Tvt(g,e)),c&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){h=Mo(x);for(var b=g.s.c;b<=g.e.c;++b){x===g.s.r&&(f[b]=ma(b)),u=f[b]+h;var T=l?(s[x]||[])[b]:s[u];T&&(Obt(r,T,x,b,e),c&&T.l&&s["!links"].push([u,T.l]))}}var A=a.CodeName||a.name||i;return c&&vt(r,574,xvt((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&vt(r,229,Mvt(s["!merges"])),c&&Cbt(r,s),vt(r,442,gbe(A)),c&&Pbt(r,s),vt(r,10),r.end()}function Dbt(t,e,n){var r=_l(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(vt(r,2057,jH(t,5,n)),n.bookType=="xla"&&vt(r,135),vt(r,225,a?Fc(1200):null),vt(r,193,avt(2)),l&&vt(r,191),l&&vt(r,192),vt(r,226),vt(r,92,gvt("SheetJS",n)),vt(r,66,Fc(a?1200:1252)),a&&vt(r,353,Fc(0)),a&&vt(r,448),vt(r,317,$vt(t.SheetNames.length)),a&&t.vbaraw&&vt(r,211),a&&t.vbaraw){var c=o.CodeName||"ThisWorkbook";vt(r,442,gbe(c))}vt(r,156,Fc(17)),vt(r,25,ka(!1)),vt(r,18,ka(!1)),vt(r,19,Fc(0)),a&&vt(r,431,ka(!1)),a&&vt(r,444,Fc(0)),vt(r,61,_vt()),vt(r,64,ka(!1)),vt(r,141,Fc(0)),vt(r,34,ka(z2t(t)=="true")),vt(r,14,ka(!0)),a&&vt(r,439,ka(!1)),vt(r,218,Fc(0)),Ibt(r,t,n),Rbt(r,t.SSF,n),Mbt(r,n),a&&vt(r,352,ka(!1));var u=r.end(),h=_l();a&&vt(h,140,Ovt()),a&&n.Strings&&bbt(h,252,vvt(n.Strings)),vt(h,10);var f=h.end(),g=_l(),v=0,x=0;for(x=0;x<t.SheetNames.length;++x)v+=(a?12:11)+(a?2:1)*t.SheetNames[x].length;var b=u.length+v+f.length;for(x=0;x<t.SheetNames.length;++x){var T=s[x]||{};vt(g,133,yvt({pos:b,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},n)),b+=e[x].length}var A=g.end();if(v!=A.length)throw new Error("BS8 "+v+" != "+A.length);var I=[];return u.length&&I.push(u),A.length&&I.push(A),f.length&&I.push(f),Io(I)}function $bt(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=Tl(Qi)),t&&t.SSF&&(sL(),iL(t.SSF),n.revssf=oL(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,BH(n),n.cellXfs=[],n0(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)r[r.length]=Lbt(i,n,t);return r.unshift(Dbt(t,r,n)),Io(r)}function Gbe(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var i=pc(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return $bt(t,e);case 4:case 3:case 2:return Abt(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function jbt(t,e,n,r){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>o)&&!(i[c].e.r<n||i[c].e.c<o)){if(i[c].s.r<n||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=Br({r:n,c:o}),h=r.dense?(t[n]||[])[o]:t[u],f=h&&h.v!=null&&(h.h||m1t(h.w||(fp(h),h.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(g["data-t"]=h&&h.t||"z",h.v!=null&&(g["data-v"]=h.v),h.z!=null&&(g["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),g.id=(r.id||"sjs")+"-"+u,s.push(yt("td",f,g))}}var v="<tr>";return v+s.join("")+"</tr>"}var Fbt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Vbt="</body></html>";function zbt(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Bbe(t,e){var n=e||{},r=n.header!=null?n.header:Fbt,i=n.footer!=null?n.footer:Vbt,s=[r],o=pc(t["!ref"]);n.dense=Array.isArray(t),s.push(zbt(t,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push(jbt(t,o,a,n));return s.push("</table>"+i),s.join("")}function Wbe(t,e,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?ao(r.origin):r.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=pc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],f=0,g=t["!rows"]||(t["!rows"]=[]),v=0,x=0,b=0,T=0,A=0,I=0;for(t["!cols"]||(t["!cols"]=[]);v<a.length&&x<l;++v){var R=a[v];if(goe(R)){if(r.display)continue;g[x]={hidden:!0}}var C=R.children;for(b=T=0;b<C.length;++b){var V=C[b];if(!(r.display&&goe(V))){var M=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):_1t(V.innerHTML),N=V.getAttribute("data-z")||V.getAttribute("z");for(f=0;f<h.length;++f){var O=h[f];O.s.c==T+s&&O.s.r<x+i&&x+i<=O.e.r&&(T=O.e.c+1-s,f=-1)}I=+V.getAttribute("colspan")||1,((A=+V.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:x+i,c:T+s},e:{r:x+i+(A||1)-1,c:T+s+(I||1)-1}});var F={t:"s",v:M},L=V.getAttribute("data-t")||V.getAttribute("t")||"";M!=null&&(M.length==0?F.t=L||"z":r.raw||M.trim().length==0||L=="s"||(M==="TRUE"?F={t:"b",v:!0}:M==="FALSE"?F={t:"b",v:!1}:isNaN(ep(M))?isNaN(aA(M).getDate())||(F={t:"d",v:Da(M)},r.cellDates||(F={t:"n",v:Sl(F.v)}),F.z=r.dateNF||Qi[14]):F={t:"n",v:ep(M)})),F.z===void 0&&N!=null&&(F.z=N);var B="",U=V.getElementsByTagName("A");if(U&&U.length)for(var de=0;de<U.length&&!(U[de].hasAttribute("href")&&(B=U[de].getAttribute("href"),B.charAt(0)!="#"));++de);B&&B.charAt(0)!="#"&&(F.l={Target:B}),r.dense?(t[x+i]||(t[x+i]=[]),t[x+i][T+s]=F):t[Br({c:T+s,r:x+i})]=F,c.e.c<T+s&&(c.e.c=T+s),T+=I}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,x-1+i),t["!ref"]=ks(c),x>=l&&(t["!fullref"]=ks((c.e.r=a.length-v+x-1+i,c))),t}function Hbe(t,e){var n=e||{},r=n.dense?[]:{};return Wbe(r,t,e)}function Ubt(t,e){return hv(Hbe(t,e),e)}function goe(t){var e="",n=Gbt(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Gbt(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Bbt=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+cA({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Is+e}})(),yoe=(function(){var t=function(s){return Ur(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Ur(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=pc(s["!ref"]||"A1"),f=s["!merges"]||[],g=0,v=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",b=s["!rows"]||[];for(c=0;c<h.s.r;++c)x=b[c]?' table:style-name="ro'+b[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=h.e.r;++c){for(x=b[c]?' table:style-name="ro'+b[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),u=0;u<h.s.c;++u)l.push(e);for(;u<=h.e.c;++u){var T=!1,A={},I="";for(g=0;g!=f.length;++g)if(!(f[g].s.c>u)&&!(f[g].s.r>c)&&!(f[g].e.c<u)&&!(f[g].e.r<c)){(f[g].s.c!=u||f[g].s.r!=c)&&(T=!0),A["table:number-columns-spanned"]=f[g].e.c-f[g].s.c+1,A["table:number-rows-spanned"]=f[g].e.r-f[g].s.r+1;break}if(T){l.push(n);continue}var R=Br({r:c,c:u}),C=v?(s[c]||[])[u]:s[R];if(C&&C.f&&(A["table:formula"]=Ur(uwt(C.f)),C.F&&C.F.slice(0,R.length)==R)){var V=pc(C.F);A["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,A["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!C){l.push(e);continue}switch(C.t){case"b":I=C.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=C.v?"true":"false";break;case"n":I=C.w||String(C.v||0),A["office:value-type"]="float",A["office:value"]=C.v||0;break;case"s":case"str":I=C.v==null?"":C.v,A["office:value-type"]="string";break;case"d":I=C.w||Da(C.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Da(C.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(e);continue}var M=t(I);if(C.l&&C.l.Target){var N=C.l.Target;N=N.charAt(0)=="#"?"#"+hwt(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),M=yt("text:a",M,{"xlink:href":N.replace(/&/g,"&amp;")})}l.push("          "+yt("table:table-cell",yt("text:p",M,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;FH(h),h.ods=a;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Is],c=cA({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=cA({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(abe().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(r(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function qbe(t,e){if(e.bookType=="fods")return yoe(t,e);var n=IH(),r="",i=[],s=[];return r="mimetype",Fn(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Fn(n,r,yoe(t,e)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",Fn(n,r,Bbt(t,e)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",Fn(n,r,Is+abe()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",Fn(n,r,nvt(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Fn(n,r,evt(i)),n}function FN(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Wbt(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ku(lA(t))}function Hbt(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function Hg(t){var e=t.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(i){n.set(i,r),r+=i.length}),n}function qbt(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=n>=0?0:128}function uA(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function jr(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function fw(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function Os(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],i=uA(t,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];t[n[0]++]>=128;);a=t.slice(l,n[0])}break;case 5:o=4,a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=uA(t,n),a=t.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function _o(t){var e=[];return t.forEach(function(n,r){n.forEach(function(i){i.data&&(e.push(jr(r*8+i.type)),i.type==2&&e.push(jr(i.data.length)),e.push(i.data))})}),Hg(e)}function Cu(t){for(var e,n=[],r=[0];r[0]<t.length;){var i=uA(t,r),s=Os(t.slice(r[0],r[0]+i));r[0]+=i;var o={id:fw(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Os(a.data),c=fw(l[3][0].data);o.messages.push({meta:l,data:t.slice(r[0],r[0]+c)}),r[0]+=c}),(e=s[3])!=null&&e[0]&&(o.merge=fw(s[3][0].data)>>>0>0),n.push(o)}return n}function T_(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:jr(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:jr(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:jr(o.data.length)}],r[2].push({data:_o(o.meta),type:2})});var s=_o(r);e.push(jr(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),Hg(e)}function Kbt(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=uA(e,n),i=[];n[0]<e.length;){var s=e[n[0]]&3;if(s==0){var o=e[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[n[0]],a>1&&(o|=e[n[0]+1]<<8),a>2&&(o|=e[n[0]+2]<<16),a>3&&(o|=e[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(e.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(e[n[0]]>>2&7)+4,l=(e[n[0]++]&224)<<3,l|=e[n[0]++]):(c=(e[n[0]++]>>2)+1,s==2?(l=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(l=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),i=[Hg(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Hg(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Nu(t){for(var e=[],n=0;n<t.length;){var r=t[n++],i=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(Kbt(r,t.slice(n,n+i))),n+=i}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Hg(e)}function k_(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),i=new Uint8Array(4);e.push(i);var s=jr(r),o=s.length;e.push(s),r<=60?(o++,e.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return Hg(e)}function C8(t,e){var n=new Uint8Array(32),r=FN(n),i=12,s=0;switch(n[0]=5,t.t){case"n":n[1]=2,qbt(n,i,t.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,s,!0),n.slice(0,i)}function N8(t,e){var n=new Uint8Array(32),r=FN(n),i=12,s=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,s,!0),n.slice(0,i)}function hm(t){var e=Os(t);return uA(e[1][0].data)}function Ybt(t,e,n){var r,i,s,o;if(!((r=t[6])!=null&&r[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&fw(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=FN(t[7][0].data),u=0,h=[],f=FN(t[4][0].data),g=0,v=[],x=0;x<e.length;++x){if(e[x]==null){c.setUint16(x*2,65535,!0),f.setUint16(x*2,65535);continue}c.setUint16(x*2,u,!0),f.setUint16(x*2,g,!0);var b,T;switch(typeof e[x]){case"string":b=C8({t:"s",v:e[x]},n),T=N8({t:"s",v:e[x]},n);break;case"number":b=C8({t:"n",v:e[x]},n),T=N8({t:"n",v:e[x]},n);break;case"boolean":b=C8({t:"b",v:e[x]},n),T=N8({t:"b",v:e[x]},n);break;default:throw new Error("Unsupported value "+e[x])}h.push(b),u+=b.length,v.push(T),g+=T.length,++l}for(t[2][0].data=jr(l);x<t[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),f.setUint16(x*2,65535,!0);return t[6][0].data=Hg(h),t[3][0].data=Hg(v),l}function Xbt(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=pc(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ks(r)));var s=VN(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(ne){return ne.forEach(function(se){typeof se=="string"&&o.push(se)})});var a={},l=[],c=qr.read(e.numbers,{type:"base64"});c.FileIndex.map(function(ne,se){return[ne,c.FullPaths[se]]}).forEach(function(ne){var se=ne[0],ae=ne[1];if(se.type==2&&se.name.match(/\.iwa/)){var _e=se.content,Ke=Nu(_e),Ye=Cu(Ke);Ye.forEach(function(ke){l.push(ke.id),a[ke.id]={deps:[],location:ae,type:fw(ke.messages[0].meta[1][0].data)}})}}),l.sort(function(ne,se){return ne-se});var u=l.filter(function(ne){return ne>1}).map(function(ne){return[ne,jr(ne)]});c.FileIndex.map(function(ne,se){return[ne,c.FullPaths[se]]}).forEach(function(ne){var se=ne[0];if(ne[1],!!se.name.match(/\.iwa/)){var ae=Cu(Nu(se.content));ae.forEach(function(_e){_e.messages.forEach(function(Ke){u.forEach(function(Ye){_e.messages.some(function(ke){return fw(ke.meta[1][0].data)!=11006&&Hbt(ke.data,Ye[1])})&&a[Ye[0]].deps.push(_e.id)})})})}});for(var h=qr.find(c,a[1].location),f=Cu(Nu(h.content)),g,v=0;v<f.length;++v){var x=f[v];x.id==1&&(g=x)}var b=hm(Os(g.messages[0].data)[1][0].data);for(h=qr.find(c,a[b].location),f=Cu(Nu(h.content)),v=0;v<f.length;++v)x=f[v],x.id==b&&(g=x);for(b=hm(Os(g.messages[0].data)[2][0].data),h=qr.find(c,a[b].location),f=Cu(Nu(h.content)),v=0;v<f.length;++v)x=f[v],x.id==b&&(g=x);for(b=hm(Os(g.messages[0].data)[2][0].data),h=qr.find(c,a[b].location),f=Cu(Nu(h.content)),v=0;v<f.length;++v)x=f[v],x.id==b&&(g=x);var T=Os(g.messages[0].data);{T[6][0].data=jr(r.e.r+1),T[7][0].data=jr(r.e.c+1);var A=hm(T[46][0].data),I=qr.find(c,a[A].location),R=Cu(Nu(I.content));{for(var C=0;C<R.length&&R[C].id!=A;++C);if(R[C].id!=A)throw"Bad ColumnRowUIDMapArchive";var V=Os(R[C].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var M=0;M<=r.e.c;++M){var N=[];N[1]=N[2]=[{type:0,data:jr(M+420690)}],V[1].push({type:2,data:_o(N)}),V[2].push({type:0,data:jr(M)}),V[3].push({type:0,data:jr(M)})}V[4]=[],V[5]=[],V[6]=[];for(var O=0;O<=r.e.r;++O)N=[],N[1]=N[2]=[{type:0,data:jr(O+726270)}],V[4].push({type:2,data:_o(N)}),V[5].push({type:0,data:jr(O)}),V[6].push({type:0,data:jr(O)});R[C].messages[0].data=_o(V)}I.content=k_(T_(R)),I.size=I.content.length,delete T[46];var F=Os(T[4][0].data);{F[7][0].data=jr(r.e.r+1);var L=Os(F[1][0].data),B=hm(L[2][0].data);I=qr.find(c,a[B].location),R=Cu(Nu(I.content));{if(R[0].id!=B)throw"Bad HeaderStorageBucket";var U=Os(R[0].messages[0].data);for(O=0;O<s.length;++O){var de=Os(U[2][0].data);de[1][0].data=jr(O),de[4][0].data=jr(s[O].length),U[2][O]={type:U[2][0].type,data:_o(de)}}R[0].messages[0].data=_o(U)}I.content=k_(T_(R)),I.size=I.content.length;var me=hm(F[2][0].data);I=qr.find(c,a[me].location),R=Cu(Nu(I.content));{if(R[0].id!=me)throw"Bad HeaderStorageBucket";for(U=Os(R[0].messages[0].data),M=0;M<=r.e.c;++M)de=Os(U[2][0].data),de[1][0].data=jr(M),de[4][0].data=jr(r.e.r+1),U[2][M]={type:U[2][0].type,data:_o(de)};R[0].messages[0].data=_o(U)}I.content=k_(T_(R)),I.size=I.content.length;var ze=hm(F[4][0].data);(function(){for(var ne=qr.find(c,a[ze].location),se=Cu(Nu(ne.content)),ae,_e=0;_e<se.length;++_e){var Ke=se[_e];Ke.id==ze&&(ae=Ke)}var Ye=Os(ae.messages[0].data);{Ye[3]=[];var ke=[];o.forEach(function(qe,sn){ke[1]=[{type:0,data:jr(sn)}],ke[2]=[{type:0,data:jr(1)}],ke[3]=[{type:2,data:Wbt(qe)}],Ye[3].push({type:2,data:_o(ke)})})}ae.messages[0].data=_o(Ye);var Te=T_(se),Dt=k_(Te);ne.content=Dt,ne.size=ne.content.length})();var Le=Os(F[3][0].data);{var fe=Le[1][0];delete Le[2];var $e=Os(fe.data);{var Ce=hm($e[2][0].data);(function(){for(var ne=qr.find(c,a[Ce].location),se=Cu(Nu(ne.content)),ae,_e=0;_e<se.length;++_e){var Ke=se[_e];Ke.id==Ce&&(ae=Ke)}var Ye=Os(ae.messages[0].data);{delete Ye[6],delete Le[7];var ke=new Uint8Array(Ye[5][0].data);Ye[5]=[];for(var Te=0,Dt=0;Dt<=r.e.r;++Dt){var qe=Os(ke);Te+=Ybt(qe,s[Dt],o),qe[1][0].data=jr(Dt),Ye[5].push({data:_o(qe),type:2})}Ye[1]=[{type:0,data:jr(r.e.c+1)}],Ye[2]=[{type:0,data:jr(r.e.r+1)}],Ye[3]=[{type:0,data:jr(Te)}],Ye[4]=[{type:0,data:jr(r.e.r+1)}]}ae.messages[0].data=_o(Ye);var sn=T_(se),$t=k_(sn);ne.content=$t,ne.size=ne.content.length})()}fe.data=_o($e)}F[3][0].data=_o(Le)}T[4][0].data=_o(F)}g.messages[0].data=_o(T);var le=T_(f),W=k_(le);return h.content=W,h.size=h.content.length,c}function Zbt(t){return function(n){for(var r=0;r!=t.length;++r){var i=t[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function BH(t){Zbt([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Jbt(t,e){return e.bookType=="ods"?qbe(t,e):e.bookType=="numbers"?Xbt(t,e):e.bookType=="xlsb"?Qbt(t,e):eEt(t,e)}function Qbt(t,e){Nx=1024,t&&!t.SSF&&(t.SSF=Tl(Qi)),t&&t.SSF&&(sL(),iL(t.SSF),e.revssf=oL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,VT?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=Rbe.indexOf(e.bookType)>-1,i=ibe();BH(e=e||{});var s=IH(),o="",a=0;if(e.cellXfs=[],n0(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Fn(s,o,lbe(t.Props,e)),i.coreprops.push(o),Fr(e.rels,2,o,mr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Fn(s,o,ube(t.Props)),i.extprops.push(o),Fr(e.rels,3,o,mr.EXT_PROPS),t.Custprops!==t.Props&&Co(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Fn(s,o,hbe(t.Custprops)),i.custprops.push(o),Fr(e.rels,4,o,mr.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var u={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Fn(s,o,nbt(a-1,o,e,t,u)),i.sheets.push(o),Fr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,mr.WS[0])}if(h){var g=h["!comments"],v=!1,x="";g&&g.length>0&&(x="xl/comments"+a+"."+n,Fn(s,x,sbt(g,x)),i.comments.push(x),Fr(u,-1,"../comments"+a+"."+n,mr.CMNT),v=!0),h["!legacy"]&&v&&Fn(s,"xl/drawings/vmlDrawing"+a+".vml",Abe(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Fn(s,obe(o),hw(u))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+n,Fn(s,o,ibt(e.Strings,o,e)),i.strs.push(o),Fr(e.wbrels,-1,"sharedStrings."+n,mr.SST)),o="xl/workbook."+n,Fn(s,o,tbt(t,o)),i.workbooks.push(o),Fr(e.rels,1,o,mr.WB),o="xl/theme/theme1.xml",Fn(s,o,Tbe(t.Themes,e)),i.themes.push(o),Fr(e.wbrels,-1,"theme/theme1.xml",mr.THEME),o="xl/styles."+n,Fn(s,o,rbt(t,o,e)),i.styles.push(o),Fr(e.wbrels,-1,"styles."+n,mr.STY),t.vbaraw&&r&&(o="xl/vbaProject.bin",Fn(s,o,t.vbaraw),i.vba.push(o),Fr(e.wbrels,-1,"vbaProject.bin",mr.VBA)),o="xl/metadata."+n,Fn(s,o,obt(o)),i.metadata.push(o),Fr(e.wbrels,-1,"metadata."+n,mr.XLMETA),Fn(s,"[Content_Types].xml",sbe(i,e)),Fn(s,"_rels/.rels",hw(e.rels)),Fn(s,"xl/_rels/workbook."+n+".rels",hw(e.wbrels)),delete e.revssf,delete e.ssf,s}function eEt(t,e){Nx=1024,t&&!t.SSF&&(t.SSF=Tl(Qi)),t&&t.SSF&&(sL(),iL(t.SSF),e.revssf=oL(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,VT?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=Rbe.indexOf(e.bookType)>-1,i=ibe();BH(e=e||{});var s=IH(),o="",a=0;if(e.cellXfs=[],n0(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Fn(s,o,lbe(t.Props,e)),i.coreprops.push(o),Fr(e.rels,2,o,mr.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Fn(s,o,ube(t.Props)),i.extprops.push(o),Fr(e.rels,3,o,mr.EXT_PROPS),t.Custprops!==t.Props&&Co(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Fn(s,o,hbe(t.Custprops)),i.custprops.push(o),Fr(e.rels,4,o,mr.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},f=t.Sheets[t.SheetNames[a-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,Fn(s,o,jbe(a-1,e,t,h)),i.sheets.push(o),Fr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,mr.WS[0])}if(f){var v=f["!comments"],x=!1,b="";if(v&&v.length>0){var T=!1;v.forEach(function(A){A[1].forEach(function(I){I.T==!0&&(T=!0)})}),T&&(b="xl/threadedComments/threadedComment"+a+"."+n,Fn(s,b,M_t(v,u,e)),i.threadedcomments.push(b),Fr(h,-1,"../threadedComments/threadedComment"+a+"."+n,mr.TCMNT)),b="xl/comments"+a+"."+n,Fn(s,b,Ibe(v)),i.comments.push(b),Fr(h,-1,"../comments"+a+"."+n,mr.CMNT),x=!0}f["!legacy"]&&x&&Fn(s,"xl/drawings/vmlDrawing"+a+".vml",Abe(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Fn(s,obe(o),hw(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+n,Fn(s,o,_be(e.Strings,e)),i.strs.push(o),Fr(e.wbrels,-1,"sharedStrings."+n,mr.SST)),o="xl/workbook."+n,Fn(s,o,zbe(t)),i.workbooks.push(o),Fr(e.rels,1,o,mr.WB),o="xl/theme/theme1.xml",Fn(s,o,Tbe(t.Themes,e)),i.themes.push(o),Fr(e.wbrels,-1,"theme/theme1.xml",mr.THEME),o="xl/styles."+n,Fn(s,o,Ebe(t,e)),i.styles.push(o),Fr(e.wbrels,-1,"styles."+n,mr.STY),t.vbaraw&&r&&(o="xl/vbaProject.bin",Fn(s,o,t.vbaraw),i.vba.push(o),Fr(e.wbrels,-1,"vbaProject.bin",mr.VBA)),o="xl/metadata."+n,Fn(s,o,kbe()),i.metadata.push(o),Fr(e.wbrels,-1,"metadata."+n,mr.XLMETA),u.length>1&&(o="xl/persons/person.xml",Fn(s,o,C_t(u)),i.people.push(o),Fr(e.wbrels,-1,"persons/person.xml",mr.PEOPLE)),Fn(s,"[Content_Types].xml",sbe(i,e)),Fn(s,"_rels/.rels",hw(e.rels)),Fn(s,"xl/_rels/workbook."+n+".rels",hw(e.wbrels)),delete e.revssf,delete e.ssf,s}function tEt(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=dp(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Kbe(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return LI(e.file,qr.write(t,{type:wr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return qr.write(t,e)}function nEt(t,e){var n=Tl(e||{}),r=Jbt(t,n);return rEt(r,n)}function rEt(t,e){var n={},r=wr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?qr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(rL(i))}return e.password&&typeof encrypt_agile<"u"?Kbe(encrypt_agile(i,e.password),e):e.type==="file"?LI(e.file,i):e.type=="string"?DT(i):i}function iEt(t,e){var n=e||{},r=xbt(t,n);return Kbe(r,n)}function Wh(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return oA(lA(r));case"binary":return lA(r);case"string":return t;case"file":return LI(e.file,r,"utf8");case"buffer":return wr?Sp(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Wh(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function sEt(t,e){switch(e.type){case"base64":return oA(t);case"binary":return t;case"string":return t;case"file":return LI(e.file,t,"binary");case"buffer":return wr?Sp(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function mM(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?oA(n):e.type=="string"?DT(n):n;case"file":return LI(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Ybe(t,e){Nyt(),B2t(t);var n=Tl(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=Ybe(t,n);return n.type="array",rL(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=t.SheetNames.indexOf(n.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Wh(vbt(t,n),n);case"slk":case"sylk":return Wh(zvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"htm":case"html":return Wh(Bbe(t.Sheets[t.SheetNames[i]],n),n);case"txt":return sEt(Xbe(t.Sheets[t.SheetNames[i]],n),n);case"csv":return Wh(WH(t.Sheets[t.SheetNames[i]],n),n,"\uFEFF");case"dif":return Wh(Uvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"dbf":return mM(Vvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"prn":return Wh(Gvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"rtf":return Wh(Xvt.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"eth":return Wh(vbe.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"fods":return Wh(qbe(t,n),n);case"wk1":return mM(uoe.sheet_to_wk1(t.Sheets[t.SheetNames[i]],n),n);case"wk3":return mM(uoe.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),mM(Gbe(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),iEt(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nEt(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function oEt(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function aEt(t,e,n){var r={};return r.type="file",r.file=e,oEt(r),Ybe(t,r)}function lEt(t,e,n,r,i,s,o,a){var l=Mo(n),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch{f.__rowNum__=n}else f.__rowNum__=n;if(!o||t[n])for(var g=e.s.c;g<=e.e.c;++g){var v=o?t[n][g]:t[r[g]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[g]!=null&&(f[s[g]]=c);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[g]!=null){if(x==null)if(v.t=="e"&&x===null)f[s[g]]=null;else if(c!==void 0)f[s[g]]=c;else if(u&&x===null)f[s[g]]=null;else continue;else f[s[g]]=u&&(v.t!=="n"||v.t==="n"&&a.rawNumbers!==!1)?x:fp(v,x,a);x!=null&&(h=!1)}}return{row:f,isempty:h}}function VN(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=fi(u);break;case"number":l=fi(t["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var h=Mo(l.s.r),f=[],g=[],v=0,x=0,b=Array.isArray(t),T=l.s.r,A=0,I={};b&&!t[T]&&(t[T]=[]);var R=c.skipHidden&&t["!cols"]||[],C=c.skipHidden&&t["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(R[A]||{}).hidden)switch(f[A]=ma(A),n=b?t[T][A]:t[f[A]+h],r){case 1:s[A]=A-l.s.c;break;case 2:s[A]=f[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=fp(n,null,c),x=I[o]||0,!x)I[o]=1;else{do a=o+"_"+x++;while(I[a]);I[o]=x,I[a]=1}s[A]=a}for(T=l.s.r+i;T<=l.e.r;++T)if(!(C[T]||{}).hidden){var V=lEt(t,l,T,f,r,s,b,c);(V.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(g[v++]=V.row)}return g.length=v,g}var voe=/"/g;function cEt(t,e,n,r,i,s,o,a){for(var l=!0,c=[],u="",h=Mo(n),f=e.s.c;f<=e.e.c;++f)if(r[f]){var g=a.dense?(t[n]||[])[f]:t[r[f]+h];if(g==null)u="";else if(g.v!=null){l=!1,u=""+(a.rawNumbers&&g.t=="n"?g.v:fp(g,null,a));for(var v=0,x=0;v!==u.length;++v)if((x=u.charCodeAt(v))===i||x===s||x===34||a.forceQuotes){u='"'+u.replace(voe,'""')+'"';break}u=="ID"&&(u='"ID"')}else g.f!=null&&!g.F?(l=!1,u="="+g.f,u.indexOf(",")>=0&&(u='"'+u.replace(voe,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function WH(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var i=fi(t["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];r.dense=Array.isArray(t);for(var f=r.skipHidden&&t["!cols"]||[],g=r.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(f[v]||{}).hidden||(h[v]=ma(v));for(var x=0,b=i.s.r;b<=i.e.r;++b)(g[b]||{}).hidden||(u=cEt(t,i,b,h,o,l,s,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&n.push((x++?a:"")+u)));return delete r.dense,n.join("")}function Xbe(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=WH(t,e);return n}function uEt(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var i=fi(t["!ref"]),s="",o=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=ma(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Mo(u),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,n=c?(t[u]||[])[a]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=e+"="+r}return l}function Zbe(t,e,n){var r=n||{},i=+!r.skipHeader,s=t||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?ao(r.origin):r.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=fi(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+e.length-1+i)}else o==-1&&(o=0,u.e.r=e.length-1+i);var f=r.header||[],g=0;e.forEach(function(x,b){Co(x).forEach(function(T){(g=f.indexOf(T))==-1&&(f[g=f.length]=T);var A=x[T],I="z",R="",C=Br({c:a+g,r:o+b+i});c=hA(s,C),A&&typeof A=="object"&&!(A instanceof Date)?s[C]=A:(typeof A=="number"?I="n":typeof A=="boolean"?I="b":typeof A=="string"?I="s":A instanceof Date?(I="d",r.cellDates||(I="n",A=Sl(A)),R=r.dateNF||Qi[14]):A===null&&r.nullError&&(I="e",A=0),c?(c.t=I,c.v=A,delete c.w,delete c.R,R&&(c.z=R)):s[C]=c={t:I,v:A},R&&(c.z=R))})}),u.e.c=Math.max(u.e.c,a+f.length-1);var v=Mo(o);if(i)for(g=0;g<f.length;++g)s[ma(g+a)+v]={t:"s",v:f[g]};return s["!ref"]=ks(u),s}function hEt(t,e){return Zbe(null,t,e)}function hA(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=ao(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?hA(t,Br(e)):hA(t,Br({r:e,c:n||0}))}function dEt(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function fEt(){return{SheetNames:[],Sheets:{}}}function pEt(t,e,n,r){var i=1;if(!n)for(;i<=65535&&t.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&t.SheetNames.indexOf(n=o+i)!=-1;++i);}if(Vbe(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function mEt(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=dEt(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function gEt(t,e){return t.z=e,t}function Jbe(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function yEt(t,e,n){return Jbe(t,"#"+e,n)}function vEt(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function _Et(t,e,n,r){for(var i=typeof e!="string"?e:fi(e),s=typeof e=="string"?e:ks(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=hA(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return t}var O8={encode_col:ma,encode_row:Mo,encode_cell:Br,encode_range:ks,decode_col:OH,decode_row:NH,split_cell:N1t,decode_cell:ao,decode_range:pc,format_cell:fp,sheet_add_aoa:J2e,sheet_add_json:Zbe,sheet_add_dom:Wbe,aoa_to_sheet:fb,json_to_sheet:hEt,table_to_sheet:Hbe,table_to_book:Ubt,sheet_to_csv:WH,sheet_to_txt:Xbe,sheet_to_json:VN,sheet_to_html:Bbe,sheet_to_formulae:uEt,sheet_to_row_object_array:VN,sheet_get_cell:hA,book_new:fEt,book_append_sheet:pEt,book_set_sheet_visibility:mEt,cell_set_number_format:gEt,cell_set_hyperlink:Jbe,cell_set_internal_link:yEt,cell_add_comment:vEt,sheet_set_array_formula:_Et,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const xd=No()(dh((t,e)=>({vondsten:[],addVondst:n=>t(r=>({vondsten:[...r.vondsten,{...n,id:crypto.randomUUID(),timestamp:new Date().toISOString()}]})),removeVondst:n=>t(r=>({vondsten:r.vondsten.filter(i=>i.id!==n)})),updateVondst:(n,r)=>t(i=>({vondsten:i.vondsten.map(s=>s.id===n?{...s,...r}:s)})),clearAll:()=>t({vondsten:[]}),exportAsGeoJSON:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r={type:"FeatureCollection",features:n.map(a=>({type:"Feature",geometry:{type:"Point",coordinates:[a.location.lng,a.location.lat]},properties:{id:a.id,objectType:a.objectType,material:a.material,period:a.period,depth:a.depth,notes:a.notes,timestamp:a.timestamp,photoUrl:a.photoUrl,condition:a.condition,weight:a.weight,length:a.length}}))},i=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.geojson`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s)},exportAsCSV:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=`ID,Latitude,Longitude,Datum,Type,Materiaal,Periode,Diepte (cm),Conditie,Gewicht (g),Lengte (mm),Notities,Foto URL
`,i=n.map(c=>{const u=new Date(c.timestamp).toLocaleDateString("nl-NL"),h=c.notes?`"${c.notes.replace(/"/g,'""')}"`:"";return`${c.id},${c.location.lat},${c.location.lng},${u},${c.objectType},${c.material},${c.period},${c.depth||""},${c.condition||""},${c.weight||""},${c.length||""},${h},${c.photoUrl||""}`}).join(`
`),s=r+i,o=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(o),l=document.createElement("a");l.href=a,l.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},exportAsExcel:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=n.map(a=>({ID:a.id,Latitude:a.location.lat,Longitude:a.location.lng,Datum:new Date(a.timestamp).toLocaleDateString("nl-NL"),Type:a.objectType,Materiaal:a.material,Periode:a.period,"Diepte (cm)":a.depth||"",Conditie:a.condition||"","Gewicht (g)":a.weight||"","Lengte (mm)":a.length||"",Notities:a.notes||"","Foto URL":a.photoUrl||""})),i=O8.json_to_sheet(r),s=O8.book_new();O8.book_append_sheet(s,i,"Vondsten");const o=[{wch:36},{wch:12},{wch:12},{wch:12},{wch:15},{wch:12},{wch:25},{wch:12},{wch:12},{wch:12},{wch:12},{wch:40},{wch:50}];i["!cols"]=o,aEt(s,`mijn-vondsten-${new Date().toISOString().split("T")[0]}.xlsx`)},exportAsGPX:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const r=n.map(l=>{const c=new Date(l.timestamp).toISOString();return`  <wpt lat="${l.location.lat}" lon="${l.location.lng}">
    <name>${l.objectType} - ${l.material}</name>
    <desc>${l.period}${l.depth?`, ${l.depth}cm diep`:""}${l.condition&&l.condition!=="Onbekend"?`, ${l.condition}`:""}${l.weight?`, ${l.weight}g`:""}${l.length?`, ${l.length}mm`:""}${l.notes?`. ${l.notes}`:""}</desc>
    <time>${c}</time>
    <sym>Pin</sym>
  </wpt>`}).join(`
`),i=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>Mijn Vondsten</name>
    <desc>Geexporteerd uit DetectorApp NL</desc>
    <time>${new Date().toISOString()}</time>
  </metadata>
${r}
</gpx>`,s=new Blob([i],{type:"application/gpx+xml"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.gpx`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)},exportAsKML:()=>{const n=e().vondsten;if(n.length===0){alert("Geen vondsten om te exporteren");return}const i=`<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <name>Mijn Vondsten</name>
    <description>Geexporteerd uit DetectorApp NL</description>
${n.map(l=>{const c=new Date(l.timestamp).toLocaleDateString("nl-NL"),u=`<![CDATA[
            <b>Type:</b> ${l.objectType}<br/>
            <b>Materiaal:</b> ${l.material}<br/>
            <b>Periode:</b> ${l.period}<br/>
            ${l.depth?`<b>Diepte:</b> ${l.depth} cm<br/>`:""}
            ${l.condition&&l.condition!=="Onbekend"?`<b>Conditie:</b> ${l.condition}<br/>`:""}
            ${l.weight?`<b>Gewicht:</b> ${l.weight} gram<br/>`:""}
            ${l.length?`<b>Lengte:</b> ${l.length} mm<br/>`:""}
            <b>Datum:</b> ${c}<br/>
            ${l.notes?`<b>Notities:</b> ${l.notes}<br/>`:""}
            ${l.photoUrl?`<a href="${l.photoUrl}">Bekijk foto</a>`:""}
          ]]>`;return`    <Placemark>
      <name>${l.objectType} - ${l.material}</name>
      <description>${u}</description>
      <Point>
        <coordinates>${l.location.lng},${l.location.lat},0</coordinates>
      </Point>
    </Placemark>`}).join(`
`)}
  </Document>
</kml>`,s=new Blob([i],{type:"application/vnd.google-earth.kml+xml"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`mijn-vondsten-${new Date().toISOString().split("T")[0]}.kml`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o)}}),{name:"detectorapp-local-vondsten"})),xEt={Fectio:{naam:"Fectio",latinNaam:"Fectio",type:"castellum",periode:"ca. 4 - 270 n.Chr.",beschrijving:"Groot Romeins castellum bij Bunnik/Vechten, aan de splitsing van Rijn en Vecht. Een van de belangrijkste legerbases in Nederland met ruimte voor 500 soldaten. Het fort had barakken, badhuis, hospitaal en pakhuizen. Buiten de muren woonden handelaren en soldatenfamilies in een vicus. Hier is een compleet Romeins schip gevonden (De Meern 1). Strategisch gelegen voor transport over de rivieren. Veel vondsten door natte bodem: leer, hout, textiel naast munten en militaria. Te bezoeken: Archeologisch Park Castellum Hoge Woerd met reconstructie en museum.",watWasHier:"Groot castellum met ruimte voor 500 soldaten, barakken, badhuis, hospitaal en pakhuizen. Buiten het fort een burgerdorp.",watTeZien:"Archeologisch Park Castellum Hoge Woerd toont de contouren. Museum met veel vondsten waaronder een Romeins schip.",verwachteVondsten:"Munten, fibulae, aardewerk, wapens, paardentuig, militaire uitrusting. Door natte bodem ook leer, hout en textiel.",betekenis:"Een van de belangrijkste forten aan de Limes. Knooppunt voor troepen- en goederentransport.",bronnen:["https://www.hogewoerd.nl","https://www.livius.org/articles/place/fectio-vechten/"]},Traiectum:{naam:"Traiectum",latinNaam:"Traiectum",type:"castellum",periode:"ca. 42 - 275 n.Chr.",beschrijving:'Romeins castellum onder het huidige Domplein in Utrecht. De naam betekent "doorwaadbare plaats" - hier splitsten Rijn en Vecht. Het fort (124x152m in laatste fase) bood plaats aan ca. 500 soldaten. Vijf bouwfases: eerst hout, na 200 n.Chr. steen met tufsteen uit de Eifel. Cohors II Hispanorum peditata (Spaanse infanterie) was hier uniek gelegerd 88-275 n.Chr. - hun dakpanstempels zijn nergens anders aan de Limes gevonden! Het fort werd verwoest tijdens de Bataafse Opstand (69 n.Chr.). DOMunder onder het Domplein toont de opgegraven resten. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Castellum (500 soldaten) bij riviersplitsing. Cohors II Hispanorum gelegerd.",watTeZien:"DOMunder onder het Domplein: opgravingen te bezoeken. Principia en poorten blootgelegd.",verwachteVondsten:"Dakpannen met stempels, munten, aardewerk, tufsteen bouwmateriaal, militaria.",betekenis:"UNESCO Werelderfgoed. Oorsprong van de stad Utrecht.",bronnen:["https://www.livius.org/articles/place/traiectum-utrecht/","https://www.utrechtaltijd.nl/verhalen/castellum-traiectum-een-romeinse-legerbasis-in-het-hart-van-de-domstad/","https://www.romeinen.nl/locatie-overzicht/3447271878/domunder-castellum-traiectum"]},Laurum:{naam:"Laurum",latinNaam:"Laurum",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in het huidige Woerden aan de Oude Rijn. Garnizoen van ca. 500 soldaten in houten barakken. Bijzonder vanwege de natte veenbodem: organisch materiaal bleef bewaard zoals houten schrijfplankjes met Latijnse teksten, leren schoenen en een Romeinse boot. Het fort werd meerdere keren herbouwd na overstromingen. De contouren zijn in het stratenpatroon herkenbaar. Buiten de muren lag een vicus (burgerdorp). Vondsten in Stadsmuseum Woerden, waaronder unieke houten voorwerpen die elders zijn vergaan.",watWasHier:"Castellum voor 500 soldaten met houten barakken, badhuis en pakhuizen. Vicus buiten de muren.",watTeZien:"Stadsmuseum Woerden met bijzondere vondsten. Fort-contouren in stratenpatroon herkenbaar.",verwachteVondsten:"Militaria, aardewerk, munten, schrijfplankjes. Door natte veengrond ook hout, leer en schoenen.",betekenis:"Toont Romeins bouwen in moeilijk veengebied. Unieke organische vondsten.",bronnen:["https://www.castellumwoerden.nl"]},"Castellum Praetorium Agrippinae":{naam:"Praetorium Agrippinae",latinNaam:"Praetorium Agrippinae",type:"castellum",periode:"ca. 40 - 275 n.Chr.",beschrijving:"Een van de best opgegraven Romeinse locaties van Nederland. Het castellum werd gesticht in de winter van 39/40 n.Chr. door keizer Caligula, vernoemd naar zijn moeder Vipsania Agrippina. Een opgegraven wijnvat bevatte wijn van de persoonlijke wijngaarden van de keizer! Er zijn 7 bouwfasen gevonden, 6 van hout en de laatste van steen - uniek compleet inzicht in Romeinse bouwtechnieken. Cohors III Gallorum equitata was hier gelegerd. Bij opgravingen (1941-1953) zijn door het grondwater veel organische vondsten bewaard: voedselresten, leer, touw. De vicus buiten het fort strekte zich 1 km uit met 700+ graven. Op het Castellumplein zijn de contouren in brons gemarkeerd.",watWasHier:"Castellum met 7 bouwfasen. Vicus (1 km) met 700+ graven. Detachement Cohors III Gallorum.",watTeZien:"Castellumplein met bronzen markeringen. Torenmuseum Valkenburg. Gereconstrueerde poort.",verwachteVondsten:"Militaria, organisch materiaal (voedsel, leer, touw), aardewerk, munten, inscripties.",betekenis:"Best gedocumenteerde Romeinse fort van Nederland. UNESCO Werelderfgoed.",bronnen:["https://www.livius.org/articles/place/praetorium-agrippinae-valkenburg-zh/","https://www.geschiedenisvanzuidholland.nl/zien-en-doen/locaties/praetorium-agrippinae-in-valkenburg/","https://oudvalkenburgzh.nl/torenmuseum-5/"]},"Castra Hunnerberg":{naam:"Castra Hunnerberg",latinNaam:"Castra",type:"legerkamp",periode:"ca. 16 v.Chr. - 104 n.Chr.",beschrijving:'Enorm Romeins legerkamp op de Hunnerberg bij Nijmegen - 42 hectare (80 voetbalvelden), ruimte voor 12.000 man. De enige plek in Nederland waar echte legioenen (geen hulptroepen) verbleven! Na de Bataafse Opstand (69 n.Chr.) vestigde Legio X Gemina Pia Fidelis zich hier - opgericht door Julius Caesar en het bekendste legioen van Nederland. De afkorting LXG is talloze keren gevonden op dakpannen en tegels. Bij opgravingen zijn ruim 1000 fragmenten militaire uitrusting en paardentuig gevonden. In 104 n.Chr. vertrok het legioen naar de Balkan - een ramp voor de economie. UNESCO Werelderfgoed sinds 2021, omschreven als "bakermat van de Nederduitse Limes".',watWasHier:"Legerkamp voor 12.000 man. Legio X Gemina (71-104 n.Chr.), opgericht door Julius Caesar.",watTeZien:"Museum Het Valkhof. Museum Kam in de Hunnerberg. Grafvelden in Nijmegen-Oost.",verwachteVondsten:"Legioenstempels LXG, militaria, paardentuig, dakpannen, munten, grafstenen.",betekenis:"UNESCO Werelderfgoed. Bakermat van de Limes. Enige legioenskamp in Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-hunnerberg/","https://www.welkominnijmegen.nl/pages/geschiedenis/de-romeinen-in-nijmegen/de-legerkampen.php","https://mijngelderland.nl/inhoud/specials/archeokroniek/romeinse-militaire-uitrusting-en-paardentuig-van-de-hunerberg-te-nijmegen"]},"Castellum Kops Plateau":{naam:"Kops Plateau",latinNaam:"Oppidum Batavorum",type:"castellum",periode:"ca. 10 v.Chr. - 70 n.Chr.",beschrijving:"Vroege Romeinse basis op het Kops Plateau in Nijmegen, later de civiele hoofdstad van de Bataven: Oppidum Batavorum. Hier woonden Romeinen en Bataven samen - het eerste contactpunt tussen beide culturen. Verwoest tijdens de Bataafse Opstand van 69-70 n.Chr. onder leiding van Julius Civilis. Gemengde vondsten: Romeinse militaria n Keltisch-Bataafse voorwerpen. Vroege importaardewerk en munten van Augustus. Nu natuurgebied. Museum Het Valkhof toont de unieke vondsten van deze ontmoeting van culturen.",watWasHier:"Eerst Romeins kamp, later Bataafse hoofdstad. Romeinen en Bataven woonden samen.",watTeZien:"Kops Plateau is natuurgebied. Museum Het Valkhof toont de vondsten.",verwachteVondsten:"Vroege militaria, Keltisch-Bataafse voorwerpen, importaardewerk, munten van Augustus.",betekenis:"Eerste contactpunt Romeinen-Bataven. Begin van romanisering Nederland.",bronnen:["https://www.livius.org/articles/place/noviomagus-nijmegen-kops-plateau/"]},"Nijmegen, Valkhof":{naam:"Valkhof Nijmegen",latinNaam:"Valkhof",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:"Laat-Romeinse versterking op het Valkhof in Nijmegen, aan de Waaloever. Gebouwd toen het Rijk onder druk stond van Germaanse invallen. Strategische positie boven de rivier. Continuteit: Karel de Grote bouwde hier later zijn palts (koninklijke residentie). De Sint-Nicolaaskapel bevat mogelijk Karolingische elementen op Romeinse fundamenten. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Museum Het Valkhof toont de overgang van Romeinse tijd naar vroege middeleeuwen.",watWasHier:"Laat-Romeinse versterking boven de Waal. Later Karolingische palts.",watTeZien:"Valkhofpark met Sint-Nicolaaskapel. Museum Het Valkhof.",verwachteVondsten:"Laat-Romeinse munten, gordels, riemtongen, militaire gespen, 3e-4e eeuws aardewerk.",betekenis:"Toont overgang Romeinse tijd naar middeleeuwen. Nijmegen bleef machtscentrum.",bronnen:["https://www.museumhetvalkhof.nl"]},"Castellum Op de Hoge Woerd":{naam:"Hoge Woerd",latinNaam:"Castellum",type:"castellum",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeins castellum in Leidsche Rijn (Utrecht), nu een voorbeeldig archeologisch park. Middelgroot fort met houten gebouwen en een burgerdorp (vicus) buiten de muren. Hier is een compleet Romeins schip gevonden: De Meern 1, een 25 meter lange vrachtboot. Door de natte kleigrond bleef veel organisch materiaal bewaard. Het park toont de reconstructie van het fort - je kunt over de originele fundamenten lopen. Modern museum met interactieve presentatie. Ideale plek om te zien hoe een Romeins fort eruitzag.",watWasHier:"Middelgroot castellum met houten gebouwen. Vicus buiten de muren. Compleet schip gevonden.",watTeZien:"Archeologisch Park Hoge Woerd: reconstructie fort, museum, originele fundamenten.",verwachteVondsten:"Militaria, scheepsonderdelen, aardewerk, munten. Door natte grond ook organisch materiaal.",betekenis:"Best gepresenteerde Romeinse fort in Nederland. Ideaal om fort-layout te begrijpen.",bronnen:["https://www.hogewoerd.nl"]},Lugdunum:{naam:"Lugdunum",latinNaam:"Lugdunum",type:"vlootbasis",periode:"ca. 40 - 270 n.Chr.",beschrijving:`Romeinse vlootbasis en versterkte graanopslagplaats bij de monding van de Rijn, het westelijkste punt van de gehele Limes. Hier stond mogelijk een enorme vuurtoren (ca. 60m hoog) naar model van de Pharos van Ostia - vissers noemden deze "Kalla's toren" (Caligula). Door de vele dakpannen van de Romeinse vloot wordt aangenomen dat dit een vlootbasis was. Het fort is door kustafslag in zee verdwenen. Bij stormen in 1520, 1552 en 1562 waren de runes van de "Brittenburg" zichtbaar op het strand; de laatst gedateerde vondst was 270 n.Chr. Het Rijksmuseum van Oudheden in Leiden toont vondsten. De beroemde kaart van Ortelius toont hoe het eruit zag.`,watWasHier:"Vlootbasis met vuurtoren bij Rijnmonding. Graanopslag voor Britannia.",watTeZien:"Fort verdwenen in zee. RMO Leiden toont vondsten en kaart van Ortelius.",verwachteVondsten:"Na stormen: munten, aardewerk, militaria. Fort zelf onbereikbaar in Noordzee.",betekenis:"Westelijk eindpunt van de Limes. Verbinding met Britannia.",bronnen:["https://www.livius.org/articles/place/lugdunum-katwijk/","https://nl.wikipedia.org/wiki/Lugdunum_(Katwijk)"]},"Vlootbasis Naaldwijk":{naam:"Vlootbasis Naaldwijk",type:"vlootbasis",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Vermoedelijke basis van de Classis Germanica (Germaanse vloot) bij Naaldwijk in het Westland. De Romeinse vloot patrouilleerde langs de Noordzeekust en vervoerde troepen en goederen naar Britannia. Haven met dokken voor oorlogsschepen en transportboten. Mariniers (classiarii) waren hier gestationeerd. Het gebied is nu landbouwgrond, maar bij opgravingen zijn haven-structuren en scheepsgerelateerde vondsten gedaan. Ankers, scheepsonderdelen en specifieke mariniers-uitrusting. Toont het belang van zeemacht voor de Romeinse grensverdediging.",watWasHier:"Haven voor oorlogsschepen. Mariniers gestationeerd. Patrouilles langs Noordzeekust.",watTeZien:"Gebied is landbouwgrond. Vondsten in lokale musea.",verwachteVondsten:"Scheepsonderdelen, ankers, mariniers-uitrusting, importaardewerk.",betekenis:"Toont belang Romeinse vloot voor kustverdediging.",bronnen:[]},"Minifort Ockenburg":{naam:"Minifort Ockenburg",type:"minifort",periode:"ca. 150 - 180 n.Chr.",beschrijving:"Klein Romeins kustfort bij Ockenburg in Den Haag, op een oude strandwal. Bewaakte de kust tegen piraten en Germaanse invallen over zee. Ruimte voor slechts 20-30 soldaten - een wachtpost eerder dan een echt fort. Korte gebruiksperiode van ca. 30 jaar. Toont dat de Romeinen niet alleen de rivieren maar ook de Noordzeekust verdedigden. Het terrein is beschermd rijksmonument maar niet publiek toegankelijk. Vondsten in het Haags Historisch Museum: militaria, aardewerk en munten uit de 2e eeuw.",watWasHier:"Kleine kustwachtpost voor 20-30 soldaten op strandwal.",watTeZien:"Terrein beschermd maar niet toegankelijk. Haags Historisch Museum.",verwachteVondsten:"Kleine hoeveelheden militaria, aardewerk, munten 2e eeuw.",betekenis:"Toont Romeinse kustverdediging naast rivierforten.",bronnen:[]},"Castellum Ceuclum":{naam:"Ceuclum",latinNaam:"Ceuclum",type:"castellum",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Romeins castellum bij Cuijk aan de Maas, waar de belangrijke weg naar het noorden de rivier kruiste. Het fort bewaakte een brug of veerpont. Garnizoen van hulptroepen. De naam Cuijk is afgeleid van Ceuclum. Bij de brug werden ritueel munten geofferd. Het fort lag op een strategisch punt waar de Maasroute de landweg kruiste. Vondsten wijzen op handel en militaire activiteit. Het Maasmuseum in Cuijk toont lokale Romeinse vondsten. Onder het centrum zijn bij bouwwerkzaamheden regelmatig resten gevonden.",watWasHier:"Castellum bij Maasbrug. Belangrijke rivierovergang en kruispunt.",watTeZien:"Maasmuseum Cuijk. Resten gevonden onder centrum.",verwachteVondsten:"Munten (geofferd bij brug), fibulae, aardewerk, bruggerelateerde vondsten.",betekenis:"Belangrijke schakel in wegennet langs de Maas.",bronnen:["https://www.livius.org/articles/place/ceuclum-cuijk/"]},"Castellum Meinerswijk":{naam:"Meinerswijk",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum in de uiterwaarden bij Arnhem-Meinerswijk aan de Rijn. Het fort bewaakt een strategisch punt waar de rivier goed te overzien was. Meerdere bouwfasen door overstromingen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan: militaria, aardewerk, munten en scheepsresten. Het gebied is nu natuurgebied Meinerswijk met wisselende waterstanden. Na hoog water kunnen vondsten aan de oppervlakte komen. Museum Arnhem toont Romeinse vondsten uit de regio.",watWasHier:"Castellum in uiterwaarden. Meerdere bouwfasen door overstromingen.",watTeZien:"Natuurgebied Meinerswijk. Museum Arnhem.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},Levefanum:{naam:"Levefanum",latinNaam:"Levefanum",type:"versterking",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Romeinse versterking bij Wijk bij Duurstede, waar de Rijn splitste in de Lek en Kromme Rijn. Strategisch cruciaal punt voor controle over het scheepvaartverkeer. Waarschijnlijk ook een haven voor overslag van goederen. Op dezelfde plek ontstond later de Karolingische handelsstad Dorestad, een van de belangrijkste havens van vroegmiddeleeuws Europa. De continuteit toont het blijvende belang van deze locatie. Dorestad Museum vertelt het verhaal van Romeinse tijd tot Vikingaanvallen. Vondsten: munten, handelsaardewerk, militaria.",watWasHier:"Versterking bij riviersplitsing. Haven en overslagpunt. Later Dorestad.",watTeZien:"Dorestad Museum. Terrein bebouwd.",verwachteVondsten:"Munten, handelsaardewerk, militaria, scheepsgerelateerde vondsten.",betekenis:"Strategisch controlepunt waterwegen. Later belangrijke handelsstad Dorestad.",bronnen:[]},"Nigrum Pullum":{naam:"Nigrum Pullum",latinNaam:"Nigrum Pullum (Zwarte Poel)",type:"minifort",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Zwammerdam aan de Oude Rijn. Garnizoen van 100-150 soldaten met pakhuizen en haven voor riviertransport. Wereldberoemd door de vondst van 6 Romeinse schepen (1971-1974) in perfecte staat - bewaard door de natte veengrond. De Zwammerdamschepen zijn de best bewaarde Romeinse rivierschepen ter wereld en tonen uniek inzicht in Romeins transport en scheepsbouw. Vondsten: schepen, leren schoeisel, houten voorwerpen, aardewerk, munten, militaria. Te zien in Rijksmuseum van Oudheden, Leiden.",watWasHier:"Klein fort met pakhuizen en haven. Bij opgravingen werden 6 Romeinse schepen gevonden.",watTeZien:"De schepen zijn in het Rijksmuseum van Oudheden in Leiden. Het terrein zelf is niet te bezoeken.",verwachteVondsten:"Scheepsonderdelen, leren schoeisel, houten voorwerpen, aardewerk, munten, en door de natte veengrond organisch materiaal.",betekenis:"Wereldberoemd om de goed bewaarde Romeinse schepen. Toont transport over de Rijn.",bronnen:["https://www.rmo.nl/collectie/themas/zwammerdam"]},"Stenen wachttoren Vleuterweide":{naam:"Wachttoren Vleuterweide",type:"wachttoren",periode:"ca. 150 - 250 n.Chr.",beschrijving:"Bijzondere stenen wachttoren in Vleuterweide bij Utrecht - de meeste Romeinse wachttorens waren van hout. De stenen constructie wijst op permanentie en belang. Onderdeel van het signaleringssysteem langs de Limes: bij gevaar werden vuren aangestoken om forten te waarschuwen. De toren bood uitzicht over de omgeving en de rivier. Mogelijk woonden hier ook families van de soldaten. De fundamenten zijn gemarkeerd in de moderne woonwijk. Vondsten: bouwmateriaal (dakpannen, stenen), aardewerk, persoonlijke bezittingen. Centraal Museum Utrecht.",watWasHier:"Stenen wachttoren (ongebruikelijk). Signaalpost voor waarschuwingssysteem.",watTeZien:"Fundamenten gemarkeerd in wijk. Centraal Museum Utrecht.",verwachteVondsten:"Dakpannen met legioenstempels, aardewerk, persoonlijke bezittingen.",betekenis:"Een van weinige bekende stenen wachttorens. Toont variatie in bouwwijzen.",bronnen:[]},"Wachttoren Bunnik":{naam:"Wachttoren Bunnik",type:"wachttoren",periode:"ca. 50 - 270 n.Chr.",beschrijving:"Houten wachttoren bij Bunnik aan de Rijn, onderdeel van het signaleringssysteem langs de Limes. Elke paar kilometer stond een toren met uitzicht over de rivier. Bij nadering van vijanden werden vuren of rooksignalen gegeven, zodat binnen minuten alle forten gewaarschuwd waren. De torens waren meestal van hout op een aarden verhoging. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend doordat het gebied nu bebouwd is. Vondsten zijn schaars: wat aardewerk en militaria.",watWasHier:"Houten uitkijktoren voor signalering. Kleine bezetting van 4-8 soldaten.",watTeZien:"Exacte locatie onbekend. Gebied bebouwd.",verwachteVondsten:"Kleine hoeveelheden militaria en aardewerk.",betekenis:"Onderdeel signaleringssysteem langs Limes.",bronnen:[]},"Castellum Maastricht":{naam:"Castellum Maastricht",latinNaam:"Mosae Trajectum",type:"versterking",periode:"ca. 270 - 400 n.Chr.",beschrijving:'Laat-Romeinse versterking in het centrum van Maastricht bij de brug over de Maas. Mosae Trajectum betekent "Maasoversteek". Gebouwd in een periode dat het Rijk onder druk stond van Germaanse invallen. Het fort bewaakte de strategische rivierovergang. Continuteit van bewoning: Maastricht bleef bewoond tot op heden. Onder het Vrijthof en omgeving zijn Romeinse resten gevonden. Typische laat-Romeinse vondsten: gordels, riembeslag, munten 3e-4e eeuw, zwaar versterkte muren. Centre Ceramique vertelt de geschiedenis.',watWasHier:"Laat-Romeinse versterking bij Maasbrug. Verdediging tegen Germaanse invallen.",watTeZien:"Onder Vrijthof zijn resten. Centre Ceramique.",verwachteVondsten:"Laat-Romeinse munten, militaire gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont continuteit - Maastricht ononderbroken bewoond sinds Romeinse tijd.",bronnen:["https://www.centreceramique.nl"]},Roompot:{naam:"Roompot Fort",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de Roompot in Zeeland dat de toegang tot de Oosterschelde bewaakte. Het fort beschermde schepen tegen piraterij en controleerde de vaarroute. Door zeespiegelstijging en kustafslag is het fort in de golven verdwenen. De exacte locatie ligt nu onder water. Soms spoelen na stormen vondsten aan op de stranden van Noord-Beveland en Walcheren: munten, aardewerk, metalen voorwerpen. Toont dat de Romeinen de gehele Zeeuwse delta controleerden, niet alleen de grote rivieren.",watWasHier:"Kustfort dat zeeroute bewaakte. Bescherming tegen piraterij.",watTeZien:"Fort verdwenen in zee. Soms vondsten op strand na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen voorwerpen op Zeeuwse stranden.",betekenis:"Toont Romeinse controle over Zeeuwse wateren.",bronnen:[]},"Castellum Carvium":{naam:"Carvium",latinNaam:"Carvium",type:"castellum",periode:"ca. 40 - 270 n.Chr.",beschrijving:"Romeins castellum bij Herwen-Aerdt (bij Lobith) waar Rijn en Waal samenkwamen - een strategisch knooppunt van eerste orde. Het fort controleerde het rivierverkeer op beide grote stromen. Garnizoen van hulptroepen. In de uiterwaarden zijn bij erosie en opgravingen vondsten gedaan. Het gebied is nu natuurgebied de Gelderse Poort met dynamische rivierlandschap. Na hoog water kunnen vondsten aan oppervlakte komen. Museum Het Valkhof in Nijmegen toont vondsten uit de regio. Scheepsresten gevonden.",watWasHier:"Fort bij samenvloeiing Rijn en Waal. Controleerde twee grote rivieren.",watTeZien:"Natuurgebied Gelderse Poort. Museum Het Valkhof Nijmegen.",verwachteVondsten:"Militaria, aardewerk, munten, scheepsresten. Na hoog water aan oppervlakte.",betekenis:"Controleerde strategisch knooppunt waterwegen.",bronnen:[]},Matilo:{naam:"Matilo",latinNaam:"Matilo",type:"castellum",periode:"ca. 70 - 260 n.Chr.",beschrijving:'Romeins castellum bij Leiden-Roomburg, gebouwd na de Bataafse Opstand (69-70 n.Chr.) op een strategische plek aan de monding van het Kanaal van Corbulo. Het gigantische fort (80x120m) bood plaats aan ca. 500 soldaten en is een van de best bewaarde castella in Nederland. De archeologische resten liggen grotendeels intact onder Archeologisch Park Matilo. In het park staan 6 replica-wachttorens en een aarden wal die de omtrek van het fort visualiseert. Het fort werd tussen 240-260 n.Chr. opgeheven. De locatie Roomburg ("Romeinse burcht") verwijst naar de oorsprong. UNESCO Werelderfgoed sinds 2021.',watWasHier:"Groot castellum (500 soldaten) bij monding Kanaal van Corbulo. Vicus buiten de muren.",watTeZien:"Archeologisch Park Matilo met 6 wachttoren-replica's en aarden wal. Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, grafgiften, crematie-urnen, aardewerk, munten, fibulae.",betekenis:"UNESCO Werelderfgoed. Een van de best bewaarde castella van Nederland.",bronnen:["https://parkmatilo.nl/het-verhaal-van-matilo/","https://www.limeswerelderfgoed.nl/locaties/2016475046/archeologisch-park-matilo","https://www.romeinen.nl/locatie-overzicht/2016475046/archeologisch-park-matilo"]},Corbulo:{naam:"Forum Hadriani",latinNaam:"Forum Hadriani (Municipium Aelium Cananefatium)",type:"versterking",periode:"ca. 70 - 270 n.Chr.",beschrijving:"Forum Hadriani bij Voorburg was de noordelijkste Romeinse stad van het Europese continent en de enige stad met stadsrechten in Nederland. Gesticht rond 70 n.Chr. aan het Kanaal van Corbulo (34 km, verbinding Rijn-Maas). Keizer Hadrianus verleende in 121 n.Chr. marktrechten en gaf de stad zijn naam. Rond 150 n.Chr. kreeg het stadsrechten (Municipium). De stad had ca. 1000 inwoners, een stadsmuur met dubbele gracht, stenen gebouwen en tempels. Park Arentsburgh markeert de locatie. UNESCO Werelderfgoed sinds 2021. De eerste wetenschappelijke opgravingen (1827-1833) waren door Caspar Reuvens, de eerste hoogleraar archeologie ter wereld.",watWasHier:"Enige Romeinse stad met stadsrechten in Nederland. Ca. 1000 inwoners.",watTeZien:"Park Arentsburgh in Voorburg. Kanaal traceerbaar als de Vliet.",verwachteVondsten:"Stedelijke vondsten: bouwmateriaal, aardewerk, munten, inscripties, religieuze voorwerpen.",betekenis:"UNESCO Werelderfgoed. Noordelijkste Romeinse stad van Europa.",bronnen:["https://www.awlv.nl/forum-hadriani/de-stad-forum-hadriani/","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/regio-voorburg","https://kennis.cultureelerfgoed.nl/index.php/Monumenten/508083"]},"Berg - Tomveld":{naam:"Berg-Tomveld",type:"villa",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse villa bij Berg in Zuid-Limburg, mogelijk tijdelijk militair gebruikt. Dit type gebouwen diende als landbouwbedrijf met luxe woondeel voor de eigenaar. De regio Zuid-Limburg was dicht bebouwd met villa's die graan en vee leverden aan het Romeinse leger. Vondsten wijzen op welvaart: mozaekvloeren, beschilderd pleisterwerk, hypocaustum (vloerverwarming). De locatie Tomveld verwijst mogelijk naar Romeinse grafheuvels (tumuli) in de buurt. Thermenmuseum Heerlen toont de villa-cultuur.",watWasHier:"Villa rustica met mogelijk militair gebruik. Landbouw voor legervoorraden.",watTeZien:"Locatie in agrarisch gebied. Thermenmuseum Heerlen.",verwachteVondsten:"Bouwmateriaal, dakpannen, aardewerk, munten, sieraden.",betekenis:"Toont Romeinse landbouweconomie in Zuid-Limburg.",bronnen:[]},"Berg - Trappenberg":{naam:"Berg-Trappenberg",type:"legerkamp",periode:"1e eeuw v.Chr. - 1e eeuw n.Chr.",beschrijving:"Vroeg-Romeins legerkamp bij Berg in Zuid-Limburg dat later werd omgebouwd tot villa of boerderij. Toont de transitie van militaire bezetting naar civiele bewoning. Het kamp dateert uit de veroveringsperiode toen Rome dit gebied inlijfde. Na pacificatie was een fort niet meer nodig en werd het terrein civiel benut. Vondsten: vroege Romeinse militaria naast later agrarisch materiaal. Zuid-Limburg was een grenszone voordat de Limes naar de Rijn verplaatste.",watWasHier:"Eerst legerkamp, later villa/boerderij. Overgang militair naar civiel.",watTeZien:"Locatie in landbouwgebied.",verwachteVondsten:"Vroege militaria, later agrarisch aardewerk, bouwmateriaal.",betekenis:"Toont Romeinse verovering en pacificatie van Zuid-Limburg.",bronnen:[]},"Castellum Blariacum":{naam:"Blariacum",latinNaam:"Blariacum",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van het Romeinse castellum Blariacum bij Blerick (nu deel van Venlo). De naam leeft voort in de plaatsnaam. Het fort zou de Maasovergang hebben bewaakt op de route tussen Xanten en Maastricht. De exacte locatie is nooit definitief vastgesteld ondanks vele opgravingspogingen. Vondsten in de omgeving wijzen wel op Romeinse militaire aanwezigheid: militaria, munten, aardewerk. Het Limburgs Museum in Venlo toont de Romeinse geschiedenis van de regio.",watWasHier:"Vermoedelijk castellum bij Maasovergang. Exacte locatie onzeker.",watTeZien:"Locatie niet vastgesteld. Limburgs Museum Venlo.",verwachteVondsten:"Militaria, munten, aardewerk als aanwijzingen voor fortlocatie.",betekenis:"Plaatsnaam Blerick afgeleid van Blariacum. Schakel in Maasroute.",bronnen:[]},"Fortificatie Bodegraven":{naam:"Wachtpost Bodegraven",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Waarschijnlijke Romeinse wachtpost bij Bodegraven aan de Oude Rijn. Onderdeel van het signaleringssysteem tussen de grotere forten zoals Nigrum Pullum en Laurum. De wachttorens stonden om de paar kilometer en konden met vuur- of rooksignalen waarschuwingen doorgeven. Kleine bezetting van 4-8 soldaten. De exacte locatie is niet precies bekend. Bij graafwerkzaamheden in Bodegraven zijn wel Romeinse scherven gevonden die op aanwezigheid wijzen.",watWasHier:"Kleine wachtpost voor signalering. 4-8 soldaten.",watTeZien:"Exacte locatie onbekend.",verwachteVondsten:"Aardewerk, kleine hoeveelheden militaria.",betekenis:"Onderdeel communicatiesysteem langs de Limes.",bronnen:[]},Caestert:{naam:"Caestert",type:"versterking",periode:"1e eeuw v.Chr.",beschrijving:"Mogelijk de locatie waar de Eburonen onder leiding van Ambiorix in 54 v.Chr. een Romeins legioen vernietigden - de zwaarste Romeinse nederlaag in de Lage Landen. Het plateau van Caestert bij Kanne (Belgisch Limburg) had een oppidum (versterkte nederzetting). Julius Caesar beschrijft de slag in zijn Gallische Oorlogen. De locatie is omstreden, maar Caestert is een sterke kandidaat. Symbolisch belangrijke plek voor de Belgische geschiedenis. De site is nu natuurgebied met grotten.",watWasHier:"Mogelijk slagveld Ambiorix-opstand 54 v.Chr. Oppidum (versterking).",watTeZien:"Plateau Caestert, natuurgebied met grotten.",verwachteVondsten:"Keltische en vroeg-Romeinse voorwerpen, mogelijk slagveldvondsten.",betekenis:"Mogelijke locatie grootste Romeinse nederlaag in de regio.",bronnen:[]},"Castellum Driel?":{naam:"Castellum Driel",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:'Mogelijke locatie van een Romeins castellum bij Driel in de Betuwe. Het bestaan en de exacte locatie zijn onzeker, vandaar het vraagteken. De Betuwe (Insula Batavorum - "Eiland der Bataven") was kerngebied van de Bataven, bondgenoten van Rome. Zij leverden beroemde hulptroepen aan het Romeinse leger. Een fort hier zou logisch zijn om het gebied te controleren. Vondsten in de omgeving wijzen op Romeinse aanwezigheid. Museum Het Valkhof Nijmegen toont de Bataafse cultuur.',watWasHier:"Mogelijk castellum in Bataafs kerngebied. Bestaan onzeker.",watTeZien:"Geen zichtbare resten. Museum Het Valkhof.",verwachteVondsten:"Romeinse en Bataafse voorwerpen indien locatie juist.",betekenis:"Zou Romeinse controle over Bataafs gebied tonen.",bronnen:[]},"Castellum Duiven - Loowaard":{naam:"Duiven-Loowaard",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Duiven/Loowaard aan de Rijn, in de uiterwaarden tussen Arnhem en Zevenaar. Het fort bewaakte de rivierroute en de overgang naar het Bataafse gebied. De dynamische rivier heeft veel resten weggespoeld of diep begraven. Bij lage waterstanden en na erosie komen soms vondsten aan oppervlakte: munten, militaria, aardewerk. Het gebied is nu natuurgebied met grazende grote grazers. Museum Arnhem en Het Valkhof Nijmegen tonen vondsten uit de regio.",watWasHier:"Castellum aan de Rijn in uiterwaarden. Bewaakte rivierovergang.",watTeZien:"Natuurgebied. Na erosie mogelijk vondsten aan oppervlakte.",verwachteVondsten:"Militaria, munten, aardewerk na erosie of bij laag water.",betekenis:"Onderdeel fortenketen langs de Rijn.",bronnen:[]},"Castellum Grinnes":{naam:"Grinnes",latinNaam:"Grinnes",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins castellum bij Rossum in de gemeente Maasdriel - waarschijnlijk het antieke Grinnes vermeld op de Peutingerkaart. Het fort lag aan de Waal en controleerde de rivierroute. Bij opgravingen zijn resten van het fort gevonden. De omgeving is rijk aan Romeinse vondsten: militaria, munten, aardewerk, bouwmateriaal. Het Museum voor de Bommelerwaard in Ammerzoden toont lokale vondsten. De naam Grinnes leeft niet voort in moderne plaatsnamen.",watWasHier:"Castellum aan de Waal. Vermeld op Peutingerkaart.",watTeZien:"Locatie opgegraven. Museum Bommelerwaard.",verwachteVondsten:"Militaria, munten, aardewerk, bouwmateriaal.",betekenis:"Verbinding antieke bronnen met archeologische locatie.",bronnen:[]},"Wachttoren Heumen":{naam:"Wachttoren Heumen",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren bij Heumen ten zuiden van Nijmegen. Onderdeel van het signaleringssysteem langs de Maas en verbindingswegen. De torens stonden op strategische punten met goed uitzicht. Bij nadering van vijanden werden signalen gegeven naar de grotere forten. Kleine bezetting van 4-8 soldaten die in de toren woonden. De exacte locatie is archeologisch vastgesteld. Vondsten: militaria, aardewerk, persoonlijke bezittingen.",watWasHier:"Signaleertoren met klein garnizoen. Uitzichtpunt.",watTeZien:"Locatie bekend maar geen zichtbare resten.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Onderdeel communicatienetwerk Romeins leger.",bronnen:[]},"Castellum Huissen?":{naam:"Castellum Huissen",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Huissen aan de Rijn. Het bestaan is niet zeker vastgesteld, vandaar het vraagteken. Huissen ligt op een logische plek tussen de bekende forten bij Arnhem en Zevenaar. Vondsten in de omgeving wijzen op Romeinse activiteit. De moderne bebouwing maakt onderzoek lastig. Als er een fort was, bewaakte het de rivierroute en mogelijk een oversteekplaats.",watWasHier:"Mogelijk castellum aan de Rijn. Bestaan onzeker.",watTeZien:"Geen resten zichtbaar. Gebied bebouwd.",verwachteVondsten:"Romeinse vondsten die fortaanwezigheid zouden bevestigen.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Castellum Kessel-Lith":{naam:"Kessel-Lith",type:"castellum",periode:"3e - 4e eeuw n.Chr.",beschrijving:"Laat-Romeins castellum uit de 3e-4e eeuw bij Kessel-Lith aan de Maas. Gebouwd in een periode van Germaanse invallen toen de oude Limes niet meer te handhaven was. Dit type forten was compacter en zwaarder versterkt dan de vroege castella. De locatie bij een rivierovergang bleef strategisch. Typische laat-Romeinse vondsten: gordels met riemtongen, militaire gespen, munten van 3e-4e eeuwse keizers. Het fort toont de veranderde militaire strategie van het late Romeinse Rijk.",watWasHier:"Laat-Romeins fort, compacter en zwaarder versterkt.",watTeZien:"Locatie bekend, weinig zichtbaar.",verwachteVondsten:"Laat-Romeinse munten, gordelbeslag, riemtongen, 3e-4e eeuws aardewerk.",betekenis:"Toont Romeinse aanpassing aan nieuwe dreigingen.",bronnen:[]},Carvo:{naam:"Carvo",latinNaam:"Carvo",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke Romeinse versterking nabij Kesteren in de Betuwe. De naam komt voor op de Peutingerkaart. Kesteren lag in het hart van het Bataafse stamgebied. De Bataven waren belangrijke bondgenoten van Rome en leverden beroemde cavalerie-eenheden. Een versterking hier zou zowel bescherming als controle bieden. De exacte locatie is niet vastgesteld. Vondsten in de regio tonen intensief Romeins-Bataafs contact: import-aardewerk, wapens, paardentuig.",watWasHier:"Vermoedelijke versterking in Bataafs kerngebied.",watTeZien:"Locatie onbekend.",verwachteVondsten:"Gemengd Romeins-Bataafse voorwerpen, paardentuig.",betekenis:"Zou Romeinse aanwezigheid in Bataafs gebied tonen.",bronnen:[]},Mannaricium:{naam:"Mannaricium",latinNaam:"Mannaricium",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Vermoedelijke locatie van het Romeinse castellum Mannaricium bij Maurik aan de Rijn. De naam komt voor op de Peutingerkaart. Het fort zou de rivierroute hebben bewaakt tussen Levefanum (Wijk bij Duurstede) en forten stroomopwaarts. De moderne plaats Maurik zou afgeleid kunnen zijn van Mannaricium. Bij bouwwerkzaamheden zijn Romeinse vondsten gedaan die op een fort wijzen. De exacte contouren zijn niet bekend.",watWasHier:"Vermoedelijk castellum aan de Rijn. Vermeld op Peutingerkaart.",watTeZien:"Geen zichtbare resten. Gebied bebouwd.",verwachteVondsten:"Militaria, aardewerk, munten bij bouwwerkzaamheden.",betekenis:"Mogelijke herkomst plaatsnaam Maurik.",bronnen:[]},Oostvoorne:{naam:"Castellum Oostvoorne",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeins kustfort bij de monding van de Waal en Maas, nu verdwenen in zee door kustafslag. Het fort bewaakte de zeeroute en beschermde tegen piraterij. De kust lag in de Romeinse tijd kilometers verder westwaarts. Door zeespiegelstijging en erosie is het fort in de golven verdwenen. Na stormen spoelen soms vondsten aan op de stranden van Voorne-Putten: munten, aardewerk, metalen voorwerpen. De Brittenburg bij Katwijk was een soortgelijk lot beschoren.",watWasHier:"Kustfort bij riviermonding. Bewaking zeeroute.",watTeZien:"Fort verdwenen in zee. Soms strandvondsten na stormen.",verwachteVondsten:"Na stormen: munten, aardewerk, metalen op strand.",betekenis:"Toont voormalige kustlijn en Romeinse kustverdediging.",bronnen:[]},"Castellum Randwijk":{naam:"Castellum Randwijk",type:"castellum",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke locatie van een Romeins castellum bij Randwijk aan de Rijn in de Betuwe. Het bestaan en de exacte locatie zijn onzeker. De rivier heeft veel oude resten weggespoeld. Randwijk ligt tussen bekende fortlocaties wat een fort hier logisch zou maken. In de uiterwaarden zijn bij erosie Romeinse vondsten gedaan. Het dynamische rivierlandschap maakt onderzoek lastig maar kan ook vondsten blootleggen na hoog water.",watWasHier:"Mogelijk castellum. Bestaan en locatie onzeker.",watTeZien:"Geen zichtbare resten. Uiterwaarden.",verwachteVondsten:"Mogelijk vondsten na erosie of hoog water.",betekenis:"Zou gat in fortenketen opvullen indien bevestigd.",bronnen:[]},"Versterking Scheveningseweg":{naam:"Minifort Scheveningseweg",type:"minifort",periode:"2e eeuw n.Chr.",beschrijving:"Vermoede locatie van een klein Romeins kustfort bij de Scheveningseweg in Den Haag, vergelijkbaar met het nabije Minifort Ockenburg. Dit type miniforten bewaakte de kust tegen piraten en Germaanse raids over zee. Ruimte voor 20-30 soldaten. De exacte locatie is niet vastgesteld maar vondsten in de omgeving suggereren Romeinse militaire aanwezigheid. Het zou aantonen dat de gehele Noordzeekust werd bewaakt, niet alleen de riviermonding.",watWasHier:"Vermoedelijk klein kustfort zoals Ockenburg. 20-30 soldaten.",watTeZien:"Locatie niet vastgesteld.",verwachteVondsten:"Militaria, aardewerk 2e eeuw indien locatie gevonden.",betekenis:"Zou Romeinse kustverdediging Den Haag bevestigen.",bronnen:[]},"Tongeren - Sacramentstraat":{naam:"Atuatuca Tungrorum",latinNaam:"Atuatuca Tungrorum / Municipium Tungrorum",type:"legerkamp",periode:"ca. 10 v.Chr. - 400 n.Chr.",beschrijving:"Oudste stad van Belgi, gesticht ca. 10 v.Chr. Hoofdstad van de Civitas Tungrorum - met 150 hectare de grootste civitas van Noordwest-Europa! Strategisch gelegen op de weg Boulogne-Bavay-Keulen. Onder keizer Trajanus (2e eeuw) ommuurd met meer dan 4,5 km muren en tot 3 grachten - waarvan nog 1,5 km staat! Een 1e-eeuwse buste van Julius Caesar is een topstuk. Het Gallo-Romeins Museum (Europees Museum van het Jaar 2011) toont een schat aan vondsten: beelden, steles, sieraden, architectuurelementen. Ook de Romeinse muren, het tempelcomplex, het aquaduct van Beukenberg en tumuli zijn te bezoeken.",watWasHier:"Civitas-hoofdstad Tungri (150 ha). 4,5 km stadsmuur. Politiek en religieus centrum.",watTeZien:"Gallo-Romeins Museum. Romeinse muren (1,5 km). Tempelcomplex. Aquaduct Beukenberg. Tumuli.",verwachteVondsten:"Stadsaardewerk, bouwmateriaal, munten, inscripties, religieuze objecten.",betekenis:"Oudste stad van Belgi. Grootste civitas van Noordwest-Europa.",bronnen:["https://www.galloromeinsmuseum.be","https://www.canonvanvlaanderen.be/en/events/tongeren-a-roman-town/"]},"Valkenburg-Marktveld, mini-castellum":{naam:"Marktveld Valkenburg",type:"minifort",periode:"1e - 2e eeuw n.Chr.",beschrijving:"Klein Romeins castellum met wachttoren bij het Marktveld in Valkenburg (Zuid-Holland), nabij het grotere Praetorium Agrippinae. Dit type miniforten vulde de ruimtes tussen de grote castella op. Wachttoren voor signalering en kleine bezetting voor patrouilles. De combinatie van toren en klein fort was effectief voor grensbewaking. Bij opgravingen zijn de contouren vastgesteld. Vondsten in Archeologisch Steunpunt Valkenburg.",watWasHier:"Klein fort met wachttoren. Aanvulling op Praetorium Agrippinae.",watTeZien:"Archeologisch Steunpunt Valkenburg.",verwachteVondsten:"Militaria, aardewerk, kleine persoonlijke voorwerpen.",betekenis:"Toont gelaagdheid Romeinse grensverdediging.",bronnen:[]},"Wachttoren a":{naam:"Wachttoren Utrecht-West",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Een van meerdere Romeinse wachttorens in de omgeving van Utrecht, onderdeel van het signaleringssysteem langs de Limes. De torens stonden om de 1-2 kilometer met zicht op elkaar. Bij nadering van vijanden werden vuur- of rooksignalen gegeven. Binnen minuten kon de hele grens gewaarschuwd zijn. Kleine houten constructie op aarden verhoging met bezetting van 4-8 soldaten. Vondsten zijn schaars door de kleine schaal.",watWasHier:"Houten signaleertoren. 4-8 soldaten.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Kleine hoeveelheden aardewerk en militaria.",betekenis:"Onderdeel vroegwaarschuwingssysteem.",bronnen:[]},"Wachttoren b":{naam:"Wachttoren Utrecht-Oost",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren ten oosten van Utrecht, onderdeel van de keten signaleertorens langs de Rijn. Elke toren had zichtlijn naar de volgende. Dit systeem maakte snelle communicatie mogelijk in een tijd zonder telegraaf of telefoon. De soldaten woonden in of bij de toren en hielden permanent wacht. Bij gevaar werden brandende fakkels of rookpotten gebruikt. De locatie is archeologisch vastgesteld maar niet zichtbaar.",watWasHier:"Signaleertoren in torenketen. Permanente wacht.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, militaria, persoonlijke bezittingen.",betekenis:"Onderdeel communicatienetwerk Limes.",bronnen:[]},"Wachttoren c":{naam:"Wachttoren Hoge Woerd",type:"wachttoren",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse wachttoren nabij Castellum Op de Hoge Woerd, onderdeel van het signaleringssysteem. Torens bij forten dienden als vooruitgeschoven posten en waarschuwingsplaatsen. De combinatie van fort met omringende torens was de standaard Romeinse grensverdediging. Het Archeologisch Park Hoge Woerd geeft een goed beeld van hoe dit systeem functioneerde. De toren zelf is niet gereconstrueerd maar de context is te begrijpen.",watWasHier:"Signaleertoren bij castellum. Vooruitgeschoven post.",watTeZien:"Archeologisch Park Hoge Woerd toont context.",verwachteVondsten:"Aardewerk, militaria.",betekenis:"Toont samenhang fort en torens.",bronnen:[]},"Zwammerdam-Rijksstraatweg":{naam:"Zwammerdam-Rijksstraatweg",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Mogelijke militaire nederzetting aan de Rijksstraatweg in Zwammerdam, naast het bekende Nigrum Pullum fort. Mogelijk een vicus (burgerdorp) of aparte militaire faciliteit. Bij Zwammerdam werden de beroemde Romeinse schepen gevonden. De hele zone langs de Oude Rijn was dicht bezet met militaire en civiele structuren. Vondsten wijzen op intensieve Romeinse activiteit: aardewerk, munten, militaria en door de natte veenbodem ook organisch materiaal.",watWasHier:"Mogelijk vicus of militaire faciliteit nabij Nigrum Pullum.",watTeZien:"Geen zichtbare resten.",verwachteVondsten:"Aardewerk, munten, militaria, organisch materiaal.",betekenis:"Toont dichtheid Romeinse bewoning langs Oude Rijn.",bronnen:[]},"Kastell Aachen":{naam:"Aquae Granni",latinNaam:"Aquae Granni",type:"versterking",periode:"1e - 4e eeuw n.Chr.",beschrijving:'Romeinse kuuroord bij de hete bronnen (tot 75C!) gewijd aan Apollo en de Keltische geneesheer Grannos - "aan de wateren van Grannos". In de 1e eeuw uitgebouwd tot kurort voor de legioenen van Neder-Germani. Onder keizer Trajanus bouwden legioenen uit Xanten een aquaduct en thermen onder de huidige Dom. De Mnsterthermen hadden de indeling van een valetudinarium (Romeins hospitaal). Karel de Grote bouwde hier zijn Pfalz (793-813) en maakte Aken tot keizerlijke residentie - bewust als "vernieuwer van het Romeinse Rijk". De Dom (UNESCO 1978, eerste in Duitsland!) staat op Romeinse fundamenten. Karel stierf hier in 814.',watWasHier:"Kurort voor legioenen. Thermen. Later keizerlijke Pfalz van Karel de Grote.",watTeZien:"Dom (UNESCO). Centre Charlemagne. Thermen onder de stad.",verwachteVondsten:"Badhuisresten, inscripties, munten, Romeins en Karolingisch bouwmateriaal.",betekenis:"Ononderbroken bewoning van Romeinse tijd tot Karel de Grote. Eerste UNESCO-site Duitsland.",bronnen:["https://centre-charlemagne.eu/zeitreise/?lang=en","http://www.aquaegranni.de/","https://de.wikipedia.org/wiki/Aquae_Granni"]},Hazerswoude:{naam:"Hazerswoude-Rijndijk",type:"wachttoren",periode:"2e - 3e eeuw n.Chr.",beschrijving:"Bevestigde Romeinse wachtpost langs de Limesweg bij Hazerswoude-Rijndijk. Bij opgravingen in 2021-2023 door Vestigia BV en het Rijksmuseum van Oudheden zijn spectaculaire vondsten gedaan: resten van de houten Limesweg (eiken palen uit 124-125 n.Chr.), een Romeinse dam, en aanwijzingen voor een kleine wachtpost. Bijzondere vondsten: de eerste Romeinse mijlpaal in Nederland (2023), een muntschat met 22 zilveren munten (na 166 n.Chr.), aardewerk, mantelspelden, leren schoenzolen en ca. 40.000-50.000 objecten. De locatie ligt precies tussen Albaniana (Alphen) en Matilo (Leiden).",watWasHier:"Wachtpost langs de Limesweg. Houten wegdek uit 124-125 n.Chr.",watTeZien:"Opgravingen afgerond. Vondsten naar Rijksmuseum van Oudheden.",verwachteVondsten:"Militaria, munten, aardewerk. Gebied grotendeels onderzocht.",betekenis:"Eerste Romeinse mijlpaal in Nederland. Bevestigt trac Limesweg.",bronnen:["https://www.rmo.nl/onderzoek/opgravingsprojecten/hazerswoude/","https://www.vestigia.nl/opgraving-hazerswoude-in-samenwerking-met-het-rijksmuseum-van-oudheden-en-de-gemeente-alphen-aan-den-rijn/","https://romeinsalphen.nl/themas/romeinse-weg-hazerswoude-rijndijk"]},Albaniana:{naam:"Albaniana",latinNaam:"Albaniana",type:"castellum",periode:"41 - 275 n.Chr.",beschrijving:"Groot Romeins castellum bij Alphen aan den Rijn, een van de belangrijkste forten aan de Nederlandse Limes. Het fort werd gesticht in 41-42 n.Chr., kort na de dood van keizer Caligula. De locatie is nauwkeurig bekend: bij het Rijnplein en Theater Castellum aan de Castellumstraat. Het fort (80x120m) was beschermd door een omgrachte aarden wal. Bij opgravingen tussen 1950 en 2002 zijn uitgebreide resten gevonden. Door de natte bodem zijn veel houten structuren bewaard gebleven. Een bronzen maquette van het castellum staat op het Rijnplein.",watWasHier:"Castellum met vicus. Locatie bekend: Rijnplein/Castellumstraat.",watTeZien:"Bronzen maquette Rijnplein. Theater Castellum op fortlocatie. Archeon.",verwachteVondsten:"Munten, militaria, aardewerk, dakpannen, fibulae. Veel bij bouwwerkzaamheden.",betekenis:"Een van de hoofdforten aan de Limes. UNESCO Werelderfgoed.",bronnen:["https://www.hierisalphen.nl/home/ontdekken/romeinse-limes","https://www.romeinen.nl/weten/nederland-in-de-romeinse-tijd/zuid-holland/alphen-aan-den-rijn","https://archeologiehuiszuidholland.nl/zien-en-doen/het-archeologiehuis/fort-aan-de-rijn"]}},wEt={naam:"Romeins fort",type:"versterking",periode:"1e - 3e eeuw n.Chr.",beschrijving:"Romeinse militaire versterking langs de Limes, de noordgrens van het Romeinse Rijk. Forten lagen om de 10-15 km langs de Rijn. Garnizoen van hulptroepen (auxilia) die de grens bewaakten tegen Germaanse invallen. Standaard rechthoekige plattegrond met houten of stenen muur, gracht, poorten en binnengebouwen (barakken, commandopost, graanopslagplaats, werkplaatsen). Buiten de muren vaak een vicus (burgerdorp) met handelaren en soldatenfamilies. Vondsten: munten, fibulae (mantelspelden), aardewerk, wapens, gereedschap. Onderdeel van UNESCO Werelderfgoed sinds 2021."},bEt={castellum:"Castellum (legerplaats)",wachttoren:"Wachttoren (signaalpost)",vlootbasis:"Vlootbasis (haven)",legerkamp:"Legerkamp (castra)",minifort:"Minifort (wachtpost)",versterking:"Versterking",villa:"Villa (militair gebruikt)"};ir.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");function _oe(t){if(!t)return t;const e={Mo:"ma",Tu:"di",We:"wo",Th:"do",Fr:"vr",Sa:"za",Su:"zo",Mon:"ma",Tue:"di",Wed:"wo",Thu:"do",Fri:"vr",Sat:"za",Sun:"zo",PH:"feestdagen",SH:"schoolvakantie"};let n=t;return Object.entries(e).forEach(([r,i])=>{n=n.replace(new RegExp(`\\b${r}\\b`,"gi"),i)}),n=n.replace(/\boff\b/gi,"gesloten").replace(/\bclosed\b/gi,"gesloten").replace(/\bopen\b/gi,"open"),n}async function EEt(t){try{const e=Zn(t),n=ir("EPSG:4326","EPSG:28992",e);if(n[0]<7e3||n[0]>3e5||n[1]<289e3||n[1]>629e3)return null;const r=1,s=`https://service.pdok.nl/rws/ahn/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=dtm_05m&QUERY_LAYERS=dtm_05m&INFO_FORMAT=application/json&CRS=EPSG:28992&BBOX=${`${n[0]-r},${n[1]-r},${n[0]+r},${n[1]+r}`}&WIDTH=1&HEIGHT=1&I=0&J=0`,a=await(await fetch(s)).json();if(a.features&&a.features.length>0){const l=a.features[0].properties,c=l?.value_list??l?.GRAY_INDEX??l?.value??l?.gray_index;if(c!=null){const u=typeof c=="number"?c:parseFloat(c);if(!isNaN(u))return u}}}catch(e){console.warn("AHN height query failed:",e)}return null}const SEt={ABG:"Alphen-Chaam",ACM:"Alkmaar",ALF:"Alfen",ALK:"Alkemade",AML:"Ameland",AMR:"Amerongen",AMS:"Amsterdam",ANL:"Anloo",APD:"Apeldoorn",ARN:"Arnhem",ASN:"Assen",AVW:"Avenhorn",BDA:"Breda",BLK:"Blokker",BRN:"Barneveld",DEL:"Delft",DHG:"Den Haag",DRD:"Dordrecht",EHV:"Eindhoven",EMN:"Emmen",EPE:"Epe",GNP:"Gennep",GRN:"Groningen",GRV:"Grave",GTB:"Giethoorn",HDK:"Harderwijk",HLM:"Haarlem",HLN:"Heiloo",HRL:"Harlingen",HTN:"Houten",LDN:"Leiden",LWR:"Leeuwarden",MST:"Maastricht",NKK:"Nijkerk",NMG:"Nijmegen",OTM:"Ootmarsum",RTD:"Rotterdam",SND:"Sneek",TBG:"Tilburg",UTR:"Utrecht",VLO:"Venlo",WGN:"Wageningen",ZWL:"Zwolle",ZTP:"Zutphen",444:"Houten",811:"Gouda",310:"Utrecht",344:"Amsterdam",363:"Rotterdam",518:"Den Haag",758:"Eindhoven",772:"Tilburg",855:"Breda",85:"Arnhem",268:"Nijmegen",14:"Groningen",80:"Leeuwarden",995:"Maastricht",106:"Enschede",153:"Zwolle",34:"Almere"},TEt={1:"Zeer lage trefkans op archeologische resten",2:"Lage trefkans op archeologische resten",3:"Middelhoge trefkans op archeologische resten",4:"Hoge trefkans op archeologische resten",5:"Lage trefkans (water)",6:"Middelhoge trefkans (water)",7:"Hoge trefkans (water)",8:"Water",9:"Niet gekarteerd"};function xoe(t,e){const n=[],r=t.toLowerCase(),i=(e||"").toLowerCase();return r.includes("kalkhoudend")||i.endsWith("a")?n.push("Kalkhoudend = goede metaalconservering"):(r.includes("kalkarm")||r.includes("kalkloos"))&&n.push("Kalkarm = meer corrosie op metalen"),r.includes("poldervaag")?n.push("Poldervaaggrond = jonge rivierklei, ingepolderd gebied"):r.includes("enkeerdgrond")||r.includes("enk")?n.push("Enkeerdgrond = oude akkers met plaggenbemesting - archeologisch interessant!"):r.includes("podzol")?n.push("Podzolgrond = uitgeloogde zandgrond, vaak zuur"):(r.includes("veengrond")||r.includes("veen"))&&n.push("Veengrond = zuur, slechte metaalconservering (tenzij waterverzadigd)"),r.includes("zware klei")?n.push("Zware klei = moeilijk graven, goede conservering"):r.includes("lichte klei")||r.includes("zavel")?n.push("Zavel/lichte klei = redelijk te graven"):r.includes("zand")&&!r.includes("zavel")&&n.push("Zandgrond = makkelijk graven"),r.includes("rivierklei")||i.startsWith("r")?n.push("Rivierafzetting"):(r.includes("zeeklei")||i.startsWith("m"))&&n.push("Zeekleiafzetting"),n}function kEt(){const t=es(Mt=>Mt.map),e=xd(Mt=>Mt.removeVondst),n=xd(Mt=>Mt.updateVondst),r=xd(Mt=>Mt.vondsten),{layers:i,addPoint:s,addLayer:o}=Po(),[a,l]=X.useState([]),[c,u]=X.useState(0),[h,f]=X.useState(!1),[g,v]=X.useState(null),[x,b]=X.useState(!1),[T,A]=X.useState(!1),[I,R]=X.useState(null),[C,V]=X.useState(null),[M,N]=X.useState(null),[O,F]=X.useState(null),[L,B]=X.useState(!1),[U,de]=X.useState(null),[me,ze]=X.useState(null),[Le,fe]=X.useState(null),[$e,Ce]=X.useState(!1),[le,W]=X.useState(""),[ne,se]=X.useState([]),ae=ne[c]||null,[_e,Ke]=X.useState(()=>{const Mt=localStorage.getItem("popupTextScale");return Mt?parseInt(Mt):100}),[Ye,ke]=X.useState("half"),Te=Mt=>{Ke(Mt),localStorage.setItem("popupTextScale",Mt.toString())},Dt=a[c]||"",qe=a.length>1,sn=Mt=>{const Yn=Mt.match(/<strong[^>]*>(.*?)<\/strong>/);if(Yn){const cr=Yn[1].replace(/<[^>]+>/g,""),Ft=Mt.replace(Yn[0],"").replace(/^(<br\s*\/?>)+/,"");return{title:cr,contentWithoutTitle:Ft}}return{title:"",contentWithoutTitle:Mt}},$t=Mt=>Mt.replace(/class="([^"]*)"/g,(cr,Ft)=>{if(Ft.includes("text-xs")){const On=Ft.replace(/\btext-xs\b/g,"").trim();return On?`style="font-size:0.857em" class="${On}"`:'style="font-size:0.857em"'}if(Ft.includes("text-sm")){const On=Ft.replace(/\btext-sm\b/g,"").trim();return On?`class="${On}"`:""}return cr}).replace(/class=""/g,""),{title:fn,contentWithoutTitle:yn}=sn(Dt),dt=$t(yn),lr=Dt.includes("Landbouwperceel"),$n=Dt.includes("data-vondst-id="),Un=()=>{u(Mt=>(Mt-1+a.length)%a.length)},Xr=()=>{u(Mt=>(Mt+1)%a.length)},fo=async()=>{if(console.log(" HOOGTEKAART KNOP GEKLIKT"),console.log(" parcelCoordinate uit state:",g),!t||!g||T){console.log(" STOP - map:",!!t,"coord:",g,"loading:",T);return}console.log(` DOORGEVEN AAN showParcelHeightMap: [${g[0]}, ${g[1]}]`),A(!0);try{await Pyt(t,g)&&b(!0)}catch(Mt){console.error("Failed to load height map:",Mt)}finally{A(!1)}},kr=()=>{t&&(XV(t),b(!1))};X.useEffect(()=>{if(!t)return;const Mt=Ft=>{let On='<strong class="text-purple-800">AMK Monument</strong>';if(Ft.toponiem&&(On+=`<br/><span class="text-sm font-semibold">${Ft.toponiem}</span>`),Ft.kwaliteitswaarde&&(On+=`<br/><span class="text-sm text-purple-700">${Ft.kwaliteitswaarde}</span>`),Ft.omschrijving&&(On+=`<br/><span class="text-xs text-gray-600 mt-1 block">${Ft.omschrijving}</span>`),Ft.txt_label){const Qt=Ft.txt_label.split(", ").slice(0,3).join(", ");On+=`<br/><span class="text-xs text-gray-500 italic">${Qt}${Ft.txt_label.split(", ").length>3?"...":""}</span>`}return On},Yn=async(Ft,On)=>{const Qt=[],Oo=t.getLayers().getArray().filter(ji=>ji instanceof Am&&ji.getVisible()?ji.getSource()instanceof DRe:!1);for(const ji of Oo){const Ps=ji.getSource();if(!Ps)continue;const Pn=ji.get("title")||"";if(Pn.startsWith("Paleokaart"))continue;if(Pn==="Archeo Landschappen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://services.rce.geovoorziening.nl/landschappenkaart/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=landschappenkaart_nl&QUERY_LAYERS=landschappenkaart_nl&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Ve=oe.landschapsnaam||oe.naam||"Archeologisch Landschap",Q=oe.omschrijving||"";let ye=`<strong class="text-green-800">${Ve}</strong>`;Q&&(ye+=`<br/><span class="text-sm text-gray-600">${Q}</span>`),ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ye+='<div class="text-sm text-gray-700 mt-1">Een archeologisch landschap is een gebied waar het landschap nog sporen draagt van menselijke activiteit uit het verleden. Denk aan oude akkers, nederzettingen of verdedigingswerken.</div>',ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ye+='<div class="text-sm text-gray-700 mt-1">Aardewerk, munten, gereedschap en andere voorwerpen van vroegere bewoners. De kans op vondsten hangt af van het type landschap.</div>',ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',ye+='<div class="text-sm text-gray-700 mt-1"><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/landschappenkaart" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Landschappenkaart</a></div>',ye+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Landschapstypen_van_Nederland" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Landschapstypen</a></div>',Qt.push(ye)}}catch(He){console.warn("Archeo Landschappen WMS query failed:",He)}continue}if(Pn==="Essen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://services.rce.geovoorziening.nl/landschapsatlas/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=essen&QUERY_LAYERS=essen&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Ve='<strong class="text-amber-800">Es (historisch akkercomplex)</strong>';(oe.naam||oe.Naam||oe.NAME)&&(Ve+=`<br/><span class="text-sm font-semibold text-amber-700">${oe.naam||oe.Naam||oe.NAME}</span>`),(oe.type||oe.Type||oe.TYPE)&&(Ve+=`<br/><span class="text-xs text-gray-600">${oe.type||oe.Type||oe.TYPE}</span>`),(oe.omschrijving||oe.Omschrijving)&&(Ve+=`<br/><span class="text-xs text-gray-500">${oe.omschrijving||oe.Omschrijving}</span>`),Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is een es?</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1">Een es is een oud akkercomplex op hogere zandgronden. Eeuwenlang werden hier gewassen verbouwd. De bodem werd bemest met plaggen en mest, waardoor de grond donker en vruchtbaar werd.</div>',Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1">Munten, gespen, knopen, aardewerk en soms bijzondere voorwerpen die door bemesting op het land terechtkwamen. Essen behoren tot de beste vindplaatsen voor metaaldetectie.</div>',Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Conservering</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1 italic">De zure zandgrond tast metaal aan. IJzer en koper zijn vaak slecht bewaard. Zilver en brons houden zich beter.</div>',Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Ve+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Es_(geografie)" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Es (geografie)</a></div>',Qt.push(Ve)}}catch(He){console.warn("Essen WMS query failed:",He)}continue}if(Pn==="FAMKE Steentijd"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/2/query?geometry=${Ae[0]},${Ae[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,z=await(await fetch(Ie)).json();if(z.features&&z.features.length>0){const bt=z.features[0].attributes;let Y='<strong class="text-amber-800">FAMKE Steentijd-Bronstijd</strong>';Y+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const oe=bt.BESCHR||"";oe&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',Y+=`<div class="text-sm text-amber-700 mt-1 font-medium">${oe}</div>`);const Ve=bt.BESCHRTOELICHTING||"";Ve&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`);const Q=bt.BESCHRLINK||"";Q&&(Y+=`<div class="mt-3"><a href="${Q}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de steentijd en bronstijd te verwachten zijn.</div>',Qt.push(Y)}}catch(He){console.warn("FAMKE Steentijd query failed:",He)}continue}if(Pn==="FAMKE IJzertijd"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=`https://geoportaal.fryslan.nl/arcgis/rest/services/Themas/cultuurhistorie/MapServer/1/query?geometry=${Ae[0]},${Ae[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=BESCHR,BESCHRTOELICHTING,BESCHRLINK&returnGeometry=false&f=json`,z=await(await fetch(Ie)).json();if(z.features&&z.features.length>0){const bt=z.features[0].attributes;let Y='<strong class="text-orange-800">FAMKE IJzertijd-Middeleeuwen</strong>';Y+='<br/><span class="text-sm text-gray-500">Friese verwachtingskaart</span>';const oe=bt.BESCHR||"";oe&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Advies</span></div>',Y+=`<div class="text-sm text-orange-700 mt-1 font-medium">${oe}</div>`);const Ve=bt.BESCHRTOELICHTING||"";Ve&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Toelichting</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${Ve}</div>`);const Q=bt.BESCHRLINK||"";Q&&(Y+=`<div class="mt-3"><a href="${Q}" target="_blank" rel="noopener noreferrer" class="text-sm text-blue-600 hover:underline">Meer informatie</a></div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is FAMKE?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">FAMKE is de Friese Archeologische Monumentenkaart Extra. Deze kaart toont waar in Friesland vondsten uit de ijzertijd tot en met de middeleeuwen te verwachten zijn.</div>',Qt.push(Y)}}catch(He){console.warn("FAMKE IJzertijd query failed:",He)}continue}if(Pn==="Archeo Onderzoeken"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&QUERY_LAYERS=archeologische_onderzoeksmeldingen_openbaar_rd&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}&FEATURE_COUNT=20`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0)for(const oe of Y.features){const Ve=oe.properties,Q=Ve.type_onderzoek||"",ye=Ve.projectnaam||Ve.project_naam||Ve.naam||"",De=ye&&ye!=="-"&&ye.trim()!==""&&!/^\d+$/.test(ye.trim())?ye:"",Je=Ve.gemeente||"",Ue=Ve.uitvoerder||"",nt=Ve.onderzoeksmeldingnummer||"",et=Ve.adres||Ve.straat||"";let Pt="Archeologisch Onderzoek";De?Pt=De:Je&&et?Pt=`${Je} - ${et}`:Je&&(Pt=`Onderzoek ${Je}`);let zt=`<strong class="text-blue-800">${Pt}</strong>`;if(Q&&(zt+=`<br/><span class="text-sm font-semibold text-blue-700">${Q}</span>`),Je&&!Pt.includes(Je)&&(zt+=`<br/><span class="text-sm text-gray-700">${Je}</span>`),et&&!Pt.includes(et)&&(zt+=`<br/><span class="text-sm text-gray-600">${et}</span>`),nt&&(zt+=`<br/><span class="text-xs text-gray-500 font-mono">OM: ${nt}</span>`),Ue&&(zt+=`<br/><span class="text-sm text-gray-700">Uitvoerder: ${Ue}</span>`),Ve.startdatum||Ve.einddatum){const te=[Ve.startdatum,Ve.einddatum].filter(Boolean).join(" - ");zt+=`<br/><span class="text-xs text-gray-600">Periode: ${te}</span>`}const gn=[];Ve.periode_paleolithicum&&gn.push("Paleolithicum"),Ve.periode_mesolithicum&&gn.push("Mesolithicum"),Ve.periode_neolithicum&&gn.push("Neolithicum"),Ve.periode_bronstijd&&gn.push("Bronstijd"),Ve.periode_ijzertijd&&gn.push("IJzertijd"),Ve.periode_romeins&&gn.push("Romeins"),Ve.periode_middeleeuwen&&gn.push("Middeleeuwen"),Ve.periode_nieuwe_tijd&&gn.push("Nieuwe tijd"),gn.length>0&&(zt+=`<br/><span class="text-sm text-purple-700">Datering: ${gn.join(", ")}</span>`),zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',Q.toLowerCase().includes("opgraving")?zt+='<div class="text-sm text-gray-700 mt-1">Hier is een archeologische opgraving gedaan. Professionele archeologen hebben vondsten en sporen gedocumenteerd en geborgen.</div>':Q.toLowerCase().includes("bureauonderzoek")?zt+='<div class="text-sm text-gray-700 mt-1">Een bureauonderzoek naar de archeologische verwachting op basis van historische bronnen en kaarten.</div>':Q.toLowerCase().includes("booronderzoek")?zt+='<div class="text-sm text-gray-700 mt-1">Met boringen is onderzocht wat er in de grond zit. Vaak de eerste stap om te bepalen of er verder onderzoek nodig is.</div>':Q.toLowerCase().includes("proefsleuven")?zt+='<div class="text-sm text-gray-700 mt-1">Proefsleuven zijn gegraven om te kijken of er archeologische sporen in de grond zitten.</div>':Q.toLowerCase().includes("begeleiding")?zt+='<div class="text-sm text-gray-700 mt-1">Archeologische begeleiding bij graafwerk. Een archeoloog was aanwezig om te controleren of er vondsten naar boven kwamen.</div>':Q.toLowerCase().includes("inventariserend")||Q.toLowerCase().includes("karterend")?zt+='<div class="text-sm text-gray-700 mt-1">Verkennend onderzoek om te bepalen of er archeologische resten in de grond kunnen zitten.</div>':zt+='<div class="text-sm text-gray-700 mt-1">Op deze locatie is archeologisch onderzoek uitgevoerd. De resultaten zijn opgeslagen in het landelijke archief.</div>',zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Interessant voor detectie?</span></div>',zt+='<div class="text-sm text-gray-700 mt-1 italic">Onderzoekslocaties kunnen interessant zijn: archeologen vinden vaak niet alles. Maar check altijd eerst of je daar mag zoeken.</div>',zt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Rapport opzoeken</span></div>';let q="";if(De?q=De:Ue&&Je?q=`${Ue} ${Je}`:Je&&(q=Je),q){const te=q.length>35?q.substring(0,35)+"...":q;zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archaeology.datastations.nl/dataverse/root?q=${encodeURIComponent(q)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek "${te}" in DANS</a></div>`,zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://scholar.google.nl/scholar?q=${encodeURIComponent(q+" archeologisch rapport")}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek in Google Scholar</a></div>`}nt&&(zt+=`<div class="text-sm text-gray-700 mt-1"><a href="https://archis.cultureelerfgoed.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Zoek OM ${nt} in ARCHIS</a> <span class="text-xs text-gray-400">(account nodig)</span></div>`),Qt.push(zt)}}catch(He){console.warn("Archeo Onderzoeken WMS query failed:",He)}continue}if(Pn==="IKAW"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=500,z=`https://services.rce.geovoorziening.nl/ikaw/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&QUERY_LAYERS=IKAW3Indicatievekaartarcheologischewaarden2008&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Ve=Math.round(oe.PALETTE_INDEX||oe.palette_index||0),Q=TEt[Ve]||`Trefkans onbekend (${Ve})`;let ye='<strong class="text-orange-800">IKAW Verwachtingskaart</strong>';ye+='<br/><span class="text-sm text-gray-500">Kaart met kansen op archeologische vondsten</span>',ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat betekent dit?</span></div>',ye+=`<div class="text-sm text-orange-700 mt-1">${Q}</div>`;const Je={1:{tekst:"De kans op archeologische vondsten is hier zeer klein. De grond is waarschijnlijk verstoord of te jong.",vondsten:"Niet veel te verwachten, maar verrassingen zijn altijd mogelijk.",kleur:"text-gray-600"},2:{tekst:"De kans op vondsten is laag, maar niet uitgesloten. Soms worden hier toch interessante objecten gevonden.",vondsten:"Af en toe losse vondsten uit verschillende periodes.",kleur:"text-yellow-600"},3:{tekst:"Dit is een interessant gebied met een redelijke kans op vondsten. Hier woonden of werkten mensen in het verleden.",vondsten:"Aardewerk, munten, metalen voorwerpen uit verschillende tijdperken.",kleur:"text-amber-600"},4:{tekst:"Dit is een zeer kansrijk gebied! Hier zijn waarschijnlijk resten van oude bewoning of activiteit. Let op: bij graafwerk kan een vergunning nodig zijn.",vondsten:"Grote kans op interessante vondsten: aardewerk, munten, sieraden, gereedschap.",kleur:"text-orange-600"},5:{tekst:"Dit is een waterbodem. Vondsten zijn hier moeilijker te bereiken maar kunnen goed bewaard zijn gebleven.",vondsten:"Scheepswrakken, verloren lading, gedumpte voorwerpen.",kleur:"text-blue-600"},6:{tekst:"Waterbodem met archeologische potentie. Hier kunnen interessante vondsten liggen die door het water goed bewaard zijn.",vondsten:"Scheepsresten, ankers, aardewerk, metalen voorwerpen.",kleur:"text-blue-600"},7:{tekst:"Waterbodem met hoge archeologische waarde. Hier zijn bekende vindplaatsen of scheepswrakken.",vondsten:"Belangrijke maritieme vondsten, beschermd gebied.",kleur:"text-blue-700"}}[Ve];Je&&(ye+=`<div class="text-sm ${Je.kleur} mt-1">${Je.tekst}</div>`,ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ye+=`<div class="text-sm text-gray-700 mt-1">${Je.vondsten}</div>`),ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de IKAW?</span></div>',ye+='<div class="text-sm text-gray-700 mt-1">De IKAW (Indicatieve Kaart Archeologische Waarden) toont de kans op archeologische vondsten in heel Nederland. De kaart is gemaakt door de Rijksdienst voor het Cultureel Erfgoed.</div>',Qt.push(ye)}}catch(He){console.warn("IKAW WMS query failed:",He)}continue}if(Pn==="Inundatiegebieden"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=inundaties&QUERY_LAYERS=inundaties&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Ve='<strong class="text-blue-800">Inundatiegebied</strong>';(oe["linie-naam"]||oe.linie_naam)&&(Ve+=`<br/><span class="text-sm font-semibold text-blue-700">${oe["linie-naam"]||oe.linie_naam}</span>`),oe.naam&&(Ve+=`<br/><span class="text-sm text-gray-700">${oe.naam}</span>`),oe.periode&&(Ve+=`<br/><span class="text-xs text-gray-500">${oe.periode}</span>`),oe.lin_period&&(Ve+=`<br/><span class="text-xs text-gray-400">${oe.lin_period}</span>`),Qt.push(Ve)}}catch(He){console.warn("Inundatiegebieden WMS query failed:",He)}continue}if(Pn==="Militaire Objecten"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=objecten&QUERY_LAYERS=objecten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Ve=oe.obj_soort||"",Q=oe.obj_naam||"",ye=oe.lin_period||"",De=oe["linie-naam"]||oe.linie_naam||"";let Je=Ve||"Militair Object",Ue="Dit is een historisch militair object uit de Nederlandse verdedigingsgeschiedenis.",nt="";const et=Ve.toLowerCase();et.includes("fort")?(Ue="Een fort is een versterkte verdedigingspost, vaak met dikke muren en geschutsopstellingen. Forten maakten deel uit van grotere verdedigingslinies.",nt="Rond forten worden soms kogels, knopen van uniformen, muntjes of andere militaire voorwerpen gevonden."):et.includes("schans")?(Ue="Een schans is een kleinere versterking, vaak gemaakt van aarde en palissaden. Schansen werden gebruikt om strategische punten te verdedigen.",nt="Bij schansen kun je musketkogels, knopen en soms munten uit de 17e-18e eeuw tegenkomen."):et.includes("batterij")||et.includes("battery")?(Ue="Een batterij is een geschutsopstelling, vaak op een strategische plek om vijanden onder vuur te nemen.",nt="Bij batterijen worden soms kanonkogels of onderdelen van geschut gevonden."):et.includes("bunker")||et.includes("kazemat")?(Ue="Een bunker of kazemat is een versterkte betonnen schuilplaats. Veel werden gebouwd rond 1940 als onderdeel van verdedigingslinies.",nt="Bij bunkers worden soms militaire voorwerpen uit WOII gevonden, zoals knopen, gespen of munitieresten."):et.includes("sluis")||et.includes("inlaatwerk")?(Ue="Militaire sluizen en inlaatwerken werden gebruikt om land onder water te zetten (inunderen). Dit was een belangrijke verdedigingstactiek.",nt="Bij historische sluizen worden soms voorwerpen gevonden van soldaten die deze bewaakten."):et.includes("toren")||et.includes("wachttoren")?(Ue="Wachttorens werden gebruikt om de omgeving in de gaten te houden en vijandelijke bewegingen te signaleren.",nt="Bij torens worden soms persoonlijke voorwerpen van soldaten gevonden."):et.includes("kazerne")&&(Ue="Een kazerne is een gebouw waar soldaten gelegerd waren. Hier woonden, aten en oefenden de troepen.",nt="Rond kazernes worden regelmatig knopen, gespen en andere persoonlijke voorwerpen gevonden.");let Pt=`<strong class="text-stone-800">${Je}</strong>`;Q&&(Pt+=`<br/><span class="text-sm font-semibold text-stone-700">${Q}</span>`),De&&(Pt+=`<br/><span class="text-sm text-blue-600">${De}</span>`),ye&&(Pt+=`<br/><span class="text-xs text-gray-500">${ye}</span>`),Pt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Pt+=`<div class="text-sm text-gray-700 mt-1">${Ue}</div>`,nt&&(Pt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Pt+=`<div class="text-sm text-gray-700 mt-1">${nt}</div>`),Pt+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Pt+='<div class="text-sm text-gray-700 mt-1">',Pt+='<a href="https://erfgoedenlocatie.nl/linies-en-stellingen" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">RCE Linies en Stellingen</a>',Pt+="</div>",Qt.push(Pt)}}catch(He){console.warn("Militaire Objecten WMS query failed:",He)}continue}if(Pn==="Verdedigingslinies"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://services.rce.geovoorziening.nl/liniesenstellingen/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=linies&QUERY_LAYERS=linies&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Ve='<strong class="text-amber-800">Verdedigingslinie</strong>';const Q={"Hollandse Waterlinie":"Verdedigingsstelsel (1815-1940) dat gebruik maakte van inundaties om Holland te beschermen. UNESCO Werelderfgoed.","Nieuwe Hollandse Waterlinie":"Uitgebreide versie (1815-1940) met forten en inundatiegebieden van Muiden tot Gorinchem.","Stelling van Amsterdam":"Ringverdediging rond Amsterdam (1880-1920) met 42 forten. UNESCO Werelderfgoed.",Grebbelinie:"Verdedigingslinie langs de Grebbe (17e-20e eeuw). Zware gevechten in mei 1940.",IJssellinie:"Koude Oorlog verdediging (1950-1968) langs de IJssel tegen Sovjet-invasie.",Atlantikwall:"Duitse kustverdediging WOII (1942-1945) van Noorwegen tot Spanje.","Peel-Raamstelling":"Verdedigingslinie in Brabant/Limburg. Gevechten mei 1940.","Maas-Waalstelling":"Linie tussen Maas en Waal, onderdeel landsverdediging.",Zuiderwaterlinie:"Waterlinie in West-Brabant en Zeeland (17e-19e eeuw).","Staats-Spaanse Linies":"Vestingwerken uit de 80-jarige oorlog (1568-1648)."},ye=oe.naam||oe.lin_naam||"";if(ye){Ve+=`<br/><span class="text-sm font-semibold text-amber-700">${ye}</span>`;const De=Object.entries(Q).find(([Je])=>ye.toLowerCase().includes(Je.toLowerCase())||Je.toLowerCase().includes(ye.toLowerCase()));De&&(Ve+=`<br/><span class="text-sm text-gray-700">${De[1]}</span>`)}oe.lin_period&&(Ve+=`<br/><span class="text-xs text-purple-600">${oe.lin_period}</span>`),oe.status&&(Ve+=`<br/><span class="text-xs text-gray-400">${oe.status}</span>`),Qt.push(Ve)}}catch(He){console.warn("Verdedigingslinies WMS query failed:",He)}continue}if(Pn==="Rijksmonumenten"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,z=`https://data.geo.cultureelerfgoed.nl/openbaar/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=rijksmonumentpunten&QUERY_LAYERS=rijksmonumentpunten&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Ve='<strong class="text-red-800">Rijksmonument</strong>';(oe.cbsNaam||oe.cbs_naam)&&(Ve+=`<br/><span class="text-sm font-semibold">${oe.cbsNaam||oe.cbs_naam}</span>`),oe.hoofdcategorie&&(Ve+=`<br/><span class="text-sm text-red-700">${oe.hoofdcategorie}</span>`),oe.subcategorie&&(Ve+=`<br/><span class="text-xs text-gray-600">${oe.subcategorie}</span>`),oe.rijksmonumentnummer&&(Ve+=`<br/><span class="text-xs text-gray-500">Nr: ${oe.rijksmonumentnummer}</span>`),(oe.bouwjaar||oe.oorspronkelijkebouwjaar)&&(Ve+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${oe.bouwjaar||oe.oorspronkelijkebouwjaar}</span>`),Ve+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',oe.rijksmonumentnummer&&(Ve+=`<div class="text-sm text-gray-700 mt-1"><a href="https://monumentenregister.cultureelerfgoed.nl/monumenten/${oe.rijksmonumentnummer}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk in Monumentenregister</a></div>`),Ve+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Rijksmonument" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia: Rijksmonument</a></div>',Qt.push(Ve)}}catch(He){console.warn("Rijksmonumenten WMS query failed:",He)}continue}if(Pn==="Werelderfgoed"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=500,z=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Ve='<strong class="text-cyan-800">UNESCO Werelderfgoed</strong>';(oe.siteName||oe.naam)&&(Ve+=`<br/><span class="text-sm font-semibold text-cyan-700">${oe.siteName||oe.naam}</span>`),oe.siteDesignation&&(Ve+=`<br/><span class="text-xs text-gray-600">${oe.siteDesignation}</span>`),Qt.push(Ve)}}catch(He){console.warn("Werelderfgoed WMS query failed:",He)}continue}if(Pn==="Terpen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=`https://geoportaal.fryslan.nl/arcgis/rest/services/ProvinciaalGeoRegister/PGR2/MapServer/66/query?geometry=${Ae[0]},${Ae[1]}&geometryType=esriGeometryPoint&spatialRel=esriSpatialRelIntersects&outFields=SOORT,SHAPE_Area&returnGeometry=false&f=json`,z=await(await fetch(Ie)).json();if(z.features&&z.features.length>0){const bt=z.features[0].attributes,Y=bt.SOORT||"Terp",oe=bt.SHAPE_Area?Math.round(bt.SHAPE_Area):null;let Ve="",Q="",ye=!1;try{const Pt=`https://service.pdok.nl/rce/ps-ch/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=PS.ProtectedSite&QUERY_LAYERS=PS.ProtectedSite&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-100},${Ae[1]-100},${Ae[0]+100},${Ae[1]+100}`}`,gn=await(await fetch(Pt)).json();if(gn.features&&gn.features.length>0){const q=gn.features[0].properties;Ve=q.siteName||q.naam||"",Q=q.inspireId||q.monumentnummer||"",ye=!0}}catch{}let De="";Ve?(De=`<strong class="text-orange-800">${Ve}</strong>`,De+=`<br/><span class="text-sm text-orange-600 font-medium">${Y}</span>`):De=`<strong class="text-orange-800">${Y}</strong>`,De+='<br/><span class="text-sm text-gray-600">Friese terp (woonheuvel)</span>';const Ue={terp:{uitleg:"Een kunstmatige woonheuvel waar mensen woonden om droge voeten te houden.",periode:"IJzertijd tot Middeleeuwen"},"afgegraven terp":{uitleg:"Deze terp is deels of geheel afgegraven voor de vruchtbare grond (terpaarde).",periode:"Oorspronkelijk IJzertijd-Middeleeuwen"},terprestant:{uitleg:"Hier lag ooit een terp, waarvan nu alleen nog resten over zijn.",periode:"IJzertijd tot Middeleeuwen"},"deels afgegraven terp":{uitleg:"Een deel van deze terp is afgegraven, een deel is nog intact.",periode:"IJzertijd tot Middeleeuwen"},"verhoogd kerkhof":{uitleg:"Een verhoogd kerkhof, vaak op een oude terplocatie gebouwd.",periode:"Middeleeuwen"},kerkterp:{uitleg:"Een terp met daarop een kerk, vaak het centrum van een terpdorp.",periode:"IJzertijd tot heden"}}[Y.toLowerCase()]||{uitleg:"Een kunstmatige woonheuvel uit de tijd dat dit gebied vaak overstroomde.",periode:"IJzertijd tot Middeleeuwen"};if(De+=`<div class="mt-2 text-sm text-gray-700">${Ue.uitleg}</div>`,De+=`<br/><span class="text-sm text-gray-600">Periode: ${Ue.periode}</span>`,oe&&oe>100){const nt=(oe/1e4).toFixed(1);De+=`<br/><span class="text-sm text-gray-500">Oppervlak: ${nt} hectare</span>`}if(ye&&(De+='<div class="mt-2 p-2 bg-orange-100 rounded text-xs text-orange-800">',De+="<strong> Rijksmonument</strong> - Deze terp is wettelijk beschermd. Detecteren is niet toegestaan zonder vergunning.",Q&&(De+=`<br/>Monumentnummer: ${Q}`),De+="</div>"),De+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',De+="<strong>Detectietip:</strong> ",Y.toLowerCase().includes("afgegraven")?De+="Afgegraven terpen zijn interessant! Bij het afgraven kwam materiaal aan de oppervlakte. Zoek op akkers rond de oude terplocatie.":De+="Terpen zijn rijk aan vondsten: aardewerk, munten, fibulae, botten, gereedschap. De grond is vaak donker en vruchtbaar door eeuwenlange bewoning.",De+="</div>",De+='<div class="mt-3 space-y-1">',De+='<a href="https://www.terpenonderzoek.nl/" target="_blank" class="block text-blue-600 hover:underline text-sm">Terpenonderzoek.nl - Wetenschappelijk onderzoek</a>',De+='<a href="https://www.friesmuseum.nl/collectie/archeologie/" target="_blank" class="block text-blue-600 hover:underline text-sm">Fries Museum - Terpvondsten</a>',De+='<a href="https://nl.wikipedia.org/wiki/Terp" target="_blank" class="block text-blue-600 hover:underline text-sm">Wikipedia - Terpen</a>',Ve){const nt=encodeURIComponent(Ve+" terp friesland");De+=`<a href="https://www.google.com/search?q=${nt}" target="_blank" class="block text-blue-600 hover:underline text-sm">Zoek meer over ${Ve}</a>`}De+="</div>",Qt.push(De)}}catch(He){console.warn("Terpen query failed:",He)}continue}if(Pn==="Religieus Erfgoed"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,z=`https://services.rce.geovoorziening.nl/landschapsatlas_view/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=religieuserfgoed&QUERY_LAYERS=religieuserfgoed&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Ve=oe.naam||oe.NAAM||oe.name||oe.NAME||"Onbekend",Q=oe.denominatie||oe.DENOMINATIE||oe.religie||"",ye=oe.type||oe.TYPE||oe.functie||"",De=oe.bouwjaar||oe.BOUWJAAR||oe.jaar||"",Je=oe.gemeente||oe.GEMEENTE||oe.plaats||"";let Ue=`<strong class="text-purple-800">${Ve}</strong>`;const nt=ye.toLowerCase();let et="Een religieus gebouw of heilige plek.",Pt="Munten van kerkgangers, knopen, gespen, religieuze voorwerpen";nt.includes("kerk")||nt.includes("church")?(et="Een kerk was het hart van de gemeenschap. Hier kwamen mensen samen voor diensten, maar ook voor belangrijke gebeurtenissen.",Pt="Munten uit de collecte, knopen, gespen, pelgrimsinsignes, loden zegels"):nt.includes("kapel")||nt.includes("chapel")?(et="Een kapel is een klein gebedshuis, vaak bij een landgoed, langs een weg, of op een bijzondere plek.",Pt="Devotionalia, munten, kruisjes, rozenkransen"):nt.includes("synagoge")?(et="Een synagoge is een Joods gebedshuis. Veel synagogen in Nederland zijn verwoest of herbestemd na de Tweede Wereldoorlog.",Pt="Munten, knopen, kleine religieuze voorwerpen"):nt.includes("klooster")||nt.includes("monastery")?(et="Een klooster was een woon- en werkplek voor monniken of nonnen. Veel kloosters hadden eigen werkplaatsen en landerijen.",Pt="Religieuze voorwerpen, zegels, gereedschap, aardewerk, middeleeuwse munten"):nt.includes("toren")||nt.includes("tower")?(et="Een kerktoren of klokkentoren. Soms is alleen de toren nog over van een verdwenen kerk.",Pt="Munten, knopen, bouwmateriaal"):(nt.includes("begraafplaats")||nt.includes("cemetery"))&&(et="Een historische begraafplaats. Detecteren op begraafplaatsen is niet toegestaan zonder toestemming.",Pt="Detecteren hier niet toegestaan"),Q&&(Ue+=`<br/><span class="text-sm text-purple-600">${Q}</span>`),ye&&(Ue+=`<br/><span class="text-sm text-gray-600">${ye}</span>`),De&&(Ue+=`<br/><span class="text-sm text-gray-500">Bouwjaar: ${De}</span>`),Je&&(Ue+=`<br/><span class="text-xs text-gray-400">${Je}</span>`),Ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Ue+=`<div class="text-sm text-gray-700 mt-1">${et}</div>`,Ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Ue+=`<div class="text-sm text-gray-700 mt-1">${Pt}</div>`,Ue+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',nt.includes("begraafplaats")?Ue+='<div class="text-sm text-red-600 mt-1">Detecteren op begraafplaatsen is niet toegestaan. Respecteer de rust van de overledenen.</div>':Ue+='<div class="text-sm text-gray-700 mt-1">Veel kerken en religieuze gebouwen zijn beschermd monument. Vraag altijd toestemming voordat je gaat detecteren op het terrein.</div>',Qt.push(Ue)}}catch(He){console.warn("Religieus Erfgoed WMS query failed:",He)}continue}if(Pn==="Gewaspercelen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,rn=`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`,z=`https://service.pdok.nl/rvo/brpgewaspercelen/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=BrpGewas&QUERY_LAYERS=BrpGewas&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${rn}`,bt=`https://service.pdok.nl/bzk/bro-bodemkaart/wms/v1_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=soilarea&QUERY_LAYERS=soilarea&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${rn}`,[Y,oe]=await Promise.all([fetch(z),fetch(bt).catch(()=>null)]),Ve=await Y.json();if(Ve.features&&Ve.features.length>0){const Q=Ve.features[0].properties;let ye='<strong class="text-green-800">Landbouwperceel</strong>';if((Q.gewas||Q.gewasnaam)&&(ye+=`<br/><span class="text-sm font-semibold text-green-700">${Q.gewas||Q.gewasnaam}</span>`),(Q.categorie||Q.category)&&(ye+=`<br/><span class="text-xs text-gray-600">${Q.categorie||Q.category}</span>`),Q.oppervlakte&&(ye+=`<br/><span class="text-xs text-gray-500">${Q.oppervlakte} ha</span>`),oe)try{const De=await oe.json();if(De.features&&De.features.length>0){const Je=De.features[0].properties,Ue=Je.first_soilname||Je.soilname||Je.bodemtype,nt=Je.first_soilcode||Je.soilcode||Je.maparea_soilcode;if(Ue){ye+=`<br/><span class="text-xs text-amber-700 font-medium">Grondsoort: ${Ue}</span>`;const et=xoe(Ue,nt);et.length>0&&(ye+=`<br/><span class="text-xs text-gray-500 italic">${et.join("  ")}</span>`)}}}catch{}Qt.push(ye)}}catch(He){console.warn("BRP Gewaspercelen WMS query failed:",He)}continue}if(Pn==="Kadastrale Grenzen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=20,z=`https://service.pdok.nl/kadaster/kadastralekaart/wms/v5_0?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=Perceel&QUERY_LAYERS=Perceel&STYLES=&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Ve=oe.kadastraleGemeenteWaarde||oe.kadastrale_gemeente_waarde||oe.kadastraleGemeente||SEt[String(oe.kadastraleGemeenteCode)]||oe.kadastraleGemeenteCode,Q=oe.sectie||oe.Sectie||"",ye=oe.perceelnummer||oe.perceelNummer||oe.Perceelnummer||"",De=oe.kadastraleGrootteWaarde||oe.kadastrale_grootte_waarde||oe.kadastraleGrootte||oe.oppervlakte,Je=oe.AKRKadastraleGemeenteCodeWaarde||oe.akrKadastraleGemeenteCodeWaarde||"",Ue=[Ve,Q,ye].filter(Boolean).join(" "),nt=Je&&Q&&ye?`${Je}-${Q}-${ye}`:"";let et='<strong class="text-indigo-800">Kadastraal Perceel</strong>';if(Ue&&(et+=`<br/><span class="text-sm text-indigo-700">${Ue}</span>`),nt&&(et+=`<br/><span class="text-sm font-bold text-gray-800 font-mono">${nt}</span>`),De){const Pt=typeof De=="number"?De:parseFloat(De);isNaN(Pt)||(et+=`<br/><span class="text-xs text-gray-600">${Pt.toLocaleString("nl-NL")} m</span>`)}et+='<br/><br/><span class="text-xs text-gray-600">Eigenaar opzoeken? Kopieer bovenstaande code, ga naar </span><a href="https://www.kadaster.nl/winkel" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">kadaster.nl/winkel</a><span class="text-xs text-gray-600"> en klik "Zoek op aanduiding"</span><span class="text-xs text-gray-400"> (betaalde dienst)</span>',Qt.push(et)}}catch(He){console.warn("Kadastrale Grenzen WMS query failed:",He)}continue}if(Pn==="Scheepswrakken"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_SCHEEPSRESTANTEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-cyan-800">${oe.naam||oe.NAAM||"Scheepswrak"}</strong>`;Q+='<br/><span class="text-sm text-gray-800">Historisch scheepswrak in Zuid-Holland</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Op deze plek ligt een oud scheepswrak. Dit is een schip dat lang geleden is gezonken. ",Q+="In de bodem kunnen nog resten van het schip en de lading liggen.",Q+="</div>",(oe.type||oe.TYPE)&&(Q+=`<br/><span class="text-sm text-cyan-700">Type: ${oe.type||oe.TYPE}</span>`),(oe.datering||oe.DATERING)&&(Q+=`<br/><span class="text-sm text-gray-600">Periode: ${oe.datering||oe.DATERING}</span>`),(oe.bron||oe.BRON)&&(Q+=`<br/><span class="text-xs text-gray-500">Bron: ${oe.bron||oe.BRON}</span>`),Q+='<div class="mt-2 p-2 bg-cyan-50 rounded text-xs text-cyan-800">',Q+="<strong>Detectietip:</strong> Bij scheepswrakken kun je bijzondere vondsten doen zoals scheepsonderdelen, munten, gereedschap en lading. Let op: vaak is een vergunning nodig.",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Qt.push(Q)}}catch(He){console.warn("Scheepswrakken WMS query failed:",He)}continue}if(Pn==="Woonheuvels ZH"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_WOONHEUVEL&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-orange-800">${oe.naam||oe.NAAM||"Woonheuvel"}</strong>`;Q+='<br/><span class="text-sm text-gray-800">Historische woonheuvel (terp)</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Een woonheuvel is een door mensen opgeworpen heuvel. Mensen woonden hierop om droge voeten te houden bij hoog water. ",Q+="Deze heuvels werden steeds hoger gemaakt. Je vindt ze vooral in laaggelegen gebieden.",Q+="</div>",(oe.type||oe.TYPE)&&(Q+=`<br/><span class="text-sm text-orange-700">Type: ${oe.type||oe.TYPE}</span>`),Q+='<div class="mt-2 p-2 bg-orange-50 rounded text-xs text-orange-800">',Q+="<strong>Detectietip:</strong> Woonheuvels zijn rijk aan vondsten! Denk aan aardewerk, munten, sieraden en huisraad uit de middeleeuwen. De grond bevat vaak veel materiaal.",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Qt.push(Q)}}catch(He){console.warn("Woonheuvels WMS query failed:",He)}continue}if(Pn==="Romeinse Forten"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_ROMEINSFORT&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-red-800">${oe.naam||oe.NAAM||"Romeins Fort"}</strong>`;Q+='<br/><span class="text-sm text-gray-800">Romeins militair fort (castellum)</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Dit was een Romeins legerfort. De Romeinen bouwden deze forten langs de Rijn, de grens van hun rijk. ",Q+="Soldaten woonden hier en bewaakten de grens. Deze forten zijn ongeveer 2000 jaar oud.",Q+="</div>",(oe.type||oe.TYPE)&&(Q+=`<br/><span class="text-sm text-red-700">Type: ${oe.type||oe.TYPE}</span>`),(oe.periode||oe.PERIODE)&&(Q+=`<br/><span class="text-sm text-gray-600">Periode: ${oe.periode||oe.PERIODE}</span>`),Q+='<div class="mt-2 p-2 bg-red-50 rounded text-xs text-red-800">',Q+="<strong>Detectietip:</strong> Romeinse forten zijn toplocaties! Je kunt hier Romeinse munten, fibulae (mantelspelden), militaire uitrusting en aardewerk vinden. Vaak beschermd, check de regels!",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.limesworld.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over de Romeinse Limes</a></div>',Qt.push(Q)}}catch(He){console.warn("Romeinse Forten WMS query failed:",He)}continue}if(Pn==="Windmolens"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&QUERY_LAYERS=CHS_2015_NEDERZETTING_WINDMOLENS&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-amber-800">${oe.naam||oe.NAAM||"Windmolen"}</strong>`;if(Q+='<br/><span class="text-sm text-gray-800">Historische windmolen</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Windmolens gebruikten de kracht van de wind. Ze maalden graan tot meel of pompten water weg uit polders. ",Q+="Nederland heeft veel molens omdat we laaggelegen land droog moesten houden.",Q+="</div>",oe.type||oe.TYPE||oe.functie||oe.FUNCTIE){const ye=oe.functie||oe.FUNCTIE||oe.type||oe.TYPE;Q+=`<br/><span class="text-sm text-amber-700">Functie: ${ye}</span>`}(oe.bouwjaar||oe.BOUWJAAR)&&(Q+=`<br/><span class="text-sm text-gray-600">Bouwjaar: ${oe.bouwjaar||oe.BOUWJAAR}</span>`),Q+='<div class="mt-2 p-2 bg-amber-50 rounded text-xs text-amber-800">',Q+="<strong>Detectietip:</strong> Bij molens vind je vaak voorwerpen van de molenaar en bezoekers: munten, knopen, gereedschap. Ook de grond rond verdwenen molens kan interessant zijn.",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.molendatabase.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Nederlandse molens</a></div>',Qt.push(Q)}}catch(He){console.warn("Windmolens WMS query failed:",He)}continue}if(Pn==="Erfgoedlijnen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&QUERY_LAYERS=CHS_ERFGOEDLIJN_HOOFDSTRUCTUUR&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-purple-800">${oe.naam||oe.NAAM||oe.erfgoedlijn||"Erfgoedlijn"}</strong>`;Q+='<br/><span class="text-sm text-gray-800">Historische lijn in het landschap</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Een erfgoedlijn is een route of lijn met veel geschiedenis. Dit kunnen oude dijken, wegen, kanalen of verdedigingslinies zijn. ",Q+="Langs deze lijnen vind je vaak bijzondere plekken.",Q+="</div>",(oe.type||oe.TYPE)&&(Q+=`<br/><span class="text-sm text-purple-700">Type: ${oe.type||oe.TYPE}</span>`),(oe.omschrijving||oe.OMSCHRIJVING)&&(Q+=`<br/><span class="text-sm text-gray-600">${oe.omschrijving||oe.OMSCHRIJVING}</span>`),Q+='<div class="mt-2 p-2 bg-purple-50 rounded text-xs text-purple-800">',Q+="<strong>Detectietip:</strong> Erfgoedlijnen volgen oude routes waar mensen langskwamen. Denk aan munten, knopen, gespen en andere verloren voorwerpen. Dijken en wegen zijn vaak interessant.",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.erfgoedlijnen.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over Erfgoedlijnen</a></div>',Qt.push(Q)}}catch(He){console.warn("Erfgoedlijnen WMS query failed:",He)}continue}if(Pn==="Oude Kernen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=200,z=`https://geodata.zuid-holland.nl/geoserver/cultuur/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&QUERY_LAYERS=CHS_2015_ARCHEOLOGIE_KERNEN&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-stone-800">${oe.naam||oe.NAAM||"Historische Kern"}</strong>`;Q+='<br/><span class="text-sm text-gray-800">Oude dorps- of stadskern</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Dit is het oude centrum van een dorp of stad. Hier woonden en werkten mensen al honderden jaren geleden. ",Q+="De grond bevat vaak veel sporen van het verleden.",Q+="</div>",(oe.type||oe.TYPE)&&(Q+=`<br/><span class="text-sm text-stone-700">Type: ${oe.type||oe.TYPE}</span>`),(oe.periode||oe.PERIODE)&&(Q+=`<br/><span class="text-sm text-gray-600">Periode: ${oe.periode||oe.PERIODE}</span>`),Q+='<div class="mt-2 p-2 bg-stone-100 rounded text-xs text-stone-800">',Q+="<strong>Detectietip:</strong> Oude kernen zijn rijk aan vondsten! Munten, knopen, sieraden, gereedschap en huisraad. Let op: detecteren is vaak niet toegestaan in beschermde kernen.",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.zuid-holland.nl/onderwerpen/cultuur-erfgoed/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over erfgoed Zuid-Holland</a></div>',Qt.push(Q)}}catch(He){console.warn("Oude Kernen WMS query failed:",He)}continue}if(Pn==="Relictenkaart Punten"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_p&QUERY_LAYERS=ChAr_Relictenkaart_p&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Ve={KV:{naam:"Kasteel of Vesting",uitleg:"Een versterkt gebouw uit de middeleeuwen. Vaak zijn er nog resten in de grond."},K:{naam:"Kapel",uitleg:"Een klein kerkgebouw. Rond kapellen worden vaak religieuze voorwerpen gevonden."},KE:{naam:"Kerkhof",uitleg:"Historische begraafplaats. Respecteer deze plek en vraag altijd toestemming."},B:{naam:"Buitenhuis",uitleg:"Een landhuis van welgestelde families. Vaak met tuinen en bijgebouwen."},OB:{naam:"Oud Bebouwingsrelict",uitleg:"Resten van oude bebouwing. Hier stonden ooit huizen of boerderijen."},OV:{naam:"Oude Verkaveling",uitleg:"Historisch patroon van akkers en weilanden uit vroeger tijden."},NR:{naam:"Nijverheidsrelict",uitleg:"Plek waar vroeger ambacht of industrie was, zoals smederijen of molens."},GH:{naam:"Grafheuvel",uitleg:"Prehistorische begraafplaats. Beschermd monument - niet detecteren!"},BP:{naam:"Begraafplaats",uitleg:"Historische begraafplaats. Respecteer deze plek."},HH:{naam:"Havezate",uitleg:"Adellijk huis met landerijen. Interessant voor middeleeuwse vondsten."},RM:{naam:"Rosmolen",uitleg:"Molen aangedreven door paarden. Zeldzaam cultuurhistorisch object."},WM:{naam:"Windmolen",uitleg:"Historische windmolen. Vaak zijn funderingen nog zichtbaar."},PM:{naam:"Poldermolen",uitleg:"Molen voor waterbeheer. Belangrijk voor de waterhuishouding."},EK:{naam:"Eendenkooi",uitleg:"Plek om wilde eenden te vangen. Bijzonder cultuurlandschap."},SH:{naam:"Scholtenhoeve",uitleg:"Boerderij van een welgestelde boer. Vaak eeuwenoud."},SL:{naam:"Slot",uitleg:"Versterkt kasteel of adellijke woning."},MO:{naam:"Motte",uitleg:"Vroegmiddeleeuwse kasteelberg. Zeer interessant voor detectie."},BR:{naam:"Borg",uitleg:"Versterkte adellijke woning, typisch voor het noorden."}},Q=oe.type?.replace(/[0-9]/g,"")||"",ye=Ve[Q]||{naam:oe.type||"Cultuurhistorisch object",uitleg:"Een historisch relict in het Gelderse landschap."};let De=`<strong class="text-emerald-800">${ye.naam}</strong>`;De+='<br/><span class="text-sm text-gray-800">Gelders cultuurhistorisch relict</span>',oe.streek&&(De+=`<br/><span class="text-sm text-gray-600">Streek: ${oe.streek}</span>`),De+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',De+=`<div class="text-sm text-gray-700 mt-1">${ye.uitleg}</div>`,De+='<div class="mt-3"><a href="https://www.gelderland.nl/erfgoed" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Meer over Gelders erfgoed</a></div>',Qt.push(De)}}catch(He){console.warn("Relictenkaart Punten WMS query failed:",He)}continue}if(Pn==="Relictenkaart Lijnen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=50,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_l&QUERY_LAYERS=ChAr_Relictenkaart_l&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Q={1:{naam:"Sprengenbeek",uitleg:"Kunstmatig aangelegde beek voor waterkracht. Vaak bij papiermolens."},2:{naam:"Oude waterloop",uitleg:"Historische beek of rivier. Langs waterlopen vind je vaak oude bewoningssporen."},3:{naam:"Doorgaande weg",uitleg:"Eeuwenoude handelsroute. Langs deze wegen gingen reizigers en handelaren."},4:{naam:"Hessenweg",uitleg:"Historische handelsweg naar Duitsland. Gebruikt door marskramers en kooplieden."},5:{naam:"Oude weg",uitleg:"Historische route door het landschap. Vaak al eeuwen in gebruik."},6:{naam:"Historische grens",uitleg:"Oude eigendoms- of gebiedsgrens. Soms gemarkeerd met grenspalen."},7:{naam:"Trekpad",uitleg:"Pad langs een kanaal waar paarden schepen trokken."},8:{naam:"Jaagpad",uitleg:"Pad langs water voor scheepvaart met paardentractie."}}[oe.klasse]||{naam:"Historisch lijnrelict",uitleg:"Een lijnvormig historisch element in het landschap."};let ye=`<strong class="text-teal-800">${Q.naam}</strong>`;ye+='<br/><span class="text-sm text-gray-800">Gelders lijnrelict</span>',ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ye+=`<div class="text-sm text-gray-700 mt-1">${Q.uitleg}</div>`,ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip</span></div>',ye+='<div class="text-sm text-gray-700 mt-1">Langs oude wegen en waterlopen worden vaak vondsten gedaan. Mensen verloren er munten en voorwerpen.</div>',Qt.push(ye)}}catch(He){console.warn("Relictenkaart Lijnen WMS query failed:",He)}continue}if(Pn==="Relictenkaart Vlakken"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=100,z=`https://geoserver.gelderland.nl/geoserver/ngr_a/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=ChAr_Relictenkaart_v&QUERY_LAYERS=ChAr_Relictenkaart_v&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties,Q={1:{naam:"Oud agrarisch land",uitleg:"Gebied dat al voor 1850 als landbouwgrond werd gebruikt. Rijk aan geschiedenis."},2:{naam:"Jonge heideontginning",uitleg:"Heide die tussen 1850 en 1950 is ontgonnen voor landbouw."},3:{naam:"Open essencomplex",uitleg:"Historische akkers op hoge grond. Vaak eeuwenoud en rijk aan vondsten."},4:{naam:"Kampenlandschap",uitleg:"Landschap met kleine akkers omringd door houtwallen. Typisch voor Oost-Nederland."},5:{naam:"Heiderelict",uitleg:"Restant van het vroegere uitgestrekte heidelandschap. Vaak prehistorische vondsten."},6:{naam:"Oud bosrelict",uitleg:"Bos dat al in 1850 bestond. Oude bossen bevatten vaak cultuurhistorische resten."},7:{naam:"Stuifzandrelict",uitleg:"Overblijfsel van actief stuifzand. Vaak bij grafheuvels en prehistorische sites."},8:{naam:"Oud bouwland",uitleg:"Historische akkergrond. Boeren hebben hier eeuwenlang gewerkt."},9:{naam:"Historisch grasland",uitleg:"Oud weiland of hooiland. Vaak bij boerderijen en dorpen."},10:{naam:"Beekdal",uitleg:"Laagte langs een beek. Mensen woonden graag bij water."}}[oe.klasse]||{naam:"Historisch landschap",uitleg:"Een waardevol cultuurlandschap in Gelderland."};let ye=`<strong class="text-lime-800">${Q.naam}</strong>`;if(ye+='<br/><span class="text-sm text-gray-800">Gelders landschapsrelict</span>',oe.st_area_shape_){const De=(oe.st_area_shape_/1e4).toFixed(1);ye+=`<br/><span class="text-sm text-gray-600">${De} hectare</span>`}ye+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is dit?</span></div>',ye+=`<div class="text-sm text-gray-700 mt-1">${Q.uitleg}</div>`,Qt.push(ye)}}catch(He){console.warn("Relictenkaart Vlakken WMS query failed:",He)}continue}if(Pn==="Verdronken Dorpen"){try{const He=Zn(Ft),Ae=ir("EPSG:4326","EPSG:28992",He),Ie=200,z=`https://opengeodata.zeeland.nl/geoserver/chs/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&LAYERS=geocmd_vrddrppnt&QUERY_LAYERS=geocmd_vrddrppnt&INFO_FORMAT=application/json&I=50&J=50&WIDTH=100&HEIGHT=100&CRS=EPSG:28992&BBOX=${`${Ae[0]-Ie},${Ae[1]-Ie},${Ae[0]+Ie},${Ae[1]+Ie}`}`,Y=await(await fetch(z)).json();if(Y.features&&Y.features.length>0){const oe=Y.features[0].properties;let Q=`<strong class="text-blue-800">${oe.naam||oe.NAAM||"Verdronken dorp"}</strong>`;Q+='<br/><span class="text-sm text-gray-800">Verdronken dorp in Zeeland</span>',Q+='<div class="mt-2 text-sm text-gray-700">',Q+="Dit dorp is lang geleden door de zee verzwolgen. Bij stormvloeden brak de zeedijk door en liep het land onder water. ",Q+="De mensen vluchtten, maar hun huizen en bezittingen bleven achter. In de bodem liggen nog resten van dit dorp.",Q+="</div>",(oe.verdronken||oe.VERDRONKEN||oe.jaar||oe.JAAR)&&(Q+=`<br/><span class="text-sm text-blue-700">Verdronken in: ${oe.verdronken||oe.VERDRONKEN||oe.jaar||oe.JAAR}</span>`),(oe.gemeente||oe.GEMEENTE)&&(Q+=`<br/><span class="text-sm text-gray-600">Gemeente: ${oe.gemeente||oe.GEMEENTE}</span>`),(oe.bron||oe.BRON)&&(Q+=`<br/><span class="text-xs text-gray-500">Bron: ${oe.bron||oe.BRON}</span>`),Q+='<div class="mt-2 p-2 bg-blue-50 rounded text-xs text-blue-800">',Q+="<strong>Detectietip:</strong> Verdronken dorpen bevatten veel vondsten! Aardewerk, munten, sieraden, gereedschap en huisraad. Bij laag water komen soms stukken vrij. Let op getijden en veiligheid!",Q+="</div>",Q+='<div class="mt-2"><a href="https://www.verdronkengeschiedenis.nl/" target="_blank" class="text-blue-600 hover:underline text-sm">Meer over verdronken dorpen</a></div>',Qt.push(Q)}}catch(He){console.warn("Verdronken Dorpen WMS query failed:",He)}continue}const Ti=Ps.getFeatureInfoUrl(Ft,On,"EPSG:3857",{INFO_FORMAT:"application/json"});if(Ti)try{const Ae=await(await fetch(Ti)).json();if(Ae.features&&Ae.features.length>0){const Ie=Ae.features[0].properties;if(Pn==="AHN 0.5m"){let Y='<strong class="text-blue-800">AHN Hoogtekaart</strong>';const oe=Ie.value_list??Ie.GRAY_INDEX??Ie.value??Ie.gray_index??Ie.dtm_05m??Ie.DTM_05M??Ie.hoogte??Ie.HOOGTE??Ie.elevation??Ie.ELEVATION;if(oe!=null&&!isNaN(Number(oe))){const Ve=typeof oe=="number"?oe.toFixed(2):Number(oe).toFixed(2);Y+=`<br/><span class="text-sm text-blue-700">Hoogte: ${Ve} m NAP</span>`,Qt.push(Y)}else{let Ve=!1;const Q=["geometry","id","fid","gml_id","bbox"];for(const[ye,De]of Object.entries(Ie))!Q.includes(ye.toLowerCase())&&De!==null&&De!==""&&(Y+=`<br/><span class="text-xs text-gray-600">${ye}: ${De}</span>`,Ve=!0);Ve&&Qt.push(Y)}continue}if(Pn==="Geomorfologie"){let Y='<strong class="text-green-800">Geomorfologie</strong>',oe=!1;const Ve=Ie.landform_subgroup_description,Q=Ie.relief_klasse,ye=Ie.relief_subklasse,De=Ie.genese_description,Je=Ie.active_process;if(Ve&&(Y+=`<br/><span class="text-sm text-green-700">${Ve}</span>`,oe=!0),Q){const Ue=ye&&ye!==Q?`${Q} (${ye})`:Q;Y+=`<br/><span class="text-xs text-gray-600">Relief: ${Ue}</span>`,oe=!0}if(De&&(Y+=`<br/><span class="text-xs text-gray-500">Ontstaan: ${De}</span>`,oe=!0),Je&&Je!=="onbekend"&&(Y+=`<br/><span class="text-xs text-gray-500">Actief proces: ${Je}</span>`,oe=!0),!oe){const Ue=["geometry","id","fid","gml_id","bbox","fuuid","geom","collection_id"];for(const[nt,et]of Object.entries(Ie))!Ue.includes(nt.toLowerCase())&&et!==null&&et!==""&&!nt.includes("validfrom")&&!nt.includes("validto")&&(Y+=`<br/><span class="text-xs text-gray-600">${nt}: ${et}</span>`)}Y+='<br/><a href="https://legendageomorfologie.wur.nl/" target="_blank" rel="noopener" class="text-xs text-blue-600 hover:underline">Meer over geomorfologie</a>',Qt.push(Y);continue}let rn=`<strong>${Pn}</strong>`;const z=Ie.first_soilname||Ie.soilname,bt=Ie.soilcode||Ie.first_soilcode;if(z&&(rn+=`<br/><span class="text-sm text-amber-700">${z}</span>`,Pn==="Bodemkaart")){const Y=xoe(z,bt);Y.length>0&&(rn+=`<br/><span class="text-xs text-gray-500 italic">${Y.join("  ")}</span>`)}if(Ie.soilslope&&Ie.soilslope!=="Niet opgenomen"&&(rn+=`<br/><span class="text-xs text-gray-500">Helling: ${Ie.soilslope}</span>`),!z){const Y=["geometry","id","fid","gml_id","GRAY_INDEX","gray_index","value"];for(const[oe,Ve]of Object.entries(Ie))!Y.includes(oe)&&Ve&&Ve!=="Niet opgenomen"&&(rn+=`<br/><span class="text-xs text-gray-600">${oe}: ${Ve}</span>`)}Qt.push(rn)}}catch(He){console.warn("WMS GetFeatureInfo failed:",He)}}return Qt},cr=async Ft=>{const On=[],Qt=[],Oo=Ae=>{if(!Ae)return;const Ie=Ae.getType(),z=Ae.clone().transform("EPSG:3857","EPSG:4326").getCoordinates();return{type:Ie,coordinates:z}},ji=EEt(Ft.coordinate),Ps=[];t.forEachFeatureAtPixel(Ft.pixel,Ae=>{Ps.push(Ae)});for(const Ae of Ps){const Ie=Ae.getProperties(),{geometry:rn,...z}=Ie;if(z.vondst){const Q=z.vondst,ye=`<strong>${Q.objectType}</strong>
            <div data-vondst-id="${Q.id}"></div>
            <br/><span class="text-sm text-gray-600"><strong>Materiaal:</strong> ${Q.material}</span>
            <br/><span class="text-sm text-gray-600"><strong>Periode:</strong> ${Q.period}</span>
            ${Q.depth?`<br/><span class="text-sm text-gray-600"><strong>Diepte:</strong> ${Q.depth} cm</span>`:""}
            ${Q.condition&&Q.condition!=="Onbekend"?`<br/><span class="text-sm text-gray-600"><strong>Conditie:</strong> ${Q.condition}</span>`:""}
            ${Q.weight?`<br/><span class="text-sm text-gray-600"><strong>Gewicht:</strong> ${Q.weight} gram</span>`:""}
            ${Q.notes?`<br/><span class="text-sm text-gray-600"><strong>Notities:</strong> ${Q.notes}</span>`:""}
            ${Q.photoUrl?`<br/><a href="${Q.photoUrl}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm"> Bekijk foto</a>`:""}
            <br/><span class="text-xs text-gray-400">${new Date(Q.timestamp).toLocaleDateString("nl-NL")}</span>`;On.push(ye),Qt.push(null),R(Q.id);continue}if(z.layerType==="customPoint"&&z.customPoint){const Q=z.customPoint,ye=z.customLayerName||"Mijn Laag",De=z.customLayerColor||"#f97316";let Je="";if(Q.popupContent?(Je=`<div class="flex items-center gap-2 mb-2 pb-2 border-b border-gray-100">
              <span class="w-3 h-3 rounded-full flex-shrink-0" style="background-color: ${De}"></span>
              <span class="text-xs font-medium" style="color: ${De}">${ye}</span>
            </div>`,Je+=Q.popupContent):(Je=`<strong>${Q.name}</strong>`,Je+=`<br/><span class="text-xs text-gray-500">${ye}</span>`,Q.category&&Q.category!=="Overig"&&(Je+=`<br/><span class="text-sm text-gray-600"><strong>Categorie:</strong> ${Q.category}</span>`)),Q.photos&&Q.photos.length>0){Je+='<div class="flex flex-wrap gap-1 my-2">';for(const Ue of Q.photos.slice(0,3)){const nt=Ue.thumbnailUrl||Ue.thumbnailBase64;nt&&(Je+=`<img src="${nt}" alt="Foto" class="w-16 h-16 object-cover rounded border border-gray-200" />`)}Q.photos.length>3&&(Je+=`<span class="text-xs text-gray-400 self-end">+${Q.photos.length-3} meer</span>`),Je+="</div>"}Q.notes&&!Q.popupContent&&(Je+=`<br/><span class="text-sm text-gray-600 mt-1">${Q.notes}</span>`),Q.url&&(Je+=`<br/><a href="${Q.url}" target="_blank" rel="noopener" class="text-blue-600 hover:underline text-sm">Meer info</a>`),Je+=`<br/><span class="text-xs text-gray-400">${new Date(Q.createdAt).toLocaleDateString("nl-NL")}</span>`,On.push(Je),Qt.push(null);continue}if(z.layerType==="importedLayer"){const Q=z.layerName||"Gemporteerde laag",ye=z.layerColor||"#8b5cf6",De=["layerType","layerId","layerName","layerColor","featureIndex","geometry"],Je=z.name||z.Name||z.naam||z.title||z.NAAM||z.NAME||z.label||z.description||"Feature";let Ue=`<strong style="color: ${ye}">${Je}</strong>`;Ue+=`<br/><span class="text-xs text-gray-500">${Q}</span>`;const nt=Object.entries(z).filter(([et])=>!De.includes(et)&&et!=="name"&&et!=="Name");if(nt.length>0){Ue+='<div class="mt-2 space-y-1">';for(const[et,Pt]of nt)if(Pt!=null&&Pt!==""){const zt=et.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,q=>q.toUpperCase());let gn=String(Pt);gn.length>200&&(gn=gn.substring(0,200)+"..."),gn.startsWith("http://")||gn.startsWith("https://")?Ue+=`<div class="text-sm"><span class="text-gray-500">${zt}:</span> <a href="${gn}" target="_blank" rel="noopener" class="text-blue-600 hover:underline">Link</a></div>`:Ue+=`<div class="text-sm"><span class="text-gray-500">${zt}:</span> <span class="text-gray-700">${gn}</span></div>`}Ue+="</div>"}On.push(Ue),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Ue});continue}if(z.kwaliteitswaarde&&z.kwaliteitswaarde.includes("archeologische waarde")){const Q=Mt(z);On.push(Q),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Q});continue}if(z.layerType==="romeinsFort"||z.layerType==="romeinsFortLijn"){const Q=z.Name||z.name||"";z.description;const ye=xEt[Q]||null,De=ye||wEt;let Je=`<strong class="text-red-800">${ye?De.naam:Q||"Romeins Fort"}</strong>`;if(Je+=`<br/><span class="text-sm text-red-700">${bEt[De.type]||De.type}</span>`,Je+=`<br/><span class="text-sm text-gray-500">${De.periode}</span>`,z.layerType==="romeinsFortLijn"&&(Je+='<br/><span class="text-sm text-red-600"> Gereconstrueerde fortomtrek</span>'),Je+=`<br/><span class="text-xs text-gray-600 mt-1 block">${De.beschrijving}</span>`,ye?.bronnen&&ye.bronnen.length>0){const Ue=ye.bronnen[0].replace(/^https?:\/\//,"").split("/")[0];Je+=`<br/><a href="${ye.bronnen[0]}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-xs">${Ue}</a>`}On.push(Je),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Je});continue}let bt=z.name||z.Name||z.naam||z.title||z.NAAM||z.NAME||z.label||z.route_name||z.road_name;bt||(z.leisure==="playground"?bt="Speeltuin":z.leisure==="park"?bt="Park":z.leisure==="swimming_area"||z.sport==="swimming"?bt="Zwemplek":z.tourism==="museum"?bt="Museum":z.amenity==="cafe"||z.amenity==="restaurant"?bt=z.amenity==="cafe"?"Caf":"Restaurant":z.historic==="castle"?bt="Kasteel":bt="Info"),(z.bunker_type||z.name&&(z.name.toLowerCase().includes("bunker")||z.name.toLowerCase().includes("kazemat")||z.name.toLowerCase().includes("schuilplaats")))&&(bt="Bunker"),z.historic==="battlefield"&&(bt="Historisch slagveld");let Y=`<strong>${bt}</strong>`,oe=!1;if(z.category&&(Y+=`<br/><span class="text-sm text-gray-600">Categorie: ${z.category}</span>`),z.from_to&&z.from_to!==bt&&(Y+=`<br/><span class="text-sm text-gray-600">${z.from_to}</span>`),z.route&&z.route!==bt&&(Y+=`<br/><span class="text-sm text-gray-600">${z.route}</span>`),z.TOPONIEM&&(Y+=`<br/><span class="text-sm font-semibold text-gray-800">${z.TOPONIEM}</span>`,z.PLAATS&&(Y+=`<br/><span class="text-xs text-gray-500">${z.PLAATS}</span>`)),(z.AARD_VINDP||z.Aard_vindp)&&(Y+=`<br/><span class="text-sm text-gray-700">Aard: ${z.AARD_VINDP||z.Aard_vindp}</span>`),z.BEGIN_PER&&z.EIND_PER&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${z.BEGIN_PER} - ${z.EIND_PER}</span>`),(z.AARD_OPM||z.Aard_opmer)&&(Y+=`<br/><span class="text-xs text-gray-600 italic">${z.AARD_OPM||z.Aard_opmer}</span>`),z.Gemeente&&(Y+=`<br/><span class="text-sm text-gray-600">Gemeente: ${z.Gemeente}</span>`),z.Bron&&(Y+=`<br/><span class="text-xs text-gray-500">Bron: ${z.Bron}</span>`),z.Bron_besch&&(Y+=`<br/><span class="text-xs text-gray-500">${z.Bron_besch}</span>`),z.Dat_st_z&&z.Dat_ei_z&&(Y+=`<br/><span class="text-sm text-purple-700">Datering: ${z.Dat_st_z} - ${z.Dat_ei_z}</span>`),z.Begin&&z.Einde&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${z.Begin} - ${z.Einde}</span>`),z.Uiterwaard&&(Y+=`<br/><span class="text-sm font-semibold">${z.Uiterwaard}</span>`),z.rivier&&(Y+=`<br/><span class="text-sm text-blue-600">Rivier: ${z.rivier}</span>`),z.Beschrijvi&&(Y+=`<br/><span class="text-sm text-gray-700">${z.Beschrijvi}</span>`),z.leisure==="park"){oe=!0,Y=`<strong class="text-green-800">${z.name||"Park"}</strong>`,Y+='<br/><span class="text-sm text-gray-800">Park</span>',z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),z.area&&(Y+=`<br/><span class="text-sm text-gray-600">Oppervlakte: ${z.area}</span>`);const ye=[];if(z.dog==="yes"&&ye.push("Honden toegestaan"),z.lit==="yes"&&ye.push("Verlicht"),z.bench==="yes"&&ye.push("Bankjes"),ye.length>0&&(Y+=`<br/><span class="text-sm text-gray-600">${ye.join("  ")}</span>`),z.operator&&(Y+=`<br/><span class="text-xs text-gray-500">Beheer: ${z.operator}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',Y+='<div class="text-sm text-gray-700">Parken zijn populair bij detectoristen. Mensen verliezen hier munten en sieraden. Vraag eerst toestemming aan de gemeente of beheerder.</div>',z.website){const De=z.website.replace(/^https?:\/\//,"").split("/")[0];Y+=`<div class="mt-2"><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">${De}</a></div>`}}else z.leisure==="playground"&&(oe=!0,Y=`<strong class="text-orange-800">${z.name||"Speeltuin"}</strong>`,Y+='<br/><span class="text-sm text-gray-800">Speeltuin</span>',z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`));if(z.tourism==="museum"||z.museum){oe=!0;const Q=z.name||"Museum",ye=z.museum||z["museum:type"]||"",Je=ye&&ye!=="yes"?{art:"Kunstmuseum",history:"Geschiedenismuseum",archaeology:"Archeologisch museum",science:"Wetenschapsmuseum",technology:"Techniekmuseum",nature:"Natuurmuseum",open_air:"Openluchtmuseum",local:"Streekmuseum",military:"Militair museum",railway:"Spoorwegmuseum",maritime:"Maritiem museum",children:"Kindermuseum"}[ye.toLowerCase()]||ye:"Museum";if(Y=`<strong class="text-purple-800">${Q}</strong>`,Y+=`<br/><span class="text-sm text-purple-600">${Je}</span>`,z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),z.fee){const Ue=z.fee==="yes"?"Toegangsprijs":z.fee==="no"?"Gratis toegang":z.fee;Y+=`<div class="mt-2"><span class="text-sm text-gray-600">${Ue}</span></div>`}if(z.opening_hours){const Ue=_oe(String(z.opening_hours));Y+=`<div class="mt-2"><span class="text-xs text-green-600">Open: ${Ue}</span></div>`}if(z.website||z.url){const Ue=z.website||z.url;Y+=`<div class="mt-1"><a href="${Ue}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-sm">Bezoek ${Q}</a></div>`}if(z.wikipedia){const Ue=z.wikipedia.split(":")[0]||"nl",nt=z.wikipedia.split(":")[1]||z.wikipedia;Y+=`<div class="text-sm"><a href="https://${Ue}.wikipedia.org/wiki/${encodeURIComponent(nt)}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Meer info op Wikipedia</a></div>`}if(z["addr:street"]||z["addr:housenumber"]||z["addr:city"]){if(Y+='<div class="mt-2 text-xs text-gray-400">',z["addr:street"]||z["addr:housenumber"]){const Ue=[z["addr:street"],z["addr:housenumber"]].filter(Boolean).join(" ");Ue&&(Y+=`${Ue}<br/>`)}z["addr:city"]&&(Y+=`${z["addr:postcode"]||""} ${z["addr:city"]}`),Y+="</div>"}}if(z.leisure==="swimming_area"||z.sport==="swimming"||z.natural==="beach"){oe=!0,Y=`<strong class="text-cyan-800">${z.name||"Zwemplek"}</strong>`;const ye=z.natural==="beach"?"Strand":z.leisure==="swimming_area"?"Zwemplek":"Zwemwater";Y+=`<br/><span class="text-sm text-gray-800">${ye}</span>`,z.water&&(Y+=`<br/><span class="text-sm text-gray-700">${{lake:"Meer",river:"Rivier",pond:"Vijver",reservoir:"Reservoir",canal:"Kanaal"}[z.water]||z.water}</span>`),z.supervised==="yes"&&(Y+='<br/><span class="text-sm text-green-700">Met toezicht</span>'),z.changing_rooms==="yes"&&(Y+='<br/><span class="text-sm text-gray-600">Kleedruimte aanwezig</span>'),z.description&&(Y+=`<div class="mt-2 text-sm text-gray-700">${z.description}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Tip voor detectie</span></div>',Y+='<div class="text-sm text-gray-700">Zwemplekken kunnen interessant zijn voor detectie. Mensen verliezen hier sieraden en munten. Let op: niet overal is detecteren toegestaan.</div>'}if(z.osm_id&&z.address!==void 0&&(Y+='<br/><span class="text-sm text-lime-700">Kringloopwinkel</span>',z.address&&(Y+=`<br/><span class="text-xs text-gray-500">${z.address}</span>`),z.phone&&(Y+=`<br/><span class="text-xs text-gray-600">${z.phone}</span>`)),z.site_type==="tumulus"){oe=!0;const Q=Ae.getGeometry()?.getCoordinates();let ye="",De="";if(Q){const Je=Zn(Q),Ue=Je[0],nt=Je[1];Ue>5.5&&Ue<6.3&&nt>52&&nt<52.5?(ye="Veluwe",De="De Veluwe heeft de grootste concentratie grafheuvels van Nederland. Veel heuvels liggen in grafvelden met tientallen heuvels bij elkaar."):Ue>6.2&&Ue<7.1&&nt>52.6&&nt<53.3?(ye="Drenthe",De="Drenthe is beroemd om zijn prehistorische monumenten. Naast hunebedden liggen hier honderden grafheuvels uit de Bronstijd."):Ue>4.5&&Ue<6&&nt>51.3&&nt<51.9?(ye="Noord-Brabant",De="Op de Brabantse zandgronden liggen veel grafheuvels, vaak in kleine groepjes op hogere gronden."):Ue>5.5&&Ue<6.3&&nt>50.7&&nt<51.6?(ye="Limburg",De="De Limburgse heuvels en plateaus herbergen grafheuvels uit verschillende periodes, van Bronstijd tot Romeinse tijd."):Ue>5&&Ue<5.6&&nt>52&&nt<52.4&&(ye="Utrechtse Heuvelrug",De="De stuwwallen van de Utrechtse Heuvelrug en het Gooi waren al in de prehistorie bewoond. Grafheuvels markeren de laatste rustplaats van de vroege bewoners.")}Y+='<br/><span class="text-sm text-amber-700">Grafheuvel uit de Bronstijd of IJzertijd</span>',ye&&(Y+=`<br/><span class="text-sm text-gray-500">${ye}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Een grafheuvel is een kunstmatige heuvel over een of meerdere graven. De meeste Nederlandse grafheuvels zijn 3000 tot 4000 jaar oud, uit de Bronstijd (2000-800 v.Chr.) of vroege IJzertijd.</div>',De&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Over deze regio</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${De}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe herken je een grafheuvel?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Grafheuvels zijn vaak ronde, lage heuvels van 10-30 meter doorsnee en 1-3 meter hoog. Ze liggen meestal op zandgronden, vaak in groepjes (grafvelden). Let op de kenmerkende ronde vorm in het landschap.</div>',z.wikidata?(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1"><a href="https://www.wikidata.org/wiki/${z.wikidata}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Bekijk op Wikidata</a></div>`):(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer informatie</span></div>',Y+='<div class="text-sm text-gray-700 mt-1"><a href="https://nl.wikipedia.org/wiki/Grafheuvel" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Lees meer over grafheuvels op Wikipedia</a></div>')}if(z.historic==="castle"||z.castle_type){oe=!0;const Q={manor:{label:"Landhuis",uitleg:"Een landhuis of havezate was het woonhuis van een adellijke familie. Vaak met een landgoed eromheen.",vondsten:"Sieraden, gespen, munten, aardewerk van rijke bewoners"},stately:{label:"Statig huis",uitleg:"Een groot en deftig woonhuis, vaak van welgestelde families. Soms met kasteelachtige kenmerken.",vondsten:"Huishoudelijke voorwerpen, munten, knopen, aardewerk"},fortress:{label:"Fort/Vesting",uitleg:"Een versterkte militaire bouwwerk, gebouwd om een gebied te verdedigen.",vondsten:"Militaire voorwerpen, kogels, gespen, uniformonderdelen"},defensive:{label:"Verdedigingskasteel",uitleg:"Een kasteel gebouwd voor verdediging, met dikke muren, een gracht en torens.",vondsten:"Wapens, harnasonderdelen, pijlpunten, middeleeuwse munten"},palace:{label:"Paleis",uitleg:"Een groot en luxueus gebouw voor koningen, prinsen of zeer rijke families.",vondsten:"Luxe voorwerpen, sieraden, zegels, zeldzame munten"},castrum:{label:"Romeins fort",uitleg:"Een Romeins legerkamp of fort. Deze zijn bijna 2000 jaar oud!",vondsten:"Romeinse munten, fibulae, militaria, aardewerk"},citadel:{label:"Citadel",uitleg:"Een sterk versterkte kern binnen een stad, als laatste verdedigingslinie.",vondsten:"Militaire voorwerpen uit verschillende periodes"}},ye=z.castle_type?Q[z.castle_type]:null,De=ye?.label||"Kasteel";if(Y+=`<br/><span class="text-sm text-purple-700">${De}</span>`,z.start_date&&(Y+=`<br/><span class="text-xs text-gray-500">Bouwjaar: ${z.start_date}</span>`),z.heritage&&(Y+='<br/><span class="text-sm text-amber-700">Rijksmonument</span>'),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',ye?Y+=`<div class="text-sm text-gray-700 mt-1">${ye.uitleg}</div>`:Y+='<div class="text-sm text-gray-700 mt-1">Een historisch kasteel of adellijk huis. Kastelen waren vaak het middelpunt van macht en rijkdom in een gebied.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',ye?Y+=`<div class="text-sm text-gray-700 mt-1">${ye.vondsten}</div>`:Y+='<div class="text-sm text-gray-700 mt-1">Munten, sieraden, gespen, aardewerk en andere voorwerpen van de vroegere bewoners.</div>',z.wikipedia||z.website){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',z.wikipedia){const Je=z.wikipedia.startsWith("http")?z.wikipedia:`https://nl.wikipedia.org/wiki/${z.wikipedia.replace(/^nl:/,"")}`;Y+=`<div class="text-sm text-gray-700 mt-1"><a href="${Je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}z.website&&(Y+=`<div class="text-sm text-gray-700 mt-1"><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Website bezoeken</a></div>`)}}if(z.historic==="ruins"){const Q=z.ruins_type||"";let ye="Rune",De="Een rune is wat overblijft van een oud gebouw. Het kan een kerk, kasteel, molen of ander bouwwerk zijn geweest.",Je="Baksteenfragmenten, aardewerk, metalen voorwerpen van vroegere bewoners of gebruikers";if(Q.toLowerCase().includes("church")||Q.toLowerCase().includes("kerk")?(ye="Kerkrune",De="De overblijfselen van een oude kerk. Vaak nog te herkennen aan de fundering of een paar muren.",Je="Religieuze voorwerpen, munten van kerkgangers, knopen, gespen"):Q.toLowerCase().includes("castle")||Q.toLowerCase().includes("kasteel")?(ye="Kasteelrune",De="De resten van een middeleeuws kasteel. Soms is alleen de gracht of fundering nog zichtbaar.",Je="Middeleeuwse munten, sieraden, harnasonderdelen, pijlpunten"):Q.toLowerCase().includes("mill")||Q.toLowerCase().includes("molen")?(ye="Molenrune",De="Wat rest van een oude molen. Vaak nog te zien aan de stenen fundering of de molenberg.",Je="Gereedschap, munten, huishoudelijke voorwerpen"):Q.toLowerCase().includes("fort")&&(ye="Fortrune",De="De overblijfselen van een militair fort of verdedigingswerk.",Je="Militaire voorwerpen, kogels, gespen, uniformonderdelen"),Y+=`<br/><span class="text-sm text-amber-700">${ye}</span>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${De}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je hier vinden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${Je}</div>`,z.description&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Beschrijving</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`),z.wikipedia){const Ue=z.wikipedia.startsWith("http")?z.wikipedia:`https://${z.wikipedia.split(":")[0]||"nl"}.wikipedia.org/wiki/${z.wikipedia.replace(/^[a-z]{2}:/,"")}`;Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${Ue}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(z.bunker_type||z.name&&(z.name.toLowerCase().includes("bunker")||z.name.toLowerCase().includes("kazemat")||z.name.toLowerCase().includes("schuilplaats"))){oe=!0;const Q={munitions:"Munitiebunker",personnel_shelter:"Personeelsschuilplaats",personell_shelter:"Personeelsschuilplaats",command:"Commandobunker",gun_emplacement:"Geschutsbunker",mg_nest:"Mitrailleursnest",technical:"Technische bunker",storage:"Opslagbunker",tobruk:"Tobruk",kazemat:"Kazemat",Flak:"Luchtafweerstelling",hardened_aircraft_shelter:"Vliegtuigshelter",shelter:"Schuilkelder",observation:"Observatiebunker",anti_aircraft:"Luchtafweerstelling"},ye=z.name||"",De=z.bunker_type?Q[z.bunker_type]||z.bunker_type:"";ye&&ye!=="Bunker"&&(Y+=`<br/><span class="text-sm font-semibold text-gray-700">${ye}</span>`),De&&De!==ye&&(Y+=`<br/><span class="text-xs text-gray-500">${De}</span>`);const Je=Ae.getGeometry()?.getCoordinates();let Ue="",nt="",et="";if(Je){const Pt=Zn(Je),zt=Pt[0],gn=Pt[1],q=zt<4.8||zt<5.2&&gn>51.8&&gn<53.5,te=zt>4.2&&zt<4.4&&gn>52&&gn<52.15,J=zt>4.5&&zt<4.7&&gn>52.4&&gn<52.5,ee=zt>4&&zt<4.2&&gn>51.95&&gn<52.05,re=zt<4.2&&gn<51.6,ie=zt>5.2&&zt<5.8&&gn>51.9&&gn<52.3;te?(Ue="Deze bunker maakt deel uit van de Atlantikwall bij Scheveningen. De Duitsers bouwden hier tijdens WOII zo'n 80 bunkers in de duinen. De muren zijn soms 3 meter dik beton. Voor deze bunkers moesten 138.000 mensen uit Den Haag en Scheveningen hun huis verlaten.",nt="https://nl.wikipedia.org/wiki/Atlantikwall_Museum_Scheveningen",et="Atlantikwall Museum Scheveningen"):J?(Ue="Deze bunker hoort bij Festung IJmuiden, een van de zwaarst verdedigde punten van de Atlantikwall. De Duitsers bouwden hier bunkers om de haventoegang te beschermen. Er zijn nu rondleidingen door het Bunkermuseum.",nt="https://www.bunkermuseum.nl/",et="Bunkermuseum IJmuiden"):ee?(Ue="Deze bunker maakt deel uit van de Atlantikwall bij Hoek van Holland. Dit was een strategisch punt voor de Duitsers vanwege de Nieuwe Waterweg. Veel bunkers zijn nog te bezoeken.",nt="https://www.atlantikwallhoekvanholland.nl/",et="Atlantikwall Hoek van Holland"):re?(Ue="Deze bunker hoort bij de Atlantikwall in Zeeland. De Duitsers verdedigden hier de Westerschelde en de kust. Bij Zoutelande en Westkapelle zijn veel bunkers bewaard gebleven.",nt="https://www.bunkermuseumzoutelande.nl/",et="Bunkermuseum Zoutelande"):q?(Ue="Deze bunker maakt deel uit van de Atlantikwall: de Duitse verdedigingslinie langs de hele kust van Europa. In Nederland bouwden de Duitsers duizenden bunkers tussen 1942 en 1944.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="Atlantikwall (Wikipedia)"):ie?(Ue="Deze bunker hoort mogelijk bij de Grebbelinie of de Nieuwe Hollandse Waterlinie. Dit waren Nederlandse verdedigingslinies die de Duitsers na 1940 versterkten met bunkers.",nt="https://nl.wikipedia.org/wiki/Grebbelinie",et="Grebbelinie (Wikipedia)"):(Ue="Een bunker uit de Tweede Wereldoorlog. De meeste bunkers in Nederland zijn gebouwd tussen 1940 en 1944, als onderdeel van de Duitse verdediging of langs bestaande Nederlandse linies.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)")}else Ue="Een bunker uit de Tweede Wereldoorlog.",nt="https://nl.wikipedia.org/wiki/Atlantikwall",et="WOII bunkers (Wikipedia)";Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${Ue}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je vinden?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Bij bunkers worden soms voorwerpen gevonden zoals patronen, uniformknopen, gespen en persoonlijke spullen van soldaten.</div>',Y+='<div class="mt-2 text-xs text-gray-500 italic">Let op: betreed nooit een bunker zonder toestemming. Raak munitieresten niet aan.</div>',Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">',Y+=`<a href="${nt}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">${et}</a>`,z.website?Y+=`<br/><a href="${z.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>`:Y+='<br/><a href="https://www.tracesofwar.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">TracesOfWar</a>',Y+="</div>"}if(z.historic==="battlefield"){oe=!0;const Q=z.name||"Onbekend slagveld",De={"Slag om Arnhem":{periode:"September 1944",samenvatting:"De Slag om Arnhem was onderdeel van Operatie Market Garden. Geallieerde parachutisten probeerden de brug over de Rijn te veroveren. Na negen dagen hevige gevechten moesten ze zich terugtrekken. Van de 10.000 Britse soldaten werden er 1.500 gedood en 6.500 krijgsgevangen gemaakt.",watZieJe:"Er zijn veel monumenten en infoborden. Het Airborne Museum in Oosterbeek vertelt het hele verhaal. Elk jaar in september is er een herdenking.",uitkomst:"De geallieerden verloren de slag. Nederland bleef nog tot mei 1945 bezet.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Arnhem"},"Slag om de Sloedam":{periode:"1-2 november 1944",samenvatting:"Canadese soldaten vielen de Sloedam aan om Walcheren te bevrijden. De dam was smal en de Duitsers verdedigden fel. Veel soldaten sneuvelden bij deze bloedige aanval.",watZieJe:"Bij de dam staat een monument voor de gevallen Canadezen. Er zijn infoborden die de slag uitleggen.",uitkomst:"De Canadezen wonnen na zware verliezen. Dit opende de weg naar de bevrijding van Walcheren.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_de_Sloedam"},"Slag bij Heiligerlee (1568)":{periode:"23 mei 1568",samenvatting:"De eerste veldslag van de Tachtigjarige Oorlog. Lodewijk van Nassau versloeg het Spaanse leger. Zijn broer Adolf sneuvelde tijdens de strijd.",watZieJe:"In Heiligerlee staat het Slag bij Heiligerlee monument. Het klooster waar Adolf van Nassau begraven ligt is nog te bezoeken.",uitkomst:"De opstandelingen wonnen, maar dit was pas het begin van 80 jaar oorlog.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_bij_Heiligerlee_(1568)"},Overloon:{periode:"Oktober 1944",samenvatting:"Bij Overloon vochten Britten en Amerikanen tegen de Duitsers. Het was een van de zwaarste tankgevechten op Nederlandse bodem. Het dorp werd volledig verwoest.",watZieJe:"Het Oorlogsmuseum Overloon staat op het voormalige slagveld. Je kunt tanks, vliegtuigen en andere voertuigen zien.",uitkomst:"De geallieerden wonnen na wekenlange gevechten.",wikiUrl:"https://nl.wikipedia.org/wiki/Slag_om_Overloon"},"Slagveld Lanakerveld":{periode:"1568",samenvatting:"Onderdeel van de Nederlandse opstand tegen Spanje. Hier vonden gevechten plaats tijdens de beginjaren van de Tachtigjarige Oorlog.",watZieJe:"Het gebied is nu grotendeels landbouwgrond. Lokaal zijn er soms infoborden.",uitkomst:"Onderdeel van de lange strijd tegen de Spaanse overheersing.",wikiUrl:"https://nl.wikipedia.org/wiki/Tachtigjarige_Oorlog"},Blessebrugschans:{periode:"Diverse periodes",samenvatting:"Een historische schans die meerdere keren werd gebruikt in militaire conflicten.",watZieJe:"De resten van de schans zijn nog zichtbaar in het landschap.",uitkomst:"De schans speelde een rol in verschillende conflicten.",wikiUrl:"https://nl.wikipedia.org/wiki/Schans_(vestingwerk)"}}[Q];if(Q!=="Onbekend slagveld"&&Q!=="Historisch slagveld"&&(Y+=`<br/><span class="text-sm font-semibold text-red-700">${Q}</span>`),De)Y+=`<br/><span class="text-xs text-gray-500">${De.periode}</span>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${De.samenvatting}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe liep het af?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${De.uitkomst}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kun je zien?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${De.watZieJe}</div>`,Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">',Y+=`<a href="${De.wikiUrl}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a>`,Q.includes("Arnhem")&&(Y+='<br/><a href="https://www.airbornemuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Airborne Museum Oosterbeek</a>'),Q.includes("Overloon")&&(Y+='<br/><a href="https://www.oorlogsmuseum.nl/" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Oorlogsmuseum Overloon</a>'),Y+="</div>";else if(z.date&&(Y+=`<br/><span class="text-xs text-gray-500">${z.date}</span>`),z.description?(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`):(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat gebeurde hier?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">Op deze plek vonden historische gevechten plaats. Zoek lokaal naar infoborden of monumenten.</div>'),z.wikipedia){const Je=z.wikipedia.startsWith("http")?z.wikipedia:`https://nl.wikipedia.org/wiki/${z.wikipedia.replace("nl:","")}`;Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bronnen</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1"><a href="${Je}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`}}if(z.bron==="Paleobiology Database"){const Q=Ue=>{const nt={Mollusca:"weekdieren zoals schelpen en slakken",Brachiopoda:"armpotigen, schelp-achtige dieren",Echinodermata:"stekelhuidigen zoals zee-egels en zeesterren",Chordata:"gewervelde dieren",Arthropoda:"geleedpotigen zoals kreeften en trilobieten",Cnidaria:"neteldieren zoals koralen en kwallen",Bryozoa:"mosdiertjes",Foraminifera:"eencellige schelpdieren",Plantae:"planten",Crinoidea:"zeelelies",Gastropoda:"slakken",Bivalvia:"tweekleppigen zoals mossels en oesters",Cephalopoda:"koppotigen zoals inktvissen en ammonieten",Trilobita:"trilobieten, uitgestorven kreeftachtigen",Mammalia:"zoogdieren",Reptilia:"reptielen",Pisces:"vissen",Amphibia:"amfibien"};for(const[et,Pt]of Object.entries(nt))if(Ue.toLowerCase().includes(et.toLowerCase()))return Pt;return""},ye=Ue=>{const nt={Cambrium:"541-485 miljoen jaar geleden",Ordovicium:"485-444 miljoen jaar geleden",Siluur:"444-419 miljoen jaar geleden",Devoon:"419-359 miljoen jaar geleden",Carboon:"359-299 miljoen jaar geleden",Perm:"299-252 miljoen jaar geleden",Trias:"252-201 miljoen jaar geleden",Jura:"201-145 miljoen jaar geleden",Krijt:"145-66 miljoen jaar geleden",Paleogeen:"66-23 miljoen jaar geleden",Neogeen:"23-2,6 miljoen jaar geleden",Kwartair:"2,6 miljoen jaar - nu",Pleistoceen:"2,6 miljoen - 11.700 jaar geleden",Holoceen:"11.700 jaar geleden - nu"};for(const[et,Pt]of Object.entries(nt))if(Ue.toLowerCase().includes(et.toLowerCase()))return Pt;return""},De=Ue=>{const nt={limestone:"kalksteen",sandstone:"zandsteen",shale:"schalie",clay:"klei",sand:"zand",gravel:"grind",marl:"mergel",chalk:"krijt",mudstone:"moddersteen",siltstone:"siltsteen"};let et=Ue;for(const[Pt,zt]of Object.entries(nt))et=et.replace(new RegExp(Pt,"gi"),zt);return et},Je=Ue=>{const nt={marine:"zee",coastal:"kust",terrestrial:"land",fluvial:"rivier",lacustrine:"meer",reef:"rif",deltaic:"delta",shallow:"ondiep water",deep:"diep water"};let et=Ue;for(const[Pt,zt]of Object.entries(nt))et=et.replace(new RegExp(Pt,"gi"),zt);return et};if(z.vindplaats&&(Y+=`<br/><span class="text-xs text-gray-600">${z.vindplaats}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',z.taxonomie&&z.taxonomie!=="Onbekend"){const Ue=Q(z.taxonomie);Ue?(Y+=`<div class="text-sm text-gray-700 mt-1">${Ue}</div>`,Y+=`<div class="text-xs text-gray-500 italic">(${z.taxonomie})</div>`):Y+=`<div class="text-sm text-gray-700 mt-1">${z.taxonomie}</div>`}if(z.aantal_fossielen){const Ue=parseInt(z.aantal_fossielen),nt=Ue>100?"Veel fossielen gevonden op deze locatie.":Ue>10?"Meerdere fossielen gevonden op deze locatie.":`${z.aantal_fossielen} fossiel${Ue>1?"en":""} gevonden op deze locatie.`;Y+=`<div class="text-sm text-gray-600 mt-1">${nt}</div>`}if(z.periode&&z.periode!=="Onbekend"){Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wanneer leefden deze dieren?</span></div>';const Ue=ye(z.periode);Y+=`<div class="text-sm text-gray-700 mt-1">${z.periode}</div>`,Ue&&(Y+=`<div class="text-sm text-gray-600">${Ue}</div>`),z.ouderdom&&z.ouderdom!=="Onbekend"&&(Y+=`<div class="text-sm text-gray-600">Ouderdom: ${z.ouderdom}</div>`)}(z.gesteente||z.formatie||z.milieu)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">In wat voor gesteente?</span></div>',z.gesteente&&(Y+=`<div class="text-sm text-gray-700 mt-1">${De(z.gesteente)}</div>`),z.formatie&&(Y+=`<div class="text-sm text-gray-600">Formatie: ${z.formatie}</div>`,z.lid&&(Y+=`<div class="text-sm text-gray-600 ml-3">Lid: ${z.lid}</div>`)),z.milieu&&(Y+=`<div class="text-sm text-gray-600">Leefomgeving: ${Je(z.milieu)}</div>`))}if(z.layerType==="fossielHotspot"){const Q=[];if(z.type&&Q.push(z.type),z.region&&Q.push(z.region),z.country){const ye={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Q.push(ye[z.country]||z.country)}if(Q.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),(z.finds||z.period)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',z.finds&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.finds}</div>`),z.period&&(Y+=`<div class="text-sm text-gray-600 mt-1">Periode: ${z.period}</div>`),z.geology&&(Y+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${z.geology}</div>`)),z.access||z.tips){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',z.access){const De=z.access.toLowerCase().includes("verboden")||z.access.toLowerCase().includes("niet toegankelijk")?"text-red-600":"text-gray-700";Y+=`<div class="text-sm ${De} mt-1">${z.access}</div>`}z.tips&&(Y+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="mineralenHotspot"){const Q=[];if(z.region&&Q.push(z.region),z.country){const ye={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Q.push(ye[z.country]||z.country)}if(Q.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),z.minerals&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.minerals}</div>`,z.geology&&(Y+=`<div class="text-sm text-gray-600 mt-1">Geologie: ${z.geology}</div>`)),z.access||z.tips){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Hoe kom ik er?</span></div>',z.access){const De=z.access.toLowerCase().includes("verboden")||z.access.toLowerCase().includes("niet toegankelijk")||z.access.toLowerCase().includes("gesloten")?"text-red-600":"text-gray-700";Y+=`<div class="text-sm ${De} mt-1">${z.access}</div>`}z.tips&&(Y+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="goudrivier"){const Q=[];if(z.river&&Q.push(z.river),z.region&&Q.push(z.region),z.country){const ye={NL:"Nederland",BE:"Belgi",DE:"Duitsland",FR:"Frankrijk"};Q.push(ye[z.country]||z.country)}if(Q.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),(z.goldType||z.origin)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat kan ik er vinden?</span></div>',z.goldType&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.goldType}</div>`),z.origin&&(Y+=`<div class="text-sm text-gray-600 mt-1">Herkomst: ${z.origin}</div>`)),z.legal||z.tips){if(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Mag ik hier zoeken?</span></div>',z.legal){const De=z.legal.includes("VERBODEN")?"text-red-600 font-semibold":"text-gray-700";Y+=`<div class="text-sm ${De} mt-1">${z.legal}</div>`}z.tips&&(Y+=`<div class="text-sm text-gray-600 mt-1 italic">Tip: ${z.tips}</div>`)}}if(z.layerType==="wandelroute"){const Q=[];if(z.region&&Q.push(z.region),z.country){const ye={NL:"Nederland",BE:"Belgi"};Q.push(ye[z.country]||z.country)}if(Q.length>0&&(Y+=`<br/><span class="text-xs text-gray-600">${Q.join("  ")}</span>`),z.distance||z.duration){const ye=z.distance?`${z.distance} km`:"",De=z.duration?`${z.duration}`:"",Je=[ye,De].filter(Boolean).join("  ");Je&&(Y+=`<br/><span class="text-sm text-green-700 font-medium">${Je}</span>`)}(z.description||z.highlights)&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat ga je zien?</span></div>',z.description&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`),z.highlights&&(Y+=`<div class="text-sm text-gray-600 mt-1">Hoogtepunten: ${z.highlights}</div>`)),z.startAddress&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Waar begin ik?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.startAddress}</div>`),z.url&&(Y+=`<div class="mt-3"><a href="${z.url}" target="_blank" class="text-sm text-blue-600 hover:underline">Bekijk route en download GPX</a></div>`)}if(z.layerType==="hunebed"){z.period&&(Y+=`<br/><span class="text-sm text-purple-700">Periode: ${z.period}</span>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat zie je hier?</span></div>',z.description&&(Y+=`<div class="text-sm text-gray-700 mt-1">${z.description}</div>`);const Q=[];if(z.stones){const ye=z.stones.toLowerCase(),De=ye.match(/(\d+)\s*dekst[^\s,]*/i),Je=ye.match(/(\d+)\s*draagst[^\s,]*/i),Ue=ye.match(/(\d+)\s*sluitst[^\s,]*/i),nt=ye.match(/(\d+)\s*poortst[^\s,]*/i),et=ye.match(/(\d+)\s*gangdekst[^\s,]*/i),Pt=ye.match(/(\d+)\s*gangzijst[^\s,]*/i);De&&Q.push(`${De[1]} deksteen${parseInt(De[1])>1?"en":""} (de grote steen${parseInt(De[1])>1?"en":""} bovenop)`),Je&&Q.push(`${Je[1]} draagstenen (de stenen die de dekstenen dragen)`),Ue&&Q.push(`${Ue[1]} sluitsteen${parseInt(Ue[1])>1?"en":""} (afsluiting aan de korte zijden)`),nt&&Q.push(`${nt[1]} poortsteen${parseInt(nt[1])>1?"en":""} (bij de ingang)`),et&&Q.push(`${et[1]} gangdeksteen${parseInt(et[1])>1?"en":""} (boven de toegangsgang)`),Pt&&Q.push(`${Pt[1]} gangzijstenen (langs de toegangsgang)`)}if(z.length&&Q.push(`Een grafkamer van ${z.length} lang`),z.width&&Q.push(`${z.width}`),Q.length>0&&(Y+='<div class="text-sm text-gray-700 mt-1">Het hunebed heeft:</div>',Y+='<ul class="list-disc list-inside text-sm text-gray-700 mt-1 space-y-0.5">',Q.forEach(ye=>{Y+=`<li>${ye}</li>`}),Y+="</ul>"),z.notable){const ye=z.notable.toLowerCase();let De="Wat is hier bijzonder?";ye.includes("grootste")?De="Waarom is dit het grootste hunebed?":ye.includes("klein")||ye.includes("kindhunebed")?De="Waarom is dit hunebed zo klein?":ye.includes("cluster")||ye.includes("naast elkaar")?De="Waarom liggen hier meerdere hunebedden?":(ye.includes("enige")||ye.includes("westelijk")||ye.includes("noordelijk"))&&(De="Wat maakt deze locatie bijzonder?"),Y+=`<div class="mt-3"><span class="text-sm font-semibold text-gray-800">${De}</span></div>`,Y+=`<div class="text-sm text-gray-700 mt-1">${z.notable}</div>`}Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is de Trechterbeker cultuur?</span></div>',Y+='<div class="text-sm text-gray-700 mt-1">De Trechterbeker cultuur is de naam voor de mensen die 5.000 jaar geleden in Nederland woonden. Ze maakten potten met een trechter-vorm. Daarom heten ze zo. Deze mensen bouwden de hunebedden als graven voor hun doden.</div>',z.finds&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Wat is hier gevonden?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.finds}</div>`),z.museum&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Museum in de buurt</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">${z.museum}</div>`),Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Bezoeken</span></div>',z.access?Y+=`<div class="text-sm text-gray-700 mt-1">${z.access}</div>`:Y+='<div class="text-sm text-gray-700 mt-1">Je kunt dit hunebed gratis bezoeken.</div>',z.wikipedia&&(Y+='<div class="mt-3"><span class="text-sm font-semibold text-gray-800">Meer weten?</span></div>',Y+=`<div class="text-sm text-gray-700 mt-1">Lees meer op <a href="${z.wikipedia}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Wikipedia</a></div>`)}if((z.inventarisnummer||z.locatie_naam)&&(z.locatie_naam&&(Y+=`<br/><span class="text-sm font-semibold">${z.locatie_naam}</span>`),z.inventarisnummer&&(Y+=`<br/><span class="text-xs text-gray-500">CAI: ${z.inventarisnummer}</span>`),z.datering_tekst&&(Y+=`<br/><span class="text-sm text-purple-700">${z.datering_tekst}</span>`)),(z.veensoort||z.dikte)&&(z.veensoort&&(Y+=`<br/><span class="text-sm text-amber-700">${z.veensoort}</span>`),z.dikte&&(Y+=`<br/><span class="text-xs text-gray-600">Dikte: ${z.dikte}</span>`)),z.nature&&z.debut){Y+=`<br/><span class="text-sm text-purple-700">${z.nature}</span>`;const Q=z.debut===z.fin?z.debut:`${z.debut} - ${z.fin}`;Q&&(Y+=`<br/><span class="text-sm text-gray-700">Periode: ${Q}</span>`),z.structure&&(Y+=`<br/><span class="text-xs text-gray-600">${z.structure}</span>`),z.commune&&(Y+=`<br/><span class="text-xs text-gray-500">${z.commune}</span>`),z.decouvert&&(Y+=`<br/><span class="text-xs text-gray-400">Ontdekt: ${z.decouvert}</span>`),z.numero&&(Y+=`<br/><span class="text-xs text-gray-400">${z.numero}</span>`)}if((z.NATURE_OPE||z.CODE_OPERA)&&(z.TITRE&&(Y+=`<br/><span class="text-sm font-semibold">${z.TITRE}</span>`),z.NATURE_OPE&&(Y+=`<br/><span class="text-sm text-amber-700">${z.NATURE_OPE}</span>`),z.AUTEUR&&(Y+=`<br/><span class="text-xs text-gray-600">Auteur: ${z.AUTEUR}</span>`),z.DATE&&(Y+=`<br/><span class="text-xs text-gray-500">Datum: ${z.DATE}</span>`),z.COMMUNE&&(Y+=`<br/><span class="text-xs text-gray-500">${z.COMMUNE}</span>`)),z.type_protection&&(z.n_site||z.t_site)){const Q=z.type_protection==="Classe"?"text-red-700":"text-amber-700";Y+=`<br/><span class="text-sm ${Q}">${z.type_protection}</span>`,z.n_site&&(Y+=`<br/><span class="text-sm font-semibold">${z.n_site}</span>`),z.t_site&&(Y+=`<br/><span class="text-xs text-gray-600">${z.t_site}</span>`),z.c_site&&(Y+=`<br/><span class="text-xs text-gray-500">Code: ${z.c_site}</span>`),z.d_creation&&(Y+=`<br/><span class="text-xs text-gray-400">Beschermd sinds: ${z.d_creation}</span>`)}if(z.type_protection&&z.cod_diren){const Q=z.type_protection==="Classe"?"text-red-700":"text-amber-700";if(Y+=`<br/><span class="text-sm ${Q}">${z.type_protection}</span>`,z.proced&&(Y+=`<br/><span class="text-xs text-gray-600">${z.proced}</span>`),z.d_proced&&(Y+=`<br/><span class="text-xs text-gray-500">Date: ${z.d_proced}</span>`),z.comment){const ye=String(z.comment).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${ye}${String(z.comment).length>150?"...":""}</span>`}}if(z.type_protection&&z.nomsite){const Q=z.type_protection==="Classe"?"text-red-700":"text-amber-700";if(Y+=`<br/><span class="text-sm ${Q}">${z.type_protection}</span>`,z.caractere&&(Y+=`<br/><span class="text-xs text-gray-600">${z.caractere}</span>`),z.datedecis&&(Y+=`<br/><span class="text-xs text-gray-500">Date: ${z.datedecis}</span>`),z.descriptio){const ye=String(z.descriptio).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${ye}${String(z.descriptio).length>150?"...":""}</span>`}}if(z.secteur&&z.style){if(Y+=`<br/><span class="text-sm text-gray-700">${z.secteur}</span>`,z["sous-secteur"]&&(Y+=`<br/><span class="text-xs text-gray-600">${z["sous-secteur"]}</span>`),z.description){const Q=String(z.description).slice(0,150);Y+=`<br/><span class="text-xs text-gray-600 italic">${Q}${String(z.description).length>150?"...":""}</span>`}z.url&&(Y+=`<br/><a href="${z.url}" target="_blank" class="text-xs text-blue-600 hover:underline">Meer info</a>`)}if(z.nature_operation||z.synthese){z.nature_operation&&(Y+=`<br/><span class="text-sm text-red-700">${z.nature_operation}</span>`),z.responsable_operation&&(Y+=`<br/><span class="text-xs text-gray-600">Responsable: ${z.responsable_operation}</span>`),z.date_operation&&(Y+=`<br/><span class="text-xs text-gray-500">Datum: ${z.date_operation}</span>`);const Q=[];if(z.prehistoire==="Oui"&&Q.push("Prehistorie"),z.protohistoire==="Oui"&&Q.push("Protohistorie"),z.antiquite==="Oui"&&Q.push("Romeins"),z.moyen_age==="Oui"&&Q.push("Middeleeuwen"),z.temps_modernes==="Oui"&&Q.push("Moderne tijd"),Q.length>0&&(Y+=`<br/><span class="text-sm text-purple-700">${Q.join(", ")}</span>`),z.adresse&&(Y+=`<br/><span class="text-xs text-gray-500">${z.adresse}</span>`),z.synthese){const ye=String(z.synthese).slice(0,200);Y+=`<br/><span class="text-xs text-gray-600 italic">${ye}${String(z.synthese).length>200?"...":""}</span>`}}if(z.operator&&(Y+=`<br/><span class="text-sm text-gray-600">${z.operator}</span>`),!oe){if(z.opening_hours){const Q=_oe(String(z.opening_hours));Y+=`<br/><span class="text-xs text-green-600">Open: ${Q}</span>`}z.website&&(Y+=`<br/><a href="${z.website}" target="_blank" class="text-xs text-blue-600 underline">Website</a>`)}if(z.addr_street){const Q=[z.addr_street,z.addr_housenumber,z.addr_postcode].filter(Boolean).join(" ");Y+=`<br/><span class="text-xs text-gray-500">${Q}</span>`}const Ve=z.description||z.omschrijving||z.descr||z.info;Ve&&Ve!==bt&&(Y+=`<br/><span class="text-sm text-gray-600">${Ve}</span>`),On.push(Y),Qt.push({geometry:Oo(rn),properties:z,popupHtml:Y})}const Pn=t.getView().getResolution()||1,Ti=await Yn(Ft.coordinate,Pn);On.push(...Ti);for(const Ae of Ti)Qt.push(null);const He=await ji;if(On.length===0&&He!==null){const Ae=`<strong class="text-blue-800">Terrein</strong>
          <br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
            <span class="text-xs text-gray-400">Hoogte:</span>
            <span class="text-sm font-medium text-blue-600">${He.toFixed(2)} m NAP</span>
          </div>`;On.push(Ae),Qt.push(null)}if(On.length>0&&He!==null&&(On[0]+=`<br/><div class="mt-2 pt-2 border-t border-gray-100 flex items-center gap-1">
          <span class="text-xs text-gray-400">Hoogte:</span>
          <span class="text-sm font-medium text-blue-600">${He.toFixed(2)} m NAP</span>
        </div>`),On.length>0){l(On),se(Qt),u(0),console.log(` KLIK OPGESLAGEN: [${Ft.coordinate[0].toFixed(0)}, ${Ft.coordinate[1].toFixed(0)}]`),v(Ft.coordinate),b(!1),B(!1),Ce(!1),W(""),de(null);const Ae=Zn(Ft.coordinate);ze(Ae),N(`https://www.google.com/maps/dir/?api=1&destination=${Ae[1]},${Ae[0]}`),F(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${Ae[1]},${Ae[0]}`),f(!0)}};return t.on("click",cr),()=>{t.un("click",cr)}},[t]);const Si=()=>{f(!1),ke("half"),t&&x&&(XV(t),b(!1))},Rs=(Mt,Yn)=>{const cr=Yn.velocity.y,Ft=Yn.offset.y;Ye==="half"?Ft<-50||cr<-500?ke("full"):(Ft>100||cr>500)&&Si():(Ft>50||cr>300)&&ke("half")};return m.jsx(ar,{children:h&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1500]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:Si}),m.jsxs(Ct.div,{className:"fixed bottom-0 left-0 right-0 z-[1501] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{fontSize:`${14*_e/100}px`,height:Ye==="full"?"90vh":"auto",maxHeight:Ye==="full"?"90vh":"35vh"},initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},drag:"y",dragConstraints:{top:0,bottom:0},dragElastic:.3,onDragEnd:Rs,children:[m.jsx("div",{className:"flex justify-center pt-2 pb-1 cursor-grab active:cursor-grabbing",onClick:()=>ke(Ye==="half"?"full":"half"),children:m.jsx("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),m.jsxs("div",{className:"flex items-center gap-2 px-3 pb-2 border-b border-gray-100",children:[qe&&m.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[m.jsx("button",{onClick:Un,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Vorige laag",children:m.jsx(owe,{size:18})}),m.jsxs("span",{className:"text-gray-500 font-medium min-w-[32px] text-center",style:{fontSize:"0.857em"},children:[c+1,"/",a.length]}),m.jsx("button",{onClick:Xr,className:"p-1 text-blue-500 hover:text-blue-600 transition-colors border-0 outline-none bg-transparent","aria-label":"Volgende laag",children:m.jsx(lb,{size:18})})]}),m.jsx("span",{className:"flex-1 font-semibold text-gray-800 truncate",style:{fontSize:"1em"},children:fn||"Info"}),me&&m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>B(!L),className:`p-1.5 transition-colors flex-shrink-0 border-0 outline-none bg-transparent ${U?"text-green-500":"text-orange-500 hover:text-orange-600"}`,title:"Toevoegen aan mijn laag","aria-label":"Toevoegen aan mijn laag",children:U?m.jsx(up,{size:18}):m.jsx(uu,{size:18})}),L&&m.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white rounded-lg shadow-lg border border-gray-200 py-1 min-w-[180px] max-w-[220px]",children:[m.jsx("div",{className:"px-3 py-1 text-xs text-gray-400 font-medium",children:"Toevoegen aan:"}),m.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:i.filter(Mt=>!Mt.archived).map(Mt=>m.jsxs("button",{onClick:()=>{const Yn=ae;s(Mt.id,{name:fn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[me[0],me[1]],sourceLayer:fn,geometry:Yn?.geometry,sourceProperties:Yn?.properties,popupContent:Yn?.popupHtml}),B(!1),de(Mt.name),setTimeout(()=>de(null),2e3)},className:"w-full px-3 py-1.5 text-left text-sm text-gray-700 hover:bg-blue-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx("span",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:Mt.color}}),m.jsx("span",{className:"truncate",children:Mt.name})]},Mt.id))}),m.jsx("div",{className:"border-t border-gray-100 mt-1 pt-1",children:$e?m.jsxs("div",{className:"px-2 py-1",children:[m.jsx("input",{type:"text",value:le,onChange:Mt=>W(Mt.target.value),placeholder:"Naam nieuwe laag...",className:"w-full px-2 py-1 text-sm border border-gray-200 rounded focus:outline-none focus:border-orange-400",autoFocus:!0,onKeyDown:Mt=>{if(Mt.key==="Enter"&&le.trim()){const Yn=o(le.trim()),cr=ae;s(Yn,{name:fn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[me[0],me[1]],sourceLayer:fn,geometry:cr?.geometry,sourceProperties:cr?.properties,popupContent:cr?.popupHtml}),B(!1),Ce(!1),W(""),de(le.trim()),setTimeout(()=>de(null),2e3)}else Mt.key==="Escape"&&(Ce(!1),W(""))}}),m.jsxs("div",{className:"flex gap-1 mt-1",children:[m.jsx("button",{onClick:()=>{if(le.trim()){const Mt=o(le.trim()),Yn=ae;s(Mt,{name:fn||"Punt",category:"Overig",notes:"",url:void 0,coordinates:[me[0],me[1]],sourceLayer:fn,geometry:Yn?.geometry,sourceProperties:Yn?.properties,popupContent:Yn?.popupHtml}),B(!1),Ce(!1),W(""),de(le.trim()),setTimeout(()=>de(null),2e3)}},disabled:!le.trim(),className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded disabled:opacity-50",children:"Toevoegen"}),m.jsx("button",{onClick:()=>{Ce(!1),W("")},className:"px-2 py-1 text-xs text-gray-500 hover:text-gray-700",children:"Annuleer"})]})]}):m.jsxs("button",{onClick:()=>Ce(!0),className:"w-full px-3 py-1.5 text-left text-sm text-orange-600 hover:bg-orange-50 border-0 outline-none bg-transparent flex items-center gap-2",children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe laag maken..."})]})})]})]}),O&&m.jsx("a",{href:O,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-amber-500 hover:text-amber-600 transition-colors flex-shrink-0",title:"Open Street View","aria-label":"Open Street View",children:m.jsx(fwe,{size:18})}),M&&m.jsx("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 text-blue-500 hover:text-blue-600 transition-colors flex-shrink-0",title:"Navigeer naar locatie","aria-label":"Open in Google Maps",children:m.jsx(vg,{size:18})}),m.jsx("button",{onClick:Si,className:"p-1.5 text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0 border-0 outline-none bg-transparent","aria-label":"Sluiten",children:m.jsx(Ei,{size:18})})]}),m.jsx("div",{className:`px-4 py-3 overflow-y-auto select-text min-h-0 ${Ye==="full"?"flex-1":""}`,style:{userSelect:"text",WebkitUserSelect:"text"},dangerouslySetInnerHTML:{__html:dt}}),m.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 flex items-center gap-2 flex-shrink-0",children:[m.jsx(rH,{size:14,className:"text-gray-400 flex-shrink-0"}),m.jsx("input",{type:"range",min:"80",max:"150",value:_e,onChange:Mt=>Te(parseInt(Mt.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsxs("span",{className:"text-gray-400 w-8 text-right",style:{fontSize:"0.857em"},children:[_e,"%"]})]}),$n&&I&&!C&&m.jsxs("div",{className:"px-4 pb-4 flex gap-2 flex-shrink-0",children:[m.jsxs("button",{onClick:()=>{const Mt=r.find(Yn=>Yn.id===I);Mt&&V(Mt)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(k2,{size:16}),m.jsx("span",{children:"Bewerken"})]}),m.jsxs("button",{onClick:()=>{e(I),f(!1),R(null)},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white bg-red-500 hover:bg-red-600 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(wp,{size:16}),m.jsx("span",{children:"Verwijderen"})]})]}),C&&m.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-100 pt-3 flex-shrink-0 overflow-y-auto max-h-[40vh]",children:[m.jsx("div",{className:"text-sm font-medium text-blue-600",children:"Vondst bewerken"}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Objecttype"}),m.jsx("input",{type:"text",value:C.objectType,onChange:Mt=>V({...C,objectType:Mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Materiaal"}),m.jsx("input",{type:"text",value:C.material,onChange:Mt=>V({...C,material:Mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Periode"}),m.jsx("input",{type:"text",value:C.period,onChange:Mt=>V({...C,period:Mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-gray-500",children:"Notities"}),m.jsx("textarea",{value:C.notes,onChange:Mt=>V({...C,notes:Mt.target.value}),className:"w-full px-2 py-1 text-sm bg-gray-50 rounded border-0 outline-none focus:bg-blue-50 resize-none h-16"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:()=>V(null),className:"flex-1 px-3 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none text-sm",children:"Annuleren"}),m.jsx("button",{onClick:()=>{n(C.id,{objectType:C.objectType,material:C.material,period:C.period,notes:C.notes}),V(null),f(!1)},className:"flex-1 px-3 py-2 text-white bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors border-0 outline-none text-sm",children:"Opslaan"})]})]}),lr&&g&&m.jsx("div",{className:"px-4 pb-4 border-t border-gray-100",children:x?m.jsxs("button",{onClick:kr,className:"w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:[m.jsx(T2,{size:16}),m.jsx("span",{children:"Hoogtekaart verbergen"})]}):m.jsx("button",{onClick:fo,disabled:T,className:`w-full flex items-center justify-center gap-2 px-3 py-2 mt-3 text-white rounded-lg transition-colors border-0 outline-none ${T?"bg-blue-400 cursor-wait":"bg-blue-500 hover:bg-blue-600"}`,children:T?m.jsxs(m.Fragment,{children:[m.jsx(eH,{size:16,className:"animate-spin"}),m.jsx("span",{children:"Laden..."})]}):m.jsxs(m.Fragment,{children:[m.jsx(T2,{size:16}),m.jsx("span",{children:"Hoogtekaart tonen"})]})})})]})]})})}const woe=1e-4;function AEt(t,e){return t.points.some(n=>{const r=Math.abs(n.coordinates[0]-e[0]),i=Math.abs(n.coordinates[1]-e[1]);return r<woe&&i<woe})}function IEt(){const t=es(F=>F.map),e=ri(F=>F.openVondstForm),{openAddPointModal:n,openCreateLayerModal:r,openLayerManagerModal:i}=ri(),s=Po(F=>F.layers),[o,a]=X.useState(null),[l,c]=X.useState(!1),[u,h]=X.useState(!1),[f,g]=X.useState(!1),v=X.useRef(null),x=X.useRef(null);X.useEffect(()=>{if(!t){console.log(" LongPressMenu: map not ready");return}const F=t.getViewport();if(!F){console.log(" LongPressMenu: viewport not ready");return}console.log(" LongPressMenu: attached to viewport",F);const L=600,B=15,U=Ce=>{if(console.log(" Touch start, touches:",Ce.touches.length),Ce.touches.length!==1)return;const le=Ce.touches[0];x.current={x:le.clientX,y:le.clientY},console.log(" Starting long press timer at:",x.current),v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Timer fired! startPos:",x.current),!x.current)return;const W=window.__olMap;if(!W){console.log(" Map not available (global)");return}const ne=F.getBoundingClientRect(),se=[x.current.x-ne.left,x.current.y-ne.top],ae=W.getCoordinateFromPixel(se);if(ae){const _e=Zn(ae);Ce.preventDefault(),a({pixel:[x.current.x,x.current.y],coordinate:_e}),c(!0),h(!1),setTimeout(()=>h(!0),300),"vibrate"in navigator&&navigator.vibrate(50),console.log(" Long press detected at:",_e)}},L)},de=Ce=>{if(!v.current||!x.current)return;const le=Ce.touches[0],W=le.clientX-x.current.x,ne=le.clientY-x.current.y,se=Math.sqrt(W*W+ne*ne);se>B&&(console.log(" Touch moved too much, cancelling. Distance:",se),clearTimeout(v.current),v.current=null)},me=()=>{console.log(" Touch end, timer active:",!!v.current),v.current&&(console.log(" Cancelling timer on touch end"),clearTimeout(v.current),v.current=null),x.current=null},ze=Ce=>{l&&Ce.preventDefault()},Le=Ce=>{Ce.button===0&&(console.log(" Mouse down"),x.current={x:Ce.clientX,y:Ce.clientY},v.current&&clearTimeout(v.current),v.current=window.setTimeout(()=>{if(console.log(" Mouse timer fired!"),!x.current)return;const le=window.__olMap;if(console.log(" __olMap:",le),console.log(" __olMap constructor:",le?.constructor?.name),console.log(" has getCoordinateAtPixel:",typeof le?.getCoordinateAtPixel),!le){console.log(" Map not available (global)");return}const W=F.getBoundingClientRect(),ne=[x.current.x-W.left,x.current.y-W.top];console.log(" Pixel:",ne);const se=le.getCoordinateFromPixel(ne);if(console.log(" Coordinate:",se),se){const ae=Zn(se);a({pixel:[x.current.x,x.current.y],coordinate:ae}),c(!0),h(!1),setTimeout(()=>h(!0),300),console.log(" Long press (mouse) detected at:",ae)}},L))},fe=Ce=>{if(!v.current||!x.current)return;const le=Ce.clientX-x.current.x,W=Ce.clientY-x.current.y;Math.sqrt(le*le+W*W)>B&&(console.log(" Mouse moved, cancelling"),clearTimeout(v.current),v.current=null)},$e=()=>{console.log(" Mouse up"),v.current&&(clearTimeout(v.current),v.current=null),x.current=null};return F.addEventListener("touchstart",U,{passive:!1}),F.addEventListener("touchmove",de,{passive:!0}),F.addEventListener("touchend",me),F.addEventListener("touchcancel",me),F.addEventListener("contextmenu",ze),F.addEventListener("mousedown",Le),F.addEventListener("mousemove",fe),F.addEventListener("mouseup",$e),F.addEventListener("mouseleave",$e),()=>{F.removeEventListener("touchstart",U),F.removeEventListener("touchmove",de),F.removeEventListener("touchend",me),F.removeEventListener("touchcancel",me),F.removeEventListener("contextmenu",ze),F.removeEventListener("mousedown",Le),F.removeEventListener("mousemove",fe),F.removeEventListener("mouseup",$e),F.removeEventListener("mouseleave",$e),v.current&&clearTimeout(v.current)}},[t,l]);const b=()=>{u&&(c(!1),a(null),h(!1),g(!1))},T=()=>{c(!1),a(null),h(!1),g(!1)},A=F=>{if(!o)return;const[L,B]=o.coordinate;n(F,{lat:B,lng:L}),T()},I=()=>{r(),T()},R=()=>{if(!o)return;const[F,L]=o.coordinate;e({lat:L,lng:F}),c(!1),a(null),h(!1)},C=()=>{if(!o)return;const[F,L]=o.coordinate,B=`https://www.google.com/maps?q=${L},${F}`;window.open(B,"_blank"),c(!1),a(null),h(!1)},V=()=>{if(!o)return;const[F,L]=o.coordinate,B=`https://www.google.com/maps?layer=c&cbll=${L},${F}`;window.open(B,"_blank"),T()},M=()=>{if(!o)return;const F=document.createElement("input");F.type="file",F.accept="image/*",F.capture="environment",F.onchange=async L=>{const B=L.target.files?.[0];if(!B)return;const[U,de]=o.coordinate;e({lat:de,lng:U},B)},F.click(),T()},N=()=>{i(),T()},O=F=>{const[L,B]=F;return`${B.toFixed(5)}N, ${L.toFixed(5)}E`};return m.jsx(ar,{children:l&&o&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:b}),m.jsxs(Ct.div,{className:"fixed z-[1601] bg-white rounded-xl shadow-md overflow-hidden min-w-[200px] border-0 outline-none",style:{left:Math.min(o.pixel[0],window.innerWidth-220),top:(()=>{const F=f?480:380;return window.innerHeight-o.pixel[1]<F&&o.pixel[1]>F?o.pixel[1]-F+40:Math.min(o.pixel[1],window.innerHeight-F)})()},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.15},children:[m.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[m.jsx(fc,{size:16}),m.jsx("span",{className:"text-xs font-mono",children:O(o.coordinate)})]})}),m.jsxs("div",{className:"bg-white",children:[m.jsxs("button",{onClick:R,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-orange-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(aN,{size:20,className:"text-orange-500"}),m.jsx("span",{className:"font-medium",children:"Vondst toevoegen"})]}),m.jsxs("button",{onClick:M,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-green-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(KO,{size:20,className:"text-green-500"}),m.jsx("span",{className:"font-medium",children:"Foto maken"})]}),m.jsxs("div",{className:"relative",children:[m.jsxs("button",{onClick:()=>g(!f),className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(nu,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium flex-1 text-left",children:"Voeg toe aan laag..."}),m.jsx(lb,{size:16,className:`text-gray-400 transition-transform ${f?"rotate-90":""}`})]}),m.jsx(ar,{children:f&&m.jsx(Ct.div,{className:"bg-gray-50 border-t border-gray-100",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:s.length===0?m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none",children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Maak eerst een laag aan"})]}):m.jsxs(m.Fragment,{children:[s.map(F=>{const L=o?AEt(F,o.coordinate):!1;return m.jsxs("button",{onClick:()=>!L&&A(F.id),className:`w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm bg-transparent border-0 outline-none ${L?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,title:L?"Al toegevoegd aan deze laag":void 0,disabled:L,children:[L&&m.jsx(up,{size:14,className:"text-green-500 flex-shrink-0"}),m.jsx("span",{className:"truncate",children:F.name}),m.jsx("span",{className:"text-xs text-gray-400 ml-auto",children:L?"al toegevoegd":`(${F.points.length})`})]},F.id)}),m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 pl-11 flex items-center gap-2 text-sm text-purple-600 hover:bg-purple-50 bg-transparent border-0 outline-none border-t border-gray-200",children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe laag..."})]})]})})})]}),m.jsxs("button",{onClick:N,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-purple-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(Ict,{size:20,className:"text-purple-500"}),m.jsx("span",{className:"font-medium",children:"Lagen beheren"})]}),m.jsxs("button",{onClick:C,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-blue-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(vg,{size:20,className:"text-blue-600"}),m.jsx("span",{className:"font-medium",children:"Open in Google Maps"})]}),m.jsxs("button",{onClick:V,className:"w-full px-4 py-3 flex items-center gap-3 transition-colors hover:bg-yellow-50 text-gray-700 bg-white border-0 outline-none",children:[m.jsx(fwe,{size:20,className:"text-yellow-600"}),m.jsx("span",{className:"font-medium",children:"Street View"})]})]}),m.jsx("div",{className:"bg-white",children:m.jsxs("button",{onClick:T,className:"w-full px-4 py-3 flex items-center justify-center gap-2 text-gray-500 hover:bg-blue-50 transition-colors bg-white border-0 outline-none",children:[m.jsx(Ei,{size:18}),m.jsx("span",{children:"Annuleren"})]})})]})]})})}const REt={Compass:flt,TreePalm:Zct,Mountain:T2,Waves:lut,Search:dN,Target:Hct,Layers:nu,Grid:lwe},PEt={Compass:"text-purple-600",Waves:"text-cyan-600",TreePalm:"text-green-600",Mountain:"text-stone-600",Search:"text-amber-600",Target:"text-red-600",Layers:"text-blue-600",Grid:"text-lime-600"},MEt={Compass:"hover:bg-purple-50",Waves:"hover:bg-cyan-50",TreePalm:"hover:bg-green-50",Mountain:"hover:bg-stone-50",Search:"hover:bg-amber-50",Target:"hover:bg-red-50",Layers:"hover:bg-blue-50",Grid:"hover:bg-lime-50"},boe=["Mijn Vondsten","Labels Overlay","TMK 1850","Bonnebladen 1900","Hunebedden","FAMKE Steentijd","FAMKE IJzertijd","Grafheuvels","Terpen","AMK Monumenten","AMK Romeins","AMK Steentijd","AMK Vroege ME","AMK Late ME","AMK Overig","Romeinse wegen (regio)","Romeinse wegen (Wereld)","Romeinse Forten","Romeinse Forten Lijnen","Kastelen","IKAW","Archeo Onderzoeken","Rijksmonumenten","Werelderfgoed","Religieus Erfgoed","Essen","Runes","WWII Bunkers","Slagvelden","Militaire Vliegvelden","Verdedigingslinies","Inundatiegebieden","Militaire Objecten","Paleokaart 800 n.Chr.","Paleokaart 100 n.Chr.","Paleokaart 500 v.Chr.","Paleokaart 1500 v.Chr.","Paleokaart 2750 v.Chr.","Paleokaart 5500 v.Chr.","Paleokaart 9000 v.Chr.","UIKAV Punten","UIKAV Vlakken","UIKAV Expert","UIKAV Buffer","UIKAV Indeling","Hoogtekaart (WebGL)","AHN4 Hoogtekaart Kleur","AHN4 Hillshade NL","AHN4 Multi-Hillshade NL","AHN 0.5m","Veengebieden","Geomorfologie","Bodemkaart","Fossiel Hotspots","Mineralen Hotspots","Goudrivieren","Fossielen Nederland","Fossielen Belgi","Fossielen Duitsland","Fossielen Frankrijk","Parken","Speeltuinen","Musea","Strandjes","Kringloopwinkels","Ruiterpaden","Laarzenpaden","Gewaspercelen","Kadastrale Grenzen","Scheepswrakken","Woonheuvels ZH","Windmolens","Erfgoedlijnen","Oude Kernen","Relictenkaart Punten","Relictenkaart Lijnen","Relictenkaart Vlakken","Verdronken Dorpen"],CEt=["CartoDB (licht)","OpenStreetMap","Luchtfoto","TMK 1850","Bonnebladen 1900"],NEt=[5.2913,52.1326],OEt=8;function LEt(){const t=io(L=>L.setLayerVisibility),e=bs(L=>L.stopTracking),n=es(L=>L.map),{presetsPanelOpen:r,togglePresetsPanel:i,closeAllPanels:s}=ri(),{presets:o,applyPreset:a,updatePreset:l,createPreset:c,resetToDefaults:u}=qhe(),h=io(L=>L.visible),f=Nn(L=>L.presetPanelFontScale),g=Nn(L=>L.setPresetPanelFontScale),v=Nn(L=>L.showFontSliders),x=12*f/100,[b,T]=X.useState(null),[A,I]=X.useState(!1),[R,C]=X.useState(""),V=()=>{s(),boe.forEach(L=>t(L,!1)),CEt.forEach(L=>{t(L,L==="CartoDB (licht)")}),e(),n&&n.getView().animate({center:Pi(NEt),zoom:OEt,duration:500}),console.log(" Reset: CartoDB, alle lagen uit, GPS uit, zoom naar Nederland")},M=L=>{a(L),s()},N=(L,B)=>{L.stopPropagation();const U=Object.entries(h).filter(([de,me])=>me&&boe.includes(de)).map(([de])=>de);l(B,{layers:U}),T(B),setTimeout(()=>T(null),2e3),console.log(" Lagen opgeslagen naar preset")},O=()=>{R.trim()&&(c(R.trim(),"Layers"),C(""),I(!1))},F=()=>{confirm("Alle presets terugzetten naar standaard? Dit verwijdert aangepaste presets.")&&u()};return m.jsxs(m.Fragment,{children:[m.jsx(Ct.button,{onClick:V,className:"fixed bottom-2 left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Reset - CartoDB, alle lagen uit, GPS uit",children:m.jsx(yct,{size:20,className:"text-gray-600"})}),m.jsx(Ct.button,{onClick:i,className:"fixed bottom-[60px] left-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},title:"Presets",children:r?m.jsx(YO,{size:20,className:"text-blue-600"}):m.jsx(nu,{size:20,className:"text-blue-600"})}),m.jsx(ar,{children:r&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[800]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:i}),m.jsxs(Ct.div,{initial:{opacity:0,x:-10,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-10,scale:.95},transition:{duration:.15},className:"fixed bottom-[60px] left-[56px] bg-white/95 rounded-xl shadow-lg overflow-hidden w-[240px] backdrop-blur-sm z-[801]",children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",style:{fontSize:`${x}px`},children:[m.jsx("span",{className:"font-medium text-white",children:"Presets"}),v&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:f,onInput:L=>{g(parseInt(L.target.value))},onChange:L=>g(parseInt(L.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${f}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),m.jsx("div",{className:"p-2 max-h-[300px] overflow-y-auto",children:o.map(L=>{const B=REt[L.icon]||nu,U=PEt[L.icon]||"text-blue-600",de=MEt[L.icon]||"hover:bg-blue-50",me=b===L.id;return m.jsxs("button",{onClick:()=>M(L.id),className:`w-full h-8 flex items-center gap-2 px-2 ${de} rounded text-left transition-colors border-0 outline-none bg-transparent overflow-hidden ${me?"bg-green-50":""}`,style:{fontSize:`${x}px`},children:[m.jsx(B,{size:14,className:`${U} flex-shrink-0`}),m.jsx("span",{className:"text-gray-700 truncate flex-1",children:L.name}),me?m.jsx("span",{className:"ml-auto p-1 flex-shrink-0",children:m.jsx(up,{size:14,className:"text-green-500"})}):m.jsx("span",{onClick:ze=>N(ze,L.id),className:"ml-auto p-1 hover:bg-gray-200 rounded transition-colors flex-shrink-0",title:"Huidige lagen opslaan naar deze preset",children:m.jsx(mwe,{size:12,className:"text-gray-400 hover:text-blue-500"})})]},L.id)})}),m.jsx("div",{className:"border-t border-gray-200 p-2",children:A?m.jsxs("div",{className:"flex gap-1",children:[m.jsx("input",{type:"text",value:R,onChange:L=>C(L.target.value),onKeyDown:L=>{L.key==="Enter"&&O(),L.key==="Escape"&&I(!1)},placeholder:"Naam preset...",autoFocus:!0,className:"flex-1 px-2 py-1 text-sm rounded bg-gray-50 border-0 outline-none focus:ring-1 focus:ring-blue-400",style:{fontSize:`${x}px`}}),m.jsx("button",{onClick:O,disabled:!R.trim(),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm disabled:opacity-50 border-0 outline-none",children:m.jsx(up,{size:14})})]}):m.jsxs("div",{className:"flex gap-1",children:[m.jsxs("button",{onClick:()=>I(!0),className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",style:{fontSize:`${x}px`},children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe preset"})]}),m.jsx("button",{onClick:F,className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-colors border-0 outline-none",title:"Presets terugzetten naar standaard",children:m.jsx(_ct,{size:14})})]})})]})]})})]})}function DEt(){const t=es(o=>o.map),[e,n]=X.useState(0),[r,i]=X.useState(!1);X.useEffect(()=>{if(!t)return;const o=t.getView(),a=()=>{const l=o.getRotation(),c=l*180/Math.PI;n(c),i(Math.abs(l)>.087)};return a(),o.on("change:rotation",a),()=>{o.un("change:rotation",a)}},[t]);const s=()=>{t&&t.getView().animate({rotation:0,duration:300})};return m.jsx(ar,{children:r&&m.jsx(Ct.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},onClick:s,className:"fixed top-[60px] right-2 z-[800] w-11 h-11 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",title:"Klik om noorden te herstellen",children:m.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",style:{transform:`rotate(${-e}deg)`},children:[m.jsx("path",{d:"M12 2 L14.5 12 L12 10 L9.5 12 Z",fill:"#EA4335"}),m.jsx("path",{d:"M12 22 L9.5 12 L12 14 L14.5 12 Z",fill:"white",stroke:"#9CA3AF",strokeWidth:"0.5"}),m.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"#374151"})]})})})}const $Et=[{name:"AHN4 Hoogtekaart Kleur",color:"blue",default:.85},{name:"AHN4 Hillshade NL",color:"blue",default:.7},{name:"AHN4 Multi-Hillshade NL",color:"blue",default:.7},{name:"AHN 0.5m",color:"blue",default:.7},{name:"TMK 1850",color:"amber",default:.8},{name:"Bonnebladen 1900",color:"amber",default:.8},{name:"Geomorfologie",color:"green",default:.5},{name:"Bodemkaart",color:"amber",default:.6},{name:"Veengebieden",color:"amber",default:.6},{name:"IKAW",color:"orange",default:.5},{name:"Archeo Landschappen",color:"green",default:.5},{name:"Terpen",color:"orange",default:.7},{name:"Essen",color:"amber",default:.6},{name:"AMK Monumenten",color:"purple",default:.45},{name:"AMK Romeins",color:"red",default:.6},{name:"AMK Steentijd",color:"amber",default:.6},{name:"AMK Vroege ME",color:"green",default:.6},{name:"AMK Late ME",color:"blue",default:.6},{name:"AMK Overig",color:"purple",default:.6},{name:"Paleokaart 9000 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 5500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 2750 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 1500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 500 v.Chr.",color:"indigo",default:.7},{name:"Paleokaart 100 n.Chr.",color:"indigo",default:.7},{name:"Paleokaart 800 n.Chr.",color:"indigo",default:.7},{name:"Verdedigingslinies",color:"red",default:.7},{name:"Inundatiegebieden",color:"red",default:.5},{name:"Gewaspercelen",color:"green",default:.6},{name:"Erfgoedlijnen",color:"purple",default:.7},{name:"Oude Kernen",color:"orange",default:.6},{name:"Relictenkaart Vlakken",color:"green",default:.5}],jEt={blue:"accent-blue-500",amber:"accent-amber-500",red:"accent-red-500",indigo:"accent-indigo-500",green:"accent-green-500",orange:"accent-orange-500",purple:"accent-purple-500"};function FEt(){const[t,e]=X.useState(!1),[n,r]=X.useState(!1),i=io(u=>u.visible),s=io(u=>u.opacity),o=io(u=>u.setLayerOpacity),a=$Et.filter(u=>i[u.name]);if(a.length===0)return null;const l=n?a:a.slice(0,3),c=a.length>3;return m.jsxs("div",{className:"fixed bottom-[112px] right-2 z-[900]",children:[m.jsxs(Ct.button,{onClick:()=>e(!t),className:"w-11 h-11 bg-white/80 rounded-xl backdrop-blur-sm shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none hover:bg-white/90 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":"Opacity sliders",title:t?"Sluit opacity sliders":"Open opacity sliders",children:[m.jsx(Oct,{size:22,strokeWidth:2,className:"text-gray-500"}),a.length>0&&m.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 text-white text-[10px] rounded-full flex items-center justify-center",children:a.length})]}),m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)}),m.jsxs(Ct.div,{initial:{opacity:0,x:20,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:20,scale:.9},transition:{duration:.2},className:"absolute bottom-0 right-14 bg-white/95 rounded-lg shadow-lg p-3 min-w-[220px] max-h-[60vh] overflow-y-auto",children:[m.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2 uppercase tracking-wide",children:"Transparantie"}),m.jsx("div",{className:"space-y-3",children:l.map(u=>{const h=s[u.name]??u.default;return m.jsxs("div",{children:[m.jsx("label",{className:"text-xs font-medium text-gray-700 mb-1 block truncate",title:u.name,children:u.name}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"range",min:"0",max:"100",value:h*100,onChange:f=>o(u.name,parseInt(f.target.value)/100),className:`flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer ${jEt[u.color]}`}),m.jsxs("span",{className:"text-xs text-gray-500 w-8 text-right select-none pointer-events-none",children:[Math.round(h*100),"%"]})]})]},u.name)})}),c&&m.jsx("button",{onClick:()=>r(!n),className:"w-full mt-3 pt-2 border-t border-gray-200 flex items-center justify-center gap-1 text-xs text-gray-500 hover:text-gray-700",children:n?m.jsxs(m.Fragment,{children:[m.jsx(YO,{size:14}),"Minder tonen"]}):m.jsxs(m.Fragment,{children:[m.jsx(ab,{size:14}),a.length-3," meer..."]})})]})]})})]})}function VEt(){const t=es(C=>C.map),e=Nn(C=>C.showWeatherButton),[n,r]=X.useState(!1),[i,s]=X.useState(""),[o,a]=X.useState([]),[l,c]=X.useState(!1),[u,h]=X.useState(!1),f=X.useRef(null),g=X.useRef(null),v=X.useRef();X.useEffect(()=>{n&&f.current&&f.current.focus()},[n]),X.useEffect(()=>{if(!n)return;const C=V=>{g.current&&!g.current.contains(V.target)&&x()};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[n]),X.useEffect(()=>{if(!n)return;const C=V=>{V.key==="Escape"&&x()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[n]),X.useEffect(()=>{if(v.current&&clearTimeout(v.current),i.length<2){a([]);return}return v.current=window.setTimeout(async()=>{h(!0);try{const V=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/suggest?q=${encodeURIComponent(i)}&rows=7`)).json();V.response?.docs&&a(V.response.docs)}catch(C){console.error("Search error:",C),a([])}finally{h(!1)}},300),()=>{v.current&&clearTimeout(v.current)}},[i]);const x=()=>{r(!1),s(""),a([]),c(!1)},b=async C=>{try{const M=await(await fetch(`https://api.pdok.nl/bzk/locatieserver/search/v3_1/lookup?id=${encodeURIComponent(C)}`)).json();if(M.response?.docs?.[0]?.centroide_ll){const O=M.response.docs[0].centroide_ll.match(/POINT\(([^ ]+) ([^)]+)\)/);if(O)return{lng:parseFloat(O[1]),lat:parseFloat(O[2])}}}catch(V){console.error("Lookup error:",V)}return null},T=async C=>{if(!t)return;const V=await b(C.id);V&&t.getView().animate({center:Pi([V.lng,V.lat]),zoom:16,duration:1e3}),x()},A=async(C,V)=>{V.stopPropagation();const M=await b(C.id);if(M){const N=`https://www.google.com/maps?q=${M.lat},${M.lng}`;window.open(N,"_blank")}x()},I={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"};if(!n)return m.jsx(Ct.button,{className:"fixed right-14 z-[800] w-11 h-11 flex items-center justify-center bg-white/90 hover:bg-white rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",style:I,onClick:()=>r(!0),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Zoeken",children:m.jsx(dN,{size:22,className:"text-gray-600"})});const R=e?"220px":"52px";return m.jsxs("div",{ref:g,className:"fixed right-14 z-[850]",style:{...I,left:R},children:[m.jsxs(Ct.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"search-input-wrapper",children:[m.jsx(dN,{size:18,className:"search-icon"}),m.jsx("input",{ref:f,type:"text",value:i,onChange:C=>{s(C.target.value),c(!0)},onFocus:()=>c(!0),placeholder:"Zoek adres of plaats...",className:"search-input"}),m.jsx("button",{onClick:x,className:"search-clear",title:"Sluiten",children:m.jsx(Ei,{size:18})})]}),m.jsx(ar,{children:l&&o.length>0&&m.jsx(Ct.ul,{className:"search-results",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},children:o.map(C=>m.jsxs("li",{className:"search-result-item",children:[m.jsx("div",{className:"search-result-content",onClick:()=>T(C),children:m.jsx("span",{className:"search-result-text",children:C.weergavenaam})}),m.jsx("button",{className:"search-navigate-btn",onClick:V=>A(C,V),title:"Open in Google Maps",children:m.jsx(vg,{size:20})})]},C.id))})}),l&&u&&m.jsx("div",{className:"search-loading",children:"Zoeken..."})]})}function zEt(){const t=es(o=>o.map),[e,n]=X.useState(!1);X.useEffect(()=>{if(!t)return;const o=t.getView(),a=()=>{const l=o.getRotation();n(Math.abs(l)>.087)};return a(),o.on("change:rotation",a),()=>{o.un("change:rotation",a)}},[t]);const r=()=>{if(!t)return;const o=t.getView(),a=o.getZoom();a!==void 0&&o.animate({zoom:a+1,duration:200})},i=()=>{if(!t)return;const o=t.getView(),a=o.getZoom();a!==void 0&&o.animate({zoom:a-1,duration:200})},s=e?"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 112px)":"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)";return m.jsxs(Ct.div,{className:"fixed right-2 z-[800] flex flex-col gap-1",style:{top:s},animate:{top:s},transition:{duration:.2},children:[m.jsx(Ct.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:r,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Inzoomen",children:m.jsx(uu,{size:18,className:"text-gray-600"})}),m.jsx(Ct.button,{className:"w-9 h-9 flex items-center justify-center bg-white/80 hover:bg-white/90 rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm",onClick:i,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Uitzoomen",children:m.jsx(hwe,{size:18,className:"text-gray-600"})})]})}const UEt="detector2024",tz="detectorapp-auth";function GEt({children:t}){const[e,n]=X.useState(!1),[r,i]=X.useState(""),[s,o]=X.useState(!1),[a,l]=X.useState(""),[c,u]=X.useState(!0);X.useEffect(()=>{localStorage.getItem(tz)==="authenticated"&&n(!0),u(!1)},[]);const h=f=>{f.preventDefault(),l(""),r===UEt?(localStorage.setItem(tz,"authenticated"),n(!0)):(l("Onjuist wachtwoord"),i(""))};return c?m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center",children:m.jsx("div",{className:"text-white text-lg",children:"Laden..."})}):e?m.jsx(m.Fragment,{children:t}):m.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-blue-600 to-blue-800 flex items-center justify-center p-4",children:m.jsxs(Ct.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:m.jsx(OV,{size:32,className:"text-blue-600"})}),m.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"DetectorApp"}),m.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Test versie - Toegang beveiligd"})]}),m.jsxs("form",{onSubmit:h,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wachtwoord"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{type:s?"text":"password",value:r,onChange:f=>i(f.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none pr-12",placeholder:"Voer wachtwoord in",autoFocus:!0}),m.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?m.jsx(cN,{size:20}):m.jsx(uN,{size:20})})]})]}),a&&m.jsx(Ct.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm text-center",children:a}),m.jsx("button",{type:"submit",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"Inloggen"})]}),m.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"Alleen voor testers"})]})})}function BEt(){localStorage.removeItem(tz),window.location.reload()}function WEt({isOpen:t,onClose:e}){const n=xd(l=>l.vondsten),r={total:n.length,byType:{},byMaterial:{},byPeriod:{},byCondition:{},avgDepth:0,totalWeight:0,recent:n.slice(-5).reverse()};let i=0,s=0;n.forEach(l=>{r.byType[l.objectType]=(r.byType[l.objectType]||0)+1,r.byMaterial[l.material]=(r.byMaterial[l.material]||0)+1,r.byPeriod[l.period]=(r.byPeriod[l.period]||0)+1,l.condition&&(r.byCondition[l.condition]=(r.byCondition[l.condition]||0)+1),l.depth&&(i+=l.depth,s++),l.weight&&(r.totalWeight+=l.weight)}),r.avgDepth=s>0?Math.round(i/s):0;const o=l=>Object.entries(l).sort((c,u)=>u[1]-c[1]),a=l=>Math.max(...Object.values(l),1);return m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(swe,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Vondsten Dashboard"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(Ei,{size:18})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:n.length===0?m.jsxs("div",{className:"text-center py-8 text-gray-500",children:[m.jsx(fc,{size:48,className:"mx-auto mb-3 opacity-30"}),m.jsx("p",{className:"font-medium",children:"Nog geen vondsten"}),m.jsx("p",{className:"text-sm mt-1",children:"Voeg je eerste vondst toe via de oranje knop of long-press op de kaart"})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[m.jsx(L8,{icon:m.jsx(fc,{size:20}),value:r.total,label:"Totaal",color:"bg-orange-100 text-orange-700"}),m.jsx(L8,{icon:m.jsx(Qk,{size:20}),value:r.avgDepth>0?`${r.avgDepth}cm`:"-",label:"Gem. diepte",color:"bg-blue-100 text-blue-700"}),m.jsx(L8,{icon:m.jsx(Sct,{size:20}),value:r.totalWeight>0?`${r.totalWeight.toFixed(1)}g`:"-",label:"Tot. gewicht",color:"bg-green-100 text-green-700"})]}),m.jsx(gM,{title:"Per Type",data:o(r.byType),max:a(r.byType),color:"bg-orange-500"}),m.jsx(gM,{title:"Per Periode",data:o(r.byPeriod),max:a(r.byPeriod),color:"bg-amber-500"}),m.jsx(gM,{title:"Per Materiaal",data:o(r.byMaterial),max:a(r.byMaterial),color:"bg-blue-500"}),Object.keys(r.byCondition).length>0&&m.jsx(gM,{title:"Per Conditie",data:o(r.byCondition),max:a(r.byCondition),color:"bg-green-500"}),m.jsxs("div",{children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[m.jsx(XW,{size:14}),"Recente Vondsten"]}),m.jsx("div",{className:"space-y-2",children:r.recent.map(l=>m.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium text-sm text-gray-800",children:l.objectType}),m.jsx("span",{className:"text-gray-400 mx-1",children:"-"}),m.jsx("span",{className:"text-sm text-gray-600",children:l.material})]}),m.jsx("span",{className:"text-xs text-gray-400",children:new Date(l.timestamp).toLocaleDateString("nl-NL")})]},l.id))})]})]})})]})]})})}function L8({icon:t,value:e,label:n,color:r}){return m.jsxs("div",{className:`rounded-lg p-3 ${r}`,children:[m.jsx("div",{className:"flex items-center gap-2 mb-1 opacity-70",children:t}),m.jsx("div",{className:"text-xl font-bold",children:e}),m.jsx("div",{className:"text-xs opacity-70",children:n})]})}function gM({title:t,data:e,max:n,color:r}){return e.length===0?null:m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:t}),m.jsx("div",{className:"space-y-1.5",children:e.slice(0,6).map(([i,s])=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-24 text-xs text-gray-600 truncate",title:i,children:i}),m.jsx("div",{className:"flex-1 h-4 bg-gray-100 rounded-full overflow-hidden",children:m.jsx(Ct.div,{className:`h-full ${r} rounded-full`,initial:{width:0},animate:{width:`${s/n*100}%`},transition:{duration:.5,ease:"easeOut"}})}),m.jsx("div",{className:"w-6 text-xs text-gray-600 text-right font-medium",children:s})]},i))})]})}function HEt(t){const{type:e,coordinates:n}=t,r=a=>Pi(a),i=a=>a.map(r),s=a=>a.map(i),o=a=>a.map(s);switch(e){case"Point":return new Vs(r(n));case"LineString":return new ro(i(n));case"Polygon":return new ou(s(n));case"MultiPoint":return new X1(i(n));case"MultiLineString":return new np(s(n));case"MultiPolygon":return new p1(o(n));default:return console.warn(`Unsupported geometry type: ${e}`),null}}function qEt(t,e,n){const r=t.color,i=10,s=5,o=14;let a=i;if(n>50?a=s:n>10?a=Math.max(s,i-(n-10)/10):n<2&&(a=o),e==="Point"||e==="MultiPoint")return new zn({image:new $a({radius:a,fill:new Nr({color:r}),stroke:new Sr({color:"#ffffff",width:2})})});if(e==="LineString"||e==="MultiLineString")return new zn({stroke:new Sr({color:r,width:3})});if(e==="Polygon"||e==="MultiPolygon"){const l=KEt(r,.3);return new zn({fill:new Nr({color:l}),stroke:new Sr({color:r,width:2})})}return new zn({image:new $a({radius:a,fill:new Nr({color:r}),stroke:new Sr({color:"#ffffff",width:2})})})}function KEt(t,e){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(n){const r=parseInt(n[1],16),i=parseInt(n[2],16),s=parseInt(n[3],16);return`rgba(${r}, ${i}, ${s}, ${e})`}return t}function YEt(){const t=es(r=>r.map),e=qA(r=>r.layers),n=X.useRef(new Map);return X.useEffect(()=>{if(!t)return;const r=new Set;e.forEach(i=>{r.add(i.id);const s=new Nd;i.features.features.forEach((a,l)=>{if(!a.geometry)return;const c=HEt(a.geometry);if(!c)return;const u=new _i({geometry:c,...a.properties,layerType:"importedLayer",layerId:i.id,layerName:i.name,layerColor:i.color,featureIndex:l});u.setStyle((h,f)=>qEt(i,a.geometry.type,f)),s.addFeature(u)});const o=n.current.get(i.id);if(o)o.setSource(s),o.setVisible(i.visible),o.setOpacity(i.opacity);else{const a=new gp({source:s,zIndex:900,visible:i.visible,opacity:i.opacity,properties:{title:i.name,customLayerId:i.id}});t.addLayer(a),n.current.set(i.id,a)}}),n.current.forEach((i,s)=>{r.has(s)||(t.removeLayer(i),n.current.delete(s))})},[t,e]),X.useEffect(()=>()=>{t&&(n.current.forEach(r=>{t.removeLayer(r)}),n.current.clear())},[t]),null}ir.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs");v2e(ir);function XEt(t){if(!t||t.length<2)return"unknown";const[e,n]=t;return e>=7e3&&e<=3e5&&n>=289e3&&n<=629e3?"RD":Math.abs(e)<=180&&Math.abs(n)<=90?"WGS84":"unknown"}function ZEt(t){const[e,n]=t;return ir("EPSG:28992","EPSG:4326",[e,n])}function Qbe(t,e){return typeof t[0]=="number"?e(t):t.map(n=>Qbe(n,e))}function JEt(t){const e=t.coordinates;return!e||Array.isArray(e)&&e.length===0?null:t.type==="Point"?e:t.type==="LineString"||t.type==="MultiPoint"?e[0]:t.type==="Polygon"||t.type==="MultiLineString"?e[0]?.[0]:t.type==="MultiPolygon"?e[0]?.[0]?.[0]:null}async function QEt(t){const e=[],n=[];try{const r=await t.text(),i=JSON.parse(r);if(!i.type)return e.push('Ongeldig GeoJSON: geen "type" veld gevonden'),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}};let s=[];i.type==="FeatureCollection"?s=i.features||[]:i.type==="Feature"?s=[i]:i.type==="GeometryCollection"?s=(i.geometries||[]).map((c,u)=>({type:"Feature",geometry:c,properties:{id:u}})):s=[{type:"Feature",geometry:i,properties:{}}],s.length===0&&n.push("Geen features gevonden in bestand");let o="unknown",a=!1;if(s.length>0&&s[0].geometry){const c=JEt(s[0].geometry);c&&(o=XEt(c))}o==="RD"&&(n.push("Rijksdriehoek coordinaten gedetecteerd, worden omgezet naar WGS84"),a=!0,s=s.map(c=>{if(!c.geometry)return c;const u=Qbe(c.geometry.coordinates,ZEt);return{...c,geometry:{...c.geometry,coordinates:u}}}),o="WGS84");const l=[...new Set(s.filter(c=>c.geometry).map(c=>c.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:s},errors:e,warnings:n,metadata:{featureCount:s.length,geometryTypes:l,coordinateSystem:o,transformed:a}}}catch(r){return e.push(`Fout bij parsen: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function eSt(t){const e=[],n=[];try{const r=await t.text(),s=new t0t({extractStyles:!1}).readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&n.push("Geen features gevonden in KML bestand");const l=new ZO().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((u,h)=>{const f={...u.properties},g=f.name||f.Name||`Feature ${h+1}`,v=f.description||f.Description||"";return{type:"Feature",geometry:u.geometry,properties:{...f,name:g,description:v}}}),c=[...new Set(l.filter(u=>u.geometry).map(u=>u.geometry.type))];return{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:n,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen KML: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}async function tSt(t){const e=[],n=[];try{const r=await t.text(),s=new mgt().readFeatures(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});s.length===0&&n.push("Geen features gevonden in GPX bestand");const l=new ZO().writeFeaturesObject(s,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).features.map((u,h)=>{const f={...u.properties},g=f.name||f.Name||`Waypoint ${h+1}`,v=f.desc||f.description||"",x=f.time||null,b=f.ele||null;return{type:"Feature",geometry:u.geometry,properties:{...f,name:g,description:v,time:x,elevation:b}}}),c=[...new Set(l.filter(u=>u.geometry).map(u=>u.geometry.type))];return c.includes("LineString")&&n.push("GPX track routes worden als lijnen weergegeven"),{success:!0,features:{type:"FeatureCollection",features:l},errors:e,warnings:n,metadata:{featureCount:l.length,geometryTypes:c,coordinateSystem:"WGS84",transformed:!1}}}catch(r){return e.push(`Fout bij parsen GPX: ${r instanceof Error?r.message:"Onbekende fout"}`),{success:!1,features:{type:"FeatureCollection",features:[]},errors:e,warnings:n,metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function HH(t){switch(t.split(".").pop()?.toLowerCase()){case"geojson":case"json":return"geojson";case"kml":case"kmz":return"kml";case"gpx":return"gpx";default:return"unsupported"}}function nSt(){return".geojson,.json,.kml,.gpx"}function qH(){return"GeoJSON, KML (Google My Maps), GPX"}async function rSt(t){switch(HH(t.name)){case"geojson":return QEt(t);case"kml":return eSt(t);case"gpx":return tSt(t);case"unsupported":default:return{success:!1,features:{type:"FeatureCollection",features:[]},errors:[`Niet-ondersteund bestandsformaat: ${t.name}. Ondersteunde formaten: ${qH()}`],warnings:[],metadata:{featureCount:0,geometryTypes:[],coordinateSystem:"unknown",transformed:!1}}}}function iSt(t){return t.size>10485760?{valid:!1,error:`Bestand te groot (${(t.size/1024/1024).toFixed(1)} MB). Maximum is 10 MB.`}:HH(t.name)==="unsupported"?{valid:!1,error:`Niet-ondersteund bestandsformaat. Ondersteunde formaten: ${qH()}`}:t.name.toLowerCase().endsWith(".kmz")?{valid:!1,error:"KMZ bestanden worden nog niet ondersteund. Pak het bestand uit en importeer het .kml bestand."}:{valid:!0}}function sSt({isOpen:t,onClose:e}){const n=qA(N=>N.addLayer),r=X.useRef(null),[i,s]=X.useState("idle"),[o,a]=X.useState(null),[l,c]=X.useState(null),[u,h]=X.useState(""),[f,g]=X.useState(null),[v,x]=X.useState(!1),b=X.useCallback(()=>{s("idle"),a(null),c(null),h(""),g(null),r.current&&(r.current.value="")},[]),T=X.useCallback(()=>{b(),e()},[b,e]),A=X.useCallback(async N=>{const O=iSt(N);if(!O.valid){g(O.error||"Ongeldig bestand"),s("error");return}a(N),s("parsing"),g(null);const F=N.name.replace(/\.[^/.]+$/,"");h(F);try{const L=await rSt(N);if(!L.success){g(L.errors.join(`
`)),s("error");return}if(L.features.features.length===0){g("Geen features gevonden in het bestand"),s("error");return}c(L),s("preview")}catch(L){g(L instanceof Error?L.message:"Onbekende fout bij parsen"),s("error")}},[]),I=X.useCallback(N=>{const O=N.target.files?.[0];O&&A(O)},[A]),R=X.useCallback(N=>{N.preventDefault(),x(!0)},[]),C=X.useCallback(N=>{N.preventDefault(),x(!1)},[]),V=X.useCallback(N=>{N.preventDefault(),x(!1);const O=N.dataTransfer.files?.[0];O&&A(O)},[A]),M=X.useCallback(()=>{if(!l||!u.trim())return;const N=o?HH(o.name):"geojson";n({name:u.trim(),type:N==="unsupported"?"geojson":N,features:l.features,visible:!0,opacity:1,color:"",sourceFileName:o?.name||"unknown"}),T()},[l,u,o,n,T]);return m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:T}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[80vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(AI,{size:18}),m.jsx("span",{className:"font-medium",children:"Laag Importeren"})]}),m.jsx("button",{onClick:T,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(Ei,{size:18})})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i==="idle"&&m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${v?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:R,onDragLeave:C,onDrop:V,children:[m.jsx(JW,{size:40,className:"mx-auto text-gray-400 mb-3"}),m.jsx("p",{className:"text-gray-600 mb-2",children:"Sleep een bestand hierheen"}),m.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"of"}),m.jsx("button",{onClick:()=>r.current?.click(),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none",children:"Bestand kiezen"}),m.jsx("input",{ref:r,type:"file",accept:nSt(),onChange:I,className:"hidden"})]}),m.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[m.jsx("p",{className:"font-medium",children:"Ondersteunde formaten:"}),m.jsx("p",{children:qH()})]})]}),i==="parsing"&&m.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[m.jsx(eH,{size:40,className:"text-purple-500 animate-spin mb-4"}),m.jsx("p",{className:"text-gray-600",children:"Bestand verwerken..."}),m.jsx("p",{className:"text-gray-400 text-sm",children:o?.name})]}),i==="error"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-4 bg-red-50 rounded-lg",children:[m.jsx(awe,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-red-700",children:"Import mislukt"}),m.jsx("p",{className:"text-sm text-red-600 mt-1 whitespace-pre-wrap",children:f})]})]}),m.jsx("button",{onClick:b,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Opnieuw proberen"})]}),i==="preview"&&l&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[m.jsx(Jat,{size:20,className:"text-green-500 flex-shrink-0 mt-0.5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-green-700",children:"Bestand geladen"}),m.jsx("p",{className:"text-sm text-green-600",children:o?.name})]})]}),l.warnings.length>0&&m.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg",children:[m.jsx("p",{className:"font-medium text-amber-700 text-sm",children:"Let op:"}),m.jsx("ul",{className:"text-sm text-amber-600 mt-1 list-disc list-inside",children:l.warnings.map((N,O)=>m.jsx("li",{children:N},O))})]}),m.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Features:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.featureCount})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-500",children:"Types:"}),m.jsx("span",{className:"ml-2 font-medium",children:l.metadata.geometryTypes.join(", ")||"-"})]})]})}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de laag"}),m.jsx("input",{type:"text",value:u,onChange:N=>h(N.target.value),placeholder:"Bijv. Mijn locaties",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]}),i==="preview"&&m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex gap-2",children:[m.jsx("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border-0 outline-none",children:"Annuleren"}),m.jsx("button",{onClick:M,disabled:!u.trim(),className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors border-0 outline-none disabled:opacity-50 disabled:cursor-not-allowed",children:"Importeren"})]})]})]})})}function oSt(){const{user:t,loading:e,error:n,signInWithGoogle:r,logout:i,initAuth:s}=G5();return X.useEffect(()=>{s()},[s]),e?m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg text-gray-500",children:[m.jsx(hp,{size:16,className:"animate-pulse"}),m.jsx("span",{className:"text-sm",children:"Laden..."})]}):t?m.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5 bg-green-50 rounded-lg",children:[t.photoURL?m.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-8 h-8 rounded-full border-2 border-green-200",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-200 flex items-center justify-center",children:m.jsx(iH,{size:16,className:"text-green-600"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"text-sm font-medium text-green-800 truncate",children:t.displayName||t.email}),m.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1",children:[m.jsx(hp,{size:12}),"Cloud sync actief"]})]}),m.jsx("button",{onClick:i,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(tH,{size:16})})]}):m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg text-gray-500",children:[m.jsx(slt,{size:16}),m.jsx("span",{className:"text-sm",children:"Alleen lokale opslag"})]}),m.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none",children:[m.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),m.jsx("span",{className:"text-sm text-gray-700",children:"Inloggen met Google"})]}),n&&m.jsx("div",{className:"px-3 py-2 bg-red-50 text-red-700 text-xs rounded-lg",children:n})]})}const aSt="https://forms.gle/R5LCk11Bzu5XrkBj8";function lSt(){const{settingsPanelOpen:t,toggleSettingsPanel:e,vondstDashboardOpen:n,toggleVondstDashboard:r,openLayerManagerModal:i}=ri(),s=Nn(),{presets:o,createPreset:a,deletePreset:l,updatePreset:c}=qhe(),u=xd(ne=>ne.vondsten),h=qA(ne=>ne.layers),{layers:f,updateLayer:g}=Po(),{devMode:v,setDevMode:x,tier:b}=sG(),[T,A]=X.useState(""),[I,R]=X.useState(!1),[C,V]=X.useState(!1),[M,N]=X.useState(null),[O,F]=X.useState(""),[L,B]=X.useState(null),[U,de]=X.useState(""),[me,ze]=X.useState("algemeen"),Le=14*s.fontScale/100,fe=()=>{T.trim()&&(a(T.trim(),"Layers"),A(""),R(!1))},$e=(ne,se)=>{N(ne),F(se)},Ce=ne=>{O.trim()&&(c(ne,{name:O.trim()}),console.log(` Preset hernoemd naar "${O.trim()}"`)),N(null),F("")},le=()=>{N(null),F("")},W=[{id:"algemeen",label:"Algemeen",icon:m.jsx(Dct,{size:14})},{id:"lagen",label:"Lagen",icon:m.jsx(nu,{size:14})},{id:"vondsten",label:"Vondsten",icon:m.jsx(fc,{size:14})}];return m.jsxs(m.Fragment,{children:[m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",style:{fontSize:`${Le}px`},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(LV,{size:18,className:"text-white"}),m.jsx("span",{className:"font-medium text-white",children:"Instellingen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[s.showFontSliders&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"text-[10px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:s.fontScale,onInput:ne=>{s.setFontScale(parseInt(ne.target.value))},onChange:ne=>s.setFontScale(parseInt(ne.target.value)),className:"w-20 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${s.fontScale}%`}),m.jsx("span",{className:"text-xs text-blue-200",children:"T"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none ml-1",children:m.jsx(Ei,{size:18,className:"text-white",strokeWidth:2.5})})]})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:W.map(ne=>m.jsxs("button",{onClick:()=>ze(ne.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${me===ne.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[ne.icon,ne.label]},ne.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",style:{fontSize:`${Le}px`},children:[me==="algemeen"&&m.jsxs(m.Fragment,{children:[m.jsx(Lh,{title:"Account",icon:m.jsx(iH,{size:16}),children:m.jsx(oSt,{})}),m.jsxs(Lh,{title:"Kaart",icon:m.jsx(nH,{size:16}),children:[m.jsx(cSt,{label:"Standaard achtergrond",children:m.jsxs("select",{value:s.defaultBackground,onChange:ne=>s.setDefaultBackground(ne.target.value),className:"px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx("option",{value:"CartoDB (licht)",children:"Licht"}),m.jsx("option",{value:"OpenStreetMap",children:"OSM"}),m.jsx("option",{value:"Luchtfoto",children:"Luchtfoto"})]})}),m.jsx(D0,{label:"Schaalbalk tonen",checked:s.showScaleBar,onChange:s.setShowScaleBar})]}),m.jsxs(Lh,{title:"GPS",icon:m.jsx(cb,{size:16}),children:[m.jsx(D0,{label:"GPS aan bij start",checked:s.gpsAutoStart,onChange:s.setGpsAutoStart}),m.jsx(D0,{label:"Nauwkeurigheidscirkel",checked:s.showAccuracyCircle,onChange:s.setShowAccuracyCircle})]}),m.jsxs(Lh,{title:"Feedback",icon:m.jsx(jct,{size:16}),children:[m.jsx(D0,{label:"Trillen bij acties",checked:s.hapticFeedback,onChange:s.setHapticFeedback}),m.jsx(D0,{label:"Spraakfeedback vondsten",checked:s.voiceFeedbackEnabled,onChange:s.setVoiceFeedbackEnabled}),s.voiceFeedbackEnabled&&m.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:[m.jsx(out,{size:12,className:"inline mr-1"}),"Spreekt vondst info uit bij toevoegen"]})]}),m.jsxs(Lh,{title:"Weer",icon:m.jsx(hp,{size:16}),children:[m.jsx(D0,{label:"Weerwidget tonen",checked:s.showWeatherButton,onChange:s.setShowWeatherButton}),m.jsx("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:"Actueel weer, voorspelling en buienradar"})]}),m.jsxs(Lh,{title:"Development",icon:m.jsx(hlt,{size:16}),children:[m.jsx(D0,{label:"Dev Mode (alles ontgrendeld)",checked:v,onChange:x}),m.jsxs("p",{className:"text-gray-500 mt-1",style:{fontSize:"0.75em"},children:["Huidige tier: ",m.jsx("span",{className:"font-medium text-blue-600",children:b}),v&&m.jsx("span",{className:"text-green-600",children:" (alle lagen ontgrendeld)"})]})]})]}),me==="lagen"&&m.jsxs(m.Fragment,{children:[m.jsx(Lh,{title:"Mijn lagen",icon:m.jsx(nu,{size:16}),isOwn:!0,children:m.jsxs("div",{className:"space-y-1",children:[f.filter(ne=>!ne.archived).length===0?m.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Nog geen eigen lagen aangemaakt."}):f.filter(ne=>!ne.archived).map(ne=>m.jsx("div",{className:"flex items-center gap-2 py-1.5 px-2 hover:bg-gray-50 rounded",children:L===ne.id?m.jsx("input",{type:"text",value:U,onChange:se=>de(se.target.value),onKeyDown:se=>{se.key==="Enter"?(U.trim()&&g(ne.id,{name:U.trim()}),B(null)):se.key==="Escape"&&B(null)},onBlur:()=>{U.trim()&&g(ne.id,{name:U.trim()}),B(null)},autoFocus:!0,className:"flex-1 px-1.5 py-0.5 text-sm bg-orange-50 rounded outline-none focus:ring-1 focus:ring-orange-400"}):m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:ne.name}),m.jsxs("span",{className:"text-xs text-gray-400",children:[ne.points.length," punten"]}),m.jsx("button",{onClick:()=>{B(ne.id),de(ne.name)},className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none bg-transparent",title:"Naam bewerken",children:m.jsx(k2,{size:12})})]})},ne.id)),m.jsxs("button",{onClick:()=>{i(),e()},className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(LV,{size:14}),m.jsx("span",{children:"Lagen beheren"})]})]})}),m.jsx(Lh,{title:"Lagen importeren",icon:m.jsx(AI,{size:16}),children:m.jsxs("div",{className:"space-y-1",children:[h.length>0&&m.jsxs(m.Fragment,{children:[h.map(ne=>m.jsx(gwe,{layer:ne},ne.id)),m.jsx("div",{className:"border-t border-gray-100 my-2"})]}),m.jsxs("button",{onClick:()=>V(!0),className:"flex items-center gap-2 px-2 py-1.5 text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Nieuwe laag importeren"})]}),m.jsx("p",{className:"text-gray-400 mt-1",style:{fontSize:"0.7em"},children:"GeoJSON, KML (Google My Maps), GPX"})]})}),m.jsx(Lh,{title:"Presets",icon:m.jsx(nu,{size:16}),children:m.jsxs("div",{className:"space-y-2",children:[o.map(ne=>m.jsx("div",{className:"flex items-center justify-between py-1",children:M===ne.id?m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("input",{type:"text",value:O,onChange:se=>F(se.target.value),onKeyDown:se=>{se.key==="Enter"&&Ce(ne.id),se.key==="Escape"&&le()},className:"flex-1 px-2 py-0.5 bg-blue-50 rounded border border-blue-300 outline-none",style:{fontSize:"0.9em"},autoFocus:!0}),m.jsx("button",{onClick:()=>Ce(ne.id),className:"px-2 py-0.5 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:"OK"}),m.jsx("button",{onClick:le,className:"px-2 py-0.5 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.7em"},children:""})]}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:[ne.name,ne.isBuiltIn&&m.jsx("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:"(standaard)"})]}),m.jsxs("span",{className:"ml-1 text-gray-400",style:{fontSize:"0.7em"},children:["(",ne.layers.length," lagen)"]})]}),!ne.isBuiltIn&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("button",{onClick:()=>$e(ne.id,ne.name),className:"p-1 text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(k2,{size:14})}),m.jsx("button",{onClick:()=>l(ne.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(wp,{size:14})})]})]})},ne.id)),I?m.jsxs("div",{className:"flex gap-2 mt-2",children:[m.jsx("input",{type:"text",value:T,onChange:ne=>A(ne.target.value),placeholder:"Naam nieuwe preset",className:"flex-1 px-2 py-1 bg-gray-100 rounded border-0 outline-none",style:{fontSize:"0.9em"},onKeyDown:ne=>ne.key==="Enter"&&fe(),autoFocus:!0}),m.jsx("button",{onClick:fe,className:"px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Opslaan"}),m.jsx("button",{onClick:()=>R(!1),className:"px-2 py-1 bg-gray-200 text-gray-600 rounded hover:bg-gray-300 transition-colors border-0 outline-none",style:{fontSize:"0.75em"},children:"Annuleren"})]}):m.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(uu,{size:14}),m.jsx("span",{children:"Huidige lagen als preset opslaan"})]})]})})]}),me==="vondsten"&&m.jsx(m.Fragment,{children:m.jsxs(Lh,{title:"Vondsten",icon:m.jsx(fc,{size:16}),isOwn:!0,children:[m.jsx("p",{className:"text-gray-500 py-1",style:{fontSize:"0.75em"},children:"Vondsten worden altijd lokaal op dit apparaat opgeslagen."}),m.jsxs("button",{onClick:r,className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsx(swe,{size:14}),m.jsxs("span",{children:["Dashboard (",u.length," vondsten)"]})]}),m.jsx(uSt,{})]})})]}),m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",style:{fontSize:`${Le}px`},children:[m.jsxs("a",{href:aSt,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(iwe,{size:16}),m.jsx("span",{children:"Meld een bug"})]}),m.jsxs("button",{onClick:BEt,className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:[m.jsx(tH,{size:16}),m.jsx("span",{children:"Uitloggen"})]}),m.jsx("p",{className:"text-gray-400 text-center",style:{fontSize:"0.75em"},children:"Instellingen worden lokaal opgeslagen"})]})]})]})}),m.jsx(WEt,{isOpen:n,onClose:r}),m.jsx(sSt,{isOpen:C,onClose:()=>V(!1)})]})}function Lh({title:t,icon:e,children:n,isOwn:r}){return m.jsxs("section",{children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-1 border-b border-gray-100",children:[m.jsx("span",{className:r?"text-orange-600":"text-blue-600",children:e}),m.jsx("span",{className:`font-medium ${r?"text-orange-600":"text-gray-800"}`,style:{fontSize:"1em"},children:t})]}),m.jsx("div",{className:"space-y-2",children:n})]})}function cSt({label:t,children:e}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:t}),e]})}function D0({label:t,checked:e,onChange:n}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-gray-600",style:{fontSize:"0.9em"},children:t}),m.jsx("button",{onClick:()=>n(!e),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${e?"bg-gradient-to-r from-blue-500 to-blue-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${e?"left-[22px]":"left-0.5"}`})})]})}function uSt(){const[t,e]=X.useState(!1),{vondsten:n,exportAsGeoJSON:r,exportAsCSV:i,exportAsExcel:s,exportAsGPX:o,exportAsKML:a}=xd(),l=[{label:"Excel (.xlsx)",action:s,desc:"Spreadsheet"},{label:"CSV",action:i,desc:"Comma-separated"},{label:"GeoJSON",action:r,desc:"GIS software"},{label:"GPX",action:o,desc:"GPS apparaten"},{label:"KML",action:a,desc:"Google Earth"}],c=u=>{u(),e(!1)};return n.length===0?m.jsxs("div",{className:"flex items-center gap-2 mt-2 px-2 py-1.5 text-gray-400 bg-gray-100 rounded w-full cursor-not-allowed",style:{fontSize:"0.9em"},children:[m.jsx(lN,{size:14}),m.jsx("span",{children:"Geen vondsten om te exporteren"})]}):m.jsxs("div",{className:"relative mt-2",children:[m.jsxs("button",{onClick:()=>e(!t),className:"flex items-center justify-between gap-2 px-2 py-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none w-full",style:{fontSize:"0.9em"},children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(lN,{size:14}),m.jsxs("span",{children:["Exporteer vondsten (",n.length,")"]})]}),m.jsx("span",{style:{fontSize:"0.8em"},children:""})]}),t&&m.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:l.map((u,h)=>m.jsxs("button",{onClick:()=>c(u.action),className:"w-full px-3 py-2 text-left hover:bg-blue-50 transition-colors border-0 outline-none flex justify-between items-center",style:{fontSize:"0.9em"},children:[m.jsx("span",{className:"text-gray-700",children:u.label}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.8em"},children:u.desc})]},h))})]})}const zN="2.32.12";function hSt({size:t=18}){return m.jsxs("svg",{viewBox:"0 0 24 24",width:t,height:t,children:[m.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}function dSt(){const[t,e]=X.useState(!1),{user:n,loading:r,signInWithGoogle:i,logout:s}=G5(),{toggleInfoPanel:o,toggleSettingsPanel:a,toggleMonumentSearch:l}=ri(),c=Nn(U=>U.menuFontScale),u=Nn(U=>U.setMenuFontScale),h=Nn(U=>U.showFontSliders),f=Nn(U=>U.setShowFontSliders),g=Nn(U=>U.showVondstButton),v=Nn(U=>U.setShowVondstButton),x=Nn(U=>U.showRouteRecordButton),b=Nn(U=>U.setShowRouteRecordButton),T=Nn(U=>U.showCustomPointLayers),A=Nn(U=>U.setShowCustomPointLayers),I=Nn(U=>U.showWeatherButton),R=Nn(U=>U.setShowWeatherButton),C={top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))"},V=()=>e(!1),M=()=>{V(),o()},N=()=>{V(),a()},O=()=>{V(),l()},F=()=>{V(),i()},L=()=>{V(),s()},B=13*c/100;return m.jsxs(m.Fragment,{children:[m.jsx(Ct.button,{className:`fixed right-2 z-[800] w-11 h-11 flex items-center justify-center rounded-xl shadow-sm border-0 outline-none transition-colors backdrop-blur-sm ${t?"bg-blue-500 hover:bg-blue-600":"bg-white/90 hover:bg-white"}`,style:C,onClick:()=>e(!t),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Menu",children:t?m.jsx(Ei,{size:22,className:"text-white"}):m.jsx(ect,{size:22,className:"text-gray-600"})}),m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[799]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:V}),m.jsxs(Ct.div,{initial:{opacity:0,y:-8,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.95},transition:{duration:.15},className:"fixed right-2 z-[801] w-64 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col",style:{top:"calc(max(0.5rem, env(safe-area-inset-top, 0.5rem)) + 52px)",fontSize:`${B}px`},children:[m.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-1.5 bg-blue-500",children:[m.jsx("span",{className:"font-medium text-white",style:{fontSize:`${B}px`},children:"Menu"}),h&&m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-blue-200",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"130",step:"10",value:c,onInput:U=>u(parseInt(U.target.value)),onChange:U=>u(parseInt(U.target.value)),className:"w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${c}%`}),m.jsx("span",{className:"text-[11px] text-blue-200",children:"T"})]})]}),r?m.jsx("div",{className:"px-3 py-4 flex items-center justify-center",children:m.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"})}):n?m.jsx("div",{className:"px-3 py-3 border-b border-gray-100",children:m.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?m.jsx("img",{src:n.photoURL,alt:n.displayName||"User",className:"w-8 h-8 rounded-full",referrerPolicy:"no-referrer"}):m.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:m.jsx(iH,{size:16,className:"text-white"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate",style:{fontSize:"0.85em"},children:n.displayName||"Gebruiker"}),m.jsx("div",{className:"text-green-600",style:{fontSize:"0.7em"},children:"Cloud sync actief"})]}),m.jsx("button",{onClick:L,className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none bg-transparent",title:"Uitloggen",children:m.jsx(tH,{size:16})})]})}):m.jsxs("button",{onClick:F,className:"w-full px-3 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors border-0 outline-none bg-transparent",children:[m.jsx(hSt,{size:18}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Inloggen met Google"})]}),m.jsxs("div",{className:"py-1",children:[m.jsxs("button",{onClick:M,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-blue-50",style:{fontSize:"0.95em"},children:[m.jsx(QW,{size:18,className:"text-blue-500"}),m.jsx("span",{children:"Info & handleiding"})]}),m.jsxs("button",{onClick:O,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-purple-50",style:{fontSize:"0.95em"},children:[m.jsx(cwe,{size:18,className:"text-purple-500"}),m.jsx("span",{children:"Zoek in monumenten"})]})]}),m.jsxs("div",{className:"py-1 border-t border-gray-100",children:[m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(fc,{size:18,className:"text-orange-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Vondst knop"})]}),m.jsx("button",{onClick:()=>v(!g),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${g?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${g?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(hN,{size:18,className:"text-green-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Route knop"})]}),m.jsx("button",{onClick:()=>b(!x),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${x?"bg-gradient-to-r from-green-500 to-green-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${x?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(hp,{size:18,className:"text-cyan-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Weerwidget"})]}),m.jsx("button",{onClick:()=>R(!I),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${I?"bg-gradient-to-r from-cyan-500 to-cyan-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${I?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(nu,{size:18,className:"text-amber-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Mijn lagen"})]}),m.jsx("button",{onClick:()=>A(!T),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${T?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${T?"left-[22px]":"left-0.5"}`})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(rH,{size:18,className:"text-purple-500"}),m.jsx("span",{className:"text-gray-700",style:{fontSize:"0.9em"},children:"Tekstgrootte"})]}),m.jsx("button",{onClick:()=>f(!h),className:`w-10 h-5 rounded-full transition-all border-0 outline-none relative ${h?"bg-gradient-to-r from-purple-500 to-purple-600":"bg-gray-300"}`,children:m.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white shadow-sm transition-all ${h?"left-[22px]":"left-0.5"}`})})]})]}),m.jsx("div",{className:"mt-auto border-t border-gray-100",children:m.jsxs("button",{onClick:N,className:"w-full px-3 py-2.5 text-left flex items-center gap-3 border-0 outline-none bg-transparent transition-colors text-gray-700 hover:bg-gray-50",style:{fontSize:"0.95em"},children:[m.jsx(LV,{size:18,className:"text-gray-500"}),m.jsx("span",{children:"Instellingen"})]})}),m.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-center text-gray-400",style:{fontSize:"0.65em"},children:["DetectorApp NL v",zN]})]})]})})]})}const fSt="https://forms.gle/R5LCk11Bzu5XrkBj8";function pSt(){const{infoPanelOpen:t,toggleInfoPanel:e}=ri(),[n,r]=X.useState("info"),i=[{id:"info",label:"Info",icon:m.jsx(QW,{size:14})},{id:"functies",label:"Functies",icon:m.jsx(JW,{size:14})},{id:"handleiding",label:"Handleiding",icon:m.jsx(Vat,{size:14})}];return m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-blue-500",children:[m.jsxs("span",{className:"font-medium text-white",children:["DetectorApp NL v",zN]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-blue-400/50 hover:bg-blue-400 transition-colors border-0 outline-none",children:m.jsx(Ei,{size:18,className:"text-white",strokeWidth:2.5})})]}),m.jsx("div",{className:"flex border-b border-gray-200",children:i.map(s=>m.jsxs("button",{onClick:()=>r(s.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 text-sm font-medium transition-colors border-0 outline-none ${n===s.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[s.icon,s.label]},s.id))}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 text-sm",children:[n==="info"&&m.jsx(mSt,{}),n==="functies"&&m.jsx(gSt,{}),n==="handleiding"&&m.jsx(ySt,{}),m.jsxs("section",{className:"pt-2 border-t border-gray-200 space-y-2",children:[m.jsxs("a",{href:fSt,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-3 py-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",children:[m.jsx(iwe,{size:14}),m.jsx("span",{className:"text-sm",children:"Meld een bug of geef feedback"})]}),m.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["DetectorApp NL v",zN," - Gratis en zonder tracking"]})]})]})]})]})})}function mSt(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Over deze app"}),m.jsx("p",{className:"text-gray-600",children:"DetectorApp NL is d gratis kaartapplicatie voor metaaldetectie, fossielen zoeken en archeologische verkenning in Nederland. Met 70+ kaartlagen, GPS tracking met richtingspijl, eigen lagen, cloud sync en uitgebreid vondstenbeheer."})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Databronnen & Licenties"}),m.jsxs("ul",{className:"space-y-2 text-gray-600",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"RCE / Cultureelerfgoed.nl"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"AMK Monumenten, Rijksmonumenten, Werelderfgoed, Paleokaarten, Religieus Erfgoed, Essen, Archeo Onderzoeken"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"PDOK / Kadaster"})," (CC0/CC-BY)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Luchtfoto, AHN Hoogtekaarten, IKAW, Bodemkaart, Geomorfologie, Kadastrale Grenzen, Gewaspercelen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"OpenStreetMap"})," (ODbL)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Hunebedden, Grafheuvels, Bunkers, Kastelen, Terpen, Parken, Kringloopwinkels, Musea, Speeltuinen, Strandjes"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Itiner-E / Wetenschappelijk"})," (CC BY 4.0)",m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Romeinse wegen - Brughmans, Paout, de Soto & Bjerregaard Vahlstrup"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Mindat.org"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Mineralen hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Paleontica / Fossielen data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Fossiel hotspots en vindplaatsen"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Map5.nl / Kadaster"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Historische kaarten (TMK 1850, Bonnebladen 1900)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciale data"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Relictenkaart (Gelderland), Scheepswrakken (Zuid-Holland), Verdronken Dorpen (Zeeland)"})]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV / Rijkswaterstaat"}),m.jsx("br",{}),m.jsx("span",{className:"text-xs",children:"Uiterwaarden archeologische data, Expert advies, Bufferlagen"})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Privacy & Opslag"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Volledig anoniem mogelijk:"})," Je kunt deze app gebruiken zonder enige registratie of login. Al je data blijft dan 100% op je eigen apparaat."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Geen tracking:"})," Deze app verzamelt geen analytics, cookies, gebruiksstatistieken of persoonlijke gegevens. Er is geen server die je gedrag registreert."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Locatiegegevens:"})," Je GPS-positie wordt alleen gebruikt om je locatie op de kaart te tonen. Deze wordt niet opgeslagen of gedeeld met derden."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Google Login - Wat betekent het?"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsx("p",{className:"font-medium text-green-700",children:" Google login is volledig optioneel"}),m.jsx("p",{children:m.jsx("strong",{children:"Wat wordt gesynchroniseerd:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Je eigen aangemaakte lagen (Mijn Lagen)"}),m.jsx("li",{children:"Je vondsten registraties"}),m.jsx("li",{children:"Je preset-instellingen"})]}),m.jsx("p",{children:m.jsx("strong",{children:"Wat NIET wordt gedeeld:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Je GPS-locatie wordt niet opgeslagen in de cloud"}),m.jsx("li",{children:"Je zoekgeschiedenis wordt niet bewaard"}),m.jsx("li",{children:"Welke kaartlagen je bekijkt wordt niet geregistreerd"}),m.jsx("li",{children:"Niemand anders kan je data zien - alleen jij"})]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Waarom inloggen?"})," Alleen voor synchronisatie tussen apparaten (telefoon/tablet/PC) en als backup voor je vondsten."]}),m.jsx("p",{className:"text-xs text-gray-500 italic",children:"Tip: Gebruik de app gerust zonder login als je privacy belangrijker vindt dan synchronisatie. Alle functies werken ook offline."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Zonder login (anoniem)"}),m.jsxs("div",{className:"text-gray-600 space-y-2",children:[m.jsx("p",{className:"font-medium text-blue-700",children:" 95% van de functies werkt zonder login"}),m.jsx("p",{children:m.jsx("strong",{children:"Beschikbaar zonder login:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Alle 70+ kaartlagen bekijken"}),m.jsx("li",{children:"GPS tracking en navigatie"}),m.jsx("li",{children:"Vondsten registreren (lokaal opgeslagen)"}),m.jsx("li",{children:"Eigen lagen aanmaken (lokaal opgeslagen)"}),m.jsx("li",{children:"Export naar Excel/CSV/GeoJSON/GPX/KML"}),m.jsx("li",{children:"Lagen importeren"}),m.jsx("li",{children:"Alle presets en instellingen"})]}),m.jsx("p",{children:m.jsx("strong",{children:"Alleen met login:"})}),m.jsxs("ul",{className:"list-disc list-inside ml-2 text-xs space-y-1",children:[m.jsx("li",{children:"Synchronisatie tussen apparaten"}),m.jsx("li",{children:"Cloud backup van je vondsten"})]})]})]})]})}function gSt(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(nH,{size:16,className:"text-blue-600"}),"Kaartlagen (70+)"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Basis:"})," CartoDB, OpenStreetMap, PDOK Luchtfoto"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Historisch:"})," TMK 1850, Bonnebladen 1900"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Hoogtekaarten:"})," AHN4 Hillshade, Multi-Hillshade, Hoogtekaart Kleur, AHN 0.5m"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Archeologie:"})," AMK Monumenten (per periode), Archeo Onderzoeken, IKAW, Essen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeins:"})," Romeinse wegen, Romeinse Forten met historische info, Limesweg"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Prehistorie:"})," Hunebedden, Grafheuvels, Terpen, Paleokaarten (7 periodes)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Militair:"})," WWII Bunkers, Slagvelden, Vliegvelden, Verdedigingslinies"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Erfgoed:"})," Rijksmonumenten, Kastelen, Runes, Religieus Erfgoed"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Terrein:"})," Veengebieden, Geomorfologie, Bodemkaart"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Percelen:"})," Gewaspercelen (met bouwplantoelichting), Kadastrale Grenzen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Recreatie:"})," Parken, Musea, Kringloopwinkels, Strandjes, Wandelroutes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Provinciaal:"})," Relictenkaart, Scheepswrakken, Verdronken Dorpen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"UIKAV:"})," Uiterwaard data, Expert advies, Vlakken, Punten, Bufferlagen"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Olt,{size:16,className:"text-purple-600"}),"Mineralen & Fossielen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Mineralen hotspots:"})," Vindplaatsen uit Mindat.org met mineralenlijst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Goudrivieren:"})," Bekende locaties voor goud zoeken"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Fossiel hotspots:"})," Vindplaatsen met fossieltypen en periodes"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Premium lagen:"})," Gedetailleerde data (beschikbaar met account)"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Ilt,{size:16,className:"text-orange-600"}),"Mijn Lagen"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen lagen:"})," Maak lagen voor vakantie, projecten, etc."]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Toevoegen:"})," Tik op + in popup om monument/locatie aan laag toe te voegen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Polygonen:"})," Hele monumentgebieden worden opgeslagen, niet alleen een punt"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Originele info:"})," Popup content blijft behouden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Kleuren:"})," Elke laag krijgt eigen kleur (aanpasbaar)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Import:"})," Laad GeoJSON, KML of GPX bestanden"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Export:"})," Exporteer lagen als GeoJSON"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(hp,{size:16,className:"text-green-600"}),"Google Cloud Sync"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Inloggen:"})," Via hamburger menu rechtsboven"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Synchronisatie:"})," Lagen en vondsten automatisch naar cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Meerdere apparaten:"})," Altijd toegang tot je data"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Veilig:"})," Alleen jij hebt toegang tot je gegevens"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(cb,{size:16,className:"text-green-600"}),"GPS & Navigatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Live GPS tracking met nauwkeurigheidscirkel"}),m.jsx("li",{children:"Richtingspijl draait mee met je telefoon"}),m.jsx("li",{children:"Kaart handmatig draaien + kompasknop naar noorden"}),m.jsx("li",{children:"Schaalbalk onderaan (aan/uit in Instellingen)"}),m.jsx("li",{children:"Open locatie in Google Maps vanuit popup"}),m.jsx("li",{children:"Zoekbalk voor adressen en plaatsen"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(fc,{size:16,className:"text-orange-600"}),"Vondsten"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Toevoegen via GPS locatie, long-press of handmatig"}),m.jsx("li",{children:"Velden: type, materiaal, periode, diepte, conditie, gewicht"}),m.jsx("li",{children:"Foto's toevoegen (link of upload)"}),m.jsx("li",{children:"Export: Excel, CSV, GeoJSON, GPX, KML"}),m.jsx("li",{children:"Dashboard met statistieken"}),m.jsx("li",{children:"Cloud sync met Google account"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(nu,{size:16,className:"text-purple-600"}),"Presets"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Standaard:"})," Detectie, Steentijd, Romeins, Middeleeuwen, WOII, Analyse, Fossielen, Mineralen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Aanpasbaar:"})," Overschrijf preset met huidige lagen (diskette-icoon)"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Eigen presets:"})," Maak nieuwe via Instellingen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Tekstgrootte:"})," Aanpasbaar per panel via slider"]})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(ict,{size:16,className:"text-cyan-600"}),"Perceelinformatie"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsx("li",{children:"Kadastrale aanduiding (gemeente, sectie, nummer)"}),m.jsx("li",{children:"Oppervlakte in m en hectare"}),m.jsx("li",{children:"Gewas en bouwplan met uitleg"}),m.jsx("li",{children:"Bodemtype met beschrijving"}),m.jsx("li",{children:"AHN hoogte in meters NAP"}),m.jsx("li",{children:"Hoogtekaart per perceel (bergje-icoon)"}),m.jsx("li",{children:"Link naar eigenaar opzoeken (Kadaster)"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(Cct,{size:16,className:"text-red-600"}),"Monumenten & Erfgoed"]}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"AMK:"})," Archeologische Monumenten per periode"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Romeinse Forten:"})," Uitgebreide historische info per fort"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Rijksmonumenten:"})," Met bescherming en historie"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Verdedigingswerken:"})," Linies, forten, schansen"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Popup info:"})," Directe uitleg over archeologische waarde"]})]})]})]})}function ySt(){return m.jsxs(m.Fragment,{children:[m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Eerste stappen"}),m.jsxs("ol",{className:"text-gray-600 space-y-2 text-xs list-decimal list-inside",children:[m.jsxs("li",{children:["Tik op de ",m.jsx("strong",{children:"GPS knop"})," (rechtsonder, oranje) om je locatie te zien"]}),m.jsxs("li",{children:["Kies een ",m.jsx("strong",{children:"preset"})," (linksonder, laagjes-icoon) voor een snelle start"]}),m.jsxs("li",{children:["Of open ",m.jsx("strong",{children:"Kaartlagen"})," om individuele lagen aan te zetten"]}),m.jsx("li",{children:"Tik op objecten op de kaart voor gedetailleerde informatie"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Hamburger Menu"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsx("p",{children:"Rechtsboven vind je het menu met:"}),m.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[m.jsxs("li",{children:[m.jsx("strong",{children:"Google Login:"})," Synchroniseer je data naar de cloud"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Vondst toevoegen:"})," Registreer een nieuwe vondst"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Info & Handleiding:"})," Dit scherm"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Instellingen:"})," Presets, export, weergave"]})]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"GPS & Navigatie"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"GPS knop (oranje):"})," Aan/uit toggle voor locatie tracking."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Richtingspijl:"})," Blauwe pijl toont de richting van je telefoon."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kaart draaien:"})," Met twee vingers of via kompas."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Kompasknop:"})," Verschijnt rechtsboven als kaart gedraaid is. Tik om naar noorden te draaien."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Google Maps:"})," Vanuit elke popup kun je direct navigeren."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Locaties opslaan in Mijn Lagen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Tik op een object op de kaart (monument, bunker, etc.)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"})," Tik op de ",m.jsx("strong",{children:"oranje +"})," knop in de popup header"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een bestaande laag of maak een nieuwe aan"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," De locatie inclusief vorm (polygoon) en info wordt opgeslagen!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Tip: Maak lagen voor vakantiebestemmingen, projecten of interessante locaties."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Vondst registreren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Via GPS:"})," Open menu  Vondst toevoegen. Je locatie wordt automatisch ingevuld."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Via long-press:"}),' Houd je vinger op de kaart  kies "Vondst toevoegen".']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Handmatig:"}),' In het formulier  "Kies op kaart" voor exacte locatie.']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Foto's:"})," Voeg foto-links toe of upload direct."]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Presets gebruiken"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Toepassen:"})," Linksonder  preset kiezen."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Aanpassen:"})," Zet gewenste lagen aan  tik diskette-icoon naast preset."]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Nieuw maken:"}),' Instellingen  Presets  "Huidige lagen opslaan".']})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Cloud Sync instellen"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Open hamburger menu rechtsboven"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Tik op "Inloggen met Google"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies je Google account"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Klaar!"})," Je lagen en vondsten worden automatisch gesynchroniseerd."]}),m.jsx("p",{className:"text-gray-500 italic",children:"Je data is veilig en alleen voor jou toegankelijk."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Lagen importeren"}),m.jsxs("div",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 1:"})," Ga naar Instellingen (hamburger menu)"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 2:"}),' Scroll naar "Lagen importeren"']}),m.jsxs("p",{children:[m.jsx("strong",{children:"Stap 3:"})," Kies een GeoJSON, KML of GPX bestand"]}),m.jsxs("p",{children:[m.jsx("strong",{children:"Resultaat:"})," Nieuwe laag met je geimporteerde data!"]}),m.jsx("p",{className:"text-gray-500 italic",children:"Handig voor routes, waypoints of eigen datasets."})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor detectie"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"AHN Hillshade"})," om relif te zien (grafheuvels, wallen)"]}),m.jsxs("li",{children:["Combineer ",m.jsx("strong",{children:"AMK"})," met ",m.jsx("strong",{children:"Gewaspercelen"})," voor slimme zoeklocaties"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"IKAW"})," voor archeologische verwachting"]}),m.jsxs("li",{children:["Gebruik ",m.jsx("strong",{children:"historische kaarten"})," (TMK 1850) om oude structuren te vinden"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Archeo Onderzoeken"})," voor eerdere vondsten in het gebied"]}),m.jsxs("li",{children:[m.jsx("strong",{children:"Bodemkaart"})," toont of grond geschikt is (popup legt uit)"]})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor fossielen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Fossiel hotspots"})," aan voor bekende vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Paleokaarten"})," voor historische kustlijnen"]}),m.jsxs("li",{children:["Check ",m.jsx("strong",{children:"Geomorfologie"})," voor oude zeebodems en rivieren"]}),m.jsx("li",{children:"Popup toont welke fossielen op elke locatie gevonden zijn"})]})]}),m.jsxs("section",{children:[m.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tips voor mineralen"}),m.jsxs("ul",{className:"text-gray-600 space-y-1 text-xs list-disc list-inside",children:[m.jsxs("li",{children:["Zet ",m.jsx("strong",{children:"Mineralen hotspots"})," aan voor vindplaatsen"]}),m.jsxs("li",{children:["Bekijk ",m.jsx("strong",{children:"Goudrivieren"})," voor goudzoekmogelijkheden"]}),m.jsx("li",{children:"Popup toont welke mineralen op elke locatie voorkomen"}),m.jsx("li",{children:"Links naar Mindat.org voor gedetailleerde info"})]})]}),m.jsxs("section",{children:[m.jsxs("h3",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[m.jsx(vg,{size:16,className:"text-blue-600"}),"Handige links"]}),m.jsxs("ul",{className:"text-gray-600 space-y-2 text-xs",children:[m.jsxs("li",{children:[m.jsx("a",{href:"https://legendageomorfologie.wur.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Geomorfologie legenda (WUR)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Uitgebreide uitleg over landvormen"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://legenda-bodemkaart.bodemdata.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Bodemkaart legenda (BRO)"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Volledige bodemclassificatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.mindat.org/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Mindat.org - Mineralen database"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Wereldwijde mineralen informatie"})]}),m.jsxs("li",{children:[m.jsx("a",{href:"https://www.cultureelerfgoed.nl/",target:"_blank",rel:"noopener",className:"text-blue-600 hover:underline font-medium",children:"Rijksdienst voor Cultureel Erfgoed"}),m.jsx("br",{}),m.jsx("span",{className:"text-gray-500",children:"Officile monumenten informatie"})]})]})]})]})}function eEe(t,e,n,r){const s=(r-e)*Math.PI/180,o=(n-t)*Math.PI/180,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}function D8(t){let e=0;for(let n=1;n<t.length;n++)e+=eEe(t[n-1].coordinates[0],t[n-1].coordinates[1],t[n].coordinates[0],t[n].coordinates[1]);return e}const xl=No()(dh((t,e)=>({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[],visibleRouteIds:new Set,heatmapEnabled:!1,gridEnabled:!1,gridCenter:null,gridSize:20,gridCount:10,gridColor:"rgba(139, 92, 246, 0.6)",autoPauseEnabled:!1,autoPauseSeconds:120,startRecording:()=>{t({state:"recording",currentPoints:[],startTime:Date.now(),pauseStartTime:null,totalPausedTime:0})},pauseRecording:()=>{const{state:n}=e();n==="recording"&&t({state:"paused",pauseStartTime:Date.now()})},resumeRecording:()=>{const{state:n,pauseStartTime:r,totalPausedTime:i}=e();if(n!=="paused"||!r)return;const s=Date.now()-r;t({state:"recording",pauseStartTime:null,totalPausedTime:i+s})},stopRecording:n=>{const{state:r,currentPoints:i,startTime:s,totalPausedTime:o,pauseStartTime:a}=e();if(r==="idle"||!s||i.length<2)return t({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0}),null;const l=Date.now();let c=o;a&&(c+=l-a);const u=l-s-c,h=D8(i),f={id:crypto.randomUUID(),name:n||`Route ${new Date().toLocaleDateString("nl-NL")} ${new Date().toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,points:i,startTime:s,endTime:l,totalDistance:h,totalDuration:u,pausedDuration:c,createdAt:new Date().toISOString()};return t(g=>{const v=new Set(g.visibleRouteIds);return v.add(f.id),{state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0,savedRoutes:[f,...g.savedRoutes],visibleRouteIds:v}}),f},cancelRecording:()=>{t({state:"idle",currentPoints:[],startTime:null,pauseStartTime:null,totalPausedTime:0})},addPoint:(n,r,i)=>{const{state:s,currentPoints:o}=e();if(s!=="recording")return;if(o.length>0){const l=o[o.length-1];if(eEe(l.coordinates[0],l.coordinates[1],n,r)<2)return}const a={coordinates:[n,r],timestamp:Date.now(),accuracy:i};t({currentPoints:[...o,a]})},deleteRoute:n=>{t(r=>({savedRoutes:r.savedRoutes.filter(i=>i.id!==n)}))},renameRoute:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,name:r}:s)}))},clearAllRoutes:()=>{t({savedRoutes:[],visibleRouteIds:new Set})},toggleRouteVisibility:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.has(n)?i.delete(n):i.add(n),{visibleRouteIds:i}})},showRoute:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.add(n),{visibleRouteIds:i}})},hideRoute:n=>{t(r=>{const i=new Set(r.visibleRouteIds);return i.delete(n),{visibleRouteIds:i}})},showAllRoutes:()=>{t(n=>({visibleRouteIds:new Set(n.savedRoutes.map(r=>r.id))}))},hideAllRoutes:()=>{t({visibleRouteIds:new Set})},toggleHeatmap:()=>{t(n=>({heatmapEnabled:!n.heatmapEnabled}))},setHeatmapEnabled:n=>{t({heatmapEnabled:n})},toggleGrid:()=>{t(n=>({gridEnabled:!n.gridEnabled}))},setGridEnabled:n=>{t({gridEnabled:n})},setGridCenter:n=>{t({gridCenter:n})},setGridSize:n=>{t({gridSize:n})},setGridCount:n=>{t({gridCount:n})},setGridColor:n=>{t({gridColor:n})},centerGridOnCurrentLocation:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(n=>{t({gridCenter:[n.coords.longitude,n.coords.latitude],gridEnabled:!0})},n=>{console.error("Could not get location:",n)})},setAutoPauseEnabled:n=>{t({autoPauseEnabled:n})},setAutoPauseSeconds:n=>{t({autoPauseSeconds:n})},importRouteFromGPX:(n,r)=>{try{const s=new DOMParser().parseFromString(n,"application/xml");if(s.querySelector("parsererror"))return{success:!1,error:"Ongeldig XML formaat"};const a=s.querySelectorAll("trkpt");if(a.length<2&&s.querySelectorAll("wpt").length<2)return{success:!1,error:"Geen route punten gevonden in GPX bestand"};const l=[];if((a.length>0?a:s.querySelectorAll("wpt")).forEach(b=>{const T=parseFloat(b.getAttribute("lat")||"0"),A=parseFloat(b.getAttribute("lon")||"0"),I=b.querySelector("time"),R=I?new Date(I.textContent||"").getTime():Date.now();!isNaN(T)&&!isNaN(A)&&l.push({coordinates:[A,T],timestamp:isNaN(R)?Date.now():R})}),l.length<2)return{success:!1,error:"Niet genoeg geldige punten in GPX bestand"};const u=s.querySelector("trk > name")?.textContent||s.querySelector("metadata > name")?.textContent||r||`Import ${new Date().toLocaleDateString("nl-NL")}`,h=D8(l),f=l[0].timestamp,g=l[l.length-1].timestamp,v=g-f,x={id:crypto.randomUUID(),name:u,points:l,startTime:f,endTime:g,totalDistance:h,totalDuration:v>0?v:0,pausedDuration:0,createdAt:new Date().toISOString()};return t(b=>{const T=new Set(b.visibleRouteIds);return T.add(x.id),{savedRoutes:[x,...b.savedRoutes],visibleRouteIds:T}}),{success:!0,routeId:x.id}}catch(i){return console.error("GPX import error:",i),{success:!1,error:"Fout bij importeren van GPX bestand"}}},updateRouteNotes:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,notes:r}:s)}))},addPhotoToRoute:(n,r)=>{const i={...r,id:crypto.randomUUID(),timestamp:new Date().toISOString()};t(s=>({savedRoutes:s.savedRoutes.map(o=>o.id===n?{...o,photos:[...o.photos||[],i]}:o)}))},removePhotoFromRoute:(n,r)=>{t(i=>({savedRoutes:i.savedRoutes.map(s=>s.id===n?{...s,photos:(s.photos||[]).filter(o=>o.id!==r)}:s)}))},getCurrentDistance:()=>{const{currentPoints:n}=e();return D8(n)},getCurrentDuration:()=>{const{state:n,startTime:r,totalPausedTime:i,pauseStartTime:s}=e();if(!r)return 0;const o=Date.now();let a=i;return n==="paused"&&s&&(a+=o-s),o-r-a},getAverageSpeed:()=>{const n=e().getCurrentDistance(),r=e().getCurrentDuration();return r===0?0:n/1e3/(r/36e5)}}),{name:"detectorapp-route-recording",version:2,partialize:t=>({savedRoutes:t.savedRoutes,visibleRouteIds:Array.from(t.visibleRouteIds),heatmapEnabled:t.heatmapEnabled,gridEnabled:t.gridEnabled,gridCenter:t.gridCenter,gridSize:t.gridSize,gridCount:t.gridCount,gridColor:t.gridColor,autoPauseEnabled:t.autoPauseEnabled,autoPauseSeconds:t.autoPauseSeconds}),merge:(t,e)=>({...e,...t,visibleRouteIds:new Set(t?.visibleRouteIds||[])})}));function tEe(t){const e=`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="DetectorApp NL"
  xmlns="http://www.topografix.com/GPX/1/1"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd">
  <metadata>
    <name>${t.name}</name>
    <time>${new Date(t.startTime).toISOString()}</time>
  </metadata>
  <trk>
    <name>${t.name}</name>
    <trkseg>
${t.points.map(s=>`      <trkpt lat="${s.coordinates[1]}" lon="${s.coordinates[0]}">
        <time>${new Date(s.timestamp).toISOString()}</time>
      </trkpt>`).join(`
`)}
    </trkseg>
  </trk>
</gpx>`,n=new Blob([e],{type:"application/gpx+xml"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`${t.name.replace(/[^a-zA-Z0-9]/g,"-")}.gpx`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}let sg=null,zT=null;function nEe(){if(typeof window>"u"||!("speechSynthesis"in window))return!1;sg=window.speechSynthesis;const t=()=>{const e=sg?.getVoices()||[];zT=e.find(n=>n.lang.startsWith("nl")||n.name.toLowerCase().includes("dutch")||n.name.toLowerCase().includes("nederland"))||null,!zT&&e.length>0&&(zT=e[0])};return t(),sg&&(sg.onvoiceschanged=t),!0}function vSt(t,e){if(!sg&&!nEe()||!sg)return;sg.cancel();const n=new SpeechSynthesisUtterance(t);zT&&(n.voice=zT),n.lang="nl-NL",n.rate=e?.rate,n.pitch=e?.pitch??1,n.volume=e?.volume??1,sg.speak(n)}function _St(t){const e=[];e.push(`${t.type} toegevoegd`),t.material&&t.material!=="Onbekend"&&e.push(`Materiaal: ${t.material}`),t.period&&t.period!=="Onbekend"&&e.push(`Periode: ${t.period}`),t.layerName&&t.layerName!=="Vondsten"&&e.push(`Opgeslagen in ${t.layerName}`);const n=e.join(". ");vSt(n,{rate:1.1})}nEe();const xSt="detectorapp-photos",wSt=1,UN="photos",bSt=1024,ESt=200,SSt=.8,TSt=.7;function kSt(){return new Promise((t,e)=>{const n=indexedDB.open(xSt,wSt);n.onerror=()=>e(n.error),n.onsuccess=()=>t(n.result),n.onupgradeneeded=r=>{const i=r.target.result;i.objectStoreNames.contains(UN)||i.createObjectStore(UN,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1})}})}async function Eoe(t,e,n){return new Promise((r,i)=>{const s=new Image,o=URL.createObjectURL(t);s.onload=()=>{URL.revokeObjectURL(o);let{width:a,height:l}=s;(a>e||l>e)&&(a>l?(l=Math.round(l*e/a),a=e):(a=Math.round(a*e/l),l=e));const c=document.createElement("canvas");c.width=a,c.height=l;const u=c.getContext("2d");if(!u){i(new Error("Could not get canvas context"));return}u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.drawImage(s,0,0,a,l),c.toBlob(h=>{h?r({blob:h,width:a,height:l}):i(new Error("Could not create blob"))},"image/jpeg",n)},s.onerror=()=>{URL.revokeObjectURL(o),i(new Error("Could not load image"))},s.src=o})}async function ASt(t,e){const{blob:n,width:r,height:i}=await Eoe(e,bSt,SSt),{blob:s}=await Eoe(e,ESt,TSt),o={id:t,fullImage:n,thumbnail:s,originalName:e.name,mimeType:"image/jpeg",width:r,height:i,size:n.size,createdAt:new Date().toISOString()},a=await kSt();return new Promise((l,c)=>{const u=a.transaction(UN,"readwrite"),f=u.objectStore(UN).put(o);f.onsuccess=()=>l(o),f.onerror=()=>c(f.error),u.oncomplete=()=>a.close()})}function $8({label:t,value:e,onChange:n,options:r,required:i=!1,placeholder:s="Typ hier..."}){const[o,a]=X.useState(!1),[l,c]=X.useState(!1),[u,h]=X.useState(""),f=e&&!r.includes(e),g=()=>{c(!0),h(f?e:""),a(!1)},v=()=>{u.trim()&&n(u.trim()),c(!1)};return l?m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[t,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:u,onChange:x=>h(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),v()),x.key==="Escape"&&c(!1)},onBlur:v,placeholder:s,autoFocus:!0,className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}):m.jsxs("div",{className:"relative",children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:[t,i&&m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsxs("button",{type:"button",onClick:()=>a(!o),className:"w-full flex items-center justify-between px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors text-left",style:{border:"none",outline:"none"},children:[m.jsxs("span",{className:e?"":"text-gray-400",children:[e||"Selecteer...",f&&m.jsx(nse,{size:12,className:"inline ml-1 text-orange-500"})]}),m.jsx(ab,{size:16,className:`text-gray-400 transition-transform ${o?"rotate-180":""}`})]}),o&&m.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[m.jsxs("button",{type:"button",onClick:g,className:"w-full px-3 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 transition-colors flex items-center gap-2",style:{border:"none",outline:"none"},children:[m.jsx(nse,{size:12}),"Eigen invoer..."]}),m.jsx("div",{className:"border-t border-gray-100"}),r.map(x=>m.jsx("button",{type:"button",onClick:()=>{n(x),a(!1)},className:`w-full px-3 py-2 text-left text-sm transition-colors ${x===e?"bg-orange-50 text-orange-600":"text-gray-600 hover:bg-gray-50"}`,style:{border:"none",outline:"none"},children:x},x))]})]})}function rEe({onClose:t,initialLocation:e}){const n=bs(qe=>qe.position),r=es(qe=>qe.map),i=ri(qe=>qe.vondstFormPhoto),s=Po(qe=>qe.layers),o=Po(qe=>qe.addPoint);Po(qe=>qe.addPhotoToPoint);const a=Nn(qe=>qe.voiceFeedbackEnabled),l=xl(qe=>qe.state),c=xl(qe=>qe.startTime);xl(qe=>qe.savedRoutes);const u=()=>l==="idle"||!c?null:`Route ${new Date(c).toLocaleDateString("nl-NL")} ${new Date(c).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})}`,h=l==="recording"||l==="paused",f=u(),[g,v]=X.useState(""),[x,b]=X.useState(""),[T,A]=X.useState(""),[I,R]=X.useState(""),[C,V]=X.useState(!1),[M,N]=X.useState(void 0),[O,F]=X.useState(void 0),[L,B]=X.useState(Uc),[U,de]=X.useState(i),[me,ze]=X.useState(null);X.useEffect(()=>{if(U){const qe=URL.createObjectURL(U);return ze(qe),()=>URL.revokeObjectURL(qe)}else ze(null)},[U]);const[Le,fe]=X.useState(e?"map-pick":n?"gps":"map-center"),[$e,Ce]=X.useState(e||null),[le,W]=X.useState(!1),ne=()=>{if(Le==="gps"&&n)return{lat:n.lat,lng:n.lng};if(Le==="map-pick"&&$e)return $e;if(r){const qe=r.getView().getCenter();if(qe){const[sn,$t]=Zn(qe);return{lat:$t,lng:sn}}}return null},se=ne();X.useEffect(()=>{if(!le||!r)return;const qe=sn=>{const[$t,fn]=Zn(sn.coordinate);Ce({lat:fn,lng:$t}),fe("map-pick"),W(!1)};return r.on("click",qe),()=>r.un("click",qe)},[le,r]);const ae=()=>W(!0),_e=()=>{n&&(fe("gps"),Ce(null))},Ke=()=>{const qe=document.createElement("input");qe.type="file",qe.accept="image/*",qe.capture="environment",qe.onchange=sn=>{const $t=sn.target.files?.[0];$t&&de($t)},qe.click()},Ye=()=>de(null),ke=async qe=>{qe.preventDefault();const sn=ne();if(!sn){alert("Geen locatie beschikbaar");return}if(!x){alert("Vul een naam/type in");return}V(!0);try{let $t=g||"";if(L===Uc){const dt=[];T&&dt.push(`Materiaal: ${T}`),I&&dt.push(`Periode: ${I}`),M&&dt.push(`Gewicht: ${M}g`),O&&dt.push(`Lengte: ${O}mm`),dt.length>0&&($t=dt.join(" | ")+(g?` | ${g}`:""))}let fn;if(U){const dt=crypto.randomUUID();try{const lr=await ASt(dt,U),$n=await Te(lr.thumbnail);fn={id:dt,thumbnailBase64:$n,createdAt:lr.createdAt}}catch(lr){console.error("Failed to save photo:",lr)}}o(L,{coordinates:[sn.lng,sn.lat],name:x,category:L===Uc?x:"Overig",notes:$t||"",...fn?{photos:[fn]}:{},...h&&c?{routeId:`recording-${c}`,routeName:f||void 0}:{}});const yn=s.find(dt=>dt.id===L)?.name||"Vondsten";a&&_St({type:x,material:T||void 0,period:I||void 0,layerName:yn}),alert(`Toegevoegd aan ${yn}! ${fn?" (met foto)":""}`),t()}catch($t){alert("Fout bij opslaan: "+$t.message)}finally{V(!1)}},Te=qe=>new Promise((sn,$t)=>{const fn=new FileReader;fn.onloadend=()=>sn(fn.result),fn.onerror=$t,fn.readAsDataURL(qe)}),Dt=X.useMemo(()=>s.map(qe=>({id:qe.id,name:qe.name,color:qe.color})),[s]);return le?m.jsx(Ct.div,{className:"fixed bottom-0 left-0 right-0 z-[2000] p-4",initial:{y:100},animate:{y:0},exit:{y:100},children:m.jsxs("div",{className:"bg-orange-500 text-white rounded-xl shadow-xl p-4 flex items-center justify-between max-w-md mx-auto",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(aN,{size:24,className:"animate-pulse"}),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium",children:"Tik op de kaart"}),m.jsx("div",{className:"text-sm opacity-90",children:"om locatie te kiezen"})]})]}),m.jsx("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"})]})}):m.jsx(Ct.div,{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:m.jsxs(Ct.div,{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[m.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white px-5 py-4 flex justify-between items-center flex-shrink-0",children:[m.jsx("h2",{className:"text-lg font-semibold",children:"Nieuwe Vondst"}),m.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors border-0 outline-none",children:m.jsx(Ei,{size:20})})]}),m.jsxs("form",{onSubmit:ke,className:"flex-1 overflow-y-auto",children:[m.jsxs("div",{className:"p-5 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto"}),me?m.jsxs("div",{className:"relative",children:[m.jsx("img",{src:me,alt:"Vondst",className:"w-full h-40 object-cover rounded-xl"}),m.jsx("button",{type:"button",onClick:Ye,className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors border-0 outline-none shadow-lg",children:m.jsx(wp,{size:16})})]}):m.jsxs("button",{type:"button",onClick:Ke,className:"w-full h-32 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-2 hover:bg-gray-100 transition-colors text-gray-500 border-2 border-dashed border-gray-200",style:{outline:"none"},children:[m.jsx(KO,{size:32}),m.jsx("span",{className:"text-sm",children:"Maak een foto"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locatie"}),se&&m.jsxs("div",{className:"bg-orange-50 rounded-xl px-4 py-3 mb-2",children:[m.jsxs("div",{className:"text-sm text-orange-800 font-mono",children:[se.lat.toFixed(6),"N, ",se.lng.toFixed(6),"E"]}),m.jsx("div",{className:"text-xs text-orange-600 mt-1",children:Le==="gps"?" GPS locatie":Le==="map-pick"?" Gekozen op kaart":" Kaart midden"})]}),!se&&m.jsx("div",{className:"bg-red-50 rounded-xl px-4 py-3 mb-2",children:m.jsx("div",{className:"text-sm text-red-600",children:"Geen locatie beschikbaar"})}),m.jsxs("div",{className:"flex gap-2",children:[n&&Le!=="gps"&&m.jsxs("button",{type:"button",onClick:_e,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors border-0 outline-none",children:[m.jsx(cb,{size:16}),"GPS"]}),m.jsxs("button",{type:"button",onClick:ae,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors border-0 outline-none",children:[m.jsx(aN,{size:16}),"Kies op kaart"]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Opslaan naar"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:Dt.map(qe=>m.jsx("button",{type:"button",onClick:()=>B(qe.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all border-0 outline-none ${L===qe.id?"bg-gray-800 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:qe.name},qe.id))})]}),L===Uc&&m.jsx($8,{label:"Type vondst",value:x,onChange:b,options:["Munt","Aardewerk","Gesp","Fibula","Ring","Speld","Sieraad","Gereedschap","Wapen","Anders"],required:!0,placeholder:"Typ type vondst..."}),L!==Uc&&m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:["Naam",m.jsx("span",{className:"text-orange-500 ml-0.5",children:"*"})]}),m.jsx("input",{type:"text",value:x,onChange:qe=>b(qe.target.value),placeholder:"Naam van het punt...",className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"}})]}),L===Uc&&m.jsxs(m.Fragment,{children:[m.jsx($8,{label:"Materiaal",value:T,onChange:A,options:["Brons","IJzer","Zilver","Goud","Koper","Lood","Tin","Keramiek","Steen","Glas","Bot","Hout","Leer","Onbekend"],placeholder:"Typ materiaal..."}),m.jsx($8,{label:"Periode",value:I,onChange:R,options:["Steentijd","Bronstijd","IJzertijd","Romeins","Middeleeuws","Nieuwetijd","Modern","Onbekend"],placeholder:"Typ periode..."}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Gewicht (g)"}),m.jsx("input",{type:"number",value:M??"",onChange:qe=>N(qe.target.value?parseFloat(qe.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]}),m.jsxs("div",{className:"flex-1",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Lengte (mm)"}),m.jsx("input",{type:"number",value:O??"",onChange:qe=>F(qe.target.value?parseFloat(qe.target.value):void 0),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all",style:{border:"none",outline:"none"},min:"0",step:"0.1"})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notities"}),m.jsx("textarea",{value:g,onChange:qe=>v(qe.target.value),className:"w-full px-3 py-2.5 bg-gray-50 rounded-lg text-gray-700 focus:bg-white focus:ring-2 focus:ring-orange-500 transition-all resize-none h-20",style:{border:"none",outline:"none"},placeholder:"Beschrijving, context, vindplaats details..."})]}),m.jsx("div",{className:"rounded-xl px-4 py-3 bg-orange-50",children:m.jsx("p",{className:"text-sm text-orange-700",children:' Opgeslagen in "Mijn Lagen" op dit apparaat'})})]}),m.jsxs("div",{className:"p-5 pt-0 flex gap-3",children:[m.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors font-medium border-0 outline-none",children:"Annuleren"}),m.jsx("button",{type:"submit",disabled:C||!se||le||!x,className:"flex-1 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium border-0 outline-none",children:C?"Opslaan...":"Opslaan"})]})]})]})})}function ISt(){const{user:t,setUser:e,setLoading:n}=G5();return X.useEffect(()=>{const s=fce(Iy,o=>{e(o),n(!1)});return()=>s()},[e,n]),{user:t,loginAnonymous:async()=>{try{await r3e(Iy)}catch(s){console.error("Login failed:",s)}},logout:async()=>{try{await pce(Iy)}catch(s){console.error("Logout failed:",s)}},isAuthenticated:!!t}}function RSt(){const{isAuthenticated:t,loginAnonymous:e}=ISt(),n=Nn(c=>c.vondstenLocalOnly),r=Nn(c=>c.showVondstButton),i=ri(c=>c.vondstFormOpen),s=ri(c=>c.vondstFormLocation),o=ri(c=>c.openVondstForm),a=ri(c=>c.closeVondstForm);if(!r)return null;const l=()=>{if(n){o();return}if(!t){confirm("Je moet ingelogd zijn om vondsten in de cloud op te slaan. Anoniem inloggen?")&&e();return}o()};return m.jsxs(m.Fragment,{children:[m.jsx(Ct.button,{className:"fixed bottom-2 right-[60px] z-[1000] w-11 h-11 bg-orange-500 hover:bg-orange-600 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:l,title:"Vondst toevoegen",children:m.jsx(fc,{size:22,strokeWidth:2})}),m.jsx(ar,{children:i&&m.jsx(rEe,{onClose:a,initialLocation:s||void 0})})]})}function PSt(){const t=Nn(Te=>Te.showRouteRecordButton),e=Nn(Te=>Te.showVondstButton),n=ri(Te=>Te.toggleRouteDashboard),{state:r,startRecording:i,pauseRecording:s,resumeRecording:o,stopRecording:a,cancelRecording:l,addPoint:c,getCurrentDistance:u,getCurrentDuration:h,getAverageSpeed:f,currentPoints:g,savedRoutes:v,autoPauseEnabled:x,autoPauseSeconds:b}=xl(),[T,A]=X.useState(!1),[I,R]=X.useState(""),[C,V]=X.useState(!1),[M,N]=X.useState(!1),O=X.useRef(null),F=X.useRef(null),L=X.useRef(null),B=Te=>{const Dt=Math.floor(Te/1e3),qe=Math.floor(Dt/3600),sn=Math.floor(Dt%3600/60),$t=Dt%60;return qe>0?`${qe}:${sn.toString().padStart(2,"0")}:${$t.toString().padStart(2,"0")}`:`${sn}:${$t.toString().padStart(2,"0")}`},U=Te=>Te<1e3?`${Math.round(Te)} m`:`${(Te/1e3).toFixed(2)} km`,de=Te=>`${Te.toFixed(1)} km/h`,me=(Te,Dt,qe,sn)=>{const fn=(sn-Dt)*Math.PI/180,yn=(qe-Te)*Math.PI/180,dt=Math.sin(fn/2)*Math.sin(fn/2)+Math.cos(Dt*Math.PI/180)*Math.cos(sn*Math.PI/180)*Math.sin(yn/2)*Math.sin(yn/2);return 6371e3*(2*Math.atan2(Math.sqrt(dt),Math.sqrt(1-dt)))};if(X.useEffect(()=>(r==="recording"?(N(!1),"geolocation"in navigator&&O.current===null&&(O.current=navigator.geolocation.watchPosition(Te=>{const Dt=Te.coords.longitude,qe=Te.coords.latitude,sn=Date.now();c(Dt,qe,Te.coords.accuracy),x&&F.current?me(F.current.lon,F.current.lat,Dt,qe)>3?(F.current={lon:Dt,lat:qe,time:sn},L.current&&(clearTimeout(L.current),L.current=null)):sn-F.current.time>=b*1e3&&(s(),N(!0),F.current=null):F.current={lon:Dt,lat:qe,time:sn}},Te=>{console.error("GPS error:",Te)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e3}))):(O.current!==null&&(navigator.geolocation.clearWatch(O.current),O.current=null),L.current&&(clearTimeout(L.current),L.current=null)),()=>{O.current!==null&&(navigator.geolocation.clearWatch(O.current),O.current=null),L.current&&(clearTimeout(L.current),L.current=null)}),[r,c,x,b,s]),!t)return null;const ze=e?"right-[114px]":"right-[60px]",Le=e?"right-[168px]":"right-[114px]",fe=()=>{i(),V(!0)},$e=()=>{s()},Ce=()=>{o()},le=()=>{R(`Route ${new Date().toLocaleDateString("nl-NL")}`),A(!0)},W=()=>{const Te=a(I);A(!1),V(!1),R(""),Te&&confirm(`Route "${Te.name}" opgeslagen! (${U(Te.totalDistance)})

Direct exporteren als GPX?`)&&tEe(Te)},ne=()=>{g.length>2&&!confirm("Weet je zeker dat je de opname wilt annuleren? De route wordt niet opgeslagen.")||(l(),A(!1),V(!1))},se=u(),ae=h(),_e=f(),Ke=Te=>{switch(Te){case"recording":return"bg-red-500 hover:bg-red-600";case"paused":return"bg-yellow-500 hover:bg-yellow-600";default:return"bg-green-500 hover:bg-green-600"}},Ye=Te=>{switch(Te){case"recording":return m.jsx(dwe,{size:22,strokeWidth:2});case"paused":return m.jsx(pwe,{size:22,strokeWidth:2});default:return m.jsx(hN,{size:22,strokeWidth:2})}},ke=()=>{switch(r){case"idle":fe();break;case"recording":$e();break;case"paused":Ce();break}};return m.jsxs(m.Fragment,{children:[m.jsxs(Ct.button,{className:`fixed bottom-2 ${ze} z-[1000] w-11 h-11 ${Ke(r)} text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none backdrop-blur-sm`,whileHover:{scale:1.05},whileTap:{scale:.95},onClick:ke,title:r==="idle"?"Route opnemen":r==="recording"?"Pauzeren":"Hervatten",children:[Ye(r),r==="recording"&&m.jsx(Ct.div,{className:"absolute inset-0 rounded-xl bg-red-400",animate:{opacity:[.5,0,.5]},transition:{duration:1.5,repeat:1/0}})]}),m.jsx(ar,{children:r==="idle"&&v.length>0&&m.jsxs(Ct.button,{className:`fixed bottom-2 ${Le} z-[1000] w-11 h-11 bg-green-400 hover:bg-green-500 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:n,title:`Mijn routes (${v.length})`,children:[m.jsx(uwe,{size:18,strokeWidth:2}),m.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-white text-green-600 text-xs font-bold rounded-full flex items-center justify-center shadow-sm",children:v.length})]})}),m.jsx(ar,{children:(r==="recording"||r==="paused")&&m.jsx(Ct.button,{className:`fixed bottom-2 ${Le} z-[1000] w-11 h-11 bg-gray-700 hover:bg-gray-800 text-white rounded-xl shadow-sm flex items-center justify-center cursor-pointer border-0 outline-none`,initial:{opacity:0,scale:.8,x:20},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.8,x:20},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:le,title:"Stoppen en opslaan",children:m.jsx(Vct,{size:18,strokeWidth:2,fill:"currentColor"})})}),m.jsx(ar,{children:C&&r!=="idle"&&m.jsxs(Ct.div,{className:"fixed bottom-16 right-2 z-[999] bg-white/95 backdrop-blur-sm rounded-xl shadow-lg p-3 min-w-[180px]",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},children:[m.jsxs("div",{className:"flex items-center justify-between mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:r==="recording"?" Opname":M?" Auto-pauze":" Gepauzeerd"}),m.jsx("button",{onClick:()=>V(!1),className:"p-0.5 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:m.jsx(Ei,{size:14})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Qk,{size:16,className:"text-green-500"}),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:U(se)})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(oN,{size:16,className:"text-blue-500"}),m.jsx(MSt,{duration:ae,recordingState:r,formatTime:B})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Clt,{size:16,className:"text-green-500"}),m.jsx("span",{className:"text-sm text-gray-600",children:de(_e)})]}),m.jsxs("div",{className:"text-xs text-gray-400 pt-1 border-t border-gray-100",children:[g.length," punten opgenomen"]})]})]})}),m.jsx(ar,{children:T&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1500] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>A(!1)}),m.jsxs(Ct.div,{className:"fixed left-4 right-4 top-1/2 z-[1501] bg-white rounded-xl shadow-2xl p-4 max-w-sm mx-auto",initial:{opacity:0,scale:.9,y:"-40%"},animate:{opacity:1,scale:1,y:"-50%"},exit:{opacity:0,scale:.9,y:"-40%"},children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Route opslaan"}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Afstand:"}),m.jsx("span",{className:"font-medium",children:U(se)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Duur:"}),m.jsx("span",{className:"font-medium",children:B(ae)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Gem. snelheid:"}),m.jsx("span",{className:"font-medium",children:de(_e)})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{className:"text-gray-500",children:"Punten:"}),m.jsx("span",{className:"font-medium",children:g.length})]})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Naam van de route"}),m.jsx("input",{type:"text",value:I,onChange:Te=>R(Te.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Route naam...",autoFocus:!0})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:ne,className:"flex-1 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none",children:"Annuleren"}),m.jsxs("button",{onClick:W,disabled:g.length<2,className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[m.jsx(mwe,{size:16}),"Opslaan"]})]}),g.length<2&&m.jsx("p",{className:"text-xs text-red-500 text-center mt-2",children:"Minimaal 2 punten nodig om op te slaan"})]})]})})]})}function MSt({duration:t,recordingState:e,formatTime:n}){const[r,i]=X.useState(t);return X.useEffect(()=>{if(e!=="recording"){i(t);return}const s=setInterval(()=>{i(o=>o+1e3)},1e3);return()=>clearInterval(s)},[e,t]),X.useEffect(()=>{i(t)},[t]),m.jsx("span",{className:"text-lg font-semibold text-gray-800",children:n(r)})}function CSt(){const t=es(s=>s.map),{currentPoints:e,state:n}=xl(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!t)return;const s=new Nd;i.current=s;const o=new gp({source:s,zIndex:999,properties:{name:"route-recording-layer"}});return r.current=o,t.addLayer(o),()=>{r.current&&t&&t.removeLayer(r.current)}},[t]),X.useEffect(()=>{if(!i.current||(i.current.clear(),n==="idle"||e.length===0))return;const s=e.map(o=>Pi(o.coordinates));if(s.length>=2){const o=new _i({geometry:new ro(s)});o.setStyle(new zn({stroke:new Sr({color:n==="paused"?"rgba(234, 179, 8, 0.8)":"rgba(168, 85, 247, 0.8)",width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(o)}if(s.length>=1){const o=new _i({geometry:new Vs(s[0])});o.setStyle(new zn({image:new $a({radius:8,fill:new Nr({color:"rgba(34, 197, 94, 1)"}),stroke:new Sr({color:"white",width:2})})})),i.current.addFeature(o)}if(s.length>=1){const o=new _i({geometry:new Vs(s[s.length-1])});o.setStyle(new zn({image:new $a({radius:6,fill:new Nr({color:n==="paused"?"rgba(234, 179, 8, 1)":"rgba(168, 85, 247, 1)"}),stroke:new Sr({color:"white",width:2})})})),i.current.addFeature(o)}},[e,n]),null}const Soe=["#a855f7","#3b82f6","#22c55e","#f97316","#ec4899","#14b8a6","#eab308","#8b5cf6"];function NSt(){const t=es(s=>s.map),{savedRoutes:e,visibleRouteIds:n}=xl(),r=X.useRef(null),i=X.useRef(null);return X.useEffect(()=>{if(!t)return;const s=new Nd;i.current=s;const o=new gp({source:s,zIndex:998,properties:{name:"saved-routes-layer"}});return r.current=o,t.addLayer(o),()=>{r.current&&t&&t.removeLayer(r.current)}},[t]),X.useEffect(()=>{if(!i.current)return;i.current.clear(),e.filter(o=>n.has(o.id)).forEach((o,a)=>{const l=Soe[a%Soe.length],c=o.points.map(x=>Pi(x.coordinates));if(c.length<2)return;const u=new _i({geometry:new ro(c),routeId:o.id,routeName:o.name});u.setStyle(new zn({stroke:new Sr({color:l,width:4,lineCap:"round",lineJoin:"round"})})),i.current.addFeature(u);const h=new _i({geometry:new Vs(c[0]),routeId:o.id,type:"start"});h.setStyle(new zn({image:new $a({radius:8,fill:new Nr({color:"#22c55e"}),stroke:new Sr({color:"white",width:2})}),text:new th({text:"S",font:"bold 10px sans-serif",fill:new Nr({color:"white"}),offsetY:1})})),i.current.addFeature(h);const f=new _i({geometry:new Vs(c[c.length-1]),routeId:o.id,type:"end"});f.setStyle(new zn({image:new $a({radius:8,fill:new Nr({color:"#ef4444"}),stroke:new Sr({color:"white",width:2})}),text:new th({text:"E",font:"bold 10px sans-serif",fill:new Nr({color:"white"}),offsetY:1})})),i.current.addFeature(f);const g=Math.floor(c.length/2),v=new _i({geometry:new Vs(c[g]),routeId:o.id,type:"label"});v.setStyle(new zn({text:new th({text:o.name,font:"12px sans-serif",fill:new Nr({color:"#1f2937"}),stroke:new Sr({color:"white",width:3}),offsetY:-15})})),i.current.addFeature(v)})},[e,n]),null}function OSt(){const t=es(o=>o.map),{savedRoutes:e,visibleRouteIds:n,heatmapEnabled:r}=xl(),i=X.useRef(null),s=X.useRef(null);return X.useEffect(()=>{if(!t)return;const o=new Nd;s.current=o;const a=new ZIe({source:o,blur:15,radius:10,weight:()=>1,gradient:["#00f","#0ff","#0f0","#ff0","#f00"],opacity:.6,zIndex:90});return i.current=a,t.addLayer(a),()=>{t&&i.current&&t.removeLayer(i.current)}},[t]),X.useEffect(()=>{if(!s.current||!i.current)return;if(s.current.clear(),!r){i.current.setVisible(!1);return}const o=e.filter(l=>n.has(l.id)),a=[];for(const l of o)for(const c of l.points){const u=new _i({geometry:new Vs(Pi(c.coordinates))});a.push(u)}s.current.addFeatures(a),i.current.setVisible(a.length>0)},[e,n,r]),null}function LSt(t,e,n,r){const i=[],s=e/111e3,o=e/(111e3*Math.cos(t[1]*Math.PI/180)),a=Math.floor(n/2),l=t[0]-a*o,c=t[0]+a*o,u=t[1]-a*s,h=t[1]+a*s;for(let x=-a;x<=a;x++){const b=t[0]+x*o,T=[Pi([b,u]),Pi([b,h])],A=new _i({geometry:new ro(T),type:"grid-line"});A.setStyle(new zn({stroke:new Sr({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(A)}for(let x=-a;x<=a;x++){const b=t[1]+x*s,T=[Pi([l,b]),Pi([c,b])],A=new _i({geometry:new ro(T),type:"grid-line"});A.setStyle(new zn({stroke:new Sr({color:r,width:x===0?2:1,lineDash:x===0?void 0:[5,5]})})),i.push(A)}const f="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let x=-a;x<a;x++)for(let b=-a;b<a;b++){const T=t[0]+(b+.5)*o,A=t[1]+(x+.5)*s,I=x+a,R=b+a;if(I>=0&&I<f.length){const C=`${f[I]}${R+1}`,V=new _i({geometry:new ro([Pi([T,A]),Pi([T,A])]),type:"grid-label"});V.setStyle(new zn({text:new th({text:C,font:"12px sans-serif",fill:new Nr({color:r}),stroke:new Sr({color:"rgba(255,255,255,0.8)",width:3})})})),i.push(V)}}const g=new _i({geometry:new ro([Pi([t[0]-o*.2,t[1]]),Pi([t[0]+o*.2,t[1]])]),type:"grid-center"});g.setStyle(new zn({stroke:new Sr({color:"#ef4444",width:3})})),i.push(g);const v=new _i({geometry:new ro([Pi([t[0],t[1]-s*.2]),Pi([t[0],t[1]+s*.2])]),type:"grid-center"});return v.setStyle(new zn({stroke:new Sr({color:"#ef4444",width:3})})),i.push(v),i}function DSt(){const t=es(l=>l.map),{gridEnabled:e,gridCenter:n,gridSize:r,gridCount:i,gridColor:s}=xl(),o=X.useRef(null),a=X.useRef(null);return X.useEffect(()=>{if(!t)return;const l=new Nd;a.current=l;const c=new gp({source:l,zIndex:85,properties:{name:"grid-overlay-layer"}});return o.current=c,t.addLayer(c),()=>{o.current&&t&&t.removeLayer(o.current)}},[t]),X.useEffect(()=>{if(!a.current||!o.current)return;if(a.current.clear(),!e||!n){o.current.setVisible(!1);return}const l=LSt(n,r,i,s);a.current.addFeatures(l),o.current.setVisible(!0)},[e,n,r,i,s]),null}function $St(t){const e=[];let n=0;return t.points.forEach((r,i)=>{if(i>0){const a=t.points[i-1],l=6371e3,c=(r.coordinates[1]-a.coordinates[1])*Math.PI/180,u=(r.coordinates[0]-a.coordinates[0])*Math.PI/180,h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(a.coordinates[1]*Math.PI/180)*Math.cos(r.coordinates[1]*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2),f=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));n+=l*f}const s=5,o=Math.sin(n/50)*2+Math.sin(n/120)*1.5+Math.sin(n/30+r.coordinates[0]*1e3)*.5;e.push({distance:n,elevation:Math.max(0,s+o)})}),e}function jSt({route:t,onClose:e}){const n=X.useRef(null),[r,i]=X.useState([]),[s,o]=X.useState({min:0,max:0,gain:0,loss:0});X.useEffect(()=>{const l=$St(t);if(i(l),l.length>0){const c=l.map(v=>v.elevation),u=Math.min(...c),h=Math.max(...c);let f=0,g=0;for(let v=1;v<l.length;v++){const x=l[v].elevation-l[v-1].elevation;x>0?f+=x:g+=Math.abs(x)}o({min:u,max:h,gain:f,loss:g})}},[t]),X.useEffect(()=>{const l=n.current;if(!l||r.length<2)return;const c=l.getContext("2d");if(!c)return;const u=l.width,h=l.height,f={top:20,right:20,bottom:30,left:40};c.fillStyle="#f9fafb",c.fillRect(0,0,u,h);const g=Math.max(...r.map(C=>C.distance)),v=Math.min(...r.map(C=>C.elevation))-1,x=Math.max(...r.map(C=>C.elevation))+1,b=C=>f.left+C/g*(u-f.left-f.right),T=C=>h-f.bottom-(C-v)/(x-v)*(h-f.top-f.bottom);c.strokeStyle="#e5e7eb",c.lineWidth=1;const A=5;for(let C=0;C<=A;C++){const V=v+(x-v)*(C/A),M=T(V);c.beginPath(),c.moveTo(f.left,M),c.lineTo(u-f.right,M),c.stroke(),c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="right",c.fillText(`${V.toFixed(1)}m`,f.left-5,M+3)}const I=5;for(let C=0;C<=I;C++){const V=g/I*C,M=b(V);c.fillStyle="#9ca3af",c.font="10px sans-serif",c.textAlign="center",c.fillText(V<1e3?`${Math.round(V)}m`:`${(V/1e3).toFixed(1)}km`,M,h-10)}c.beginPath(),c.moveTo(b(r[0].distance),h-f.bottom),r.forEach(C=>{c.lineTo(b(C.distance),T(C.elevation))}),c.lineTo(b(r[r.length-1].distance),h-f.bottom),c.closePath();const R=c.createLinearGradient(0,f.top,0,h-f.bottom);R.addColorStop(0,"rgba(139, 92, 246, 0.3)"),R.addColorStop(1,"rgba(139, 92, 246, 0.05)"),c.fillStyle=R,c.fill(),c.strokeStyle="#8b5cf6",c.lineWidth=2,c.lineJoin="round",c.lineCap="round",c.beginPath(),r.forEach((C,V)=>{const M=b(C.distance),N=T(C.elevation);V===0?c.moveTo(M,N):c.lineTo(M,N)}),c.stroke()},[r]);const a=l=>l<1e3?`${Math.round(l)} m`:`${(l/1e3).toFixed(2)} km`;return m.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed inset-4 z-[1700] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[70vh]",children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(T2,{size:20}),m.jsx("span",{className:"font-medium",children:"Hoogteprofiel"})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:m.jsx(Ei,{size:18})})]}),m.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:[m.jsx("h3",{className:"font-medium text-gray-800 truncate",children:t.name}),m.jsx("p",{className:"text-xs text-gray-500",children:a(t.totalDistance)})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-b border-gray-100",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-blue-500 mb-1",children:m.jsx(hwe,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Min"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.min.toFixed(1),"m"]})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-purple-500 mb-1",children:m.jsx(T2,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Max"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.max.toFixed(1),"m"]})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-green-500 mb-1",children:m.jsx(tut,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Stijging"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.gain.toFixed(1),"m"]})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"flex items-center justify-center text-red-500 mb-1",children:m.jsx(Qct,{size:14})}),m.jsx("div",{className:"text-xs text-gray-500",children:"Daling"}),m.jsxs("div",{className:"text-sm font-medium",children:[s.loss.toFixed(1),"m"]})]})]}),m.jsx("div",{className:"flex-1 p-3",children:m.jsx("canvas",{ref:n,width:350,height:200,className:"w-full h-full"})}),m.jsx("div",{className:"px-4 py-2 bg-yellow-50 border-t border-yellow-100",children:m.jsxs("p",{className:"text-xs text-yellow-700",children:[m.jsx("strong",{children:"Let op:"})," Dit zijn gesimuleerde hoogtewaarden. Koppeling met AHN-data komt binnenkort."]})})]})}const FSt=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(2)} km`,VSt=t=>{const e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60);return n>0?`${n}u ${r}m`:`${r} min`},Toe=t=>new Date(t).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function zSt({route:t,onClose:e}){const{updateRouteNotes:n,addPhotoToRoute:r,removePhotoFromRoute:i}=xl(),[s,o]=X.useState(t.notes||""),[a,l]=X.useState("info"),c=X.useRef(null),u=()=>{n(t.id,s)},h=async v=>{const x=v.target.files?.[0];if(!x)return;const b=URL.createObjectURL(x);r(t.id,{url:b,caption:x.name}),c.current&&(c.current.value="")},f=v=>{confirm("Foto verwijderen?")&&i(t.id,v)},g=xl(v=>v.savedRoutes.find(x=>x.id===t.id))||t;return m.jsxs(Ct.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[1700] flex items-center justify-center p-4",children:[m.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),m.jsxs(Ct.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"relative bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md max-h-[85vh] flex flex-col",children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("h3",{className:"font-medium truncate",children:g.name}),m.jsx("p",{className:"text-xs text-purple-200",children:Toe(g.createdAt)})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none ml-2",children:m.jsx(Ei,{size:18})})]}),m.jsxs("div",{className:"flex border-b border-gray-200",children:[m.jsxs("button",{onClick:()=>l("info"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="info"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[m.jsx(fc,{size:16,className:"inline mr-1"}),"Info"]}),m.jsxs("button",{onClick:()=>l("photos"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="photos"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[m.jsx(KO,{size:16,className:"inline mr-1"}),"Foto's (",g.photos?.length||0,")"]}),m.jsxs("button",{onClick:()=>l("notes"),className:`flex-1 py-2 text-sm font-medium border-0 outline-none transition-colors ${a==="notes"?"text-purple-600 border-b-2 border-purple-500":"text-gray-500 hover:text-gray-700"}`,children:[m.jsx(JW,{size:16,className:"inline mr-1"}),"Notities"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a==="info"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-purple-600 mb-1",children:[m.jsx(Qk,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Afstand"})]}),m.jsx("p",{className:"text-lg font-semibold",children:FSt(g.totalDistance)})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-blue-600 mb-1",children:[m.jsx(oN,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Duur"})]}),m.jsx("p",{className:"text-lg font-semibold",children:VSt(g.totalDuration)})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-green-600 mb-1",children:[m.jsx(fc,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Punten"})]}),m.jsxs("p",{className:"text-lg font-semibold",children:[g.points.length," GPS punten"]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[m.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-1",children:[m.jsx(XW,{size:16}),m.jsx("span",{className:"text-xs text-gray-500",children:"Aangemaakt"})]}),m.jsx("p",{className:"text-sm",children:Toe(g.createdAt)})]})]}),a==="photos"&&m.jsxs("div",{className:"space-y-4",children:[m.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:h,className:"hidden"}),m.jsxs("button",{onClick:()=>c.current?.click(),className:"w-full py-8 border-2 border-dashed border-purple-300 rounded-lg text-purple-500 hover:bg-purple-50 transition-colors flex flex-col items-center gap-2",children:[m.jsx(uu,{size:24}),m.jsx("span",{className:"text-sm",children:"Foto toevoegen"})]}),g.photos&&g.photos.length>0?m.jsx("div",{className:"grid grid-cols-2 gap-2",children:g.photos.map(v=>m.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[m.jsx("img",{src:v.url,alt:v.caption||"Route foto",className:"w-full h-full object-cover"}),m.jsx("button",{onClick:()=>f(v.id),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors border-0 outline-none",children:m.jsx(wp,{size:12})}),v.caption&&m.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-2 py-1 bg-black/50 text-white text-xs truncate",children:v.caption})]},v.id))}):m.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Nog geen foto's toegevoegd"})]}),a==="notes"&&m.jsxs("div",{className:"space-y-4",children:[m.jsx("textarea",{value:s,onChange:v=>o(v.target.value),placeholder:"Voeg notities toe over deze route...",className:"w-full h-48 p-3 border border-gray-300 rounded-lg outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"}),m.jsx("button",{onClick:u,className:"w-full px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors border-0 outline-none",children:"Notities opslaan"})]})]})]})]})}function USt({route:t,size:e=80}){const n=X.useRef(null);return X.useEffect(()=>{const r=n.current;if(!r||t.points.length<2)return;const i=r.getContext("2d");if(!i)return;i.fillStyle="#f3f4f6",i.fillRect(0,0,e,e);const s=t.points.map(R=>R.coordinates[0]),o=t.points.map(R=>R.coordinates[1]),a=Math.min(...s),l=Math.max(...s),c=Math.min(...o),u=Math.max(...o),h=8,f=e-h*2,g=e-h*2,v=R=>l===a?e/2:h+(R-a)/(l-a)*f,x=R=>u===c?e/2:h+g-(R-c)/(u-c)*g;i.strokeStyle="#a855f7",i.lineWidth=2,i.lineCap="round",i.lineJoin="round",i.beginPath(),t.points.forEach((R,C)=>{const V=v(R.coordinates[0]),M=x(R.coordinates[1]);C===0?i.moveTo(V,M):i.lineTo(V,M)}),i.stroke();const b=v(t.points[0].coordinates[0]),T=x(t.points[0].coordinates[1]);i.fillStyle="#22c55e",i.beginPath(),i.arc(b,T,4,0,Math.PI*2),i.fill();const A=v(t.points[t.points.length-1].coordinates[0]),I=x(t.points[t.points.length-1].coordinates[1]);i.fillStyle="#ef4444",i.beginPath(),i.arc(A,I,4,0,Math.PI*2),i.fill()},[t,e]),t.points.length<2?m.jsx("div",{className:"bg-gray-100 rounded flex items-center justify-center text-gray-400",style:{width:e,height:e},children:m.jsx(fc,{size:20})}):m.jsx("canvas",{ref:n,width:e,height:e,className:"rounded"})}const j8=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(2)} km`,F8=t=>{const e=Math.floor(t/1e3),n=Math.floor(e/3600),r=Math.floor(e%3600/60);return n>0?`${n}u ${r}m`:`${r} min`},koe=t=>new Date(t).toLocaleDateString("nl-NL",{day:"numeric",month:"short",year:"numeric"});function GSt({isOpen:t,onClose:e,onViewRoute:n}){const{savedRoutes:r,deleteRoute:i,renameRoute:s,clearAllRoutes:o,visibleRouteIds:a,toggleRouteVisibility:l,showAllRoutes:c,hideAllRoutes:u,heatmapEnabled:h,toggleHeatmap:f,gridEnabled:g,toggleGrid:v,centerGridOnCurrentLocation:x,gridSize:b,setGridSize:T,autoPauseEnabled:A,setAutoPauseEnabled:I,autoPauseSeconds:R,setAutoPauseSeconds:C,importRouteFromGPX:V}=xl(),[M,N]=X.useState(null),[O,F]=X.useState(""),[L,B]=X.useState(!1),[U,de]=X.useState(!1),[me,ze]=X.useState(null),[Le,fe]=X.useState(null),$e=X.useRef(null),Ce=async ke=>{const Te=` ${ke.name}

 Afstand: ${j8(ke.totalDistance)}
 Duur: ${F8(ke.totalDuration)}
 ${ke.points.length} GPS punten
 ${koe(ke.createdAt)}

Opgenomen met DetectorApp NL`;if(navigator.share)try{await navigator.share({title:ke.name,text:Te});return}catch(Dt){Dt.name!=="AbortError"&&console.error("Share failed:",Dt)}try{await navigator.clipboard.writeText(Te),alert("Route info gekopieerd naar klembord!")}catch{prompt("Kopieer de route info:",Te)}},le=async ke=>{const Te=ke.target.files?.[0];if(Te){try{const Dt=await Te.text(),qe=V(Dt,Te.name.replace(".gpx",""));qe.success?alert(`Route gemporteerd: ${Te.name}`):alert(`Import mislukt: ${qe.error}`)}catch{alert("Fout bij lezen van bestand")}$e.current&&($e.current.value="")}},W=ke=>{N(ke.id),F(ke.name)},ne=ke=>{O.trim()&&s(ke,O.trim()),N(null),F("")},se=ke=>{confirm(`Weet je zeker dat je "${ke.name}" wilt verwijderen?`)&&i(ke.id)},ae=()=>{r.length!==0&&confirm(`Weet je zeker dat je alle ${r.length} routes wilt verwijderen? Dit kan niet ongedaan worden gemaakt.`)&&o()},_e=ke=>{l(ke);const Te=r.find(Dt=>Dt.id===ke);Te&&n&&n(Te)},Ke=r.reduce((ke,Te)=>ke+Te.totalDistance,0),Ye=r.reduce((ke,Te)=>ke+Te.totalDuration,0);return m.jsxs(m.Fragment,{children:[m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1600] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1601] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-md mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-purple-500 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(hN,{size:20}),m.jsx("span",{className:"font-medium",children:"Mijn Routes"}),m.jsxs("span",{className:"text-purple-200 text-sm",children:["(",r.length,")"]})]}),m.jsx("button",{onClick:e,className:"p-1 rounded bg-purple-400/50 hover:bg-purple-400 transition-colors border-0 outline-none",children:m.jsx(Ei,{size:18})})]}),r.length>0&&m.jsxs("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100 flex items-center justify-between text-sm",children:[m.jsxs("div",{className:"flex gap-4",children:[m.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[m.jsx(Qk,{size:14}),m.jsxs("span",{children:["Totaal: ",j8(Ke)]})]}),m.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700",children:[m.jsx(oN,{size:14}),m.jsx("span",{children:F8(Ye)})]})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{onClick:()=>de(!U),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${A?"bg-green-100 text-green-600":"text-purple-600 hover:bg-purple-100"}`,title:A?"Auto-pauze uit":"Auto-pauze aan",children:m.jsx(Kct,{size:14})}),m.jsx("button",{onClick:()=>B(!L),className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${g?"bg-blue-100 text-blue-600":"text-purple-600 hover:bg-purple-100"}`,title:g?"Grid verbergen":"Grid tonen",children:m.jsx(lwe,{size:14})}),m.jsx("button",{onClick:f,className:`px-2 py-1 text-xs rounded transition-colors border-0 outline-none ${h?"bg-orange-100 text-orange-600":"text-purple-600 hover:bg-purple-100"}`,title:h?"Heatmap verbergen":"Heatmap tonen",children:m.jsx(Elt,{size:14})}),m.jsx("button",{onClick:c,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle tonen",children:m.jsx(uN,{size:14})}),m.jsx("button",{onClick:u,className:"px-2 py-1 text-xs text-purple-600 hover:bg-purple-100 rounded transition-colors border-0 outline-none",title:"Alle verbergen",children:m.jsx(cN,{size:14})})]})]}),m.jsx(ar,{children:L&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:m.jsxs("div",{className:"px-4 py-3 bg-blue-50 space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Grid Assistent"}),m.jsx("button",{onClick:v,className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${g?"bg-blue-500 text-white":"bg-blue-200 text-blue-700"}`,children:g?"Aan":"Uit"})]}),m.jsx("div",{className:"flex items-center gap-2",children:m.jsxs("button",{onClick:x,className:"flex-1 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",children:[m.jsx(aN,{size:14}),"Centreer op mijn locatie"]})}),m.jsxs("div",{className:"space-y-1",children:[m.jsxs("label",{className:"text-xs text-blue-700",children:["Celgrootte: ",b,"m"]}),m.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:b,onChange:ke=>T(Number(ke.target.value)),className:"w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer"}),m.jsxs("div",{className:"flex justify-between text-xs text-blue-600",children:[m.jsx("span",{children:"5m"}),m.jsx("span",{children:"50m"})]})]}),m.jsx("p",{className:"text-xs text-blue-600",children:"Gebruik het grid om systematisch een veld af te zoeken. Elk vak heeft een label (A1, B2, etc.) voor referentie."})]})})}),m.jsx(ar,{children:U&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden border-b border-purple-100",children:m.jsxs("div",{className:"px-4 py-3 bg-green-50 space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium text-green-800",children:"Auto-pauze"}),m.jsx("button",{onClick:()=>I(!A),className:`px-3 py-1 text-xs rounded-full transition-colors border-0 outline-none ${A?"bg-green-500 text-white":"bg-green-200 text-green-700"}`,children:A?"Aan":"Uit"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsxs("label",{className:"text-xs text-green-700",children:["Pauze na: ",R<60?`${R}s`:`${Math.floor(R/60)}m ${R%60}s`]}),m.jsx("input",{type:"range",min:"30",max:"300",step:"30",value:R,onChange:ke=>C(Number(ke.target.value)),className:"w-full h-2 bg-green-200 rounded-lg appearance-none cursor-pointer"}),m.jsxs("div",{className:"flex justify-between text-xs text-green-600",children:[m.jsx("span",{children:"30s"}),m.jsx("span",{children:"5min"})]})]}),m.jsxs("p",{className:"text-xs text-green-600",children:["De opname pauzeert automatisch als je langer dan ",R<60?`${R} seconden`:`${Math.floor(R/60)} minuten`," stilstaat. Ideaal voor pauzes tijdens het detecteren."]})]})})}),m.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:r.length===0?m.jsxs("div",{className:"text-center py-12 text-gray-500",children:[m.jsx(hN,{size:48,className:"mx-auto mb-3 text-gray-300"}),m.jsx("p",{className:"font-medium",children:"Nog geen routes"}),m.jsx("p",{className:"text-sm mt-1",children:"Start een opname om je eerste route vast te leggen"})]}):r.map(ke=>m.jsxs(Ct.div,{layout:!0,className:"bg-gray-50 rounded-lg p-3 flex gap-3",children:[m.jsx(USt,{route:ke,size:70}),m.jsxs("div",{className:"flex-1 min-w-0",children:[M===ke.id?m.jsx("input",{type:"text",value:O,onChange:Te=>F(Te.target.value),onKeyDown:Te=>{Te.key==="Enter"&&ne(ke.id),Te.key==="Escape"&&N(null)},onBlur:()=>ne(ke.id),className:"w-full px-2 py-1 text-sm bg-white border border-purple-300 rounded outline-none focus:ring-2 focus:ring-purple-400",autoFocus:!0}):m.jsx("h3",{className:"font-medium text-gray-800 truncate",children:ke.name}),m.jsx("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(XW,{size:12}),koe(ke.createdAt)]})}),m.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-600",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Qk,{size:12}),j8(ke.totalDistance)]}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(oN,{size:12}),F8(ke.totalDuration)]}),m.jsxs("span",{children:[ke.points.length," punten"]})]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>_e(ke.id),className:`p-1.5 rounded transition-colors border-0 outline-none ${a.has(ke.id)?"bg-purple-100 text-purple-600":"text-gray-400 hover:text-purple-600 hover:bg-purple-50"}`,title:a.has(ke.id)?"Verbergen op kaart":"Tonen op kaart",children:a.has(ke.id)?m.jsx(uN,{size:16}):m.jsx(cN,{size:16})}),m.jsx("button",{onClick:()=>W(ke),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam wijzigen",children:m.jsx(k2,{size:16})}),m.jsx("button",{onClick:()=>fe(ke),className:"p-1.5 text-gray-400 hover:text-cyan-600 hover:bg-cyan-50 rounded transition-colors border-0 outline-none",title:"Details & foto's",children:m.jsx(QW,{size:16})}),m.jsx("button",{onClick:()=>ze(ke),className:"p-1.5 text-gray-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Hoogteprofiel",children:m.jsx(T2,{size:16})}),m.jsx("button",{onClick:()=>Ce(ke),className:"p-1.5 text-gray-400 hover:text-pink-600 hover:bg-pink-50 rounded transition-colors border-0 outline-none",title:"Delen",children:m.jsx(Pct,{size:16})}),m.jsx("button",{onClick:()=>tEe(ke),className:"p-1.5 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteer als GPX",children:m.jsx(lN,{size:16})}),m.jsx("button",{onClick:()=>se(ke),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors border-0 outline-none",title:"Verwijderen",children:m.jsx(wp,{size:16})})]})]},ke.id))}),m.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 space-y-2",children:[m.jsx("input",{ref:$e,type:"file",accept:".gpx",onChange:le,className:"hidden"}),m.jsxs("button",{onClick:()=>$e.current?.click(),className:"w-full px-3 py-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors border-0 outline-none text-sm flex items-center justify-center gap-2",children:[m.jsx(AI,{size:16}),"GPX bestand importeren"]}),r.length>0&&m.jsx("button",{onClick:ae,className:"w-full px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border-0 outline-none text-sm",children:"Alle routes verwijderen"})]})]})]})}),m.jsx(ar,{children:me&&m.jsx(jSt,{route:me,onClose:()=>ze(null)})}),m.jsx(ar,{children:Le&&m.jsx(zSt,{route:Le,onClose:()=>fe(null)})})]})}const V8={lat:52.1326,lon:5.2913};function iEe({code:t,size:e=18}){return t===0?m.jsx(Uct,{size:e,className:"text-yellow-500"}):t>=1&&t<=3?m.jsx(hp,{size:e,className:"text-gray-400"}):t===45||t===48?m.jsx(tlt,{size:e,className:"text-gray-400"}):t>=51&&t<=67||t>=80&&t<=82?m.jsx(ZW,{size:e,className:"text-blue-500"}):t>=71&&t<=77||t>=85&&t<=86?m.jsx(llt,{size:e,className:"text-cyan-500"}):t>=95?m.jsx(rlt,{size:e,className:"text-purple-500"}):m.jsx(hp,{size:e,className:"text-gray-400"})}function BSt({degrees:t,size:e=14}){return m.jsx("div",{style:{transform:`rotate(${t+180}deg)`},className:"inline-flex",children:m.jsx(cb,{size:e,className:"text-blue-500"})})}function WSt({data:t}){if(!t||t.length===0)return null;const e=Math.max(...t.map(r=>r.precipitation),.5),n=t.some(r=>r.precipitation>0);return m.jsxs("div",{className:"space-y-1",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-[10px] text-gray-500",children:"Neerslag 2 uur"}),!n&&m.jsx("span",{className:"text-[10px] text-green-600 font-medium",children:"Droog"})]}),m.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-lg overflow-hidden",children:[m.jsx("div",{className:"absolute inset-0 flex items-end px-0.5",children:t.map((r,i)=>{const s=r.precipitation/e*100,o=r.precipitation>2?"bg-blue-600":r.precipitation>.5?"bg-blue-500":r.precipitation>0?"bg-blue-400":"bg-transparent";return m.jsx("div",{className:"flex-1 mx-px",children:m.jsx("div",{className:`w-full rounded-t transition-all ${o}`,style:{height:`${Math.max(s,r.precipitation>0?8:0)}%`}})},i)})}),m.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between px-1 text-[8px] text-gray-400",children:[m.jsx("span",{children:"Nu"}),m.jsx("span",{children:"+1u"}),m.jsx("span",{children:"+2u"})]})]})]})}function HSt({pollen:t}){const e=[{name:"Gras",value:t.grass},{name:"Berk",value:t.birch},{name:"Els",value:t.alder},{name:"Bijvoet",value:t.mugwort}].filter(i=>i.value>0).sort((i,s)=>s.value-i.value);if(e.length===0)return m.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-green-600",children:[m.jsx(tse,{size:12}),m.jsx("span",{children:"Lage pollenconcentratie"})]});const n=e[0],r=n.value>=4?"text-red-500":n.value>=3?"text-orange-500":n.value>=2?"text-amber-500":"text-green-600";return m.jsxs("div",{className:`flex items-center gap-1.5 text-[10px] ${r}`,children:[m.jsx(tse,{size:12}),m.jsxs("span",{children:[n.name,": ",n.value>=4?"Zeer hoog":n.value>=3?"Hoog":n.value>=2?"Matig":"Laag"]})]})}function qSt({hourly:t}){const e=t.slice(0,6);return e.length===0?null:m.jsxs("div",{className:"space-y-1",children:[m.jsx("div",{className:"text-[10px] text-gray-500",children:"Komende uren"}),m.jsx("div",{className:"flex gap-1",children:e.map((n,r)=>{const i=new Date(n.time),s=r===0;return m.jsxs("div",{className:`flex flex-col items-center p-1.5 rounded-lg flex-1 ${s?"bg-blue-100":"bg-gray-50"}`,children:[m.jsx("span",{className:"text-[9px] text-gray-500",children:s?"Nu":`${i.getHours()}u`}),m.jsx(iEe,{code:n.weatherCode,size:14}),m.jsxs("span",{className:"text-[10px] font-medium",children:[Math.round(n.temperature),""]})]},n.time)})})]})}function KSt(){const t=Nn(x=>x.showWeatherButton),e=Nn(x=>x.showFontSliders),n=Nn(x=>x.weatherFontScale),r=Nn(x=>x.setWeatherFontScale),i=bs(),s=KS(),[o,a]=X.useState(!1),l=12*n/100,c=KS(x=>x.showBuienradar),u=KS(x=>x.setShowBuienradar);if(X.useEffect(()=>{c&&a(!1)},[c]),X.useEffect(()=>{if(!t)return;const x=i.position||V8;(!s.weatherData||Date.now()-s.weatherData.lastUpdated>600*1e3)&&s.fetchWeather(x.lat,x.lon)},[t,i.position?.lat]),X.useEffect(()=>{if(!t)return;const x=setInterval(()=>{const b=i.position||V8;s.fetchWeather(b.lat,b.lon)},600*1e3);return()=>clearInterval(x)},[t,i.position?.lat]),!t)return null;const h=s.weatherData?.current,f=s.weatherData?.hourly||[],g=s.weatherData?.precipitation15min||[],v=s.weatherData?.pollen;return m.jsxs(m.Fragment,{children:[o&&m.jsx("div",{className:"fixed inset-0 z-[1099]",onClick:()=>a(!1)}),m.jsx(Ct.div,{className:"fixed left-2 z-[1100] bg-white shadow-lg border border-gray-200 select-none rounded-xl",style:{top:"max(0.5rem, env(safe-area-inset-top, 0.5rem))",width:o?"200px":"auto",maxWidth:"200px"},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},layout:!0,children:s.isLoading&&!h?m.jsxs("div",{className:"p-3 flex items-center gap-2",children:[m.jsx(mct,{size:16,className:"animate-spin text-blue-500"}),m.jsx("span",{className:"text-sm text-gray-500",children:"Laden..."})]}):h?m.jsxs("div",{className:"p-2.5",style:{fontSize:`${l}px`},children:[m.jsxs("button",{onClick:()=>a(!o),className:"w-full border-0 outline-none bg-transparent p-0",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(iEe,{code:h.weatherCode,size:24}),m.jsx("div",{className:"flex flex-col leading-tight",children:m.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[Math.round(h.temperature),""]})})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(rse,{size:14,className:"text-gray-400"}),m.jsx("span",{className:"text-sm text-gray-600",children:Math.round(h.windSpeed)}),m.jsx(BSt,{degrees:h.windDirection,size:12})]}),m.jsx("div",{className:"ml-auto",children:o?m.jsx(YO,{size:16,className:"text-gray-400"}):m.jsx(ab,{size:16,className:"text-gray-400"})})]}),m.jsxs("div",{className:"text-[11px] text-gray-500 text-left mt-1",children:[BLe[h.weatherCode]||"Onbekend",m.jsxs("span",{className:"text-gray-400 ml-1",children:[" ",Math.round(h.apparentTemperature),""]})]})]}),m.jsx(ar,{children:o&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:m.jsxs("div",{className:"pt-2 mt-2 border-t border-gray-200/50 space-y-3",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[m.jsx(ylt,{size:12,className:"text-blue-500"}),m.jsx("span",{children:"Vocht"})]}),m.jsxs("div",{className:"text-sm font-bold text-blue-600",children:[h.humidity,"%"]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[m.jsx(rse,{size:12,className:"text-gray-500"}),m.jsx("span",{children:"Windstoten"})]}),m.jsxs("div",{className:"text-sm font-bold text-gray-600",children:[Math.round(h.windGusts)," km/u"]})]}),m.jsxs("div",{className:"bg-cyan-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[m.jsx(cb,{size:12,className:"text-cyan-500"}),m.jsx("span",{children:"Wind"})]}),m.jsx("div",{className:"text-sm font-bold text-cyan-600",children:WLe(h.windDirection)})]}),m.jsxs("div",{className:"bg-purple-50 rounded-lg p-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500",children:[m.jsx(hp,{size:12,className:"text-purple-500"}),m.jsx("span",{children:"Bewolking"})]}),m.jsxs("div",{className:"text-sm font-bold text-purple-600",children:[h.cloudCover,"%"]})]})]}),m.jsxs("button",{onClick:()=>u(!c),className:`w-full flex items-center gap-2 p-2 rounded-lg transition-colors border-0 cursor-pointer ${c?"bg-blue-500 hover:bg-blue-600":"bg-blue-50 hover:bg-blue-100"}`,children:[m.jsx(ZW,{size:16,className:c?"text-white":"text-blue-500"}),m.jsx("span",{className:`text-sm font-medium ${c?"text-white":"text-blue-700"}`,children:"Buienradar"}),m.jsx("span",{className:`text-xs ml-auto ${c?"text-blue-100":"text-blue-500"}`,children:c?"Aan":"Uit"})]}),g.length>0&&m.jsx(WSt,{data:g}),f.length>0&&m.jsx(qSt,{hourly:f}),v&&m.jsx(HSt,{pollen:v}),m.jsxs("div",{className:"text-[9px] text-gray-400 text-center pt-1",children:["Bijgewerkt: ",new Date(s.weatherData.lastUpdated).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"})]}),e&&m.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200/50",children:[m.jsx(rH,{size:12,className:"text-gray-400"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:n,onChange:x=>r(parseInt(x.target.value)),className:"flex-1 h-1 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),m.jsxs("span",{className:"text-[10px] text-gray-400 w-8",children:[n,"%"]})]})]})})})]}):m.jsxs("button",{onClick:()=>{const x=i.position||V8;s.fetchWeather(x.lat,x.lon)},className:"p-3 flex items-center gap-2 border-0 outline-none bg-transparent",children:[m.jsx(hp,{size:18,className:"text-gray-400"}),m.jsx("span",{className:"text-sm text-gray-500",children:"Weer laden"})]})})]})}function YSt({isVisible:t,onClose:e}){const n=es(C=>C.map),r=X.useRef(null),i=X.useRef(null),[s,o]=X.useState([]),[a,l]=X.useState(0),[c,u]=X.useState(!0),[h,f]=X.useState(!0),[g,v]=X.useState("normal"),[x,b]=X.useState(70),T=g==="slow"?800:g==="normal"?500:250,A=X.useCallback(async()=>{f(!0);try{const V=await(await fetch("https://api.rainviewer.com/public/weather-maps.json")).json(),M=[];V.radar?.past&&V.radar.past.forEach(O=>{M.push({path:O.path,time:O.time*1e3})}),V.radar?.nowcast&&V.radar.nowcast.forEach(O=>{M.push({path:O.path,time:O.time*1e3})}),o(M);const N=V.radar?.past?.length?V.radar.past.length-1:0;l(N)}catch(C){console.error("Failed to fetch radar data:",C)}finally{f(!1)}},[]);X.useEffect(()=>{if(t){A();const C=setInterval(A,300*1e3);return()=>clearInterval(C)}},[t,A]),X.useEffect(()=>{if(!n||!t||s.length===0)return;const C=s[a];if(!C)return;const V=`https://tilecache.rainviewer.com${C.path}/256/{z}/{x}/{y}/2/1_1.png`;if(r.current){const M=r.current.getSource();M&&(M.setUrl(V),M.refresh())}else{const M=new hy({url:V,crossOrigin:"anonymous"}),N=new Am({source:M,opacity:x/100,zIndex:1500,properties:{name:"rain-radar-layer",title:"Buienradar"}});r.current=N,n.addLayer(N)}return()=>{}},[n,t,s,a]),X.useEffect(()=>{r.current&&r.current.setOpacity(x/100)},[x]),X.useEffect(()=>{!t&&r.current&&n&&(n.removeLayer(r.current),r.current=null)},[t,n]),X.useEffect(()=>()=>{r.current&&n&&(n.removeLayer(r.current),r.current=null),i.current&&clearInterval(i.current)},[n]),X.useEffect(()=>{if(!c||s.length===0||!t){i.current&&(clearInterval(i.current),i.current=null);return}return i.current=setInterval(()=>{l(C=>(C+1)%s.length)},T),()=>{i.current&&(clearInterval(i.current),i.current=null)}},[c,s.length,T,t]);const I=X.useCallback(()=>{if(s.length===0||!s[a])return"--:--";const C=s[a].time,V=Date.now(),M=Math.round((C-V)/6e4),O=new Date(C).toLocaleTimeString("nl-NL",{hour:"2-digit",minute:"2-digit"});return Math.abs(M)<3?`${O} (nu)`:M<0?`${O} (${M}m)`:`${O} (+${M}m)`},[s,a]),R=C=>{u(!1),l(V=>C==="prev"?V>0?V-1:s.length-1:(V+1)%s.length)};return t?m.jsx(ar,{children:m.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 left-2 right-2 z-[1600] bg-white/95 backdrop-blur-sm rounded-xl shadow-xl border border-gray-200",style:{maxWidth:"400px",margin:"0 auto"},children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-gray-100",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(ZW,{size:14,className:"text-blue-500"}),m.jsx("span",{className:"text-xs font-medium text-gray-700",children:h?"Laden...":I()})]}),m.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(Ei,{size:14,className:"text-gray-500"})})]}),m.jsxs("div",{className:"px-3 py-2 flex items-center gap-2",children:[m.jsxs("div",{className:"flex items-center gap-0.5",children:[m.jsx("button",{onClick:()=>R("prev"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(owe,{size:14,className:"text-gray-600"})}),m.jsx("button",{onClick:()=>u(!c),className:`p-1.5 rounded transition-colors border-0 outline-none ${c?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:c?m.jsx(dwe,{size:14}):m.jsx(pwe,{size:14})}),m.jsx("button",{onClick:()=>R("next"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(lb,{size:14,className:"text-gray-600"})})]}),m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("span",{className:"text-[9px] text-gray-400 w-6",children:"-2u"}),m.jsx("input",{type:"range",min:"0",max:Math.max(0,s.length-1),value:a,onChange:C=>{u(!1),l(parseInt(C.target.value))},className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsx("span",{className:"text-[9px] text-gray-400 w-8 text-right",children:"+30m"})]}),m.jsx("div",{className:"flex items-center gap-0.5 bg-gray-100 rounded p-0.5",children:["slow","normal","fast"].map(C=>m.jsxs("button",{onClick:()=>v(C),className:`px-1.5 py-0.5 text-[9px] rounded transition-colors border-0 outline-none ${g===C?"bg-white text-blue-600 shadow-sm":"text-gray-500 bg-transparent"}`,children:[C==="slow"?"":C==="normal"?"1":"2",""]},C))})]}),m.jsxs("div",{className:"px-3 py-1.5 flex items-center gap-2 border-t border-gray-100",children:[m.jsx("span",{className:"text-[10px] text-gray-500 w-14",children:"Dekking"}),m.jsx("input",{type:"range",min:"10",max:"100",value:x,onChange:C=>b(parseInt(C.target.value)),className:"flex-1 h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500"}),m.jsxs("span",{className:"text-[10px] text-gray-500 w-8 text-right",children:[x,"%"]})]}),m.jsxs("div",{className:"px-3 pb-1.5 flex items-center justify-center gap-1.5",children:[m.jsx("span",{className:"text-[8px] text-gray-400",children:"Licht"}),m.jsxs("div",{className:"flex h-1.5 rounded overflow-hidden",children:[m.jsx("div",{className:"w-3",style:{backgroundColor:"#88D0F3"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#32B8A4"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#F4E61F"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#F09D1C"}}),m.jsx("div",{className:"w-3",style:{backgroundColor:"#E12E18"}})]}),m.jsx("span",{className:"text-[8px] text-gray-400",children:"Zwaar"})]})]})}):null}const Aoe={Munt:"#f59e0b",Aardewerk:"#a16207",Gesp:"#6b7280",Fibula:"#8b5cf6",Ring:"#ec4899",Speld:"#6366f1",Sieraad:"#f43f5e",Gereedschap:"#64748b",Wapen:"#ef4444",Anders:"#3b82f6"},XSt={Munt:"M",Aardewerk:"A",Gesp:"G",Fibula:"F",Ring:"R",Speld:"S",Sieraad:"Si",Gereedschap:"Gr",Wapen:"W",Anders:"?"};function ZSt(){const t=es(i=>i.map),e=xd(i=>i.vondsten),n=Nn(i=>i.showLocalVondsten),r=X.useRef(null);return X.useEffect(()=>{if(!t)return;const i=new Nd;return e.forEach(s=>{const o=new _i({geometry:new Vs(Pi([s.location.lng,s.location.lat])),vondst:s}),a=Aoe[s.objectType]||Aoe.Anders,l=XSt[s.objectType]||"?";o.setStyle((c,u)=>{let v=12;u>50?v=6:u>10?v=Math.max(6,12-(u-10)/10):u<2&&(v=14);const x=Math.max(8,Math.min(12,v-2));return new zn({image:new $a({radius:v,fill:new Nr({color:a}),stroke:new Sr({color:"#ffffff",width:v>8?2:1})}),text:v>=8?new th({text:l,font:`bold ${x}px sans-serif`,fill:new Nr({color:"#ffffff"}),offsetY:1}):void 0})}),i.addFeature(o)}),r.current?r.current.setSource(i):(r.current=new gp({source:i,zIndex:1e3,properties:{title:"Mijn Vondsten"}}),r.current.setVisible(n),t.addLayer(r.current)),()=>{r.current&&t&&(t.removeLayer(r.current),r.current=null)}},[t,e]),X.useEffect(()=>{r.current&&r.current.setVisible(n)},[n]),null}const JSt={Mineraal:"M",Fossiel:"F",Erfgoed:"E",Monument:"Mo",Overig:""};function QSt(t){const{type:e,coordinates:n}=t,r=s=>typeof s[0]=="number"?Pi(s):s.map(r),i=r(n);switch(e){case"Point":return new Vs(i);case"LineString":return new ro(i);case"Polygon":return new ou(i);case"MultiPoint":return new X1(i);case"MultiLineString":return new np(i);case"MultiPolygon":return new p1(i);default:return new Vs(Pi(n))}}function eTt(){const t=es(i=>i.map),e=Po(i=>i.layers),n=Nn(i=>i.showCustomPointLayers),r=X.useRef(new Map);return X.useEffect(()=>{if(!t)return;const i=new Set(e.map(s=>s.id));return r.current.forEach((s,o)=>{i.has(o)||(t.removeLayer(s),r.current.delete(o))}),e.forEach(s=>{const o=new Nd;s.points.forEach(l=>{let c;const u=l.geometry&&l.geometry.type!=="Point";l.geometry?c=QSt(l.geometry):c=new Vs(Pi(l.coordinates));const h=new _i({geometry:c,layerType:"customPoint",customPoint:l,customLayerId:s.id,customLayerName:s.name,customLayerColor:s.color}),f=JSt[l.category]||l.category.charAt(0).toUpperCase();if(u){const g=l.geometry.type;h.setStyle(()=>g==="Polygon"||g==="MultiPolygon"?new zn({fill:new Nr({color:s.color+"40"}),stroke:new Sr({color:s.color,width:2})}):g==="LineString"||g==="MultiLineString"?new zn({stroke:new Sr({color:s.color,width:3})}):new zn({image:new $a({radius:8,fill:new Nr({color:s.color}),stroke:new Sr({color:"#ffffff",width:2})})}))}else h.setStyle((g,v)=>{let A=12;v>50?A=6:v>10?A=Math.max(6,12-(v-10)/10):v<2&&(A=14);const I=Math.max(8,Math.min(12,A-2));return new zn({image:new $a({radius:A,fill:new Nr({color:s.color}),stroke:new Sr({color:"#ffffff",width:A>8?2:1})}),text:A>=8?new th({text:f,font:`bold ${I}px sans-serif`,fill:new Nr({color:"#ffffff"}),offsetY:1}):void 0})});o.addFeature(h)});const a=r.current.get(s.id);if(a)a.setSource(o),a.setVisible(n&&s.visible);else{const l=new gp({source:o,zIndex:950,properties:{title:s.name,customPointLayerId:s.id},visible:n&&s.visible});t.addLayer(l),r.current.set(s.id,l)}}),()=>{r.current.forEach(s=>{t&&t.removeLayer(s)}),r.current.clear()}},[t,e,n]),null}function tTt(){const{createLayerModalOpen:t,closeCreateLayerModal:e}=ri(),{addLayer:n}=Po(),r=Nn(),[i,s]=X.useState(""),[o,a]=X.useState([...Nm]),[l,c]=X.useState(""),u=14*r.fontScale/100,h=()=>{const b=l.trim();b&&!o.includes(b)&&(a([...o,b]),c(""))},f=b=>{a(o.filter(T=>T!==b))},g=b=>{o.includes(b)?a(o.filter(T=>T!==b)):a([...o,b])},v=()=>{i.trim()&&(n(i.trim(),o),s(""),a([...Nm]),c(""),e())},x=()=>{s(""),a([...Nm]),c(""),e()};return m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(nu,{size:18}),m.jsx("span",{className:"font-medium",children:"Nieuwe laag"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:r.fontScale,onChange:b=>r.setFontScale(parseInt(b.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${r.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ei,{size:18})})]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{fontSize:`${u}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam van de laag"}),m.jsx("input",{type:"text",value:i,onChange:b=>s(b.target.value),placeholder:"bijv. Vakantie Frankrijk 2026",className:"w-full px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:Nm.map(b=>m.jsx("button",{onClick:()=>g(b),className:`px-3 py-1 rounded-full transition-colors border-0 outline-none ${o.includes(b)?"bg-orange-500 text-white":"bg-white text-gray-600 hover:bg-blue-50"}`,style:{fontSize:"0.9em"},children:b},b))})]}),o.filter(b=>!Nm.includes(b)).length>0&&m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-2",style:{fontSize:"0.9em"},children:"Eigen categorien"}),m.jsx("div",{className:"flex flex-wrap gap-2",children:o.filter(b=>!Nm.includes(b)).map(b=>m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{onClick:()=>g(b),className:"px-3 py-1 rounded-l-full bg-orange-500 text-white hover:bg-orange-600 transition-colors border-0 outline-none",style:{fontSize:"0.9em"},children:b}),m.jsx("button",{onClick:()=>f(b),className:"px-2 py-1 rounded-r-full bg-orange-600 text-white hover:bg-orange-700 transition-colors border-0 outline-none",title:"Verwijder categorie",children:m.jsx(wp,{size:12})})]},b))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Eigen categorie toevoegen"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"bijv. Grot, Bron, ...",className:"flex-1 px-3 py-2 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},onKeyDown:b=>b.key==="Enter"&&h()}),m.jsx("button",{onClick:h,disabled:!l.trim(),className:"px-3 py-2 bg-white hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors border-0 outline-none text-gray-600",children:m.jsx(uu,{size:20})})]})]})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${u}px`},children:[m.jsx("button",{onClick:x,className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:v,disabled:!i.trim(),className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Aanmaken"})]})]})]})})}const sEe=200,nTt=.7;async function rTt(t,e=sEe){return new Promise((n,r)=>{const i=new Image,s=document.createElement("canvas"),o=s.getContext("2d");i.onload=()=>{let a=i.width,l=i.height;a>l?a>e&&(l=Math.round(l*e/a),a=e):l>e&&(a=Math.round(a*e/l),l=e),s.width=a,s.height=l,o?.drawImage(i,0,0,a,l),s.toBlob(c=>{c?n(c):r(new Error("Failed to create blob from canvas"))},"image/jpeg",nTt)},i.onerror=()=>r(new Error("Failed to load image")),i.src=URL.createObjectURL(t)})}function iTt(t){return new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>{typeof r.result=="string"?e(r.result):n(new Error("Failed to convert blob to base64"))},r.onerror=()=>n(new Error("Failed to read blob")),r.readAsDataURL(t)})}async function sTt(t){const e=await rTt(t,sEe),n=await iTt(e);return{thumbnailBlob:e,thumbnailBase64:n}}function oTt(){return`photo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const z8=5;function aTt({photos:t,onAddPhoto:e,onRemovePhoto:n,disabled:r}){const i=X.useRef(null),s=X.useRef(null),o=async l=>{const c=l.target.files;if(!c||c.length===0)return;const u=z8-t.length,h=Array.from(c).slice(0,u);for(const f of h)try{const{thumbnailBase64:g}=await sTt(f),v={id:oTt(),thumbnailBase64:g,createdAt:new Date().toISOString(),pendingUpload:!0};e(v)}catch(g){console.error("Failed to process image:",g)}l.target.value=""},a=t.length<z8;return m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"block font-medium text-gray-700",style:{fontSize:"0.9em"},children:["Foto's (",t.length,"/",z8,")"]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.map(l=>m.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 border border-gray-200",children:[m.jsx("img",{src:l.thumbnailUrl||l.thumbnailBase64,alt:"Foto",className:"w-full h-full object-cover"}),!r&&m.jsx("button",{type:"button",onClick:()=>n(l.id),className:"absolute top-0.5 right-0.5 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center border-0 outline-none",children:m.jsx(Ei,{size:12,className:"text-white"})}),l.pendingUpload&&m.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-orange-500/80 text-white text-center py-0.5",style:{fontSize:"0.6em"},children:"Wacht..."})]},l.id)),a&&!r&&m.jsxs(m.Fragment,{children:[m.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Maak foto",children:[m.jsx(KO,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Camera"})]}),m.jsxs("button",{type:"button",onClick:()=>i.current?.click(),className:"w-16 h-16 rounded-lg border-2 border-dashed border-gray-300 hover:border-orange-400 hover:bg-orange-50 flex flex-col items-center justify-center gap-1 transition-colors bg-transparent outline-none",title:"Kies foto",children:[m.jsx(zlt,{size:20,className:"text-gray-400"}),m.jsx("span",{className:"text-gray-400",style:{fontSize:"0.6em"},children:"Gallerij"})]})]})]}),m.jsx("input",{ref:s,type:"file",accept:"image/*",capture:"environment",onChange:o,className:"hidden"}),m.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"})]})}function lTt(){const{addPointModalOpen:t,addPointModalLayerId:e,addPointModalLocation:n,closeAddPointModal:r}=ri(),{addPoint:i,getLayer:s}=Po(),o=Nn(),[a,l]=X.useState(""),[c,u]=X.useState(""),[h,f]=X.useState(""),[g,v]=X.useState([]),x=e?s(e):null,b=14*o.fontScale/100,T=()=>{!a.trim()||!e||!n||(i(e,{name:a.trim(),category:"Overig",notes:c.trim(),url:h.trim()||void 0,coordinates:[n.lng,n.lat],photos:g.length>0?g:void 0}),l(""),u(""),f(""),v([]),r())},A=()=>{l(""),u(""),f(""),v([]),r()};return x?m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:A}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-sm mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(fc,{size:18}),m.jsx("span",{className:"font-medium",children:"Punt toevoegen"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:o.fontScale,onChange:I=>o.setFontScale(parseInt(I.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${o.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:A,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ei,{size:18})})]})]}),m.jsx("div",{className:"px-4 py-1.5",children:m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),m.jsx("span",{className:"text-sm text-gray-600",children:x.name})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",style:{fontSize:`${b}px`},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Naam *"}),m.jsx("input",{type:"text",value:a,onChange:I=>l(I.target.value),className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"},autoFocus:!0})]}),m.jsx(aTt,{photos:g,onAddPhoto:I=>v([...g,I]),onRemovePhoto:I=>v(g.filter(R=>R.id!==I))}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Notities"}),m.jsx("textarea",{value:c,onChange:I=>u(I.target.value),placeholder:"Beschrijving, tips, opmerkingen...",rows:2,className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors resize-none",style:{fontSize:"1em"}})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block font-medium text-gray-700 mb-1",style:{fontSize:"0.9em"},children:"Link"}),m.jsx("input",{type:"url",value:h,onChange:I=>f(I.target.value),placeholder:"https://...",className:"w-full px-3 py-1.5 bg-white rounded-lg border-0 outline-none hover:bg-blue-50 transition-colors",style:{fontSize:"1em"}})]})]}),m.jsxs("div",{className:"p-3 flex gap-3",style:{fontSize:`${b}px`},children:[m.jsx("button",{onClick:A,className:"flex-1 px-4 py-1.5 bg-white hover:bg-blue-50 rounded-lg transition-colors border-0 outline-none text-gray-600",style:{fontSize:"1em"},children:"Annuleren"}),m.jsx("button",{onClick:T,disabled:!a.trim(),className:"flex-1 px-4 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:"Toevoegen"})]})]})]})}):null}function cTt(){const{layerManagerModalOpen:t,closeLayerManagerModal:e,openCreateLayerModal:n,openLayerDashboard:r}=ri(),{layers:i,removeLayer:s,toggleVisibility:o,toggleArchived:a,exportLayerAsGeoJSON:l,importLayerFromGeoJSON:c}=Po(),u=Nn(),h=14*u.fontScale/100,[f,g]=X.useState(null),[v,x]=X.useState(null),[b,T]=X.useState(null),[A,I]=X.useState(!1),R=i.filter(U=>!U.archived),C=i.filter(U=>U.archived),V=A?C:R,M=U=>{v===U?(s(U),x(null)):(x(U),setTimeout(()=>x(null),3e3))},N=U=>{l(U)},O=async U=>{const de=U.target.files?.[0];if(de){try{const me=await de.text(),ze=c(me);ze.success||(T(ze.error||"Import mislukt"),setTimeout(()=>T(null),3e3))}catch{T("Kon bestand niet lezen"),setTimeout(()=>T(null),3e3)}U.target.value=""}},F=()=>{g(null),x(null),T(null),I(!1),e()},L=U=>{r(U)},B=()=>{F(),n()};return m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:F}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[85vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(nu,{size:18}),m.jsx("span",{className:"font-medium",children:"Mijn Lagen beheren"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:u.fontScale,onChange:U=>u.setFontScale(parseInt(U.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${u.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:F,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ei,{size:18})})]})]}),m.jsxs("div",{className:"flex border-b border-gray-100",children:[m.jsxs("button",{onClick:()=>I(!1),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${A?"text-gray-500 hover:text-gray-700 hover:bg-gray-50":"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50"}`,children:["Actief (",R.length,")"]}),m.jsxs("button",{onClick:()=>I(!0),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none flex items-center justify-center gap-1 ${A?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[m.jsx(rwe,{size:14}),"Archief (",C.length,")"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${h}px`},children:[V.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:A?m.jsx("p",{style:{fontSize:"1em"},children:"Geen gearchiveerde lagen."}):m.jsxs(m.Fragment,{children:[m.jsx("p",{className:"mb-4",style:{fontSize:"1em"},children:"Je hebt nog geen eigen lagen."}),m.jsxs("button",{onClick:B,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none",style:{fontSize:"1em"},children:[m.jsx(uu,{size:16,className:"inline mr-2"}),"Nieuwe laag aanmaken"]})]})}):m.jsx("div",{className:"divide-y divide-gray-100",children:V.map(U=>m.jsx(hTt,{layer:U,isExpanded:f===U.id,onToggleExpand:()=>g(f===U.id?null:U.id),onToggleVisibility:()=>o(U.id),onToggleArchived:()=>a(U.id),onOpenDashboard:()=>L(U.id),onExport:()=>N(U.id),onDelete:()=>M(U.id),confirmDelete:v===U.id,onRename:de=>Po.getState().updateLayer(U.id,{name:de}),onChangeColor:de=>Po.getState().updateLayer(U.id,{color:de})},U.id))}),b&&m.jsx("div",{className:"mx-4 my-2 p-3 bg-red-50 text-red-700 text-sm rounded-lg",children:b})]}),m.jsxs("div",{className:"p-4 flex gap-3",style:{fontSize:`${h}px`},children:[m.jsxs("label",{className:"flex-1 px-4 py-2 bg-white hover:bg-blue-50 rounded-lg transition-colors cursor-pointer flex items-center justify-center gap-2 border-0 outline-none text-gray-600",children:[m.jsx(AI,{size:16}),m.jsx("span",{style:{fontSize:"1em"},children:"Importeren"}),m.jsx("input",{type:"file",accept:".geojson,.json",onChange:O,className:"hidden"})]}),m.jsxs("button",{onClick:B,className:"flex-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors border-0 outline-none flex items-center justify-center gap-2",style:{fontSize:"1em"},children:[m.jsx(uu,{size:16}),m.jsx("span",{children:"Nieuwe laag"})]})]})]})]})})}const uTt=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899"];function hTt({layer:t,isExpanded:e,onToggleExpand:n,onToggleVisibility:r,onToggleArchived:i,onOpenDashboard:s,onExport:o,onDelete:a,confirmDelete:l,onRename:c,onChangeColor:u}){const[h,f]=X.useState(!1),[g,v]=X.useState(t.name),[x,b]=X.useState(!1),T=X.useRef(null);X.useEffect(()=>{h&&T.current&&(T.current.focus(),T.current.select())},[h]);const A=()=>{v(t.name),f(!0)},I=()=>{const N=g.trim();N&&N!==t.name&&c(N),f(!1)},R=()=>{v(t.name),f(!1)},C=N=>{N.key==="Enter"?I():N.key==="Escape"&&R()},V=t.points.filter(N=>N.status==="completed").length,M=t.points.length;return m.jsxs("div",{className:"bg-white",children:[m.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[m.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors border-0 outline-none bg-transparent",children:e?m.jsx(ab,{size:16}):m.jsx(lb,{size:16})}),m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>b(!x),className:"w-5 h-5 rounded-full flex-shrink-0 border-2 border-white shadow-sm hover:scale-110 transition-transform cursor-pointer",style:{backgroundColor:t.color},title:"Kleur wijzigen"}),x&&m.jsx("div",{className:"absolute top-7 left-0 z-50 bg-white rounded-lg shadow-lg p-2 flex flex-wrap gap-1 w-24",children:uTt.map(N=>m.jsx("button",{onClick:()=>{u(N),b(!1)},className:`w-5 h-5 rounded-full border-2 hover:scale-110 transition-transform ${N===t.color?"border-gray-800":"border-white"}`,style:{backgroundColor:N}},N))})]}),h?m.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[m.jsx("input",{ref:T,type:"text",value:g,onChange:N=>v(N.target.value),onKeyDown:C,onBlur:I,className:"flex-1 px-2 py-1 text-gray-800 font-medium bg-orange-50 rounded outline-none focus:ring-2 focus:ring-orange-400"}),m.jsx("button",{onClick:I,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Opslaan",children:m.jsx(up,{size:16})})]}):m.jsxs("button",{onClick:s,className:"flex-1 min-w-0 text-left border-0 outline-none bg-transparent hover:bg-orange-50 rounded px-2 py-1 -ml-2 transition-colors",title:"Bekijk dashboard",children:[m.jsx("div",{className:"font-medium text-gray-800 truncate hover:text-orange-600",children:t.name}),m.jsx("div",{className:"text-xs text-gray-500",children:M>0?m.jsxs("span",{className:V===M?"text-green-600":"",children:[V,"/",M," voltooid"]}):"Geen punten"})]}),!h&&m.jsx("button",{onClick:A,className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors border-0 outline-none",title:"Naam bewerken",children:m.jsx(k2,{size:16})}),m.jsx("button",{onClick:s,className:"p-2 text-orange-400 hover:text-orange-600 hover:bg-orange-50 rounded transition-colors border-0 outline-none",title:"Open dashboard",children:m.jsx(uwe,{size:18})}),!t.archived&&m.jsx("button",{onClick:r,className:`p-2 rounded transition-colors border-0 outline-none ${t.visible?"text-blue-500 hover:bg-blue-50":"text-gray-400 hover:bg-gray-100"}`,title:t.visible?"Verbergen":"Tonen",children:t.visible?m.jsx(uN,{size:18}):m.jsx(cN,{size:18})}),m.jsx("button",{onClick:i,className:`p-2 rounded transition-colors border-0 outline-none ${t.archived?"text-green-500 hover:text-green-600 hover:bg-green-50":"text-gray-400 hover:text-amber-600 hover:bg-amber-50"}`,title:t.archived?"Herstellen":"Archiveren",children:t.archived?m.jsx(Lat,{size:18}):m.jsx(rwe,{size:18})}),m.jsx("button",{onClick:o,className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded transition-colors border-0 outline-none",title:"Exporteren als GeoJSON",children:m.jsx(lN,{size:18})}),m.jsx("button",{onClick:a,className:`p-2 rounded transition-colors border-0 outline-none ${l?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:l?"Klik nogmaals om te verwijderen":"Verwijderen",children:m.jsx(wp,{size:18})})]}),m.jsx(ar,{children:e&&m.jsx(Ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:m.jsxs("div",{className:"px-4 pb-3 pl-12 space-y-2",children:[t.categories.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1",children:t.categories.map(N=>m.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:N},N))}),t.points.length>0&&m.jsxs("div",{className:"text-xs text-gray-500 space-y-1 max-h-32 overflow-y-auto",children:[t.points.slice(0,5).map(N=>m.jsx("div",{className:"flex items-center gap-2",children:m.jsx("span",{className:`font-medium ${N.status==="completed"?"text-green-600 line-through":N.status==="skipped"?"text-gray-400 line-through":"text-gray-700"}`,children:N.name})},N.id)),t.points.length>5&&m.jsxs("div",{className:"text-gray-400",children:["...en ",t.points.length-5," meer"]})]}),m.jsxs("div",{className:"text-xs text-gray-400",children:["Aangemaakt: ",new Date(t.createdAt).toLocaleDateString("nl-NL")]})]})})})]})}function dTt(){const{layerDashboardOpen:t,layerDashboardLayerId:e,closeLayerDashboard:n}=ri(),{getLayer:r,setPointStatus:i,updatePoint:s,removePoint:o}=Po(),a=Nn(),[l,c]=X.useState("all"),[u,h]=X.useState(null),[f,g]=X.useState(""),[v,x]=X.useState(null),b=e?r(e):null,T=14*a.fontScale/100;if(!b)return null;const A=b.points.filter(L=>l==="all"?!0:L.status===l),I=b.points.length,R=b.points.filter(L=>L.status==="completed").length,C=b.points.filter(L=>L.status==="todo").length,V=b.points.filter(L=>L.status==="skipped").length,M=(L,B)=>{i(b.id,L,B)},N=L=>{s(b.id,L,{notes:f}),h(null),g("")},O=L=>{v===L?(o(b.id,L),x(null)):(x(L),setTimeout(()=>x(null),3e3))},F=()=>{h(null),x(null),n()};return m.jsx(ar,{children:t&&m.jsxs(m.Fragment,{children:[m.jsx(Ct.div,{className:"fixed inset-0 z-[1700] bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:F}),m.jsxs(Ct.div,{className:"fixed inset-4 z-[1701] bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-w-lg mx-auto my-auto max-h-[90vh]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/50",style:{backgroundColor:b.color}}),m.jsx("span",{className:"font-medium truncate",children:b.name})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] opacity-70",children:"T"}),m.jsx("input",{type:"range",min:"80",max:"150",step:"10",value:a.fontScale,onChange:L=>a.setFontScale(parseInt(L.target.value)),className:"header-slider w-16 opacity-70 hover:opacity-100 transition-opacity",title:`Tekstgrootte: ${a.fontScale}%`}),m.jsx("span",{className:"text-xs opacity-70",children:"T"}),m.jsx("button",{onClick:F,className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-1",children:m.jsx(Ei,{size:18})})]})]}),m.jsxs("div",{className:"px-4 py-2 bg-orange-50 flex items-center justify-between text-sm",children:[m.jsxs("span",{className:"text-orange-800 font-medium",children:[R,"/",I," voltooid"]}),m.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[m.jsxs("span",{className:"text-orange-600",children:[C," te doen"]}),V>0&&m.jsxs("span",{className:"text-gray-500",children:[V," overgeslagen"]})]})]}),m.jsx("div",{className:"flex border-b border-gray-100",children:["all","todo","completed","skipped"].map(L=>m.jsxs("button",{onClick:()=>c(L),className:`flex-1 px-3 py-2 text-sm transition-colors border-0 outline-none ${l===L?"text-orange-600 border-b-2 border-orange-500 bg-orange-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[L==="all"&&"Alles",L==="todo"&&"Te doen",L==="completed"&&"Voltooid",L==="skipped"&&"Overgeslagen"]},L))}),m.jsx("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${T}px`},children:A.length===0?m.jsx("div",{className:"p-8 text-center text-gray-500",children:m.jsx("p",{children:"Geen punten gevonden"})}):m.jsx("div",{className:"divide-y divide-gray-100",children:A.map(L=>m.jsx("div",{className:"p-3",children:m.jsxs("div",{className:"flex items-start gap-3",children:[m.jsxs("div",{className:"flex flex-col gap-1 pt-0.5",children:[m.jsx("button",{onClick:()=>M(L.id,L.status==="completed"?"todo":"completed"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${L.status==="completed"?"bg-green-100 hover:bg-green-200":"bg-gray-100 hover:bg-green-100"}`,title:L.status==="completed"?"Markeer als te doen":"Markeer als voltooid",children:m.jsx(up,{size:14,className:L.status==="completed"?"text-green-600":"text-gray-400"})}),m.jsx("button",{onClick:()=>M(L.id,L.status==="skipped"?"todo":"skipped"),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none transition-colors ${L.status==="skipped"?"bg-gray-200 hover:bg-gray-300":"bg-gray-100 hover:bg-gray-200"}`,title:L.status==="skipped"?"Markeer als te doen":"Overslaan",children:m.jsx(jat,{size:14,className:L.status==="skipped"?"text-gray-600":"text-gray-400"})})]}),L.photos&&L.photos.length>0&&m.jsxs("div",{className:"relative flex-shrink-0",children:[m.jsx("img",{src:L.photos[0].thumbnailUrl||L.photos[0].thumbnailBase64,alt:"Foto",className:"w-12 h-12 object-cover rounded border border-gray-200"}),L.photos.length>1&&m.jsxs("span",{className:"absolute -bottom-1 -right-1 bg-orange-500 text-white text-[9px] px-1 rounded-full",children:["+",L.photos.length-1]})]}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:`font-medium truncate ${L.status==="completed"?"text-green-700 line-through":L.status==="skipped"?"text-gray-400 line-through":"text-gray-800"}`,children:L.name}),L.sourceLayer&&m.jsxs("span",{className:"text-xs text-gray-400 truncate",children:["via ",L.sourceLayer]})]}),u===L.id?m.jsxs("div",{className:"mt-2",children:[m.jsx("textarea",{value:f,onChange:B=>g(B.target.value),placeholder:"Notities...",rows:2,className:"w-full px-2 py-1 bg-white rounded border-0 outline-none hover:bg-blue-50 transition-colors resize-none text-sm",autoFocus:!0}),m.jsxs("div",{className:"flex gap-2 mt-1",children:[m.jsx("button",{onClick:()=>N(L.id),className:"px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 border-0 outline-none",children:"Opslaan"}),m.jsx("button",{onClick:()=>{h(null),g("")},className:"px-2 py-1 text-xs bg-white text-gray-600 rounded hover:bg-blue-50 border-0 outline-none",children:"Annuleren"})]})]}):L.notes?m.jsx("p",{className:"text-sm text-gray-600 mt-1",children:L.notes}):null,L.url&&m.jsxs("a",{href:L.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-500 hover:text-blue-700 mt-1",children:[m.jsx(vg,{size:12}),"Link"]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("button",{onClick:()=>{h(L.id),g(L.notes)},className:"w-6 h-6 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded border-0 outline-none",title:"Notities bewerken",children:m.jsx(cct,{size:14})}),m.jsx("button",{onClick:()=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${L.coordinates[1]},${L.coordinates[0]}`,"_blank")},className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:text-blue-600 hover:bg-blue-50 rounded border-0 outline-none",title:"Navigeer naar",children:m.jsx(fc,{size:14})}),m.jsx("button",{onClick:()=>O(L.id),className:`w-6 h-6 flex items-center justify-center rounded border-0 outline-none ${v===L.id?"text-white bg-red-500 hover:bg-red-600":"text-gray-400 hover:text-red-600 hover:bg-red-50"}`,title:v===L.id?"Klik nogmaals":"Verwijderen",children:m.jsx(wp,{size:14})})]})]})},L.id))})})]})]})})}function fTt(){const[t,e]=X.useState(navigator.onLine),[n,r]=X.useState(!1);return X.useEffect(()=>{const i=()=>{e(!0),r(!1)},s=()=>{e(!1),r(!1)};return window.addEventListener("online",i),window.addEventListener("offline",s),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",s)}},[]),t||n?null:m.jsx(ar,{children:m.jsx(Ct.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"fixed top-0 left-0 right-0 z-[2000] bg-amber-500 text-white px-4 py-2 shadow-lg",children:m.jsxs("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(uut,{size:18}),m.jsx("span",{className:"text-sm font-medium",children:"Offline modus - Kaart werkt met gecachede data"})]}),m.jsx("button",{onClick:()=>r(!0),className:"p-1 hover:bg-white/20 rounded transition-colors border-0 outline-none bg-transparent",children:m.jsx(Ei,{size:16})})]})})})}function pTt(t){return t}function mTt(t){if(t==null)return pTt;var e,n,r=t.scale[0],i=t.scale[1],s=t.translate[0],o=t.translate[1];return function(a,l){l||(e=n=0);var c=2,u=a.length,h=new Array(u);for(h[0]=(e+=a[0])*r+s,h[1]=(n+=a[1])*i+o;c<u;)h[c]=a[c],++c;return h}}function gTt(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}function yTt(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return Ioe(t,n)})}:Ioe(t,e)}function Ioe(t,e){var n=e.id,r=e.bbox,i=e.properties==null?{}:e.properties,s=vTt(t,e);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function vTt(t,e){var n=mTt(t.transform),r=t.arcs;function i(u,h){h.length&&h.pop();for(var f=r[u<0?~u:u],g=0,v=f.length;g<v;++g)h.push(n(f[g],g));u<0&&gTt(h,v)}function s(u){return n(u)}function o(u){for(var h=[],f=0,g=u.length;f<g;++f)i(u[f],h);return h.length<2&&h.push(h[0]),h}function a(u){for(var h=o(u);h.length<4;)h.push(h[0]);return h}function l(u){return u.map(a)}function c(u){var h=u.type,f;switch(h){case"GeometryCollection":return{type:h,geometries:u.geometries.map(c)};case"Point":f=s(u.coordinates);break;case"MultiPoint":f=u.coordinates.map(s);break;case"LineString":f=o(u.arcs);break;case"MultiLineString":f=u.arcs.map(o);break;case"Polygon":f=l(u.arcs);break;case"MultiPolygon":f=u.arcs.map(l);break;default:return null}return{type:h,coordinates:f}}return c(e)}async function fOt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.statusText}`);const n=await e.json();return console.log(` Loaded GeoJSON from ${t}`),n}catch(e){throw console.error(`Error loading GeoJSON from ${t}:`,e),e}}async function _Tt(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to load ${t}: ${e.statusText}`);const n=await e.json(),r=Object.keys(n.objects)[0],i=yTt(n,n.objects[r]);return console.log(` Loaded and converted TopoJSON from ${t}`),i}catch(e){throw console.error(`Error loading TopoJSON from ${t}:`,e),e}}function xTt(t){return new ZO({featureProjection:"EPSG:3857"}).readFeatures(t)}const oEe={all:{name:"Alle provincies",bounds:[3.37,50.75,7.21,53.47]},groningen:{name:"Groningen",bounds:[6.2,53.1,7.21,53.47]},friesland:{name:"Friesland",bounds:[5.05,52.85,6.25,53.45]},drenthe:{name:"Drenthe",bounds:[6.1,52.65,7.1,53.15]},overijssel:{name:"Overijssel",bounds:[5.85,52.15,6.9,52.7]},flevoland:{name:"Flevoland",bounds:[5.15,52.25,6,52.65]},gelderland:{name:"Gelderland",bounds:[5,51.75,6.4,52.45]},utrecht:{name:"Utrecht",bounds:[4.85,51.9,5.65,52.25]},"noord-holland":{name:"Noord-Holland",bounds:[4.5,52.2,5.25,52.95]},"zuid-holland":{name:"Zuid-Holland",bounds:[3.85,51.8,4.9,52.35]},zeeland:{name:"Zeeland",bounds:[3.37,51.2,4.3,51.75]},"noord-brabant":{name:"Noord-Brabant",bounds:[4.35,51.25,6,51.85]},limburg:{name:"Limburg",bounds:[5.55,50.75,6.25,51.8]}};function wTt(t,e,n){if(n==="all")return!0;const r=oEe[n];if(!r)return!0;const[i,s,o,a]=r.bounds;return t>=i&&t<=o&&e>=s&&e<=a}let yM=null;async function aEe(){if(yM)return yM;const t=await _Tt("/detectorapp-nl/data/amk_monumenten_full.topojson");return yM=xTt(t),yM}function bTt(t,e,n=50){const r=t.toLowerCase(),i=e.toLowerCase(),s=r.indexOf(i);if(s===-1)return t.substring(0,100)+"...";const o=Math.max(0,s-n),a=Math.min(t.length,s+e.length+n);let l="";return o>0&&(l+="..."),l+=t.substring(o,a),a<t.length&&(l+="..."),l}async function ETt(t,e=50,n="all"){if(!t||t.length<2)return[];const r=await aEe(),i=[],o=t.toLowerCase().split(/\s+/).filter(a=>a.length>=2);for(const a of r){const l=(a.get("omschrijving")||"").toLowerCase(),c=(a.get("toponiem")||"").toLowerCase(),u=(a.get("txt_label")||"").toLowerCase();if(o.every(f=>l.includes(f)||c.includes(f)||u.includes(f))){const f=a.getGeometry();if(!f)continue;const g=f.getExtent(),v=oh(g),[x,b]=N2(v,"EPSG:3857","EPSG:4326");if(!wTt(x,b,n))continue;const T=a.get("omschrijving")||"";if(i.push({id:a.get("ID")||a.get("monumentnummer"),monumentnummer:a.get("monumentnummer"),toponiem:a.get("toponiem")||"Onbekend",kwaliteitswaarde:a.get("kwaliteitswaarde")||"",periode:a.get("txt_label")||"",omschrijving:T,matchedText:bTt(T,o[0]),coordinates:[x,b],extent:g}),i.length>=e)break}}return i.sort((a,l)=>{const c={"zeer hoge archeologische waarde":3,"hoge archeologische waarde":2,"archeologische waarde":1};return(c[l.kwaliteitswaarde]||0)-(c[a.kwaliteitswaarde]||0)}),i}async function STt(t){return(await aEe()).find(n=>n.get("monumentnummer")===t)||null}const TTt={"zeer hoge archeologische waarde":"bg-purple-600","hoge archeologische waarde":"bg-purple-500","archeologische waarde":"bg-purple-400"},kTt={"zeer hoge archeologische waarde":"Zeer hoog","hoge archeologische waarde":"Hoog","archeologische waarde":"Waarde"};let Ox=null;function ATt(t){return Ox||(Ox=new gp({source:new Nd,style:new zn({fill:new Nr({color:"rgba(147, 51, 234, 0.5)"}),stroke:new Sr({color:"#9333ea",width:3})}),zIndex:9999}),t.addLayer(Ox)),Ox}function ITt(){Ox&&Ox.getSource()?.clear()}async function RTt(t,e){const n=await STt(e);if(!n)return;const i=ATt(t).getSource();i?.clear();const s=n.clone();i?.addFeature(s)}function PTt({isOpen:t,onClose:e}){const n=es(me=>me.map),r=Nn(),[i,s]=X.useState(""),[o,a]=X.useState("all"),[l,c]=X.useState([]),[u,h]=X.useState(!1),[f,g]=X.useState(!1),[v,x]=X.useState(null),[b,T]=X.useState(null),[A,I]=X.useState(50),[R,C]=X.useState(!1),V=X.useRef(null),M=X.useRef(),N=13*r.fontScale/100;X.useEffect(()=>{t&&V.current&&setTimeout(()=>V.current?.focus(),100)},[t]),X.useEffect(()=>{t||C(!1)},[t]),X.useEffect(()=>{if(M.current&&clearTimeout(M.current),i.length<2){c([]),g(!1);return}return M.current=window.setTimeout(async()=>{h(!0),g(!0);try{const me=await ETt(i,A,o);c(me)}catch(me){console.error("Monument search error:",me),c([])}finally{h(!1)}},400),()=>{M.current&&clearTimeout(M.current)}},[i,o,A]);const O=async me=>{if(!n)return;const ze=n.getView();if(v===me.id){const Le=Gf(me.extent,50);ze.fit(Le,{duration:500,maxZoom:18})}else{const Le=Gf(me.extent,200);ze.fit(Le,{duration:500,maxZoom:16}),await RTt(n,me.monumentnummer),x(me.id),T(me.id)}},F=(me,ze)=>{if(ze.stopPropagation(),!n)return;const Le=n.getView(),fe=Gf(me.extent,20);Le.fit(fe,{duration:500,maxZoom:18})},L=(me,ze)=>{ze.stopPropagation(),T(b===me?null:me)},B=()=>{e()},U=()=>{ITt(),s(""),a("all"),c([]),g(!1),x(null),T(null),I(50),e()},de=me=>{if(!i||i.length<2)return me;const ze=i.toLowerCase().split(/\s+/).filter(fe=>fe.length>=2);let Le=me;return ze.forEach(fe=>{const $e=fe.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Ce=new RegExp(`(${$e})`,"gi");Le=Le.replace(Ce,'<mark class="bg-yellow-200 px-0.5">$1</mark>')}),Le};return t?m.jsx(ar,{children:m.jsxs(Ct.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 z-[1701] bg-white rounded-t-2xl shadow-2xl overflow-hidden flex flex-col",style:{height:R?"85vh":"38vh"},children:[m.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gradient-to-r from-purple-500 to-purple-600 text-white cursor-pointer select-none",onClick:()=>C(!R),children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(cwe,{size:16}),m.jsx("span",{className:"font-medium text-sm",children:"Zoek monumenten"})]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(Flt,{size:20,className:"opacity-70"}),m.jsx("button",{onClick:me=>{me.stopPropagation(),B()},className:"p-1 rounded hover:bg-white/20 transition-colors border-0 outline-none ml-2",children:m.jsx(Ei,{size:16})})]})]}),m.jsx("div",{className:"p-2 border-b border-gray-100 space-y-2",children:m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("div",{className:"relative flex-1",children:[m.jsx(dN,{size:16,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),m.jsx("input",{ref:V,type:"text",value:i,onChange:me=>{s(me.target.value),x(null),T(null)},placeholder:"bouwvoor, scherven...",className:"w-full pl-8 pr-8 py-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm"}),i&&m.jsx("button",{onClick:()=>{s(""),x(null),T(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 border-0 outline-none bg-transparent",children:m.jsx(Ei,{size:14})})]}),m.jsx("select",{value:o,onChange:me=>{a(me.target.value),x(null),T(null)},className:"py-1.5 px-2 bg-gray-100 rounded-lg border-0 outline-none focus:ring-2 focus:ring-purple-500 text-sm text-gray-700 w-28",children:Object.entries(oEe).map(([me,{name:ze}])=>m.jsx("option",{value:me,children:ze},me))})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto",style:{fontSize:`${N}px`},children:[u&&m.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Zoeken..."}),!u&&f&&l.length===0&&m.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Geen resultaten"}),!u&&l.length>0&&m.jsxs("div",{className:"divide-y divide-gray-100",children:[m.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 text-xs text-gray-500 flex justify-between items-center",children:[m.jsxs("span",{children:[l.length,l.length>=A?"+":""," gevonden"]}),l.length>=A&&m.jsx("button",{onClick:()=>I(A+50),className:"text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent",children:"Meer laden"})]}),l.map(me=>m.jsxs("div",{className:`transition-colors ${v===me.id?"bg-purple-50":"bg-transparent"}`,children:[m.jsx("button",{onClick:()=>O(me),className:"w-full text-left px-3 py-2 hover:bg-purple-50 transition-colors border-0 outline-none bg-transparent",children:m.jsxs("div",{className:"flex items-start justify-between gap-2",children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("p",{className:"font-medium text-gray-800 text-sm",children:me.toponiem}),m.jsx("p",{className:"text-xs text-purple-600 mt-0.5",children:me.periode})]}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[m.jsx("span",{className:`px-1.5 py-0.5 rounded text-white text-[9px] ${TTt[me.kwaliteitswaarde]||"bg-gray-500"}`,children:kTt[me.kwaliteitswaarde]||"AMK"}),v===me.id&&m.jsx("button",{onClick:ze=>F(me,ze),className:"p-1 bg-purple-500 hover:bg-purple-600 text-white rounded transition-colors border-0 outline-none",title:"Zoom in",children:m.jsx(put,{size:12})})]})]})}),v===me.id&&m.jsxs("div",{className:"px-3 pb-2",children:[m.jsxs("button",{onClick:ze=>L(me.id,ze),className:"flex items-center gap-1 text-xs text-purple-600 hover:text-purple-700 border-0 outline-none bg-transparent mb-1",children:[b===me.id?m.jsx(YO,{size:14}):m.jsx(ab,{size:14}),b===me.id?"Minder":"Omschrijving"]}),b===me.id&&m.jsx("div",{className:"text-xs text-gray-700 bg-gray-50 rounded p-2 max-h-32 overflow-y-auto whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:de(me.omschrijving)}})]})]},me.id))]}),!u&&!f&&m.jsx("div",{className:"p-3 text-xs text-gray-500",children:"Zoek op trefwoorden in 13.000+ AMK monumenten"})]}),(v||i)&&m.jsx("div",{className:"p-2 border-t border-gray-100",children:m.jsx("button",{onClick:U,className:"w-full py-2 text-sm text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors border-0 outline-none",children:"Wis zoekopdracht en highlight"})})]})}):null}class Roe{buffer=[];size;weights;constructor(e=8){this.size=e,this.weights=Array.from({length:e},(r,i)=>Math.pow(2,i));const n=this.weights.reduce((r,i)=>r+i,0);this.weights=this.weights.map(r=>r/n)}add(e){if(this.buffer.length>0){const n=this.buffer[this.buffer.length-1];let r=e-n;r>180&&(e-=360),r<-180&&(e+=360)}this.buffer.push(e),this.buffer.length>this.size&&this.buffer.shift()}getSmoothed(){if(this.buffer.length===0)return null;if(this.buffer.length===1)return this.normalize(this.buffer[0]);let e=0,n=0;const r=this.size-this.buffer.length;for(let i=0;i<this.buffer.length;i++){const s=this.weights[r+i];e+=this.buffer[i]*s,n+=s}return this.normalize(e/n)}normalize(e){return(e%360+360)%360}clear(){this.buffer=[]}}function MTt(){const t=bs(c=>c.tracking),e=bs(c=>c.headingSource),n=bs(c=>c.rawGPSHeading),r=bs(c=>c.setSmoothedHeading),i=X.useRef(new Roe(6)),s=X.useRef(new Roe(10)),o=X.useRef(0),a=X.useRef(null),l=33;X.useEffect(()=>{if(!t||e!=="gps"||n===null||n===a.current)return;a.current=n;const c=performance.now();if(c-o.current<l)return;i.current.add(n);const u=i.current.getSmoothed();u!==null&&(o.current=c,r(u))},[t,e,n,r]),X.useEffect(()=>{if(!t||e!=="compass")return;let c=0;const u=80,h=f=>{const g=performance.now();if(g-c<u||g-o.current<l)return;c=g;let v=null;if(f.webkitCompassHeading!==void 0?v=f.webkitCompassHeading:f.alpha!==null&&(v=(360-f.alpha)%360),v!==null){s.current.add(v);const x=s.current.getSmoothed();x!==null&&(o.current=g,r(x))}};return window.addEventListener("deviceorientationabsolute",h),window.addEventListener("deviceorientation",h),()=>{window.removeEventListener("deviceorientationabsolute",h),window.removeEventListener("deviceorientation",h)}},[t,e,r]),X.useEffect(()=>{t||(i.current.clear(),s.current.clear(),a.current=null)},[t])}function CTt(){const t=es(i=>i.map),e=io(i=>i.setLayerOpacity),n=io(i=>i.visible),r=X.useRef(null);X.useEffect(()=>{if(!t)return;const i=()=>{const s=t.getView().getZoom();if(!s||r.current!==null&&Math.abs(s-r.current)<.5)return;r.current=s;const o=n["AHN 0.5m"],a=n["AHN4 Multi-Hillshade NL"];!o&&!a||(o&&(s>=18?e("AHN 0.5m",.85):s>=16?e("AHN 0.5m",.75):s>=14?e("AHN 0.5m",.65):e("AHN 0.5m",.55)),a&&(s>=18?e("AHN4 Multi-Hillshade NL",.8):s>=16?e("AHN4 Multi-Hillshade NL",.7):s>=14?e("AHN4 Multi-Hillshade NL",.6):e("AHN4 Multi-Hillshade NL",.5)))};return t.on("moveend",i),i(),()=>{t.un("moveend",i)}},[t,n,e])}const U8=2e3;function NTt(){const t=G5(x=>x.user),{layers:e,clearAll:n}=Po(),{vondsten:r,clearAll:i}=xd(),{savedRoutes:s}=xl(),o=X.useRef(null),a=X.useRef(!0),l=X.useRef(""),c=X.useRef(""),u=X.useRef(""),h=X.useCallback(async x=>{if(t)try{const b=Ay(Ff,"users",t.uid);await j6(b,{layers:x,layersUpdatedAt:F6()},{merge:!0}),console.log(" Lagen gesynchroniseerd naar cloud")}catch(b){console.error(" Fout bij synchroniseren lagen:",b)}},[t]),f=X.useCallback(async x=>{if(t)try{const b=Ay(Ff,"users",t.uid);await j6(b,{vondsten:x,vondstenUpdatedAt:F6()},{merge:!0}),console.log(" Vondsten gesynchroniseerd naar cloud")}catch(b){console.error(" Fout bij synchroniseren vondsten:",b)}},[t]),g=X.useCallback(async x=>{if(t)try{const b=Ay(Ff,"users",t.uid);await j6(b,{routes:x,routesUpdatedAt:F6()},{merge:!0}),console.log(" Routes gesynchroniseerd naar cloud")}catch(b){console.error(" Fout bij synchroniseren routes:",b)}},[t]),v=X.useCallback(async()=>{if(t)try{const x=Ay(Ff,"users",t.uid),b=await tLe(x);if(b.exists()){const T=b.data();if(T.layers&&Array.isArray(T.layers)){const A=T.layers,I=Po.getState().layers,R=[...A],C=new Set(A.map(V=>V.id));I.forEach(V=>{C.has(V.id)||R.push(V)}),Po.setState({layers:R}),l.current=JSON.stringify(R),console.log(` ${A.length} lagen geladen uit cloud`)}if(T.vondsten&&Array.isArray(T.vondsten)){const A=T.vondsten,I=xd.getState().vondsten,R=[...A],C=new Set(A.map(V=>V.id));I.forEach(V=>{C.has(V.id)||R.push(V)}),xd.setState({vondsten:R}),c.current=JSON.stringify(R),console.log(` ${A.length} vondsten geladen uit cloud`)}if(T.routes&&Array.isArray(T.routes)){const A=T.routes,I=xl.getState().savedRoutes,R=[...A],C=new Set(A.map(M=>M.id));I.forEach(M=>{C.has(M.id)||R.push(M)});const V=new Set(R.map(M=>M.id));xl.setState({savedRoutes:R,visibleRouteIds:V}),u.current=JSON.stringify(R),console.log(` ${A.length} routes geladen uit cloud`)}}else console.log(" Geen cloud data gevonden, lokale data wordt gesynchroniseerd..."),await h(e),await f(r),await g(s);a.current=!1}catch(x){console.error(" Fout bij laden uit cloud:",x),a.current=!1}},[t,e,r,s,h,f,g]);return X.useEffect(()=>{t?(a.current=!0,v()):(a.current=!0,l.current="",c.current="")},[t?.uid]),X.useEffect(()=>{if(!t||a.current)return;const x=JSON.stringify(e);if(x!==l.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{l.current=x,h(e)},U8),()=>{o.current&&clearTimeout(o.current)}},[t,e,h]),X.useEffect(()=>{if(!t||a.current)return;const x=JSON.stringify(r);if(x!==c.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{c.current=x,f(r)},U8),()=>{o.current&&clearTimeout(o.current)}},[t,r,f]),X.useEffect(()=>{if(!t||a.current)return;const x=JSON.stringify(s);if(x!==u.current)return o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{u.current=x,g(s)},U8),()=>{o.current&&clearTimeout(o.current)}},[t,s,g]),{isLoggedIn:!!t,syncLayersToCloud:h,syncVondstenToCloud:f,syncRoutesToCloud:g}}function OTt(){MTt(),CTt(),NTt();const t=bs(f=>f.fetchPassivePosition);X.useEffect(()=>{t()},[t]);const n=14*Nn(f=>f.fontScale)/100,r=ri(f=>f.vondstFormOpen),i=ri(f=>f.vondstFormLocation),s=ri(f=>f.closeVondstForm),o=ri(f=>f.routeDashboardOpen),a=ri(f=>f.toggleRouteDashboard),l=ri(f=>f.monumentSearchOpen),c=ri(f=>f.closeMonumentSearch),u=KS(f=>f.showBuienradar),h=KS(f=>f.setShowBuienradar);return m.jsx(GEt,{children:m.jsxs("div",{style:{fontSize:`${n}px`},children:[m.jsx(fTt,{}),m.jsx(nrt,{}),m.jsx(_ut,{}),m.jsx(ZSt,{}),m.jsx(YEt,{}),m.jsx(eTt,{}),m.jsx(CSt,{}),m.jsx(NSt,{}),m.jsx(OSt,{}),m.jsx(DSt,{}),m.jsx(kEt,{}),m.jsx(IEt,{}),m.jsx(VEt,{}),m.jsx(yut,{}),m.jsx(RSt,{}),m.jsx(PSt,{}),m.jsx(zEt,{}),m.jsx(wut,{}),m.jsx(Rut,{}),m.jsx(FEt,{}),m.jsx(dSt,{}),m.jsx(LEt,{}),m.jsx(pSt,{}),m.jsx(DEt,{}),m.jsx(KSt,{}),m.jsx(YSt,{isVisible:u,onClose:()=>h(!1)}),m.jsx(lSt,{}),m.jsx(tTt,{}),m.jsx(lTt,{}),m.jsx(cTt,{}),m.jsx(dTt,{}),m.jsx(GSt,{isOpen:o,onClose:a}),m.jsx(ar,{children:r&&m.jsx(rEe,{onClose:s,initialLocation:i||void 0})}),m.jsx(PTt,{isOpen:l,onClose:c})]})})}const LTt="fef02a7628814a519d5f0eeb2d82656e";function DTt(){Qn.apiKey=LTt}DTt();console.log(`%c DetectorApp v${zN}`,"background: #4CAF50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;");TSe.createRoot(document.getElementById("root")).render(m.jsx(OTt,{}));export{bMt as $,Xe as A,Qn as B,jfe as C,TDe as D,Ji as E,_i as F,ZO as G,ZIe as H,TA as I,$r as J,pg as K,ro as L,it as M,GIt as N,_Mt as O,Vs as P,Ea as Q,Wo as R,zn as S,Am as T,eQ as U,Nd as V,Dqe as W,Tye as X,MMt as Y,PMt as Z,_,DRe as a,nl as a$,Fk as a0,jk as a1,nb as a2,UMt as a3,tqe as a4,aye as a5,DMt as a6,$Mt as a7,NMt as a8,Tk as a9,Dn as aA,cI as aB,sI as aC,Or as aD,Kn as aE,pn as aF,lh as aG,eIt as aH,ts as aI,okt as aJ,Zhe as aK,kl as aL,ho as aM,tO as aN,Mg as aO,Ot as aP,Kt as aQ,BUe as aR,vl as aS,mB as aT,H2 as aU,eg as aV,Qm as aW,Zh as aX,Ny as aY,Wl as aZ,j1 as a_,YG as aa,aa as ab,XA as ac,iqe as ad,Z3 as ae,h7e as af,yMt as ag,uh as ah,aXe as ai,en as aj,qt as ak,Yo as al,Gs as am,m2 as an,Bt as ao,Ze as ap,AB as aq,RB as ar,z2 as as,YE as at,av as au,Xge as av,ve as aw,YLe as ax,cRt as ay,La as az,gp as b,Vfe as b$,Bqe as b0,nDe as b1,Gl as b2,Sa as b3,Nf as b4,Hr as b5,$a as b6,jIt as b7,WIt as b8,BIt as b9,sCt as bA,Bte as bB,$Ct as bC,zVe as bD,Cde as bE,iw as bF,v2 as bG,Ok as bH,Qr as bI,lu as bJ,_G as bK,uc as bL,Tr as bM,Y2 as bN,da as bO,X2 as bP,hPt as bQ,cPt as bR,uPt as bS,kd as bT,yi as bU,y5t as bV,x2 as bW,z1e as bX,hde as bY,U8e as bZ,UAt as b_,Td as ba,Gu as bb,xs as bc,Jt as bd,tre as be,C0 as bf,N0 as bg,Qhe as bh,tde as bi,nde as bj,nkt as bk,XTt as bl,Ukt as bm,i5t as bn,m5t as bo,Dd as bp,WAt as bq,gg as br,p0e as bs,TNt as bt,jQe as bu,MHe as bv,Ad as bw,g0e as bx,y0e as by,m0e as bz,Sr as c,iRt as c$,ude as c0,zP as c1,sPt as c2,pl as c3,A1e as c4,Oy as c5,IVe as c6,mAt as c7,gve as c8,q5 as c9,nqe as cA,rqe as cB,wIt as cC,SIt as cD,EIt as cE,bIt as cF,uBe as cG,vje as cH,xje as cI,_je as cJ,wje as cK,JAt as cL,QAt as cM,cu as cN,CKe as cO,LB as cP,iO as cQ,HPt as cR,e2 as cS,fqe as cT,NG as cU,AF as cV,jQ as cW,uo as cX,Jkt as cY,Zkt as cZ,rRt as c_,AIt as ca,iB as cb,xa as cc,QJ as cd,UPt as ce,qn as cf,Jhe as cg,KA as ch,Tde as ci,V7e as cj,s6e as ck,ja as cl,Ikt as cm,tT as cn,z_ as co,nI as cp,tn as cq,_It as cr,xIt as cs,UIt as ct,kIt as cu,TIt as cv,XMt as cw,$7e as cx,zMt as cy,hn as cz,ir as d,mUe as d$,aMt as d0,sRt as d1,yPt as d2,Xnt as d3,mT as d4,xQe as d5,W4t as d6,Cn as d7,q4t as d8,ib as d9,r7 as dA,aPt as dB,_Ct as dC,FCt as dD,fd as dE,Nfe as dF,oMt as dG,dn as dH,fa as dI,Hu as dJ,ea as dK,afe as dL,eF as dM,AQe as dN,Yhe as dO,gi as dP,v9 as dQ,uB as dR,Vkt as dS,ha as dT,e4 as dU,Fkt as dV,sIt as dW,Q1e as dX,Zg as dY,J1e as dZ,CZe as d_,lB as da,$fe as db,tI as dc,Jy as dd,$1 as de,u1e as df,IMt as dg,jKe as dh,m7e as di,$u as dj,FKe as dk,Fa as dl,hc as dm,D_ as dn,Oi as dp,Wfe as dq,oC as dr,GM as ds,B8e as dt,Gt as du,xve as dv,cV as dw,ZQe as dx,U6 as dy,mI as dz,Nr as e,UB as e$,qTt as e0,KTt as e1,ove as e2,tb as e3,eJe as e4,rV as e5,ov as e6,hh as e7,fI as e8,Nk as e9,ZIt as eA,rde as eB,HZe as eC,zme as eD,Jfe as eE,NKe as eF,OMt as eG,IB as eH,C1 as eI,sqe as eJ,VMt as eK,rc as eL,FMt as eM,eqe as eN,aRt as eO,Bc as eP,lO as eQ,OZe as eR,cMt as eS,Kkt as eT,N6e as eU,rAt as eV,PDe as eW,I1 as eX,yG as eY,pBe as eZ,l0e as e_,vZe as ea,sve as eb,xZe as ec,nve as ed,ive as ee,UG as ef,GG as eg,rje as eh,ije as ei,oO as ej,aO as ek,Are as el,K5t as em,B5t as en,D5t as eo,Zi as ep,O5t as eq,eOt as er,tOt as es,tje as et,Pee as eu,d8e as ev,DCt as ew,FRt as ex,eu as ey,gkt as ez,fOt as f,W3t as f$,mGe as f0,jZe as f1,AGe as f2,_Ze as f3,rve as f4,KZe as f5,nRt as f6,W5 as f7,H5 as f8,Mde as f9,Qa as fA,us as fB,el as fC,W2 as fD,Dg as fE,MIt as fF,yVe as fG,pF as fH,TG as fI,n2 as fJ,yl as fK,e6e as fL,Yfe as fM,Ffe as fN,vIt as fO,So as fP,xk as fQ,zs as fR,qAt as fS,HAt as fT,t_e as fU,n_e as fV,$5t as fW,U5t as fX,Pg as fY,UJ as fZ,zIt as f_,qkt as fa,fVe as fb,z7e as fc,kCt as fd,zCt as fe,uI as ff,Wkt as fg,xG as fh,B5 as fi,yUe as fj,DGe as fk,XGe as fl,_Xe as fm,F7e as fn,fRt as fo,t2 as fp,jMt as fq,Ume as fr,LGe as fs,xUe as ft,wUe as fu,bUe as fv,BZe as fw,TZe as fx,kZe as fy,YZe as fz,th as g,AVe as g$,lXe as g0,Xf as g1,WDe as g2,Ak as g3,Di as g4,hge as g5,ol as g6,vRt as g7,u2 as g8,NRt as g9,JDe as gA,tF as gB,x$e as gC,rIt as gD,jee as gE,O$e as gF,d3t as gG,F1 as gH,$k as gI,YTt as gJ,Akt as gK,as as gL,n3t as gM,t3t as gN,$At as gO,ic as gP,_Ue as gQ,Kh as gR,tl as gS,a3t as gT,FIt as gU,yXe as gV,_Rt as gW,yRt as gX,oPt as gY,oUe as gZ,kRt as g_,y$ as ga,XRt as gb,wO as gc,vB as gd,_B as ge,YRt as gf,iPt as gg,EO as gh,uze as gi,WYe as gj,Hge as gk,ZB as gl,GZe as gm,fMt as gn,hMt as go,pI as gp,Ds as gq,dMt as gr,_p as gs,$g as gt,pMt as gu,Yy as gv,Ekt as gw,Nkt as gx,q5t as gy,ZDe as gz,Pi as h,cBe as h$,RF as h0,Ui as h1,yNt as h2,WM as h3,u9 as h4,fx as h5,cO as h6,lPt as h7,iv as h8,OCt as h9,c0e as hA,tIt as hB,Q8e as hC,RUe as hD,TGe as hE,IUe as hF,bO as hG,zM as hH,lkt as hI,VZe as hJ,RZe as hK,$ye as hL,xCt as hM,DB as hN,dXe as hO,pT as hP,Cf as hQ,Zl as hR,jBe as hS,nAt as hT,Ykt as hU,Ude as hV,tGe as hW,Mkt as hX,rI as hY,Ode as hZ,Xg as h_,bCt as ha,PRt as hb,pRt as hc,p$ as hd,UVe as he,rv as hf,q2 as hg,B2 as hh,Fs as hi,HB as hj,bje as hk,cje as hl,ope as hm,jze as hn,lRt as ho,Aze as hp,FZe as hq,uIt as hr,DQ as hs,Xfe as ht,Zfe as hu,oRt as hv,xGe as hw,a0e as hx,Qqe as hy,PZe as hz,JA as i,H as i$,aBe as i0,sBe as i1,m$ as i2,e0e as i3,NVe as i4,Gx as i5,LDe as i6,Sd as i7,X5t as i8,fCt as i9,NC as iA,qNt as iB,q3t as iC,yge as iD,Rk as iE,i9 as iF,Pze as iG,xge as iH,QIt as iI,RNt as iJ,Gkt as iK,c$e as iL,Tte as iM,YA as iN,Ynt as iO,R1 as iP,dG as iQ,UDe as iR,IRt as iS,JUe as iT,to as iU,vge as iV,Rze as iW,Zx as iX,WTt as iY,L1e as iZ,gB as i_,dCt as ia,eKe as ib,tge as ic,cze as id,Nee as ie,C7e as ig,Ik as ih,a2 as ii,cAt as ij,x8e as ik,T8e as il,I8e as im,od as io,Bkt as ip,IAt as iq,R7e as ir,GQe as is,ZNt as it,_ve as iu,r5t as iv,K4 as iw,t5t as ix,_T as iy,n5t as iz,St as j,lNt as j$,aje as j0,gd as j1,iXe as j2,YB as j3,PVe as j4,ERt as j5,l4 as j6,e_e as j7,ptt as j8,mtt as j9,VRt as jA,zee as jB,qge as jC,Qkt as jD,z0e as jE,LAt as jF,Z5t as jG,Cm as jH,Kze as jI,SPt as jJ,_Pt as jK,zh as jL,ukt as jM,hkt as jN,ckt as jO,ADe as jP,nv as jQ,pGe as jR,Lme as jS,o0e as jT,qIt as jU,J7e as jV,HIt as jW,Q7e as jX,Pfe as jY,uNt as jZ,cNt as j_,M5t as ja,Btt as jb,C5t as jc,T5t as jd,S5t as je,Htt as jf,AS as jg,P5t as jh,Zze as ji,vUe as jj,gUe as jk,EZe as jl,QZe as jm,tJe as jn,Dze as jo,Gge as jp,eje as jq,SZe as jr,eve as js,mCt as jt,pCt as ju,qo as jv,fB as jw,e9 as jx,dB as jy,RRt as jz,ue as k,VO as k$,aNt as k0,dNt as k1,hNt as k2,oNt as k3,sNt as k4,Oye as k5,Mze as k6,JJ as k7,iNt as k8,HG as k9,XIt as kA,GYe as kB,n$e as kC,gAt as kD,aDe as kE,HNt as kF,Uje as kG,Yje as kH,iI as kI,hIt as kJ,oIt as kK,aIt as kL,Rkt as kM,FDe as kN,jAt as kO,AG as kP,EAt as kQ,bAt as kR,mRt as kS,m$e as kT,p$e as kU,DRt as kV,CRt as kW,GDe as kX,mde as kY,wi as kZ,BAt as k_,Wje as ka,tVe as kb,aG as kc,dkt as kd,lG as ke,fkt as kf,xI as kg,Xx as kh,UYe as ki,l6e as kj,s5t as kk,Nye as kl,r2 as km,Z5 as kn,Af as ko,vMt as kp,rO as kq,aB as kr,ykt as ks,GB as kt,wCt as ku,vCt as kv,MPt as kw,BXe as kx,WXe as ky,tve as kz,_Tt as l,sze as l$,mW as l0,ml as l1,zO as l2,nOt as l3,yd as l4,wAt as l5,j_ as l6,$It as l7,Ege as l8,bge as l9,q4 as lA,ige as lB,xNt as lC,vNt as lD,_Nt as lE,$Qe as lF,Yet as lG,rtt as lH,rDe as lI,Tkt as lJ,pde as lK,Y5 as lL,Ckt as lM,Dk as lN,hYe as lO,Dge as lP,TRt as lQ,V$ as lR,ZA as lS,eAt as lT,fF as lU,_O as lV,RPt as lW,IPt as lX,uge as lY,lge as lZ,rze as l_,nUe as la,rC as lb,ege as lc,URt as ld,xB as le,V_ as lf,NPt as lg,OPt as lh,LPt as li,tPt as lj,QRt as lk,KRt as ll,Sze as lm,JRt as ln,eUe as lo,CIt as lp,bRt as lq,CPt as lr,E3t as ls,Xy as lt,g5t as lu,ekt as lv,WVe as lw,ere as lx,OVe as ly,CVe as lz,E as m,k3t as m$,gHe as m0,yS as m1,wx as m2,l3t as m3,LMt as m4,D7e as m5,h3t as m6,c3t as m7,yg as m8,uet as m9,Zqe as mA,_Ge as mB,wGe as mC,tNt as mD,sT as mE,xMt as mF,Yge as mG,Kme as mH,ede as mI,bkt as mJ,Ede as mK,Qfe as mL,YJ as mM,$de as mN,$et as mO,uRt as mP,_ge as mQ,eRt as mR,cB as mS,Lde as mT,kkt as mU,ZF as mV,Rqe as mW,HTt as mX,K0e as mY,n9 as mZ,A3t as m_,det as ma,fet as mb,qde as mc,uMt as md,RG as me,q_ as mf,zXe as mg,gNt as mh,O8e as mi,Mfe as mj,yqe as mk,AO as ml,pC as mm,xqe as mn,qme as mo,o3t as mp,dVe as mq,J5t as mr,eS as ms,Tf as mt,Fm as mu,vs as mv,wKe as mw,XXe as mx,mkt as my,IGe as mz,Xn as n,nIt as n$,BYe as n0,yCt as n1,gCt as n2,mG as n3,$Ge as n4,OGe as n5,MZe as n6,NGe as n7,iKe as n8,OAt as n9,i3t as nA,s3t as nB,sB as nC,Hkt as nD,skt as nE,O1e as nF,zNt as nG,VNt as nH,Q4t as nI,eNt as nJ,Dkt as nK,S1e as nL,F1e as nM,_2 as nN,Xh as nO,yB as nP,sge as nQ,hI as nR,b1e as nS,wI as nT,S3t as nU,i8 as nV,OIt as nW,I4 as nX,qZe as nY,dze as nZ,_4 as n_,PG as na,qG as nb,GAt as nc,f_ as nd,JLe as ne,TF as nf,YNt as ng,Det as nh,XNt as ni,KNt as nj,yve as nk,oW as nl,Aa as nm,Cze as nn,AE as no,KIt as np,CQe as nq,gMt as nr,u3t as ns,mMt as nt,FNt as nu,PNt as nv,j8e as nw,Lye as nx,g2 as ny,r3t as nz,sr as o,YAt as o$,XVe as o0,NIt as o1,Js as o2,Zs as o3,UCt as o4,WCt as o5,VCt as o6,u$e as o7,zkt as o8,lpe as o9,QTt as oA,ade as oB,ZAt as oC,XAt as oD,dRt as oE,Rde as oF,lYe as oG,qYe as oH,E1e as oI,Ave as oJ,pkt as oK,LNt as oL,DNt as oM,$Nt as oN,jNt as oO,bNt as oP,SNt as oQ,ENt as oR,het as oS,Cg as oT,MKe as oU,Mye as oV,kqe as oW,gQ as oX,q8e as oY,IIt as oZ,T3t as o_,zYe as oa,fze as ob,pze as oc,nC as od,SRt as oe,eze as of,tze as og,Fnt as oh,tu as oi,NO as oj,pZe as ok,yAt as ol,N1e as om,D1e as on,SXe as oo,Y3t as op,NXe as oq,X3t as or,lGe as os,DIt as ot,iIt as ou,VIt as ov,$kt as ow,bQe as ox,MVe as oy,rkt as oz,xTt as p,Okt as p$,KAt as p0,yje as p1,ett as p2,h$e as p3,ttt as p4,Xet as p5,vPt as p6,J4t as p7,lMt as p8,Fqe as p9,kNt as pA,nNt as pB,rNt as pC,CNt as pD,NNt as pE,UNt as pF,GNt as pG,fNt as pH,BNt as pI,WNt as pJ,DQe as pK,VQe as pL,Fve as pM,s2 as pN,ONt as pO,kQe as pP,Pkt as pQ,Nze as pR,CUe as pS,vze as pT,jRt as pU,M3t as pV,GGe as pW,cge as pX,Fge as pY,hfe as pZ,vT as p_,CMt as pa,EMt as pb,kMt as pc,SMt as pd,AMt as pe,TMt as pf,RMt as pg,f5t as ph,WJ as pi,wMt as pj,TVe as pk,xRt as pl,DVe as pm,ARt as pn,HCt as po,VXe as pp,Wc as pq,ORt as pr,wNt as ps,$c as pt,MNt as pu,lIt as pv,D$e as pw,INt as px,ANt as py,YQe as pz,vn as q,jg as q$,UGe as q0,$Pt as q1,$Rt as q2,SBe as q3,Qne as q4,XLe as q5,JTt as q6,ZTt as q7,Jze as q8,pqe as q9,Z4t as qA,ZRt as qB,Pf as qC,r9 as qD,zRt as qE,Ca as qF,tDe as qG,JZe as qH,tkt as qI,CCt as qJ,NCt as qK,$ze as qL,QGe as qM,JGe as qN,jge as qO,_He as qP,SGe as qQ,bGe as qR,EGe as qS,FGe as qT,ZGe as qU,xPt as qV,FYe as qW,PGe as qX,K3t as qY,Q5t as qZ,H3t as q_,A5t as qa,I5t as qb,Eqe as qc,k5t as qd,Vk as qe,Uk as qf,gqe as qg,vkt as qh,Mqe as qi,Cqe as qj,VB as qk,Unt as ql,QNt as qm,e5t as qn,JIt as qo,JNt as qp,p5t as qq,h5t as qr,d5t as qs,u5t as qt,c5t as qu,aet as qv,kve as qw,mNt as qx,pNt as qy,iet as qz,v2e as r,W5t as r0,Y5t as r1,H5t as r2,kze as r3,GRt as r4,HRt as r5,nPt as r6,BRt as r7,qRt as r8,rPt as r9,ICt as rA,gGe as rB,yx as rC,nKe as rD,YIt as rE,lCt as rF,SCt as rG,tRt as rH,aze as rI,tKe as rJ,mpe as rK,vpe as rL,EPt as rM,PCt as rN,bPt as rO,wPt as rP,LRt as rQ,TB as rR,jkt as rS,MCt as rT,kGe as rU,Jqe as rV,jGe as rW,dPt as rX,pPt as rY,v5t as rZ,tUe as ra,nGe as rb,wRt as rc,gI as rd,yI as re,vI as rf,kYe as rg,j3t as rh,jCt as ri,TCt as rj,RCt as rk,ACt as rl,_kt as rm,ZCt as rn,XCt as ro,akt as rp,ECt as rq,MRt as rr,LCt as rs,lHe as rt,ZXe as ru,H1e as rv,Lkt as rw,nte as rx,iCt as ry,F3t as rz,xe as s,hi as t,Ci as u,ya as v,Nde as w,Skt as x,Xkt as y,Kr as z};
//# sourceMappingURL=index-C14TKpKm.js.map
